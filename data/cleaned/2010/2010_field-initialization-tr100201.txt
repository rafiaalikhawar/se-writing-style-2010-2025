inference of field initialization technical report uw cse university of washington department of computer science engineering february fausto spoto dipartimento di informatica universit di verona italy fausto.spoto univr.itmichael d. ernst computer science engineering university of washington usa mernst uw.edu abstract araw object is partially initialized with only some of its fields set to legal values.
a raw object may violate its object invariants such as that a given field is non null .
programs often need to manipulate partially initialized objects but they must do so with care.
furthermore analyses must be aware of rawness.
for instance software verification cannot depend on object invariants for raw objects.
we present a static analysis that infers a safe over approximation of the program variables fields or array elements that at runtime might hold non fully initialized objects.
our formalization is flow sensitive and considers the exception flow in the analyzed programs.
we have proved the analysis to be sound.
we have also implemented our analysis in a tool called julia that computes both nullness and rawness information.
we have evaluated julia on over 50k lines of code.
we have compared its output to manually written nullness and rawness information and to an independently written type checking tool that checks nullness and rawness.
j ulia s output is accurate and we believe useful both to programmers and to static analyses.
.
introduction object oriented programming languages such as java allow the definition of instance variables orfields that hold the state of the objects.
those fields are normally but not necessarily initialized inside the constructors defined in their class.
before that initialization in java they hold the default value for their static type.
for fields of reference type the default value is null .
many type checking systems and static verification tools aim to prove that some object invariant inv holds for the objects of a given class.
this means that invmust be true immediately after the object construction and must remain true every time a public method is entered or exited.
a typical object invariant states that some field fis non null .
this means that all constructors must initialize fto a non null value and that fwill never be reset to null later.
this is an important piece of information since it guarantees that no dereference of fwill ever throw a nullpointerexception .
this conclusion is nottrueinside the constructors.
before fis initialized it still holds the default value null .
our work focuses on initialization properties rather than all ways any invariant can be violated such as by setting a value to a non null value that is inconsistent with its formal specification.
since in general object invariants do not hold for partiallyinitialized raw objects it is important to identify those sites program fields parameters return values or array elements that might hold a raw object at run time.
these sites are not just the this variable inside the constructors that variable can be passed to methods and stored in fields or arrays.
moreover a raw variable... many non null fields defined here public optionsdialog frame owner super owner options initializes a non null field this.owner owner initializes the remaining non null fields setup this is non raw here pack ... figure a snippet of code from the jflex program.
loses its rawness as soon as all its fields have been initialized or some relevant subset of its fields see section .
.
hence this might be non raw inside a constructor from a given program point onwards.
figure contains a snippet of code from class optionsdialog of the jflex scanner generator one of the applications that we analyze in section .
method setup is called by the constructor of class optionsdialog to help it build the object this helper method initializes most of the fields of the object.
the julia tool performs our rawness analysis and infers that the receiver of setup is raw and all other