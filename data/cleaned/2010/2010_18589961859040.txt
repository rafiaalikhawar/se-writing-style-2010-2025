security driven model based dynamic adaptation brice morin inria centre rennes bretagne atlantique brice.morin inria.frtejeddine mouelhi telecom bretagne rennes tejeddine.mouelhi telecom bretagne.eufranck fleurey sintef ict oslo franck.fleurey sintef.no yves le traon university of luxembourg yves.letraon uni.luolivier barais and jean marc j z quel inria and irisa university of rennes barais irisa.fr jezequel irisa.fr abstract security is a key challenge for software engineering espe cially when considering access control and software evolutions.
no satisfying solution exists for maintaining the al ignment of access control policies with the business logic.
cur rent implementations of access control rely on the separati on between the policy and the application code.
in practice this separation is not so strict and some rules are hardcoded within the application making the evolution of the policy difficult.
we propose a new methodology for implementing security driven applications.
from a policy define d by a security expert we generate an architectural model re flecting the access control policy.
we leverage the advances in the models runtime domain to keep this model synchronized with the running system.
when the policy is updated the architectural model is updated which in turn reconfigures the running system.
as a proof of concept we apply the approach to the development of a library management system.
categories and subject descriptors d2.
software architectures k6.
management of computing and information systems security and protection general terms design security this work was partially funded by the diva project eu fp7 strep contract permission to make digital or hard copies of all or part of thi s work for personal or classroom use is granted without fee provided th at copies are not made or distributed for profit or commercial advantage an d that copies bear this notice and the full citation on the first page.
to cop y otherwise to republish to post on servers or to redistribute to lists re quires prior specific permission and or a fee.
ase september antwerp belgium.
copyright acm ... .
.keywords access control adaptive system model driven engineering models runtime .
introduction security is a key issue in modern software intensive systems driving the every day life of billions of people all aro und the world.
software systems deployed in large companies banks airports etc must be available with a high level of security.
among different security concerns user authentication data encryption etc access control pla ys a critical role.
it ensures that users depending on their rol es can only access the resources they are supposed to access.
designing implementing and executing such systems requires the highest attention from the different stakeholder s. a small error in the specification or in the implementation of the access control concern could make a critical resource accessible to standard users.
several security models lik e rbac or orbac propose high level abstractions to security experts in order to specify access control policie s. the current implementation techniques consist in using a standard architecture that involves designing a dedicated security component called the policy decision point pdp which can be configured independently from the rest of the implementation containing the business logic of the application.
the execution of functions in the business logic includes calls to the pdp called peps policy enforcement points which grants or denies access to the protected resources functionalities of the system.
such an architectu re can for example be implemented with aspect oriented programming techniques.
the main limitation of the current implementation techniques is that they do not allow for flexible access control mechanisms.
in fact the access control policy cannot be modified without previously modifying the code to support the new access control rule.
this is an expected effect of the separation between the security code access control mechanism and the functional code.
in fact because of this approach the functional code may contain some hard coded access control mechanisms implementing some access control rules.
modifying these specific rules requires locatin g these hidden mechanisms and removing them.
in this pa205 per we address this issue by providing flexible access contr ol mechanisms.
in this paper we propose to leverage model driven engineering mde techniques to provide a very flexible approach for managing access control.
on one side access control policies are defined by security experts using a domain specific modeling language dsml which describes the concepts of access control as well as their relationships.
on the other side the application is designed using another dsml for describing the architecture of a system in terms of components and bindings.
this component based software architecture only contains the business componen ts of the application which encapsulate the functionalities of the system without any security concern.
then we define mappings between both dsmls describing how security concepts are mapped to architectural concepts.
we use these mappings to fully generate an architecture that enforces th e security rules.
when the security policy is updated the architecture is also updated.
finally we leverage the notion of models runtime in order to keep the architectural model itself synchronized with the access control model synchronized with the running system.
this way we can dynamically update the running system in order to reflect changes in the security policy.
only users who have the right to access a resource can actually access this resource.
the remainder of the paper is organized as follows.
section presents a background on access control and motivates the need for more flexible access control policies.
section describes an overview of our approach.
section presents the security and the architecture metamodels and how they are composed.
section describes how the architecture model is impacted when the security policy is updated and how these changes are automatically reflected at runtime.
section presents related work.
section concludes and presents future work.
.
motiv ations for dynamic access control access control aims at securing a system by controlling the access of users processes or components or any other entity to the resources of the system.
this access is controlled through the enforcement of an access control policy which expresses a set of rules for allowing or denying the access to the system resources.
several access control models allow defining access control policies.
this section presents the motivation behind the need for a more dynamic access control.
to show the limitation of the existing platforms we first present the existing architect ure for implementing access control policies.
then we explain the various reasons that lead to the need to provide a new approach for enforcing dynamic access control policies.
.
current architecture for managing access control figure depicts a security architecture typically used for implementing the security policy.
roughly there are two main components the policy decision point pdp is the point where policy decisions are made.
it encapsulates the access control policy and implements a mechanism to process requests coming from the business logic via the pep and returns a response which can be deny or permit .
policies can be stored in various ways data base extensible access control markup language xacml files etc.
the policy enforcement point pep is the point in the business logic where the policy decisions are enforced.
it is a security mechanism which has been intentionally inserted in the application functional code.
before the service is executed the pep sends a request to the pdp to get the suitable response grant or deny which depends on the user requesting the service and on the current context.
based on the pdp response if the access is granted the service executes else the access is denied and the pep forbids the execution of the service.
guipdp access control policy pep business logic figure the security architecture this architecture clearly separates the access control dec ision from its enforcement thus improving the testability o f the system.
in addition the security rules are centralized improving the observability of the system.
one can easily monitor the enforced security rules to detect bugs or securi ty flaws.
.
limitations of current approaches although current approaches allow the security rules to be updated and modified the enforcement of these modifications is problematic.
this is due to the existence of some access control mechanisms hard coded into the business logic.
these hidden mechanisms enforce some of the access control rules making the system s policy more rigid and difficult to modify.
there are two kinds of mechanisms identified in the implicit mechanisms and the explicit mechanisms.
the implicit mechanisms are implemented by construction through the design model or the deployment architecture.
for instance figure illustrates such an impl icit mechanism.
in this example by construction the secretari es are not allowed to update accounts.
the access control policy can however be easily updated to allow secretaries to update accounts.
however to enforce this new rule refactori ng is required.
a simple refactoring would consist of moving th e association access and the methods to the level of the clas s personnel.
such a refactoring would also allow any personnel instance to access the personnel accounts which may be an unexpected change.
so the program will have to be carefully modified in several locations to implement the desired evolution of the access control policy.
206figure implicit security mechanism the second kind of hidden mechanisms is the explicit mechanisms which are implemented within some portions of the application code that is not documented.
figure shows an example of these explicit mechanisms 1public void borrowbook book b user user visible mechanism call to the security policy service securitypolicyservice.check user securitymodel.borrow method book.
class securitymodel.default context do something else hidden mechanism if getdayofweek .equals sunday getdayofweek .equals saturday this is not authorized throw a business exception throw newbusinessexception not allowed to borrow in week ends figure explicit security mechanism in the body of the method after the pep call to the pdp a new check is done which forbids borrowing books during week ends.
if the policy has to be modified to allow borrowing books during week ends this hidden mechanism should be located and deleted.
.
discussion both the explicit and the implicit mechanisms reduce the flexibility of the system.
they are inevitable since they are due to the way the standard architecture pdp pep is implemented as illustrated through the examples.
in fact the problem is not due to the architecture itself.
it is caused by the way applications are developed by separating the process of implementing the security mechanism the pdp and the pep from the application logic implementation.
this application logic part should be implemented by taking into account the access control policy so that this poli cy is not hard coded in the business logic.
for these reasons we clearly need to take into account access control during the modeling and more importantly the deployment of secured systems.
this is the main contribution of this work which involves providing a complete process that includes access control throughout the modeling and the specially deployment processes.
.
overview in commercial and government environments any change to the security policies normally requires impact assessme nts risk analysis and such changes should go through the rfc request for change process.
however in case of urgency crisis events intrusion detection server crashes inte roperability with external systems to deal with a critical situ ation the adaptation of a security policy at runtime is a necessity.
this adaptation may or may not have been already predicted or planned.
the proposed approach and the combination of composition and dynamic adaptation techniques shown in figure show how the security policy can be adapted conforming to a defined adaptation plan or in an unplanned way.
the security adaptation mechanisms we propose deal with the challenging issue of how to provide running systems supporting planned and unplanned security policy adaptations.
the inputs of the process are two independent models the business architecture model of the system and the security model.
these two models are expressed in different domain specific modeling languages the core business architecture with an architecture modeling language section .
and the security policy with an access control language section .
.
by dynamically composing the security model with the architecture model the approach allows adapting the applicatio n security policy according to pre defined adaptation rules b ut also to cope with any unplanned changes of the security model.
business architecture model security enforced architecture modelsecurity policy context information middleware platformrunning system monitoring frameworkadaptive security model composition the security policy is composed with the business architecture reasoning depending on the context the appropriate access control rules are selected from the security model adaptation the running system is safely and automatically reconfigured notification the monitoring framework triggers reasoning by notifying relevant changes evolution at any time the security model can be updated models at runtime figure overview of the proposed approach the adaptive security model contains a set of access control rules and a description of the context in which these rules apply.
at runtime depending on the context information coming from the system the appropriate set of rules has to be chosen.
this is the reasoning shown as in figure .
the reasoning phase processes the security model based on the context information coming from the system to produce the security policy to be enforced.
basically when some events are triggered security rules can be activated o r deactivated.
once the appropriate security policy has been defined it has to be composed into the architecture model of the application see in figure .
the models to compose here are of different nature an architecture model on one 207side and a security policy on the other side.
the composition is done in two steps .
the security policy is transformed into an architecture model realizing it .
this architecture model is composed with the business architecture model the implementation of this complex composition operator is discussed in section .
the output of the composition is a plain architecture model which enforces the security polic y in the application.
step and in figure correspond to the synchronization of the architecture model with the running system and the monitoring of the system environment.
for both of these tasks the approach proposed in this paper reuses existing runtime adaptation techniques.
basically the idea is to leverage monitoring and runtime reconfiguration mechanisms offered by middleware platforms in order to extract context information and update the running system to match the desired architecture.
finally poi nt in figure corresponds to an evolution of the security model.
the proposed approach allows changing the security model at any point in time.
here it does not only consist in activating deactivating existing rules but also consi sts in adding removing or updating rules or roles.
this paper focuses on how the architecture and the running system causally evolves when the security policy is updated.
context monitoring and reasoning can be realized by existing adaptive system modeling techniques such as .
.
composing security and architecture metamodels in this section we describe how we compose the architecture metamodel into the security metamodel.
we first introduce a generic metamodel for describing access contro l policies.
then we introduce our generic metamodel for describing component based architecture.
finally we detai l how we map security concepts to architectural concepts.
.
a generic metamodel for describing access control policies the metamodel we use to describe access control policies is illustrated in figure at the end of this paper.
it defines the concepts and their relationships needed to design acces s control models.
the root concept is the policy .
a policy contains resources roles users andrules.
a resource e.g.
a book define some actions e.g.
borrow .
each user of the system has one role.
rules allow specifying the action the users via their role can perform on the resources of the system.
we distinguish two types of rules permission specifies the actions that the user of a given role can perform.
by default users can access the actions associated with their roles.
delegation specifies the actions that a user delegator delegates to another user delegatee .
by default no delegation is active.
each rule can be associated with a context.
a context specifies when a rule should be active depending of the environment.
for example users can borrow books from monday to friday if they have not exceeded their quota.a context is a boolean expression involving some context variables.
a metamodel for describing such context can be found in .
rules with no associated context are active by default but could be deactivated.
.
a core metamodel for runtime architectures our generic metamodel is illustrated in figure at then end of this paper.
a component type contains some ports.
each port has a uml like cardinality upper and lower bounds indicating if the port is optional lowerbound or mandatory lowerbound .
it also indicates if the port only allows single bindings upperbound or multiple bindings upperbound .
a port also declares a role client or server and is associated to a service.
a service encapsulates some operations defined by a name a return type and some parameters.
a service has a similar structure as java interface.
a component instance has a type and a state on off specifying whether the component is started or stopped.
it can be bound to other instances by a transmission binding linking a provided service server port to a required servi ce client port .
a composite instance can additionally decla re sub instances and delegation bindings.
a delegation bindi ng specifies that a service from a sub component is exported by the composite instance.
.
mapping security concepts to architectural concepts in this sub section we propose to map the security concepts section .
to architectural concepts section .
.
this mapping is performed by the seamless weaving engine provided by kermeta that allows designers to extend a metamodel with additional elements1 attributes