delft university of technology software engineering research group technical report series detecting and visualizing inter worksheet smells in spreadsheets felienne hermans martin pinzger and arie van deursen report tud serg sergtud serg published produced and distributed by software engineering research group department of software technology faculty of electrical engineering mathematics and computer science delft university of technology mekelweg cd delft the netherlands issn software engineering research group technical reports for more information about the software engineering research group note c copyright by the authors of this report.
software engineering research group department of software technology faculty of electrical engineering mathematics and computer science delft university of technology.
all rights reserved.
no part of this series may be reproduced in any form or by any means without prior written permission of the authors.detecting and visualizing inter worksheet smells in spreadsheets felienne hermans martin pinger arie van deursen software engineering research group delft university of technology delft the netherlands email f.f.j.hermans m.pinzger arie.vandeursen tudelft.nl abstract spreadsheets are often used in business for simple tasks as well as for mission critical tasks such as finance or forecasting.
similar to software some spreadsheets are of better quality than others for instance with respect to usability maintainability or reliability.
in contrast with software however spreadsheets are rarely checked tested or certified.
in this paper we aim at developing an approach for detecting smells that indicate weak points in a spreadsheet s design.
to that end we first study code smells and transform these code smells to their spreadsheet counterparts.
we then present an approach to detect the smells and communicate located smells to spreadsheet users with data flow diagrams.
we analyzed occurrences of these smells in the euses corpus.
furthermore we conducted ten case studies in an industrial setting.
the results of the evaluation indicate that smells can indeed reveal weaknesses in a spreadsheet s design and that data flow diagrams are an appropriate way to show those weaknesses.
keywords spreadsheets code smells refactoring data flow diagrams i. i ntroduction spreadsheets are widely used in industry winston estimates that of all analysts in industry perform calculations in spreadsheets.
their use is diverse ranging from inventory administration to educational applications and from scientific modeling to financial systems.
especially in the financial domain spreadsheets are prevailing.
panko estimates that of u.s. firms and in europe use spreadsheets in some form for financial reporting.
business analysts using spreadsheets usually have very limited training in programming or structuring data.
in spite of that they effectively are end user programmers and as such face many of the challenges of professional developers such as identifying faults debugging or understanding someone else s code .
this paper aims at providing support for spreadsheet users to take on these end user programming challenges focused on support for identifying potentially risky parts in a spreadsheet s high level design i.e.
the way in which worksheets are organized and depend on each other.
our starting point is the code smell metaphor introduced by fowler .
in particular we study the coupling and cohesion of classes called collaboration disharmonies by lanza and marinescu and transform these code smells in such a way that they apply to the coupling of worksheetsrather than classes.
from this we obtain a list of interworksheet smells .
in order to detect these smells automatically we define metrics for each of them.
with each metric we establish a threshold to know at what point to identify a worksheet as smelly.
we follow the approach of who analyzed metrics on source code and set thresholds by determining the worst and of all methods and choosing corresponding metric values for the thresholds representing medium high and very high risk.
we then address the issue of communicating identified smells to spreadsheet users.
for this we use our original worksheet visualization since earlier experiments have shown that these diagrams are useful for spreadsheet users to get an overview of the structure of their spreadsheet.
we enrich those data flow diagrams with colors and tool tips to convey the inter worksheet smells to spreadsheet users.
we perform a quantitative and qualitative evaluation of our approach.
firstly we analyzed the euses corpus and investigated the occurrence of inter worksheet smells.
secondly we conducted a series of case studies at a large dutch financial institution called robeco.
here we conducted ten case studies.
in each study we analyzed a real life spreadsheet and discussed the located smells with the spreadsheet owner supported by the generated data flow diagram.
the evaluations aim to answer the following research questions r1 what inter worksheet smells are the most common and why?
r2 how do inter worksheet smells expose threats to spreadsheet quality and calculation integrity?
r3 to what extent are enriched data flow diagrams an appropriate way of visualizing inter worksheet smells?
the findings of these evaluations indicate that interworksheet smells are commonly found in real life spreadsheets inter worksheet smells can indicate real weaknesses in a spreadsheet s design and data flow diagrams seem useful to help spreadsheet users locate and understand inter worksheet smells.
this paper is organized as follows.
section ii gives an overview of related work in the area of code smells and spreadsheet metrics.
in section iii we sketch the background of our approach and illustrate it with a motivating example.
sergfelienne hermans martin pinzger and arie van deursen detecting and visualizing inter worksheet smells in spreadsheets tud serg 1section iv introduces the inter worksheet smells followed by section v that explains how to automatically detect the smells.
in section vi the communication of the smells to spreadsheet users by means of data flow diagrams is described.
section vii describes the implementation of our prototype breviz while section viii explains the two evaluations we have performed in detail.
section ix discusses the applicability of the proposed approach followed by the concluding remarks in section x. ii.
r elated work efforts related to our research include work on code smells firstly the canonical work by fowler that gives an overview of code smells and corresponding refactorings.
recent efforts focused on the automatic identification of code smells by means of metrics.
marinescu for instance uses metrics to identify suspect classes those classes that might have design flaws.
lanza and marinescu explain this methodology in more detail.
alves et al.
focus on a strategy to obtain thresholds for metrics from a benchmark.
olbrich et al.
furthermore investigates the changes in smells over time and discusses their impact .
furthermore there are papers that address common errors in spreadsheets.
ayal et al.
for instance names the incorrect grouping of data and incorrect coupling between those groups as sources of errors.
panko names omission errors as the most dangerous of spreadsheet errors.
omission errors are those errors that arise from misinterpretation of the situation that should be modeled powell et al.
.
finally there are papers on spreadsheet metrics which are also aimed at locating weak points in spreadsheets.
there is our recent work that applies code smells to individual formulas rather than worksheets.
in bregar published a paper presenting a list of spreadsheet metrics based on software metrics .
he however does not provide any justification of the metrics nor did he present an evaluation.
hodnigg and mittermeir propose several spreadsheet metrics of which some are similar to bregar s. their metrics are divided into three categories general metrics such as the number of formulas and the number of distinct formulas formula complexity metrics such as the number of