language fuzzing using constraint logic programming kyle dewey jared roesch ben hardekopf university of california santa barbara kyledewey jroesch benh cs.ucsb.edu abstract fuzz testing builds con dence in compilers and interpreters.
it is desirable for fuzzers to allow targeted generation of programs that showcase speci c language features and behaviors.
however the predominant program generation technique used by most language fuzzers stochastic context free grammars does not have this property.
we propose the use of constraint logic programming clp for program generation.
using clp testers can write declarative predicates specifying interesting programs including syntactic features and semantic behaviors.
clp subsumes and generalizes the stochastic grammar approach.
categories and subject descriptors d. .
constraint and logic languages d. .
testing tools keywords fuzzing automated program generation automated testing .
introduction language fuzzing is a proven strategy for testing the correctness of compilers and interpreters.
however existing language fuzzing techniques are in general ad hoc and limited in their scope and their e ectiveness.
we propose a new method for language fuzzing based on constraint logic programming clp .
our clp method generalizes and improves upon the existing fuzzing strategies.
language fuzzing is used to test language implementations i.e.
compilers and interpreters.
a fuzzer automatically generates programs in the language being tested and feeds them to one or more implementations of that language.
the fuzzer can then use an oracle of correctness or di erential testing to determine if the program was executed correctly.
fuzzing is often used as a bug nding tool but this work was supported by nsf ccf .
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
ase september vasteras sweden.
copyright acm ... .
.
.it can also be used to increase con dence in the correctness of a language implementation.
for example if a fuzzer can generate a million programs that all stress a particular language feature in diverse ways without ever triggering a bug then the implementor can have a high degree of con dence in the correctness of that language feature.
with respect to both nding bugs and increasing con dence in correctness the most important part of a language fuzzer is the technique used to generate programs because that technique ultimately determines what is tested and how it is tested.
program generation.
a desirable property of program generation for language fuzzing is the ability to target generation i.e.
to specify particular combinations of syntactic language features and semantic language behaviors that the generated programs should all exhibit.
for example suppose that the language implementation has been augmented with a new optimization or language feature and the implementor wants to test that the new version of the implementation is correct.
in order to do so the fuzzer should speci cally generate programs that would trigger the optimization or that would use the new language feature.
purely syntactic speci cations are not su cient for this purpose the fuzzer must be able to specify program behaviors to achieve the desired results.
current state of the art.
the predominant program generation strategy for language fuzzing is based on stochastic context free grammars .
the fuzzer takes a grammar describing the syntax of the language being tested and an assignment from the grammar s productions to probabilities.
the resulting probabilistic grammar is used to generate syntactically valid programs whose various expressions conform to the given probability distribution.
approaches based on stochastic grammars do not have the ability to target program generation for speci c syntactic features and semantic behaviors.
traditional stochastic grammars are only able to guide program generation by tuning the grammar s probabilities often one of the most laborious aspects of using stochastic grammars .
even using additional extended features such as conditional probabilities and bounds stochastic grammars remain rooted in syntax preventing testers from directly specifying semantic behaviors under test.
key insight.
our central insight is that constraint logic programming clp is an ideal vehicle for language fuzzing that strictly subsumes the stochastic grammar approach i.e.
using clp predicates we can specify stochastic gram725 mars but we can also specify combinations of syntactic features and semantic behaviors in a declarative and e cient way.
the nature of clp means that these predicates can be directly used to automatically generate many satisfying programs i.e.
programs that contain the speci ed features and behaviors.
clp is not an alternative approach from stochastic grammars but rather a complete replacement with strictly greater expressiveness.
contributions.
our speci c contributions in this paper are the following a general description of how to apply clp to language fuzzing in order to yield the bene ts outlined above section a discussion of how to apply our method to fuzz javascript a dynamically typed scripting language with objects prototype based inheritence and higher order functions section and an evaluation of our method that uses our techniques for fuzzing javascript to compare against a purely stochastic grammar approach section .
.
related work we review related work with respect rst to language fuzzing then with respect to declarative test generation.
language fuzzing.
the most common technique used to automatically generate programs for testing is the stochastic grammar approach described in section .
state of the art language fuzzers based on this method include jsfunfuzz langfuzz and csmith .
jsfunfuzz was developed internally by mozilla speci cally for javascript in order to test the spidermonkey javascript engine.
langfuzz is targeted to dynamic languages including javascript but is not restricted to a single language.
langfuzz extends stochastic generation to include mutation given an existing test suite langfuzz will randomly mutate the existing programs in order to generate new ones.
csmith uses stochastic generation as the basis of a fuzzing tool for c supplemented with auxiliary c speci c techniques and analyses to handle potentially unde ned behavior and other c speci c problems.
we demonstrate in the rest of the paper that our proposed clp method is able to specify the same things as stochastic grammars and also specify semantic behaviors and relations between syntactic expressions.
declarative test generation.
our clp technique uses declarative speci cations to generate programs for language fuzzing.
no existing language fuzzers use this approach but there are techniques for automatic data structure generation e.g.
red black trees that use similar ideas.
testera allows programmers to declaratively specify data structures using predicates written in alloy .
alloy compiles the speci cation down to a sat instance and uses a sat solver to generate satisfying data structure instances.
udita allows users to specify data structure predicates in java using a hybrid declarative imperative style.
it allows for the de nition of generators which can be called nondeterministically which is a simpli cation of earlier purely imperative style generators like those in astgen .
korat allows for purely declarative data structure predicates to be speci ed in java.
korat s technique is in some ways similar to though distinct from a logic programming based approach.
however it has no ability to solve symbolic constraints and cannot employ symbolic reasoning about the values contained in the data structures.none of the above existing declarative test generation strategies use constraint logic programming and none have been applied to program generation for language fuzzing.
.
clp for program generation in this section we discuss how to use constraint logic programming for program generation.
we brie y review standard clp syntax and semantics but readers unfamiliar with clp may wish to consult further