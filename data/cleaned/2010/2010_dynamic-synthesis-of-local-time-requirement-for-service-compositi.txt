singapor e management univ ersity singapor e management univ ersity institutional k nowledge at singapor e management univ ersity institutional k nowledge at singapor e management univ ersity resear ch collection school of computing and information systems school of computing and information systems dynamic synthesis of local time r equir ement for ser vice dynamic synthesis of local time r equir ement for ser vice composition composition tian huat t an tienne andr jun sun singapor e management univ ersity junsun smu.edu.sg yang liu jin song dong see next page for additional authors follow this and additional works at https ink.libr ary.smu.edu.sg sis r esear ch part of the softwar e engineering commons citation citation tan tian huat andr tienne sun jun liu y ang dong jin song and chen manman.
dynamic synthesis of local time r equir ement for ser vice composition.
.
proceedings of the 35th international conf erence on softwar e engineering icse san f rancisco ma y .
.
available at available at https ink.libr ary.smu.edu.sg sis r esear ch this conf erence pr oceeding ar ticle is br ought t o you for fr ee and open access b y the school of computing and information systems at institutional k nowledge at singapor e management univ ersity .
it has been accepted for inclusion in resear ch collection school of computing and information systems b y an authoriz ed administr ator of institutional k nowledge at singapor e management univ ersity .
for mor e information please email cher ylds smu.edu.sg .
author author tian huat t an tienne andr jun sun y ang liu jin song dong and manman chen this conf erence pr oceeding ar ticle is a vailable at institutional k nowledge at singapor e management univ ersity https ink.libr ary.smu.edu.sg sis r esear ch dynamic synthesis of local time requirement for service composition tian huat tan tienne andr y jun sunz yang liux jin song dong manman chen nus graduate school for integrative sciences and engineering singapore tianhuat comp.nus.edu.sg yuniversit paris sorbonne paris cit lipn cnrs umr f villetaneuse france etienne.andre lipn.univ paris13.fr zsingapore university of technology and design singapore sunjun sutd.edu.sg xnanyang technological university singapore yangliu ntu.edu.sg national university of singapore singapore dongjs chenman comp.nus.edu.sg abstract service composition makes use of existing servicebased applications as components to achieve a business goal.
in time critical business environments the response time of a service is crucial which is also reflected as a clause in service level agreements slas between service providers and service users.
to allow the composite service to fulfill the response time requirement as promised it is important to find a feasible set of component services such that their response time could collectively allow the satisfaction of the response time of the composite service.
in this work we propose a fully automated approach to synthesize the response time requirement of component services in the form of a constraint on the local response times that guarantees the global response time requirement.
our approach is based on parameter synthesis techniques for real time systems.
it has been implemented and evaluated with real world case studies.
i. i ntroduction service oriented architecture is a paradigm that promotes the building of software applications by using services as basic components.
services make their functionalities available through a set of operations accessible over a network infrastructure.
to assemble a set of services to achieve a business goal service composition such as bpel business process execution language orchestration has been proposed.
the service that is composed by service composition is called acomposite service and services that the composite service makes use of are called component services.
in business where timing is critical a requirement on the service response time is often an important clause in service level agreements slas which is the contractual basis between service consumers and service providers on the expected quality of service qos level.
henceforth we denote the response time requirement of composite services asglobal time requirement and the set of constraints on the response times of the component services as the local time requirement .
the response time of a composite service is highly dependent on that of individual component services.
it is therefore important to derive the local time requirementfrom the global time requirement so as to identify component services which could be used to build the composite service while satisfying the response time requirement.
consider an example of a stock indices service which has an sla with the subscribed users such that the stock indices would be returned in two seconds upon request.
the stock indices service makes use of three component services including a paid service to request for the stock indices.
the stock indices service provider would be interested to know the local time requirement of the component services.
bpel is a service composition language that supports complex timing constructs and control flow structures such as concurrency.
such a combination of timing constructs concurrent calls to external services and complex control structures makes it a challenge to synthesize the local time requirement.
in this paper we present a fully automated technique for the synthesis of the local time requirement in bpel.
the approach works by performing dynamic analysis on the service composition using techniques of parameter synthesis for realtime systems.
for the synthesized local time requirement to be useful it needs to be as weak as possible to avoid discarding any service candidates that might be part of a feasible composition.
this is particularly important as often having a faster service would incur higher cost.
to synthesize a better constraint that allows larger sets of feasible composition we provide an extra analysis on the activities and classify them as or activities or and activities.
we then extend labeled transition systems lts with and states and or states which we call and or lts aolts for synthesizing the local time requirement.
the approach not only avoids bad scenarios in the service composition but also guarantees the fulfillment of global time requirement.
our contributions are as follows given a composite service we develop a sound method for synthesizing the local time requirement in the form of a set of constraints on the local service response978 .
c ieee icse san francisco ca usa542times.
the approach is implementation independent therefore can be applied at the design stage of service composition.
we propose a new kind of labeled transition systems called aolts that allows us to exploit the hierarchical structure of composite services for synthesizing a more relaxed local time requirement which is yet strong enough to guarantee the reachability of good scenarios inanyinstances of the composite services.
we develop a fully automated tool to evaluate the proposed method and apply it to real world case studies.
the synthesized local time requirement has multiple advantages.
first it allows the selection of feasible services from a large pool of services with similar functionalities but different local response times.
second the designer can avoid over approximations on the local response times.
an over approximation may lead the service provider to purchase a service at a higher cost while a service at a lower cost with a slower response time may be sufficient to guarantee the global time requirement.
third the local requirements serve as a safe guideline when component services are to be replaced or new services are to be introduced.
last but not least the requirement synthesized by our method gives a quantitative measure of the robustness of the composite services.
indeed if the global time requirement is satisfied given a local response time of seconds it may not be the case anymore for a value bigger than but very close to seconds e.g.
.
seconds .
the constraint synthesized gives a measure of the upper bound until which each local response time can vary.
outline .
the rest of this paper is structured as follows.
section ii introduces a timed bpel running example.
section iii provides the necessary definition for terminologies.
section iv introduces our approach to dynamically analyze the bpel process.
section v presents the synthesis algorithms and their soundness proofs.
section vi reviews related works.
section vii discusses the application of our approach on two case studies.
finally section viii concludes the paper and outlines future work.
ii.
a t imed bpel e xample bpel is a standard for implementing composition of existing web services by specifying an executable work flow using predefined activities.
in this work we assume the composite service is specified using the bpel language.
basic bpel activities that communicate with component web services are receive invoke and reply which are used to receive messages execute component web services and return values respectively.
we denote them as communication activities.
the control flow of the service is defined using structural activities such as flow sequence pick if etc.
in this section we illustrate a stock market indices service smis that is used as a running example in this work.receive user sync.
invoke ds xreply indexes async.
invoke fs onmessage fs onalarm second xreply indexes async.
invoke ps onmessage ps onalarm second xreply indexes reply failure indexes exist indexes do not exist fig.
.
stock market indices service a. stock market indices service assume that the smis is a paid service and its goal is to provide updated stock indexes to the subscribed users.
it provides service level agreement sla to the subscribed users stating that it always responds within two seconds upon request.
the smis has three component web services a database service ds a free news feed service fs and a paid news feed service ps .
the strategy of the smis is calling the free service fsbefore calling the paid service psin order to minimize the cost.
upon returning the result to the user the smis would also store the latest results in an external database service provided by ds storage of the results is omitted here .
the workflow of the smis is sketched in fig.
under the form of a tree.
when a request is received from a subscribed customer receive user it would synchronously invoke i.e.
invoke and wait for reply the database service sync invoke ds to request for stock indexes stored in the last minute.
upon receiving the response from ds the process is followed by an if branch denoted by .
if the indexes are available indexes exists then they are returned to the user reply indexes .
otherwise fsis invoked asynchronously i.e.
the system moves on after the invocation without waiting for the reply .
a pick construct denoted by is used here to await incoming response onmessage from previous asynchronous invocation and timeout onalarm if necessary.
if the response from fs onmessage fs is received within one second then the result is returned to the user reply indexes .
otherwise the timeout occurs onalarm second and smis stops waiting for the result from fsand calls psinstead async invoke ps .
similar to fs the result from psis returned to user if the response from psis received within one second.
otherwise it would notify the user regarding the failure of getting stock indexes reply failure .
the state with a x resp.
represents the desired resp.
undesired end state.
the global time requirement for smis is that smis should respond within two seconds upon request.
it is of particular interest to know the local time requirements for services ps 543fs and ds so as to fulfill the global time requirement.
this information could also help to choose a paid service pswhich is both cheap and responding quickly enough.
b. bpel notations to present bpel syntax succinctly we define a set of bpel notations below rec s and reply s are used to denote receive from and reply to a service s sinv s resp.
ainv s denotes synchronous resp.
asynchronous invocation of a service s pjjjqdenotes the concurrent execution of bpel activities pandq pcbbqdenotes conditional activity where bis a guard condition.
if bis evaluated as true bpel activity pis executed otherwise activity qis executed.
pick s p alrm a q denotes bpel pick activity which either receives the message from service swithin aseconds where a2r and subsequently executes bpel activity p or timeouts at aseconds and subsequently executes bpel activity q. if the message is arrived at exactly aseconds then porqexecutes nondeterministically.
iii.
f ormal model for parametric analysis a composite service smakes use of a finite number of component services to accomplish a task.
let c fs1 sng be the set of all component services that are used by s. the response time of a service s1is reflected on the time that spends on the communication activities.
for example assume that the only communication activity that communicates with component service s1issinv s1 .
upon invoking of service s1 the construct sinv s1 waits for the reply.
the response time of component service s1 is equivalent to the waiting time in sinv s1 therefore by analyzing the time spent in sinv s1 we can get the response time of component service s1.
given a composite service s let ti2r 0be the response time of component service sifori2 f1 ng and let ct ft1 tngbe a set of component service response times that fulfill the global time requirement of service s. because ti for i2 f1 ng is a real number there are infinitely many possible values even in a bounded interval and even if one restricts to rational numbers .
a method to tackle this problem is to reason parametrically by considering these response times as unknown constants or parameters .
letui2r 0be the parametric response time of component service sifori2f1 ng and let cu fu1 ungbe the set of component service parametric response times.
using constraints on cu we can represent an infinite number of possible response times symbolically.
the local time requirement of composite service sis specified as a constraint over cu.
an example of local time requirement is u1 u2 .
this local time requirement specifies that in order for sto satisfy the global time requirement either service s1needs to respond within time units or service s2needs to respond within time units.we review relevant definitions in the following.
a. clocks parameters and constraints aclock is a variable of type r .
a clock is used to record the time passage of a communication activity.
all clocks are progressing at the same rate.
xis defined as a universal set of clocks.
let x fx1 xhg x be a finite set of clocks.
a clock valuation is a function w x!r that assigns a nonnegative real value to each clock.
a parameter is an unknown constant.
letudenote the universal set of parameters disjoint withx.
given a finite set u fu1 umg u aparameter valuation is a function u!r 0assigning a non negative real value to each parameter.
we can identify a valuation with the point u1 um .
alinear term onx uis an expression of the formp i n izi dwith zi2x u i2r 0for1 i n and d2r .
given x x and u u aninequality over xanduise e0with 2f g where eande0are linear terms on x u. aconstraint is a conjunction of inequalities.
we denote by cx uthe set of all constraints over xandu.
henceforth we use w resp.
to denote a clock resp.
parameter valuation.
letc2c x denote the constraint over xobtained by replacing in ceach u2uwith u .
similarly c denotes the constraint obtained by replacing each clock x inc with w x .
we write w j c ifc evaluates to true.
cisempty if there does not exist a parameter valuation such that j c otherwise cisnon empty .
we define c fx djx2c d2r 0g as time elapsing ofc i.e.
the constraint over xanduobtained from cby delaying an arbitrary amount of time.
given two constraints c1 c22c x u c1isincluded inc2 denoted by c1 c2 if 8w w j c1 w j c2.
b. labeled transition systems in this work the semantics of composite service is captured using labeled transition systems ltss .
the behavior of composite service is affected by the input data.
since the input data is unpredictable in order to reason on the general behavior of composite service it is useful to obtain a local time requirement which could guarantee global time requirement for any input data.
for example given conditional expression pcbbq the execution of activity por activity qis based on the valuation of b but if we choose to abstract from data either porqwill be executed non deterministically.
a state of the lts represents a status of the composite service.
informally a concrete state is a state that contains data information and the lts that contains concrete state is denoted as concrete lts.
an abstract state is a state which abstracts away data information and the lts that contains abstract state is denoted as abstract lts.
our dynamic analysis is based on the abstract lts.
in the following we provide the formal definition of various terminologies that are used in this work.
definition parameterized composite service model a composite service model mis a tuple var v0 u p0 c0 where varis a finite set of variables v0is an initial valuation that maps each variable to its initial value uis a finite set544of parameters p0is the composite service process and c0is the initial constraint.
given a service model m with a parameter set u fu1 umg and given a parameter valuation u1 um m denotes the instantiation ofm with viz.
the model var v0 u p0 c where cisc0 vm i ui ui .
note thatm is a non parametric service model.
definition concrete labeled transition system a concrete labeled transition system is a tuple lc sc sc c where scis a set of concrete states sc 02scis the initial state is the universal set of actions c sc scis a transition relation.
aconcrete state s cis represented as v p c d where vis a valuation of the variables i.e.
a function that maps a variable name to its value pis a composite service process cis a constraint overcx and dis the real valued duration from the initial state s0to the beginning of the state s. definition abstract labeled transition system anabstract labeled transition system is a tuplel s s0 where sis a set of abstract states s02sis the initial state is the universal set of actions s sis a transition relation.
anabstract state s is represented as p c d where pis a composite service process cis a constraint over cx u and dis the parametric duration from the initial state s0to the beginning of the state s i.e.
a linear term on the parameters .
henceforth we refer to an abstract state resp.
abstract lts as a state resp.
lts as long as it is clear from the context.
the following definitions could be easily extended to concrete states and concrete ltss.
given an lts l s s0 a state s2sis said to be a terminal state if there does not exist a state s02sand an action a2 such that s a s0 otherwise sis said to be a non terminal state .
there is a runfrom a state sto state s0 where s s02s if there exist a set of statesfs1 sng sand a sequence of actions ha1 ani where ai2 such that s1 s sn s0 and 8i2f1 n 1g si ai si .
acomplete run is a run that starts in the initial state s0and ends in a terminal state.
given a state s2s we use enable s to denote the set of states reachable from s formally enable s fs0js02s a2 s a s0 g. given a state s p c d we use the notation s pto denote the component pofs and similarly fors cands d. givenm var u p0 c0 the global time requirement formrequires that for every state p c d reachable from the initial state p0 c0 in the lts the constraint d tg is satisfied where tg2r 0is the global time constraint .
the local time requirement requires that if the response times of all component services of msatisfy the local time constraint c l2c u then the service ssatisfies the global time requirement.act a s x a s x a1 act mpick x mpick x a2 act a s x0 x a s x0 a3 act mpick x0 x mpick x0 a4 act p q x act p x act q x a5 act po 9q x act p x o 9q a6 fig.
.
activation function where a2frec sinv ainv replyg 2fjjj cbbg and mpick pick s pt alrm a pa iv.
d ynamic analysis with lts our approach for synthesizing local time constraint for component services is based on the dynamic analysis of the constraint of each state in the lts of the composite service m. in this section we present how we analyze the lts with real time semantics using parametric techniques.
in order to analyze the lts with real time semantics we use clocks to record the elapsing of time.
the clock formalism has been used to record the time elapsing in several formalisms in particular in timed automata ta .
in tas the clocks are defined during the modeling phase and once created are never discarded.
it is known the the state space of the system could grow exponentially with the number of clocks.
an alternative approach is to create clocks on the fly when necessary and have them pruned when no longer needed.
this allows smaller state space compared to the explicit clock approach we refer to this second approach as implicit clock approach .
we use the implicit clock approach when analyzing the bpel model with ltss.
a. clock activation clocks are implicitly associated with timed processes.
for instance given an action sinv s a clock starts ticking once the process becomes activated.
to introduce clocks on the fly we define an activation function actin fig.
.
given a process p we denote by pxthe corresponding process that has been associated with clock x. the activation function will be called when a new state sis reached to assign a new clock for each newly activated communication activity.
rules a1 and a2 state that a new clock is associated with bpel communication activity if it is newly activated.
rules a3 and a4 state that if a bpel communication activity has already been assigned a clock it will be never reassigned.
rules a5 and a6 state that function actis applied recursively for activated child activities for bpel structural activities.
b. idling function given a state s we define function idle to calculate how long the activity acan idle in state s. the result is a constraint over the clocks and the parameters.
rule i1 states the situation that the communication required to wait for the response of component services s and states the value of clock xmust not be larger than the response time parameter tsof the service.
rule i2 states that the situation that no waiting is required.
rules i3 to i5 state that the function idleis applied recursively for activated child activities of a bpel structural activity.545idle a s x x ts i1 idle b s x x i2 idle p q idle p idle q i3 idle po 9q idle p i4 idle mpick x x ts x a i5 fig.
.
idling function where a2frec sinvg b2fainv replyg 2fjjj cbbg mpick pick s pt alrm a pa and tsis the parametric response time of service s we define an undesired scenario that the user does not want to end in.
in case of the smis example it corresponds to a situation where both component services fsand psfail to response within one second.
given a bpel service m in order to be able to classify the desired and undesired scenarios we allow the user to annotate a bpel activity aas a bad activity denoted by bad.
the annotation can be achieved for example by using extension attribute of bpel activities.
the execution of activity badwill result the lts of mto end in an undesired terminal state which we denote as a bad state .
the terminal state which is not a bad state is called agood state .
the synthesized local time constraint needs to guarantee the avoidance of all bad states and the reachability of at least one good state.
c. state space exploration lety hx0 x1 i be a sequence of clocks.
starting from the initial state s0 p0 c0 we iteratively construct successor states as follows.
given a state p c d a clock x which is not currently associated with pis picked from y. the state p c d is transformed into act p x c x d i.e.
timed processes which just become activated are associated with xandcis conjuncted with x .
then a firing rule is applied to get a target state p0 c0 d0 such that c0be satisfiable otherwise the transition is infeasible .
note that for the sake of conciseness firing rules are not introduced here they encode the semantics of bpel and are straightforward.
lastly clocks which do not appear within p0are pruned from c0.
observe that one clock is introduced and zero or more clocks may be pruned during a transition.
actually a clock is introduced only if necessary if the activation function does not activate any subprocess this new clock is not created.
d. application to an example consider composite service m which is a fraction of the smis of section ii.
the lts of mis shown in fig.
.
at state s0 activation function assigns clock xto record time elapsing of pick activity mpick and the tuple becomes mpick x true .
from state s0 it could evolve into state s1if the constraint c1 x tps idle mpick x where idle mpick x x tps x is satisfiable.
intuitively c1 denotes the constraint where tpstime units elapsed since clock xhas started.
in fact constraint c1is satisfiable for example with tps 5andx .
therefore it could evolve into state s1 rgood x tps x tps .
sinces0 mpick true s1 rgood tps tps s3 stop tps tps xs2 rbad tps s4 stop tps fig.
.
lts of service m where mpick pick ps rgood alrm rbad rgood reply user rbad bad and tpsis the parametric response time of service ps clock xis not used anymore in s1 pwhich is rgood it is eliminated using variable elimination techniques such as fourier motzkin .
after elimination of clock variable xand simplification of the expression state s1becomes rgood tps tps .
from state s0 it could also evolve into state s2 if the constraint c2 x idle mpick x where idle mpick x x tps x is satisfiable.
it is easy to see that c2is satisfiable we now have state s2 rbad tps .
from state s1 activation function assigns clock x0for reply activity rgood and the reply activity becomes rgood x0.
it could evolve to state s3 if the constraint c3 tps idle rgood x0 where idle rgood x0 x0 is satisfiable.
in fact it is with the similar reason as previous cases and it evolves into terminal state s3 stop tps tps where stop is an activity that does nothing.
since the terminal state is due to a good activity s3is considered as a good state denoted by x. from state s2 it could also evolve into terminal state s4 stop tps .
since the terminal state is due to the bad activity it is considered as a bad state denoted by .
v. c onstraint synthesis using aolts in this section given a global time constraint tgfor service s we present an approach to synthesize local time constraint clbased on the lts.
we show that if response times of all component services of ssatisfy the local time requirement the service swould end at a good state regardless of the values input by the user.
a. and activity and or activity to synthesize a better constraint that allows larger sets of feasible composition we first characterize the bpel structural activities.
we divide the structural activities into and activities and or activities.
an and activity is non deterministic in the abstract lts but deterministic in the concrete lts an example is the if activity.
consider the abstract lts of a service s var v0 u p0 c0 that has var fag v0 fa7!1g u ftgandp0 aca 1bbwhere aandbare bpel processes and c0 true .
the global time requirement for service srequires that the service must complete within four546s0 aca 1bb true s1 a true sn stop t t xs2 b true sn stop t t x fig.
.
abstract ltss0 fa7!1g aca 1bb true s1 fa7!1g a true sn fa7!1g stop t t x fig.
.
concrete lts seconds.
the abstract lts of service sis shown in fig.
.
the initial state s0has two branches due to the non determinism of the abstract lts for the conditional activity.
assume sn andsnare the only two good states that could be reached from execution of s1and s2respectively.
given constraint c1 sn c sn d t 2and constraint c2 sn c sn d t the result c1 c2 viz.
t will guarantee the reachability of a good state within four seconds in the abstract lts.
nevertheless in the concrete lts as shown in fig.
the result would be incorrect since for example t would not satisfy the constraint of the only good state sn 1in the concrete lts.
the reason is that the transition caused by the and activity in the abstract lts could be missing in the concrete lts therefore we must conjunct the constraint to guarantee it could reach state sn in the concrete lts.
in our example the correct local time requirement would be c1 c2 which is t .
if a structural activity is not an and activity it is classified as an or activity.
the transition caused by an or activity in the abstract lts could not be missing in the concrete lts.
examples of or activities include flow pick and sequence .
b. and or lts since a bpel composite service contains a hierarchy of and activities and or activities we extend the lts with and or states to facilitate the conjunction and disjunction of constraints in the hierarchical activities.
we denote the lts that has been extended with and or state as and or labeled transition system aolts .
definition and or labeled transition system an and or labeled transition system aolts is a tuple lao sao s0 ao where sao s fand org sis a set of abstract states s02sis the initial state is a set of symbols and ao sao saois alabeled transition relation .
we call a state s2sa normal state to differentiate from andstates and or states.
a non terminal normal state is said to be aninter state .
fig.
shows the lts of a composite service s that contains an and activity a1 i2cb 1b bad inside an or activity a2 i1jjja1 where ijdenotes sinv sj such thatsjis a component service with parametric response time tj for j2f1 3g.
the aolts of composite service sis shown in fig.
.
given the global time constraint tg let ci si c si d for i2 f4 6g the local time requirement for composite service s is c4 c5 c6 .s0 i1jjj i2cb 1bi3 true s1 i1 t1 t2 t1 t3 t1 s4 stop t1 t2 t1 t3 t1 xs2 i2 t2 t1 t2 t3 t2 s5 stop t2 t1 t2 t3 t2 xs3 i3 t3 t1 t3 t2 t3 s6 stop t3 t1 t3 t2 t3 x fig.
.
lts of composite service s s0 or s1 s4and s2 s5s3 s6 fig.
.
aolts of service ss0 or s1 s4and s2 s5s0 s0 fig.
.
bad state propagation c. bad state propagation consider now we change the definition of i3in fig.
as bad and we have state s0 s0 3ands0 6where state s0 is a bad state.
let ci si c si d tg for i2f4 5g a plausible synthesis solution on the local time requirement for composite service swould be c4 c5 s0 c. given ft17!
t27!
t37!3g and variable b this might be resulting in a situation where no good state is reachable.
in order to avoid this situation we apply bad state propagation .
it works by propagating the bad status to the parent as described below.
if the current state is a terminal bad state propagate the bad status to the parent if the current state is an or state sor and all states in enable sor have a bad status then marks sorwith a bad status and propagate the bad status to the parent state otherwise do nothing if the current state is an and state sand and if there exists a state in enable sand that has a bad status then mark sandwith a bad status and propagate the bad status to the parent state otherwise do nothing if the current state is an inter state and if the unique successor state succ s has a bad status then mark swith a bad status and propagate the bad status to the parent state otherwise do nothing.
consider the example in fig.
.
the bad state status of s0 would propagate up to the and state.
therefore the current constraint is c4 s2 c s0 c .
d. the algorithm for synthesis of local time requirement algorithm presents the main algorithm for synthesizing the local time constraint.
given a state s synconsaolts s returns a constraint tuple cswhich is a tuple b c where b2b andc2c u. given constraint tuple cs we use cs first to refer the first component of cs and cs second to refer the second component of cs.
in the following we define notions that are used in algorithm .
given a fc1 cng c u we denote547algorithm algorithm synconsaolts s input state sof lts output the constraint tuple for lts that starts at s 1ifs is good state then return true s c s d tg 3ifs is bad state then kbad kbad s c return false ?
6cs fsynconsaolts s0 js02enable s g 7ifs is or state then iftrue2d jcsj then return true wfc secondjc2cs c first trueg else return false ?
12ifs is and state then iffalse2d jcsj then return false ?
else return true vfcjc2r jcsj 17ifs is inter state then ifcs first true then return true cs second else kbad kbad s c return false ?
algorithm algorithm localtimeconstraint s0 input initial state s0 output the local time constraint cl 1s synconsaolts s0 2ifs first true then return kbad s second 4else return false byvathe conjunction of constraints in a i.e.
c1 cn.
similarly we denote bywathe disjunction of constraints in a i.e.
c1 cn.d jcsj denotes the set of elements in the domain of cs formally fb bj9c2c u b c 2csg.
r jcsj denotes the set of element in the range of cs formally fc cuj9b2b b c 2csg.
if a set csis known to contain exactly an element cs1 we use cs to denote that particular element cs1.
furthermore kbadis a static variable of type cu that is used to collect the negation of the constraint associated to states that are marked with a bad status lines and .
finally tgis the given global time constraint of a service s.s0 s true s1 rgoodcbba1 true ds s2 and s3 a1 true ds s4 rgood true ds s5 p1 true ds s6 stop true ds x s7 or s8 a2 fs ds s9 rgood fs ds fs s10 p2 fs ds s11 stop fs ds fs x s12 or s13 rbad ps fs ds s14 rgood ps fs ds ps s15 stop ps fs ds s16 stop ps fs ds ps xsinv ds and ainv fs reply user oalrm 1omsg fs ainv ps reply user oalrm 1omsg ps reply failure reply user fig.
.
lts of the smis where s sinv ds o 9rgoodcbba1 a1 ainv fs o 9p1 p1 pick fs rgood alrm a2 a2 ainv ps o p2 p2 pick ps rgood alrm rbad rgood reply user rbad bad in algorithm lines and are used for the purpose of bad state propagation as described in section v c. lines and are used for synthesizing the local time constraint with conjunction and disjunction operation.
given a constraint tuple cs synconsaolts s if state sis marked with a bad status during bad state propagation then cs first false otherwise cs first true.
algorithm is the entry algorithm that returns the local time constraint given initial state s0of a service s. if s0is not marked with a bad status then it returns the local time constraint otherwise it returns false i.e.
there is no parameter valuation for component services that could possibly satisfy the local time requirement of service s. e. application to the running example fig.
shows the aolts of the running example introduced in section ii.
algorithm localtimeconstraint is used to synthesize the local time constraint for smis based on the aolts.
the local time constraint is simplified and convert to disjunctive normal form dnf by using z3 and the local time constraint of the running example is tfs tds tds tfs tps tds tfs tds tfs tps tds tfs tds tps this result as a whole provides us useful information regarding how the component services collectively satisfy the global time constraint.
that is of most importance for selecting component services.
by observing the conjuncts of dnf we can extract useful information as well.
for example tps tds tfs tds tps conveys to us that if the free service fstakes more than one second to548response and if the database service dsis fast enough e.g.
it is a service over local network then we need a paid service psthat responds in less than one second in order for the smis to fulfill the global time constraint.
f .
soundness in the following we assume that all loops have a bound on the number of iterations and the execution time see section v g for discussion .
lemma givenmbe an abstract service model the lts ofmis acyclic.
proof this holds due to the assumption on the loop activities such that the upper bound on the number of iterations and the time of execution is known and there is no recursive activities in bpel.
lemma lets0 snbe a complete run in lts and be a parameter valuation if j sn cthen j si c for all i2f1 n 1g.
proof since there is only conjunction of new constraints refer to section iv c when moving one step to the other.
therefore si c si cfori2f1 ng and the result holds.
theorem soundness of localtimeconstraint given servicem var v0 u p0 c0 k localtimeconstraint m .
let sgood be the collection of good states in sandsbadbe the collection of all bad states ins and.
if kis non empty there is at least a good state sg2sgoodthat is reachable in any concrete lts of m there is no bad state sb2sbadthat is reachable in any concrete lts ofm .
proof before bad state propagation by definition there will have at least an edge from non terminal state.
we show that after bad state propagation all kind of non terminal states and states or states inter states that are not marked with a bad status will have at least an edge that leads to a good state in the abstract lts of m .
for and states and inter states if there exists one child that is marked with a bad status then the and states and normal states should be marked with a bad status line and line .
this means that the and states that are not marked with a bad status have all their transitions preserved in the abstract lts.
therefore regardless which transitions are removed in the concrete lts there is at least one transition left the concrete lts will execute at least one transition .
for the or states if all the child states are marked with a bad status then the or states will be marked with a bad status therefore if they are not marked with a bad status they would have at least one transition left in the abstract state line .
since any concrete lts does not remove the transition from an or state therefore all transitions of an orstate remains.
by lemma since the lts is finite and acyclic it will have at least one of the transitions that ends in the terminal state.
let state sgbe a good state and tgbe the global time constraint by lemma j sg c sg tg implies that j s0 c where s0is any non terminal state in the complete runs between initial state and good statesg.
therefore item holds.
since the result is of the form k1 k2 kn kbad this can be rewritten as k1 kbad k2 kbad kn kbad .
since kbad contains negation of all such reachable bad states therefore all the bad states are non reachable and item holds.
g. discussion we discuss our method and show its advantages and limitations in this section.
termination .
our method is guaranteed to terminate.
this is due to the fact that bpel composite services do not support recursion as well as our assumption on the loop activities such that the upper bound on the number of iterations and the time of execution is known.
we discuss how to enforce such assumption if the loop activities exist.
for the upper bound on the number of iterations it could be either provided by the user or it could be inferred by using loop bound analysis tool e.g.
.
for the maximum time of loop executions this could in fact be enforced by using proper timeout mechanism in bpel.
time for internal operations .
for simplicity we do not account for the time taken for the internal operations of the system.
in reality the time taken by the internal operations might be significant especially when the process is large.
in order to provide a more accurate synthesis of time constraint an additional constraint toverhead b where toverhead2r 0is a time overhead for an internal operation and b2r 0is a machine dependent upper bound for toverhead could be included for more precise analysis.
the method in estimation of bis not the focus of this work the interested reader may refer to e.g.
.
completeness .
a limitation of the method is that it is incomplete i.e.
it does not include all parameter valuations that could give a solution to the problem of the local time requirement.
the method could also return an empty constraint although there exists parameter valuation that satisfies the solution.
this can be seen as a tradeoff of making the synthesized local time requirement more general i.e.
to hold in any composite service instances.
consider the conditional case ac1 1bb where activity ais always executed but activity bis never executed.
since our method is completely abstracted from data the constraint of executing activity a as well as activity b are both considered but in fact only activity aneeds to be considered therefore our method has discarded some feasible parameter valuation in this case.
in practice such situation could be mitigated by proper program analysis method.
vi.
r elated work this work shares common techniques with work for constraint synthesis for scheduling problems.
the use of models such as parametric timed automata pta and parametric time petri nets tpns for solving such problems has received recent attention.
in particular in parametric constraints are inferred guaranteeing the feasibility549of a schedule using ptas with stopwatches.
in we extended the inverse method see e.g.
to the synthesis of parameters in a parametric timed extension of csp.
although ptas or tpns might have been used to encode part of bpel language our work is specifically adapted and optimized for synthesizing local timing constraint in the area of service composition.
the quantitative measure of the robustness of concurrent timed systems has been tackled in different papers see for a survey .
however most approaches consider a single dimension transitions can usually be taken at most before or after units of time from their original firing time.
this can be seen as a ball in jujdimensions of radius .
in contrast our approach quantifies robustness for all parameter dimensions in the form of a polyhedron in jujdimensions.
our method is related to using lts for analysis purpose in web services.
in the author proposes an approach to obtain behavioral interfaces in the form of lts of external services by decomposing the global interface specification.
it also has been used in the model checking the safety and liveness properties of bpel services.
for example foster et al.
transform bpel process into fsp subsequently using a tool named as ws engineer for checking safety and liveness properties.
simmonds et al.
proposes a userguided recovery framework for web services based on lts.
our work uses lts in synthesizing local time requirement dynamically.
our method is related to the finding of a suitable quality of service qos for the system .
the authors of propose two models for the qos based service composition problem model the service composition problem as a mixed integer linear problem where constraints of global and local component serviced can be specified.
the difference with our work is that in their work the local constraint has been specified whereas for ours the local constraints is to be synthesized.
an approach of decomposing the global qos to local qos has been proposed in .
it uses the mixed integer programming mip to find optimal decomposition of qos constraint.
however the approach only concerns for simplistic sequential composition of web services method call without considering complex control flow and timing requirement.
our method is related to response time estimation.
in the authors propose to use linear regression method and a maximum likelihood technique for estimating the service demands of requests based on their response times.
has also discussed the impact of slow services on the overall response time on a transaction that use several services concurrently.
our work is focused on decomposing the global requirement to local requirement which is orthogonal to these works.
vii.
e valuation here we report about the evaluation of our approach using two case studies.
each case study consists of a service composition in the form of a bpel process.
the experiment data were obtained on a system using intel core i5 2410m cpu with 4gb ram.a.
computer purchasing services the goal of the computer purchasing service cps e.g.
dell.com is to allow a user to purchase the computer system online using credit cards.
cps makes use of five component services namely shipper service ss logistic service ls inventory service is manufacture service ms and billing service bs .
the global time requirement of the cps is to response within three seconds.
cps starts upon receiving the purchase request from the client with credit card information and cps spawns three workflows viz.
shipping workflow inventory workflow and billing workflow concurrently.
in the shipping workflow the shipping service provider is invoked synchronously for the shipping service on computer systems.
upon receiving the reply ls which is a service provided by internal logistic department is invoked synchronously to record the shipping schedule.
in the manufacture workflow is is invoked synchronously to check for the availability of the goods.
subsequently ms is invoked asynchronously to update the manufacture department regarding the current inventory stock.
in the billing workflow the billing service which is offered by third party merchant is invoked synchronously for billing the customer with credit card information.
the aolts of this system contains states and transitions.
the time taken for the synthesis with the simplification to dnf takes seconds.
the local time constraint for cps contains a disjunction of conjuncts in the dnf that are given below.
tss tls tis tis tbs tss tls tis tbs tss tls tbs tbs tis tss tls tis tbs tss tls tbs tss tis tis tss tls tss tls tis tbs tss tis tis tbs tbs tss tls tss tls tis tbs tss tls tis tss tbs tbs tss tls tss tls tis tbs tss tbs tbs tis tis tss tls tss tls tis tbs tss tls tbs tis tss tss tls tis tbs tss tbs tis tbs tbs tss tls tss tls tis tbs tis tbs tbs tss tss tls tis tbs tss tls tis tbs tss tss tls tis tbs tss tis tbs tss tis tss tls tss tls tis tbs tis tss tbs tis tss tls tis tbs note that tmsdoes not appear in the local time constraint for cps.
the reason is that ms is invoked asynchronously without expecting a response therefore its response time is irrelevant to the global time requirement of cps.
given each service with their maximum response time as a constraint e.g.
c1 tis tls tss tbs and the local time constraint cl it is useful to know whether c1is included in cl.
this can be checked automatically using smt solver such as z3 and concluded that c1is included incl.
b. travel booking service the goal of a travel booking service tbs such as booking.com is to provide a combined flight and hotel booking service by integrating two independent existing services.
tbs provides an sla for its subscribed users saying that it must respond within three seconds upon request.
the travel booking550system has five component services user validation service vs flight service fs backup flight service fs bak hotel service hs and backup hotel service hs bak .
upon receiving the request from users tbs spawns two workflows viz.
a flight request workflow and a hotel request workflow concurrently.
in flight request workflow it starts by invoking fs which is a service provided by a flight service booking agent.
if service fs does not respond within two seconds then fs is abandoned and another backup flight service fs bakis invoked.
if fs bakreturns within one second then the workflow is completed otherwise it is considered as a failure for the flight request workflow.
the hotel request workflow shares the same process as the flight request workflow by replacing fs with hs and fs bakwith hs bak.
the resulting aolts has states with transitions and it takes .
seconds for synthesizing the constraints and simplify the constrains into dnf.
the local time constraint for tbs contains a disjunction of conjuncts in the dnf that are shown below.
thsbak tfsbak tfs ths tfs thsbak 2ths tfs thsbak tfsbak tfs ths ths thsbak tfsbak ths tfs tfsbak ths ths 2tfs thsbak tfsbak tfs ths tfs thsbak tfs ths tfs thsbak tfs 2ths thsbak tfs tfs ths ths ths 2tfs thsbak tfs tfs ths tfs 2ths ths tfsbak tfs ths ths tfsbak tfs tfsbak ths ths 2tfs ths tfsbak tfs ths tfs tfs 2ths ths tfs tfs ths ths 2tfs ths tfs tfs ths note that the constraint contains inequalities such as ths .
this could be counterintuitive as it asserts the response time of hotel service be larger than .
this inequality is introduced by for example the pick activity refer to state s4infig .
but one should view the local time constraint as whole i.e.
view it as all possible sets of parameter valuations that could satisfy the constraint.
viii.
c onclusion and future work we have presented a novel technique for synthesizing the local time requirement for the component services of a composite service s knowing its global time requirement.
our approach is based on the dynamic analysis of the aolts of a composite service by making use of parameterized timed techniques.
the synthesis algorithm conjuncts and disjuncts the constraint of all good states in the aolts to synthesize a local time constraint for component services.
we have implemented the approach in the pat tool and applied it to two case studies.
we plan to further improve and develop the technique presented in this paper.
first we will consider various heuristics that could be used to reduce the number of states and transitions.
second we will investigate the combination of our approach with other approaches such as the inverse method to evaluate the possibility of synthesizing a betterlocal time requirement.
last we could extend our current approach to other domains that share similar problems for example sensor networks.