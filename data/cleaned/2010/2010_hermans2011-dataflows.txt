supporting professional spreadsheet users by generating leveled dataflow diagrams felienne hermans delft university of technology f.f.j.hermans tudelft.nlmartin pinzger delft university of technology m.pinzger tudelft.nlarie van deursen delft university of technology arie.vandeursen tudelft.nl abstract thanks to their flexibility and intuitive programming model spreadsheets are widely used in industry often for businesscritical applications.
similar to software developers professional spreadsheet users demand support for maintaining and transferring their spreadsheets.
in this paper we first study the problems and information needs of professional spreadsheet users by means of a survey conducted at a large financial company.
based on these needs we then present an approach that extracts this information from spreadsheets and presents it in a compact and easy to understand way with leveled dataflow diagrams.
our approach comes with three different views on the dataflow that allow the user to analyze the dataflow diagrams in a top down fashion.
to evaluate the usefulness of the proposed approach we conducted a series of interviews as well as nine case studies in an industrial setting.
the results of the evaluation clearly indicate the demand for and usefulness of our approach in ease the understanding of spreadsheets.
categories and subject descriptors h. .
office automation spreadsheets d. .
design tools and techniques flowcharts general terms design experimentation human factors languages keywords data flow diagrams visualization spreadsheets end user programming work partially done while at the computer human interaction and software engineering lab chisel department of computer science university of victoria canada.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
icse may waikiki honolulu hi usa copyright acm ... .
.
.
introduction spreadsheets are widely used in industry winston estimates that of all analysts in industry perform calculations in spreadsheets.
their use is diverse ranging from inventory administration to educational applications and from scientific modeling to financial systems.
the financial business is a domain where spreadsheets are especially prevailing.
panko estimates that of u.s. firms and in europe use spreadsheets in some form for financial reporting.
business analysts using spreadsheets usually have very limited if any training as a programmer.
in spite of that they effectively are end user programmers and as such face many of the challenges of professional developers such as identifying faults debugging or understanding someone else s code .
this paper aims at providing support for spreadsheet users to take on these end user programming challenges.
to that end we first study the problems and information needs of professional spreadsheet users and then present an approach that presents this information in a compact and easy to understand way with leveled dataflow diagrams.
the context in which we conduct our research is formed by the analysts of robeco a dutch asset management company with approximately employees worldwide and overe130 billion worth of assets under management.
in a survey we conducted among of their analysts we found that they use excel for an average of hours a day underlining the large role spreadsheets play in their daily work.
furthermore spreadsheets have an average lifetime of more than five years and individual spreadsheets are used by different analysts on average.
in order to support analysts in their work with spreadsheets we start by identifying information needs .
in particular we describe how we conducted interviews with the same group of analysts using a grounded theory approach to obtain understanding of their use of spreadsheets.
in the interviews spreadsheet transfer scenarios to a new user to an auditor and to a professional developer creating custom software were identified as problematic.
in those scenarios end users search for a better insight into the dependencies between cells formulas groups of cells and worksheets.
to meet these demands we propose an approach for the automated extraction of dataflow diagrams from spreadsheets.
such diagrams can be used to visualize data processes manipulating data and dependencies between them.
furthermore leveled diagrams can be used to accommodate hierarchies for example for blocks of cells or worksheets.permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
icse may waikiki honolulu hi usa copyright acm ... .
451we implemented our approach in a tool called gyrosat which can generate dataflow graphs from excel spreadsheets.
to evaluate our approach we conducted a series of evaluations in the concrete setting of robeco.
first we interviewed the same group of spreadsheet users analyzing how the tool could help in transferring their own spreadsheets to colleagues.
furthermore we conducted nine case studies three for each type of transfer task identified.
the findings of these evaluations indicate that spreadsheet professionals from robeco consider the tool as helpful the visualizations derived help to create a story line to explain spreadsheets to colleagues in transfer tasks the visualizations scale well to large and complex spreadsheets in use at robeco.
this paper is organized as follows.
in section we describe the interviews leading to the information needs of spreadsheet users.
then in section we provide background information on dataflow diagrams after which we describe our algorithm to derive dataflow diagrams in sections and .
in section we cover our implementation which we use in the evaluation described in section .
we conclude with a discussion of our results an overview of related work and a summary of our contributions and directions for future research.
.
spreadsheet information needs to gain understanding of the problems around spreadsheet usage we conducted a survey at robeco.
robeco is a dutch asset management company with approximately employees worldwide of which work in their headquarters in rotterdam where we performed our survey.
the survey was conducted following the grounded theoryapproach.
grounded theory is a qualitative research method that discovers theory from data .
when using grounded theory observations are documented and subsequently coded into categories.
during this coding process that takes place after each observation as opposed to after all observations a theory might emerge .
grounded theory is a method especially suited for discovering problems that exist for the participants.
therefore in a grounded theory study the researcher works with a general area of interest rather than with a specific problem .
the area of interest in our study is the use of spreadsheets in industry.
to investigate this area we conducted a survey amongst employees of robeco using semi structured interviews.
for each interview we kept a memo of statements questions asked and answers provided by the employee.
following the grounded theory approach we continuously analyzed the memos of each day and used the results to direct the following interviews.
a total of employees was invited to participate in the survey with varying spreadsheet knowledge and expertise working in different departments making it a maximum variation sample .
of the invitees participated in the interviews.
the interviews were performed over a time period of weeks with or interviews per day.
we started the interviews by asking subjects about the role of spreadsheets in their daily work and let subjects tell their own story.
during the course of the first interviews many subjects stated that problems with spreadsheets occur in spreadsheet transfer scenarios .
in such a scenario a spreadsheet is transferred from one employee to another for instance when anemployee leaves the company and a colleague has to start working with his spreadsheet.
from that point on we started asking subjects in interviews whether they experienced such scenarios.
we found that the vast majority agreed that they often transferred spreadsheet to a colleague.
we coded all described scenarios into the following three categories s1a spreadsheet has to be transferred to a colleague.
this scenario typically occurs when for example a new employee starts working for the company an employee leaves the company or when a new spreadsheet is created that has to be used by an other employee.
s2a spreadsheet has to be checked by an auditor.
auditing periodically happens at large companies to determine whether spreadsheets in key processes are well designed error free and well documented.
s3a spreadsheet is being replaced by custom software.
when a spreadsheet created by an end user becomes so complex that it no longer complies to standards in the company such as safety access control or readability it is transformed into a custom software system.
to determine ways to support users in these scenarios we dived deeper into the problems occurring during a transfer scenario.
as it turns out problems typically occur when the receiving employee has too little understanding of the spreadsheet.
the most of the subjects expressed that they had difficulties with understanding a spreadsheet they received from a colleague.
zooming in even further we identified information needs spreadsheet receivers have from the stories we heard about the problems during a transfer.
we then analyzed the memos and coded them into the following four categories with the percentage of memos mentioning one of the information needs in parentheses .
i1how are the different worksheets spreadsheet tabs related?
i2where do formulas refer to?
i3what cells are meant for input?
i4what cells contain output?
these results show that the most important information needs of professional spreadsheet users concern the structure of the formula dependencies.
users indicated that the only way they can find these dependencies currently is by using the excel audit toolbar.
this excel feature that shows cell dependencies within one worksheet by overlaying the worksheet with a dependency graph insufficiently meets these needs.
firstly this graph becomes incomprehensible quickly when arrows cross each other as shown in figure .
furthermore it has to be enabled cell by cell making it impractical for large spreadsheets.
finally it is not able to show dependencies between worksheets.
underlining the importance of spreadsheets at robeco were the answers to the final question about the nature of the tasks performed with spreadsheets.
we classified these answers into three categories 452figure a spreadsheet in excel with the audit toolbar enabled.
presentation of data for instance to show data to colleagues or customers.
calculations without a direct decision for instance calculating the performance numbers of a portfolio to put in a brochure.
calculations to base decisions on for instance calculating the stocks that are generating the lowest profit to remove them from a portfolio.
these numbers show many spreadsheets within robeco play a key role in decision making within the company.
.
background before presenting how we support professional users information needs we provide a brief overview of the preliminaries this paper builds upon.
.
dataflow diagrams dataflow diagrams or similar techniques for representing the flow within systems such as flowcharts have been present in literature since the seventies .
dataflow diagrams show how data moves from one process to another and illustrate the relationship of processes and data in an information system.
we follow the definition of de marco who recognizes the following four types of objects rectangles representing entities which are sources or sinks of data rounded rectangles representing processes which take data as input perform an operation on the data and yield an output value open ended rectangles representing data stores arrows representing the dataflow between objects figure shows an example of a data flow diagram for a simple order system in which we can recognize a process process order that takes data from entities client data and books db and outputs its data to entity delivery system and to data store order history .
figure a data flow diagram for a simple order system.
.
leveled dataflow diagrams a key element in data flow diagrams is the ability to represent a hierarchical decomposition of a process or function using what de marco calls a leveled data flow diagram .
higher levels are used to abstract the details from lower levels.
the lower levels containing the details are revealed by expanding an entity at a higher level.
by collapsing the entity the details are hidden again.
.
dataflow diagram extraction algorithm from our analysis of the interviews we concluded that professional spreadsheet users often have difficulties with understanding spreadsheets received in transfer scenarios.
we propose to support users in those scenarios by visualizing the structure and contents of a spreadsheet as a leveled dataflow diagram.
dataflow diagrams are commonly used and well understood by spreadsheet end users.
they show the dependencies between cells in the spreadsheet grouped in levels for worksheets and data blocks.
in the following we present our approach to derive leveled dataflow diagrams from spreadsheets.
the approach consists of six steps which are outlined in figure .
the first two steps originate from our earlier work extracting class diagrams from spreadsheets .
the first step determines the cell type of all cells in the spreadsheet which can be data formula label orempty section .
.
the second step identifies data blocks within a spreadsheet as described in section .
.
in the third step labels describing data and formula cells are computed section .
.
the fourth step generates an initial dataflow diagram by creating entities for cells of type data and formula and creating arrows corresponding to formula dependencies.
details on the dataflow creation can be found in section .
.
in the fifth step the labels of cells that were computed in step are attached to the corresponding entities in the diagram section .
.
the final step adds the levels to the dataflow diagram.
a level is introduced for each worksheet within the spreadsheet and for each data block within every worksheet section .
.
.
cell classification to distinguish between different cell types we use a cell classification strategy based on the one described by abraham and erwig .
this algorithm starts with identifying all cells containing a formula and marking them as type formula.
next the content of the formulas is inspected.
cells that are referred to in a formula are marked data unless they were already typed as formula in the first step.453all cells that did not get a type in these two steps are recognized as label when not empty and empty otherwise.
applying this algorithm to the example in figure results in the colored spreadsheet.
the orange cells of the columns exam and lab are marked data cells.
the green cells of the column overall are marked formula cells.
the remaining gray cells are marked label cells.
.
identifying data blocks a data block is defined as a rectangle containing a connected group of cells of type data label orformula .
two cells are connected if they touch each other horizontally vertically or diagonally.
to find such a data block the following strategy is applied find the left most upper most non empty cell that is not yet contained within a data block.
the initial data block is set to contain only this cell.
next this data block is expanded by inspecting all cells that are connected to the data block in all directions.
if one of these cells is non empty the data block is enlarged to include this cell.
expanding is done until all cells next to the data block are empty.
in the example in figure the cells are grouped into one data block at a1 e7.
.
name resolution in this step names are resolved for cells of type data and formula .
to determine the name of such a cell we consider the data block in which it lies.
we assume the name of the cell can be found on the borders of this data block as illustrated by the rectangle in the third spreadsheet of figure .
the name of a cell is constructed of two parts a horizontal part the first label in the row in which the cell lies and a vertical part the first label in the corresponding column.
the algorithm for localizing the vertical part for a cell cis as follows it starts with inspecting the first cell of the column in which clies.
if this cell is of type label the value of the cell is set as the vertical part of the name.
if the cell is of type formula ordata the procedure is ended without having a vertical part for c. if the cell is of type empty the algorithm continues with inspecting the next cell in the column.
the algorithm is repeated until either a formula ordata cell is encountered or the position of the cell for which the name is computed is reached.
the procedure for computing the horizontal part of the name is similar.
once the two parts are found the name of a cell is constructed by concatenating the names of the two parts.
if the name is empty the algorithm uses the location of the cell such as b5 as name.
referring to our example in figure the calculation of the vertical part of the name for cell c4 starts at c1 which is empty.
next c2 is inspected where the name part exam is found.
for the horizontal part the algorithm obtains the name richard griffin resulting in the final name exam richard griffin for cell c4.
the name resolution is heuristic in nature so it is not always able to find a suitable name.
however as we will see in section users participating in our case studies found the names useful.
.
initial dataflow diagram construction to create the initial dataflow diagram we only consider cells of type formula ordata.
for each cell of type formula two objects are created an entity denoting the result of a cell classifica g415on iden g415fying data blocks dataflow construc g415on name resolu g415on name replacement groupingc4 d4 average e4 c4 exam richard griffin d4 lab richard griffin e4 overall richard griffin exam richard griffin lab richard griffin average overall richard griffin data block end result sheet overall exam richard griffin lab richard griffin average overall richard griffin figure overview of the approach for extracting leveled dataflow diagrams from spreadsheets.454formula and a process representing the formula s calculation.
the name for this process node consists of all functions in the formula like sum or .
one arrow is created from the process to the entity.
as can be seen in figure the cell on e4 results in an entity e4 and a process named average showing what is calculated in e4.
for a cell of type data for example c4 only one entity is created.
next the arrows are created if a formula arefers to a cellb an arrow is introduced from the entity of bto the process of a. as shown in figure the entities for data cells c4 and d4 are connected to the process of e4.
.
name replacement in the fifth step of the transformation the names for cells found in the name resolution step are attached to the corresponding entities of the initial diagram.
this is done so dataflow diagrams show the calculations in terms of labels occurring in the spreadsheet in order to make the diagrams easier to understand for end users.
.
grouping the final step groups the entities and processes according to the levels identified in a spreadsheet for data blocks and worksheets.
first a level for each data block is created and entities and processes of the cells in that data block are included in it.
we try to find a name for the data block by inspecting its left most upper most cell if this cell is of type label this label is used as the name of this data block.
if no label can be found the location of the left most upper most cell is used.
subsequently a level for each worksheet is created that contains the levels of its data blocks.
for worksheets the level gets the name the user gave to the worksheet.
referring to our example in figure there is one worksheet sheet overall containing one data block named data block end result .
.
dataflow views having described the generation of dataflow diagrams from spreadsheets in the previous section we turn our attention to supporting users in navigating the diagrams obtained.
we decided to express our diagrams in an existing graph format since several sophisticated graph browsing tools already exist like dot graphml and dgml.
after investigating the available options we decided to use the dgml directed graph markup language an xml schema for hierarchical directed graphs that can be viewed with the graph browser that is part of microsoft visual studio ultimate.
it is intended to visualize software architectures and dependency graphs for systems of around lines of code.
the dgml graph browser offers a number of features that are directly relevant to the dataflow diagrams we derive from spreadsheets.
in particular zooming collapsing and expanding levels the automatic grouping of multiple arrows between entities and processes in one thick arrow and the butterfly mode a feature that slices a graph showing only the nodes that depend on the selected node.
users can also add and remove nodes color nodes and add additional levels with the dgml browser options that proved to be very useful in the experiments.
in the next post managing large graphs.aspxsubsections we will see how we use these features in the three views we support.
as a running example for all these views we use the spreadsheet to calculate exam scores from figure .
this spreadsheet consist of four worksheets and contains cells of which are formulas.
it can be obtained online from our website2together with the generated dataflow diagrams and a screencast showing our approach in more detail.
figure the global view for the exam spreadsheet.
numbers in the upper left corner indicate the number of data blocks within the worksheet.
figure the worksheet main exam expanded to worksheet view.
numbers in the upper left corner indicate the number of cells within the data block.
.
global view the most top level view of the dataflow diagram is the global view .
this view shows all worksheets within the spreadsheet and the relations between them.
an arrow from worksheet ato worksheet bindicates a formula in worksheet b refers to a cell in worksheet a. the dgml browser groups multiple arrows into one so the thicker the arrow is the webhome455more formulas reference cells of an other worksheet.
figure shows the worksheet view of the grades example spreadsheet where formulas in worksheet main exam refer to cells in worksheet participants .
.
worksheet view while examining the spreadsheets we gathered during the initial interviews we noticed that spreadsheet users often structure the contents of a worksheet into data blocks.
these data blocks as well as the dependencies between them are visualized by the worksheet view.
the view is derived from the global view by expanding a level representing a worksheet.
in this way details of a worksheet are revealed while keeping the overall picture of the spreadsheet.
figure shows the worksheet view for worksheet main exam containing the two data blocks questions and results .
the data block results contains formulas that refer to cells in the data block questions .
.
formula view more details about the calculations within a worksheet can be observed in the formula view.
at this level the relation between one specific formula and the cells it depends on is shown.
to obtain this view the user opens a data blocknode in the worksheet view showing all calculations in the data block.
the user can select the formula for which he wants to enable the formula view by using dgml s butterfly mode.
the original data flow diagram is then sliced to show only the entities and processes connected to the selected node.
figure shows the formula view for the calculation of an overall exam score.
.
implementation the visualization of dataflow diagrams is developed as an extension to the existing gyro spreadsheet analysis toolkit gyrosat and is implemented in c .
using visual studio .
gyrosat that is currently implemented as stand alone program parses an excel file identifies formulas blocks and cell names and generates dataflow diagrams according to the algorithm described in section .
the output of gyrosat is an dgml file which can be navigated by means of microsoft visual studio ultimate s built in dgml browser.
.
ev aluation to evaluate the use of dataflow visualization for spreadsheet comprehension we performed two studies.
first we asked all respondents to the initial interviews their opinion on the usefulness of dataflow visualization.
secondly we performed a multiple case study of nine individual case studies in which we observed users working with gyrosat.
the following two subsections describe both studies in more detail.
with these interviews and observations we seek to answer the following research questions.
r1 how does dataflow visualization help users to understand spreadsheets better?
r2 how is our approach able to visualize large and complex spreadsheets?
r3 what are the main limitations of the current approach?with r1 we seek to understand if and why the approach works well via r2 how the approach works in extreme cases and with r3 in what situations the approach does not work well.
both our interviews and the cases aim at addressing all three questions the interviews aim at getting generalizable answers whereas the cases seek to increase realism focusing on actual tasks the analysts had to work on in real life cases.
.
interviews .
.
study design to test the idea of dataflow visualization we asked all respondents of the initial interviews to express their opinion about dataflow diagrams in general.
we interviewed them about this in individual sessions.
during the interviews we first showed them an example of a simple dataflow diagram with only a few entities and processes in one level.
next we showed them a visualization of a more complex spreadsheet which we obtained during the information needs interviews.
we asked them to what extent they were able to understand the given visualization and how they thought these kinds of visualizations could help their work.
.
.
findings during these interviews we found that almost all interviewees understand dataflow diagrams well.
only one of the respondents indicated that he was not familiar with the dataflow notation and that he had trouble understanding it.
all other respondents expressed they feel comfortable using dataflow diagrams.
as one of the respondents stated as analysts we are used to thinking in processes and therefore this kind of diagrams is very natural to us .
with respect to the usefulness of the transformation of spreadsheet visualization to their daily work around out of respondents indicated their work could benefit from these diagrams.
they really outperform the excel audit toolbar because they show the entire view of the sheet one of the respondents answered clearly indicating the benefits of dataflow visualization.
the most positive respondent stated that this tool would make my work times easier .
six respondents indicated problems with the visualization for different reasons.
two subjects found the generated dataflow diagrams complex and said that they needed more time working with the diagrams to determine whether it could help their work.
two other subjects missed information about filtering in the diagrams.
in some cases spreadsheets at robeco are filled with large amounts of data and excel s filter function is used to obtain the needed rows.
this information is not conveyed with the dataflow diagram so for these two participants important information was missing.
the fifth subject liked the idea but preferred a visualization within excel so it would be easier to see the connection between the two.
the final negative respondent indicated his spreadsheets used to keep track of laws and regulations were not critical to the company so it would not be worth the trouble of analyzing them.456figure a detailed calculation of an exam grade in the formula view.
.
case studies .
.
study design to evaluate the use of dataflow visualization in more depth we performed nine case studies three for each transfer scenario.
in each case study two subjects participated an expert the user who has the most knowledge of the spreadsheet and a receiver the user who needs to learn about the spreadsheet.
during the case study they performed a reallife transfer scenario with their own spreadsheet.
there was no time limit to the observation i.e.
we let experts finish their entire explanation.
typically one study took about one hour.
table shows characteristics of the spreadsheets used in the studies the number of worksheets the average minimum and maximum number or rows and columns over all these worksheets the number of non empty cells and the number of formulas.
all experts were somewhat familiar with the generated dataflow diagrams since all of them also participated in the first evaluation study.
therefore we did not provide them with instructions on how to use gyrosat and the dgmlbrowser.
we only intervened in the observation if participants got stuck.
participants were allowed to have a second machine with the spreadsheet on it to point out information about the specifics of the spreadsheet such as layout or diagrams.
they could choose to use both the dataflow diagram and the spreadsheet for supporting their explanation.
before the observation started we asked experts to briefly explain the contents of the spreadsheet and assess how complicated the spreadsheet was according to them.
during the case study we gathered information both by observing subjects and asking them to reflect about the actions they were performing during the course of the study.
we gathered all this information in hand written notes which we used to describe the observations and reactions of the subjects.
with respect to repeatability we unfortunately cannot provide the spreadsheets used in this experiment since they are confidential.
we do give as much information about all other factors of the study to make it as easy as possible for other researchers to perform a similar study.
.
.
findings in this section we describe the most important observations we made during the nine case studies.s1 transferring a spreadsheet to a colleague.
a common observation in all three s1 observations is that experts are surprised by the complexity of their own spreadsheets.
before the actual transfer started they mention the spreadsheet is not very complicated.
however when they see the visualization they realize that it is more complicated then they thought.
in all cases there were some links in the visualization that were not immediately obvious to the experts.
we observed all three experts asking where does this data actually come from?
more than once.
the global view with the graphical layout of the worksheets helps receivers to see what sheet the expert is talking about.
as the receiver in scenario s1c s1c r puts it this really helps me to understand what is what.
experts use the global view to create a logical story line through the spreadsheet.
by starting with for instance the worksheet at the end of the flow they can explain the structure of the computations.
expert s1a e stated that the global view reminds me of the plan i had when building this spreadsheet.
normally i just walk through the worksheets from left to right but that is not the logical way.
there were also differences between the three cases the most significant being that in scenario s1a the spreadsheet also contained a visual basic for applications vba script and the effects of this script are not considered by our approach yet.
the expert in this case clearly thought this was a shortcoming stating because the vba part is missing we only see half of the picture that is a pity.
s2 checking a spreadsheet by an auditor.
all three receivers in this case auditors appreciated the help the visualization provided them especially with acquiring a feeling of how the spreadsheet was built.
as s2a r put it this picture leads me straight to the difficult parts .
normally the only way to finds these parts is to select the cell and track the dependencies with the excel audit toolbar.
subject s2c r agrees with s2a r that the only choice he had when performing a spreadsheet audit was clicking through all the cells a time consuming and tedious process.
subject s2b r furthermore stated that the global view shows him the idea behind the spreadsheet helping him to find errors on a whole new level.
all three subjects felt this tool has the potential to make their work easier.
on the downside s2a r and s2b r indicated that auditors are often interested in relations between the spreadsheet and its environment i.e.
external files the spreadsheet re 457scenario spreadsheet description worksh.
rows col. cells form.
avg min max avg min max s1a shares risk management s1b top and bottom stock performance s1c combining data from different sources for weekly reports16 s2a overview of portfolio data s2b overview of gain and loss of all trades for one week10 s2c constructing a stock portfolio s3a comparison of stock data from two sources4 s3b data on loaned stocks and their dividend date5 s3c calculating which trades to perform in the future18 table summary of spreadsheets used in the nine case studies.
trieves its information from or outputs it results to such as other spreadsheets or databases.
this underlines information needs i3 and i4 although in a manner we did not find during the interviews.
s3 replacing a spreadsheet by custom software.
all s3 receivers stated they understood the experts much better with the use of the dataflow diagrams.
the global view was appreciated since all three expressed that in the software replacing the spreadsheet similar dependencies will exist often what is modeled in a spreadsheet as a worksheet is represented in software by a class.
as s3b r stated this diagram is a basis for the architecture of the software i will build .
in these three cases we again found that the dataflow diagram helped experts to tell their spreadsheet s story.
the top down way of starting with the global view advancing through the detailed worksheet view to the formula view reflects the way experts normally explain the spreadsheet yet is made more tangible by means of the diagrams.
we repeatedly saw how experts use the names of cells and regions in the spreadsheet which are present in the dataflow diagram to explain the sheet in their own terms.
s3a r did point out an additional downside of our approach in industrial spreadsheets one formula sometimes contains multiple calculations.
in our current approach each formula calculation is represented by only one entity making it difficult to see what is calculated in the formula.
note that this is particularly relevant to the s3 scenarios in which the receiver is a software engineer who needs to understand exactly how calculations are performed.
.
conclusions with the results of the interviews and the case studies we are able to answer the research questions.
r1 how does dataflow visualization help users to understand spreadsheets better?
one of the main reasons why dataflow visualization supports a spreadsheet transfer scenario is that the global view provides an overview of the spreadsheet helping the expert to create a story around the spreadsheet.
both experts and receivers feel that the global view reveals the ideabehind the spreadsheet.
the detailed worksheet view supports the top down way in which experts normally explain their spreadsheets.
finally the formula view allows end users to find details of calculationswhen necessary.
the interactive visualization furthermore allows users both experts and receivers to edit the dataflow diagram by adding or removing entities or giving them a specific color so they can customize the diagram to fit their story exactly.
r2 how is our approach able to visualize large and complex spreadsheets?
several of the spreadsheets under study were large see table containing thousands of formulas and dependencies.
to be able to handle industrial spreadsheets of these sizes we introduced levels in the dataflow diagrams and provided three different views on the leveled diagram.
in all nine case studies the global view was found easy to understand even for cases with more than worksheets.
this is probably caused by the fact that spreadsheet users divide a spreadsheet into worksheets and data blocks themselves.
the names for these sheets and blocks are obtained from the spreadsheet helping users understand levels in terms of the underlying application domain.
the formula view shows the calculation for one formula only abstracting away from all other details of the spreadsheet no matter how large it is.
this feature was also appreciated by many receivers especially in scenarios s2 and s3 since there the receivers want to know exactly how formulas are built up.
r3 what are the main limitations of the current approach?
there are some spreadsheet concepts the current implementation cannot handle properly.
for instance visual basic code is not considered in generating the dataflow visualization.
in the observations we noticed that users do see this as a limitation of the current approach as these concepts are important in the spreadsheets.
furthermore our treatment of formulas representing them by just one process works well for smaller ones with few operators but is less helpful for more complex ones.
an option might be to represent a formula as multiple processes for instance representing a b c d with three processes one for and .
we keep this as a point for future work.
for auditors the information needs i3 and i4 where broadened by the case studies in which we found that there is also the need to visualize dependencies between a spreadsheet and it s external data sources .
this can be other spreadsheets but also databases or programs.
the visualization of external spreadsheets with our approach is quite straight forward.
it could be created by introducing an additional filelevel in which we group the worksheet by the file they oc 458cur in and visualize relations between different spreadsheet files based on formula dependencies as before.
the implementation of relationships between a spreadsheet and other types of data sources is a bit more involved so we defer that to future work.
in some cases users would like to see the connection between the dataflow diagram and the original spreadsheet which is not possible with the current implementation.
this need typically occurred when users switched from the global view to the worksheet view.
then they wanted to have a look inside the worksheet to see what region in the spreadsheet corresponded to what data block especially when gyrosat was not able to find a name for a data block.
once they understood the connection they continued their explanation with the support of the dataflow diagram and left the spreadsheet.
.
discussion the current implementation of gyrosat while still a prototype helps users explain their spreadsheet to colleagues in a structured way.
in this section we discuss a variety of issues that affect the applicability and suitability of the proposed approach.
.
meaningful identifiers it is not in all cases possible to find identifiers in the spreadsheet.
in some cases they are simply not present while in other cases the layout of the spreadsheet is too complicated for our name resolution algorithm.
for example when there are empty rows between the names of the columns and the actual data the names will be in one data block and the values will be in another making it impossible for our current naming algorithm to find names for these cells.
a point for future work is the improvement of this algorithm.
note that when names are not present they will obviously never been found.
this might be overcome by allowing users to attach missing names to cells for instance by means of a wizard.
.
spreadsheet comprehension although currently we focus on using our approach for aiding in spreadsheet transfer scenarios we believe this approach is also suited for what we call individual spreadsheet comprehension .
this is a scenario in which one person needs to understand a spreadsheet without someone explaining it.
in future work we will evaluate our approach in this kind of scenarios.
in this type of use of our approach the identification of meaningful identifiers is even more important since there is no expert present to add missing information.
.
threats to validity a threat to the external validity of our evaluation concerns the representativeness of the selected set of employees at robeco and their spreadsheets.
however other papers report on industrial spreadsheet stories similar to the ones we found at robeco so their practice seems to be representable.
furthermore there is a risk of aptitude treatment interaction since all of the initial participants where invited for the second evaluation and it could be the case that only the most positive ones responded to this request.
judging by the number of points of criticism in the second evaluation this seems not to be the case here.
with respect to internal validity one of the threats is the fact that wedid not pick a random sample.
this effect can be decreased by using a larger test group in future experiments.
we however believe the current test group serves as a good reference group as the persons varied in their age function and daily tasks with spreadsheets.
in our empirical study we tried to maximize the realism of our evaluation which unfortunately comes at the price of reduced repeatability.
as an alternative we considered using the euses spreadsheet corpus which is often used in spreadsheet research including ours .
in this case however we could not use this corpus since we were not able to identify users and transfer tasks for the spreadsheets in this corpus.
.
related work flowcharts direct family members of the dataflow diagrams have been present in computer science since its early days .
later knuth developed a system that could draw them automatically from source code .
experiments done by scanlan showed flowcharts can be a good asset aiding users in comprehending source code.
the problems around spreadsheet use are a topic for many papers.
nardi and miller for instance found that it is difficult to get a global sense of the structure of a spreadsheet that requires tracing the dependencies among the cells.
this statement is very similar to the ones we gathered in the interviews.
users in the survey of nardi and miller named this tedious process their biggest complaint about spreadsheets.
burnett and rothermel have written a series of papers on testing spreadsheets .
underlying their test methods is the cell relationship graph crg a graph that shows the relation between cells.
they however use this graph to calculate what cells depend on what other cells and the crgs are not shown to end users testing the spreadsheet.
many papers describe mechanisms to visualize spreadsheet structure to support user understanding.
the first one was davis suggesting the online data dependency tool that extracts a spreadsheet flow diagram as proposed by ronenet al.
to document spreadsheets.
the tool was never implemented because at the time of writing graphical layout of these diagrams was too complicated to automate.
they did perform an evaluation with a hand generated diagram and compared its usefulness to an arrow diagram a diagram showing dependencies directly in the spreadsheet similar to excel s audit toolbar.
results show that participants identified more cell dependencies with the diagrams than without although the arrow diagram performed slightly better then the online diagram.
clermont introduces the notion of data dependency graph ddg showing end users the relation between all cells within a spreadsheet as part of an auditing toolkit.
a ddg however only contains cell names such as b5 and does not show the formula calculations.
shiozawa et al.
proposes to create a dataflow diagram in 3d on top of a given spreadsheet where more distinct connections are placed higher above the spreadsheet.
this is an interactive process in which users can select cells and lift them up .
although their approach seems very promising it has to date never been evaluated in practice.
the main difference between these related approaches and ours is the introduction of levels in the dataflow diagram the automatic extraction of names for worksheets data blocks and cells and our extensive evaluation in industry.
.
concluding remarks the goal of this paper is to underline the importance of spreadsheet analysis and visualization as a means to aid users in understanding spreadsheets.
to that end we have designed an approach to represent calculations within a spreadsheet as data flow diagrams and implemented this approach in the gyro spreadsheet analysis toolkit.
the key contributions of this paper are as follows a detailed survey analyzing the information needs of spreadsheet users section an algorithm to extract a dataflow diagram from a spreadsheet section different views on the dataflow diagram section an implementation of the proposed methods in the gyrosat toolkit section an evaluation of the proposed approach within a large dutch financial company section the current research gives rise to several directions for future work.
as mentioned before we should concentrate on gathering more information from the spreadsheets not only from formula dependencies but from visual basic code as well.
it would also be an improvement to link the dataflow diagram to the spreadsheet.
ideal would be to have a dataflow diagram and a spreadsheet on the screen simultaneously and highlight a certain part of the data flow diagram when a corresponding part of the spreadsheet was selected and vice versa.
.