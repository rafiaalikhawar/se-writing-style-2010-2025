inferring models of concurrent systems from logs of their behavior with csight ivan beschastnikh yuriy brun michael d. ernst arvind krishnamurthy department of computer science school of computer science computer science engineering university of british columbia university of massachusetts university of washington vancouver bc canada amherst ma usa seattle wa usa bestchai cs.ubc.ca brun cs.umass.edu mernst arvind cs.washington.edu abstract concurrent systems are notoriously difficult to debug and understand.
a common way of gaining insight into system behavior is to inspect execution logs and documentation.
unfortunately manual inspection of logs is an arduous process and documentation is often incomplete and out of sync with the implementation.
to provide developers with more insight into concurrent systems we developed csight.
csight mines logs of a system s executions to infer a concise and accurate model of that system s behavior in the form of a communicating finite state machine cfsm .
engineers can use the inferred cfsm model to understand complex behavior detect anomalies debug and increase confidence in the correctness of their implementations.
csight s only requirement is that the logged events have vector timestamps.
we provide a tool that automatically adds vector timestamps to system logs.
our tool prototypes are available at this paper presents algorithms for inferring cfsm models from traces of concurrent systems proves them correct provides an implementation and evaluates the implementation in two ways by running it on logs from three different networked systems and via a user study that focused on bug finding.
our evaluation finds that csight infers accurate models that can help developers find bugs.
categories and subject descriptors d. .
distributed programming general terms algorithms design modeling keywords model inference log analysis concurrency distributed systems csight .
introduction when a system behaves in an unexpected manner or when a developer must make changes to legacy code the developer faces the challenging task of understanding the system s behavior.
to help with this task developers often enable logging and analyze runtime logs.
unfortunately the size and complexity of logs often exceed a human s ability to navigate and make sense of the captured data.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
icse june hyderabad india copyright held by the owner author s .
publication rights licensed to acm.
acm .
.
.
.
promising approach to help developers is model inference.
the goal of a model inference algorithm is to convert a log of system executions into a model typically a finite state machine that accurately and concisely represents the system that generated the log.
numerous model inference algorithms and tools exist to help debug verify and validate sequential programs .
unfortunately this rich prior body of work is not directly applicable to distributed or concurrent systems.
this is because a common assumption made in model inference is that the underlying set of executions is totally ordered for every pair of events in an execution one precedes the other.
this assumption is crucial to the inference algorithms correctness and running them on logs that are not totally ordered results in inaccurate models.
unfortunately this assumption does not hold for concurrent systems such as networked systems for which events at different nodes may occur without happens before relationships .
additionally most model inference algorithms infer finite state machine fsm models which are inappropriate for modeling multi process implementations.
this paper describes a new model inference technique and a corresponding tool called csight for concurrency insight which infers a communicating finite state machine cfsm model of the processes that generated the log.
csight can be applied to logs of distributed systems protocol traces traces of ajax events in a webbrowser and other concurrent behavior traces.
csight models have multiple developer oriented uses for example developers can inspect query and check csight s models against their own mental model of the system to find bugs.
these uses are the focus of our present work.
however we believe that csight generated models have numerous other applications such as model based testing of concurrent systems and automated detection of anomalous behavior as systems are exposed to new workloads and environments.
this paper presents the following four contributions .a novel model inference algorithm to infer a cfsm model from a log of vector timestamped concurrent executions section and a corresponding tool called csight.
.a proof that csight generated models are accurate as they satisfy several key properties of the input log section .
.a tool for automatically augmenting existing process local logging mechanisms with vector timestamping logic.
this makes it easy to apply csight to existing systems section .
.
a two pronged evaluation of csight section we applied csight to logs of three systems the stop andwait protocol the opening closing handshakes of tcp and the replication strategy in the v oldemort distributed hash table.
csight was effective for uncovering the true model for each of these systems.permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
copyright is held by the author owner s .
publication rights licensed to acm.
icse may june hyderabad india acm send x m!x oa?ack osend x m!x ea?ack esend x m!x oa?ack osend x m!x ea?ack e1 12mas0s1send x s2m!x otimeouta?ack es3a?ack os4send x s5m!x ea?ack ea?ack otimeout b. output model sender a?ack er0r1m?x or2recv x m?x or3r4m?x er5recv x a!ack em?x em?x em?x oa!ack o b. output model receiver a input logsenderreceiver2 12m?x orecv x a!ack om?x erecv x a!ack em?x orecv x a!ack om?x erecv x a!ack efigure example input and output of csight for the stop and wait protocol sa w .
a example input log with a single trace of two processes running sa w. the two integers at the beginning of each event in the log are the event s vector clock timestamp.
b the csight derived cfsm model of sa w derived from a log with additional traces not shown consisting of b. the sender process model and b. the receiver process model.
in sa w the sender transmits messages to the receiver using channel m and the receiver replies with