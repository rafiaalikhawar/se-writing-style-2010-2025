adequate monitoring of service compositions antonia bertolino isti cnr via moruzzi pisa italy antonia.bertolino isti.cnr.iteda marchetti isti cnr via moruzzi pisa italy eda.marchetti isti.cnr.itandrea morichetta isti cnr via moruzzi pisa italy andrea.morichetta isti.cnr.it abstract monitoring is essential to validate the runtime behaviour of dynamic distributed systems.
however monitors can inform of relevant events as they occur but by their very nature they will not report about all those events that are not happening.
in service oriented applications it would be desirable to have means to assess the thoroughness of the interactions among the services that are being monitored.
in case some events or message sequences or interaction patterns have not been observed for a while in fact one could timely check whether this happens because something is going wrong.
in this paper we introduce the novel notion of monitoring adequacy which is generic and can be de ned on di erent entities.
we then de ne two adequacy criteria for service compositions and implement a proof of concept adequate monitoring framework.
we validate the approach on two case studies the travel reservation system and the future market choreographies.
categories and subject descriptors d. .
testing and debugging monitors general terms performance measurement management veri cation keywords adequacy criteria choreography operation coverage branch coverage monitoring .
introduction wisdom is knowing how little we know .
socrates services are pervasive and increasingly a ect our everyday life.
services are discovered accessed and bound dynamically from di erent devices.
an essential instrument of permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
esec fse august saint petersburg russia copyright acm ... .
.service provision is the capability to monitor their behaviour and their o ered quality of service qos .
the two activities of service management and monitoring are together situated by papazoglou and coauthors at the top of the three planes of their research roadmap in service oriented computing above service composition and service foundations.
in this paper we focus on monitoring of service compositions.
service monitoring can come in many avors depending on several factors.
ghezzi and guinea classify monitors according to the type of monitored properties the service composition paradigm the method used to collect data degree of invasiveness and timeliness.
for example we could monitor functional or non functional properties of either service orchestrations or service choreographies following an event based or a state based approach etc.
in fact many di erent approaches and frameworks have been recently proposed for service monitoring.
however behind all monitoring approaches we can identify one common high level goal that is to timely detect potential problems occurring during service execution and one common activity ow consisting of i dynamically extracting information about the interactions among services ii collecting this information and iii presenting it to users in useful formats .
monitoring thus is inherently a passive activity monitors by their very nature are limited to capturing and analysing what is going on.
in recent years researchers have realized that standard monitors are not su cient to validate system behaviours in the rapidly and continuously evolving context of serviceoriented architecture and have recognised the need to make them more powerful and self aware.
there have been several proposals as we discuss in the related work section for augmenting the analysis capability of a monitor for example by making it capable to predict events before they occur or to extrapolate the allowed remaining margins of qos values.
however we also would like to have ways to assess whether a monitoring session is adequate i.e.
if it is keeping track of all events of interest or if instead the collected information misses some important event.
by saying that the monitor does not report some event here we do not refer to the chance that the monitor lost it but to the fact that the event did not happen.
our proposal goes in the direction of making the monitor wiser in the sense of socrates s saying i.e.
we would like to enable a monitor to know that it does not know .
to do this we propose to explicitly de ne what are the relevant entities that we would expect to observe and hence to set an adequacy criterion on such entities implying that the mon itored information should normally report that such entities have been covered.
as the standard monitoring activity proceeds we can then progressively measure the percentage of observed entities and thus become aware that some expected simple or complex events have not happened for some time.
coverage assessment has been introduced in software testing decades ago e.g.
referring to coverage of entities in the program controlow or dataow and nowadays constitutes a fundamental part of testing activity.
we introduce here the similar and as important notion of monitoring adequacy .
we highlight a fundamental di erence between the traditional notion of testing adequacy and the novel notion of monitoring adequacy namely the concept of the observation window along which coverage is measured by de ning the period in which monitor adequacy is assessed the observation window adapts to monitoring the concept of a test session or test suite on which test adequacy is evaluated.
presentation wise we distinguish between the abstract definition of the monitor adequacy and its possible instantiations.
the former is completely generic and can be applied to di erent entities and application domains the latter are obtained after establishing a type of coverage requirements i.e.
what are the entities that will be counted.
in this paper we provide contributions in both directions as follows we introduce the generic notion of a monitor adequacy criterion we de ne and implement two speci c instantiations of a monitor adequacy criterion for the monitoring of service compositions we provide a proof of concept framework and its preliminary assessment on two case studies showing the feasibility of the approach and interesting information that can be obtained.
the paper structure is as follows sections and illustrate the idea and propose a generic de nition of adequate monitoring.
section provides an instantiation of an adequate monitor for services choreographies and section describes the high level architecture of a proof of concept adequate monitor.
section introduces the case studies considered and section discusses some preliminary results.
finally section puts our work in context of related work and section draws conclusions.
.
motiv ation to illustrate our idea we consider a simpli ed example of a home banking application which provides bank customers with di erent services performing the most common bank account operations including withdraw deposit bank transfer stock market bank statement and so on.
it is natural to suppose that the bank is interested in monitoring the banking activities performed by the users of home banking functionality so to evaluate the qos and to timely detect possible problems that could compromise the overall system security and usability.
however monitors typically allow to observe relevant events as they occur but do not by default provide information that something is nothappening.
now suppose that for some time no home banking customers ask for stock market operations this may be due simply to a temporary decreaseof customers interest in stock market investment or instead to a service malfunctioning.
in either case it could be very useful for the bank to be promptly informed that no invocation to the stock market service is being monitored so that they can analyse the situation and implement the most suitable solution.
as another example the bank can be interested to evaluate the sequence of interactions of its users and the respective responses and in particular to check if their relative frequencies conform to those expected.
suppose that in a normal usage of the home banking platform an operation pro le assigns some respective percentages to every service invocation and response.
a change of the expected usage statistics over time could happen for di erent reasons and is certainly an important symptom for the bank if a drastic decrease of successful withdraw operations is evidenced the bank could suspect of a malfunctioning of the service behavior and possibly activate the necessary testing and maintenance activity.
we do not say that a standard monitoring activity could not in principle detect the above mentioned situations.
however ultimately any monitor collects and analyses data following some prede ned monitoring rules for our scope it is indi erent how these rules are given as probes or assertions or by other approaches .
therefore to be informed that some interesting operation is not being observed as in the missing invocations to stock market service example or is happening with a frequency di erent from the expected one as in the changed usage statistics example the bank should in advance instruct the monitor with some time out interval or some usage pro le for each event they want to keep under control.
without being explicitly instructed by some speci c rule the monitor cannot spot potential critical situations.
the reason behind such weakness is that monitors passively log what is happening but lack any adequacy criterion to decide whether the collected data provide a complete snapshot of the system potential behaviours.
to address this need in a comprehensive way as we better describe in the following section we propose to enhance monitors with a notion of coverage and make them capable to measure coverage of the relevant entities under a de ned monitor adequacy criterion.
.
defining monitor adequacy in this section we introduce the generic concept of a monitor adequacy criterion without binding its de nition to a speci c coverage measure.
in fact the notion of monitor adequacy is neutral with respect to both the entities to be covered and the application domain.
to introduce the notion of monitor adequacy it can be useful to rst recall as a reference for comparison the well established notion of test adequacy.
since the seminal work of goodenough and gerhart adequacy criteria are extensively investigated in software testing literature and considered an essential part of any testing method .
adequacy criteria are used to assess the thoroughness of test suites by establishing a set of test requirements they should ful ll.
more typically in test coverage criteria these requirements are mapped onto a set of entities that must be covered when the test cases are executed for example all statements or all branches in the program controlow.
if all entities are covered we say that the coverage criterion is satis ed otherwise we can use the percentage of covered entities asa quality measure of the test suite.
the intuitive motivation behind measuring test coverage is that if some entity has never been tested it might contain undetected faults.
obviously the converse reasoning does not apply if we had covered all entities and detected no failure this does not necessarily imply that the program is correct.
in a similar way we propose here to assess the adequacy of the monitored executions by identifying what are the relevant entities to be covered and by assessing if all of them or otherwise what percentage have been observed.
to do this we can refer to the observed execution traces and measure coverage of the entities belonging to these traces.
as for test adequacy the motivation behind assessing monitoring adequacy is that if some entities are not covered we cannot exclude that these might hide some problem.
thus the notion of monitoring adequacy is de ned similarly to test adequacy but it implies some signi cant di erences.
one rst di erence concerns the period along which we measure coverage.
in fact in the case of test adequacy this is measured over a test session and the obtained measure refers to the executed test suite.
in monitoring there is not a similar notion of a test suite since monitoring observes how the system spontaneously behaves.
in principle the monitor observation could last inde nitely whereas for analysis purposes we need to set some limits upon the observed execution traces.
therefore we introduce a notion similar to that of a test session by associating the monitoring coverage measure with the length of a considered observation period.
intuitively we de ne a sliding observation window over a time measurement unit which could be either continuous e.g.
we consider the execution traces collected in the last sec or discrete e.g.
we consider the most recent traces .
another di erence concerns the fact that monitoring coverage is no longer a monotonically increasing function as it happens in a test session as more traces are monitored one entity that was covered before could not be covered anymore.
a decrease of coverage testing could happen in regression testing after some code modi cation has occurred.
monitoring coverage could normally increase or decrease allowing for detecting possible dynamic modi cations in the service interactions.
we now formally de ne monitoring coverage.
let us denote byri2rtheith entity to be covered and by i2 the length of its associated observation window.
we could set di erent lengths ifor eachri or we could have one same interval for all entities.
the monitor adequacy criterion c dynamically measures the coverage on rfor a given at each time unit tas follows c t pjrj i i t jrj where forri2rand i2 i t ifriis covered at least once in otherwise in summary our de nition of monitoring adequacy introduces the following concepts an adequate monitor is a monitor that is instructed to keep track of a set of requirements rito be coveredin a window i this is similar to the instrumentation phase of coverage testing a monitor coverage analyzer is a tool that at every instantt can provide a coverage measure as in eq.
and if this is less than can provide a list of those entities that have not been covered as for test coverage an entity that is not covered is not necessarily the signal of a problem however provides an indication that we have not heard for some time from that entity.
we may want to program the coverage analyzer so to raise a warning message when some entity is not covered.
.
implementing monitor adequacy we now re ne the abstract concept of monitoring adequacy introduced in the previous section.
with reference to eq.
the instantiation of a monitoring coverage criterion requires to specify the requirements rto be covered to set the continuous or discrete time unit t and consequently to de ne the respective observation windows .
we take as the application domain the case of service choreographies.
a choreography speci cation which could be expressed in various languages e.g.
ws cdl1or bpmn2 can be seen as a contract de ning the agreed ordering conditions and constraints under which participating services interact by message exchange.
this speci cation describes the externally observable behavior of all parties involved from a global viewpoint di erently from a service orchestration in which participants interactions are regulated from a single point of control .
strictly speaking service choreographies are not executed but they are enacted this means that we cannot run some prescribed service interaction ow like in a bpel3orchestration rather di erent behaviours happen as participant services autonomously play their roles.
given such a loose context it is important to verify whether the behaviours emerging in an enacted choreography are conforming to its speci cation.
runtime monitoring helps to address such need and our notion of an adequacy criterion in choreography monitoring can be useful to help assess whether all or how many of the interesting behaviours are emerging.
in this paper as we motivate in section .
we focus on adequacy criteria that measure the operations invoked either independently of the sequence of invocation operation coverage or within a speci ed sequence we call this branch coverage .
once available the coverage information dynamically collected can be exploited in many ways.
a choreography does not have any single point of control but we can suppose a choreography manager stakeholder as a generic actor who will be in charge of choreography management and veri cation and who is interested in the coverage assessment.
the choreography manager could set a desired coverage measure and ask to be noti ed when the coverage decreases under that measure.
or at a certain instant t he she could take a snapshot of coverage and check which entities are not covered.
or a warning message could be issued if some entity has not been covered for a certain period.
an excerpt of the fsm associated to the home banking choreography it is worth notice that as it happens with test coverage monitoring adequacy can only give warnings.
how to best make use of those warnings and where necessary what could be e ective counter measures are two crucial consequent questions.
we hint at some examples in section however further research is needed to answer them.
.
entity definition within a choreography the participating services interact by means of operation calls thus invocations of operations are the basic entities to be monitored.
operation coverage can be considered as a parallel to the standard test criterion of statement coverage.
in particular we de ne operation entity considering every service participating in a choreography an operation entity is one of the operations speci ed in the service interface that is invoked inside the choreography at least once a service could specify more operations that are not used within the considered choreography which are not quali ed as operation entities operation coverage domain considering a choreography the operation coverage domain is the set of all the operation entities of all the services involved in the choreography percentage of operation coverage with reference to eq.
the percentage of operation coverage at time tis given by c where ris the operation coverage domain we discuss how the set of the observation windows is de ned in the next section .
consequently at a given instant ta choreography monitor is adequate with respect to the operation coverage criterion if the percentage of operations covered is or greater than an established threshold level .
as said we see operation coverage as a basic criterion corresponding to all statement coverage.
in testing a minimum requirement is often considered coverage of all branches of the program control ow graph.
we can establish a parallel for choreography monitoring considering a graph representation of the choreography behavioral model.
whatever is the formalism used to represent the choreography speci cation it is always possible to derive an abstract behavioral model such as a finite state machine fsm in which each transition represents a message exchange between two participants of the composition and each node represents the evolution of composition states according to the exchange of messages.
in figure we provide an excerpt of the behavioral model represented by a fsm of the home banking choreography example described in section vb b d w indicate the virtualbank bank deposit withdraw services involved in the choreography.
we label each edge with the name of the involved operation and the sender and receiver services for instance login vb b denotes the request sent from the virtualbank to the bank when a homebanking user asks to login and so on.
over such a graph we can introduce a concept similar to the program control ow branch.
in particular branch entity considering the behavioral model graph of a choreography a branch entity is an arc in this graph.
it is indicated as o i j where ois operation service iis the sender and jis the receiver branch coverage domain considering a behavioral model graph of a choreography the branch coverage domain is the set of all the branch entities in the graph percentage of branch coverage with reference to eq.
the percentage of branch coverage at time tis given by c where ris the branch coverage domain for de ning see next section .
consequently at a given instant ta choreography monitor is adequate with respect to the branch coverage criterion if the percentage of branch coverage is or greater than an established threshold level .
.
observation windows as de ned in eq.
the measure of operation branch coverage depends on the length of the observation windows iassociated with the selected entities.
how can we set the lengths of such observation windows?
we provide below two practical methodologies based either on some prior knowledge or assumptions of the entities frequency or on the data collected during a learning phase.
in case of operation entities the operation coverage domain can be derived directly from the choreography specication.
if some prior knowledge or expectation about how frequently such operations are invoked during the choreography enactment is available this can be used to assign to each entity in the operation coverage domain some expected relative frequency.
in case of branches we propose a procedure similar to that adopted in software reliability engineering for the de nition of the implicit functional operation pro le .
considering the behavioral graph of the choreography speci cation at each level the arcs of the graph can be annotated with their relative frequencies so that the sum of the frequencies of all the arcs exiting from a node is equal to .
in this case the absolute frequency of each branch entity can be calculated by multiplying the frequencies values of each branch entities in the path from the entity considered to the root node of the model.
each absolute frequency can then be used to calculate the length of the observation windows of the associated branch entity.
above proposed methodologies require some prior knowledge of the entity frequencies that may not be always available.
however in speci c domains where a choreography is well established it is thinkable that choreography managers or domain experts could have this knowledge or derive it from previously collected data set.
an alternative methodology we propose relies on a learning phase.
the monitor is used in a rst phase just to collect data useful for de ning the frequency measures of interest operation branch .
the data collection is performed for a certain period of time under some supervision control for ensuring that the collected data are representative of regular behaviour.
afterwards the data are used to set the frequencies of each entity and to consequently estimate the associated observation windows.
this methodology has the advantage that it does not require prior knowledge becausefigure an instantiation of an adequate monitoring framework data are directly obtained from the eld.
however the accuracy of the calculated entity frequencies is in relation with the scheduled learning time and will rely on a de ned level of precision.
consequently the derived observation windows have to be calculated considering a certain con dence level.
.
adequate monitor architecture with reference to figure we outline the components of the high level architecture of the proof of concept adequate monitor for service compositions we have implemented gui a web interface allows the user to upload the behavioral model of the service composition and the parameters useful for adequacy measurement.
through the gui the user can visualize the information produced by the coverage analyzer see below e.g.
a curve of the evolution of the percentage of coverage measured the coverage details for each considered entity the derived monitoring statistics possible warnings raised and the monitoring log.
wsmonitor wsm this is a web service that receives event messages from the services involved in the composition and forwards them to the inferential engine.
each eventmessage contains the following parameters compositionid which is the unique identi er of the composition instantiation enactmentid which identi es the user of the composition eventname which speci es the interaction performed and data which is an optional parameter containing additional information.
inferential engine ie this component dynamically evaluates the set of rules that match with the received events and executes the actions associated to those that are satis ed.
in the current implementation we rely on drools engine that is a business rules management system with a forward chaining inference based engine.
rules generator rg this component takes in input the behavioural model and the coverage parameters selected by the user through the gui and derives the entities to be covered by applying a graph traversal algorithm and the length of the observation windows according to the two approaches outlined in section .
.
for each entity rg generates one corresponding rule for the employed drools engine.
a drools rule is composed by a condition and an action whereby the condition contains an ordered events sequence and the action speci es the activities to be executed when the condition is satis ed.
an example of a dummy rule as we specify them for the adequate monitor is depicted in listing the when clause is used to check if within the observation window e.g.
the last n eventmessage s the entity e.g.
an eventmessage with eventname eventx is not observed.
if such clause is satis ed the corresponding action is performed the covered attribute for that entity is set to false .
coverageanalyzer ca this component captures all the actions executed by ie and elaborates them so to extract useful information for visualizing the monitored events and elaborating statistics about the overall percentage of coverage.
the ca maintains a log of coverage for each entity so at each instant it is possible to know the state of all entities and measure the total coverage or show the coverage trend along the time.
raising alert warnings for the entities that are not covered.
a warning message indicates a condition that might need supervision and can be seen as a programming language exception.
the warnings can be transmitted to the user in graphical form through the gui or in textual form such as an alert message.
moreover a log le would report additional information like the last time the en tity was observed the related sequence of events and parameters etc.
collecting the monitoring log for o line analysis.
when in learning phase ca simply logs the occurrence of entities to be covered and produces the statistics of the observed frequencies.
these are referred for de ning the observation windows in operation.
rule entity1 when list arraylist from collect eventmessage over window length n not eventmessage eventname eventx from list then entity1.covered false end listing example rule figure shows the overall structure of the monitor and the data exchanged between the di erent components.
the gui is conceptually divided into two parts initialization and visualization.
the behavioral model is inserted by using the initialization part and passed to the rg.
as an example in the gure we consider that the speci cation is provided as an fsm model and the criterion selected is branch coverage.
the derived rules are sent to ie and in parallel wsm starts receiving the eventmessages.
the icons drawn in the wsm component represent the enactmentid while the labels e1 .. e5 are the eventname s. for instance the male actor executes a sequence of activities in the composition that forces the events e1 e2 e4 .
these data are given to ie that recognizes the coverage of the corresponding branches and noti es to ca the list of branches not exercised within their observation windows.
this information is rendered to the users by means of the visualization part in the gui.
.
case studies in this section we introduce the two choreographies to which we applied our adequate monitor.
.
travel reservation system the travel reservation system as provided in the wsci documentation implements a business process for reserving and booking airline tickets and includes the following services traveler which models the user of the travel reservation system travel agent which is in charge of managing the travel reservation process airline which provides the functionalities for booking a selected ight.
in order to have a more complete case study we added the following services hotel and car park which provide the functionalities for reserving and booking hotel rooms and parking spaces respectively and car rental which allows to rent a car nearby the destination airport.
at very high level the considered business processes are the following initially traveler asks the travel agent for a ight itinerary then the travel agent calculates the best solutions and asks the involved airline to verify the seats availability.
in case of positive response the travel agent builds the itinerary and asks the traveler to con rm the seats found or modify the original intention.
in case of conrmation the travel agent proceeds with the airline.
once the ight is reserved the traveler has di erent options canceling the reservation buying the ight ticket or asking foradditional services i.e.
rent a car book a room or a parking space.
when such negotiations are concluded travel agent noti es the selected trip to traveler who can again modify the solution or reserve it.
when all the reservations are concluded the traveler can call the travel agent that is in charge to con rm the requests with the involved services.
these will then provide the traveler with the appropriate responses.
finally the traveler can cancel either the entire trip or only some of the required additional services by calling again the travel agent.
.
future market the future market choreography is a real choreography developed by the distributed systems group at usp computer science dpt.
implementing a distributed on line shopping service.
as depicted in figure it consists of the following work ow a customer provides in input a shopping list querying the price of each listed item to di erent on line supermarkets with the goal of nding the lowest price.
several services for subsequently purchasing and delivering the items from the multiple supermarkets are provided the human customers that interact with the choreography through a portal are represented as customers the registry stores the list of services that implement the multiple supermarkets in the version enacted ve di erent supermarkets were registered that provide similar functionalities for searching and purchasing products if a supermarket is at shortage of some product it can procure it either from a supplier or directly from the manufacturer the shipper is in charge of the delivery of acquired products to a postal address and nally a bank service supervises the on line payments.
.
preliminary assessment in this section we report the results of applying the adequate monitoring to the two case studies.
in particular using the travel reservation system choreography we simulate various possible monitoring outcomes whereas using the future market choreography we collect results from a real even if less complex application.
to assess an adequate monitor we identi ed two critical concerns the setting of the observation windows since we foresee that these may have an important impact in the approach e ectiveness and understanding whether the observed variations in the coverage measure may be indeed useful to identify potential issues.
therefore we used the case studies for investigating the following research questions rq1 how does monitoring coverage vary depending on the observation windows?
rq2 can monitor coverage reveal potential issues?
.
travel reservation system in the performed simulations we varied the combination of the following independent variables coverage criterion cc this parameter indicates the entities to be covered i.e.
cc 2foperations branches g. the cardinality of operation coverage domain for the travel reservation system is while that of branch coverage domain is figure future market choreography entity frequencies ef we considered the possibility of manually annotating choreography model or to perform a learning phase thus ef 2fannotation learning g con dence level cl when ef learning we considered di erent con dence levels with cl 2f90 g coverage threshold ct this parameter indicates the coverage threshold to be considered adequate we set ct2f80 g. we launched various reservation requests from simulated clients randomly choosing one possible complete path over the behavioural model of the travel reservation system.
thus considering a discrete time measurement unit associated to the completion of a path in the behavioural model we carried on the simulation for time units.
observation windows analysis.
figure summarizes in four frames the simulation results using di erent approaches for setting the entities windows.
each graph reports on the x axis the time unit t and on the y axis the percentage of cumulative entity coverage.
in particular figure a resp.
b shows a portion of the curves of the cumulative operation coverage considering the following setting of the independent variables cc operations resp.
branches ef learning cl ct .
since the lengths of each observation window ihave been obtained by statistical inference the estimates are valid within a pre xed con dence level as follows the top level curves for both operation and branch coverage show an extract of the adequate monitoring considering cl those in the middle cl and those at the bottom cl .
in each graph the dotted lines at and correspond to the ct values.the frame c resp.
d in the same gure shows an extract of the curve of the cumulative operation resp.
branch coverage considering the following setting of the independent variables cc operations resp.
branches ef annotation ct .
manually annotated frequencies should re ect some prior knowledge of the choreography behavior.
however we considered in this experiment the worst case of no prior knowledge and simply adopted a uniform distribution of the frequencies for the operations for branches we considered as equally probable those at the same level in the graph.
from the comparison of the various curves in figure we can provide a preliminary answer to rq1.
a rst somewhat obvious conclusion is that the more information we can use for setting the observation windows associated to the various entities the better.
ideally we would like to observe a stable and high coverage throughout the choreography monitoring except for problems so having an oscillating coverage is not good.
when ef annotation frames c and d the coverage uctuates rapidly especially for operation coverage.
this means that the provided annotations are based on wrong assumptions about the expected frequency of operation invocations providing in the end a deceiving perception of possible choreography instabilities.
concerning the case of ef learning frames a and b the simulations with cl provide an increasing trend of both operation and branch coverage values.
considering for instance the frame b with cl the branch coverage values are between and with cl the values are between and when cl the values are between and .
this is in line with the higher con dence level adopted for setting the observation windows which forces a consistent increase of the windows length.
the consequence is that the adequate monitoringfigure coverage evaluation using learning data and prior knowledge x axis is tand y axis is coverage results less sensible to the choreography behaviors local variation and the perception provided by the monitor is that no anomalous situations are experienced.
to summarize the ideal approach for setting the observation windows would be to exploit prior knowledge when this faithfully represents the reality.
when this knowledge is not available a learning activity is a feasible compromise.
the con dence level in learning phase directly in uences the observation windows length the higher is cl value the longer will be the window consequently the higher is the chance to cover more entities but conversely the less timely will be the monitoring warnings.
coverage measure analysis.
based on the above observations the analysis of rq2 has been carried out considering the following experimental setting cc operations resp.
branches ef learning cl ct .
figure a resp.
b shows an excerpt of the graphical representations of the cumulative operation resp.
branch coverage obtained using these settings.
focusing on the curves at the top both on part a and part b the graph evidences several observation periods in which entity coverage decreases under the established boundary .
for the choreography manager these variations of coverage measure could be a symptom of some anomalies that could require a deeper investigation.
more importantly the monitor not only gives these coverage cumulative value but can also report detailed information on which entities are responsible for the coverage decrease.
the bottom part of figure a resp.
b shows pictorially the coverage of each entity in every choreography behavior execution.
we draw a horizontal row for each entity thus we have rows for operations in part a and rows for branches in part b .
along each row at instant tthe point is green ifthe entity is covered red otherwise4.
thus all red points are warnings of possible anomalous situations.
the longer is a set of consecutive red points in a same row the more critical could be the problem.
in detail a punctual analysis of the bottom parts of figure a and b shows that there are entities that continuously alternate between green and red e.g.
the rst lines of figure b .
this could evidence a situation in which the chosen observation windows are too short.
in real contexts this could be due to several reasons a not adequately long learning activity a not accurate setting of the con dence level or even some variations in the services behaviors.
conversely there are entities that are green almost all the period e.g.
the last few lines of figure a .
this could happen because the chosen observation windows are too long however in general continuous green lines are not a problem.
there are periods in which the coverage measure is under the established threshold .
the local decrease happens in situations in which several entities are not observed contemporaneously.
this can be due to several reasons such for instance a modi cation in the expected users behavior or a propagation of an anomaly to di erent services in the choreography.
whatever the causes the local decrease of coverage can be an alarm of anomalous behavior in the choreography enactment.
even when the coverage measure is above the established threshold some entities cannot be covered for long periods.
these are evidenced by long red segments.
the reasons of this situation could be in rela4gray or black respectively in black white printingfigure adequate monitoring coverage of travel reservation system tion to serious malfunctioning of a services or important anomalies in the users behaviors.
.
future market in this section we report the results from adequate monitoring of future market.
in this case study we considered both operation and branch coverage and set ct .
due to the simplicity of the choreography we opted for the prior knowledge approach to derive the observation windows setting a uniform distribution of entity frequencies.
we performed randomly exercised the choreography services.
figure a shows an excerpt of the percentage of branch coverage observed.
we omit the curve relative to operation coverage because it always reached .
the curve evidences that the coverage is below the set threshold and from the detailed report we see there are two continuous red lines corresponding to two branches that are never covered.
following such results an analysis of the choreography speci cation revealed that due to how the con guration parameters are set every time the supermarket does not have a product available and asks the supplier this always passes the request to the manufacturer.
indeed the stock amount for some products for supermarket and supplier was set to the same values thus every time the supermarket was at shortage of some product the supplier did too and it was forced to ask to the manufacturer.
thus the branch representing the case that the supplier returns the product without interacting with manufacturer never occurs.
we notice that to have some comparison data about the e ectiveness of the adequate monitor in parallel we also set up a standard qos monitoring tool the glimpse monitor .
the data collected by the standard monitor provided for each service interaction the time duration but did not revel any anomalous behavior as in any case the choreography enactments proceeded smoothly to their completion.
we modi ed the settings by di erencing the stock amount for supermarket and supplier and repeated the measurement using the new con guration.
as shown in figure b the continuous red lines disappeared and an overall increasing of percentage of branch coverage was observed.
this outcome con rms our answer to rq2 in the previous case study that the monitoring coverage provides useful indications of potential issues that may escape a traditional monitor.
.
caveat the two above case studies su er from many limitations and threats the rst is a simulation and may not be representative of real situations the second is a real third party choreography but quite simple.
the results we show are quite preliminary and must be taken as a rst attempt to show the feasibility of the approach and con rm its potential usefulness.
however a more extensive experimentation of adequate monitoring is required for better understanding its strengths and limitations.
.
related work monitoring is an essential asset for controlling and managing distributed systems and since early works such as the related literature spans over more than three decades.
a relatively recent survey underlined a renewed interest in monitoring approaches and tools due to the increasing complexity and pervasiveness of software systems.
rise of interest is even more evident with the advent of the service oriented paradigm whose characteristics such as stringent qos requirements decentralized management loose coupling and dynamic binding of independent services make runtime monitoring at the same time indispensable and highly challenging.
for lack of space we do not survey here the broad related work on more traditional challenges posed by service compositions monitoring which are brie y summarized in e.g.
and .
rather we focus here on proposals of smart monitoring approaches i.e.
monitors enhanced beyond the passive observation of system executions with the aim of preventing or anticipating potential risks.
it is understood that such smart approaches cannot neglect any of the traditional challenges and hence need to rely on top of solutions to address those ones as well.
as a trend several researchers start to consider monitoring a useful instrument to observe the behavior of a service composition not only to report about problems that have already occurred but also to predict likely problems in the near future.
several proposals go in the direction of checking the execution traces against a model of correct executions and of introducing enhanced analysis capabilities to try to foresee possible deviations.
this type of approach has been realized in di erent avors.
in for example the authors propose a choreography monitor for early detection of run figure adequate monitoring coverage of future market choreography time faults intended as deviations from admissible message exchanges between the cooperating services.
the monitor maintains a snapshot of the multi party conversations and in case a failure occurs in an instance of the choreographed services it analyzes the speci cation and decides whether the choreography execution can be completed.
if not it noti es the a ected services.
cassandra is a proactive monitor with the ability to map a services composition execution on a global interface automaton and to predict the future execution traces from the current state thus identifying in advance the risk to reach erroneous states.
other smart approaches focus on monitoring of nonfunctional properties to prevent qos violations.
the approach in focuses on preventing qos violations of explicitly de ned slas.
it uses machine learning to perform runtime prediction of sla violations at de ned checkpoints and if necessary triggers runtime adaptation.
in both and the authors address the prediction of qos violation problems in a service orchestration.
in the proadapt framework the monitor provides historical data of operations used in the instantiated execution models to an orchestrator that performs the runtime adaptation by selecting the concrete binding to services to be invoked in a composition.
the approach in focuses on cumulative qos metrics and estimates the allowed qos values for the remainder of the execution of the orchestration starting from those cumulated qos values.
in a monitoring approach is proposed for choreographies that calculates statically implicit qos constraints and issues a warning when these are violated at runtime as for an adequate monitor warning a violation of an implicit qos constraint could likely but not necessarily lead to the failure of a contractual constraint.
however all the above mentioned predictive approaches remain limited to the elaboration of the passively captured executions.
in contrast in our approach the monitor is empowered also to raise a warning of nothaving observed for some time interesting behaviours.
to the best of our knowledge there are not similar approaches in literature.
another branch of related work is passive testing which refers to the observation of the input output behavior of a system during normal operation for the purpose of detecting faults .
every collected trace is matched to a model most often a finite state machine model or also an extended fsm to verify if it conforms to the speci ed behaviour.
the conformance check is done either o line or on line.
proposed initially for the management of network protocols for which active testing was impractical due tolimited controllability of inputs research in passive testing has been recently relaunched for the management of web services e.g.
.
although the two branches of literature on monitoring and passive testing have little overlap we can speculate that passive testing constitutes a sophisticated type of functional monitoring in which the monitor is instructed to observe the traces permissible in the model.
as in passive testing we also compare the collected traces against a model however our purpose is not only that of detecting deviations rather we aim at measuring coverage over the considered model.
thus our approach could be considered as an enhanced form of passive testing.
.
conclusions and future work in this paper we introduced a novel notion of monitoring adequacy for service compositions and de ned two speci c instantiations of a monitor adequacy criterion operations and branches.
we also developed a proof of concept adequate monitoring and provided a preliminary assessment of the framework on two case studies.
the obtained results showed the feasibility of the approach and evidenced that adequate monitoring can e ectively overcome the limitation of a standard monitor.
indeed the last passively reports what is happening and is not able to decide whether the collected data provide a thorough snapshot of the system potential behaviours.
adequate monitoring of service composition enhances standard monitors with a notion of coverage and thus makes them capable to measure coverage of the relevant entities under a de ned monitor adequacy criterion.
however an important lesson learned was that monitoring coverage can uctuate depending on the observation windows thus attention is required in the choice of entity frequencies.
in the future market case study we manually analysed the choreography speci cation to locate the cause for the observed anomalies.
in future work we intend to further augment the monitoring framework with the capability to trigger on line test cases for automating this analysis following the early audition approach .
also in the authors propose to combine service monitoring with on line testing however those works augment on line testing with the information coming from monitoring whereas we propose conversely to augment monitoring with the capability to launch the notobserved executions.
a more extensive assessment of the approach to evaluate its costs and bene ts is needed.
.