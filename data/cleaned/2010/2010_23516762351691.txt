supporting automated vulnerability analysis using formalized vulnerability signatures mohamed almorsy john grundy and amani s. ibrahim computer science software engineering faculty of information communication technologies swinburne university of technology hawthorn victoria australia swin.edu.au abstract adopting publicly accessible platforms such as cloud computing model to host it systems has become a leading trend .
although this helps to minimize cost and inc rease availability and reachability of applications it has serious implications on applications security.
h ackers can easily exploit vulnerabilities in such publically accessible services.
in addition to of the total reported application vulnerabili ties are web application specific .
identifying such known vulnerabilities as well as newly discovered vulnerabilities is a key challenging security requirement.
however existing vulnerability analysis tools cover no more than of the known vulnerabilit ies.
we introduce a new solution that support s automated vulnerability analysis using formalized vulnerability signatures .
instead of depending on formal methods to locate vulnerability instances where analyzers have to be developed to locate specific vuln erabilities our approach incorporates a formal vulnerability signature described using ocl.
using this formal signature we perform program analysis of the target system to locate signature matches i.e.
signs of possibl e vulnerabilities .
a newly discove red vulnerability can be easily identified in a target program provided that a formal signature for it exists .
we have developed a prototype static vulnerability analysis tool based on our for malized vulnerability signatures specification approach .
we have validated our approach in capturing signatures of the owsap top10 vulnerabilities and applied these signatures in analyzing a set of seven benchmark applications.
categories and subject descriptors f. .
specifying and verifying and reasoning about programs semantics of programming languages program analysis k. .
verification.
general terms algorithms design security languages verification keywords software security vulnerability analysis formal vulnerability speci fication common weaknesses enumeration cwe .
introduction new computational paradigms such as cloud computing and service oriented architectures soa depend on outsourcing it systems for hosting on third party platforms outside of the enterprise network perimeter usually on the internet .
this increases the possibility of hackers attacking and exploiting vulnerabilities in such applications.
in addition the number of newly discovered vulnerabilities is increasing rapidly.
delays in discovering and m itigating such vulnerabilities increase the probability of successful application attacks and security breach.
web applications have become the prominent application delivery model used in such platforms as they do not require client deployment or configur ation and can be centrally updated and managed.
however web application vulnerabilities continue to make up the largest percentage of the total reported vulnerabilities in software applications.
web applications vulnerabilities constitute on average of the total reported vulnerabilities over the last three years.
of these reported vulnerabilities well known vulnerabilities such as cross site scripting xss represents while sql injection sqli vulnerabilities represent .
reported vulnerabili ties are usually recorded in commonly available vulnerability databases such as nvd or cvedetails .com .
vulnerabilities weaknesses definitions are maintained in the common weaknesses enumeration cwe database .
this database is used as a reference framework by application developers deployment engineers and sec urity engineers to help identifying possible weaknesses to attack in software applications.
however a key problem with cwe is that recorded vulnerabilities are almost specified informally.
thus eac h security vendor develop s their security analysis tools based on their own understa nding of such vulnerabilities.
commercial vulnerability scanners such as appscan web inspect cenzic mcafee focus on black box vulnerability analysis to avoid being limit ed to specific programming languages or platforms.
however n one of these scanners cover all known vulnerability types .
moreover they are limited in discovering stored forms of xss and sqli vulnerability.
to achieve good results with vulnerability analysis multiple scanners should be applied .
existing research efforts focus on specific vulnerability types.
most focus on sqli xss or input sanitization .
these efforts use static analysis with many variations dynamic analysis or hybrid of static and dynamic techniques .
however they focus on specific vulnerabilities only.
thus new vulnerabilities cannot be incorporated for checking unless we have new algorithms .
a key problem with both industrial and academic effort s is that they are not comprehensive enough to co ver known vulnerabilities or extensible to incorporate new vulnerabilities.
many tools depend on their own encoded representations of vulnerabilities which are suitable for their own analysis approaches.
from our investigation in these efforts we reached a conclusion that the key problem really lies in the vulnerability definitions and not in introducing new analysis techniques most of the existing approaches use similar techniques with various combinations .
moreover t he various existing vulnerabilitie s databases while useful are not directly utilized by vulnerability analysis tools due to their informality however we figured out that different security permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
ase september essen germany copyright acm ... .
analysis tasks including vulnerability analysis attack analysis and threat analysis can be faci litated if we have a formal vulnerability definition.
our analysis of the vulnerability analysis domain leads us to following research questions what details do we need to capture to fully describe a given vulnerability?
how can we formalize the signature s of possible security vulnerabilities ?
how can we effectively use such formal vulnerability specifications in automating the vulnerability analysis process?
in this paper we introduce a new comprehensive vulnerability specification schema.
this schema c aptures formal rich details of a given application vulnerability weakness including categor ies preconditions consequences signature s etc.
a key entry that we focus on in this schema is the vulnerability signature.
this signature specifies a set of inva riants when matched it means that the given vulnerability exists.
we adopt object constraint language ocl in capturing such signatures .
ocl is a declarative and formal language based on first order logic and set theory.
vulnerability signatures are validated against a comprehensive system description model that covers most program entities including classes methods statements inputs sources outputs targets etc.
furthermore it helps in developing more abstract signature s not coupled with specific programming langu age or platform .
as an initial step in validating our vulnerability schema and signature specification approach we have developed an ocl based static application vulnerability analysis tool .
this tool uses a new static vulnerability detection approach th at performs program analysis looking for matches for vulnerability signatures defined in ocl in a given program source code .
then it produces an overall vulnerability assessment report for the target application .
this vulnerability analyzer will be exte nded to support dynamic analysis as well using vulnerability analysis workflow engine.
a key difference between our static vulnerability analysis tool and existing tools is that it uses our formal vulnerability specifications to detect source code vulnerab ilities while working on an abstract system representation.
moreover it analyzes programs for any new vulnerability that has defined signature s .
this is compared to existing efforts that have specific built in algorithms to discover certain vulnera bility types only.
we have developed a prototype tool supporting our approach and evaluated it in capturing the well known top10 vulnerabilities reported by owsap.
we have validated our toolset in locating these vulnerabilities in a set of open source web applications.
in section we analyze the existing secu rity vulnerabilities and map this analysis on the top10 owsap vulnerabilities.
section describes our vulnerability definition schema the vulnerability signature specification and our ocl based sta tic vulnerability analysis tool.
section describes our prototype implementation details.
in section we discuss our experimental evaluation and results.
section discusses the implications of our work and key directions for further research.
section reviews related work.
.
background to understand the root causes of security vulnerabilities we analyzed different system structures components and deployment models.
we applied this analysis on the top10 vulnerabilities reported by owsap.
we summarize ou r conclusions as follows .
analysis of security vulnerabilities a given software system whether desktop web or even embedded is based on a hosting service e.g.
web server operating system virtual server etc.
figure .
a hosting service provides a set of apis that the hosted system can use to read inputs from possible input sources users files memory database etc.
or write outputs to possible outp ut targets.
any vulnerability in the hosting service implies that an attacker can control inputs and or outputs of the target system.
the hosting media is a place where the hosted system runs e.g.
a process in case of web server or memory in case of os.
if the hosting media breache d it may be used to control the hosted system inputs output s or even processing overrid ing kernel data using buffer overflow .
however t hese entities are out of the software system control.
function storage channel component hosting media hosting servicee p s t x a b figure .
an overview of the host system component relations any target system is composed of a set of components.
these components may be subsystems composite components or simple components.
system components may be hosted on the same hosting service in stance or different instances different servers .
in the latter case they have to communicate through communication channels which may be unsecure an attacker may eavesdrop or intercept messages .
a system component may be an active component a compo nent that can take actions or perform operations such as system functions.
active components are able to secure themselves and their processed data e.g.
authenticating users authorizing users encrypting data etc.
or alternatively a passive component a component that cannot take actions to change data it maintains such as storage components databases files or transmission components communication channels .
passive components cannot secure themselves e.g.
a file or table cannot enforce security ac cess on its contents by itself.
they depend on other components such as the hosting service os dbms or active system component s to manage secure such components.
this is a big open issue in data security area e.g.
data leak age protection where confidentiality of data moving between different applications with different security levels may be threaten ed.
both active and passive components may be breached by the hosting service e.g.
read data in memory files or on communication channel s. each comp onent regardless of its type has a set of entry points e and set of exit output points x and is used in processing p as a storage s or as a communication channel t .
these entry and exit points can be compromised by an attacker who has contr ol on the hosting service to read write modify delete the data.
usually the number of entry points and exit points the attack surface is used as a security metric when assessing systems security .
furthermore an active component may have vulnerabilities related to inputs input validation input coming from a user passin g by the hosting service outputs output validation and exceptions outputs may depend on malicious modified inputs or passed through a vulnerable hosting service or processing logical errors e.g.
race conditions malicious data corruption service overloading .
we use this analysis in categorizing vulnerabilities according to the source of vulnerability such as input validation output validation processing and hosting service vulnerabilities .
this helps in deciding which types of vulnerabilitie s can be 101identified by static analysis dynamic analysis etc.
moreover it helps in deciding the mitigation actions that can be applied to block such vulnerabilities.
.
owsap top10 security vulnerabilities before we discuss how we formalize software system vulnerability definitions we give an overview of the owsap top10 web application vulnerabilities .
owsap open web security application project is a community effort to define and share knowledge about web application security approaches.
we discuss thes e top vulnerabilities and signature s we deduce from the vulnerabilities recorded in nvd and cwe.
these signatures are used by our vulnerability analysis tool however they can be further revised by experts to get more accurate results.
injection flaw s this type of vulnerabilit ies includes several well known attacks intended to compromise application inputs in order to gain control or modify data such as sqli os command injection ldap query injection and xpath query injection.
all arise from input validation problems .
all external inputs are untrusted is a well known security principal that should be realize in securing systems .
these vulnerabilities occur whenever a system trusts an input from the user first order injection or from a reposito ry stored or second order injection and uses it to build dynamic queries that run os or database commands without sufficient input sanitization or validation.
an attacker can use this type of vulnerabilities to execute malicious commands or gain privil eged access to the system under attack .
fig ure shows code vulnerable to sqli.
for example a password argume nt of the form or or allow s access to any specified username e.g.
admin or root .
the signature of these vulnerabilities is a dynamic query statement that uses external inputs without proper sanitization.
public bool loguser string username string password string query select username from users where userid username and password passwo rd figure .
a code snippet vulnerable to sqli a ttack cross site scripting flaw s this is a two step vulnerability.
first an attacker uses the application to store malicious data.
when ever a victim sends a request to resource x the web server responds with data containing malicious code without being encoded .
this malicious code executes on the victim browser causing disclosure of her confidential information to the attacker.
this vulnerability type may be from stored data e.g.
from a database or reflected from user input .
this is very common attack in applications that use user i nputs for search or discussion s. the signature of these vulnerabilities is to call output functions using external or stored inputs without sanitization or encoding .
broken authentication and session management flaw s this is a common problem with security authentication.
it includes attacks such as authentication bypassing via external inputs depend on external input to bypass authenticating the current requester authentication checking not included in critical functions using hard coded credentials using an easy to guess password or session timeouts not set or checked .
this enables unauthenticated users to maliciously access and use system resources.
figure shows a code snippet vulnerable to improper authentication attack where a user can modify their cookie to bypass the authentication check.
the signature of these vulnerabilities is that every publicly accessible function should not trust external inpu ts to bypass by conditional statement triggering the authentication function .
if request.cookies !
true if !authenticateuser request.params request.params throw new exception invalid user doadministrativetask figure .
a code snippet vulnerable to authentication bypass insecure direct object reference flaw s authenticated users can send malicious in puts to access unauthorized data .
figure shows an example where attacker sends custid xyz instead of custid abc .
this enables the attacker to access other customers data.
the signature of these vulnerabilities is that user inputs are not authorized before used in business function s. if !authenticateuser request.params request.params throw new exception invalid user updatecustomerbalance request.querystring nbalance figure .
a code snippet vulnerable to improper authz cross site request forgery csrf flaw s an attacker deceives an authorized user by sending a forged request to the user s application to perform malicious action s. this attack requires the victim to have a valid session or cookie with the application already authorized .
the signature of these vulnerabilities is that requests origins are not validated or that responses are usually predictable or have fixed url format.
it is usually difficult to identify csrf using static analysi s techniques because it is usually managed by the web server .
security misconfiguration flaw s the system is not securely configured.
this includes exposing information through exceptions system executing with higher privileges than required system files are accessible to unauthenticated users or resources have misconfigured permissions.
some of these vulnerabilities can be discovered from the exception handlers whether they expose system details or not.
others need to be ex amined by application response s for unauthorized actions using dynamic analysis .
unvalidated redirect and forward flaw s the application redirects requests to a target url that is concatenated from user inputs response.redirect userinput .
this type of vulnerability is similar to the injection vulnerabilities where web redirect functions use external inputs to build the redirect url.
failure to restrict url access flaw s an application does not perform access control on resources or urls.
these vulnerabilities can be easily examined b y checking webpage methods for authorization function calls.
dynamic analysis is required to check application responses for unauthorized urls.
insufficient transport layer protection flaw s sensitive data including credentials and customer data are transm itted in plain text.
the signature of these vulnerabilities is that output data are transmitted without passing by encryption functions.
dynamic analysis is required to examine application responses if the protection is done on the transport layer .
from this analysis we deduce d two points i top10 vulnerabilities reflect categorization we introduce in section .
i.e.
input validation such as sqli url redirection csrf output validation such as xss information exposure and hosting service such as security misconfiguration and insufficient transport layer protection and ii many of these top10 vulnerabilities can be discovered using static source code analysis vulnerabilities related to the program itself while other require dynamic analysis vulnerabilities related to the hosting service or configurations .
.
why formal ized vulnerability definition?
the s ecurity analysis for a given system includes different tasks that are usually performed at different stages of the system implementation.
threa t analysis is conducted at early stages of the system development usually during the system design phase.
here the software development team work together to identify possible problems that may arise from using specific platforms architectures languages and the expected deployment model.
a formal vulnerability definition as shown in figure facilitates identifying possible weaknesses in a given platform or language.
vulnerability analysis is applied during system development or after development has b een completed.
it targets identifying security compromising errors in the system implementation.
a formal vulnerability definition helps in automating vulnerability analysis as we will show later in this paper.
attack analysis is applied after the system h as been deployed or when a detailed deployment model becomes available.
it focuses on identifying possible attack vectors on system resources given the networked system.
a formal definition helps identifying preconditions and consequences for each vulnerab ility instance found in the program.
threat analysisvulnerability definition vulnerability analysis attack analysis figure .
vulnerability definition and security analysis tasks .
our approach we base our security analysis approach on i a formal vulnerability definition schema that captures every detail related to a given vulnerability.
this helps in every security analysis task as discussed above ii a formal vulnerability signature specification approach that can capture security vulnerability signatures and iii an extensible vulnerability analys is tool that perform signature based program analysis.
here we introduce a static analysis component only .
we are working on an integrated vulnerabilit y analyzer that performs static and dynamic analysis.
figure .
weakness definition schema .
vulnerabili ty definition schema we studied the various security analysis tasks vulnerability attack and threat analysis to identify the key items required in these tasks that should be included in a vulnerability definition schema shown in figure .
these vulnera bilities definitions should be managed by security experts may be used as extension of cwe database .
vulnerability id every discovered vulnerability instance as in the nvd database should have a reference to its parent weakness or vulnerability defin ition.
this helps retrieving vulnerability details e .g.
preconditions consequences .
category many categorization schemas for software vulnerabilities do exist.
each categorization schema helps understanding weaknesses from a specific point of view e.g.
developers or researchers .
a categorization based on the root cause or source of the weakness shown in figure helps in vulnerability analysis mitigation and even avoidance.
thus we propose to categorize vulnerabilities as input validation processing logic output validation hosting service hosting media communication channel storage and security control vulnerabilities.
language platform specifies the language s that a given vulnerability applies to i.e.
many languages have language specifi c vulnerabilities such as c c c java etc.
we also use this to describe the technology or architecture paradigm inherent with the vulnerability e.g.
client server web based service oriented or multi tier along with the underlying environment e. g. web server client application server database server.
this helps in threat analysis to identify possible vulnerabilities that may exist and start taking precautions to avoid such vulnerabilities .
preconditions this attribute aids both vulnerability analysis and attack analysis.
preconditions are a list of the capabilities that an attacker should possess or the list of system configurations that need to be present in order to exploit this vulnerability e.g.
to exploit a specific vulnerability an attacker might have to have root access user access remote root access public access etc.
consequences if a given vulnerability exploited what will be the benefits achieved by the attackers e.g.
disclosure of system information invalid processing inva lid results execute an unauthorized function elevate permission bypass security crash or d enial of service dos.
this can be used in planned attacks e.g.
using vulnerability v1 will help the attacker to obtain a set of privileges.
the se privileges may be preconditions of vulnerability v2.
the consequence of v2 may be the actual goal of the attacker.
impacted resources this specifies the resources that will be impacted if the given vulnerability exploited including memory configuration files registr y customer data credentials cryptography keys.
likelihood the probability that the given vulnerability is exploited by an attacker may be low medium or high.
this depends on the complexity of the given vulnerability and attacker capabilities as defi ned in the vulnerability preconditions.
vulnerability signature a vulnerability signature describes patterns that when matched in a target program mean it is likely to have the given vulnerability.
this may be signature of code snippets or signature of system response for request s with specific signatures .
every single vulnerability may have different signatures that capture different forms scenarios or that are applicable with different vulnerability analysis techniques.
prevention a list of precauti ons to be followed or checked during code review .
these might be rules to check during system development or deployment combinations of architectures languages and platforms to use or not to use .
mitigations indicates how we can modify the vulnerable system entities to block a discovered vulnerability.
this may require modification of the vulnerable code parts changing system configurations or even changing system architecture.
.
vulnerability signature specification existing software security weakne ss or vulnerability definitions in the common weakness enumeration cwe database help in understanding the nature of a given vulnerability .
however they do not directly help in locating such vulnerabilities in target systems.
formalizing these descripti ons helps vulnerability analysis tools in automating the vulnerability analysis process.
ideally a formal vulnerability signature specified by security experts should be specified on an abstract level far from the source code and programming language det ails enabling locating possible vulnerability instances in different programs written in different programming languages.
vulnerability name id signaturepreconditions consequences impacted resources likelihooddescription mitigation actionsprevention actionscategorylanguage platform103 figure .
our system description class diagram used by our ocl based vulnerability signature approach we use ocl as a well known extensible and formal language to specify semantic rather than syntactical signatures of security weaknesses.
to support specifying and validating ocl based signatures we have developed a system description model shown in figure .
this model is inspired from our analysis of security vulne rabilities s ection .
it captures main entities in an object oriented program including components classes instances inputs input sources output output targets methods method bod y method statements e.g.
if else statements loops new objects etc.
moreover it captures security concepts such as authenticat ion authorization audit etc.
and other system details such as hosting service deployment descriptors etc.
each entity has a set of attributes such as method name accessibility variable name variable type method call name etc.
this enables specifying ocl based vulnerability signatures on different system entities other than source code entities classes methods code blocks such as deployment descriptors configuration files hosting services web server storage output targets or input sources.
of course this requires developing different parsers other than code parsers that can read such entities .
moreover this requires a comprehensive vulnerability analyzer that support s locating signatures in such entities as well as source code .
the vulnerability analysis tool should have different profiles for different languages and platforms asp.net php c java etc.
.
thus vulnerabilities with signatures containing input source or output target security authentication authorization sanitization and other functions can be interpreted differently based on the program platform or programming language used.
if the system uses custom sanitization or security functions developers have to mark their security functions in the resulting system model .
table1 shows some vulnerability signatures specified in ocl using our system description model figure for example sqli signature any method that has method call statement s where the callee function is executequery and one of the parameters passed to it is previous assigned to untrusted identifier coming from one of the input sources.
this initial signature can be revised to incorporate taint analysis checking .
taint analysis can be defined as an ocl function that adds every variable assigned to a user input parameter to a suspected list.
in this case we update the vulnerability signature to use method.suspectedlist .
contains x instead of x.contains inputsource as in table1 .
table1.
examples of ocl specified vulnerability signatures vul.
vulnerability signature sqli method.contains s methodcall s.fnname executequery and s.arguments.contains x identifierexpression x.contains inputsource xss method.contains s assignmentstatement s.rightpart.contains inputsource and s.leftpart.contains outputtarget improper authn.
method.ispublic true and method.co ntains s methodcall s.isauthenitcationfn true and s.parent ifelsestmt and s.parent.condition.contains inputsource improper authz.
method.ispublic true and method.contains s expression s.contains x inputsource x.issanitized false or x.isauthorized false xss signature any method statement s of type assignment statement where left part is of type output target e.g.
text label grid etc.
and right part uses input from the tainted input sources.
improper authentication signature any public method that has statement s of type method call where the callee method is marked as authentication function while this method call can be skipped using user input as part of the bypassing condition.
imprope r authorization signature any public method that has statement s of type expression i.e.
any statement where s uses data x without being sanitized authorized or simply taint data method.suspectedlist .contains x true .
a key problem with these signatures is that we do not consider security solutions applied beyond the system source code either using proxies to filter sql queries or using security controls deployed on the web server as an http handler.
these can be handled by appending a d ynamic signature forming a sequence of ocl constraints to be checked on system responses to malicious requests.
another issue is that we may have different signatures with different complexities for the same vulnerability.
we expect security experts to dev elop strong and complete signatures.
weak signatures mean more false positives which may annoy developers or more false negatives which harm customers.
.
ocl based static vulnerability analyzer given that vulnerability signatures are now formalized in o cl the static vulnerability analysis component become s a program analysis tool that traverse s the given program looking for code 104snippets that match the given vulnerability signatures.
figure describes the architecture of our static vulnerability analy zer based on the formalized vulnerability signature concept.
program source codeprogram representation abstract syntax tree program representation n...... signature locatorocl functionsplatform profile vulnerability listweaknesses signatures ocl figure .
ocl based static vulnerability analysis tool program source code the program to be analysed can be either a source code or even program binaries dlls exes .
in the latter case we use de compilation techniques to reverse engineer the source code of the given program.
abstract program representation to avoid being specific to programs written in a specific programming language or with a specific coding style we transform the given system code into an abstract syntax tree ast representation.
the program ast abstracts most of the source code details away from specific language constructs.
extracting source code ast requires using different language pars ers we currently support c vb.net and c .
then we perform more abstraction by transforming this ast to our system description model shown in figure .
we support specifying signatures on other system aspects including features architecture etc.
fo r example one may check for vulnerability signatures of code that realize specific features.
this also helps in combining static analysis and dynamic analysis where results of the static analysis used to drive black box testing scenarios.
signature locato r this is the main component in our vulnerability analysis tool.
it receives the abstract system representation and generates a list of possible vulnerabilities in the given system along with their locations in code .
at analysis time it loads the platfor m profile based on the details of the program under analysis.
then it loads the defined weaknesses in the weaknesses signatures database specified in ocl based on the target program platform language.
the signature locator transforms these signatures into constraints and checks on program entities i.e.
code snippets that match the specified signatures.
the ocl functions represent a library of predefined functions that can be used in specifying vulnerability signatures and in identifying possible matc hes.
this includes control flow analysis data flow analysis string analysis taint analysis etc.
the developed weaknesses signatures are compiled using ocl compiler and validated against our system description model before getting stored in the weaknes ses signatures database.
to locate vulnerability matches the signature locator translates every vulnerability ocl signature in a visitor class as in figure9 which has a handler method for every concept used in the ocl signature e.g.
if the signatur e checks that the method is public then the visitor class will have a handler for s ystem entities of type method definition .
this handler contains a set of checks based on the given ocl signature.
the visitor class traverses the target program entities.
i f a visited node has a handler this handler is triggered e.g.
a visitor for sqli signature figure has handlers for method definition and method call nodes.
in the method call handler it will have a condition to check the called method.
if it i s executequery it mark s this entity and contin ues to visit its arguments.
otherwise it skips for another system entity .
the signature locator generates a list of discovered vulnerabilities along with code locations thought to have these vulnerabilities .
we use application vulnerability description language avdl to represent the identified vulnerabilities in xml format to support interoperability with existing vulnerability databases such as nvd.
.
implementation we briefly describe some implementation details of our formal static vulnerability analysis tool.
first we developed a ui component to assist security experts in capturing vulnerability signatures in ocl.
this provides vulnerability specification and signature editing including checking valid ity of ocl statements and test ing of specifications on sample source code .
we use an existing ocl parser to parse and validate signatures against our system description model figure .
once validated the vulnerability signature is stored in the signatures database .
next to parse the given program source code and generate a system abstract model we use an existing .net parser nrefactory library which supports vb.net and c .
moreover we have used a c parser written in python called pycparser .
thus we now support locating vulnerabilities in c vb.net c and c .
we are working on parsers for php and java.
for a system with binaries only available we use an existing de compilation tool ilspy to generate code from binaries.
this is currently suppor ted for c and vb.net only.
third we developed a class library to transform the generated ast into a more abstract summarized representation as specified in our system description model.
this reduces its size and complexity to reflect only necessary details required in signature s matching reduce complexity and make our technique more scalable than if a full ast was used.
other system models such as system features architecture etc.
can be specified by the system provider and added to our ast mode l. fourth our signature locator has an ocl translator that translates a given ocl signature into a visitor class.
this visitor class is used to traverse system representation entities.
for each entity it performs customized checks as determined in the ocl si gnature.
public class sqliv isitor abstractasttransformer public override object visitmethodcall invocationexpression s if s.fnname executequery foreach statement x in s.arguments if x.acceptvisitor this !
null count list.items.add s.startlocation s.endlocation ... public override visitidentifierexpression identifierexpression x if ocllibrary.istainted x.identifier true return true ... figure .
sample of the sql injection visitor class figure shows a sample visitor class generated from the simple sql injection signature specified in table .
the sqli visitor class implements a set of predefined functions based on each part in the sql injection signature e.g.
the visitmethodcall function is related to the condition method.contains s methodcall etc.
context method suspectedlist collection identifier let userinputs collection identifier method.
parameters post result method.body select stmt assignmentstmt rightpart.contains userinputs select id identifierexp figure .
sample of the tainted data analysis function our ocl functions library has a set of functions required during the analy sis phase.
this includes control flow analysis cfa data flow analysis dfa tainted data analysis etc.
these functions are defined in ocl and can be extended with further static analysis functions based on future vulnerability analysis 105needs.
an ocl t o c transformer performs a transformation for these functions as well as new ocl signatures once defined.
program slicing and taint analysis techniques core techniques in program and security analysis area can be easily captured in ocl .
figure shows a sample tainted data analysis function defined in ocl.
this can be extended to filter sanitized variables variables processed by sanitization function s .
profile platform asp.net inputsources source web.httprequest.get querystri ng source source web.httprequest.get cookies source ... outputtargets target system.web.httpresponse.write target target ui.webcontrols.textbox.set text target target webcontrols.hyp erlink.set navigateurl target ... figure .
sample of the platform profile for asp.net our vulnerability analyzer depends on platform profile s to set the analysis context.
platform profile is an xml document that contains information about a specific platf orm.
it is used to set the context of the signature locator according to the target system implementation platform.
figure shows an example of a platform profile for asp.net.
this is different from java or php profiles.
these functions are used by the s ignature locator as values for the abstract concepts i p sources o p targets etc.
.
.
evaluation in this section we summarize our experimental evaluation we have performed to assess the capabilities of our approach in capturing as well as identified secur ity vulnerabilities.
we apply the ocl based vulnerability signatures illustrated in section .
table .
summary of benchmark applications statistics benchmark downloads kloc files classes method ast galactic .
splendidcrm kooboo blogengine .
bugtracer nopcommerce rel.
webgoat .
benchmark applications we have selected a set of seven web based open source web applications developed asp.n et as a benchmark to evaluate our approach.
these applications cover a wide business spectrum including galactic is an erp system developed internally in our group for testing purposes.
splendidcrm i s an open source crm that is developed with the same capabilities of the well known open source sugarcrm.
it has a commercial and community versions.
kooboo is an open source enterprise cms used in developing websites.
blogengine is an open source asp.net .
blogging engine.
bugtracer is an open source web based bug tracking and general purpose issue tracking application.
nopcommerce is an open source ecommerce solution with more than releases.
webgoat is developed by owsap for security testing purpos es.
except for galactic we did not have experience with these applications security .
table summarizes statistics of these applications including known no.
download size kloc files classes methods and ast build time msec .
.
metrics used to assess t he effectiveness of our approach in discovering security vulnerabilities using static program analysis we use a set of metrics to measure the soundness and completeness of the analysis technique .
these metrics are precision rate recall rate and f measur e. the precision metric is used to assess the soundness of the approach.
a high precision means that the approach returns more valid results true positive tp than invalid results false positive fp .
thus the maximum precision is achieved when no fal se positives see equation below .
the recall metric is used to assess the completeness.
a high recall means that the approach returns most of the valid results true positive tp than missed valid results false negative fn see equation .
the f measure metric combines both precision and recall.
it is used to measure the overall effectiveness of the approach weighted harmonic mean .
this metric depends on the importance of the recall rate and the precision rate e.g.
if we are interested in high pr ecision more valid vulnerabilities then we will give precision factor high weight and vice versa.
in our evaluation we assume that the importance of the precision rate and recall rate is equal see equation .
eq.
eq.
eq.
table .
experimental results of applying ocl based vulnerability analysis tool on benchmark applications.
d discovered vulnerability fp false positives and fn false negatives.
columns represent ids of the benchmark applications galactic splendid kooboo blogengine bugtracer nopcommerce and webgoat.
vuln.
tot.
sqli d fp fn authn.
bypass d fp fn authz.
bypass d fp fn xss d fp fn csrf d fp fn info.
expo.
d fp fn url redir d fp fn total d fp fn d fp fn d fp fn d fp fn d fp fn d fp fn d fp fn d fp fn sqli authn.
bypassauthz.
bypassxss csrf info.
exposureurl redirectnumber of vulnerabilities vulnerability type7 chart .
discovered vulnerabilities per vulnerability type url redirect info.
exposure csrf xss authz.
bypass chart .
discovered vulnerabilities per application precision recall f measure chart .
our achieved precision recall and f measure rates xss csrf url redirect.
authz.
bypass info.
expos.
sql chart .
performance of our approach per vulnerability .
experimental results table summarizes results of our experiments.
we used our approach to analyse applications in the benchmark suite to identify seven of the top10 web applications vulnerabilities from the owsap2010 report .
other vulnerabilities could not specify static signatu res use static program analysis .
however specifying dynamic signatures for these vulnerabilities is easy.
table summarizes for each application and each vulnerability analysed the total time taken number of vulnerabilities in the code base found fps analyser thought vulnerability but there is not on manual analysis and fns manual code analysis indicates a vulnerability but our tool did not discover it .
chart shows the number of discovered vulnerabilities grouped by vulnerability type.
the sqli represents the most frequent vulnerability in all applications th en cross site reference forgery csrf vulnerability.
after that cross site scripting xss and authorization bypassing vulnerabilities are relatively equal.
this is mostly conforming to the ranking reported by owsap2010.
chart shows the number of vulnerabilities identified in every application.
it is clear that nopcommerce and kooboo are the most vulnerable applications.
however if we consider the application size factor we see that the ratio of vulnerabilities discovered per compared to application size is about equal.
moreover some applications such as blogengine use microsoft membership for access control which eliminates the authentication bypassing vulnerabilities.
chart s hows the precision recall and f measure rates for each vulnerability type.
this chart shows that we achieve a high precision rate for most of the vulnerability types.
the precision metric is on average .
this means that for each identified vulnerabilit ies we have false positives.
this chart also shows a good recall rate although it is relatively lower than precision rate we achieved.
the recall metric is on average .
this means that in every vulnerability instances we can corre ctly identify and we miss instances.
this value could be improved if we use a hybrid dynamic and static analysis approach.
the overall effectiveness of the approach f measure is around .
a key result from this chart is that the recall metric is higher in sqli xss information disclosure and url redirection than in the other vulnerabilities.
this justifies our initial supposition that although we succeeded in developing a static signature for these signature s csrf authorization and authn.
bypass it is difficult to achieve a high correct detection rate without dynamic analysis.
.
performance evaluation chart shows the time in sec required to analyse the benchmark applications to locate the existing vulnerabilities instances for the given set of vulnerability signatures.
it is clear that the sqli vulnerability takes much more time to identify than xss and authorization bypassing.
the authentication bypass takes the lowest time.
the time required to identify a given vulnerability depends o n number and complexity of specified ocl signatures.
.
discussion in this research we introduce a formal vulnerability definition schema signature specification approach based on ocl and static vulnerability analyser.
vulnerability definition schema cover s most of the details required in security analysis tasks attack threat and vulnerability analysis tasks .
vulnerability signature is specified on an abstract system representation.
this allows applying the same signature on different systems developed w ith different languages.
use of ocl allows formalizing and easing of signatures validation and testing.
moreover a new vulnerability can be easily located in the target system as far as we have a formal signature for it.
we succeeded in producing a vulner ability analysis tool that can work online without a need for new algorithms modules or patches.
the current static analyser achieves a precision rate of and recall rate of .
although we are usually interested in high recall rate which implies les s false negatives i.e.
less number of vulnerabilities that could not be detected by the analyser in the current tool we focused on high precision rate where number of reported vulnerabilities that are false positives i.e.
not a real vulnerability are les s. the reason behind this decision was that static analysers are usually used by system developers who are interested in getting less false positives to mitigate.
another reason is related to the nature of security vulnerabilities.
from our experiments w e determined that not all vulnerabilities can be captured using static analysis and the same applies using dynamic analysis.
vulnerabilities related to source code such as sqli and xss can be described and located using static analysis.
vulnerabilities su ch as csrf are difficult to use static signatures.
from our experience in developing signatures of the top10 vulnerabilities and our experiments we determined that i it is better to use dynamic analysis tools with certain vulnerabilities such as csrf because these vulnerabilities can be handled by the web server.
this means that we have a high false positive if we use static analysis tool to locate these vulnerabilities ii some vulnerabilities can be easily identified and located by static 107analysis such as sql injection and xss vulnerabilities iii some vulnerabilities such as dom based sql and xss vulnerabilities need a collaborating static and dynamic analysis to locate them.
we believe that combining static and dynamic analysis is needed to incr ease the precision and recall rates.
a key problem with static analysis tools is the use of aspect oriented security techniques where security is weaved within the system at runtime.
in this case we will have a high false positive rate because we report v ulnerabilities that are already mitigated by the aspect based security.
the same will occur if external security controls are used such as in database engines to filter sql queries using db proxies to filter queries using web server s deployed security controls such as encryptions authentication and authorization or even provided by the platform through configurations such as asp.net membership or other anti csrf anti xss security controls.
these can be discovered using dynamic vulnerability analysis extensions.
the lack of system engineers annotations of the system security functions may lead to high false positive.
however this problem can be solved by employing dynamic vulnerability analysis.
dynamic vulnerability analysis approaches cannot help in locating specific code snippets where vulnerabilities exist.
moreover they cannot help testing code coverage.
thus a hybrid approach of static and dynamic analysis is required.
we are extending our analyser to support both.
we use a workflow engine to define the analysis sequence using different approaches to locate a given vulnerability.
this increases the recall rate of the overall approach.
moreover we plan to include confidence level with reported vulnerabilities.
this helps developers to priori tize based on criticality and importance.
our ocl based signatures and vulnerability analysis tool can be used in different program analysis problems such as aspect mining refactoring locating bad smells or reengineering impact analysis .
in these c ases system engineers have to specify signatures they want to locate in their programs.
.
related work existing efforts in vulnerability analysis can be categorized into static analysis dynamic analysis and hybrid analysis based approaches.
most of these e fforts designed for specific vulnerability types mainly sqli xss.
jimenez et al.
review various software vulnerability prevention and detection techniques .
broadly static program analysi s techniques work on the source code level.
this includes pattern matching that searches for a given string inside source code tokens extracted from source code or system byte code e.g.
calls to specific functions.
data flow and taint analysis identify data coming from untrusted sources to mark as tainted i.e.
should not be used before being sanitized or filtered.
model checking to detect vulnerabilities depends on extracting a system model from the source code and developing a set of constraints on the m odel that should not occur .
an issue is that model checking approaches often suffer from a state explosion problem and generate only a counterexample.
dynamic analysis techniques analyse a system as a black box avoiding being overwhelmed with system detai ls.
fuzzy testing provides random data as input to the application in order to determine if the application can handle it correctly or not.
dynamic techniques are however limited in code coverage.
static analysis approaches nist has been conducting a security analysis tools assessment project samate .
a part of this project is to specify a set of weaknesses that any source code security analysis approach should support including sql injection xss os command injection etc.
they have also developed a set of test cases that help in assessing the capabilities of a security analysis tool in discovering such vulnerabilities.
halfond et al.
introduce a new sql injection vulnerability identification technique base on positive tainting.
they identify trusted strings in an application and only these trusted strings to be used to create certain parts of an sql query such as keywords or operators.
lei et al.
trace the memory size of buffer related variables and instrument the code with corresponding constraint assertions before t he potential vulnerable points by constraint based analysis.
they used model checking to test for the reachability of the injected constraints.
dasgupta et al.
introduce a framework for analysing database application binaries to automatically identify security correctness and performance problems especially sqli vulnerabilities.
they adopt data and control flow analysis techniques as wel l as identifying sql statements parameters tables and conditions and finally analyse such details to identify sqli vulnerabilities.
martin et al introduce a program query language pql that can be used to capture definition of program queri es that are capable to identify security errors or vulnerabilities.
pql query is a pattern to be matched on execution traces.
they focus on java based applications and define signatures in terms of code snippets.
this limits their capabilities in locating vulnerabilities instances that matches semantically but not syntactically.
wassermann et al.
introduce an approach to finding xss vulnerabilities based on formalizing security policies based on w3c recommendation.
they conduct a string taint analysis using context free grammars to represent sets of possible string values.
they then enforce a security policy that the generated web pages include no untrusted scripts.
jovanovic et al.
introduce a static analysis tool for detecting web application vulnerabilities.
they adopt flow sensitive inter procedural and context sensitive data flow analysis.
they target identifying xss vulnerabilities only.
ganesh et al introduce a string constraint solver to check if a given string can have a substring with a given set of constraints.
they use thi s to conduct white box and dynamic testing to verify if a given system is vulnerable to sqli attacks.
dynamic analysis approaches bau et al perform an analysis of black box web vulnerability scanners.
they conducted an evaluation of a set of eight leading commercial tools to assess the supported classes of vulnerabilities and the ir effectiveness against these target vulnerabilities.
a key conclusion of their analysis is that all these tools have low detection rates of advanced and second order xss and sqli.
the average percentage of discovered vulnerabilities equals .
the analy sis shows that these tools achieve in session management vulnerabilities and in the cross site scripting vulnerabilities.
kals et al introduce a vulnerability scanner that uses a black box to scan web sites for the presence of exploitable sqli and xss.
they do not depend on a vulnerability signature database but th ey require attacks to be implemented as classes t hat satisfy certain interfaces.
weinberger et al introduce an analysis of a set of frameworks that provide xss sanitizatio n techniques.
they identify limitations including lack of context sensitive sanitization that result in developing custom sanitizer that need to be validated for their correctness and supporting client side code dom based xss .
felmetsger et al use an approach for automated logic vulnerabilities detection in web applications.
they depend on inferring syst em specifications of a web application s logic by analysing system execution traces.
they then use model checking to iden tify specification violations.
the extraction of properties 108specifications to be validated is a key limitation in this approach .
they assume that these traces represent correct system behaviour.
hybrid analysis approaches monga et al introduce a hybrid analysis framework that blends static and dynamic approaches to det ect vulnerabilities in web applications.
the application code is translated into an intermediate form.
the resulting static model is filtered to focus only on dangerous statements.
this reduces model size where dynamic analysis will be conducted mitigatin g the performance overhead of the dynamic taint analysis approach.
this approach as most taint analysis approaches either static or dynamic targets only injection related vulnerabilities.
balzarotti et al introduce composition of static and dynamic analysis approaches saner to help validating sanitization functions in web applications.
the static analysis is used to identify sensitive sources sinks methods.
dynamic analysis used to analyse the id entified suspected paths.
compared to existing efforts our approach achieves scalable extensible and powerful signature based vulnerability analysis not coupled to specific vulnerability analysis technique or language platform.
our approach is based on formalizing vulnerability definition including the vulnerability signature part.
.
summary we introduce a new automated formal vulnerability analysis approach.
our approach is based on formalized vulnerability definition schema.
a part of this schema is t he formal vulnerability signature.
this signature specifies a set of invariants that confirm the existence of a given vulnerability in the target program.
we adopt ocl in specifying vulnerability signatures.
we developed a static vulnerability analysis too l that uses our formally specified vulnerabilities signatures to locate possible matches in the target system.
a new vulnerability can be easily identified provided that it has a formal signature.
we validated our approach on a set of seven open source app lications from different domains different sizes and different development models.
our experimental results show that our ocl based static analysis tool achieves precision rate and recall rate.
this means that we achieve a good fp rate an d a fair fn rate .
we are currently working on a dynamic analysis extension based on our formal signatures approach that yields better rates.
.