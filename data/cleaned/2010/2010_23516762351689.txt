user aware privacy control via extended static information flow analysis xusheng xiao1 nikolai tillmann2manuel fahndrich2 jonathan de halleux2michal moskal2 1dept.
of computer science north carolina state university raleigh nc usa 2microsoft research one microsoft way redmond wa usa 1xxiao2 ncsu.edu nikolait maf jhalleux micmo microsoft.com abstract applications in mobile marketplaces may leak private user information without notification.
existing mobile platforms provide little information on how applications use private user data making it difficult for experts to validate applications and for users to grant applications access to their private data.
we propose a user aware privacy control approach which reveals how private information is used inside applications.
we compute static information flows and classify them as safe unsafe based on a tamper analysis that tracks whether private data is obscured before escaping through output channels.
this flow information enables platforms to provide default settings that expose private data only for safe flows thereby preserving privacy and minimizing decisions required from users.
we built our approach into touchdevelop an application creation environment that allows users to write scripts on mobile devices and install scripts published by other users.
we evaluate our approach by studying scripts published by users.
categories and subject descriptors d. .
validation k. computers and society privacy general terms human factors security verification keywords mobile application privacy control information flow analysis .
introduction modern mobile device platforms like ios android and windows phone provide a central place called app stores or marketplaces for finding and downloading third party applications.
a common problem faced by these mobile device platforms is that the published applications in the marketplace may leak private user information through output channels.
many of these applications worked on this project as a microsoft research intern.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
ase september essen germany copyright acm ... .
.
figure information flow view of a sample script access mobile device resources such as pictures and gps that may contain and expose private information and share them using remote cloud services or web services without notifying users .
to mitigate these problems privacy control mechanisms employed by mobile device platforms include two major parts manual app validation by experts experts employed by an app store manually exercise the functionality provided by an app and observe its behaviors for validation access control granting by users app stores ask for permissions before users can install applications android and windows phone or an app requests permissions before it can access users private information ios .
the manual validation process is costly and delays publishing of apps.
it is also incomplete since it cannot examine every execution path to detect violations of privacy policies .
access control granting provides information about what private information these applications may access rather than how these applications use private information causing users to make uninformed decisions on how to control their privacy.
these privacy control mechanism lead to a situation where users simply install applications without questioning the requested permissions even if the applications may silently leak private information .
to improve the privacy control mechanism of these mobile platforms we provide a user aware privacy control approach that reduces efforts for app validation and access granting by computing information flows and classifying information flows as safe unsafe.
our approach automatically computes information flows of private information via static analysis and visualizes the flows as shown in figure .
we use the term source to refer to an origin of private information and sink to refer to a point where information may leak from an app.
the example in figure shows that the app uses capabilities camera location pictures media and sharing .
among these the first are sources and the last two are sinks.
among the possible flows sources to sinks our analysis shows that the location flows to the sharing sink and thatcamera andlocation flow to the media sink.permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
ase september essen germany copyright acm ... .
given the computed information flows our approach employs the mechanism of user driven access control .
when the application is executed for the first time our approach allows users to choose among realinformation anonymized information or abort execution as shown in figure the abort option is not yet implemented in touchdevelop .
these settings provide flexible choices for users using anonymized information e.g.
a fixed picture or a fixed geolocation users can experiment with applications before granting access to real information aborting an execution prevents unintended access to a resource and is helpful for diagnosis.
to assist experts and users in better understanding how apps handle private information and improve privacy control our approach further classifies information flows based on a tamper analysis.
we define a policy to classify information flows as safe or unsafe an information flow is safe if only untampered private information flows to a vetted sink.
a vetted sink is a sink that presents an explicit dialog requesting the user s permissions before the information being shown escapes.
in myer s terminology this dialog corresponds to a declassify step and tampered data has low integrity.
for example in touchdevelop the sharing of a picture taken directly from the camera shows a dialog for users to review the picture before it leaks from the device.
such information flows do not leak private information without notifying users and should be safe.
however a malicious app could encode the user s phone number into the color intensity of some pixels inside a picture to be shared.
the information flow will reveal that private information from the camera andcontact sources flow to the share sink but a user may be hard pressed to recognize any changed pixels in the picture being posted.
our analysis detects such obscure flow by observing whether the information is tampered with before reaching the sinks.
based on the safe unsafe classification of flows our policy is to use real information for sources only appearing in safe flows and anonymized information for all other sources.
our user aware privacy control approach strives for a balance between security and user involvement.
by employing user driven access control our approach ensures that apps gain permissions from users for private information accessed by apps.
to avoid overwhelming the users with access granting which may annoy users and cause users to blindly grant every permission our approach does not ask users to grant access to private information accessed by an app but not flowing to sinks.
furthermore our technique provides default settings that are safe to run a script without further user decisions thereby reducing risk and user burden.
we built a prototype of our privacy control into touchdevelop a novel mobile platform that enables users to write apps directly using touch screens.
in touchdevelop apps are written using a scripting language that is expressive enough to create applications or games utilizing most features of mobile devices .
we call apps written in touchdevelop scripts .
users can publish their scripts in a script bazaar where other users can install and run them on their own devices.
touchdevelop is thus similar to other mobile device platforms except that we use no manual validation only automatic information flow analysis.
our approach works well with the touchdevelop platform for several reasons all code is made available through the script bazaar as source the expressiveness of the language enables apps to be created in fewer lines allowing efficient static analysis on whole scripts the language does not allow reflection eval or native calls to platform apis making code analysis easier .
this paper makes the following contributions we propose a user aware privacy control approach which reveals information flows and their classification to users to assist app validation and user driven access control.
our apfigure grant access to private information proach is a first step towards improving privacy control on mobile devices via automatic analysis.
we present an extended static analysis to compute information flows and check tamper information for classifying information flows as safe unsafe flows.
the automatic computation and classification of information flows and resuling safe default settings enable our script bazaar to operate without any manual script validation .
we built a prototype of our privacy control into touchdevelop both for analyzing published scripts and to present user privacy settings to the user based on our analysis and policy.
we studied scripts published by users to evaluate the effectiveness and performance of our information flow analysis.
the results show that among the scripts use a private source but only scripts .
flow private information to a sink.
among these scripts our approach classifies as safe reducing the need to make access granting choices to a mere .
of all scripts.
alternatively users need to grant access to only sources .
among sources appearing in scripts together with sinks.
.
touchdevelop language touchdevelop allows users to create applications using an imperative and statically typed language .
a touchdevelop script consists of a number of actions procedures and global variables.
the body of actions consists of expressions that either update local or global variables assignments invoke another action or invoke a predefined property conditional statements if then else loop statements for while and foreach that iteratively execute a block of statements.
the global variables are statically typed and their current value is persisted and accessible across multiple script invocations.
as a statically typed language touchdevelop defines a number of data types e.g.
number orstring fors orpicture forpin figure .
each data type provides a number of properties e.g.
p share .
for the sake of the simplicity the language does not provide features that allow users to define new types or properties.
.
classified information flow in this section we illustrate several examples to show how scripts written in touchdevelop may leak private information referred to asclassified information .
figure shows an example of how classified information flows among values such as number andstring .
at line variable locbecomes classified since it contains the geolocation information obtained via the gps.
here we refer to the811action foo nothing vars unclassified varp media create picture varloc senses current location classified s loc describe classified p draw text s p s mutable state is classified p share facebook figure example of classified information flow 1action foo msg message msgs messagecollection i number nothing varpic senses take camera picture pic share facebook share a pic vars currloc classified msgs add msg msg set message s classified varmsg2 msgs at i classified via reference type flow msg2 share facebook vary false ifs contains seattle then y true classified via implicit flow 15action currloc returns r string varl senses current location classified r locations describe location l classified figure implicit and reference type information flow property senses current location as a source of geolocation information.
at line the location is transformed into a string and assigned to s thereby making sclassified.
at line the location string sis rendered as text into the picture p causing pto be classified.
at line the share action of pleaks the classified information of the user s geolocation to facebook.
here we refer to the property share as a sink.
one thing to note is that if line were moved to after line then pwould not be classified.
the later update of s would not affect p. now let s look at another example shown in figure .
at line the message msg is added to the message collection msgs .
the message collection msgs keeps a reference to msg which means that msg can be accessed from msgs at a later time.
at line msg becomes classified which causes msgs to be classified indirectly.
at line msg2 the i th message in msgs may contain the information of msg or other messages.
thus msg2 should also be considered as classified.
we refer to this type of information flow as reference type flow since it occurs through objects such as message collections that contain