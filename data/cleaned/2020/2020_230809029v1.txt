automated and context aware repair of color related accessibility issues for android apps yuxin zhang college of intelligence and computing tianjin university tianjin china yuxinzhang tju.edu.cnsen chen college of intelligence and computing tianjin university tianjin china senchen tju.edu.cnlingling fan college of cyber science nankai university tianjin china linglingfan nankai.edu.cn chunyang chen monash university australia chunyang.chen monash.eduxiaohong li college of intelligence and computing tianjin university tianjin china abstract approximately of the world s population is suffering from various disabilities or impairments.
however many mobile ux designers and developers disregard the significance of accessibility for those with disabilities when developing apps.
it is unbelievable that one in seven people might not have the same level of access that other users have which actually violates many legal and regulatory standards.
on the contrary if the apps are developed with accessibility in mind it will drastically improve the user experience for all users as well as maximize revenue.
thus a large number of studies and some effective tools for detecting accessibility issues have been conducted and proposed to mitigate such a severe problem.
however compared with detection the repair work is obviously falling behind.
especially for the color related accessibility issues which is one of the top issues in apps with a greatly negative impact on vision and user experience.
apps with such issues are difficult to use for people with low vision and the elderly.
unfortunately such an issue type cannot be directly fixed by existing repair techniques.
to this end we propose iris an automated and context aware repair method to fix the color related accessibility issues i.e.
the text contrast issues and the image contrast issues for apps.
by leveraging a novel context aware technique that resolves the optimal colors and a vital phase of attribute to repair localization irisnot only repairs the color contrast issues but also guarantees the consistency of the design style between the original ui page and repaired ui page.
our experiments unveiled that iriscan achieve a .
repair success rate with high effectiveness and efficiency.
the usefulness of iris has also been evaluated by a user study with a high satisfaction rate as well as developers positive feedback.
of submitted pull requests on github repositories have been accepted and merged corresponding author permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse december san francisco ca usa copyright held by the owner author s .
publication rights licensed to acm.
acm isbn .
.
.
.
the projects by app developers and another developers are actively discussing with us for further repair.
irisis publicly available to facilitate this new research direction.
ccs concepts software and its engineering software maintenance tools maintaining software .
keywords mobile accessibility accessibility issue repair color related accessibility issue android app acm reference format yuxin zhang sen chen lingling fan chunyang chen and xiaohong li.
.
automated and context aware repair of color related accessibility issues for android apps.
in proceedings of the 31st acm joint european software engineering conference and symposium on the foundations of software engineering esec fse december san francisco ca usa.
acm new york ny usa pages.
introduction nowadays mobile applications apps are ubiquitous .
in addition to providing various functional services for users the importance of mobile accessibility has gained increasing attention from both industry and academia .
mobile accessibility refers to making apps more accessible to people with disabilities when they are using mobile phones .
besides its special significance for the disabled if the developers design a mobile app that has more accessible features such as screen readers talkback for android voiceover for ios they will be able to reach a larger number of audiences.
to this end governments have established laws to help eliminate barriers in electronic and information technology for people with disabilities and leading it companies e.g google apple microsoft meta and ibm have established their accessibility teams to improve app accessibility .
in recent years a large number of empirical studies have been conducted to investigate the characteristics of app accessibility .
these studies unveiled that almost all apps are suffering from accessibility issues .
to mitigate such a severe problem a series of effective automated approaches forarxiv .09029v1 aug 2023esec fse december san francisco ca usa yuxin zhang sen chen lingling fan chunyang chen and xiaohong li detecting app accessibility issues have been proposed such as android lint espresso robolectric google accessibility scanner google accessibility testing framework atf mate labeldroid accessitext latter groundhog and xbot .
yet too many accessibility issues make it difficult to effectively repair in practice.
for example the result in shows that there are issues for each app and .
issues for each page on average.
in addition to the bottlenecks from a large number of issues the various categories of issues further limit repair efficiency.
in other words it is unrealistic for app developers to repair these issues within apps even with substantial human effort also proved by the developers feedback in .
.
to address this problem researchers tried to fix these issues by leveraging automated repair approaches but such effort is in its infancy.
specifically alotaibi et al.
proposed a genetic algorithm guided by a fitness function to automatically repair size based accessibility issues in apps.
moreover the issues related to item labels i.e.
missing content labels can be mitigated by different existing approaches such as social annotation techniques deep learning algorithms and crowd sourcing techniques .
however in addition to the above two issue categories with a large proportion the issues of text or image contrast are also very serious which is one of the most prevalent accessibility issues that affect mobile apps .
as shown in figure text or image contrast also known as color related accessibility issues occurs when the color contrast between the text image and the background is less than the minimum ratio specified by the accessibility guidelines .
such issues make the apps difficult to use not only for people with low vision but also for all users.
linares v squez et al.
proposed a method to generate a brand new color scheme for the ui intending to reduce the energy consumption of the gui in android apps.
although it also changes the color of the ui page it is completely different from its original color scheme and the scenario of their work is completely different from this paper.
there are also techniques for repairing accessibility issues of web pages .
however they focused more on mobile friendly problems such as font sizing tap target spacing content sizing viewport configuration i.e.
sizing issue and flash usage i.e.
rendering issue which can inspire the repair of sizerelated issues however cannot benefit color based accessibility issues.
moreover to help meet contrast requirements on web pages several works focused on recommending color pairs by simply adjusting the color values of texts however they did not pay attention to the original design style of the web page.
additionally the implementation mechanisms are significantly different for web apps and android apps which directly distinguish repair solutions.
thus it is actually a non trivial task due to the following challenges c1 the color related changes should ensure to maintain the consistency of the design style between the original ui pages and repaired ui pages.
c2 the ui components with issues and their corresponding attribute to be modified need to be accurately located and determined.
meanwhile it should be determined whether the involved image files that are relevant to the image contrast issues really need to be modified.
c3 the repaired results need to be evaluated and confirmed by real users and developers.
to address these above challenges we proposed iris an automated and context aware approach to repa iring the colo r related a t ext contrast b image contrast allow locationchoose a storage to start benchmarkingxfigure examples of color related accessibility issues in apps.
access ibility i ssues for android apps.
specifically to address c1 we design a novel context aware technique that resolves the optimal colors by leveraging the well designed criteria for color value resolving and the color reference db construction.
the contextaware technique can ensure the design style consistency between the repaired ui pages and original ui pages for apps.
for c2 taking the selected colors as input we use an attribute to repair localization method by analyzing the source code of relevant layout files to determine the component attributes that should be modified.
meanwhile the repair constraints parsing step helps to determine if the image contrast issues need to be really fixed.
based on these key phases the issues within the apps can be effectively repaired and validated before a new repaired apk android application package file is released.
last but not least to address c3 we carry out a comprehensive and well designed user study to help evaluate our repaired results.
we also submit a number of pull requests for real github projects to help improve the accessibility of their apps.
to evaluate the effectiveness efficiency and usefulness of iris we designed a series of experiments on real world apps including both closed source and open source apps.
the results show that irisperforms a high repair success rate of .
and costs .
minutes per app on average.
finally based on the user study results and the developers feedback we highlight that iriscan really help developers fix color related accessibility issues and practically improve the app accessibility.
the user study results also show that the consistency of the original design style is well maintained from the perspective of both the ui page and the app level.
till now we have submitted pull requests on github repositories and projects have merged our repaired results and another developers are actively discussing with us for further repair.
in summary we make the main contributions as follows.
to the best of our knowledge irisis the first automated approach proposed to repair color related accessibility issues for android apps.
we make the tool and relevant data public available on github 1to facilitate new research areas for improving app accessibility.
we propose a novel context aware technique that resolves the optimal colors to ensure the consistency of design style between the required ui pages and the original ui pages.
additionally a color reference db collected from apps has been constructed and released to help resolve the optimal color value for the color selection.
and context aware repair of color related accessibility issues for android apps esec fse december san francisco ca usa 60original uirepaired ui participants with normal vision implemented by xml code t extview android layout width fill parent android layout height wrap content android textcolor 80ff0000 android text hello button android background 80ff0000 implemented by java code t extview tv t extview this.findviewbyid r.id.tv tv.sett extcolor 0xff000000 figure examples of color related layout implementation.
the experiments on real world apps including both closed source apps and open source apps demonstrate the effectiveness and efficiency of our approach.
a well designed user study clearly demonstrates the usefulness of our approach.
moreover the positive feedback from real developers has also highlighted the practicality of iris.
preliminary .
color related accessibility issue as shown in figure color related accessibility issue includes two types text contrast issue andimage contrast issue .
the former corresponds to visible text where there is a low contrast ratio between the text color and background color.
the latter refers to images with a low contrast ratio between the foreground and background colors.
the visual presentation of text and text images has a contrast of at least .
text below point regular or point bold while the contrast of large scale text point and above regular or point and above bold and large scale text image is at least required by web content accessibility guidelines wcag and google accessibility guidelines for android .
these two types of issues frequently occur in apps and significantly reduce the app accessibility.
specifically the examples shown in figure have a big visual problem even for all people not just for people with disabilities e.g.
people with low vision and the elderly .
.
color related layout implementation there are main ways to implement the color setting of ui components .
as shown in figure we can use xml layout code to set the color property for different ui components.
for example we can use android textcolor line to draw the color for the text of textview and android background line to config the color for the background of button .
the same functionalities can be completely replaced by java code by using the corresponding apis like settextcolor line .
.
reports collected from detection tools the input required for repair needs to be obtained from the google official accessibility testing framework atf a library collecting variable accessibility related checks on view objects as well as accessibilitynodeinfo objects.
among the existing accessibility issue detection tools using atf xbot which is a fully automated approach for detecting all 60original uirepaired ui participants with normal vision details of detection report t ext contrast a2dp.vol id pi tv name the item s text contrast ratio is .
.
this ratio is based on an estimated foreground color of ffffff and an estimated background color of fafafa.
consider increasing this item s text contrast ratio to .
or greater.
part of layout file provided by xbot node bounds selected false content desc package a2dp.vol class android.widget.t extview resource id a2dp.vol id pi tv name text a2dp volume index 4567figure the example of report generated by xbot .
types of accessibility issues based on the atf and google accessibility scanner has the ability to explore the app ui with high activity coverage and can effectively and efficiently collect a relatively comprehensive dataset of accessibility issues.
therefore we finally choose xbot as our issue detection and collection tool which takes as input an apk file and outputs its exploration and detection results.
figure is a partial example of the detection report and layout file provided by xbot.
the detection report prompts the type of the accessibility issue i.e.
text or image contrast the unique identification of the component i.e.
resource id andnode bounds and the specific information of the issue.
moreover xbot also provides the rendered ui screenshot for each activity.
.
default solution in android android os provides support for addressing color related accessibility issues .
the repair strategy is that the system setting of high contrast text will change the ui components of used apps to black or white according to the original color trying to make the text on the device easier for the user to read.
however after this setting is turned on the text of all colors in the app will be changed into white or black which will completely change the design style of the ui pages.
approach figure shows an overview of iris which takes as input an apk file along with the issue reports and outputs a repaired apk file without color related accessibility issues.
there are no special restrictions on the input apk while the required reports are provided by atf .irisconsists of three main phases reference db construction which analyzes the ui components without color related issues from a large number of detection results and constructs a reference database to further help select optimal color.
contextaware color selection which is a novel context aware technique that resolves the optimal value of the color replacement through two strategies based on our well designed criteria for color value resolving.
attribute to repair localization which is used to locate the position of relevant ui components and further determine the attributes of components that need to be modified.
after that iris replaces the attributes of the problematic ui component with the resolved optimal color value and updates the corresponding layout files or source code to repair the app.
.
reference db construction to provide reference values for selecting the optimal value of the replacement colors the goal of this phase is to construct aesec fse december san francisco ca usa yuxin zhang sen chen lingling fan chunyang chen and xiaohong li figure overview of iris.
reference database containing a dataset without color related issues i.e.
meet the requirements of standard color contrast .
we highlight the replacement color selected from the database that has been used in real apps and accepted by the app designers.
based on our investigation of the detection reports we notice that if we only consider the color used by the app itself it may be difficult to find a replacement color that can be applied since most ui components in an app generally share the same color value.
therefore it is essential to construct a database composed of multiple apks instead of only relying on an app itself.
meanwhile we investigated that different types of ui components e.g.
button edittext andtextview have different display styles.
therefore the influence of the category of components needs also be thought about in the reference database construction.
based on these primary investigations owing to a significant number of accessibility issue reports detected by xbot we first collect all ui components without contrast issues for all selected apks.
meanwhile we categorize this dataset by the ui component type.
in a similar manner for each apk we also collect the ui components without issues.
the purpose of building the database is to obtain the color pairs composed of the foreground color and background color of each ui component.
for the component dataset without issues the reports do not involve the specific value of the color pair of ui components so we need to make further efforts to compute the value of the color pairs.
in this process we extract the values of the key foreground and background colors from the screenshot of each ui component.
the color composition of a single component is relatively simple and usually consists of only the background color and the color of the text or image on it.
therefore we use getcolors in the image module to return the two most used colors in the screenshot.
after judging that the result meets the required contrast the color pair is returned as a replacement value for reference.
.
context aware color selection given a component with color related accessibility issues the goal of this phase is to determine the optimal replacement color for components which do not violate the standard color contrast on the premise of maintaining the style of the original design as much as possible i.e.
context aware .
this is also the innovation of our approach that is to ensure style consistency at all design levels.
when resolving the optimal replacement color two aspects need to be considered for a component with low contrast how to decide whether to change the foreground color or background color or both?
what is the strategy of color selection and what are the criteria for color value resolving under the selection strategy?
for question many ui components usually share an area with the same background color or call the same resource defining the background color on one page of an app.
therefore choosing color from app itself color from similar activitycolor from same type of ui componentselected colors complementary strategyoptimal color selectioncriteria for color value resolvingstandard for consistent color saturationhue consistency standard of the ui pagecolor from app itselfcolor from same type of ui components2complementary strategycontext aware color selectioncriteria for color value resolvingconsistency of ui component designconsistency of ui page design1figure the workflow of context aware color selection.
to modify the value of the background color is too easy to have a chain reaction which may change the color contrast between the foreground and background of other ui components or even lower than the standard value and introduce new accessibility issues.
the risk caused by this modification is high.
compared with the background color the foreground color is relatively independent usually expressed as the color of the text in the component or the main color of a picture.
when the foreground color changes it would probably not trigger changes in other parts of the ui page.
therefore our approach takes priority to modifying the foreground color of the problematic component with the goal of obtaining the optimal solution for the replacement color.
after determining the target to be modified the next problem to be solved is to find the replacement color required for modification.
the most important thing is to keep the original ui style unchanged.
therefore for question as shown in figure we propose two strategies of color selection.
.
.
color selection strategy.
two situations 1the color replacement based on the reference db.
through this strategy we can get the replacement color from the app itself or the dataset filtered by the same component types in other apps.
specifically if we can find alternative colors from the app itself we can directly use the colors defined and used by this app itself for replacement which is more in line with the color selection intention of the app designers.
if no suitable replacement color can be found in the app itself we will consider the same component types collected from other apps.
because the same types of components probably share similar design styles.2complementary strategy will be applied if we cannot find a replacement color from the reference db.
this strategy chooses the replacement color by directly modifying the original foreground color for the problematic component while maintaining the design style of the ui component and the coordination of the ui page.
.
.
criteria for color value resolving context aware .
note that the replacement color matched from the reference db by using the background color of the problematic component is a set of color candidates.
meanwhile a reference is also required to directly modify the value of the original color when using the complementary strategy.
thus to maintain the original design style of the app as much as possible we define two criteria for color value resolving.
1consistency of ui component design the hue and saturation level are consistent with the original color of ui component.
consistency of ui page design the hue is more harmonious with the overall hue of the ui page.
consistency of ui component design.
from the perspective of component design the color matching of components representsautomated and context aware repair of color related accessibility issues for android apps esec fse december san francisco ca usa the designer s intention.
ui designers usually first consider the hue of components when setting colors for them such as the color of red or blue.
in addition colors with the same hue but different saturations also have great visual differences.
actually various saturations produce a variety of visual impacts and attractions.
for example a color with high saturation is bright which can make the main body stand out from the background while a low saturation color can give people a low key and subtle feeling.
therefore when considering the designer s intention to the greatest extent and ensuring that the replacement color is relatively consistent with the original color it is crucial that the hue and saturation level of the replacement color and the original color should be consistent.
we use hsv hue saturation value to meet such a criterion since the hsv color model is consistent with the way humans describe colors and allows independent control of hue saturation and intensity value .
the hsv values of colors can be calculated using their rgb values by formulas .
h max min g b max min max r b r max min max g r g max min max b s max max min max max v max where r g and b represent red green and blue values of the rgb of one color and max and min represent the maximum and minimum values between r g and b values.
these formulas operate on values in the form of decimal numbers.
based on this standard according to the practical color coordinate system pccs we divide the calculated saturation value from to into three saturation levels low .
medium .
.
and high .
.
when filtering the replacement color values we only retain the candidate values with the same hue and saturation level as the original color.
consistency of ui page design.
as shown in figure when considering the color coordination degree of the whole ui page we leverage eight harmonic types defined on the hue channel of the hsv color wheel as the second criterion .
each type shows the hue color distribution in the harmonic template the size of the gray area is fixed but the position is not fixed and it can rotate around the center of the circle .
in other words if all the hues of a ui page fall in the gray area of a certain harmonic type the color replacement of the page is considered to be harmonic.
using the two strategies with two criteria defined in figure we can get the final optimal color for replacement.
as shown in algorithm before calculating the optimal replacement color value iriswill obtain the set of colors available for replacement from the reference db colorsetref and calculate the optimal harmonic type and deflection angle corresponding to the ui page besttand bestalpha .
after obtaining the inputs we calculate the hsv value of the original color first line .
then by judging whether the hue and saturation level of the replaceable candidate color is consistent with the original color consistency of ui component design acolorset line line that meets the consistent color hue and saturation standard is selected from the set of replaceable candidate t type n type i type i type v typex type l type y typefigure eight harmonic types for color value resolving.
colors.
if the colorset is not empty the distance between each color in the colorset and the shadow part of the optimal harmonic type is calculated line .
the smaller the distance is the more consistent the hue consistency standard of the ui page is consistency of ui page design .
the color with the smallest distance is selected from thecolorset as the optimal replacement color line .
if the colorset is empty it means no appropriate color can be selected for replacement from the existing reference db.
to find a suitable replacement color we use the complementary strategy to directly modify the hsv value of the original color.
if the original color is black white gray and other achromatic system colors neutral colors since there is only a difference in brightness between them it is only necessary to adjust the brightness v value of the original color up and down until the changed color meets the standard color contrast line .
at this time since the changed color is still neutral the hue h channel of the hsv color wheel of the whole ui page will not be affected consistency of ui page design .
the saturation s value of the original color is also not changed.
but if the original color belongs to the color system not neutral colors adjust the value of h and s on the premise that the hue and saturation level is consistent with the original color consistency of ui component design adjust the value of h first and then adjust the value of s to obtain the replaceable value colorhs line .
adjust the value of s first and then adjust the value of h to obtaincolorsh line .
finally the color closest to the original color is selected as the optimal replacement color among the two replaceable colors line .
.
attribute to repair localization after obtaining the optimal color for repairing ui components this phase aims to localize the components and determine the attributes to be repaired.
although the input detection report contains specific information about accessibility issues the specific location and the attributes that need to be modified cannot be directly determined.
there are several challenges.
first of all color related accessibility issues include two types of problems.
these two types are different in repair objects and repair methods.
for example for text contrast issues we need to repair the color attribute of the text in the ui components.
for the issues of image contrast we need to replace or modify the involved images.
secondly even for the same type of issues the attributes and the repair conditions to be modified will be different.
in addition how to decide the location of the layout code or source code of the relevant components inesec fse december san francisco ca usa yuxin zhang sen chen lingling fan chunyang chen and xiaohong li algorithm context aware color selection algorithm input colororg the problematic color with contrast issue colorsetref the color candidates selected from reference db bestt the optimal harmonic type of the corresponding ui page bestalpha the deflection angle of the optimal harmonic type output coloropt the selected optimal color 1h0 s0 v0 gethsv colororg 2foreachc colorsetrefdo 3h s v gethsv c ifisconsistenthue h0 h andisconsistentsaturation s0 s then 5colorset .append c 6ifcolorset is not null then foreachc colorset do 8d getdistance bestt bestalpha c 9disset d 10coloropt mindistance disset 11else ifisneutralcolor colororg then 13coloropt adjustv v0 colororg else 15colorhs adjusths h0 s0 colororg 16colorsh adjustsh h0 s0 colororg 17coloropt minchanged colororg colorhs colorsh 18returncoloropt the ui layout files of the app through the existing detection report is also a big challenge.
in this phase iristreats these two types of issues separately and decides the attributes to be modified by analyzing both the layout code and the source code.
.
.
localization of the related ui components .the input report contains two types of tips about the information of the components component id and bounds of a component in the layout.
note that the layout file here refers to the layout file gained by xbot denoted by xbot layout which is different from those obtained by decompiling the apk file denoted by decompile layout .
to localize the relevant components to be repaired we analyze these two different types of information.
for component id since id is unique to objects we can directly locate the property set of the corresponding component in the decompile layout or source code according to the component id figure .
for the bounds of a component the report displays bounds instead of id because xbot sometimes failed to detect the component id.
meanwhile the attribute bounds does not exist in the decompilelayout files.
thus to locate the relevant components we can find the text information of the component according to the bounds in xbot layout and choose to match through the android text attribute indecompile layout the steps in figure .
.
.
acquisition of the related attribute to repair .irisuses static data flow analysis to extract relevant attribute sets shown in figure and figure .
firstly irisparses the app to extract the layout files and smali code .
then through the above analysis iris completes the localization of the relevant components and obtains the attribute sets for each component.
for the two types of accessibility issues the attributes to repair are different.
for text contrast issues the components are generally textview edittext and button which are prone to such problems.
at this time the com.dartchecker id statistikbutton the image s contrast ratio is .
.
this ratio is based on an estimated foreground color of and an estimated background color of 5a595b.
consider increasing this ratio to .
or greater.
imagebutton android id id statistikbutton android layout width .0dip android layout height wrap content android src drawable statsimg vector android tint dcdcdc android height .0dip android width .0dip android viewportwidth .
android viewportheight .
vector original detection report layout.xml drawable statsimg.xml drawable statsimg.png selected color repaired1 the item s text contrast ratio is .
.
this ratio is based on an estimated foreground color of ffffff and an estimated background color of dbe2ef.
consider increasing this item s text contrast ratio to .
or greater.detection report node bounds content desc package ch.famoser.mensa class android.widget.textview resource id text dozentenfoyer layout.xml string name action share share log file string string name app name dozentenfoyer string string.xml application android name ch.famoser.mensa.app.dozenttenfoyerapplication android theme style apptheme android label string app name layout.xml style parent style appbasetheme name apptheme item name preferencetheme style netmonpreferencethemeoverlay item item name titletextcolor ffffff item style style.xml selected color repaired1 6originalfigure example of attribute to repair localization for text contrast.
foreground color refers to the color of the text in the component and the background color is the color of the component background.
therefore for such issues the object to be repaired is mainly the color of the text in these components.
however since the text in edittext is mainly used for input hints and the text color is generally light the color contrast of the component does not have to meet the standard requirements and such components need to be filtered out in the localization stage.
to conclude the main attributes involved include android textcolor android textcolorlink android titletextcolor and other attributes or set the attributes in the style file accordingly the step in figure .
figure shows an example of attribute to repair localization for text contrast.
for image contrast issues the frequently occurring components mainly include imagebutton andimageview .
at this time the issue with low contrast is the contrast between the image color and the background color of the component.
therefore to prevent the impact on other components in the ui we choose the image in the component as the repair object.
the first step is to get the image files that need to be repaired.
among them the source file of an image can be directly associated with the ui component through the attribute definition in the layout file.
for example as shown in figure images can be associated by setting the property values ofandroid src orandroid background related to the components.
android src drawable statsimg can be mapped directly to the file name in the resource folder res drawable statsimg.png .
figure shows an example of attribute to repair localization for image contrast.
at this time the goal of repair is to change the color setting of the image in the component.
however some images are actually not suitable for modification so we need to filter out them and conduct repairing which is elaborated as follows.
.
.
repair constraints of images .to distinguish the images suitable to be repaired we divide these images into functional images and ornamental images according to the display intention.
we choose to modify the images or icons that focus more on using functions such as return add cancel and share icons or images representing these meanings which we refer to as functional images .
for the ornamental images if we change the color of the image the display function of the image may be differentautomated and context aware repair of color related accessibility issues for android apps esec fse december san francisco ca usa com.dartchecker id statistikbutton the image s contrast ratio is .
.
this ratio is based on an estimated foreground color of and an estimated background color of 5a595b.
consider increasing this ratio to .
or greater.
imagebutton android id id statistikbutton android layout width .0dip android layout height wrap content android src drawable statsimg vector android tint dcdcdc android height .0dip android width .0dip android viewportwidth .
android viewportheight .
vector original detection report layout.xml drawable statsimg.xml drawable statsimg.png selected color repaired1 the item s text contrast ratio is .
.
this ratio is based on an estimated foreground color of ffffff and an estimated background color of dbe2ef.
consider increasing this item s text contrast ratio to .
or greater.detection report node bounds content desc package ch.famoser.mensa class android.widget.textview resource id text dozentenfoyer layout.xml string name action share share log file string string name app name dozentenfoyer string string.xml application android name ch.famoser.mensa.app.dozenttenfoyerapplication android theme style apptheme android label string app name layout.xml style parent style appbasetheme name apptheme item name preferencetheme style netmonpreferencethemeoverlay item item name titletextcolor ffffff item style style.xml selected color repaired1 6original figure example of attribute to repair localization for image contrast.
from before.
therefore we only choose to repair the functional images .
irisdistinguishes these two types of images by a lightweight static analysis technique that determines whether the images are associated with event handler methods.
the trigger behavior of a component is usually associated with the clickable attribute in the layout file.
therefore we judge whether the corresponding image is classified as a functional image by checking the relevant attributes of the problematic component.
then we execute the optimal color selection algorithm and change the color composition of the original image by changing the value of the color model of the pixel of the image such as rgb and rgba which applies to vector images in resources and other types of user uploaded non vector images such as png or jpg.
after obtaining the replacement color and locating the attribute to be modified iriswill directly replace the original values that have issues including the replacement of color values and image files.
iristhen repackages the replaced file to get a new apk.
moreover during repair we also consider many other aspects such as the judgment of foreground and background color to solve the possible detection errors of foreground and background color in the detection reports.
sometimes the set of the foreground color and the background color is reversed in the detection process such as when the detection report indicates the foreground color as and the background color as edf064 when in reality they are exactly the opposite.
before repair we capture screenshots of the ui pages and extract the color information from them to ascertain the true color composition of each component.
experiments to make the experiments we designed better evaluate our approach we raise the following questions rq1 how effective and efficient is irisin repairing the colorrelated accessibility issues?
rq2 how much does each key strategy of iriscontribute to the overall performance?
rq3 how useful is irisfrom the perspective of mobile users and app developers?
dataset.
for reference db construction we randomly collected real apps including open source apps from f droid and closed source apps from google play.
for rq1 and rq2 considering the time cost of testing we randomly selected appstable results for effectiveness evaluation of iris.
issue type real issues repaired issuessuccess rate text contrast .
image contrast .
total .
with an average size of approximately 6mb as experimental subjects of which the number of open source apps and closed source apps is and respectively and used iristo automatically repair them.
it should be noticed that these apps do not appear in the dataset i.e.
used in reference db construction.
.
rq1 effectiveness and efficiency evaluation .
.
setup .to answer rq1 we compare the detection results of apps before and after repair.
first we use the xbot tool to conduct a preliminary detection on the tested apps and count the color related accessibility issues of those apps before repair.
then we take the detection results and apk files as input use the iristo repair the color related accessibility issues of these apps one by one repackage them and output new apk files.
to get the results after repair we use the xbot tool to detect the repaired apk files again and obtain the detection results.
we evaluate the effectiveness of irisby comparing the number of repaired issues and the issues in the same original app.
the success rate for the ithapp mentioned here is denoted by repairr .
repairri nrepairdissue i nallissue i additionally to evaluate the efficiency of iris we record the execution time for these apps and compute the average time to demonstrate the performance.
.
.
result .the results of the effectiveness evaluation rq1 are shown in table .
the column real issues represents the number of issues of the text and image contrast contained in all apps.
note that we removed a part of issues when counting the number of real issues for repairing.
the removing parts include theedittext components as we mentioned in .
.
the false positive cases caused by wrong screenshots in the detection reports and the causes altered by the system design style the problem also introduced in .
finally we have real issues with text contrast and real issues with image contrast which owns the most issues among all the issue types accounting for .
.
remarkably because a component uniquely marked by id may be applied to different pages or the same page multiple times there may be two or three issues caused by the same component.
at this time the property only needs to be modified once which belongs to components with the same id.
as for text contrast table shows that the number of issues of apps before the repair is .
among them there are issues that have been repaired successfully accounting for a .
success repair rate and including different ui components.
the repair rate unveils that our tool can effectively reduce the number of text contrast issues.
the root causes of the remaining unresolved issues are as follows.esec fse december san francisco ca usa yuxin zhang sen chen lingling fan chunyang chen and xiaohong li repaired ui detected issues repaired ui detected issues repaired ui detected issues repaired ui detected issues figure examples of repaired issues.
table evaluation of the key phrase context aware color selection .
category repaired issues by reference db repaired issues by direct modification text contrast image contrast total for some components although we have located their locations and initial attribute sets during the repair process and have tried to repair them the user s actions may cause the components to appear in different states during the running of the app failing the repair.
because the color rendering is implemented in complex source code supported by new reconstructed api interfaces of thirdparty libraries rather than the official apis introduced in figure .
errors are due to the shortcomings of using bounds to locate attributes.
in the process of issue detection the detection tool cannot obtain the id of some components so we use the textinformation of the component according to the bounds to achieve positioning and the positioning effect is not as good as using id.
for the issues of image contrast table shows that there are image issues before repair and problems were repaired by iris including different components.
therefore the success rate of image contrast is .
.
there are still issues that have not been solved for the reason of the shortcomings of using bounds to locate.
finally the overall success rate of the two types of issues is .
and the total number of issues repaired is .
figure presents several examples of the repair results by iris.
more examples can be found on our website .
apart from evaluating the effectiveness of irisin the number of repairs we also record the execution time of irisin practice.
when repairing an apk iriswill first use xbot to detect the accessibility issues in it update the reference db and then start to automatically repair.
finally the average time of issue detection and db updating is .
seconds and the average time of repair is .
seconds.
compared with manual repair iriscan greatly shorten the time of attribute localization and provide a feasible reference value for color replacement.
thus irishas high time efficiency.
.
rq2 ablation study .
.
setup .in rq2 we aim to evaluate the key phases i.e.
context aware color selection and attribute to localization .
for the localization the accuracy of this phase is consistent with repairr i.e.
.
.
for context aware color selection there are two strategies to obtain the optimal replacement color selected from reference db direct modification based on the complementary strategy.
we also use xbot to detect the accessibility issues of apk before and after repair and investigate the number of repaired issues by each strategy.
.
.
result .as shown in table for the issue of text contrast and image contrast the proportions of the two strategies are and respectively.
we can see that .
of the issues in the selected apps can be repaired by the reference db indicating the reference color db plays an important role in the phase of context aware color selection.
since the color pairs in reference db are all from real apps their color matching is recognized and loved by the designers and users of those apps which also proves the rationality of our replacement.
that is also the reason why we prefer to utilize the reference db to repair issues as many as possible at first.
meanwhile there are also some issues i.e.
that cannot be repaired by the reference db while they can still be fixed by the complementary strategy.
although the replacement colors obtained using the complementary strategy do not appear in the apps in the existing db they also meet the standards including the color contrast and two designed criteria.
.
rq3 usefulness evaluation to evaluate the usefulness of iris on the one hand it is necessary to conduct a user study on the repaired ui page and repaired app.
meanwhile the consistency of the design style between the original ui pages and repaired ui pages as well as the design style of the app level also should be evaluated by the validation from real users.
on the other hand the pull requests that are accepted by real app developers on github will make our repair results more convincing in a real scenario.
during this process the feedback from real developers facilitates the iterative improvement of iris.
.
.
user study from app users .dataset.
to compare the effects before and after repair from the app users perspective we randomly selected pairs of ui pages from the repaired uis.
each pair of pages consists of the original ui and the repaired ui.automated and context aware repair of color related accessibility issues for android apps esec fse december san francisco ca usa 100original uirepaired uiboth of them participants with nomal vision participants with low vision participants figure participants preference between the original ui pages and repaired ui pages.
then we divided the pairs of pages into two groups as a control experiment for task .
to facilitate the scoring of participants we randomly selected other pairs of pages for task .
in each pair besides the original ui page and the repaired ui page we also added the ui page with the circled issues.
to evaluate the overall coordination of the design style of the repaired apps we randomly selected apps according to the different levels of the ui page number whose ui page numbers are and for task .
among them the number of issues in each app is not less than .
participant recruitment.
we recruited participants from our university including who are near sighted participants for task andtask both of them are near sighted and participants for task .
none of them has used the repaired apps which excludes the potential bias.
the participants are from different countries including singapore the united states germany and china.
these participants include undergraduates postgraduates phd students and staff.
setup.
for app users we design user research from two levels i.e.
the ui level and the app level .
at the ui level we investigate the user s preference for the ui pages before and after repair in task 1and the user s satisfaction with the repair effect of irisintask .
the purpose of task is to demonstrate the usefulness of iris for different users.
to achieve it we divided the page screenshots before and after repair into two groups looked for people who are nearsighted with over .
diopters as participants in this part and asked them to make preference choices for the two groups of screenshots without glasses simulating people with special vision and with glasses normal vision .
in this step the order of each pair of screenshots is random and marked separately.
we request participants to replicate the real world usage conditions as closely as possible when making their selections which aims to accurately simulate the authentic experiences of diverse user groups.
the purpose of task is to test the repair effect of iristhrough the score of participants.
we showed the users the original ui page the detection ui page with the issue identification the problematic component is circled and the repaired ui page.
meanwhile we also explained to the participants what is the color related accessibility issues and the goal of iris.
in this part we randomly look for participants to rate the repair effect of irisand explain the shortcomings of the repair or their suggestions.
the main evaluation criteria are whether the issues are successfully repaired.
2whether the design style of the ui page after the repair is consistent with the original design style.
3whether the color matching of the whole ui page 100original uirepaired uiboth of them participants with nomal vision participants with low vision participantsfigure distribution of participants scores.
table results of task .
app packagecomponent ui page cre allcun allcun repre allpun allpun re jp.co.hateblo.bomberhead .
.
.
.
com.guidoo.lulo.booxx .
.
.
.
ch.rmy.android.http .
.
.
.
after the repair is coordinated.
4whether the color changes are minimal.
5score on the likert scale ranging from to .
at the app level we evaluate the overall coordination of the repaired app through user research task .
the goal of task is to verify whether irisperforms well in maintaining overall color harmony within the app.
we asked the participants to circle the ui pages and uncoordinated components in each app and counted the proportion of repaired components among the circled components.
it is worth noting that we set the same resolution and the same page size for each ui screenshot ensure that each participant can see the same screenshot and eliminate the impact of other factors on user selection.
user study result.
the results of the user study are shown in figure and figure .
figure shows the preference of participants with different vision levels for the uis before and after repair in which the blue bar chart represents the preference of participants with low vision and the orange bar chart represents the choice of participants with normal vision.
on the whole our repair is more attractive to people with low vision.
under the condition of low vision without glasses almost all participants chose the repaired page .
.
meanwhile under normal vision only one third of the results of page preferences are the original pages and more than half .
of the results are the repaired pages.
this also shows that the effect of our repair is also accepted and liked by most people which can effectively solve the impact of low contrast on the viewing effect of people with weak vision.
we also investigated the reasons why some participants chose the original page.
for example they said that they preferred the color matching of the original ui on the premise that they could see the text content.
there is no doubt that this color preference has the participants personal aesthetic standards.
figure shows the distribution of participants score results on the repair effect of irisunder the condition of known issues both participants scores are greater than .
more than one third of the results .
are full scores i.e.
and the results higher than accounts for .
of all scores.
the final calculated average score is .
.
most of the participants said that the color contrast of theesec fse december san francisco ca usa yuxin zhang sen chen lingling fan chunyang chen and xiaohong li table feedback from app developers.
app star version issueid issue state openpods v1.
merged motioneye client v1.
.
alp9 merged tapunlock v2.
.
beta merged itsdicey v1.
.
merged greentooth v1.
merged knightsofalentejo v5.
.
rc merged mundraub android v1.
merged drismo v1.
.
merged icicle for freenet v0.
merged anki android .4k v2.
.
positive response activitymanager v4.
.
positive response mensa v1.
.
positive response mundraub android v1.
positive response repaired ui was improved and easy to read the replacement color selected during repair is also more coordinated with the style of the original ui and the feeling of the page is better than the original uis.
in addition some participants said that the repair of irisis more effective for people with low vision and the color matching of the original ui also has practical advantages under the condition of normal vision.
table shows the feedback results of users on the overall coordination of the repaired apps at the app level.
cre allandpre allrespectively represent the number of components and ui pages repaired by iris whilecun allandpun allrespectively represent the average number of components and ui pages that are considered uncoordinated by the user.
while cun reandpun reare the number of components repaired by irisand contained in the components or ui pages circled by users considered uncoordinated with the design style of the original app .
it can be seen that the components and ui pages repaired by irisare rarely considered to be uncoordinated with the original app which also indicates that when irisis applied to an app with color related issues including multiple ui interfaces the color selected by irisis consistent with the original app design.
.
.
feedback from app developers .setup.
to understand the views of app developers we randomly selected open source apps containing color related accessibility issues from f droid and used iristo repair them aiming to obtain feedback from them about our issue repair results.
although there are many issues detected and repaired in each app to investigate how different app developers of specific apps act towards accessibility issues and the repair result we randomly selected one issue from each app and submit pull requests in the corresponding github repositories in which we introduced the focus of iris implementation functions and the repair results to developers.
we also asked for comments about iris the repair result and suggestions for improvement.
result.
as shown in table till now we received merged pull requests and positive comments.
meanwhile we display the app name app version the number of stars and the id of the pull requests in this table.
during the traceability analysis the developers claimed that looks interesting and good you made a pr and bring in your knowledge in their feedback indicating the usefulness and practicability of iris.
figure shows an example of feedback from an app developer.
she pays attention to repairing such issues and hopes to have tools that uncover and directly fix accessibility issues.
although we find that some developers even figure feedback from the real app developers.
do not know about these contrast issues they have realized the importance of accessibility through irisand want to use it to automatically repair their apps which shows that irisis meaningful.
at the same time other developers think that their limitation is the time to implement the fixes and worry about the difficulty of positioning.
they also hope to have a tool that can automatically analyze relevant issues and irisjust implements this function and realizes the positioning of related components and automated recommendation of replacement colors which shows that irishas practical significance.
more importantly iriscan clearly make more developers aware of these issues so they can effectively avoid them during development.
discussion .
limitations .
.
scope to repair.
irisrepairs the apps based on the input test results so we only repair the problematic components raised in the test report until now.
if there are other components with color related accessibility issues but they are not detected by the detection tool iriswill not repair them.
in addition most of the repair failures are due to the limitations of bounds shown in our experiments in .
.
although using bounds can effectively solve the problem of text contrast it cannot accurately locate the problem of image contrast.
so the repair rate of image contrast is slightly lower.
but if the information identifying the components in the detection report is more accurate the less this restriction will be.
in fact although the repair of the apps highly depends on the detection report if the other effective detection tools can be integrated in the future irisalso works for them because it is scalable in practice.
.
.
object to repair.
irisadopts the method of static analysis in the localization and repair stage to analyze and extract attributes from the app ui layout file and its resource file.
however the properties of some components are set in the app source code.
currently we can only handle the basic implementation by java or kotlin code such as using official api like settextcolor as shown in figure .
we noticed that some third party libraries provide new api interfaces to restructure the official apis.
iriscannot resolve the restructured implementations but they actually do not belong to the research scope of our work.
similarly jetpack uses a new view structure to implement guis therefore irishas restrictions on apps using jetpack.
based on our experiments and investigation most apps use the traditional android xml layouts i.e.
android view to design and implement their ui pages.
therefore the current version of iris is applicable to most recent apps.automated and context aware repair of color related accessibility issues for android apps esec fse december san francisco ca usa .
threats to validity as we mentioned in .
the proportion of the first strategy directly depends on the size of the color reference db we constructed in advance.
if the size changes the proportions of the first strategy will change accordingly.
we are continuing to expand the reference db by running more apps.
in fact under the current situation the proportion of the first strategy is already the largest that is it has the greatest impact on the color selection results.
related work .
accessibility issue repair .
.
mobile platform.
for mobile accessibility automated repair has been a fresh research direction in recent years.
most of the existing studies focused on the issue categories with high proportions such as the issues of item label and touch target .
as for the item label issues the goal of repair is to augment or predict the missing content labels for ui components.
for example zhang et al.
developed methods for robust annotation of app interface elements by leveraging social annotation techniques that have been used on the web.
chen et al.
trained a deep learning model named labeldroid to predict the missing labels.
coala was a similar work based on using deep learning algorithms.
moreover crowd sourcing techniques are also used to recommend the labels of ui components in .
in terms of touch target issues named size based accessibility issues alotaibi et al.
leveraged a genetic algorithm guided by a fitness function to automatically repair them.
all above studies focus on addressing one specific type of issue due to the diverse characteristics of different issues.
compared with these studies we focus on the other issue categories including text contrast and image contrast named colorrelated accessibility issues.
however this category is of great importance and critical not only for its high proportion but also for the impact of mobile accessibility.
.
.
web platform.
substantial efforts are put into automatically fixing accessibility problems in web settings but some of them focused more on mobile friendly problems which can inspire the repair of size related issues however cannot benefit color based accessibility issues.
in the works related to color related accessibility issues the re coloring tool enhanced the accessibility of the entire page by changing the color matching of the entire web page.
tools that modify the color matching of some web components with accessibility issues also tried to improve the contrast of components by changing the problematic text background color pairs but they all lack consideration of the overall design style of the original web page.
last but not least the implementation mechanisms are significantly different for web apps and android apps which directly distinguish repair solutions.
.
accessibility issue detection and analysis compared with mobile app testing including functional testing and security testing mobile app accessibility testing is studied to a lesser extent.
silve et al.
surveyed the available approaches for detecting accessibility issues.
the existing approaches can be categorized into static and dynamic methods.android lint can report missing content labels but it is ineffective for other issue categories.
accessibility scanner can detect issues with the help of manual exploration of the app but is limited to the low activity coverage.
to mitigate such problems eler et al.
developed a model named mate by generating testing cases specifically for accessibility testing.
similarly salehnamadi et al.
proposed latte and groundhog by reusing tests written by developers or automatically generated to validate the accessibility of those use cases.
recently alshayban et al.
detected issues by deploying monkey .
however in a recent work chen et al.
identified such a solution is not effective and they further proposed xbot to automatically detect accessibility issues by leveraging app instrumentation and data flow analysis.
recently several works have also focused on the interactive accessibility of apps when users with disabilities are using assistive technologies such as talkback and voiceover .
a large number of empirical studies focused on investigating the characteristics of mobile accessibility.
ross et al.
unveiled some common labeling issues.
their following work studied the properties of each accessibility type.
yan et al.
investigated if the apps violate the accessibility guidelines and further introduced the degree of violation.
vendome et al.
proposed a taxonomy in terms of the aspects of accessibility issues by analyzing the developers posts on stack overflow.
alshaybana et al.
proposed a metric named inaccessibility issue rate to measure the distribution of such a metric for each app each issue type and app categories.
moreover they also observed this research field from app developers and users.
chen et al.
also conducted a large scale empirical study from the perspective of the issues themselves and revealed many fine grained findings.
conclusion in this paper we propose iristo automatically repair the colorrelated accessibility issues for android apps.
our approach builds a large scale reference db to help design a context aware color selection technique as well as well defined criteria and an effective attribute to repair localization method.
based on these key phrases iriscan identify the optimal color replacement for automated repair and further generate a new repackaged apk for app developers.
our comprehensive experiments including a user study demonstrate the effectiveness efficiency and usefulness of our approach from different aspects.
we finally highlight that the feedback from several real app developers is quite positive and the merged pull requests on github confirm the practicality of iris.
data availability we have released the code of irison github the constructed reference db based on apps and the apk files used in our experiment on google drive .
to facilitate developers to understand the repair performance we also have uploaded the data of the user study and some other repair cases to our website .