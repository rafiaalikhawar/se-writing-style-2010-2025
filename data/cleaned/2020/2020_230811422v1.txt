recommending analogical apis via knowledge graph embedding mingwei liu fudan university chinayanjun yang fudan university chinayiling lou fudan university china xin peng fudan university chinazhong zhou fudan university chinaxueying du fudan university china tianyong yang fudan university china abstract library migration which replaces the current library with a different one to retain the same software behavior is common in software evolution.
an essential part of this is finding an analogous api for the desired functionality.
however due to the multitude of libraries apis manually finding such an api is time consuming and error prone.
researchers created automated analogical api recommendation techniques notably documentation based methods.
despite potential these methods have limitations e.g.
incomplete semantic understanding in documentation and scalability issues.
in this study we present kge4ar a novel documentation based approach using knowledge graph kg embedding for recommending analogical apis during library migration.
kge4ar introduces a unified api kg to comprehensively represent documentation knowledge capturing high level semantics.
it further embeds this unified api kg into vectors for efficient scalable similarity calculation.
we assess kge4ar with java libraries in two scenarios with and without target libraries.
kge4ar notably outperforms state of the art techniques e.g.
.
.
and .
.
mrr improvements showcasing scalability with growing library counts.
ccs concepts software and its engineering maintaining software software evolution software libraries and repositories .
keywords api migration knowledge graph knowledge graph embedding m. liu y. yang y. lou x. peng z. zhou x. du and t. yang are with the school of computer science and shanghai key laboratory of data science fudan university china.
y. lou is the corresponding author email yilinglou fudan.edu.cn .
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse december san francisco ca usa copyright held by the owner author s .
publication rights licensed to acm.
acm isbn .
.
.
.
reference format mingwei liu yanjun yang yiling lou xin peng zhong zhou xueying du and tianyong yang.
.
recommending analogical apis via knowledge graph embedding.
in proceedings of the 31st acm joint european software engineering conference and symposium on the foundations of software engineering esec fse december san francisco ca usa.
acm new york ny usa pages.
introduction third party libraries are pivotal in modern software development enhancing quality and productivity .
however as software and libraries evolve rapidly current libraries might turn unsuitable due to factors like sustainability failures license restrictions lacking features and security performance issues .
this necessitates library migration where developers replace current libraries with new ones to re implement the same software behavior.
such migrations are common in software evolution for example he et al.
found .
.
of open source projects underwent at least one library migration.
however library migration is a very timeconsuming labor intensive and error prone task for developers in practice.
for example the prior study shows that some developers even spend up to days for library migration .
given the currently used library called source library and the api called source api one essential part in library migration is to find an analogical library called target library and an analogical api called target api which can provide the same functionality as current ones.
however manually finding analogical api is a heavy burden for developers since they need to read length api documentation and code snippets of potentially analogical apis while there are an extremely large number and fast changes of thirdparty libraries and apis e.g.
as of january there are common java libraries with apis on libraries.io .
to reduce efforts in manually searching and reading api documentation and code snippets for determining the analogical relationship between libraries and apis many techniques have been proposed to recommend suitable target libraries or analogical target apis.
in this work we focus on analogical api recommendation.
researchers have harnessed diverse resources to facilitate such recommendations including evolution history online q a interactions and api documentation aug 2023esec fse december san francisco ca usa mingwei liu yanjun yang yiling lou xin peng zhong zhou xueying du and tianyong yang .
among these documentation based api recommendation has been intensively studied in the literature since api documentation is prevalent and at low cost to collect while other information could be time consuming to collect and are not always available.
for a given source api existing documentation based techniques calculate the textual similarity between each candidate api and the source api e.g.
the textual similarity between two api functionality descriptions in the documentation and then recommend the candidate api with the highest similarity as the target api.
while promising current documentation based api recommendation techniques face two limitations.
first their way of calculating textual similarity falls short in capturing semantic level connections in api documentation.
these techniques mainly calculate the textual similarity based on the overlapping tokens or measure the token similarity without contextual consideration .
this can lead to identifying analogical semantics in api descriptions that share similar noun phrases but differing action verbs e.g.
set s3 object content vs. get s3 object content length .
additionally these techniques seldom consider domain knowledge when calculating textual similarity.
for example json arrays json objects keys and values are all json related concepts that often occur in apis related to json processing.
concepts in the context of our work refer to domain specific entities or terms often represented by noun phrases that capture specific elements or ideas within the api domain.
without considering such conceptual relationships the estimation of semantic similarity relevance between two analogical apis might be underestimated.
second these techniques typically compute similarity pairwise posing computational challenges with a vast number of candidate apis.
for example envision a library like testng encompassing over candidate apis.
existing techniques require performing over pairwise comparisons to calculate the similarity between a single source api and all the candidate apis.
this exhaustive calculation demands substantial online costs and becomes prohibitively expensive when multiple target libraries are involved.
to address this we propose kge4ar a novel documentationbased method leveraging knowledge graph embedding foranalogical apirecommendation effectively and scalably .
kge4ar constructs a unified api knowledge graph kg for third party libraries from api documentation leveraging graph embedding to represent nodes and edges as numeric vectors.
it efficiently retrieves the most similar api for a given source api from the embedded kg.
compared to previous approaches kge4ar introduces two technical innovations.
firstly it presents a novel unified api kg that comprehensively represents three types of documentation knowledge across diverse libraries better capturing overall semantics in api documentation.
secondly kge4ar proposes embedding the unified api kg enhancing efficiency and scalability by streamlining analogous api vector retrieval via vector indexing.
to implement kge4ar we build a unified api kg consisting of api elements sourced from java libraries.
this kg comprises a total of entities and relations connecting these entities.
we evaluate kge4ar in two api recommendation scenarios with and without target libraries.
when given the target libraries kge4ar achieves .
.
and .
.
improvements over the baselines in terms of mrr and hit respectively while without a given target library kge4ar substantially outperforms existing analogical api recommendation techniques by achieving .
.
.
.
and .
.
improvements in terms of mrr precision and recall respectively.
we also evaluate the scalability of kge4ar and find that it scales well with an increasing number of libraries.
furthermore we extensively investigate the impact of different design choices in kge4ar.
in summary this work makes the following contributions novel approach we introduce kge4ar a documentationbased analogical api recommendation method that builds a unified api kg for numerous libraries offering scalable recommendations via kg embedding.
thorough evaluation we thoroughly evaluate kge4ar through effectiveness comparisons in two api recommendation scenarios scalability assessment across various library quantities and analysis of design choice implications.
public benchmark we release a benchmark for extensive analogical api evaluations across numerous libraries.
background and related work in this section we discuss related work in analogical api recommendation and knowledge graphs in software engineering.
.
analogical api recommendation existing analogical api recommendation techniques leverage various sources like evolution history online posts and api documentation to find suitable target apis.
evolution history based methods use evolution history e.g.
code changes to mine frequently co occurring api pairs while documentation based ones calculate textual similarity using api related text e.g.
descriptions .
we concentrate on documentation based recommendation due to its prevalence low cost of data collection and recent research emphasis.
existing documentation based api analogical techniques mainly fall into two categories e.g.
supervised learning based and unsupervised learning based ones .
for supervised learning based techniques alrubaye et al.
propose to train a machine learning model i.e.
boosted decision tree for analogical api inference based on the features extracted from api documentation e.g.
the similarity of their method descriptions return type descriptions method names and class names and leverage the trained model to predict the probability of an unseen api pair being analogical.
different from supervised techniques that require a large amount of labeled data unsupervised learning based techniques often vectorize apis in an unsupervised way and then recommend analogical apis based on vector similarity.
for example zhang et al.
leverage the word2vec model to vectorize the api functionality description api parameters and api return values and then calculate a joint similarity based on these vectors.
although achieving promising effectiveness existing documentation based techniques suffer from two major drawbacks.
first they calculate the textual similarity based on the overlapping tokens or measure the token similarity without considering the whole context thus cannot well capture the semantic level similarity in api documentation.
second they calculate the pair wise similarity between all apis in an exhaustive way thus suffering from therecommending analogical apis via knowledge graph embedding esec fse december san francisco ca usa api kg embedding candidate api methods ranked analogical api methodskg embedding modelapi kg construction and embedding analogical api method inferring api methodapi kgfunctionality knowledge extractionapi kg construction structure knowledge extraction conceptual relation completion candidate api method retrievalcandidate api method re ranking figure overview of kge4ar scalability issue when the number of apis is large.
to address these issues our work makes the first attempt to comprehensively and structurally represent the knowledge in api documentation with a novel unified api kg .
in addition we further leverage the kg embed to enable more effective and scalable similarity calculation.
our evaluation results also demonstrate our improvements over existing documentation based techniques.
.
knowledge graph in software engineering in the domain of software engineering researchers have established knowledge graphs for diverse objectives encompassing api concepts api caveats api comparison api documentation domain terminology programming tasks ml dl models and bugs .
our work applies the api knowledge graph in a task that is distinct from existing work namely analogical api recommendation.
in addition since targeting different tasks the design and focus of our api knowledge graph are also different from existing ones.
for example the existing api knowledge graph constructed for api misuse detection mainly includes the call order and condition checking relations between apis while our api knowledge graph focuses on three types of knowledge i.e.
api structures api functionality descriptions and api conceptual relationships in api documentation which are helpful for analogical api recommendation.
moreover we also propose a novel knowledge graph embedding to enable more effective and more scalable analogical api recommendation.
.
knowledge graph embedding knowledge graph embedding kge uses low dimensional vectors to represent entities and relationships in a knowledge graph capturing semantic relationships between entities .
kge models map entities into a vector space where similar ones are closer.
they excel in applications like question answering recommendations and knowledge graph completion .
common kge approaches are transe transr and distmult .
these methods encode kg triples head entity relation tail entity into continuous vector representations.
for instance transe treats entities and relations as vectors defining relationships as translations from head to tail entities .
we employ kge to embed a unified api kg for analogical api recommendation.
approach as shown in figure kge4ar includes three phases i.e.
api kg construction api kg embedding and analogical api method inferring.
given the api documentation from a large number of librariesas inputs kge4ar first constructs a unified api kg section .
and then trains an embedding model to embed the constructed kg section .
.
lastly for a given source api kge4ar returns its analogical api based on the embedded kg section .
.
note that the first two phases only need to be run once.
once the unified kg is constructed and embedded kge4ar can recommend analogical apis for the given api efficiently.
in particular kge4ar mainly has two technical novelties.
novelty a unified api kg for a large number of libraries.
we propose constructing a unified api kg for a substantial library count e.g.
java libraries in this study .
our api kg comprises three knowledge types found in documentation which often resemble analogical apis api structures e.g.
package structures class definitions method declarations api functionality descriptions e.g.
get the number of elements in the jsonarray and api conceptual relationships i.e.
api concepts and their relationships like belong to .
unlike existing approaches that focus solely on api structures or functionality descriptions presented as token sequences our unified api kg offers a broader structural representation encompassing all three knowledge types.
this includes a novel category api conceptual relationships previously unexplored.
a graphical structure inherently suits the structured unification of multi type data thus effectively capturing the higherlevel semantics within api documentation.
novelty a kg embedding based similarity calculation.
we propose embedding the unified api kg representing each kg api as a vector.
kg embedding offers two advantages.
first it effectively preserves structural and semantic data in the unified kg.
second it expedites similarity calculations between apis in the kg.
retrieving similar api vectors from a database via vector indexing is highly efficient.
unlike existing methods requiring exhaustive similarity calculations for all api pairs our kg embedding enables a more efficient and effective approach to similarity calculation.
.
api knowledge graph construction in this phase kge4ar constructs a unified api kg for a large number of libraries based on their api documentation.
the api kg construction mainly consists of three steps.
structure knowledge extraction kge4ar first extracts all api elements e.g.
packages classes interfaces methods fields parameters and their relationships from the documentation to form a basic skeleton of the api kg functionality knowledge extraction kge4ar then extracts the functionality knowledge of the api libraries i.e.
the standardized functionality expressions of the methods including functionality verbs functionality categories and phrase patterns and the involved concepts from the names and text descriptions of methods conceptual relation completion kge4ar completes conceptual relations between api elements and concepts by analyzing names and text descriptions of api elements and concepts.
in this way api elements from different libraries can be related to each other based on shared type