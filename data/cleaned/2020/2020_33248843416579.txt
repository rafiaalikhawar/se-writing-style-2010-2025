scalable multiple view analysis of reactive systems via bidirectional model transformations christos tsigkanos tu wien vienna austrianianyu li peking university beijing chinazhi jin peking university beijing china zhenjiang hu peking university beijing chinacarlo ghezzi politecnico di milano milano italy abstract systematicmodel drivendesignandearlyvalidationenableengineerstoverifythatareactivesystemdoesnotviolateitsrequirements before actually implementing it.
requirements may come frommultiplestakeholders whoareoftenconcernedwithdifferent facets design typically involves different experts having different concerns and views of the system.
engineers start from a specification which may be sourced from some domain model while valida tion is often done on state transition structures that support model checking.
two computationally expensive steps may work against scalability transformation from specification to state transition structures andmodelchecking.weproposeatechniquethatmakestheformerefficientandalsomakestheresultingtransitionsystemssmallenoughtobeefficientlyverified.thetechniqueautomatically projects the specification into submodels depending on a property soughttobeevaluated whichcapturessomestakeholder sviewpoint.
the resulting reactive system submodel is then transformed intoastate transitionstructureandverified.thetechniqueachieves cone of influencereduction byslicingatthespecificationmodel level.
submodelsare analysis equivalentto thecorresponding full model.
if stakeholders propose a change to a submodel based on their own view changes are automatically propagated to the specificationmodelandotherviewsaffected.automatedreflectionis achievedthanks tobidirectionalmodel transformations ensuring correctness.
we cast our proposal in the context of graph based reactivesystemswhosedynamicsisdescribedbyrewritingrules.
wedemonstrateourview basedframeworkinpracticeonacase study within cyber physical systems.
acm reference format christos tsigkanos nianyu li zhi jin zhenjiang hu and carlo ghezzi.
.scalablemultiple viewanalysisofreactivesystemsviabidirectional modeltransformations.in 35thieee acminternationalconferenceonautomated software engineering ase september virtual event australia.
acm new york ny usa pages.
.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september virtual event australia association for computing machinery.
acm isbn ... .
introduction design complexity for a system is high because of the many different intertwinedfacets thatneed tobe takeninto account.furthermore different viewpoints or system aspects typically need to be accommodated .differentstakeholdershavedifferentconcerns and different experts may be involved in the design of the system focusing ondifferent technicalaspects.
forexample a distributed system may be comprised of different software components connected through networks the arrangement of components in asoftware architecture is one viewpoint while the network theyform is another.
the advisable way to dominate complexity is to applysound softwareengineeringprinciples namely separationof concerns and abstraction to system design and early validation.
we consider the case where requirements to be satisfied by a reactive system under design are specified in terms of assertionsin a temporal logic and that the system model is encoded into aformal graph based modeling language.
to support early design validation thebehaviorsthatcanemergewithinthereactivesystem need to be verified against the requirements.
this verification can be supported by model checking which requires an interpretation of the reactive system specification as a state machine.
model checkingdoesanexhaustivesearchofthestatespaceforabsenceof illegal behaviors .
however like any exhaustive technique such statemachineinterpretationanditsmodelcheckingmaybecome impractical as models become large and complex.
to address these difficulties this paper investigates a technique that leverages the different properties expressing the different concerns of stakeholders to automatically project the specification model into submodels each depending on the property under consideration.projectionsautomaticallygeneratesubmodelsthatare equivalent to the full source model from the standpoint of the specific properties that need to be verified.
projected models however are generally smaller than the full source model and therefore verificationviamodelchecking whichmaybeunfeasibleforthe full reactive system model may becomefeasible for the submodel.
forexample toreasonaboutthedeploymentofcomponentsina softwarearchitecture weonlyneedtocareaboutstructureandconnectivityoftheinfrastructureonwhichthedifferentcomponents of an application is hosted and not e.g.
network aspects.
onceasubmodelisderived adesignerwhoisconcernedwith that specific view may analyze it and correct it if problems arefound.
for example to improve performance a database expertmay decide that a cache should be placed in front of a database withinavirtualmachine reflectingthatinthedeploymentmodel.
35th ieee acm international conference on automated software engineering ase in our proposal we assure that changes applied to the submodel arereflectedbackautomaticallyinthefullmodel andfromthere propagated to other projections that may also be affected and hence would need to be re validated.
the full reactive system specificationmodelandthevarioussubmodelsforthedifferentviews are therefore automatically kept in sync supporting separation of concerns.
automated reflection is achieved thanks to the use of bidirectionalmodeltransformations .inourexample wewould need to verify that adding the new database cache does not lead to violation of other requirements for example referring to database networkconnectivity whichpertaintoanotherviewofthesystem represented by a different submodel.
we leverage results on model slicing 1and devise a practical softwareengineeringframeworkthatcansupportmultiple view analyses keepingviewsautomaticallysynchronized.theslicingprocess is performed at the reactive system specification level leveragingthetypesthatappearinthespecificationandinthe properties under consideration.
our technique achieves scalability inanalysisintwodimensions i slicingisperformedatthereactive system specification level before the expensive generation ofthe state transition structure describing its evolution and thus ii model checking occurs in a considerably smaller transition system.thelatterachieves cone of influence reductiononthestatetransition structure submitted for model checking.
weconsidersystemsthatareformallymodeled static graphbasedstructuresalongwiththeirpossible rule based dynamics yielding reactive behaviors.
in particular the specification is in termsofacomplexstaticstructuregivenintermsofagraph whichmay be sourced from some domain model and reactive dynamism is modeled by graph transformations.
interpretation of such specificationsiscostly althoughstate of the arttechniquesandtools e.g.
spin nusmv employcone of influencereductionfor traditionalreactivesystems theinterpretationstepintheexpressive graph based reactive systems we consider involves explicitly constructing the state space typically amounting to graph isomorphismoneachstep.insteadofslicingastate transitionstructure which in our case is not available and must be constructed we work at the model specification level .
ourcontributions liewithin atechnical frameworkintegrating fundamentaltechniquestoscale upautomatedanalysisbybuilding upon the cone of influence intuition that often only fractions of a model are necessary for reasoning on specific behaviors.
thus automatic projections can support verification even in cases where otherwiseit wouldnot befeasiblefor thefullmodel.
specifically weconcretelysupportseparationofconcernsandabstraction by advocating multiple views tailored in an automated way for analysis of specific requirements those enjoy soundmodelsynchronizationshavingtwoconstituents i correctness ofmodel projections where projectedsubmodelsaresufficientforcheckingagivenrequirement and ii correctnessofsynchronizations where modelsinvolvedare kept consistent under the projection relation.
finally automatedreflectionfacilitiesmakeuseofbidirectionaltrans formations whoseapplicationtoslicing multiple viewanalysis and model checking was not investigated before.
1modelslicinggeneralizestomodelstheprogramslicingtechniqueintroducedby .our modeling approach is based on bigraphs and bigraphical reactive systems brs a graph based modeling formalism proposed by r. milner able to encompass other formalisms suchas process calculi and petri nets.
our motivations for choosingthis formalism are i its generality as bigraphs have seen appli cations on systems ranging from cloud to cyber physical ii its well defined semantics and hierarchical structure leading to elegantalgorithmictreatment and iii itsnaturalrelationtograph transformationsystems renderingfuturepracticaladoptionand tool support easier.
following a model driven approach otherdomain specific models can derive the brs specification models we target.
to provide concrete evidence of the proposed modelbasedapproach wedemonstratethatthegoalofmakinganalysis scalablethrough modelprojections canbe achievedinpractice on a characteristic case study within cyber physical systems where multiple view analysis is paramount to the design process.
therestofthepaperisstructuredasfollows.sec.2providesnecessary background while sec.
gives an overview of the proposed approach.sec.4introducesatype basedapproachtoautomatically generaterequirementviews andsec.5describesmodelsynchronization.sec.6providesanassessmentoveracasestudy.related work is considered in sec.
and sec.
concludes the paper.
background inthissection westartwithasimplescenarioservingasarunning examplethroughoutthepaper.subsequently wesuccinctlyillustrate how to model graph based structure sec.
.
and dynamics sec.
.
i.e.
possible ways in which the system may change over timethroughactions.then weshow sec.
.
howtheresulting reactive system can be interpreted as a state machine upon which requirements may be verified by model checking.
runningexample.
considerthecasewherearesourceconstrained mobilerobotpatrols aspatialdomainto locateintruders.thespa tial domain is divided intoareas upon which a local edgeserver is located supportingrobotstoperformcomputationally intensive tasks e.g.
image recognition to visually detect intruders without the latency that a cloud connection would incur.
computation offloadingisperformedonvirtualmachines vms towhichthe edgeserveristhehost.astherobotmoveswithinareas avmmayneedtobemigratedtotherespectiveserverlocatedinanotherarea.
to this end network gateways may connect edge servers through whichmigrationoccurs.theubiquitoussystemshouldfulfilltwo requirements rq1 anedgeservershouldnotbeidle ifthereisanother one connected to it hosting vms load balancing and rq2 if there exists an intruder in the system the robot must keep surveying areas one two and three in sequence one after the other in a sequenced patrolling pattern .
notice that the example describes a simple reactive system.
a model of the system can be constructed which represents struc ture entities and their relations within the scenario as well as dynamic evolution due toactions.
subsequently interpretation as astate transitionmodelanditsverificationintheformofmodel checkingcanbeusedtocheckiftherequirementshold.however interpretation and verification of large models may be impractical.moreover multiple stakeholders e.g.
robotic experts deployment engineers mayhavedifferentinterestsinthesystem soseparation of concerns is highly desirable.
following such a principle implies 994supporting analysis on each concern separately and abstracting away details that are irrelevant.
.
modeling with bigraphs modeling systems within software engineering is certainly a wide theme.
our formalism of choice is bigraphs a graph based processmeta calculusthatisabletocapturewidelydifferentsystems while featuring interesting properties.
a bigraph consists of two graphs.
a place graph is a forest a set of trees defined over a set of nodes while a link graph is a hypergraph over the same set of nodes and a set of edges each linking an arbitrary number of nodes.
connections of an edge with its nodes are called ports.
place and link graphs are orthogonal and edges between nodes cancrosslocalityboundaries.nodesthatappearinabigraphare typed2.
what follows is an informal presentation of bigraphs as used in the scope of this paper recalling definitions in .
p.q nestin pcontains q p q juxtapositionof nodes i sitenumbered i kw nodewithtype khavin ports w w bardblr juxtapositionof bi raphs 1a 1b 1c 1d 1e bigraphs can be described through a rigorous graphical representationaswellasequivalentalgebraicexpressions formulae1a 1e .
p q and karenamesthatdefineanode stype.nodescanbestructured hierarchically the containment relationshipis expressedin formula 1a and is graphically described by nesting.
bigraphs may be placed at the same hierarchical structure level as shown in formula 1b.
additionally bigraphs can contain sites formula 1c that canbeusedtodenoteplaceholders i.e.
thepresenceofunspecified nodes graphicallyrepresentedasshadedboxes.absenceofasite signifies no unspecified nodes in that part of the hierarchy.
eachnode type control can be associated with a number of named ports.
in formula 1d the node identified by type khas port names w ports are graphically represented as black bullets.
bigraphs can be contained in roots that delimit different hierarchical structures thus being juxtaposed.
in formula 1e wandrare different roots.
an instance of the example system is illustrated in fig.
where entitiessuchasrobotsandserversarewithinthreeareas.notice howareasarelinkedtonamesidentifyingthem andlinksofservers tothenetworkgatewaytraversethehierarchies i.e.
thenestingofnodes .sitesdenoteunspecifiednodes.usingthealgebraicnotation the bigraph of fig.
can be represented as in formula .
area .
robot server lnk.
vm vm network lnk area .
intruder server lnk.vm area .
intruder server lnk formally a bigraph arises from two superimposed relations.
let vbbe a set of nodes and kthe set of types of nodes.
let ctrlb vb kbe a typing function called type map.
a place graph is a tuplebp vb ctrlb prntb k whereprntb vb vbis an acyclicparentmappingmodelingnesting.a linkgraph isatuple bl vb eb ctrlb linkb k whereebis a finite set of edges and linkb eb 2vbis a link mapping assigning each edge the set of nodeswhichareconnectedbythatedge.then abigraph bconsists ofbpandbl b vb eb ctrlb prntb linkb k .
note that for b of formula k robot vm area... .
2types are called controlsin bigraphical terminology.areaservervmrobot networkservervm intruder0 area area1 servervm lnk intruder figure bigraphical model of a ubiquitous system.
.
modeling dynamics with brs a bigraphical reactive system brs captures dynamic behavior.
a brs describes possible ways with which a bigraphical structurecanevolvethroughapplicationoftransformationrules calledreactionrules which selectively rewrite parts of a bigraph.
reaction rules have the general form of r r prime where the lefthand side r theredex representsapatterntobefoundinabigraph and a right hand side r prime thereactum will replace a matched portion upon application of the reaction.
randr primeare also bigraphs.
replacement of a subgraph matching a reaction rule redex with the subgraph defined by the reactum occurs in a fashion similar to graph rewriting ina procedure called bigraph matching .
rewritingproceduresarecomputationallycostly astheyareequivalent to graph isomorphism.
utilizingreactionrules dynamicsoftheexamplescenariocan be modeled.
the possible changes entail mobile robots changing areas move vmsmigratingfromconnectedservers migrate and therobotsuccessfullycapturinganintruder capture modeledas follows a b care variables ranging over named ports move area a. robot area b. area a. area b. robot migrate server lnk.
vm bardblnetwork lnk bardblserver lnk.
server lnk.
bardblnetwork lnk bardblserver lnk.
vm lnk capture area a. robot intruder area a. robot .
analysis of reactive behaviors given an initial configuration specified by a bigraph and a set of reaction rules new configurations may be generated by repeatedly applyingreactions andpossibleevolutionscanbedescribedbya state transitionstructure .thisisa doubly labelledtransition system dlts l defined as a tuple angbracketlefts i a ap l angbracketright where sis a set of states describing configurations i sis the initial state ais a set of transition labels ap is a set of atomic propositions s a sisa3 adicrelationoflabelledtransitions.if p q sand a p q is written as p q. l s 2apis a function that labels each state with the set of propositions that are true in that state.
abrsspecificationcanbetranslatedintoanequivalentdlts.intuitively givenaninitialconfigurationandasetofreactionrules adltscanbegeneratedbymappingbigraphicalconfigurationsontostates.thesetofofpropositions ap thatlabelastate p s canbe systematicallygeneratedbydeclarativelyencodingthecorrespondingbigraphconfigurationofthestate.transitionscorrespondto 995area .
robot area .
server lnk.
vm vm robot area .
intruder server lnk.vm area .
server lnk intruder ...s0 s1 s2 area .
robot area .
robot move movearea .
server lnk.
vm vm area .
robot intruder area .
server lnk intruder area .
server lnk.
vm vm robot area .
intruder server lnk.vm area .
server lnk intruder ... ... ... ... figure evaluation of a property on a fragment of l. applicationsofreactionrulesthatleadtonewbigraphicalconfigurationsandtheirlabelsrecordactionsmodeledbyrules.anexecutionfragment oflisa possiblyinfinite alternatingsequenceofstates si sand transition labels i a written as s0 1 s1 2 ...sn 1 n sn... such that si i si 1for alli .
behaviorofthesystemovertime i.e.
executionfragments can bereasoneduponwithatemporallogic.weadoptlineartemporallogic withoutthenextoperator ltlx definedasfollows true u .
propositions of the logic are bigraphs interpreted over states of l. such bigraphs are termed parametric patterns since sites can be used to reason about unspecified nodes and variables e.g.
a can match port names for instance area a. would match all areas of the model of fig.
.
the properties modeled by ltlx express behavioral constraints and are interpreted over execution fragmentsof l.intuitively theformula 1u 2expressesthat 1 istrueuntil 2becomestrue wecanderiveadditionalonessuch as diamondmath true u eventually and square diamondmath always .then requirementsrq1andrq2oftherunningexamplecanbeformally specified by formulae 4b and 4a rq1 square server lnk bardblnetwork lnk bardblserver lnk.
vm vm vm rq2 square intruder square diamondmath area .
robot diamondmath area .
robot diamondmath area .
robot 4a 4b ltlxproperties over bigraphical propositions as patterns as previously defined may be readily checked upon dlts l. for an executionfragmentof landanltlxproperty evaluationofthe property entails i finding truth values of bigraphical propositions on states and subsequently ii verifying the property s temporal componentoverthesequenceofstatesinthefragment.toevaluate bigraphicalpatternsonstates matching isused while ltlx properties are evaluated using established verification methods .
the restriction to ltlxis a known strategy to enable verification optimization techniques without significantly affecting expressiveness of the language for practical considerations .
fig.2showsanexecutionfragmentof l.bigraphicalpatterns areevaluatedineverystate whiletemporalpropertiesareevaluated over the sequence in states s0ands1 patterns shown above area .
robot andarea .
robot arerespectivelytrue and the property holds true in s1 the robot moves back to area rendering the patrolling property rq2 false.
view based reasoning framework given a reactive system specification comprising of an initial configurationandasetofrewritingrules analysisintheformofmodel checking can be performed to check that possible behaviors do not violate the stated requirements.
traditional analysis shown in the r2 ...analysis p properties propertyanalysis dynamics subset property dynamics subset... r analysis dynamicssource modelview model initial con figurationview configurationview configurationview model synchronization synchronization p2 r1 p1 figure framework for multiple view reasoning.
lower part of fig.
would entail considering the entire model and set of rules generating a state transition structure by exploring application of all rules and finally performing model checking for eachpropertyencodingadifferentrequirement.thecornerstone of our approach shown in fig.
is that for each property subsets of both the initial configuration and the set of rules are taken into account instead.
this follows the spirit of slicing techniques as applicabletomodels i.e.
notprograms wheretheslicingcriterion is a temporal logic formula i.e.
and not program variables .
the benefits of the proposed approach are twofold i slicing is performedatthesystemspecificationlevel beforethe computationally expensive generation of the state transition structure describingitsevolution andthus ii thesizeofthemodelsubmittedformodelcheckingisreducedandtailoredtoformalanalysisofeach requirement.theresultisknownasachievingcone of influence reduction which in this case has two dimensions.
first the size of each state can bereduced.
recall that each stateis modeled by a set of propositions and in our case propositions declaratively specifyalldetails ofanygivenbigraphical configuration.ourslicing approach automatically prunes all details that do not affect the requirementunderconsideration.second the numberoftransitions exiting each state fan out can also be reduced.
the proposed approach not only supports effective mechanical verification but is also beneficial to designers in their reasoning about the current system.
by projecting the full model into a more concise one which is equivalent with respect to satisfaction of a given requirement it supports separation of concerns and abstraction.ithelpsfocusingoneachconcernseparatelyandautomatically factoring away details that are irrelevant to a given requirement.
for example the robotic expert of the example system sec.
can focus her analysis on robotic mission aspects that affect the respective requirement while the expert on load balancing can focus onothers inthiscase vmmigration .suchsystemconcernsare capturedindifferentanalyzablepropertiesaswellasappropriate subsets of the model and dynamics upper part of fig.
.
996finally thetechniqueisrootedintothetheoryof bidirectional transformations whichguaranteessynchronizationbetweenmodels consistency andwell behavedness.asillustratedinfig.
in caseofchangeinoneoftheviews changesareautomaticallypropagatedbothtothefullmodelandotherviews triggeringanalysis if required.
for our example scenario if e.g.
the robotic expert changes the relevant submodel due to verification results of requirementrq2 analysiscanbetriggeredagainonthesubmodel needed to check rq1 as well.
property driven view generation letussupposethatareactivesystemspecificationmodelisgivenby providing a bigraph describing an initial configuration e.g.
fig.
andasetofreactionrulesdescribingdynamics aspersec.
.
.thissectiondescribeshowa viewmodel canbegeneratedautomatically givenaproperty.theapproachisrequirement drivenandgeneratesaviewmodel whichisaprojectionofthefullmodel.theprojected modelcomprisesaninitialconfigurationthatisasubgraphofthe original as well as a subset of the original rules.
the description is illustrated by referring to the running example.
we first introduce an algorithm that generates a view model for a given property sec.
.
.subsequently sec.
.2outlinestheproofofcorrectness based on previous results achieved within model slicing.
.
views through type based transformation the algorithm for view model generation has as input a full model m consistingofabigraph candasetrofreactionrulesdescribing dynamics as well as an ltlxproperty pspecifying a requirement.theoutputisa projection ofthefullmodelintoasubmodel comprising i a subgraph c primeofcand ii a subset r primeofrsuch that satisfaction of pon the full model can be proved equivalently bycheckingthesatisfactionof pontheviewmodel.wedefinea modeltransformationwherethe sourcemodelisthefullmodeland thetargetmodelisthe viewmodel.theproposedtransformationis embeddedintoanimplementationthatsupports bidirectionalmodel transformations as discussed in sec.
.
a model that contains exactly what is relevant to check satisfactionofarequirementandisminimal an optimalmodel could be carefully hand crafted in many cases.
however manual construction is non trivial and prone to human error.
instead we aim for an automatic technique to generate model views per requirement thatare provablyequivalentwithrespectto analysisofthe requirement on the source model.
in the running example intuitivelyonecanobservethatverificationofrequirement rq2does notrequireconsideringvms includingorexcludingthe migrate rule in the dynamic analysis does not affect satisfaction or violation of that requirement.
the presented algorithm utilizes types to generateviews byexploitingthecorrespondencebetweentypes appearinginrequirements initialconfiguration anddynamics.the algorithm does not guarantee generation of a minimal view model moreonthispointisdiscussedinsec.
.recallthatinabigraphical model different kinds of entities are reflected in types controls o f the bigraphical representation.
a requirement may concern enti ties having only certain types consider formula 4b which onlypredicates about areaandrobotandintrudernode types.
thus our approach to view generation builds on the basic intuition of non inclusion of node types that are not relevant to a requirement.algorithm computing types and rules for a view model.
input p bigraphical temporal property r set of reaction rules output proptypes set of types needed for p rp set of rules needed for p proptypes rp for allp prop p do proptypes proptypes k p end for repeat proptypes prime proptypes for allr rdo ifk rhs r proptypes nequal then proptypes proptypes k lhs r rp r rp end if end for untilproptypes prime proptypes algorithm1computesthesetoftypes proptypes neededtoevaluateaproperty p givena setofreactionrules r.italso computes a subsetrpofr which includes the reaction rules we need to considertoevaluateproperty p.thealgorithmusestwohelpfunctions kandprop.function kmapsagivenbigraphintothesetoftypesof its nodes.
recall that a temporal property has bigraphical patterns as propositions function propmaps a given property into all bigraphsfoundaspropositionsintheproperty i.e.
discardingmodal temporal operators .
the algorithm iteratively computes the set of types needed for the evaluation of the property by considering the left hand sidesandright hand sidesofreactionrules.theresultis a subset of types that can be used to reduce the source model.in addition the algorithm produces a subset of rules relevant to analysis of the property.
the algorithm starts by initializing proptypes with all node typesappearinginbigraphicalpropositionsoftheproperty lines2 .forthepropertyspecifyingrq1 thealgorithmwillincludetypes server network vm .
rules need to be also taken into account since sequences representing change of truth values of proposi tions might affect satisfaction or violation of bigraphical propo sitions within p. to this end every rule rin the set of reaction rulesrneeds to be checked whether it is related to p. specifically while iterating through reaction rules line if the righthand sideofarulehastypesincommonwith proptypes line9 the types appearing in the left hand side of the rule are also in cluded in proptypes line .
for example for the rule migrate k rhs migrate proptypes server network vm andk lhs migrate server network vm thus notypewillbeadditionally included to proptypes as they have already been there.
the algorithm continues to iterate until reaching a fixed point i.e.
the setproptypes does not change line .
to generate a view model mp cp rp from a model m c r algorithm is used to produce rpand the set oftypesproptypes neededforevaluationof p.thelatteristhen used to generate a projected configuration cpby pruning the configuration cas described in algorithm .
we take advantage of the fact that configurations are modeled as bigraphs whose nodes are 997algorithm generating a view model.
prunenode n proptypes n prime n n primeare nodes of the form q. nl wherenlis a list of nodes with the recursive form n nl nl prime prunenodelist nl proptypes ifk q proptypes andnl primeis then n prime null else n prime q. nl prime end if prunenodelist nl proptypes nl prime ifnl nequal and in the form of nhead nltailthen n prime head prunenode n head proptypes nl prime n prime head prunenodelist nl tail proptypes end if arrangedhierarchically theplacegraph sec.
.foreachhierarchical layer there might be several nodes e.g.
different areas which are consideredasa list.the objectiveof prunenode isto prunea node while prunenodelist handles the list of nodes in order.
in prunenode the function prunenodelist is invoked first to handle nodes contained in that node e.g.
robotandserverare contained in an area .
the node shall be deleted if the control of that node is not found in proptypes and none of the nodes contained in it does line2 i.e.
nl primeisnull .generationoftheviewconfigurationneeds to ensure that i all nodes of the source configuration that have typesinproptypes areincludedintheproducedconfiguration and ii all their ascendants in the tree structure are also included to ensure that structure is preserved.
sites are treated as having a specialtype andarealwaysincludedintheproducedconfiguration since they are placeholders for unspecified nodes.
fig.
presents the view models initial configuration and set of rules produced for requirements rq1 and rq2.
.
correctness of model projections projection of a reactive system source model into a view model for agivenproperty pshouldyieldasubmodelequivalenttothefull model as far as property pis concerned.
this section provides the outline of a formal proof of this equivalence leveraging theoretical results in model slicing achieved in the past .
a view model produced by the method described in sec.
.
satisfiespifandonly ifthesourcemodelsatisfies paswell.since pisatemporalproperty theequivalencehastobeshownacross executionfragments.theproofoutlineleveragesinsensitiveness tostutterwithin temporal logic this means that a property can not distinguish between fragments that differ only by stuttering i.e.
finite repetition of similar states.
insensitiveness to stutter is a prerequisite for widely used techniques in software engineering such as partial order reduction and model slicing .
recall thatpropertyspecificationoccurswithin ltlx characterizedby absence of the next time ltloperator.
the next operator is sensitive to finite stuttering and a view projection essentially works by projectingabehaviorand collapsingsequencesofstutteredstates.
anyltlxformula describes a stutter invariant property .
given a model mconsisting of a bigraph cdescribing an initial configuration a set of reaction rules rdescribing dynamics and a property p a view model mp cp rp whererp r i sareaservervm networkservervm area area1 servervm lnk0 a cp1 mi rate .
arearobot intruder0 areaarea1 intruder0 b cp2 move capture .
figure view models generated for rq1 a and rq2 b .note the absence of robot in c p1 and of vms in cp2.
produced.
initially we introduce the concept of a canonical form ofexecutionfragments thenweshowthatthereisa bisimulation relationbetween the m s execution fragments and mp s execution fragments.
the proof outline consists of three steps.
first we show that any execution fragment affecting pobtained from the full modelmhas an equivalent canonical execution fragment where transition labels only belong to rp.
we call these fragments canonicalbecause they are minimal with respect to p. in our context equivalentsignifiesthatproperty peitherholdsordoesnotholdfor bothexecutionfragments .second weshowthatforeachcanonical execution fragment obtained from the full model mthere is an executionfragmentintheviewmodel mpwhichisp equivalent.
third we show that for each execution fragment obtained from the submodel mpthere exists a canonical form fragment obtained from c r which is equivalent.
canonicalfragmentequivalenceinthefullmodel.
considerthe following fragment obtained from the full model m c r whichcapturesapplicationofrules i afromtheinitialstate s0 s0 1 s1 2 ...sn 1 n sn... the basic intuition behind the canonical form execution fragment isthatif j r rp jdoesnotmodifyanypartofthebigraphof statesjthatwillaffecttheevaluationoftheproperty.anexecution fragmentobtainedfrom c r maycontainlabelscorresponding to rules from both rpandr rpintermixed.
to obtain the correspondingcanonicalformfragment anysub sequencesoftran sitions with labels in r rpcan be dropped.
for example consider the case where in execution fragment aj rpfor all j i andj i k andaj r rpforalli j i k.thecorresponding canonical form fragment is s0 1... i si i k... n sn... recallthatrulesin r rpdonotaffectsatisfactionof p.forany executionfragment one andonlyone canonicalformexists.itcanbeeasilyshownthatthecanonicalfragmentisindeedanexecution fragment of the full model.
source view fragment equivalence.
as we observed given any execution fragment of m we can produce a canonical execution 998fragment where all transitions are labeled with rules in rp s0 1 s1... n sn... forthecanonicalexecutionfragment byapplyingtheprocedure described in sec.
.
on bigraphs that label states s0 s1...sn to eliminate from the configurations all nodes whose types do not affect property p we obtain the following execution fragment sp0 1 sp1... n spn... where the atomic proposition labeling state sp0 is a bigraph cpand for all i i rpand the atomic proposition labeling state spiis a bigraph obtained from the one labeling spi 1through the application of the rule i. fragment is an execution fragment of mpandisequivalenttofragment .thus foreachexecutionfragmentobtainedfromthe fullmodelthereisanexecutionfragment in the view model which is equivalent with respect to property p. canonical fragment equivalence in the view model.
consider any executionfragmentobtainedfrom mp cp rp forexample fragment .
if we apply the same sequence of transitions ifor alli to an initial state labeled by c we obtain a canonical execution fragment of m that is equivalent to fragment .
model synchronization we have shown that a view model can be generated from a source modelaccordingtoaspecificrequirement.however aclassicproblem in this view based approach is how to reflect changes from the viewtothesourcemodel.ifanupdateismadetotheviewmodel afterverification e.g.
tocounteractarequirementviolationfound we should be able to reflect it to the source model and from there tootherviewmodelsthatmightalsobeaffected.inthissection we show how to solve this problem by designing and implementing a bidirectionaltransformation bx forsynchronizingthesourceand the view models to correctly propagate changes between them.
without loss of generality the following description only discusseshowchangesinviewconfigurationsmayaffectmodelsynchronizations andviceversa .changestodynamicscanbehandled similarly.
precisely we assume the set proptypes for a view not to change andhencealsothesetofdynamicrules.thus whenever weusetheterm modelinthissection itstandsforonlythestatic part i.e.
the bigraphical configuration .
.
a bx algorithm bidirectional transformation bx is a useful mechanism fordatasynchronization whichwillbeusedforsynchronizationofsourceandviewmodels.abxconsistsofapairoftransformations etandput.theforwardtransformation et s isusedtoproduce atargetview vfromasource s whilethe putbacktransformation put s v is used to reflect updates on the view vto the source s. thesetwotransformationsshouldbe well behaved inthesensethat they satisfy the following round tripping laws put s et s sgetput et put s v vputget the getput property requires that no change of the view shall be reflected as no change of the source while the putget propertyrequiresallchangesintheviewtobecompletelyreflectedtotheservervmrobot area2 sourceget putproptypes vm serverservervm area2 view server area2 1migrate view serverrobot area2 source figure type based bidirectional model transformation.
algorithm updating a view model.
updatenode ns nv proptypes n primes ns nv n primesare nodes of the form q. nl .
q primes update attributes of qswithqv nl primes updatenodelist nl s nlv proptypes updatenodelist nl s nlv proptypes nl primes nls nlv nls primeare lists of nodes of the recursive form n nl.
ifbothnlsandnlvare then end update else ifmatchnsheadwithnvheadsuccessfully then nshead prime updatenode n shead nvhead proptypes else ifk nshead proptypes then nshead prime nshead else ifk nshead proptypes nequal then nshead prime delete node contained in nsheadinproptypes else ifnlsis then nls prime nlv else raise exception view nlvis illegal end if nlstail prime updatenodelist nl stail nlvtail proptypes sourcesothatthechangedviewcanbecomputedagainbyapplying the forward transformation to the updated source.
to use bx for synchronization we need to develop a pair of transformations between source and view models.
the forward transformation etisstraightforward whichistheviewgeneration function sec.
.
when a set of types proptypes is given et s prunenode s proptypes .
whatisnotsoobvious ishowtodefinethecorresponding putthat can be paired with getto form a bx satisfying the getput and putget properties.
before defining put let us consider a concrete example to see what this bx should be.
as shown in fig.
for the running example and the load balancing requirement rq1 theget producesthe viewmodelwiththe types of vmandserver.when theviewischangedto view vmismigrated wehopetouse putto propagate this change back to source yielding the modified source vmmovesawaywhiletherestofthethemodelremainsthesame .
since our getis a projection its corresponding putshould be an embeddingoftheviewelementsintothesourcemodel.todefine put we exploit the hierarchical tree structures of bigraphs echoing the previous view generation transformation strategy and use the view to update the source layer by layer putis defined by 999put s v updatenode s v proptypes where updatenode informally defined by algorithm replaces the attributes i.e.
ports of the source with the information in the view and then invokes function updatenodelist to handle nodes contained in the source node.
function updatenodelist dealswiththesituationwhereboththesourceandviewarealist ofnodes.thesimpleststrategyforupdatingalistisposition based alignment whichmatchesthesourceandviewelementsbytheir positionsinthelists.thereare6cases bothsourceandvieware emptyandwereachtheendofexecution thefirstnodeofthe source can be matched with the first of the view e.g.
serverin the sourcecanbematchedwith serverintheview and updatenode is calledtoupdatethisnode controlsinthefirstnode includingallnodescontainedinit ofthesourcearenotfoundin proptypes i.e.
noinformationshallbeextractedtotheview inwhichcasethis elementofthesourcewillremainthesame somecontrolsinthefirstelementbelongto proptypes thenthisnodeanditscontaining ones with controls found in proptypes are deleted the source is empty but the viewis not i.e.
the source listhas fewer elements thenewsourcenodeshavetobecreated otherwisetheviewis notlegal andthecomputationfailstoguaranteewell behavedness.
later updatenodelist will be invoked recursively to manage the rest of the source and view lists.
this putupdate strategy can be pairedwiththe getdefinedinsec.
.1toformawell behavedbx though the formal proof is omitted in this paper.
.
implementing bx using bigul the transformations getandputpresented in sec.
.
could be manually implemented.
although this solution provides the pro grammer with full control in two directions and can be realized usingstandardprogramminglanguages maintenanceeffortisrequired to keep consistency between getandputif one of them is changed even a small modification to one of the transformations would require redefinition of the other.
moreover the pair of transformations should be proven to be correct and well behaved.
to this end we adopt bigul a putback based bidirectional programminglanguage whereone isonly requiredtoimplement theputtransformation instead of both getandput.
this is because getis uniquely determined by putbased on well behavedness .
inbigul oncea puttransformationisgiven thecorresponding get isautomaticallyderived.wewillnotdiveintoadetailedexplanation ofput as its semantics are illustrated in algorithm .
interestingly fromthat putalgorithm bigulcanautomaticallyderivethe get withthesamesemanticsasalgorithm2.theinterestedreaderis referredto fortheunderlyingmechanismofbigul andtothe online appendix for the implementation .
use of synchronization.
synchronization between views is useful for model maintenance purposes recall the motivational example.
assume that the cloud expert decides to improve load balancing by dividingtheavailableareainto4areas placinganedgeserverin eachtoincreasesystemcapacity.tothisend shechangesthecloud view and proceeds to verify rq1.
the source and the robot view areupdatedautomatically andverificationcanbeperformedfor rq2 as well notice that in this case the robot view has changed as another area hasappeared.
observe that rq2 can beviolated ifthe sequenced patrolling behaviour is not maintained.
evaluation to provide tool support for our multiple view analysis framework werealizedaprototypicalviewgenerationandtransformationtool based on bigul which is freely available .
thereupon we demonstratetheframeworkinpracticeoveracharacteristiccase sourced from the domain of cyber physical systems experimental setup and results obtained are subsequently presented.
we high light a typical design scenario where multiple view analysis and synchronizationthroughbidirectionaltransformationisparamount to the design process and conclude with a discussion.
.
multiple views in a smart city design the prevalence of sensors networks and devices has led to the emergenceofsmarturbanenvironments.
weconsidertwogeneralized cases which can be concretized for various scenarios those concerndifferentrequirementsbuttheiranalysisisbasedonthesame model obtained from a domain model of a city.
typically thosemaybeanalyzedseparatelybydifferentstakeholders however aswilllaterbeillustrated duetochangeswithinatypical designworkflow aneedofsupportingsynchronizationamongmultiple views arises.
we note that are not debating the underlyingformalism here e.g.
for modeling cps as this is outside of the scope of this paper our goal is investigating analysis scalability.
the first case concerns environmental monitoring with wireless sensornetworks wsns comprisedof smalldevices scatteredin wide areas collecting measurement data.
in order to gather data fromlow poweredsensors oneormoremobile sinkscanbeused.
a sink is a gateway able to connect to a wsn device and also to larger networks like the internet a sink downloads data froma sensor when it is near it.
this scenario entails verification of data collection sinks move over the transportation network of the city collecting data from sensors.
the second case concerns search and rescue a setting of emergency response where autonomous uavsaredispatchedtolocatevictimsinthecity uavsmove overbuildings lookingforvictimsinneedofassistance.weseek to verify that all victims in the city are eventually located by the swarm of uavs in all possible system behaviors.
.
experiment setup results toutilizeourapproachinpractice thedesignerspecifiesthesystem model including its dynamics as well as desired system properties.
the views can then be produced automatically as described in sec.
.
.
implementation is available in accompanying material along with models used and an experiment reproduction kit.
in the following we illustrate the specification steps of the case study.bigraphicalmodelsofthephysicalspaceofcitiesareautomatically extracted from randomly synthesized domain modelsincitygml3.
therandomlysynthesizedmodelsaretocontrolforsizewhilemaintainingacanonicalstructureofrealcities.
real city models can be used as well but would distort results thegoalofthiscasestudybeingtodemonstratescalabilityinacontrollablesetting.
thebigraphicalconfigurationcontainsvarious elementspresentinthecity suchas blocks buildin s roadsand crossroads linked accordingly to capture the topological structure inherentinthedomainmodel .blocksmaycontainanarbitrary 3citygml is a standard for urban modeling with models existing for multiple cities.
1000table experiment results on cyber physical city models.
bigraph of dlts interpret.
bx size rules st. trans.
time time city1 source 23k 46m city1 uav view 1k 2m26ms city1 wsn view 1k 13m24ms city2 source 90k 6h city2 uav view 8k 16m53ms city2 wsn view 2k 3m52ms city3 source 10h city3 uav view 30k .5h65ms city3 wsn view 2k 4m68ms number of buildings each is connected to the one next to it and to ablock ssurroundingroadsifitislocatedintheblockboundary whileroadsarelinkedtocrossroads.subsequently sensorscontainingdatatoken s describingsensordeployment and victimstobe rescuedareplacedrandomly fortheexperimentsetup weconsider 5ofeach.additionally uavandsinkentitiesarealsoplaced.dynamics specification encodes i movement of data sinks across the transportationnetworkinthecityanddatacollectionfromsensors and ii movementofuavsandvictimlocalization.
theelements placed uavs sensors etc are the same in all source models inorder to control for size we seek to evaluate how increasing the problem size i.e.
city model size affects scalability while keeping dynamics stable.
since we are concerned with evaluating scalability thereductionoftransitionsystemsizeandinterpretation time over views and not verification we consider example ltlx properties aiming to i capture data collection by data sinks e.g.
diamondmath square datatoken and ii ensurevictimsearchandrescuebyuavs e.g.
square victim diamondmath building ?.
victim .
afterspecification viewsaregeneratedandinterpretedasdescribed in sec.
.
.
for brs interpretation external tools can be used e.g.
.thereupon wereportonexperimentalresults.
view generation leads to smaller models both in terms of size in nodesandports column bigraphsize intab.
aswellasreduceddynamicssets withbothreducedstate transitionsizeandmoreefficient interpretation times column dlts size and interpretation time in tab.
due to reduced configuration sizes in states and lessconcurrencyduetoreduceddynamics.progressivelylargercitymodelsdemonstratethis notehowthesourcemodelof city3was unable to be interpreted.
experiments were performed on an intel i5 .1ghz absolute values of interpretation time naturally depend on tools used what matters in our setting is the improvement obtained by analyzing views which drastically reducesspace and time.
model checking on the transition systems finally produced can then be readily performed with typical tools e.g.
spot .
multiple viewswithinthesmartcityworkflow.
aftertheanalyses performed we outline a scenario taking place in the smart city design process in which model synchronization proves useful a stakeholder in the system indicates that sensors mustbe placed additionally in city buildings for environmental monitoring.
the city model is updated to reflect this.
the change is propagated to the views corresponding tothe wsn and uav scenarios and analysis of the respec tive requirements is triggered.
the column bx time in table1recordsthetimeofprojectionforeachnewmodel.we note that view generation time is in the order of tens of milliseconds source update time is similar so omitted .
interpretation andanalysis isperformedyetagainonthe two views times are quite similar to the ones in table so they are omitted.
while analysis of the uav requirement may be successful the requirement corresponding to data collection is violated.
intuitively since sensors are now also located in buildings data collection from them cannot occur since sinks move only over the transportation network a change in the system design is required.
since uavs move between buildings an upgrade to their hardware can render them equipped with data collection capabilities.thedesignerencodesanappropriatereactionrule andinterpretation andanalysis ontheviewsistriggered again both requirements are finally satisfied.
note that i in principle every update in the views is supportedand will be correctly propagated and that ii stakeholders may analyze debug or repair views instead of the large source model.
.
discussion limitations asillustratedinthecasestudy thedesignprocesscanbefacilitated by reasoning on multiple views and analysis scalability can beincreased.
views can be produced via getand synchronization is achievedby puttransformations.notethatthetimeusedforgenerating views and synchronizing models can be neglected compared to the costly reactive system interpretation.
however as explained in the following we note that i the view generation method used is conservative and that ii future consideration of diverse case studies should assess applicability in other domains.
by performing analysis on the projected configurations and with reduced dynamics view models benefit from the reduced concurrencyandsmallersize resultinginsmallerstate transition structuressubmittedforverification.however inthescenariospresented while respective requirements pertain a single model they aretoacertaindegreedisjointastheycapturedifferentconcerns.
weacknowledgethatinthecasewheremodelshaveincreasedoverlapintypes theremaybenoincreaseinefficiency.thisisduetothe viewgeneratingalgorithm1 whichconservatively butefficiently only uses types to derive view models.
a more advanced extension would refine the model further we identify bigraph matching as the key driver for further automatic view refinement.
topreciselydiscussscalability wemustconsiderthattheanalysis technique we target is explicit state model checking whichreliesonanexhaustiveexplorationofthestatespace thisintrinsicallyrequiresrestrictinga scopetobefeasible.exhaustivestate explorationismotivatedbythe smallscopehypothesis whichstates thatahighproportionofbugscanbefoundbyexaminingasystem withinasmallscope .theapproachpresentedallowstoscale uptheboundarieswithinwhichitcanbeperformedwithacceptable performance.
the results obtained indicate that the technique iseffectivewithinamodelandworkflowofacps stakeholdersin such a scenario typically work with overlapping views of the same system e.g.
the physical space of the city .
practical experience withotherdomainswouldprovideadditionalusefulassessments and be an interesting future effort.
specifically a systematic investigation would assess if meaningful properties and view models in typical use cases in other domains exhibit overlap in types.
1001our multiple view technique has been demonstrated as based on bigraphs and brs which although generic and widely applicablehavenotenjoyede.g.
practicalapplications.however their well defined semantics and hierarchical structure led to elegant algorithmictreatment sec.
.1and5.
.wenotethatthetechnique could be readily applied for generating reduced views for other graph based formalisms that utilize types such as graph transformation systems with similar procedures and adoption of bx to support synchronization across models guaranteeing consistency.
finally and regarding the overall process a typical design workflowasillustratedinsec.
.2showsthebenefitofview basedreasoningthroughsynchronizationsautomaticallyupdatingmodels whenchangesoccur.moreover theperformanceoftransformations rightmostcolumnoftable1 renderstheprocedureapplicabletoan onlinesetting.tothisend webelievethatintegrationtoatoolchainsupportingdesignandanalysisasillustratedinthispaperhasmerit andcanenablepracticaluses.
user facingissuespertainingtointegration to some workflow or pipeline such as conflicts handling wheree.g.
twodesignersconcurrentlyedittwoviews ormerging should be tackled as well along with general usability aspects.
related work ourtechniqueisfoundedontheideathatmultipleviewsareneeded toreasonaboutasystemfordifferentrequirements.accordingly weclassifyrelatedworkintomultiple viewreasoning modelslicing and related approaches of synchronization with bx.
viewsasfirst classcitizenshavebeenintroducedbynuseibeh et al.
in their work on requirements of composite systems where requirements are often elicited from multiple sources expressing multiple and partial viewpoints.
a follow up proposesinteraction and integration of different viewpoints contributing to resulting requirements specifications .
subsequent work involved inconsistency handling between such viewpoints by supplying logical rules .
the importance of a rich model providing structure andintegrating complementaryviews capturingdiffer ent system facets was highlighted in .
multi view reasoning was further adopted in architectures with multiple potentially conflictingconcernsforqualityrequirementswithinmission critical systems .
ourreasoning framework issimilarly based onmultiple views our goal however of view generation is analysis of different system facets according to a requirements specification.
slicing has been proposed as a program analysis technique to extract the parts of a program that affect or are affected by executionofagivenstatement.slicinghasalsobeensuccessfully applied at the model level in proposition based slicing temporal logicformulae areused to reducethe size ofa transition systemformodelchecking.
wangetal useslicing toreduce thestatespaceofumlstatechartswhenmodelchecking ltlx.the slicingcriteriontypicallyconsistsofelementsfromaproperty such as the set of states and transitions in or the set of variables in e.g.
for programs .
theslice produced must preserve the behaviour of those parts of the model that affect the truth value of .
the typical strategy to achieve this is a recursive application ofanoperationuntilafixedpointisreached whichissimilarto the technique we employ upon a brs specification.
our technique traversesbigraphicalstructuresuntilafixedpointemerges however we apply this on the system specification using types frombigraphical propositions within ltlxproperties.
we note that our domain graph based reactive systems problem domain multipleview analysis and use of bx to maintain consistency between slices are to the best of our knowledge novel.
bidirectionalmodeltransformationsareapopularmechanism for maintaining consistency of at least two related sources of information.anapproachthatdefinesaconsistencyrelationbetween two models is the qvt relations language in the omg qvt standard supported by a tool complying to checking semantics .
a triplegraphgrammar canbeusedtoconcludeconsistency particularly between graph like structures as well as to find a partialcorrespondencemodelcombinedwithlinearoptimization techniques to detect maximum consistency portions .
however it is time consuming and non trivial to manually maintain round trippinglaws.otherapproachesconsiderastandardforwarddirection with automatically derived backward transformations suchastheatlaslanguage orviagraphquerying .however the forward transformation may not be injective and its ambiguity ofvariouscorrespondingput directionsiswhatmakesbidirectional programming challenging in practice.
recently putback based approaches havebeenproposedtoonlyallowwritingputback transformations.
by contrast a puttransformation could uniquely determine getby well behavedness and the putback based program guarantees that the getbehaviours are unambiguously specified.biyacc andbiflux aretypicalexamples.bigulisa formallyverifiedlanguagewhichservesasafoundationforhigherlevelputback basedlanguages .weadoptbigulinorder to have full control over the consistency restoration behaviors.
conclusion and future work earlyrequirementsvalidationhasbeenrecognizedasafundamentalsoftwareengineeringprinciple.withinreactivesystems thiscanbe achieved by providing formal high level system and requirements specifications their interpretation and mechanical verification thatthesystemmodelformallysatisfiestherequirements.fundamental problems however are scalability and usability this paper offers a novel approach that addresses exactly these problems.
regarding usability theproposedapproachsupportsseparationofconcerns andthustheabilityofdifferentstakeholderstoonlyfocusonviews that pertain to their interest.
to support coherence of the entire system a contribution of this work is the ability to keep views and specificationsynchronized achievedthroughbidirectionaltransformations.
scalability is achieved by analyzing models tailored to specific requirements instead of the complete system.
in future work we plan to improve the way submodels are projected for a given property.
the type based approach we presented is conservative and can produce non optimal submodels although submodelsareproducedveryefficiently.instancesofnodesinstead oftypesmightbetakenintoaccounttofurtherreducesubmodel size.
the technique developed has been exploited in the case ofa specific formalism based on bigraphs.
the idea of view basedrequirements validation however is more general and could beapplied to generating reduced model views for other formalisms thatutilizetypes.suchasgeneralgraphtransformationsystems.
likewise bidirectional transformation techniques may be adopted intheseothercasestosupportsynchronizationacrossmodels guaranteeing consistency across system design and development.
1002acknowledgements researchpartiallysupportedbyaustriansciencefund fwf project m2778 n edenspace andthenationalnaturalsciencefoundation of china under grant nos.
and .