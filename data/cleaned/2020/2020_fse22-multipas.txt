multipas applying program transformations to introductory programming assignments fordataaugmentation pedroorvalho pmorvalho tecnico.ulisboa.pt inesc id ist u. lisboa lisboa portugalmikol janota mikolas.janota cvut.cz czech technical university in prague prague czechrepublicvascomanquinho vasco.manquinho tecnico.ulisboa.pt inesc id ist u. lisboa lisboa portugal abstract therehasbeenagrowinginterest overthelastfewyears inthe topicofautomatedprogramrepairappliedtofixingintroductory programmingassignments ipas .however thedatasetsof ipas publiclyavailabletendtobesmallandwithnovaluableannotations aboutthedefectsofeachprogram.smalldatasetsarenotveryuseful for program repair tools that rely on machine learning models.
furthermore alargediversityofcorrectimplementationsallows computing a smaller set of repairs to fix a given incorrect program ratherthanalwaysusingthesamesetofcorrectimplementations for a given ipa.
for these reasons there has been an increasing demandfor the taskofaugmenting ipasbenchmarks.
thispaperpresents multipas aprogramtransformationtool thatcanaugment ipasbenchmarksby applyingsixsyntactic mutations that conserve the program s semantics and applying three semantic mutilations that introduce faults in the ipas.
moreover we demonstrate theusefulnessof multipas byaugmenting with millions of programs two publicly available benchmarks of programs written in the c language and also by generating an extensive benchmarkofsemantically incorrectprograms.
ccs concepts applied computing computer assisted instruction theory of computation program semantics program analysis program reasoning computing methodologies machine learning.
keywords automatedprogramrepair programtransformation dataaugmentation introductory programmingassignments moocs acmreference format pedro orvalho mikol janota and vasco manquinho.
.
multipas applying program transformations to introductory programming assignmentsfordataaugmentation.in proceedingsofthe30thacmjointeuropean software engineering conference and symposium on the foundations of softwareengineering esec fse november14 18 singapore singapore.
acm newyork ny usa 5pages.
thisworkwas donewhile thisauthorwas visitingciirc ctuin prague.
permissionto make digitalor hard copies of allorpart ofthis work for personalor classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
esec fse november 14 18 singapore singapore associationfor computing machinery.
acm isbn ... .
introduction theincreasing demand forprogramming educationhasgiven rise to all kinds of online evaluations such as massive open online courses moocs focused on introductory programming assignments ipas .
providing feedback to novice students in ipas requires substantial effort and time by the faculty.
therefore automatedprogramrepairhasbecomecrucialtoprovideautomatic personalizedfeedbacktoeachstudent .overthelastfewyears severalprogram repair tools have exploitedpreviouslyenrolledstudentsto obtain diversecorrectimplementations for eachipa.given anincorrectstudentsubmission theseframeworksfindthemostsimilarcorrectsubmissionfrompreviousyears toprovideaminimalsetofrepairstothestudent.typically having a similar correct implementation allows computing a smaller set of repairstofixagivenincorrectprogramratherthanalwaysusingthe setofrepairsneededtomaketheincorrectsubmissionsemantically equivalenttoafixedreferencesolution.furthermore anincreasing bodyofresearchhasfocusedonapplyingmachinelearning ml modelstoautomatedprogramrepair .
these ml based tools depend greatly on the existence of many correct incorrectprogramsto traintheirrepairmodels.however in most cases the publicly available benchmark sets of students submissions for ipasare small i.e.
only hundreds of submissions.
hence these benchmarks might not be sufficient to effectivelytrainanmlmodel.additionally anotherproblemwithsome real world ipasdatasetsisthatsometimesthereisnoknowledge about the number and types of defects present in each incorrect student program whichcan also negatively impact the training of ml basedprogram repairtools.
hence there is an increasing demand for data augmentation of program benchmarks to achieve minimal sets of program patches by having a more diverse collection of syntactically different correct solutions and have a more representative dataset of programs to train ml based program repair tools with labelled incorrect programs.
this data augmentation task aims to enlarge the real world datasets ofstudents programs withmore semantically correct implementations for each ipaby syntactically mutating existentcorrectstudents submissionsandtocreatealabelleddataset of incorrect programs with the information about the number and the type ofthe bugspresent ineachincorrectprogram.
thus thispaperpresents multipas atoolthatperformsdata augmentation by syntactically mutating and or semantically mutilatingipaswritteninthecprogramminglanguage.themaingoal ofmultipas istoaugment ipasbenchmarkswith moresemanticallycorrectimplementationsbyapplyingsixdifferentsyntactic mutations to pre existentcorrect implementations and newsemanticallyincorrectprogramsbymutilatingpre existentcorrect 1657esec fse november14 18 singapore singapore p. orvalho m. janota andv.
manquinho implementations.
multipas stores the variable mapping between theoriginalcorrectimplementationandthenewmutated mutilated program.moreover forthenewlygeneratedsetofincorrectprograms multipas also stores the information about the bugs in theseprograms.later thesebug s annotationscanbeusedtotrain ml models.
experimentalresultsshowthat multipas canaugmentsmallsizedpubliclyavailablebenchmarksof ipas itsp andc packipas generatingmillionsofmutated mutilatedprograms.to summarize this paper makesthe following contributions we present multipas a program transformation framework capableofaugmentingsmallimperativeprogrambenchmarks by performing six different syntactic program mutations and three semantic program mutilations multipas is publicly available on github with a demo video at .
multipas keepstheinformationaboutthetypesandthenumber of bugs present in each generated incorrect program which can be usedto trainml basedprogram repairframeworks multipas produces a variable mapping between the original program given as inputandthe mutated mutilatedprogram.
2multipas this sectionpresents multipas anewtool capableof augmenting ipasbenchmarksetsbyapplyingsyntacticmutationsandsemantic mutilations to c programs.
multipas is divided into two modules program mutator and program mutilator.
the c programs are parsed and the changes program mutations and mutilations happenattheastlevel.section .1presentsthesixdifferentsyntactic program mutations that multipas can perform to change a programsyntaxwhilepreservingitssemantics.afterwards section .
explainsthreedifferentsemanticprogrammutilationsthatintroducesemanticbugsinan ipa.finally section .3explainsbrieflythe variablemappingsproducedby multipas .multipas ispublicly available on github and thereisalsoademonstrationvideoavailableat .
.
programmutator thegoalofautomatedprogramrepairwhenappliedto ipasisto achieve the best possible set of repairs i.e.
program patches to fix a given student s incorrect submission for a programming exercise.
thebestrepairisusuallydescribedasaminimalsetoffixesrequired tomakethestudent sprogramcompliantwiththetestsuitethatdescribesthedesiredsemanticbehaviourforthatspecific ipa.tothis end manyprogramrepairtools suchasverifix trytoalign the student s submission s control flow graph with another correct submission scontrolflowgraph.next theseframeworksproposea set of syntactic patches to fix the incorrect program.
hence applyingprogrammutationstoan ipasbenchmarkincreasesthenumber of different syntactic structures and allows program repair tools toachievesmallersetsofrepairs.forthatreason multipas can perform syntactic mutations to a program such that it preserves the program semantics i.e.
both programs the original and the mutated have the same behaviour.thesixsyntacticprogrammutationsavailableon multipas are m1 comparisonexpressionmirroring cem multipas mirrors oneorseveralcomparisonexpressionse.g.
a bbecomesb a m2 if else statementsswapping ies multipas swapstheifbranch and the else branch and negates the if condition.
this operationisdoneonlyforsimpleif else statements i.e.
there are noadditionalif statementsinside the else branch m3 increment decrement operators mirroring iom multipas mirrorsthetwoincrement anddecrement operatorsinthec programminglanguage e.g.
c and c onlywhenthereturn valueof theexpressionthatcontainstheincrement decrement operator isdiscardede.g.the increment step of afor loop m4 variable declarations reordering vdr multipas reorders thevariables declarationspresentineachcodeblock.forthis multipas takes into account the dependencies between the variables declarations i.e.ifavariabledeclarationdependson othervariables thisisdonebycomputingallpossibletopological orders ofthe variables declarations m5 for while translation f2w multipas translates forloops into while loops.
just in cases of for loops that do not contain any continue instructions m6 variableaddition va multipas introducesanewdummy variable declaration in the program.
the mutated program does not have the same setof variables as the originalprogram.
example .
.
consider the two programs in listings 1and2 inthecprogramminglanguage.bothprogramsaresemantically equivalentsince both programs sum allthenatural numbers from 1tonand print the current accumulated value in each iteration.
the program in listing the mutated program is the result of applyingalltheprogrammutationsavailableon multipas tothe program in listing the original program.
note that the comparisonexpressioninthefor loopconditionwasmirrored mutation .mutation isnotapplicablesincethereisnoif else statement.
regarding mutation one can see that the increment step of the for loopwasalsomirrored line6 resp.
intheoriginal resp.mutated program.
furthermore the mutated program has a different variable declaration order than the original program mutation .
moreover the for loop was translated into a similar while loop corresponding to mutation .
lastly a dummy variable ywas introducedinline3ofthe mutatedprogram mutation .
1intmain 2intn 3inti s 4scanf d n 5s 6for i i n i 7s s i 8printf d n s 11printf d n s 12return0 listing original program.1intmain 2intn s i y 3scanf d n 4s 5i 6while n i 7s s i 8printf d n s i 11printf d n s 12return0 listing mutated program.
1658multipas applying program transformationsto introductory programmingassignmentsfordataaugmentation esec fse november14 18 singapore singapore .
programmutilator in the development of program repair tools there are two main concerns on using incorrect programs of ipasdatasets usually thereisnoknowledgeofhowmanyerrorsarepresentineachbuggy studentprogram and sincethenumberofsemanticerrorson eachprogramisunknown repairframework sdeveloperscannot dividethesetoftheincorrectprogramsintosubsetsofprograms withaspecificnumberofsemanticerrors e.g.
asubsetforprograms with one semantic error another subset for programs with two semanticerrors etc.
.furthermore dividingthedatasetofincorrect ipasinto subsets of different numbers or types of bugs can be important to train ml based program repair tools .
therefore having a program mutilator that creates a dataset of programswithaspecificnumberofsemanticbugsandonlycertain kinds of bugs becomes crucial.
this way developers of program repair tools can evaluate the scalability of their frameworks in terms of the number of semantic errors present in each program andtraintheirtoolsto repairspecific familiesofbugs.
thusmultipas also contains a program mutilator module.
this program mutilator takes a set of students submissions for a given ipaand alterseach program tointroduce nerrors nbeing passed asaparameterbytheuser.theerrorsintroducedby multipas are semantic mutilation which modifies the programs semantics.
the followingthree differentprogram mutilations bugs areavailable onmultipas b1 wrong comparison operator wco multipas swaps an expression scomparisonoperatorsforsomesyntacticallysimilar operator.forexample swapstheoperator for .multipas canalsoswap for for for for and!
for b2 variable misuse vm multipas swaps a variable in the program by another variable of the same type.
the resulting mutilatedprogramcanbecompiledsuccessfullysince multipas ensures that both variables are ofthe same type b3 assignment deletion ad multipas deletes an assignment expressioninthe program.
1intmain 2intn 3inti s 4scanf d n 5s 6for i i n i 7s s i 8printf d n s 11printf d n s 12return0 listing originalprogram.1intmain 2intn 3inti s 4scanf d n 6for i i n i 7s s i 8printf d n i 11printf d n s 12return0 listing mutilated program.
example .
.
consider the two programs in listings 3and4 written in the c programming language.
the program in listing hereafter the original program has been already presented in listing1.theprograminlisting hereafterthemutilatedprogram is the result of applying all the program mutilations available inmultipas .
the first mutilation is located in line of the mutilated program where the operator was swapped by the operator .
furthermore the variable misuse mutilation was performed in line .lastly multipas removedtheassignmentexpressionofvalue zeroto variable s line5 .
the first class of bugs wrong comparison operator is common among novice programmers and has been used to evaluate ml based programrepairtools .
thesecondfamilyof bugs variable misuse isalso common among students as wellas among experienced programmers .
this specifictask hasreceived a lot of attention from the ml research community .
lastly the assignment deletion bug is also common among students .
in the previous example it is likely for a novice student to forget to initialize variable s. bugmapping.
foreachmutilatedprogramgenerated multipas stores the information about the location and the types of the bugs introduced in the program.
this information can help train mlbasedprogram repairframeworks.
.
variablemapping typically semanticprogramrepairtools repairanincorrect program using a correct implementation for the same ipa.
in order to compare two programs it is required a relation between both sets of variables.
for example consider the programs presented in listings 3and4.
in this case having a mapping between both programs variables lets the repair framework reason about which program modifications it should perform to fix the faulty program.
programmodificationsincludethesamevariablebeingusedina different comparison expression the variable being initialized in oneprogrambutnotintheotherone etc.moreover thevariable mappingcanalsobehelpfulforthetaskof codeadaption wherethe repairframeworktriestoadaptallthevariablenamesinapasted snippet of code copied from another program or a stack overflow post to the surroundingpreexisting code .
thus everytime multipas mutatesormutilatesaprogram a mappingbetweentheoriginalprogram ssetofvariablesandthe mutated mutilated program s sets of variables is generated.
this variablemappingcanhelpaprogramrepairframework to find aminimal repair.
example2.
.
multipas wouldproducethefollowingvariable mapping between the set of variables of the programs in listings1and2 int i int i int n int n int s int s int y unk var .
moreover for the program in listings 3and4 the variable mapping would be int i int i int n int n int s int s .
evaluation theexperimentalresultspresentedinthissectionshowtheevaluation ofmultipas on two publicly available small sized datasets of ipas itsp andc pack ipas .theevaluationconsistsof usingmultipas toaugmentbothbenchmarksetsbymutatingor mutilatingallcorrectprograms.table 1showstheoverallresults of our evaluation.the first two columnsin table 1show for each dataset and for each lab class the number of ipas ipascolumn 1659esec fse november14 18 singapore singapore p. orvalho m. janota andv.
manquinho table number of programs that can be generated by multipas using each different mutation or mutilation for two different small datasetsof ipas itsp andc pack ipas .
mutations mutilations bugs itsp dataset ipas correct submissionsm1 cem m2 ies m3 iom m4 vdr m5 f2w m6 va all mutationsb1 wco b2 vm b3 ad all bugs lab3 .25e .90e .70e .74e .70e .34e .03e .86e .51e .51e .71e lab4 .99e .22e .15e .02e .41e .30e .90e .93e .20e .16e .12e lab5 .06e .59e .13e .78e .45e .80e .07e .24e .43e .78e .52e lab6 .94e .29e .36e .12e .45e .74e .75e .52e .32e .70e .02e total .12e .09e .25e .77e .20e .18e .01e .26e .73e .52e .31e cx pack ipas dataset ipas correct submissionsm1 cem m2 ies m3 iom m4 vdr m5 f2w m6 va all mutationsb1 wco b2 vm b3 ad all bugs lab02 .04e .49e .88e .64e .07e .32e .72e .68e .71e .11e .93e lab03 .21e .20e .09e .93e .07e .90e .48e .02e .94e .07e .94e lab04 .83e .85e .97e .72e .28e .80e .93e .07e .58e .08e .39e total .59e .05e .54e .70e .29e .30e .08e .06e .02e .99e .26e andthenumberofcorrectstudents submissions correctsubmissions column .alloftheexperimentswereconductedonan intel r xeon r silver computer with 4210r cpus .40ghz using amemory limit of64gb.
mutating programs.
table1shows the number of programs that can be generated by multipas when applying each individual mutationdescribedinsection .
.onecanseethatalltheprogram mutationsareabletoaugmentatleast100 ofbothbenchmarks.
furthermore both mutations m1 cem comparison expression mirroring and m4 vdr variable declarations reordering are able toaugmentbothbenchmarkswiththousandsofmutatedprograms.
these program mutations produce so many programs since the ipasinbothbenchmarksusemorethanonevariable andinseveral programmingexercises thestudentsneedtocomparethevalues ofdifferentvariables comparisonexpressions .hence multipas computesallpossiblemirroringcombinationsofthecomparison expressionsandallpossiblere orderingsofthevariabledeclarations thatarevalid.lastly iftheuserasks multipas toperformallsix programmutationsonbothbenchmarks thenumberofmutated programs reaches several billionsofprograms.
mutilating programs.
regarding the program mutilations the right handsideoftable 1showsthenumberofprograms multipas cangenerateusingeachdifferentmutilationdescribedinsection .
or all of them together.
all the program mutilations are able to generate a dataset with several thousands of incorrect programs.
mutilation b2 vm variablemisuse isthemutilationthatisableto generatemoreincorrectprogramssincetypicallytherearemany possibilities when multipas is changing a variable occurrence for anothervariable.
user configuration.
the number of programs that can be generated bymultipas can reach several million.
therefore multipas has three flags available related to the total number of programs that can be generated.
by default multipas generates only ofthoseprograms.theusercanchooseadifferentpercentageof programstobegeneratedusingtheflag p percentage total progs.
instead of generating all the programs multipas chooses a sample of size p. the user can ask multipas with flag info to print the total number of mutated mutilated programs for a given configurationofprogrammutations mutilations.
multipas only outputsthenumberofprogramswithoutgeneratingthem.iftheuser desires all the programs and has the time and memory to generateallthepossiblemutated mutilatedprograms thiscanbedone using the flag ea enumerate all .
related work in the last few years there has been a growing interest in data augmentationbyprogram transformation.yuetal .
proposedto applyseveralprogramtransformationsforbigcodedataaugmentationbasedonapre definedsetofsyntax basedrulestomutateprogramswritteninjava.liuandzhong proposedtoextractjava code samples from stack overflow and mine repairpatterns from the extracted code samples.
deepbugs also uses rule based mutationstobuild andnottoaugment adatasetofprogramsfrom scratchtotrainitsml basedprogramrepairtool.
buglab isa pythonprogramrepairframeworkthatlearnshowtodetectandfix minorbugs.inordertotrain buglab allamanisetal .
applied four program mutations and four program mutilations different thanmultipas sprogrammutationsandmutilations inorderto augment theirbenchmarkof pythonprograms.
conclusion thispaperintroduces multipas anopen sourceframeworkfor augmentingbenchmarksofintroductoryprogrammingassignments ipas .multipas can generate semantically equivalent programs byapplyinguptosixdifferentsyntaxmutationstoagivenprogram.
furthermore multipas canalsoproducesemanticallyincorrect programs using three semantic program mutilations.
moreover multipas savesthevariablemappingsbetweentheoriginalprogram and the mutated mutilated one and the information about the bugs introduced in each program.
experiments on two publicly available datasets of ipasshow that multipas can augment with millions ofprograms small sizedbenchmarks of ipas.
data availabilitystatement multipas ispubliclyavailable inthe acmdigital library .