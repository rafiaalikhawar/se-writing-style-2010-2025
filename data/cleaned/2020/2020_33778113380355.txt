finding client side business flow tampering vulnerabilities i luk kim kim1634 purdue.edu departmentof computer science purdue university west lafayette indiana usayunhui zheng zhengyu us.ibm.com ibm t. j. watson research center yorktown heights usahogun park hogun purdue.edu departmentof computer science purdue university west lafayette usa weihang wang weihangw buffalo.edu university at buffalo suny buffalo usawei you youwei ruc.edu.cn renmin university of china beijing chinayousra aafer yaafer purdue.edu departmentof computer science purdue university west lafayette usa xiangyu zhang xyzhang cs.purdue.edu departmentof computer science purdue university west lafayette usa abstract thesheercomplexityofwebapplicationsleavesopenalargeattack surfaceofbusinesslogic.particularly insomescenarios developers havetoexposeaportionofthelogictotheclient sideinorderto coordinate multiple parties e.g.
merchants client users and thirdpartypaymentservices involvedinabusinessprocess.however such client side code can be tampered with on the fly leading to businesslogicperturbationsandfinancialloss.althoughdevelopersbecomefamiliar withconceptsthatthe clientshouldneverbe trusted giventhesizeandthecomplexityoftheclient sidecodethat maybeevenincorporatedfromthirdparties itisextremelychallengingtounderstandandpinpointthevulnerability.tothisend we investigate client side business flow tampering vulnerabilities anddevelopadynamicanalysisbasedapproachtoautomatically identifying such vulnerabilities.
we evaluate our technique on popular real world websites.
with negligible overhead we have successfully identified unique vulnerabilities on websites suchas new york times hbo and youtube where an adversarycan interrupt businesslogic to bypass paywalls disable adblocker detection earn reward points illicitly etc.
ccsconcepts security and privacy web application security.
permissionto make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may23 seoul republic of korea 2020association for computing machinery.
acm isbn ... .
javascript vulnerability detection business flow tampering dynamicanalysis acm reference format ilukkim yunhuizheng hogunpark weihangwang weiyou yousra aafer andxiangyuzhang.
.findingclient sidebusinessflowtamperingvulnerabilities.in 42ndinternationalconferenceonsoftwareengineering icse may23 seoul republicofkorea.
acm newyork ny usa pages.
introduction theintrinsiccomplexityofthewebecosystemhascreatedanattractive attack surface for manipulation and exploitation.
adversaries have exploited many common flaws that plague various entities in theecosystem.ofparticularinterestareclient sidebusinesslogic flaws.if exploited they may lead to devastating consequences.
asasideeffectofexposingpartialbusinesslogictotheclientside by perturbing the internal control flow of events adversaries are able to change the intended behavior of a website and cause variouskindsofdamages.forexample supposeanapplication s addeliverymechanismis developedwiththeintentionofplaying asponsor svideobeforestreamingtheactualcontent.malicecan directly skip the first step to circumvent the business model of the website.similarly awebsiterewardsairlinemilesafteraparticipant fills out a survey.
an attacker can illegitimately earn miles without finishing the survey.
a plausible approach to achieving this is to disabletheconditioncheckandforcetheexecutionofrewardslogic withthehelpofuserscriptmanagerutilitieslikegreasemonkey or tampermonkey .
althoughowaspstronglyrecommendsenforcingbusinesslogic ontheserver side client sideimplementationsare commonly seen in practice.
sometimes developers find it is easier to do so on the client side without thinking too much about the consequences.
but more importantly it is unavoidable to devise some portion .
oe oufsobujpobm pogfsfodf po 4pguxbsf ohjoffsjoh icse may seoul republic of korea i luk kim yunhui zheng hogun park weihang wang wei you yousra aafer and xiangyu zhang c !
.
d ?
!
.
a b .
c 34ce5 !
!
c .
!
!
?
!
c34ce5 4ce5 .
dc ?
.
.
a figure motivating examples ofthelogicontheclient sidetoconnectthedotsinsomescenarios.
web applications nowadays commonly integrate third party content or services.
in such cases the client side logic plays an importantroleincoordinatingtheinternalstateswiththoseofmultiple parties.
forexample a web store may integrate a third party paymentserviceandimplementtheclient sidelogictodrivethecheckout procedure .
for websites that serve a huge number of anonymous users e.g.
youtube it is very expensive to rely on the server side to maintain the comprehensive states of all users.
threat model.
we assume adversaries can manipulate client side executiononthefly.forinstance theycantriggerwebpageevents in arbitrary orders.
they can modify client side scripts change event handlers bypass condition checks and alert and send http requeststoservers.however weassumetheydonothaveaccess to servers so they cannot modify server side logic.problem statement .
web applications extensively incorporate codefrommultiplesourcesandthusitisdesirabletounderstandtheriskshiddenintheclient sideimplementations.however giventhesizeandthecomplexitiescausedbyjavascript js dynamicfeatures and event based executions it is extremely hard to audit client side scripts including those from third parties and identify the locationsthatarevulnerabletobusinessflowtampering.tothisend we propose a dynamic analysis based approach to help developers focus on places that are more likely to be real vulnerabilities.
by reportingthe locations andtheconcretetampering instances our methodcanhelpdeveloperseffectivelyevaluateifactionsshould betakentoeitherrelocatethelogictotheserver side deploysomeruntimeattackdetectiontechniqueorincorporateadditionalclientside defensetechniques.
in this paper we investigate the pervasiveness of the clientside dom related business flow tampering vulnerabilities t ot h ebest of our knowledge this is the first study to characterize theimpact of the client side business flow tampering vulnerabilities.
astheyarecommonlycausedbyinsufficientprocessvalidation we proposeanautomaticdetectionmethodthataddressesthefollowing challenges pinpointingplacesvulnerabletobusinessflowmanipulationis difficultin multi functional web applications.
dynamicwebapplicationfeaturesshouldbehandledascodecan be injected and generated on the fly.
codemodificationtechniquesandevent baseddynamicexecutionsmakestaticanalysis difficult.inparticular ourmethodsystematicallyexamineswebsitesas follows starting with business operation descriptions we navigate the website and collect a set of functions that may be relevant tothebusinesslogic.
weanalyzeeachcandidatefunctionand lookforpotentialtamperinglocations whichmayperturbtheintended behavior if modified.
we develop techniques to select functionsthataremorelikelytobevulnerableandgeneratetampering proposals for each selected function.
we revisit the website withthetamperingproposalsandconfirmifthedetectionresults are indeed business flow tampering vulnerabilities.
to understand the scope and magnitude of the vulnerabilities in practice weevaluateourmethodon200real worldwebsites.weare abletodetectclient sidebusinesslogictamperingvulnerabilitieson popularwebsites.specifically attackerscanbypasspaywallsand read an unlimited number of articles without paying on nytimes andwashingtonpost.detectedflawson youtubeandcwtvenable attackers to skip in stream video ads.
we also discover a flaw inthe popular reward earning website inboxdollars attackers can illegitimatelyearnrewardspointswithoutfinishingtherequired steps e.g.watchvideos .inourexperiments weareabletostack .
reward for an hour attack with a single machine without watching videos and if we continue this attack we could steal around per day.
in summary we make the following contributions we investigate the pervasiveness of the dom related client side business flow tampering vulnerabilities.
we develop a novel dynamic analysis based approach to automatically identifying client side business flow tampering vulnerabilities.
we evaluate our method on popular real world websites.
withnegligiblepageloading renderingoverhead wefound27 unique vulnerabilities where an adversary can interrupt the business logic to bypass paywall disable adblock detection earn rewards illicitly etc.
motivation in this section we use two real world examples to show a how business logic can be tampered with on the client side b whysuch vulnerabilities are common and c why identifying these vulnerabilitiesis challenging.
finding client side business flow tampering vulnerabilities icse may seoul republic of korea .
bypassinga metered paywall new york times nyt is a well known news publisher.
its mainbusinessmodelisameteredpaywall.itallowsuserstoread alimitednumberofarticlesforfree.afterthat paidsubscription isrequired.nytdevelopersimplementedthemeteredpaywallin march .
within three months the system generated subscribers .withthepaywall afterauserreachesthequota of free articles a subscription message box with a black colored background covering most of the screen will be displayed.
inspired by nyt s success many publishers e.g.
washington post the boston globe and chicago tribune adopted a similar paywall system.
fig.
a describes part of the simplified paywall implementation.eachtimeanewsarticleisaccessed thearticlepageisloaded as if there was no paywall.
the paywall logic is implemented ina js file loaded as part of the article page.
in the js file function window.webpackjsonp invokesfunction initmeter whichfurther calls checkmeterdata line4 thatimplementsthepaywalllogic.in thefunction themeterdataisfirstaccessed line13 .ifthecurrentuserexceedsthefreequota function showpaywall line16 inserts the subscription message box.
to bypass the paywall the attacker candisablethefunctioncall checkmeterdata .consequently the subscriptionmessageboxiselidedandtheattackercancontinue toaccessarticlesforfree.ademovideooftheattack hostedonan anonymouswebsite can be found at .
whileowasprecommendsthatcriticalaccesscontrolshould beperformedsolelyontheserver sidetoavoidanyclient sidetampering nyt sdesignsimplydeliversallthecontenttotheclient and relies on client side access control to protect the content.
further inspection suggests that there are reasons for such a flawed design.itlookslikethepaywallsystemwasintroducedasawellencapsulatedandstand alone add on i.e.
a self contained jsfile to avoid any complex interference with the previous code base.
properlyimplementedaccesscontrolhastomonitoreachpageload fromtheserver side requiringsubstantialcodechanges.furthermore thenumberoffree readersisordersofmagnitudelargerthanthatofthesubscribers.acorrectdesignrequiresmaintainingsome profile for each free reader on the server side e.g.
the numberof free articles accessed by the reader in a time duration which wouldbemuchmoreexpensivethanthecurrentdesignthatonly needs to maintain subscribers profile.
the current design relieson the client side resources to deal with a large number of free readers.
such dilemmas are typical leading to many flawed design and implementationas shown by our results in section .
.
skippingin stream ads ads revenue is crucial for business sustainability of streaming services like youtube.
although service providers try to make money from other sources such as membership subscriptions it turnedout they often have to scale back and rely mostly on ads .
in particular youtubeinsertsadvideosbeforeandinthemiddleof contentvideos.recently itevenstartedshowinghollywoodmovies with ad breaks for free .
to implement this youtube has to use client side logic because it needs to coordinate states among multiplepartiesand dynamicallyload videos from ad networks.
fig.
b showsasimplifiedversionoftheprocess.theadvideos arecontrolledbyfunctionsconnectedbybluearrows whilebannerads are managed by functions linked by green arrows.
function ytplayer.load isinvokedduringpageloadandeventuallyinvokes function g.h.start .thefunctionfirstgetsavailableadsfromthirdpartyadproviders line3 thendecidesifadvideosshouldbeplayed by checking if the list this.ads is empty line .
if yes functions showadandshowvideoad arecalledtoplaythein streamvideoads.
otherwise itskipsandplaystheactualcontent lines7 .filling upthis.adsisbyaseparatethreadinthebackground controlledbya timer.similarly function g.h.dispatchevent isinvokedregularly to deliver ad banners via function showbanner .
by enforcing the falsebranchoutcomeatline4 theadsareskippedandtheusercan watchthecontentvideowithoutwatchingtheads.notethatthis is different from using an ad blocker to block ads.
many modern web applications are equipped with anti adblocker mechanism including youtube .
anti adblockers often work by monitoring dom object changes after ads are loaded.
if no change is observed meaningtheadsarenotdisplayed itgetsintoablockingmode requiring the user to turn off the adblocker.
an anti adblocker has to be closely coupled with the ad display function.
in this case the anti adblockerispartofthefunction shownad line5 .assuch bytamperingwiththejscode i.e.
line4 directly theads together with theanti adblockerlogic are silently evaded.
akeyfeatureofthesebusinessmodelsisthatthecontentpublisher orserviceprovider wantstoensurecertainoperationsmust beperformedontheclient side whichcannotbetrusted.thisis not a new problem.
there are many other rigorous business logics such as online shopping credit card transactions and online bank transactions.
the key enabling technique in those business models is to associate a crypto protected credential e.g.
token with a user .thetokenissharedbythemultiplepartiesinthebusiness model such that client side operations can be remotely verified.
forinstance anonlineshoppingapplicationhastointeractwith atleastaremotepaymentserviceproviderandaremoteproduct provider.thepaymentisrecordedbythepaymentserviceprovider with thecredential of theuser.the product providercan independentlycheckwiththepaymentserviceprovidertomakesurethe payment is in place before the product is sent.
such distributed integrityprotectionmechanismisheavyweightandoftendeployed inapplicationswhereusersareproperlyprofiled e.g.
userswith accounts .
however manywebapplicationsserveavastnumberofusers with most of them not properly profiled and hence do not have associatedcredentials.nonetheless thecontentpublisherswanttheirinteresttobeprotectedonthoseun profiledusers bylimitingtheir quotalikeinnytorforcingthemtowatchadslikeinyoutube .
suchlight weightbusinessmodelsusuallyhavetorelyonclientside logic to conduct access control.
in the youtube example ad networksaredesignedinsuchawaythatanythirdparty including individuals can bid for an ad slot on youtube .
most such third partiesdo nothave thecapacity tosupport remoteauthentication likethepaymentserviceproviderinonlineshopping whichentailssaving credentialsof individualusers.while abetterscheme may be possible for lightweight business models in the future e.g.
through some centralized service like google doubleclick client side tampering is a realistic and prevalent vulnerability.
as shown in the above examples such vulnerabilities can lead to financial icse may seoul republic of korea i luk kim yunhui zheng hogun park weihang wang wei you yousra aafer and xiangyu zhang loss.ifsuchattackswerelaunchedatalargescale websitesmay go out of business.
hence it is in websites best interest to identify such vulnerabilities so that they can take action to secure their interest for example by employing more expensive authentication schemes deployingon the flyattackdetectionon the server side or even performing sophisticated client side obfuscation.
identifying client side tampering vulnerabilities is challenging.
client sidecodeusuallycomesfrommultipleparties.in addition as suggested by the results in table.
there are js functionsonaverageinasinglepageload.duetotheoverwhelming size and complexities i.e.
js dynamic features code minimization and obfuscation of the client side code it is impractical for developerstomanuallylocatethevulnerablepoints.developingan automated tool to expose such problems is necessary.
therefore we propose a dynamic search based approach that applies a set of pre defined tampering operations on client side js code.
these tampering operations include enforcing branch outcomes skippingorrepeatingfunctions.toreducethesearchspace we develop an analysis technique to identify js code elements that arelikelytobebusinesslogicrelatedandfocusontamperingthose.
in particular we observe that client side business operations areusually correlated to dom mutations.
hence we intercept such eventsandcollectthecorresponding candidate jsfunctions.todeal withtheprominentdynamicfeaturesofjscode ourtechniqueis dynamic modifying the underlying js engine to instrument the internal intermediate representations of js code on the fly instead ofdirectlyinstrumentingjssourcecode.fortheaforementioned youtubeadbannercase ourtechniqueselects159codeelements as potential tampering candidates from functions.
the vulnerability disabling ad banners is identified after trials.
we have reported such problem to developers along with the nyt case.
system overview fig.2providesanoverviewofourvulnerabilitydetectionprocedure whichcan be largely divided into three phases.
siteinformationcollection .byrecordingandinspectinguserinteractions wecollectbasicinformationaboutthetargetedwebsites.
in particular we identify dom objects that should be monitored formutationeventsandgeneratebrowsingautomationscriptsthat allow automatic website navigation.
they will be used as inputs to the wholeprocedure.
details can be found in sec.
.
.identify potential js code elements to tamper with .
we analyze the website and generate candidates for tampering.
in par ticular we monitor dom mutation events and collect the corresponding call stacks.
by inspecting the functions on the stack we identifycandidatefunctionsthatmaybebusinesslogicrelated.the candidatesarefurtherrankedbasedontheestimationhowlikely theyarevulnerabletotamperingattacks.foreachcandidate we generate potential tampering proposals that include the tampering points and the corresponding tampering operations.
we explain the components and algorithmsin sec.
.
.
.
vulnerability scanning by tampering testing .
we repeatedly runthewebsitesaccordingtothegeneratedtamperingproposals to filter out proposals that cannot lead to tampering attacks.
in ordertoreducemanualeffortstoconfirmiftheoutcomesarereal attacks we develop automated techniques to group test results based on dom event tracking and clustering.
instead of examining alloutcomes testersonlyneedtocheckonerepresentativefrom eachcluster.weproduceavulnerabilityreporttoexplaintheattack for eachexploit.
we explain the details in sec.
.
.
design inthissection wedescribeeachcomponentindetailandreason about our design choices.
.
website information collection our system requires two pieces of information about the target websitetostarttheprocedure a identifiersofdomobjectsthat arerelatedtobusinesslogicand b browsingautomationscripts.
they are collected automatically by recording testers interactions withthe targetedwebsites.
inthe youtubeexample discussedin sec.
testerscanrecordbrowsingactivitiestoautomatetheopera tionssuch as playvideo .in themeantime testers canalsospecify elements or regions on the webpage that might be related to the businesslogicbysimplyclickingabuttonprovidedbyourtool.oursystemautomaticallycollectsdomselectorsthatidentifythedom objects involved.
note that our technique does not require good code coverage of the application.
any test case that triggers the businessmodelissufficient.duetotheessentialroleofbusiness model a typicaluse casewould easilycover it.furthermore such manualeffortsareone time.ourtoolrecordstheuseroperationsinanautomaticscriptthatcanberepeatedlyexecutedinthescanning phase.
hence the manual efforts required are minimal.
.
identifyingpotentialbusiness logic related functions as testers already specified their areas of interest on the web page weinterceptthemutationeventsonthedomobjectsandcollect the corresponding asynchronous call stack.
then we consider the functions onthe stack that aremore likely related tobusiness logicandgivethemhighpriorities.inparticular whenmutation eventssuchasattributeupdates nodemodifications orchilddomtreechangeshappen ahookfunctionwillbeinvokedtocollectthefunctioncalltracecontainingthefunctionsthatdirectly transitively trigger the changes.
we exclude common js libraries since they are unlikely tampering vulnerability candidates.
we remove them using a whitelisting approach.
notethatwemayobservedifferentcallstacksforthesamemutationevent.wehenceconstructacalltree bymergingthesamefunc tionsinstacktracesthroughapreprocessingstep.taketheyoutube caseinfig.
b asanexample.thefunction showad appearsin twodifferenttraces.ithastwodifferentcallees showvideoad and showbanner inthetwotraces.theyarehencethetwochildren of showad in the call tree.
all nodes in the call tree of a relevant dom mutationare considered candidates and given high priorities.
.
dynamic page data collection in order to overcome the challenges introduced by js dynamicfeatures in this step we collect runtime information about thecandidate functions obtained in the previous step.
in particular we dynamically construct a business control flow graph bcfg finding client side business flow tampering vulnerabilities icse may seoul republic of korea !
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
figure approach overview .
.
!
!
a b figure source code and business control flow graph bcfg offunction showadwitheachnoderepresentingabasicblockwithauniqueidfollowedbythestatementsintheblock for eachcandidate which abstracts away path conditions that are unlikelyto do with access control in business logic.
.
.
business control flow graph bcfg .
the abstraction focusesonprecludingpredicatesthatarenotrelatedtobusinesslogic access control.
specifically loop predicates are abstracted away as we consider loop predicates are unlikely to perform access control.
while abstracting away loop predicates we retain the loop body which may contain important function calls.
note that bcfg is not intended to be compiled and executed.
it is more a representation forustoenumeratethepossibletamperingschemes calledtampering proposals .
after abstraction bcfg mostly contains the followingconditionalstatements if then else switch case and conditional ternary operator .
a more heavy weight analysis e.g.
onethatleveragesdata flowanalysis mayhavedifficultydealing with the various complex language features and the extremely dynamicnature of js code and hence is less desirable.example.
fig.3adepictsasimplifiedversionofthefunction showad discussedintheyoutubemotivatingexample.function showad renders ads differently based on the ad types e.g.
video ads orbanner ads .
at line it checks the ad type variable a.o and verifies if it s a banner ad.
if so the function resumes the player a.dispatchevent e at line and displays the banner ad by invokingfunction a.o.start atline9.otherwise thefunction plays the video ad by invoking function a.o.start at line .table ten features for function ranking idfeatures of candidate function fn f1domainsimilaritybetween the website url and fn s script url f2the loading order of the script containing fn f3the number of appearance of fnamong all call stacks f4the position of fnon its call stack f5the collecting order of the call stack with fn f6the lengthof the call stack with fn f7the number of times fnis called f8the number of times fn s callee is called f9the number of branches in fn f10 fn s callee directly mutates dom yes no fig.
3b shows the bcfg of the function showad where each box represents a block of instructions and each arrow denotes control flow.inparticular theexecutionpath bb0 bb1 bb4andbb6 represents the video ads delivery procedure.
the yellow colored block bb6containsthefunctioncalllinkingtothenextfunctiononthe callstack.besides bb6iscontrol dependantonthegreen colored blocks bb0 bb1andbb4 .
observe that the loop predicate at line is abstracted away.
in addition to stack traces and bcfg we collect dom mutation types functionexecutionfrequencies positionsinsourcecode and thesourceurl.suchinformationisneededinthelaterscanning phase.
note that we convert the position information of a codeelement in the row and column format in the source code toits ir offset used inside the js engine as tampering is performed bythe modifiedengine.
forexample thepositionof functioncall statement showad this i nf i g .1i s row column .
we convertitto offset with89theiridentifierofthestatement.
.
tampering proposal generation withthecalltreesofdommutationsandthebcfgsofthefunctionsinthecalltrees thenextstepistogenerateasetoftampering proposals that specify the code location to tamper with and the tamperingoperation.althoughthesefunctionsandpredicateshave a higher priority compared to others due to the large search space we develop additional techniques to further rank the functions and predicates.inparticular wefirstrankfunctionsusingalearningbasedmethod.thenthebcfgsofrankedfunctionsaretraversed in order to derive tampering proposals.
.
.
candidatefunctionranking.
aswewillshowinsection5 the number of functions in the call trees of dom mutations is still verylarge.ideally wewouldliketodevelopatechniquetodetermine which of these functions are more likely to contain business access control.
however a solely program analysis based solution may not have the desirable effectiveness as runtime information provides strong hints.
for example a business access control js icse may seoul republic of korea i luk kim yunhui zheng hogun park weihang wang wei you yousra aafer and xiangyu zhang file tends to be loaded before many other jss the function that performsaccesscontroloftenhashighexecutionfrequencythan the content delivery function guarded by the access control the url of a business model related js file tends to share common domainnameasthemainpage etc.unfortunately theseproperties are uncertain and their importance is difficult to determine by humans.
therefore we propose a learning based method to predict the likelihood of a function containing business access control.
we then rank the functionsbased on their likelihood.featureselection.
basedonourobservationofthepropertiesthat arepossiblyimportant we select10features asshownintable1.
weusetamperinglocationswealreadyknow inasmallnumber of web applications to evaluate the significance of the features.
to refine selected features anova f test was leveraged.
the null hypothesis of the test is that the feature takes the same value independently of the output value to predict.
as a result highlysignificant features were chosen for our classification task.
all featuresarenormalizedindividuallybysubtractingthemeanand scalingto the unit variance.estimationof likelihood by learning a classifier.
after selecting features a classifier is learned from the training data.
as our data may be biased we explore using the balanced random forest brf the weighted svm w svm and the weightedlogistic regression w lr which are more interpretable than other classifiers e.g.
neural networks and more robust when they have a small scale of training data.
balanced random forest brf isanensemble algorithmbyabalancedbootstrappingmethod.in particular weuse1 000asthenumberofestimators.inaddition the gini impurity is used for split criterions.
w svm with rbf kernel and w lr use the ratio of class labels in their cost functions and putmoreweightontherarecasestoalleviatebias.inthetesting stage probabilities or regression values are used to estimate the likelihoods and are ranked by the scores.
to collect the training set for selecting features and learning the classifier we first prepare a few confirmed tampering cases.
afterthe training we keepusingthe trainedclassifierto rankthe candidatefunctionswithoutany additionaltraining.the result ofthe feature selection and learning will be discussed in sec.
.
.
.
.
.
tampering proposal generation.
tampering proposals are generated by algorithm .
it takes two inputs the ranked candidatefunctions whereeachfunctionhasitsabstractedbcfg the callsitetoitscalleesinthecalltree andtheurlofthesourcecode.
thetamperingstrategy whichcanbeeither bypassorrepeat.intuitively bypassskips a function call to see if the logic can be altered inthedesiredway whilethe repeatstrategygeneratesproposals thatrepeatedly invoke the callee.
the output is a list of tampering proposals indicating where and how the execution should be tampered with.
in particular a tampering proposal consists of the url of the script containing thecandidatefunction thesourcecode offsetofthetampering point the branchindex and thetampering action.the branch indexspecifiesabranchoutcomethatshouldbeenforced.forexample a basic block ended with an ifstatement may have two outgoing branches.
if we want to execute the true branch next we assign0tothebranchindex.otherwise wesetthebranchindex to1.besidepredicates wemayalsotamperwiththeexecutionofalgorithm1 tampering proposal generation input f candidate functions sorted by the likelihood having tampering points.
f f is a function with the bcfg the call site to its callee on stack and the url of thescripthaving f. ts thetamperingstrategy which can be bypassorrepeat output t tamperingproposal script url offset branch index action t function generatetamperingproposals f ts t for each f fdo f. ca llsite is the call site in fto its callee on stack co getoffset f. ca llsite iftsisbypassthen t t f. url co none disable callee b getcontroldepbasicblocks f. ca llsite foreachb bdo b.branch cntis the number of outgoing paths of basic block b fori 0tob.branch cntdo ifhaspath b i f.callsite.basic block then skip the existing path from bto the callsite continue b.branching stmt is the last stmt before branching in b. bco getoffset b.branching stmt generate a non existing path starting from b.branching stmt t t f. url bco i force branch outcome fo getoffset f t t f. url fo disable caller disable function f else repeatedly invoke the callee of fon stack t t f. url co none repeat callee non predicatestatements.inthiscase theproposalsimplyspecifiesthelocationofthestatementwithoutthebranchindexinformation.
theactionindicateshowtheexecutionshouldbetamperedwith at a particular tampering point.
the action can be disable callee disable caller force branch outcome o rrepeat callee.
details of each actioncan be found in sec.
.
.
.
foreachcandidatefunction f wefirstlocatethelocationswhere finvokes its callees observed on the stack line .
for example in fig.
b the invocation statement at line is the call site wherefunction g.h.start invokes its callee showad.
although a candidate function may invoke multiple callees in the execution weseparate them and create a trace for each invocation.
therefore in our representation a candidate function only has one call siteto its callee in a trace.
under the strategy bypass we generate a proposal that skips the invocation of the callee function line .
then we obtain the basic blocks that the call site control depends on line7 whereeachbasicblockreturnedhasanumberofoutgoing branches i.e.
branches for basic blocks with an ifstatement andnbranchesfor basicblocks ended with a switch case .
nowwewanttogenerateproposalsthatfollowpathsthatare differentfromtheoneonthestack.todoso wecheckifthecall siteisreachablethroughaparticularpath.amongthem weskip the path connecting the predecessor block and the call site line .
since we want to explore the remaining paths even the path conditions are not met we generate proposals for such paths line so that we can force the branch outcome.
thealgorithmalsocreatesaproposaltoskipexecutingtheentire function f line15 .ontheotherhand ifthegenerationstrategy isrepeat the algorithmcreates a proposal that repeatedlyinvokes the callee function line .
finding client side business flow tampering vulnerabilities icse may seoul republic of korea .
businessflow tampering testing afterthetamperingproposalsaregenerated weuseatesting based approach to confirm the real vulnerabilities.
for each proposal we leverage the automated script recorded in the earlier phase to load the target website.
when the modified js engine gets a script specified by the tampering proposal it mutates the bytecode ir on the flyaccordingtotheactionspecifiedintheproposal.after a batch of tests we gather test results and cluster them based on similarities.finally atesterconfirmsthesuccessofthetestingby checking the clustered results which are usually just a few screen shots showing if the access control is circumvented.
in this section we first discuss how our system manipulates the business flow.
then wedescribehow wefilter outtest resultsusing domevent tracking and clustering techniques in order to minimize manual efforts.
.
.
tampering actions.
as mentioned before there are four possible actions disable callee disable caller forced branching and repeat callee.
next we explain how they are supported.
disablecallee.
when the interpreter encounters the function call expression specified by the tampering location it skips the call.disable caller.
we disable the bytecode generation for statements inthefunction whichisequivalenttogeneratinganemptyfunction.
this is because we still need the definition of the disabled function.
otherwise the interpreter may crash if the disabled function is referredtosomewhere.disablingcallercanbe beneficial because it disables all function calls from other locations even not in thecall stacks we collected.
for example in fig.
b if the website also plays the ad in the middle of playing the content it can be turnedoffbydisablingtheexecutionoffunction showad instead ofdisablingall thefunctioncalls.furthermore callbackfunctions triggered by native functions e.g.
event handler or by external js libraries can only be disabled by this method since call statements are not accessible.forced branching.
the branchingtarget is forcefully setregardless of the result of the predicate condition.
however we still interpret the condition expression because it may have sub operations e.g.
function calls .
repeat callee.
thistamperingactionisforduplicatingdesirable behavior e.g.gettingrewards byrepeatedlyinvokingthefunction.
a naive approach to repeating callee would be to interpret the function call statement twice.
however business logic normally requiresnetworkinteractionbetweentheclientandwebservers.
so it is very likely the duplicated requests without interval willbe ignored or considered as an error.
we could add intervals by callingthe sleepfunctionatruntimeinthejsengine.however this mayblockthesingle threadedjsengineandsubstantiallyinterrupt thenormalexecution.tosolvethisproblem weuse settimeout function and register the function to be repeated as a callback functionof the timer event.
.
.
testresultscreening.
afterfinishingeachtesttrial weneed tocheckifthetamperingproposalsuccessfullyalterstheoriginal business flow in an intended way.
since our approach relies on domchanges asimplesolution istotrack theexistence ofdom mutationevents.forthenytexamplementionedinsec.
ifthedommutationeventthatistriggeredwhendisplayingthesubscription message box is reproduced in testing this tampering proposal is not successful.
however even if the dom mutation event is not triggered it does not mean that this test trial succeeds for various reasons.forinstance thetamperedexecutionmaystopshowing thesubscriptionmessagebox butitalsoblocksotherdomobjects suchasthearticlecontent.itisalsopossiblethattheeventisnot triggered because the page is crashed.
a more complex scenario is thatthetextmessagedisappears buttheblackboxstillexists.since there could be countless outcomes depending on web applications a tester s intervention is inevitable to make the final decision.
in order to minimize the manual efforts we group test results using a similarity basedclusteringtechnique.insteadofaskingtestersto check every result they can just check one in each cluster.
such number is smaller according to our experiment in section .
furthermore fortherestofthetestingbatches thetesteronlyneedsto checkwhenanewclusterisfound.tobespecific foreachtesttrial when the original dom mutation event is not triggered we take a screenshot get the corresponding html source code and store as a test result entry.
after testing a batch of tampering proposals wegroupthecollectedtestresultswithasimilarity basedclusteringal gorithm.weusethestructuralsimilarityindexmethod ssim for screenshots and tree edit distance ted algorithm for html files to compute the structural similarity between dom trees.
as a metric of the clustering algorithm we combine the two similarity scores since they complement each other.
specifically clusteringwiththeimagesimilaritymetricusuallygeneratesfinegrained clusters especially if a screen changes frequently.
in the ad banner case from the motivating example screenshots might vary depending on the screenshot taking time since the video content is being played therefore there would be many clusters.
in this case domtreesimilaritymetricwouldreducethenumberofclusters ifwecombine themtogether.onthe otherhand imagesimilarity shows better performance if dom structures change dynamically suchasafrontpageofnewspaperwebsitesloadingdynamiccontents.
as a clustering algorithm we select density based spatial clustering of applications with noise dbscan .
the advantage of dbscan is it does not require the number of clusters as an inputunlikeotheralgorithmssuchask means.itisanimportant factor since we do not have any clues about how many clusters exist in the test results.
note that we do not need this step for the repeattampering strategy instead wecansimplycheckiftheoriginaldommutation event is triggered after the specified timeout.
evaluation .
implementation our system1is implemented in python and node.js and the modified js engine isbased on v8 .
.
.
the testingmodule leverages thepuppeteerlibrary whichprovideshigh levelapistocontrol chromium over the devtools protocol .
to collect dynamic data andperformthebusinessflowtamperingtesting weinstrumentthe targetjscodebymodifyingv8engine inchromium.inparticular theinstrumentationworksasfollows oncethev8engineloads 1we plan to make our system available at icse may seoul republic of korea i luk kim yunhui zheng hogun park weihang wang wei you yousra aafer and xiangyu zhang table statistics of websites from categories categorytotal js size kb o fj s of functions of branches newspapers magazine onlinemedia surferrewards travel average !
!
!
!
!
figure normalized execution overhead a scriptfile an abstract syntaxtree ast isbuilt for eachfunctionandfurthertranslatedtobytecodebythebytecodegenerator.
wemodify interpretercompilationjob classtogeneratebcfgs forjs functionsafter theastsare built.the bytecodegenerator classisalsomodifiedtocollectdynamicdataandmutateexecution.
comparing to code rewriting approaches we modified the js enginebecauseitbringsinadditionalbenefits.first itcaneasily handle dynamically generated codes as well as other sophisticated code modification techniques discussed in sec.
.
second it has fewer side effects.
for example it can work with code integrity checkingtechniques e.g.
subresourceintegrity sri features .
.
research questions weinvestigatethefollowingresearchquestionsinordertoevaluate the effectiveness of our system rq1.how much overhead does our system introduce?
rq2.
howmanyreal worldbusinessflowtamperingvulnerabilities can our systemfind?rq3.
howwelldoweestimatethelikelihoodofvulnerablefunctions?inparticular whataretheresultsofthefeatureselectionand the learning algorithm?rq4.how effective are tampering testing and result screening?
rq5.how effective is our system on reducing search space?
toanswertheseresearchquestions werunoursystemon200 real worldwebsites.thewebsitesarecollectedfrom5differentcat egoriesinalexatop500sincetheyusethemostcommonbusiness models such as advertisement paywall and point reward.
.
experimentalmethodologyandresults .
.
rq1 performanceoverhead.
table shows the benchmark statisticsclustered by categories.
on average 307functionscan be observed in a single page load which points to the needs of our approach.wemeasurethreekindsofoverhead thefirstoneisto collectthestacktraceofdommutationevents thesecondiscaused bytheinstrumentationtocollectdynamicpageinformationsuch asfunctionexecutionfrequencies andthethirdisthetamperingtable result of our testing on websites case no.website t.a.
vulnerable operationcase no.website t.a.
vulnerable operation c bostonglobe dcepaywallc cnbc dce anti adblockc nytimes dce c cwtv fe c cwtv dce video ad c cbs fe c foxnews dceanti adblock c seattletimes dce c newsweek dcroffer notificationc miamiherald dce c denverpost dce c cbs dcr video adc etonline dce c youtube fe c amc dce c etonline dce c dallasnews dce paywall c amc fe c 23washingtonpost fe c 10cartoonnetwork fe c 24chicagotribune dce c fox feoffer notificationc youtube dce etc c pcmag fe c hbo fe c 13business standard dce c inboxdollars rc t.a tampering action fe forced branching dce disable callee dcr disable caller rc repeat callee testingoverhead.toreducenon determinismcausedbydynamic pagecontent e.g.
ads wecrawlthepagesandresourcestoalocal directory and then load the local pages and resources with and withoutourtechnique.theformerisconsiderthebaseline.werun eachofthe200websites10timesandaveragetheexecutiontime.
fig.4depictsthenormalizedoverhead.thefirst5setsofbarsshow the overhead observed in each category and the last set denotesthe average overhead.
the overhead for the call stack collection step is .
90ms on average.
we observed the average number of dom mutation events triggered during page loading is .
.hence the overhead of handling one mutation event is around .5ms.
similarly the overhead for dynamic page data collection step is .
70ms .
we do not measure the overhead of executing tamperingproposalsforall200websitesasitcausesexceptionsand early termination in many cases skewing the real overhead.
from the cases that terminate normally the average overhead is .
4ms which is lower than dynamic page data collection.
.
.
rq2 effectiveness in finding vulnerability.
our technique discovers27vulnerablecasesfrom23websitesasshownintable3.
the first and the fifth columns show the case number while the secondandthesixthcolumnsdescribethewebsite.thethirdand theseventhcolumnsindicatethetamperingaction andthelastones contain the vulnerable businesslogic.
observe many websites are mainstream content publishers.
we use the first cases to produce thetrainingsetforthefunctionrankingmodel.afterwetrained the classifier we found more cases.
besides the nyt case in the motivationsection wefound4morevulnerablepaywallsystems c01 and .
instead of using paywall some websites show an offer notification popup at the front page.
we found cases thattheofferpopupcanbedisabled c and11 .fromthe websitesinonlinemediacategory mostofthefindingsareabout skipping the ads before or in the middle of video playing c and .
we also try to tamper with the protection method for theirad relatedbusinesslogicagainstadblockers.wefound9cases c and in which the anti adblock techniques can be bypassed.youtubeshowsadbannersinthemiddleofvideoplaying and this can be skipped by disabling callee c .
hbo prompts a usertoprovidepersonalinformationinordertowatchfreeepisodes right before video starts.
this can be skipped by forced branching c .
inboxdollars gives points to users at the end of watching a video.our systemfounda wayto repeat therewarding operation using the repeat callee tampering action c .
we have uploaded finding client side business flow tampering vulnerabilities icse may seoul republic of korea table function ranking with classifiers a case no.avg.
rank of func.
w tampering point w lrw svm brf c .
.
.
c .
.
.
c .
.
.
c .
.
.
c .
.
average .
.
.
b case no.rank of func.
w tampering pointcase no.rank of func.
w tampering point brfrandom brfrandom c .5c .
c .4c .
c .4c .
c .4c c .2c .
c .4c .
c .3c .
c .6c .
c .6c .
c .5c .
c .3c .
average .
.
demosofourfindings recordedscreensofthesuccessfultampered cases toaprivatewebsite2.weonlyusethesefindingsforresearch purpose.
we have responsibly reported the vulnerabilities to the victim websites and are in communication with them for possible defensesolutions.
.
.
rq3 feature selection and learning algorithm.
we use candidatefunctionsfromthefirst5casesintable3asthetrainingset.
for these cases we test every tampering proposals.
if a vulnerability is found the candidate function containing the tampering proposal is marked as a positive sample.
the others are marked as negativesamples.attheend weacquire56positivesamplesand 402negativesamples.usingthetrainingset weperformthefeature selection process for the features in table .
we conduct the anova test to find out which features are significant.
as a result thefirst5featureswhosep valueislessthan0.1areselected f1 f4 f5 f7 andf8 .next inordertocheckwhichlearningalgorithm worksbestforourscenario wetested3classifiersdiscussedinsection4.
.1usingthetrainingsetwiththe5websites.inparticular we learn each classifier on randomly picked websites and test them on the rest of the websites for its cross validation.
in orderto evaluate the learned models we order candidate functions foreach website based on the likelihood scores and got the rank of thefirstfunctioncontainingtherealvulnerability.weperformthis evaluation test times then calculate the average rank values and table 4a describes the results of the classifiers as a result brf shows the best average rank value.
table 4b shows the function ranks of the successful cases we findafterweapplythetrainedclassifiers brf .inordertoevaluate its efficacy we also select functions times randomly then getthe averaged rank of functions containing the real vulnerability.
as we can see in the table the rank values with the classifier show significantly better performance than the random method.
in of the22cases wefindthevulnerabilityatthefirstcandidatefunction using the ranking.
.
.
rq4 effectiveness of tampering testing and result screening.
table shows the effectiveness of tampering testing and test result screening.thesecondcolumnshowsthetotalnumberoftampering proposals.
the third column describes the number of tests until we find a successful case.
the last two columns show the effects ofthetestresultscreening thenumberoftestresultsafterdom function ranking and screening results case no.
o ft .
p .
of tests to success of results aftere.s.
of results afterclustering c c c c c average .
.
.
.
c c c c c c c c c c c c c c c c c c c c c c average .
.
.
.
t.p.
tampering proposal e.s.
event based screening event basedscreening andthenumberofresultsaftersimilaritybased clustering.
the last column also indicates that the number ofresultsrequiringatester sconfirmation.inthisexperiment wetest tampering proposals in one batch.
as we mentioned the first cases are collected from randomly picked candidate functions and the rest cases are found with the help of the candidate function ranking method.
in the first cases c to c the numbers of tests vary from to .
the worst case is almost of the total tampering proposals c and on average we test around of thetamperingproposals.theclusteringandscreeningsignificantlyreducemanualeffortssuchthattestersonlyneedtocheck8results on average in comparison to the hundreds proposal executions.
in the cases found later c to c the number of tests needed toexposetherealvulnerabilitiesistremendouslyreducedusingthefunctionrankingmethod.theaverageis14.
whichisonly5 ofthetotaltamperingproposals.becauseofthereduction testersonlyneedtocheck2.57resultsonaverage.inaddition weinvestigatethe casesthatdonothavevulnerabilities andweobservethat testers have to check .
clusters on average.
as checking a cluster is as simple as inspecting a screenshot we consider such manual efforts are manageable.
.
.
rq5 effectivenessinreducingsearchspace.
inordertoreducesearchspace wecollectcallstacksbyobservingdommutation events and we remove redundant functions and those from js libraries.
moreover the functions have zero call count during dynamicdatacollectionarealsoremovedinthetamperingproposalgeneration.toevaluatetheeffectivenessofourfilteringmethod we collect statistics for the successful cases.
specifically we collect thetotalnumberof3typesofdata jsfiles functions andbranches icse may seoul republic of korea i luk kim yunhui zheng hogun park weihang wang wei you yousra aafer and xiangyu zhang !
figure effectiveness in reducing search space !
!
!
!
!
.
.
.
!
.
.
!
.
.
.
.
.
!
!
!
.
.
.
.
!
!
figure bypassing adblock detection in cbs.com we have to consider before and after filtering.
fig.
shows the normalized numbers of each data types from cases and the last bar denotestheaveragenumber.aswecansee wecouldreducethe number of each data type substantially.
for instance we need to investigate18 658functionswithoutfilteringifwewanttofindthe case c .
however after filtering there are only functions left and this is only .
of the original number.
on average we only needtoinspect3.
ofthejsfiles .
ofthefunctions or2.
of the branches of those in the original execution.
.
casestudy in this section weshow two case studies to demonstratehow our systemfindsthe business flow tampering vulnerabilities.
.
.
bypassing adblock detection.
the website we use in this case study c is cbs.com which is one of the biggest television networks in the us.
they provide the subscription based online streamingservice andsomeoftheirepisodescanbewatchedfor free with video ads fromsponsors.
they also protect their business logic using the anti adblock technique.
if a user tries to watch a freeepisodewithanadblocker enabledwebbrowser thewebsite blocks the actualcontents witha warning message.
inordertofindiftheiranti adblockertechniquecanbebypassed using our system we collect call stacks by tracking the warningmessage.
after preprocessing we have functions which areonly0.
ofthetotal functionsonthe page.thereare225 totaltampering proposals and after batches which is trials wefoundthevulnerability.notethatafterthescreening only3test results required a manual check.
!
!
!
!
!
!
!
!
figure repeating point reward in inboxdollars.com to analyze how our system found the success case we checked the vulnerability report.
our system found the tampering location infunction createresourceconfig .itscallstackandcodesnippet aredescribedinfig.
a and b .itchecksthepresenceofadblocker using checkforadblocker line3 anditcalls dispatchadblocked to show the warning message line .
if we follow the function checkforadblocker the function testmethod in fig.
c tries to inject a script containing ad string in its url line since the adblock applications usually block those scripts.
the tamperingproposal that forces the false branch of the if statement at line succeeds.asshown oursystemsuccessfullyfoundawaytobypass the anti adblocker technique.
with the tampered business flow userscanwatchfreeepisodeswithoutwatchingvideoads andthis would affect the business model of the website.
.
.
repeating point reward.
inboxdollars c is an online marketing company that connects consumers and advertisers and consumers can earn cash rewards for engaging in a variety of web activities.accordingtotheirwebsite totalcashpaidtomembers surpasses 50millionin2016 .oneoftheservicestheyprovide is video reward they offer points after a user watches a video containingad.tobespecific whenavideoplayerreachestheendof the video it increases a progress bar indicating the current reward status.
in this case we tried to repeat the rewarding activity.
in ordertostarttesting wefirstrecordedbrowsinginteractionsfor logginginandclickingaplaybutton thengatheredadomidentifierbyselectingtheprogressbar.thetotalnumberoffunctions that appeared during testing is and we could reduce it to whichisonly0.
ofthetotalnumber.oursystemsuccessfully found the tampering location with trials out of tampering proposals.aswediscussedinsection4.
.
itdidnotrequirethe manual work to check the success case.
fig.7illustratesthecallstackandthecodesnippetofthefunctiondoonbeforecomplete thathasvulnerability.specifically when thevideo isfinished theplayercalls thefunction ended then the function triggercallsthefunction doonbeforecomplete .inthe function itfirstchecksifthevideohasfinished line2 .ifso itcalls thefunction sc increaseprogress tosendarewardrequest toitsserveraswellastoincreasetheprogressbar.inordertorepeatthecall themodifiedjsenigneaddedthesettimeoutfunction containing the name of the function and a parameter indicating thefunctionwillbecalledafter5 000msec.usingthisvulnerability we could get multiple rewards after watching a single video.
as finding client side business flow tampering vulnerabilities icse may seoul republic of korea mentioned therewardedpointscanbeexchangedtoactualcash.
this directly causes financial damage to the website.
we were able to stack .
reward points for an hour attack with a single machine and if we continue this attack we would get around per day.
we did not exchange the points we got from the vulnerability andweareincommunicationwithinboxdollarssothattheycan deploy defense mechanism.
threats to validity thereareanumberofthreatstothevalidityofourconclusion.part of our technique i.e function ranking requires training.
although ourtrainingtaskisquitesimplewithwelldefinedfeatures weonly use training samples.
while the training set and the test set arestrictlyseparatedandourresultsindicatetheeffectivenessof the trained model it may be possible that the training set is notrepresentative and hence the ranking model may not be optimal.
we will study the effect of including more cases in the training set in our future work.
our results are only acquired on top ranked websites as our technique is heavyweight testing based requiringprocessingthousandsofdynamicallyloadedjsfilesand substantial dynamic contents.
it is possible that these websites are not representative.
we plan to test on more websites.
checking thefinalresultsrequires humanefforts.itispossiblethatwemay misssomerealvulnerabilities.wecurrentlyonlysupportsimpletampering operations which may not disclose complex business model flaws.
related work our work builds on extensive previous work on automatically testingwebapplicationsforvulnerabilities.webrieflydescriberelevant approaches as well as previous works that detect business logic vulnerabilitiesin web applications.
multiplepathexecution.
our work shares some similarity with recent work to explore execution paths by forcing program execution on js programs native binary programs mobile apps andkernelrootkits .forcedexecutionwasfirst proposed in which brute forces control flow at branches to exploreprogrampaths.x force movesforwardbydesigninga crash freeengine.inourwork forcingbranchoutcomeisoneof thetamperingactions.however ourtechniqueaddressesamuch broader problem.
guided mutation testing for js web applications developsgenericmutationtestingapproachesbasedoncommon mistakes made by js programmers .
our technique mutates placesspecifictobusinessmodels.itfeaturessophisticatedmethods to narrow down the candidates of such mutation.
symbolic andconcolic execution based techniques have also been proposedtoanalyzejsprograms.despitetheirgreatpotential handlingsubstantialdynamicfeatures in complex websites remains a challenge.
business logic vulnerability detectors.
recently researchers have proposed a number of techniques to test web applications for business logic vulnerabilities .
these techniques focus mostly on the detection of web based single signonsystemsandthird partypaymentsystems.wangetal.arethe first to analyze logic vulnerabilities on merchant websites and studiedlogicflawsonpopularwebsinglesign onsystems.thesetechniquesfollowanapi orientedmethodologythatdissects the workflow in a particular application by examining how individual parties affect the arguments of related api calls.
sun et al.
proposesastaticdetectionoflogicvulnerabilitiesine commerce webapplicationsbycombiningsymbolicexecutionandtaintanalysistodetectinvariantviolationsofcorrectpaymentlogic .
proposesanapproachtoinvokingstaticverificationofthesafety property of multiparty online services.dynamic js code analysis.
dynamic analysis is commonly used to deal with the highly dynamic nature of js applications.
builds a call graph on client side codes embedded in server sidecodes as string literals.
it handles all possible client side js code variationbysymbolicallyexecutingserver sidecode.ajaxracer detects ajax event race errors in js web applications by testing pairs of user events that are potentially ajax conflicting.
proposesadynamicslicerprovidingacomprehensiveanalysisto identifydata control anddomdependenciesforclient sidejscode.
confictjs finds conflicts between js libraries by identifying potentially conflicting libraries and testing them with generated clientapplicationsthatmaysufferfromthecorrespondingconflicts.
conclusion we present a novel dynamic analysis approach that scans web applications and automatically detects client side business flow tampering vulnerabilities.
we overcome technical challenges that hinder the detection process to make the technique practical.
our evaluation shows that our method has small overhead and discovers27uniquevulnerabilitiesinpopularwebsites whichallowan adversary to interrupt the business logic of web applications such asskippingadsatthebeginningofvideos bypassingadblocking checking and even illicitly earning reward points.
in the future we will further investigate our approach by calculatingprecisionandrecallmetricsforknownvulnerabilitiesso that we can show more accurate coverage evaluation results for possible missing cases.