an empirical study on api parameter rules hao zhong1 na meng2 zexuan li1 and li jia1 1departmentof computer science and engineering shanghai jiao tong university china 2virginiapolytechnic instituteand stateuniversity usa zhonghao sjtu.edu.cn nm8247 cs.vt.edu lizx 17 sjtu.edu.cn insanelung sjtu.edu.cn abstract developersbuildprogramsbasedonsoftwarelibrariestoreduce codingeffort.ifaprograminappropriatelysetsanapiparameter theprogrammayexhibitunexpectedruntimebehaviors.tohelp developerscorrectlyuselibraryapis researchersbuilttoolstomine api parameter rules.
however it is still unknown what types of parameter rules there are and how these rules distribute inside documentsandsourcefiles.inthispaper weconductedanempirical study to investigate the above mentioned questions.
to analyze as many parameter rules as possible we took a hybrid approach that combines automatic localization of constrained parameters withmanualinspection.ourautomaticapproach paru locates parametersthathaveconstraintseitherdocumentedinjavadoc i.e.
document rules or implied by source code i.e.
code rules .
our manualinspection identifiesandcategorizesrulesforthelocated parameters and establishes mapping between document and code rules.
by applying paru to widely used libraries we located parameters with either document or code rules.
interestingly there are only parameters that have both types of rules and pairsoftheseparameterrulesareunmatched.additionally paru extracted1 688rulesentencesfromjavadocandcode.wemanually classified these sentences into six categories two of which are overlookedbypriorapproaches.wefoundthat86.
ofparameters have only code rules .
of parameters have only document rules andonly3.
ofparametershavebothdocumentandcode rules.ourresearchrevealsthechallengesforautomatingparameter rule extraction.
based on our findings we discuss the potentials of priorapproachesand present our insights for future tool design.
acm reference format hao zhong1 na meng2 zexuan li1 and li jia1.
.
an empirical study onapiparameterrules.in 42ndinternationalconferenceonsoftwareengineering icse may23 seoul republicofkorea.
acm new york ny usa pages.
introduction software libraries e.g.
j2se are widely used because they provide thousands of reusable apis.
incorrectly using apis can cause programming errors slow down code development or even introduce security vulnerabilities to software .
since correctly using apis is important for programmer productivity and permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may23 seoul republic of korea association for computing machinery.
acm isbn ... .
quality researchers have built various approaches that detect or check api usage rules by analyzing code or documen tation .
for instance engler et al.
mined frequent callingsequencesofmethodapisfromthecodeofoperatingsystems andrevealedabnormalapiusage.asanotherexample zhong et al.
inferred api specifications from library documentation.
although the above approaches mainly focus on api invocation sequences the careful selection of legal parameter values is alsoimportant for developers to ensure the correctness of api usage.
in the literature researchers have proposed approaches to mine api parameter rules.
for instance ernst et al.
built daikontoinferinvariantsofvariables valuesfromdynamicprofiling of program executions.
zhou et al.
detected defects in api documents using techniques of program analysis and natural language processing.
both approaches extract rules based on predefined templates.
althoughpriorstudies e.g.
polikarpova etal.
showthatthe aboveapproachesinferredusefulparameterrules manyresearch questions in this research line are still open.
for instance what types of parameter rules are there and how do those parameter rulesdistributeamongdocumentsandsourcefiles?thesequestions areimportantbecausewithoutanoverviewoftheapiparameter rules existing in libraries it is hard to tell how far we are from the fully automatic approaches that i detect constraints on api parameters ii documenttheparameterrulesreflectedbycode and iii reveal any constraint violation in the client code of libraries.
to explore these questions in this paper we conducted an extensiveempiricalstudyonparameterrules.specifically toreveal as many parameter rules as possible we took a hybrid approach bycombiningautomaticfactrevealingandmanualinspection.in particular given a library it can be very time consuming for usto manually read all code and javadoc comments to identify and summarize theparameter rules.therefore webuilt anapproach paru parameterrules to locate rule descriptions in javadoc and method apis whose source code has parameter related exceptiondeclarationsorassertstatements.althoughparucannot comprehendorinterpretanydescribedorimpliedrule itcanlocate the parameters with candidate rules for further manual inspection.
here acandidate rule is a rule sentence or a parameter related exception assertion located by paru.
inthesecondstep foreachparameterlocatedbyparu wemanually examined the rule description in javadoc or inspected the codewith relatedexceptionorassertion.
inthisway wecancomprehendthemeaningofeachlocatedcandidaterule andexplore the followingresearch questions rq1 whatisthecategorizationofapiparameterrules?
prior workshowsthatthereareconstraintsonthevalues value ranges ordatatypesofapiparameters .
however we were curious whether there is any parameter rule that does ieee acm 42nd international conference on software engineering icse icse may seoul republic of korea hao zhong1 na meng2 zexuan li1 and li jia1 notfallintotheknowncategories.thisquestionisimportant because by revealing new types of rules we may shed light on future rule extraction tools.
rq2 how do rules distribute in javadoc and code implementation?ourinvestigationforthisquestionservesmultiple purposes.forinstance ifmostrulesonlyexistincode we need newapproaches thatgenerate javadoc commentsfrom codetoautomateruledocumentation.iftherulesinjavadocandsourcecodeoftenconflictwitheachother weneednew tools to detect and resolve the contradiction.
byapplyingparuto9widelyusedsoftwarelibrariesthatcontainintotal14 392sourcefiles welocated5 334parameterswith candidaterules.basedontheseparametersandtheirrules wemade the followingmajorobservations.
there are five major categories of parameter rules with the sixthcategory i.e.
other coveringmiscellaneousrules.
we analyzed1 688rule relatedsentences whicharelocatedin either javadoc comments or the exception messages of code.
in addition to the known categories such as null value constant values and value ranges we found that .
of the studied rules constrain parameters formats e.g.
csvkeyvaluedelimiter must be exactly character while .
of rulesdescribetherelationbetweendifferentparameters e.g.
polylats and polylons must be equal length .
the miscellaneous rules count for .
of the inspected data.
in total we identified three new rule categories that were unknown.
themajorityofstudiedrulesareimplicitlyindicatedbyapi code.specifically .
of parameters have rules defined in code while10.
ofparameters rulesaredefinedinjavadoc.
theresultsimplythatdevelopersseldomdescribeparameter usage explicitly which can cause significant confusion on usersoftheapis.weonlyfound2.
oftheparametersto have consistent rules that are reflected in both javadoc and code.even fewerparameters .
haveinconsistent rules i.e.
mismatches between the document rules and code rules forthesameparameters.suchinconsistenciesareusuallynot bugs.instead therulesdescribedifferentandcomplementary constraintson the same parameters.
the rest of this paper is organized as follows.
section introducesthebackground.section3presentsoursupporttool.section4 presents our empirical study.
section interprets our findings.
section6discussthepotentialsofrelatedtools.section8introduces the related work.
section concludes this paper.
background this section defines terms related to api parameter rules section2.
andoverviews rule mining techniques section .
.
.
terminologies api parameter rules describe or reflect the constraints on parametersofapimethods.suchconstraintsareimposedbyeither software library implementation or application domains and may limit the value or format of any parameter.
rule violations can cause coding errors and jeopardize developers productivity.
in our1 ... param searcher indexsearcher to find nearest points from.
param field field name.
must not be null.
param latitude latitude at the center must be within standard coordinate bounds.
param longitude longitude at the center must be within standard coordinate bounds.
param n the number of nearest ne ighbors to ret rieve 8public static topfielddocs nearest indexsearcher searcher st ring field double latitude double longitude intn 9geoutils.checklatitude latitude 10geoutils.ch ecklongitude longitude 11if n 12throw new illegalargumentexception n must be at least got n 14if field null 15throw new illegalargumentexception field must not be null 17if searcher null 18throw new illegalargumentexception searcher must not be null .
.
.
validates latitude value is within standard coordinate bounds 21public static void checklatitude double latitude 22if double.isnan latitude latitude min lat incl latitude max lat incl 23throw new illegalargumentexception invalid latitude latitude must be between min lat incl and max lat incl a a piece of api code with rules defined in javadoc parameters searcher indexsearcher to find nearest points from.
field field name.
must not be null.latitude latitude at the center must be within standard coordinate bounds.
longitude longitude at the center must be within standard coordinate bounds.
n the number of nearest neighbors to retrieve.
b thejavadocofthe nearestmethod whichisgeneratedfromits code comments with the paramtags figure example parameter rules research we focus on the parameter rules of public apis as these apisarevisibletolibraryusersandtherulescanaffectthoseusers.
asshowninfigure1a thereisamethodapi nearest ... defined in the lucene library .
among the five parameters defined for the api one parameter is field.
according to the api implementation fieldmustnotbe null becausethecodethrows anillegalargumentexception if the parameter is null.
correspondingly the library developers described this rule in the javadoc comment enclosed by and .
in particular when the tag paramis used in the comment to declare a parameter and describe the related rule s see figure 1a a document on the parameter usage can be automatically generated when the method is publicized as a library method interface see figure 1b .
since parameter rules can be either explicitly mentioned in javadoc comments or implicitly indicated by exceptions assertions in code we defined two terms to reflect the data sources of rules.
900an empirical study on api parameter rules icse may seoul republic of korea definition .
.
adocument rule is an api parameter rule observed in api javadoc tagged with param.
definition .
.
acode rule is an api parameter rule inferred from api source code.
infigure1a fieldhasbothadocumentruleandacoderule.itis also possible that a parameter has only one kind of rule or no rule at all.
for instance the parameter searcher in figure 1a has a code rule butno document rule.
definition .
.
arule sentence is a sentence that explicitly describes constraints on a parameter.
in javadoc a document rule always corresponds to a rule sentence.
in api implementation a code rule may or may not correspond to a rule sentence.
as shown in figure 1a an exception message explicitlymentionsaparameterrule field must not be null so weconsiderthemessagestringasarulesentence.therearealso scenarioswhereaninvalidparametercantriggeranexceptionin api implementation but the exception message does not explicitly describeanyrule.forsuchcases therearecoderulesimpliedby the exceptions but there is no rule sentence in the code.
definition2.
.
rulelocalization istheprocesstoidentifyrules i.e.
document and code rules in library implementation.
definition2.
.
rulecomprehension istheprocesstointerpret the meaningof a localized rule.
definition2.
.
rule extraction mining involvesbothrulelocalizationand rulecomprehension.
inourresearch wetreatruleextractionasatwo stepprocedure.
toextractaparameterrule wefirstlocalizerulesnomatterwhether theyareintheformatofrulesentencesorexception throwing assertioncodechunks.next foreachlocalizedrule wesummarizethemeaning or semantics.
.
existing rule extraction techniques researchers explored varioustechniquesto extract api parameter rulesfrom client code api documents and or api code.
miningclientcode.
clientcodeisthesourcecodethatinvokes apis.
given a software library many approaches identify client code of the library in open source projects .
some of theapproachesthencompileandexecuteclientprojects .
they leverage dynamic analysis to collect the execution traces gather run time values of variables and further infer invariants on theexact value or value ranges of parameters.
nguyen et al.usea light weight intra procedural static analysis technique to analyze theguardconditionsinclientcodebeforeanapiisinvoked .
this approach is limited by the api parameter rules sensed by developers of client code.
mining library documents.
librarydocumentsdescribethe functionalities and usage of apis in natural languages.
existing approaches typically analyze such documents with natural language processing techniques .
these approaches usually define parsing semantic templates to locate specific natural language sentences andconvertthosesentencestomethodspecifications.fortable subject projects.
names filesmethods ex.para.
doc.
commons io pdfbox shiro itext poi jfreechart lucene asm jmonkey total instance oneofthetemplatesdefinedbypandita etal.
is subject verb object which can locate rule sentences like the path cannotbe null .
mininglibrarycode.
libraryorframeworkcodeistheimplementation of class method or field apis.existing approaches use staticanalysistoinferparameterrulesfromapisourcecode .
specifically the state of the art approach of parameter rule extractionwasintroducedbyzhou etal.
whocombineddocument analysis with code analysis.
for document analysis zhou et al.defined four parsing semantictemplates e.g.
subject equal tonull tolocatedocumentrules.meanwhile forcodeanalysis theylocated exception throwing declarations in the body of any method api m. then they related the declarations with any formal parameter defined by either mor other methods invoked by m. if a parameter p cantriggerathrownexceptioninanyprogramexecutionpath they generated coderules bysynthesizingallconstraintsonthepath s forp svalue.bycomparingthedocumentrulesandcoderulesof the same api parameters they reported defective document rules.
theapproach seffectivenessislimitedby therepresentativeness of defined rule templates and the precision of static analysis.
all above mentionedtechniques can automaticallylocalize and comprehendcertainrules.forthispaper weintendedtoidentify asmanyparameterrulesaspossibleinpopularlibraries andassess what types of parameter rules there are and how parameter rules distributeamong documents and source files.
paru in this section we first present our dataset section3.
and then introduce how paru extracts document rules section .
andcode rules section .
from source files.
section .
shows the f scores of paru.
paru focuses on rule localization instead of rule comprehension.paruborrowsideasfromcurrentruleminingtools but can locate more diverse parameter rules in a scalable way.
.
dataset table shows the nine subject libraries.
column names lists the names of libraries.
in particular asm is an analysis library for java bytecode and jmonkey is a game engine framework.
except jfreechart all the other libraries were collected from the apachefoundation these libraries were designed for purposes likeassistingiofunctionalities manipulatingdifferenttypesoffiles and performing security managements.
we selected these subjects because they are widely used in various programming contexts.
901icse may seoul republic of korea hao zhong1 na meng2 zexuan li1 and li jia1 s ee ee e t d ee ee d s s e d d a a sentence without rules d h z d ee ee d z s ee d b a rule sentence figure the dependency tree for instance a search of the keyword lucene returns more than 000projects.someoftheseprojects e.g.
itext havebeenusedin theevaluationsofthepriorrule miningapproaches .column files lists the number of java source files.
column methods liststhenumberofsuspiciousmethods.asuspiciousmethodisa public method that has either an assert throwstatement or a parameter document.
column ex.
lists the number of assert throw statementsinsidethesuspiciousmethods.column para.
liststhe numberofparametersofthesuspiciousmethods.column doc.
liststhenumber of parameters that have documents.
.
step .
identifying document rules our extraction focuses on the parameter documentation labeled with paramtags.
paru uses the stanford parser to build partof speech pos tags and dependencies among words of sentences.
figure shows the parsing results of two sentences.
the grey annotations under words denote their pos tags e.g.
nn for noun .
thearrowsbetweenwordsdenotetheirdependencies.forexample thedobjarrow in figure implies that the direct object of contain isparameters.
the nsubjarrow shows that the subject of contain isurl.moredefinitionsofsuchdependenciesareavailableinthe stanfordparsermanual .althoughthesentenceinfigure2ahas a modal verb i.e.
must it does not define any rule.
this sentence describes what a root escher container is and its relation to escher records but the sentence does not define any constraint on the containerusage.parudeterminesthatasentenceisa document rule onlyif thesentenceusesatleastonemodalverb and the modal verb does not appear in sub clauses.paru relies on the tagmdtoidentifyanymodalverbwithin must shall should can may becauseaccordingtoourobservation documentrulesusually containsuchwords.
some rule mining approaches define nlp templates to mine rules while some other approaches e.g.
a variable can benullas defined in zhou et al.
include canandmayas keywordswhenminingparameterrules.thegoalofourstudyis not to reveal the implementation flaws in existing approaches but to provide insights for follow up researchers.
to achieve this goal wetriedtorevealasmanyparameterrulesaspossible.thus wehad toconsiderwhatexistingapproacheshavedonewhendesigning paru.
when the nlp based approaches rely on parsing semantictemplatestominerules theymaymissrulesentencesthat do not match any predefined template.
thus we designed paru tousemodalverbsinsteadoftemplatestolocaterules.although canandmayarelesscompulsorythantheothermodalverbswe1public quaternion fromaxes vector3f axis 2if axis.length !
3throw new illegalargumentexception axis a rray must have three elements 5return fromaxes axis axis axis a the code of the fromaxes method lj d d lj lj d lj lj b the sdg of the fromaxes method d c a path template that indicates parameter rules figure our analysis on sdgs use becausethetwowordswerementionedbypriorwork we simplyincluded them in our modal verb set for completeness.
.
step .
extracting code rules thebasicprocessofidentifyingparametercoderules.
paru is built upon wala .
paru first scans the abstract syntax trees ast ofsourcecodetolocate throwand assertstatements.
ifamethodapiimplementationincludessuchastatement paru further buildsa system dependency graph sdg for the api definition .
.
an sdg is a graph angbracketleftv e angbracketright where v is a set of nodes corresponding to code instructions and e v vis a set of directed edges.
any edge e.g.
angbracketlefts1 s2 angbracketright e denotes a data or control dependency from s1tos2.
definition3.
.
anexception clique isansdgsubgraph that correspondsto an exception throwing statement or assertion.
toconstructansdgthatvisualizesanycontrolordatadependencieswithinjavacode walafirsttranslatessourcecodeinto its intermediate representation called ir by converting each sourcelinetooneormoreirinstructions.next walacreatesa node for each instruction and connects nodes with directed edges based on the control or data dependencies between instructions.
fortheexampleshowninfigure3 anexception throwingstatement see line in figure 3a is converted to three instructions corresponding to three nodes in an sdg see nodes circlecopyrt circlecopyrt and6 circlecopyrt in figure 3b .
we use exception clique to refer to the subgraph that consists of these three nodes and any edges in between see dashed region in figure 3b .
similarly wala translates each assert statement into three ir instructions whose nodes compose an exception clique similar to the one shown in figure 3b.
the onlydifferenceisthatanassertstatementreplaces circlecopyrtwithanodefor theassertionerror creationinstruction.todetectcoderules paru locates both types of exception cliques in sdgs.
902an empirical study on api parameter rules icse may seoul republic of korea algorithm1 findallpaths algorithm require snis a source node tnis a target node ensure pathsdenotes all the paths from sntotn nextnodes sn.successors fornextnode nextnodes do ifnextnode .equal tn andpath .isvalid then stack new stack fornode pathdo stack .add node end for paths .add stack else if nextnode nelementpathandpath .ispartialvalid then path .push nextnode fi n d a l lpa t h s nextnode to path .pop end if end for given the method implementation of a public api paru first identifiesthedeclaredparametersinthemethodheaderandlocates all exception cliques in the body.
for each located exception clique in sdg paru checks whether the clique is reachable from any parameter i.e.
whetherthereisanypaththatstartsfromaparameter declaration and goes through the exception clique.
when such a pathisfound paruconcludesthattheexceptioncliquedependson the parameter and there is an implicit constraint on the parameter value.figure3cshowsanexemplarpaththatparucanfind.the path starts with the declaration of parameter n goes through an if condition that checks the parameter value range and ends with an exception clique that prints n in the error message.
algorithm1showsthedetailsofsearchingforallthevalidpaths from a given source node to a target node.
before adding a path to thesetofvalidpaths paruchecksthepathatline3.however ifit only checks the path at line it has to search many invalid paths betweenline10andline12.aseachstatementissplitintomultiple nodes in an sdg sdgs can become quite large if a method is long.
toreducethesearcheffort weaddanotherchecktoline9.atthis line itisinfeasibletofullydeterminewhetherapathisvalid but we can remove many invalid paths.
for example if we find that an if conditionhasnodatadependencyonanyparameter wecanstop the exploration of its successors.
as a path is incomplete at line atthispoint paruconcludesthatapathisinvalidiftheincomplete path is not a prefix of a valid path.
as shown in figure 1a code rules can have rule sentences.
after a valid path is extracted paru further extracts rule sentences from the thrown message and such sentencesare later manually analyzed sections .
.
and .
.
.
slicing.algorithm is less effective to find valid paths if a graphisquite large.
forexample when searchingfor all thevalid paths from circlecopyrtto4 6in figure 3b algorithm will explore the paths such as circlecopyrt circlecopyrtand1 circlecopyrt circlecopyrt.
when an sdg is large the explorationistime consuming.weiser proposedtheconcept ofprogramslicing.givenaprogramlocation landavariable v the backward slicing intends to find all the statements of the programtable the precision recall and f score of paru.
name precision recall f score commons io .
.
.
pdfbox .
.
.
shiro .
.
.
itext .
.
.
poi .
.
.
jfreechart .
.
.
lucene .
.
.
asm .
.
.
jmonkey .
.
.
thatcanaffectthevalueof vatl.foreachexceptionclique paru locatesthebackward slicebeforeitsearchesforall validpaths in order to save the search effort.
in particular wala has a program slicer .givenastatementand ansdg theslicerfindsallthe statements that appear in the backward slice of the statement.
for eachslice parubuildsasmallersdgthatcontainsonlynodesof theslice.aftersdgsaresliced forfigure3b algorithm1doesnot explore7 circlecopyrtor8 circlecopyrt since they do not appear in the sliced sdg.
.
the f scores of paru we werecurious how effectivelyparucan locate parameter rules so we constructed a ground truth data set of parameter rules for some java files and applied paru to those files to automatically locaterules.bycomparingparu sreportsagainstourgroundtruth we assessed the precision recall and f score of paru.
thesetting.
the third and the fourth authors are two phd studentsincomputerscience whohavemorethanthreeyearsofjavacoding experience.
to construct the ground truth data set for paru evaluation thetwostudentsread sourcefilesintable1 andtried their best to manually recognize parameter rules in those files.
as thesestudentsdidnotreadorwriteanysourcecodeforparu so theyhavenobiastowardsparuwhenbuildingthedataset.such settingensures the objectiveness of paruevaluation.
although some prior approaches mine parameter rules fromdatasourcesotherthansourcefiles e.g.
executionprofiles we believe our ground truth of parameter rules is reasonably good for two reasons.
first as illustrated in figure api documents are automaticallygeneratedfromthejavadoccommentsincode sothe rulesdescribedorimpliedbysourcefilescanalwayscoverthose rules inapi documentation.second inhigh quality software the source files usually define or validate constraints on parameters before using those parameters.
it is meaningful to rely on software implementation to distill parameter rules.
thus we decided to manuallyinspectsourcecodeonly insteadofalsoexaminingother informationresources simultaneously.
specifically the two students manually analyzed randomly selectedsourcefilesineachproject.foreachparameter pofmethod apim thestudentsreadthedocumentandimplementationof mto decide whether phas any document or code rule.
since the value p may be tested by code inside mor any method called by or calling m the students examined mtogetherwith methods that have any caller callee relationship with mto infer code rules.
after the manualinspection inourgroupmeeting thestudentsdiscussedtheir results to reach a consensus.
in total the two students manually 903icse may seoul republic of korea hao zhong1 na meng2 zexuan li1 and li jia1 table top ten verbs.
commons io pdfbox shiro itext poi jfreechart lucene asm jmonkey be be be be be be be be be compared include contain retrieved exceed used have have enforced used use have react have used loaded match have represented reuse supplied delegate contain use used create registered aligned contain updated add called compressed retained contain belong have change store filled failed defined null submitted contain create match write point examined fit used supplied use contain fall support queried opened havel add process updated assigned contain retained use override match match sorted contain identified documented rules and code rules which were used as the gold standard.
for the source files we appliedparutolocateanydocumentorcoderule.wethencompared thelocated rulesagainst thegold standardto calculateprecisions recalls and f scores forparu.
results.table shows the evaluation results.
for out of the projects paruacquiredf scoreshigherthan90 .bothprecision andrecallratesaregenerallyhigh i.e.
.
.
precisionand .
recall .therecallsof paruarenot100 becausesome rules can only be manually identified in nonstandard ways but are very challenging to be located by any automated tool.
for instance aparameterruleissometimesdescribedbycommentsofthewhole method but not by the javadoc comment of that parameter.
as apache projects follow strict regulations based on our evaluation resultsshownintable3 thenonstandardscenariosarerare and paruhasdetectedmostparameterrules.ourresultsimplythattherules reported by paru are very likely to be representative and we can rely on these rules to build a taxonomy of parameter rules.
empirical study with paru we conducted an empirical study to explore our research questions listed in section .
we used paru to extract parameter rules from the dataset in section .
.
in the files from real projects paru identified in total parameters to haverules.fromtheseparameterswithrules paruextracted1 rule sentences that are described in either javadoc comments or exception assertionmessages.
thereare only187 parametersthat have both document rules and code rules.
wemanuallyexaminedthe1 688rulesentencesandrulesrelated to the above mentioned parameters.
the manual inspectionprocedure took several weeks.
this section presents our manual analysisprotocolsandinvestigationfindings.moredetailsofour results and the gold standards are listed on our project website .
rq1.
rule categorization .
.
protocol.
toexplorerq1 wemanuallyclassifiedallthe1 rulesentences.here ifaparameterruleisextractedwithnorule sentence identified e.g.
an exception thrown with the empty messagebody we do not inspectthe rule becauseit is tooexpensive to understand a parameter solely based on source code.
we first classified rule sentences by the verbs which follow the extractedmodalverbs.althoughtheresultrevealshowprogrammerswrite rulesentences werealizedthattheverbsdonotpresentanaccurate classification.
to handle the problem we manually read all rule sentences and classified them based on the semantics.
during the manual inspection the first and the third authors prepared the initial inspection results.
the other authors checked the results until they came to an agreement on all the results.
.
.
result.
table shows the top ten verbs.
our result shows that developers use limited verbs to define parameter rules.
the commons io projectevendoesnothavetenverbs.inthistable we highlightverbsthatappearinmorethanhalfoftheprojects.according to this definition only four verbs are commonly used be contain have and use .
it seems that library developers exploited certain verbs much more frequently than other verbs when definingparameterrules soitisinfeasibletodistinguishparameter rules only based on verbs.
instead table shows the results of manualinspection.intotal weidentifiedsixtypesofrulesentences c1.null.
thiscategoryisaboutwhetheraparameterisallowedor disallowedtobe null.forinstance thecodeinfigure1ashowsthat anexceptionisthrownifthe fieldparameteris null therelated rulesentenceis mustnotbenull.
additionally the formatcellvalue method of poihas a document rule the cell can be null .
c1 correspondstotwocategoriesdefinedbyzhou etal.
including nullnessallowed and nullness not allowed .
c2.
range .thiscategoryfocusesonthelegalrangesofparametervalues.
whendefiningranges a rulesentence candefineboth maximum and minimum values such as latitude value must be within standard coordinate bounds.
meanwhile a rule sentence can alsodefineonly the minimumor maximum such as maxmergecount should be at least .
.
c2 corresponds to the range limitation category of zhou et al.
.
c3.
value.
this category is about legal values of parameters.
for example a rule sentence goes for string type missingvalue must be either string first or string last.
the existing approach daikon monitors program execution status at runtime collects values of variables and infers value invariants accordingly.
therefore it is likely that daikon can identify rules of c1 c3.
c4.
format.
thiscategoryfocusesontheformatsofparameters.
an exemplar rule sentence is csvkeyvaluedelimiter must be exactly character.
zhou et al.
defined a type restriction categorytodescribetyperequirementsonparameters suchas value 904an empirical study on api parameter rules icse may seoul republic of korea table rule sentences name nullrange valueformat relation others commons io pdfbox shiro itext poi jfreechart lucene asm jmonkey total .
.
.
.
.
.
ofkeymustbeanboolean.
generallyspeaking typerestrictions are about formats of parameters so we map this type restriction category to c4.
however the scope of c4 is broader.
more samples are as below.
xmpshould end witha processing instruction.
sheetnamesmustnot begin or end with .
uidmust be byte .
the movefrom must be a valid array index.
value data sourcemustbe numeric.
thelengthofthedatafora exobjlistatom mustbeatleast4 bytes.
since format related rule sentences have diversified descriptions it seems to be very challenging to define one or more templates to matchall thosesentencesforautomaticrulecomprehension.
c5.relation.
thiscategoryisaboutrelationsbetweenparameters.
for example a rule sentence defines the lengths of two parameters as polylats and polylons must be equal length.
more samples are shown below originand regionmustboth be arrays of length .
usereditatom and persistptrholder mustexistandtheiroffsetneed to match.
index of last row inclusive must be equal to or larger than firstrow.
maxitemsinblock must be at least minitemsinblock .
upper value s type should be the same as numericconfig type.
the number of values of ablock must be equal to theblock size of the blockpackedwriter which has been used to write the stream.
c6.
other.
this category includes miscellaneous rules that do not belongtoanyoftheabove mentionedcategories.
forexample arule sentence defines the synonyms of parameters synonyms must be across the samefield.
more samples are as follows afilename toviewmustbesuppliedasthefirstargument but nonewasgiven.
rc4must notbe used with agile encryption.
splinestartmustbe preceded by another type.
features must be present for textlogitstream .
this must be well formed unicode text with no unpaired surrogates.table rule sentences from thrown messages.
name nullrange valueformat relation other commons io pdfbox shiro itext poi jfreechart lucene asm jmonkey total .
.
.
.
.
.
input automaton mustbe deterministic.
amongtheabovecategories c5andc6aresolelydetectedby paru.
it is more challenging to define templates of c5 and c6 than thoseofotherrules.thetemplatesoftheothercategoriestypically define usages of single variables but the templates of c5 defineusages of multiple variables.
the prior approaches e.g.
ernst et al.
reply on frequencies to mine parameter rules but the supports of c6 are too low to be mined.
table presents the distribution of rule sentences among our six categories.
these sentences are from either javadoc or code.
the rule categories in our taxonomy are mutually exclusive.
if a parameterhasmultiplerulesentences eachsentenceisanalyzed andclassifiedindependently.accordingtothistable c1 null is thedominantrulecategoryinprojects commons io shiro and itext.
c3 value is the dominant category in project asm.
c4 format dominates the sentences in projects pdfbox poi and jmonkey.i n total the three categories null range and value account for .
of rule sentences.
finding .
in total .
of rule sentences define simple rules suchas nullvalues rangelimits and legal values.
we were also curious what types of parameter rules are usually enforced in code so we reorganized our manual analysis resultsand constructed table to illustrate the rule distribution among code of different projects.
overall the rule distributions shown in table are similar to those shown in table .
for instance the top threecategoriesintable5includec1 c2 andc4 whichcategories separately count for .
.
and .
of the rules in thrown messages.meanwhile thetopthreecategoriesintable4arealsoc1 c2 andc4 buttheirpercentagesareslightlydifferent .
.
and .
.
interestingly c3 takes up only .
of the sentences in thrownmessages butcountsfor9.
ofallinspectedrulesentences.
this discrepancy indicates that developers usually document more valuerulesbutenforcefewervaluerulesincode probablybecause itistediousanderror pronefordeveloperstoenumerateall il legal values of a parameter for checking.
inbothtables c3 c5 andc6havemuchfewerrulesthanthe other three categories.
it is tedious and time consuming for developerstowritecodeandenforcecertainrules e.g.
c6 .forinstance asshowninfigure6a thestringsmustbeorderedastheyappear inthedirectoryhierarchyofthedocument... .thisrulesentence belongs to c6 and it specifies a particular ordering of strings in the 905icse may seoul republic of korea hao zhong1 na meng2 zexuan li1 and li jia1 ... param firstsheetindex the scope must be 2f o ra d d in