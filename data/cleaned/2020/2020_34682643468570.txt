estimating residualrisk in greybox fuzzing marcel b hme monash university australia mpi sp germanydanushkaliyanage monash university australiavalentin w stholz consensys germany abstract foranyerrorlessfuzzingcampaign nomatterhowlong thereis alwayssomeresidualriskthatasoftwareerrorwouldbediscovered ifonlythecampaignwasrunforjustabitlonger.recently greybox fuzzingtoolshavefoundwidespreadadoption.yet practitionerscan onlyguesswhentheresidualriskofagreyboxfuzzingcampaign falls belowaspecific maximum allowable threshold.
in this paper we explain why residual risk cannot be directly estimated for greybox campaigns arguethat the discovery probability i.e.
theprobabilitythatthenextgeneratedinputincreases code coverage provides an excellent upper bound and explore soundstatisticalmethodsto estimatethe discoveryprobability in anongoinggreyboxcampaign.wefindthatestimatorsforblackbox fuzzing systematically and substantially under estimate the true risk.anengineer whostopsthecampaignwhentheestimators purport a risk below the maximum allowable risk is vastly misled.
she might need execute a campaign that is orders of magnitude longertoachievetheallowablerisk.hence the keychallenge we address in this paper is adaptive bias the probability to discover a specificerroractuallyincreasesovertime.weprovidethefirstprobabilistic analysisof adaptive bias andintroduce two novel classes of estimators that tackle adaptive bias.
with our estimators the engineer can decidewithconfidence when to abort the campaign.
ccs concepts securityandprivacy softwareandapplicationsecurity softwareanditsengineering softwaretestinganddebugging.
keywords software testing statistics estimation assurance correctness acmreference format marcel b hme danushka liyanage and valentin w stholz.
.
estimating residual risk in greybox fuzzing.
in proceedings of the 29th acm joint europeansoftwareengineeringconferenceandsymposiumonthefoundations of software engineering esec fse august 23 28 athens greece.acm newyork ny usa 12pages.
introduction on the one hand we have software verification which allows to demonstratethecorrectnessoftheprogramfor allinputs.onthe otherhand wehavesoftwaretestingwhichcandemonstratethe esec fse august 23 28 athens greece copyright heldby the owner author s .
acm isbn .
greybox number of generated test inputs n probability factor discovery probability bug probability figure1 ingreyboxfuzzing theprobability pbugtogenerate a bug revealing input dashed line increases asnincreases.
the probability n that the n th input is coverageincreasing solidline providesanupperboundontheprobability residual risk that it is the firstbug revealing input.
the vertical line iswhenwe expect the firstbug rev.input.
correctness of the program only for some inputs .
while verificationprovidesmuchstrongercorrectnessguarantees itis greybox fuzzing a specific form of software testing which has found widespread adoption inindustry .
from a fuzzing campaign that has found no bugs can we derive some statement about the correctness of the program?
fuzzing beingarandomprocess itshouldbepossibletoderivestatistical claims about the probability that the next generated input is the firstbug revealinginput.wecallthisprobabilitythe residualrisk .
weknowhowtoquantifyresidualriskforwhiteboxfuzzing using modelcounting andblackboxfuzzing usingestimation but not for greybox fuzzing which has emerged as the state ofthe artinautomatedvulnerabilitydiscovery.
greyboxfuzzingissubjectto adaptivebias i.e.
theprobability to generatea bug revealing inputactually increases throughoutthe fuzzingcampaign.1figure1showssimulationresultsforgreybox fuzzing.
as more seeds become available the bug probability pbug increased dashed line .
in contrast blackbox fuzzing is notsubject to adaptive bias and the probability to generate a bug revealing inputremainsconstantthroughoutthecampaign.ifthiswasthe casefor greybox fuzzing we could castresidualrisk estimation as asunriseproblem2andemploythewell knownlaplaceestimator.
however in our experiments we find that in the presence of adaptivebias thelaplaceestimatorseverely under estimatetheresidual riskforgreyboxcampaigns.thetrueriskisordersofmagnitude higher than the estimator purports.
a practitioner would abort the campaignmanydaysearlierthannecessary andassumeahigher degree ofconfidence inthe correctness thanwarranted.
1we mean the probability pbugto generate anybug revealing input not just the first.
2thesunrise problem is the following riddle suppose we have seen the sun rise ever sincewewereborn ndays ago.whatistheprobabilitythatthesunrisestomorrow?
this work is licensed under a creative commons attribution .
international license.
esec fse august athens greece marcelb hme danushkaliyanage andvalentin w stholz totackleadaptivebiasingreyboxfuzzing wefirstproposeto estimatean upperbound onresidualrisk calleddiscoveryprobability.let sstartwiththemodel.suppose wearedrawing nballs withreplacementfromanurncontainingcoloredballs.eachball representsageneratedinput.theball scolorrepresents e.g.
the executed program path i.e.
whatever we wish to measure the coverage of .
without loss of generality we assign the color blackto balls representing bug revealing inputs.
discovery probability n is the probability that the n th ball we draw has a color we have previouslynotobserved.
residual risk is theprobabilitythat the n thballwedrawis black.weargue aslongaswehave not seen any blackballsafter drawing nballs with replacement theprobabilitytodrawaballwithanarbitraryunobservedcolor provides an upper bound on the probability to draw a ball with the colorblack.
inthispaper weextendtheprobabilisticframeworkforblackbox fuzzing toincorporateconceptsfromgreyboxfuzzing andprobabilistically analyze the functional behavior of residual risk and adaptivebias.wedefine adaptivebias asthedifferenceindiscovery probabilitybetweengrey andblackboxcampaignsofequivalent length startedwiththesamecorpusandformallyshowthat under realistic assumptions adaptive biasreduces with campaign length.
we proposeand study three general approachestotackle adaptive bias during estimation in greybox fuzzing i reset estimation ii meanlocalestimation and iii extrapolation.
resetestimation arisesfromtheobservationthatagreyboxcampaigncanbe modelled as a sequence of blackbox campaigns each started when a newseedisaddedtothe corpus.insteadoftheentire campaign an a resetestimatorisappliedtothepartialcampaignstartedbefore theamostrecentlyaddedseeds.however inourexperiments reset estimators systematically overestimate and exhibit a high variance.
meanlocalestimation ismotivatedbytheobservationthatthe numberoftimesaseedhasbeenfuzzedinthepastandtheprobability to be selected next is entirely disconnected.
for instance old seeds will have been fuzzed much more than new seeds but arelesslikelyusedtogeneratethenextinput.hence meanlocal estimatorsaredefinedasweightedcombinationsofseed specific localestimates.inourexperiments wefindthatthoseperformbest withlowbiasandvariance.
extrapolation ismotivatedbyourobservationfromsimulation andempiricalresultsthatdiscoveryprobabilityfollowsapowerlaw.
inourexperiments wefindthat atthecostofmeasuringground truth discoveryprobabilitycanbeextrapolatedbyseveralorders ofmagnitude withhigh accuracy.
in summary the paper makesthe following contributions.
novelclass ofestimators that account for adaptive bias.
empirical investigation of estimator performance of existingandnewestimators ofdiscovery probability.
probabilisticanalysis ofadaptivebiasingreyboxfuzzing.
empirical andsimulation study of the functional behavior ofdiscovery probability as more inputsare generated.
extension of stads to accommodate greybox concepts such as currentcorpus and currentglobal distribution.
all data scripts are publiclyavailable motivating example whydoestheprobabilitytogenerateabug revealinginputincrease for greybox fuzzing but not for blackbox fuzzing?
let us explore this questionfor aconcrete example.
1voidcrashme char s 2if strlen s !
return 3if s b if s a if s d if s !
abort listing this program crashesfor bad!
.takenfrom .
listing1 showsaprogramthatcrashesforinput bad!
when the input executes the abortstatement in line .
our task is to generateinputsfor crashme someofwhichwouldexposethisbug.
blackbox fuzzer .
suppose we have a blackbox fuzzer that randomlygeneratesstrings char oflengthfour e.g.
r .inc charis one byte and can have one of values.
there are 4billiondifferent strings oflength four thatour blackbox fuzzercan generate.onlyone of thosewouldexpose the bug.
thus for our blackbox fuzzer the probability pbugtogenerate a bug revealing input is roughly one in four billion throughout the entire fuzzingcampaign.
greyboxfuzzer .suppose ourgreyboxfuzzergeneratesthefirst seed using the blackbox fuzzer.
assume that our greybox fuzzer has the following mutation operator given a seed choose an arbitrary character uniformly at random and substitute it with another character chosenuniformly at random.
table expected inputs to generate the next coverageincreasing seed to given the currentcorpus.
seeds from toexpected inputs required ?
???b???
2b???ba??
3ba??bad?
4bad?bad!
total inputs table 1illustrates how adding coverage increasing inputs to the seedcorpusgraduallyincreasestheprobability pbugtogeneratethe bug revealinginput.ourgreyboxfuzzerusesourblackboxfuzzer to generate the first seed ?
???
where?denotes a placeholder for an arbitrary character.
as we know the probability that this initial seed exposes the bug is one in four billion.
for simplicity wewillassumetheinitialseeddoesnotstartwitha b .thenext coverage increasing input b??
?is generated with probability1 to choosethe first character multiplied by1 256tochoose basthe first character i.e.
one in .
once this new seed is added to the corpus supposewechoosethenextseedfromthecorpusuniformly atrandom.so thenextcoverage increasinginput ba?
?isgenerated withprobability i.e.
onein2048.weproceedaccordingly until the bugisfound.
231estimatingresidualrisk in greyboxfuzzing esec fse august athens greece for a greybox fuzzer starting from an arbitrary initial seed and given the mutation operators the probability pbugto generate aninputthatexposes the bugincreasesfromoneinfour billion forthefirstgeneratedinputtooneinfour thousand forthefinal corpus because newseedsareaddedthroughoutthecampaign.
in expectation we only needaboutten thousand inputs total.
residual risk is the probability that the n st generated inputis the firstbug revealinginput i.e.
anewbugis discovered.
forour blackboxfuzzer theprobability pbugto generate anybugrevealing input remains constant while generating ninputs.
the residual risk decreases monotonically with n i.e.
pbug pbug n. forourgreyboxfuzzer as pbugincreases theresidualriskmayalso increasewhen newseedsare addedbefore itdecreasesagain.
discoveryprobability istheprobabilitythatthe n stgenerated input increases coverage.
suppose our fuzzer generates inputs that exercises the five paths in lines 3 7 of listing with probabilities p1 p2 p3 p4 p5 respectively.3forourblackboxfuzzer the discovery probability is summationtext.
i 1pi pi n.forourgreybox fuzzer aspimay vary the discovery probability may increase when new seeds are added before it decreases again.
this difference between black andgreybox isthe sourceofadaptive bias.
adaptivebias isthedifferencebetweenindiscoveryprobability betweengrey andblackboxcampaignsofequivalentlength started withthe same corpus.
probabilistic analysis .
background wepresentmoreformallythesameurnmodelfromtheintroduction usingthespeciesdiscoverymodel .letpbetheprogramthat wewishtofuzz.werefertothesetofallinputsthat pcanconsume asp sinputspace ddd.fuzzingprogram pisastochasticprocess f xn xn ddd n n ofsampling ninputswithreplacement fromtheprogram sinput space.
we call fafuzzingcampaign and a toolthatperforms fa non deterministic blackbox fuzzer .
suppose we can divide the search space dddintosindividual subdomains di s i 1calledspecies .aninput xn fissaidto discoverspeciesdiifxn diandtheredoesnotexistapreviously sampled input xm fsuch that m nandxm di i.e.
diis sampled forthe first time .
an input s species are defined based on behaviorobservedwhen executingtheinput .forinstance abranch that is exercised by input xn dddcan be seen as a species.
the discoveryofnewspeciesthencorrespondstoanincreaseinbranch coverage.
globalspecies distribution .weletpibetheprobabilitythat then th generatedinput xnbelongs to species di pi p fori i sandn n n. we call pi s i 1the fuzzer sglobal species distribution .
the expected number of discoveredspecies s n canbederivedasthecomplementoftheprobabilitythataspecies diremainsundiscoveredaftergenerating n 3note that p5 pbugin this example.
in general pbugdoes not need to correspond to a path branch orstatement in a program.formoredetails see section3.
.test inputs summedover allspecies.
s n s summationdisplay.
i bracketleftbig pi n bracketrightbig s s summationdisplay.
i pi n. wecanshowthatthenumberofspecies sthatthefuzzerdiscovers inthe limit i.e.
the asymptotic totalnumber ofspecies isgiven as s limn s n .
mutation based fuzzing .
in a mutation based fuzzing campaign new inputs are generated by mutating existing inputs socalled seeds.
in addition to the global species distribution this suggeststheexistenceofalocalspeciesdistributionforeachseed .letcbeasetofseedinputs calledtheseedcorpusand qtbe theprobabilitythatthefuzzerchoosestomutatetheseed t c. foreachseed t letdddtbethesetofallinputsthatcanbegenerated by applying the available mutation operators to t. mutation based fuzzingof tisastochasticprocess ft braceleftbig xt n xt n dddt bracerightbignt n of sampling ntinputswith replacement by random mutation of theseedt.notethat ft fwherefisamutation basedfuzzing campaign and tis a member of a corpus cof seeds.
we call all speciesthatcanbefoundbyfuzzingaseed tasthespeciesin t s neighborhood .
local species distribution .
we letpt ibe the probability that then thinput xtnwhichisgeneratedbymutatingtheseed t c belongs to species di pt i p xt n di fori i sandn n n.wecall pt i s i 1thelocalspecies distribution in the neighborhood of the seed t. note that global and local distributions bythe law of total expectation are relatedas pi summationdisplay.
t cqt pt i. fori i swhere selection probability qtis the probability thatt cis chosen for fuzzing.
hence thenumberofspecies discovered over time for a mutation based blackbox fuzzer according to equation isgiven by s n s summationdisplay.
i bracketleftbigg parenleftbigg summationdisplay.
t cqt pt i parenrightbiggn bracketrightbigg .
assumptions .forourprobabilisticmodel werequirethatglobal andlocalspeciesdistributionsare invariant throughoutthefuzzing campaign.
a contribution of the present work is to relax this assumptionforgreyboxcampaigns cf.
section3.
.sofar werequire pi p p and pt i p xt n di p xt n di fori i sandn n n whereqtis the probability that the fuzzer chooses the seed t c wherexnandxn 1are then th and n thgeneratedtestinputs respectively andwhere xtnand xt n 1arethen thand n thtestinputsgeneratedbyfuzzingthe seedt respectively.
4thisselectionprobabilityisalso known as the seed s energyorweight.
232esec fse august athens greece marcelb hme danushkaliyanage andvalentin w stholz this holds if for any program input d din the program s input space we have that p p i.e.
the probability to generate some input dis invariant throughout the campaign.ourmodelaccommodatesthatablackboxfuzzermay generateinputsfromanon uniformdistribution i.e.
foranytwo inputsd1 d2 d it is entirely possible that the probability that then thtestinputis d1ord2differs i.e.
p p .
for random testing tools and for generation or mutation based blackboxfuzzersthatgenerateinputsbysomerandomprocessitis realistictoassumethattheprobabilitytosamplefromasubdomain di ddddoesnotchange during the fuzzing campaign.
after all withoutdynamic programfeedback anon deterministicblackbox fuzzer hasno reasontovaryitsfuzzing heuristics duringthe campaign.amutation basedblackboxfuzzerusuallyhasafixed size seedcorpus candfixed sizesetofmutation operators.
otherwise wemake noassumptions aboutthenumber s relative abundance pi s i or distribution of species in the fuzzer s searchspace.specifically thereisnoassumptionthatspeciesare distributed equally.
some rare species i.e.
piis very small may well be clusteredwithin asmall regionofthe inputspace.
.
residualrisk anddiscoveryprobability wedefinethe residualrisk ofanongoingfuzzingcampaignoflength nastheprobabilitythatthe n thgeneratedtestinputdiscovers a bug.
given a set of species without loss of generality we remove allbug revealinginputs andaddthemtoanew dedicatedspecies d .inthiscontext residualriskistheprobabilitythatthe n th generatedinputbelongs to d .
figure1showsasimulationof30greyboxcampaignsonasubject with 50species including arare bug revealing species.to ensure our simulation is realistic we extended the publicly available simulationscriptthatwasusedtoexplaintheempiricalresultsonthe exponentialcostofvulnerabilitydiscovery .inthesimulation we sample nballs from an urn where each ball has one of s colors.eachcolorrepresentsaspecieswhilethecolor blackisdedicated to the bug revealing species.
to simulate greybox fuzzing wheneveraballissampledthatbelongstoapreviouslyunobserved color theprobability piforfuturesamplestohaveoneofthe neighboring colors dislightlyincreases.theresultingdistributionis normalized such that summationtext.1s i 1pi .
the residual risk is the expected probabilitythatthe n thballis blackasnincreases.werepeat thissimulation30timesandshowindividualandaveragevalues triangles andlines resp.
.
in greybox fuzzing theprobability to generate a bug revealing input actually increases over time.
however without any evidence about the presence of the bug there is no way that we can account for this increase in our missing mass estimation.
we investigate this adaptive biasin section .
.
to overcome this challenge we propose to estimate discovery probability asanupperbound ontheresidualrisk.likeresidualrisk discoveryprobabilityissubjecttoadaptivebias.however unlike residual risk we can empirically measure the discovery probability in an ongoing fuzzing campaign.
while the residual risk measures the probability that the n th ball is black which we have not observed thediscovery probability measures theprobability that the n thballhasanarbitrarycolorwhichwehavenotobserved includingthe color black cf.fig.1top curve .
number of generated test inputs n discovery prob.
delta n fuzzer blackbox greybox number of generated test inputs n species coverage s n sfuzzer blackbox greybox figure2 discoveryprobability n top andproportionof discoveredspecies s n s bottom asthenumber nofgenerated test inputs increases log log scale .
grey triangles are values for individual campaigns while lines show average values.
simulation of greybox and blackbox campaigns oflength n 50k .
we definethe discovery probability n as the probability that test input xn fdiscovers a new species which is derived as thedifference inthe expected number ofdiscovered species when nandn 1test inputshave been generated n s n s n s summationdisplay.
i 1pi pi n powerlaw .figure .top illustrates the general behavior of discovery probability.5discovery probability n appears to be scale invariant one order of magnitude more test inputs reduce the discovery probability by roughly one order of magnitude a property that holds over the entire campaign.
in fact in the log log plot discoveryprobabilityforbothblack andgreyboxcampaignsappear almostlikestraightlines.scaleinvarianceisawell knownattribute ofpowerlaw relationshipswhereaquantity f x variesasapower of another quantity x i.e.
f x ax k whereaandkare two non negative fixed parameters.
extrapolation .toleveragethepowerlawrelationship atthe beginning of a campaign we could measure the true discovery probability6in exponentially increasing intervals and employ a linear regression on the logarithm of discovery probability and number of generated tests to extrapolatediscoveryprobability by several ordersof magnitude.indeed a linearregression of log n log n yieldsaveryhighgoodness of fit .concretely inblackandgreyboxcampaigns respectively onaverage r2 andr2 5for now we ask the reader to focus on the greybox line.
we discuss adaptive bias as the differencebetween blackboxand greyboxfuzzing in section3.
.
6note that measuring discovery probability as opposed to estimating it incurs a cost that isprohibitivefor reasonably large n cf.section5.
233estimatingresidualrisk in greyboxfuzzing esec fse august athens greece .
.
.
.
.
.
.
number of generated test inputs n adaptive bias gb bb adaptive bias log10 gb log10 bb figure adaptive bias on a log x scale top g n b n bottom log10 g n log10 b n where gand barediscovery probabilities for greybox and blackbox campaigns resp.
.asdiscoveryprobabilitiesspanseveralordersofmagnitude thebottomshowsdifferenceinmagnitude.
ofthevariancefoundintheresponsevariable log n can beexplainedbythepredictorvariable log n .weinvestigatethis approachempiricallyin section6.
forastate of the artgreybox fuzzer and the results confirm our observation median r2 .
.
adaptivebias residual risk and discovery probability are subject to adaptive bias.
suppose ourfuzzercanberunintwomodes a greyboxmode anda blackbox mode .
the only difference between the two modes is that in a greybox campaign fg the fuzzer adds a generated input to theseedcorpus ifit discoversanewspecies while inablackbox campaign fb thefuzzeralwaysmaintainstheinitialseedcorpus.
all other fuzzer properties such as the initial corpus the set of mutationoperators orthepowerschedule areequalinbothmodes.
informally wecandefine adaptivebias asthedifferenceindiscoveryprobabilitybetweengrey andblackboxcampaignsofequivalent length started from the same corpus.
figure 2illustrates the impactofadaptivebiasonthediscoveryprobabilityinagreybox campaignwithin our simulation study.
duetoadaptivebias thediscoveryprobabilityisconsistently higher in the greybox campaign than the blackbox campaign untilshortlybefore ofspecies are discovered fig.
.
weextendthestadsprobabilisticmodel toaccommodate greyboxfuzzingandadaptivebias.let cnbethecurrentseedcorpusafter exactly ntest inputs have been generated in a greybox campaign fg x1 ... xn ... xn .concretely cn xm xm fg disc xm fg m n wheredisc xm fg holds if there exists a species difori i s such that generated input xm diand there does notexist apreviouslygeneratedinput xl fgsuchthat l mandxl di.adaptive bias emerges in greybox campaigns as seeds are added toacorpus.supposewithoutlossofgeneralitythatthe n th generatedinputdiscoversanewspecies thus cn cn .evenif thediscoveryprobabilities g n and b n ofgrey andblackbox campaigns respectively were the same when ntest inputs have been generated i.e.
g n b n we generally have g n b n because of the impact of the added seed s local species distribution on the global distribution cf.
equation .
current distribution pi n. to quantify the impact of adding seeds on the global species distribution we use kullback leibler kl divergence asameasureofdistancebetweentwodistributions.
for a greybox campaign let pi n s i 1be thecurrent global speciesdistribution whenntest inputshave been generated i.e.
pi n summationdisplay.
t cnqtpt i fori i s whereqtit the probability that the fuzzer chooses to mutatethe seed t cn.
adaptive bias reduces .
under a realistic assumption we show that the distance between the species distributions beforeand aftertheseedwasaddedreducesasthenumber nofgeneratedtest inputs increases.
our assumption is that the probability qt that thefuzzerchoosestomutatethemostrecentlyaddedseed t also reduces as the seed corpus grows where t cn 1butt cn.
this assumption holds for all known power schedules in the most popular greybox fuzzers libfuzzer andafl .
the kl divergence from the global species distribution pi n beforeaddingtheseed t tothedistribution pi n afteraddingt is ameasure ofdistance between both distributions d pi n pi n s summationdisplay.
i 1pi n 1log parenleftbiggpi n pi n parenrightbigg weobservethattheglobaldistribution pi n s i 1aftert was addediscomposedofthepreviousglobaldistribution pi n s i 1and the local distribution pt i s i 1of the newseed t pi n qt pi n qt pt i fori i s such that d pi n pi n s summationdisplay.
i 1pi n 1log parenleftbig1 qt ci n t parenrightbig whereqt istheprobabilitythatthefuzzerchoosestomutatethe mostrecently addedseed t andci n t pt i pi n .
recalling that log and assuming that pi n for all i i s we can see that lim qt 0d pi n pi n kl divergence dapproacheszeroas qt approacheszero.
ourestimatorsofdiscovery probability discoveryprobability istheprobabilitythatthenextgenerated input discovers a new species.
in section .
we discussed how discovery probability provides an upper bound on the residual risk.
in our evaluation we consider a good estimator to be conservative 234esec fse august athens greece marcelb hme danushkaliyanage andvalentin w stholz andaccurate.seekinganupperboundontheresidualrisk a conservative estimatormightsystematicallyoverestimaterisk butitcan never systematically underestimate.
an accurateestimator has a lowmeanbias i.e.
theaveragedifferencebetweentheestimateand thetruevalueislow andithasalowvariance i.e.
theindividual estimates are usually quiteclose to the averageestimate.
unfortunately the maximum likelihood estimator of residual risk i.e.
the proportion of vulnerability exposing inputs is neither conservative nor accurate.
it would always estimate a zero residual risk.
however in the absence of evidence for the existence of a vulnerability wecannotassigntheentireprobabilitymasstothe oneobservedevent i.e.
novulnerability .hence theproblemof estimatingtheprobabilityofaneventthathasnotbeenobserved is also known as estimating the missing mass .
in the following we recallandpropose someestimators ofthe missingmass.
.
laplace estimator the well known laplace estimator distributes some probability massacrossunobservedeventsbycountingeveryunobservedevent asobservedexactlyonce.pierre simonlaplacewasinterestedin solving the sunrise problem based on prior knowledge that the sun has risen nconsecutive days up to and including today what is the probabilitythatthesunwillrisetomorrow?inwhatwouldbecome thefoundationsofbayesianstatistics laplacedevelopedtherule ofsuccession.
letx ... x nbeasequenceofindependentbernoullirandom variables where x i if thei th trial is considered a success .
if s outofntrialsweresuccesses thenthe ruleofsuccession providesan estimator s n oftheprobability p x n x ... x n s that the n th trialwillbe asuccessas s n s n hence weintroducethe laplaceestimator l n asourfirstestimatorofresidualrisk.giventhat throughoutthefuzzingcampaign s out ofngenerated inputs have exposed a vulnerability the probabilitytodiscoveravulnerabilitywhengenerating n th test inputisestimatedas l n n n intuition .thekeyideaoflaplacewastoreporttheproportion oftimeswehaveobservedthesunnotrise assuming wehave observed both events once more than we actually have.
as the evidence for the sun always rising increases the laplace estimate of the probability of the sun notrising approaches zero.yet there alwaysremainsanon zeroprobabilityforthe sunnot to rise.
similarly as an estimator of residual risk there always remains a non zero probability that the n th test input exposes a vulnerability.
while laplace is certainly the first better missing mass estimators have since been proposed.
.
good turingestimator thegood turingestimatorisperhapsthemostwidelyusedestimatorofthemissingprobabilitymass.itwasproposedinaseminal paper by i. j. good and alan turing in .
the good turingestimatoriscomputedbasedonthefrequencyofrarelyobserved species.comparedtolaplace thegood turingestimatorconsiders more structure in the available data and is thus also more amenabletoouradjustmentsforadaptivebias.concretely goodturing gives an estimate of the probability to discover a previously unseen species.
as discussed in section .
the discovery probability providesan upper bound onthe residual risk.
whenntestinputshavebeengeneratedduringafuzzingcampaign letthe incidencefrequency yiforaspecies dibethenumber ofgeneratedtest inputsthat belong to species di yi xj xj di j n .
let the number of singleton species f1be the number of discovered species to whichexactly one generatedinputbelongs f1 di yi i s .
we introduce the good turing estimator gt n as our firstestimatorofdiscoveryprobability.suppose aftergenerating ntest casesthroughoutthefuzzingcampaign f1specieswereobserved exactlyonce.thegood turingestimatoroftheprobabilitytodiscover a previously unseen species is computed as the maximum likelihoodestimateoftheprobabilitytoobserveasingletonspecies gt n f1 n intuition .
the key idea of the good turing estimator is to useanestimateoftheprobabilitytoobserveararespeciesas an estimate of the probability to observe an unseen species which is generally rarer .
concretely good turing reports the maximum likelihood of the probability that the next generated test input tbelongs to a singleton species as an estimate of the probability that tdiscovers anewspecies.
the main properties of good turing are i the estimator s accuracy strictly increases as the sample size i.e.
number of generated testinputs increases ii its convergence tothe truevalueis alsoreasonablyfast iii itsmeansquarederrorisreasonably low and iv its performance is close to the best natural estimatorforanydistribution .whilegood turingisclassically defined for multinomial distribution the definition for the case where an inputcan belong to multiple species isequivalent .
.
reset estimators to account for adaptive bias during the estimation of discovery probability in greybox campaigns we propose to apply estimators ofmissingmasstoincidencefrequencies yithatarerefreshedevery onceinawhile i.e.
reset yi 0foralli i s .ourclassof resetestimatorsis parameterized by thenumberofseeds that can beaddedtothecorpusbeforetheincidencefrequenciesareresetto zero.
in the current instance we suggest to apply the good turing estimator ofmissingmassonthe refreshedfrequency counts.
giventhesame initialseed corpus c adaptivebias isthedifferencebetweendiscoveryprobabilitiesforablackboxfuzzingcampaignandagreyboxfuzzingcampaignoflength n.as moreseeds areaddedtothecorpus theprobabilitytodiscoverapreviouslyunobservedspeciesthe n thgeneratedtestinputusually increases foragreyboxcampaign cf.fig.
.giventhesameallowablerisk 235estimatingresidualrisk in greyboxfuzzing esec fse august athens greece comparedtoablackboxcampaign agreyboxcampaignwouldneed to generateless inputsto fall belowthe given threshold.
we propose to consider a greybox campaign as a sequence of blackbox campaigns each started when a new seed is added.
we observe that the adaptive bias emerges only because new seeds are added to the seed corpus.
as a new seed becomes available for fuzzing the probability pithat a generated input belongs to a rare speciesdimightslightlyincrease.however fortheperiodbetween two additions to the seed corpus the global species distribution remainsinvariant likeinablackboxfuzzingcampaign.hence a greybox campaign fisasequenceofblackbox campaigns f f1 f2 ... fk wherekis the number of new seeds that are added to the initial seedcorpusthroughout the greybox campaign f. givenparameter a wedefinethe a resetfrequency yi aofspecies diastheincidencefrequencyof diinthepartialgreyboxcampaign thatwasstartedwhenthe k a thseedwasaddedtotheinitial seedcorpus i.e.
yi a xj xj fk a ... fk xj di i s .
using the a reset frequency yi a the definition of the number of a resetsingleton species isstraightforward f1 a di yi a i s .
weintroducethe a resetgoodturingestimator r n a asour firstclassofestimatorsofdiscoveryprobabilitythataccountsfor adaptive bias in greybox campaigns.
the a reset good turing estimatorcan be computedas r n a f1 a n where inpractice aisthenumberofnewseedsthatcanbeaddedto theseedcorpus sincethelastreset beforetherecordedincidence frequencies mustbe reset again.
intuition .
the regular reset of incidence frequencies allows to remove the weight of the evidence for the previous species distribution when rare species were less likely.
the inverse of thea reset frequencies yi a s i 1provides a less biased estimateofthe currentglobalspeciesdistribution pi s i 1than the inverseofthe actual incidence frequencies yi s i .
however consideringonlytheshortertailofthecurrentgreybox campaign will also lead to an overestimate of the true discovery probability.7theactualprobabilitytodiscoveranewspeciesmight alreadybemuchlower.inthefollowing wepresentaclassofestimatorsthatallowsustousetheentireevidencegeneratedthroughout the full greybox campaign.
.
meanlocalestimators wecanunderstandadaptivebiasalsoasapropertythatemerges from an unbalanceddistribution of the numberof times each seed has been chosen for fuzzing.
on the one hand we have new seeds that whilemorelikelytobechosennext mayhaveneverbeen fuzzed before.
on the other hand we have old seeds that while 7we note that we prefer conservative estimators.
an estimator that overestimates residual risk is preferred over one that underestimates the risk.much less likely to be chosen next may have been fuzzed thousandsoftimes.clearly ifweestimatediscoveryprobabilityfrom global incidence frequencies where the global incidence frequency yiofaspecies diiscomputedasa linearcombination ofthelocal incidencefrequencies yt iofaseedt c i.e.
yi summationtext.
t cyt i thenthe resulting estimate is bound to be biased towards the neighborhood ofthe old less likely seeds.
now adaptive bias is nota concern for local estimators i.e.
estimatorsthatare basedonthelocaldistribution pt i s i 1ofseed t. given a seed t letmbe the fuzzer s mutation operators ltbe the set oflocations in twhere a mutation operator can be applied.
withoutlossofgenerality supposethefuzzergeneratesaninput t only when applying the operator m mto location l lt.8then p xt n t p at n m p bt n l and p xt n t p xt n t wherextnis then th input that is generated from tby fuzzing t xt n 1isthe n thinputgeneratedfrom tbyfuzzing t atnandbtn are the mutation operator and mutation location in t respectively andboth are chosenat random when generatinginput xtn.
we propose to consider a greybox campaign fasa set of concurrentblackbox campaigns one for eachseed.
f xn m.xn fxm disc xm m n n n wherefxmisaseed specificfuzzingcampaign eq.
nisthe total number of inputs that fgenerates and disc xm holds if there exists a species disuch that xmdiscovered di.
this perspective allows us to estimate quantities emerging from theglobal distributionasaweightedcombinationofestimatesofquantities emergingfrom the local distributions.
we introduce the mean local laplace estimator ml.l n as a new class of estimators of discovery probability that i account foradaptive biasingreybox campaignsand ii arecomputedas a weighted combination of local missing mass estimates notsubject toadaptivebias .giventhecurrentcorpus cnwhenntestinputs havebeengenerated cf.
section3.
then ml.l n iscomputedas ml.l n summationdisplay.
t cnqt nt whereqtistheprobabilitythat togeneratethe n thtestinput thefuzzerchoosestomutateseed t cn andntisthenumberof test inputsthat were generatedbyfuzzing t. whenntestinputshavebeengenerated letthe localincidence frequency yt iforspecies diandseedtbethenumberoftestinputs generatedbyfuzzing tthat belong to di yt i xt xt di xt ft .
whereftistheseed specificcampaign.let ft 1bethenumberof localsingletonspecies foraseed t i.e.
locallydiscoveredspecies to whichexactly one generatedinputbelongs ft di yt i i s .
we introduce the mean local good turing estimator ml.gt n asaweightedcombinationofthelocalgood turingestimates.in 8theapplicationofamutationoperatortoamutationlocationismerelyanabstraction.
it means that the fuzzer chooses at random from a large but fixed set of possible modifications to t. 236esec fse august athens greece marcelb hme danushkaliyanage andvalentin w stholz ourexperiments weoftenobservedthespecialcasewhere nt i.e.
the seed thas never been fuzzed .
in this case we assume the local discovery probability to be one .
in the absence of local singletons we fall back to the local laplace estimate.
ml.gt n summationdisplay.
t cnqt if nt nt ifft ft ntotherwise whereqtistheprobabilitythat togeneratethe n thtestinput thefuzzerchoosestomutateseed t cn ntisthenumberofinputs generated by fuzzing t andft 1is the number of local singleton species for t. intuition .
the weighted combination of local missing mass estimatestacklesadaptivebiasindiscoveryprobabilityestimation by accounting for the fact that some seeds have been fuzzed moreoftenthanothers.thecontributionofeachseed ttothe final discovery probability estimate is decided based on the current power schedule qt.
while old seeds may have been fuzzed much more often if the probability qtto select that seed is very low the contribution from that seed to the final discovery probability estimatewillalsobe relativelylow.
incontrastto a resetestimators ourmeanlocalestimatorsallow to reuse incidence frequencies from the entire fuzzing campaign.
this facilitates less imprecision during estimation.
however the weightedcombinationoflocalmissingmassestimatessystematicallyoverestimates n .forinstance whenanewseedisadded before it has been fuzzed a mean local estimator assumes that the first input generated from that seed discovers a new species whichistrueonlylocally .however apositivelybiasedresidual riskestimator iswell preferredover anegativelybiasone.
experimentalsetup .
research questions rq.
classicalestimators.
how do two classical estimators of missingmass good turingandlaplace performinthepresence ofadaptive biasfor greybox campaigns?
rq.
our estimators.
how do our novel reset reset the laplacemeanlocal andgood turingmeanlocalestimators performinaddressingadaptivebiasforgreyboxcampaigns?
rq.
extrapolation.
given a small number of data points of discoveryprobabilityattheverybeginningofthegreyboxcampaign howdoesalinearextrapolationof performinpredictingthediscoveryprobabilityseveralorders ofmagnitude laterinthe campaign?
.
fuzzer species andsubject programs forourexperiments weuse libfuzzer thedefaultgreybox fuzzeringoogle sossfuzz andmicrosoft sonefuzz .our species are a coverage elements called features.
a featureis a combinationofcoveredbranchanditshitcount.so featurecoverage subsumes branch coverage.
wealso considered evaluatingestimator performance in afl.
however afl selects each seed from a circularqueuethatcanhaveanorbitofseveralhourswhichmakes estimation difficult in short the discovery probability fluctuatessignificantly depending on the current queue position.
very recently we became aware that the latest version of afl s successor afl v3.
substituted the afl style circular queue with a more efficient libfuzzer styleweightedsampling .
wechosesixsubjectsfromfuzzbench afuzzerbenchmarking platform.
from fuzzbench we chose six arbitrary securitycritical programs that did not crash for the first 109generated test inputs.libfuzzer isanin processfuzzerthatcrasheswiththesubjectandrestarts loosingallincidencefrequencies.wechoseexactly six subjects for practical reasons.
an experimental campaign for one subjectcould runfor uptoone week.
freetype 286k loc is a widely used software font engine.
json 12k loc is the json parser library for cpp.
libpcap 69k loc is a library to capture packetsfrom thenetwork.
libpng 423kloc isanimageparser libraryforpng.
libxml2 503kloc isanxmlparserlibrary.
zlib 48kloc isadata compressionlibrary.
.
experiment methodology data points .torunagreyboxfuzzingcampaign weexecute libfuzzeronasubjectwiththeprovidedseedcorpus.at exponentially increasing intervals we record a time stamp and all relevant statistics required for estimation.
starting with generated test inputs eachsubsequentdatapointischosenaftertwiceasmany testinputsweregeneratedcomparedtothepreviousdatapoint.we stopthecampaigneitherwhenwerunoutofresources orwhen n approx.
testinputsweregenerated.forfreetype andlibxml2 we ranoutof diskspace.
repetitions .
for each subject we run fuzzing campaigns and if not statedotherwise report averagevalues.
groundtruth .foreachdatapoint wedeterminethetruediscovery probability as follows.
when recording the data point after having generated ntest inputs we suspend the greybox campaign and start a blackbox campaign of length nwith the current seed corpus.
during that blackbox campaign generated inputs that discoveranewspeciesare notaddedtotheseedcorpus andincidence frequencies or other statistics for the greybox campaign are not updated.
however we countthe number dof inputs that belong to species that have notbeen discoveredinthe greybox campaign.
wedeterminethetruediscoveryprobabilityastheproportion d nof inputs generated in the data point specific blackbox campaign of length nthat belong to species that have not been discovered in the greybox campaign of length n. note that we let the blackboxcampaigngenerateasmanyinputsasthegreyboxcampaignhasalreadygenerated.thisisbecauseoftheexponentialcost ofreducing discovery probability byone order of magnitude.
determining ground truth is expensive.
one fuzzing campaign of length n 109took between and days of wall clock time .
.
measuresofestimatorperformance weusetwoclassicalmeasuresofestimatorperformance meanbias andvariance.
meanestimatorbias quantifiesthedegreetowhich theestimatorsystematicallyover orunder estimatestheestimand.
weconsideragoodestimatortohavea smallandpositivemeanbias .
theestimatormightsystematicallyover estimatetheprobability thatavulnerabilityexists butitshouldneversystematicallyunderestimateit andthemagnitudeofthebiasshouldbesmall.
estimator 237estimatingresidualrisk in greyboxfuzzing esec fse august athens greece varianceisliteratelythevarianceoftheestimates.whiletheaverage might be close to the true value low mean bias an individual estimatemightstillbefarfromtheaverageestimate highvariance .
we consideragoodestimator to have a smallvariance .
however unlike in traditional studies of estimator performance wemeasuremeanbiasandvarianceasa differenceinmagnitude .the discoveryprobability n foralong runningfuzzingcampaigncan beverysmall.infact dependingonthenumberofinputs n n rangesovermanyordersofmagnitude cf.
section3.
.suppose the truevalueis butourestimatorgives or10 .then neither the absolutenor the relative meanbias would indicate the eightordersofmagnitudedifference.hence wemeasure biasand variance using the common logarithm.
meanbias .suppose weconduct rfuzzingcampaigns.foreach campaign r r roflengthn letthetruediscoveryprobability be r n and the estimated discovery probability be r n then the mean bias b n ofestimator iscomputedas b n r summationdisplay.
r 1log10 r n log10 r n r whereapositivemeanbiasof b n 0canbeinterpretedas n systematicallyover estimating n by b n ordersofmagnitude and b n 0as under estimating resp.
.
variance .suppose weconduct rfuzzingcampaigns foreach campaign r r r whenntest inputs have been generated let the estimated discovery probability be r n then the variance var n ofestimator iscomputedas var n r bracketleftbiggr summationdisplay.
r 1log10 r n summationtext.1r s 1log10 s n r bracketrightbigg which is the average difference between each individual and the averageestimateby var n orders ofmagnitude.
.
infrastructure all experiments were executed on a core cloud instance with intel r haswell r .3ghz cpus and 64bit main memory and a 120gbharddisk.tofacilitateafairworkload werunall andonly repetitions ofone subjectsimultaneously.
experimentalresults .
rq1.
performance ofclassical estimators figure .a shows the performance of the laplace l n and goodturing gt n estimators.bothestimatorshavepreviouslybeen proposed to estimate the current discovery probability in blackbox campaigns.
however due to the lack of ground truth they have never been empirically evaluated.
inourevaluation wefindthatbothestimators l n and gt n underestimate the true discovery probability in greybox campaigns.
theestimatemightbe uptofourordersofmagnitudesmaller than the true discovery probability.
however except for freetype at somepoint during the campaign the differencein magnitudeusually starts decreasingagain.
this is consistent withour claimthat adaptive bias reduces as more test inputs are generated.
a systematicnegativebiasis undesirable whenestimatingtheresidualrisk that a vulnerability could be discovered if more time was invested.classical estimators systematically and substantially underestimatethediscoveryprobabilityingreyboxcampaigns.this meansthattheestimatepurportsfalseconfidenceinprogram correctness.supposetheengineerstopsthecampaignaftergeneratingninputs such that the current discovery probability estimate n matcheshermaximum allowablethreshold .
ifthe meanbias at nshows adifference inmagnitudeof negative two then the engineerwill terminatethe campaign too early.
because of the power law relationship she would need to execute about two orders of magnitude more inputs to achieve the requiredallowable residual risk .
.
rq2.
performance ofourestimators figure .b shows the performance of our a reset and mean local estimators which address the key challenge in estimation for greyboxfuzzing i.e.
adaptivebias.ourestimatorsexhibitasmallerand positive mean biasthanthe previously proposedestimators.
reset.the1 resetestimator r n resetsthefrequencycounts foreachspeciesbacktozeroeverytimea newseedisadded.the resulting estimate is not subject to adaptive bias because the frequencies samplescomeonlyfromthespeciesdistributionemerging from the current corpus.
however compared to the total campaign length we are clearly undersampling.
this undersampling leads to an overestimate of the true discovery probability.
to reduce the magnitudeofthispositivebias weevaluatedthe10 resetestimator r n which resets the frequency counts for each species back to zeroafter every 10thnewlydiscoveredseed.
bothresetestimators r n and r n exhibitafairlyhigh positive mean bias.
the reset r n can provide an estimate up tothree order of magnitudes higher than the true discovery probability.for the reset the averagedistance from the average estimate i.e.
the variance could be up to about two orders of magnitude.
for the reset mean bias and variance are somewhat lower butitunderestimates.agood a resetestimator r n s is likelywithintherange a .noteasaapproachesthecurrent number ofseeds we have r n cn gt n .
meanlocal .bothmeanlocalestimatorshavealowermeanbias and variance than the reset estimators.
the mean local laplace ml.l n exhibitsthesmallestmeanbias.forallsubjectsandalmost the entire campaign ml.l n is no more than one order of magnitudeawayfromthetruediscoveryprobability.while ml.l n often slightly underestimates at the beginning it conservatively overestimateswhenalargenumberoftestshavebeengenerated.
variance isvery low.
themeanlocalestimatorsperformbest.themeanlocallaplace has the lowest bias and variance but might slightly underestimate.themeanlocalgood turingalmostneverunderestimatesbut has a slightly higher bias and variance.
anengineer using our estimators is unlikely to terminate the campaign too early.
given an allowable risk the engineer is quite likely to determinethecorrectpointintimewhentoabortthecampaign such that the currentriskisbelowthe allowable threshold.
238esec fse august athens greece marcelb hme danushkaliyanage andvalentin w stholz freetype json libcap libpng libxml zlibresidual risk mean bias variance10 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e .
.
.
.
testsestimate of delta n estimator mean bias estimator variance estimator good turing laplace a resultsfor rq1.
estimator performance for the classical estimators of discoveryprobabilitylaplace land good turing gt.
freetype json libcap libpng libxml zlibresidual risk mean bias variance10 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e 1e .
.
.
.
testsestimate of delta n estimator mean bias estimator variance estimator ml.good turing ml.laplace reset.
reset.
b resultsfor rq2.
estimator performance for ournovel estimators of discoveryprobabilitythat account for adaptivebias reset r n reset r n laplacemeanlocal ml.l n and good turingmeanlocalestimators ml.gt n .
figure results forestimator performance campaigns on subjects upto dayspersubject inwall clocktime .
.
rq3.
performance ofextrapolation fromtheextendedstadsmodel weconstructedasimulationof thirty greybox campaigns and observed an almost linear behavior ofthediscoveryprobabilityonthelog logscale cf.
figure2.top .
this suggestedapower law relationship.
infigure our empirical results confirmour observation.
for four out of six subjects about r2 of the variance found in the response variable log n can be explained bythe predictorvariablelog n subjecttolinearregression.for libcap thereare several campaigns with zero values for n leading to a lower yetstillfairlyhighgoodness of fitof r2 .forlibxmlaround n there is a sudden and consistent increase by almost oneorderofmagnitudeacrossallcampaigns wherealotofnew species were discovereddueto newlyaddedseeds r2 .
tounderstandtheutilityofextrapolation wechosethreedata pointstomeasurethediscoveryprobabilityandmeasuredmeanbias 239estimatingresidualrisk in greyboxfuzzing esec fse august athens greece r2 .
r2 .
r2 .
r2 .
r2 .
r2 .
libxml zlib libcap libpng freetype json number of generated test inputs ndiscovery probability delta n figure linear regression of andr2 goodness of fit.
grey dots and black stars show individual andaverage values resp.
ofdiscovery probability n .
andvariancewhenusinglinearregressiontoextrapolateeffectively by several orders of magnitude.
at the cost of about one million additionaltestinputs 9anextrapolationbytwoordersofmagnitude toonehundredmillion testinputs givesadiscoveryprobabilitythat isonlyaboutoneorderofmagnitudehigherthanthetruediscovery probability fortheaveragesubject.however weobservedforother dataand extrapolation points thatextrapolation underestimates whichisundesirable.cost meanbias andvariancearemuchhigher thanfor our mean local estimators.
our empirical results confirm a power law relationship.
this power law relationship suggests that an engineer can extrapolate discovery probability by ordersof magnitude with high accuracy.italsosuggeststhatanywherethroughoutthefuzzing campaign iftheengineerwantstoreducetheresidualriskbya factor of x she just needs the fuzzer to generate c xmore test cases where cisaconstant.
threats to validity as for any empirical study there are various threats to the validity of our results and conclusions.
one concern is external validity i.e.
the degree to which our findings can be generalized to and across other subjects and tools.
to mitigate this concern we definedselectioncriteriaandchosesubjectsfromawell knownfuzzer benchmarkaccordingtothesecriteria sec.
.
.anotherconcernis internal validity i.e.
the degree to which our study minimizes systematicerror.firstly tomitigate spuriousobservations duetothe randomnessofthefuzzersandtogainstatisticalpower werepeated each experiment times and report average values.
secondly our evaluation scripts may contain errors.
to facilitate scrutiny and reproducibility we make our scripts anddata available.
9the additional test inputs must be generated in a blackbox manner to measure discoveryprobability cf.
section5.
.
related work interestinassessingtheconfidencethatatestingtechniqueinspires in the correctness of a tested program dates all the way back to the s .
in this stream of works authors compared both probabilistically and experimentally the confidence inspiredbyawhiteboxtestingapproach calledpartitiontesting andblackboxtestingapproach calledrandomtesting .however they were mostly interested in theoretical properties such as effectiveness orefficiency ratherthanpracticalwaystomeasure confidence orits complement residual risk.
techniques to measure residual risk were proposed more recentlyforwhiteboxandblackboxfuzzing.
whiteboxfuzzing uses symbolic execution to systematically enumerate the paths of a program.toquantifyresidualriskinwhiteboxfuzzingcampaigns it was proposed to apply model counting to the path conditions of the explored paths .
to quantify residual risk in blackbox campaigns itwasproposed to employstatisticalestimators such as good turing or laplace .
however in our evaluation for greybox campaigns we find that those estimators are negatively biasedwhen directly applied togreybox campaigns.in contrasttoearlierworks weanalyzetheadaptivebiasandpropose twoclassesofestimators that overcome adaptive bias.
we are concerned with the residual risk that a bug still exists in a program implementation given an ongoing greybox campaign.
in parallel there exists a large body of work on quantifying the general reliability of a software system .
however as filieri et al.
recently noted the proposed approaches are defined on the design andarchitectural level ratherthanonthe program itself.
discussion thedecisionwhentostopfuzzinghasalwaysbeenguesswork.how doweknowifthenextgeneratedinputwouldnotsuddenlyexpose an error?
we are excited that we can provide the first answers for greybox fuzzing.
this question is highly practical .
for instance fuzzbuzz 10acompanywhichoffersfuzzingasaservice reached outandprovidedfeedbackonearlierversionsofthisdraft.fuzzbuzz is currently developing an estimation feature for their product which takes inspiration from our residual risk estimation research.
thekeyideaof residualriskestimation istomodelsoftwaretestingasasamplingprocessandusestatisticalmethodstoestimate the probability that a bug exists that has not yet been found.
once theriskfallsbelowacertainthreshold itbecomesimpracticalto continuethecampaign.atthispoint youcanstopthecampaign and change your setup e.g.
by adding a new harness.
our estimators can also be used to manage a resource budget in large scale continuous fuzzing platforms by automatically terminating campaigns whose residual risk dropped below the given threshold.
for thefirsttime wehaveahandleonadaptivebiasingreyboxfuzzing whichprovidesseveral avenues for future work.
acknowledgment we are thank andrei serban of fuzzbuzz for his valuable feedback on an earlier version of this draft.
this work was partly funded by the australian research council de190100046 .
this research was supportedbyuse ofthe nectarresearch cloud.
240esec fse august athens greece marcelb hme danushkaliyanage andvalentin w stholz