automated unearthing of dangerous issue reports shengyi pan zhejiang university hangzhou zhejiang china shengyi.pan zju.edu.cnjiayuan zhou centre for software excellence huawei kingston ontario canada jiayuan.zhou1 huawei.comfilipe roseiro cogo centre for software excellence huawei kingston ontario canada filipe.roseiro.cogo1 huawei.com xin xia huawei hangzhou zhejiang china xin.xia acm.orglingfeng bao zhejiang university hangzhou zhejiang china lingfengbao zju.edu.cnxing hu zhejiang university ningbo zhejiang china xinghu zju.edu.cn shanping li zhejiang university hangzhou zhejiang china shan zju.edu.cnahmed e. hassan queen s university kingston ontario canada ahmed cs.queensu.ca abstract the coordinated vulnerability disclosure cvd process is commonly adopted for open source software oss vulnerability management which suggests to privately report the discovered vulnerabilities and keep relevant information secret until the official disclosure.
however in practice due to various reasons e.g.
lacking security domain expertise or the sense of security management many vulnerabilities are first reported via public issue reports irs before its official disclosure.
such irs are dangerous irs since attackers can take advantages of the leaked vulnerability information to launch zero day attacks.
it is crucial to identify such dangerous irs at an early stage such that oss users can start the vulnerability remediation process earlier and oss maintainers can timely manage the dangerous irs.
in this paper we propose and evaluate a deep learning based approach namely memvul to automatically identify dangerous irs at the time they are reported.
memvul augments the neural networks with a memory component which stores the external vulnerability knowledge from common weakness enumeration cwe .
we rely on publicly accessible cve referred irs cirs to operationalize the concept of dangerous ir.
we mine cirs distributed across oss projects hosted on github.
evaluated under a practical scenario of high data imbalance memvul achieves the best trade off between precision and recall among all baselines.
in particular the f1 score of memvul i.e.
.
improves the best performing baseline by .
for irs that are predicted as cirs but not reported to cve we conduct a user study to investigate their usefulness to oss stakeholders.
we observe that corresponding author.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse november singapore singapore association for computing machinery.
acm isbn .
.
.
.
out of of these irs are security related and of them are suggested by security experts to be publicly disclosed indicating memvul is capable of identifying undisclosed dangerous irs.
ccs concepts security and privacy software security engineering .
keywords software security vulnerability issue report deep learning acm reference format shengyi pan jiayuan zhou filipe roseiro cogo xin xia lingfeng bao xing hu shanping li and ahmed e. hassan.
.
automated unearthing of dangerous issue reports.
in proceedings of the 30th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse november singapore singapore.
acm new york ny usa pages.
introduction open source software oss is widely used by the software industry from small scale projects to critical applications deployed in global infrastructures.
despite its benefits the usage of oss also incurs on security risks that can lead to negative impacts to individuals and organizations .
to better manage oss vulnerabilities and minimize the risk of exploits the coordinated vulnerability disclosure cvd process is commonly adopted .
the cvd suggests to privately report the discovered vulnerabilities to oss maintainers so that relevant information is not publicly available until the maintainers are ready for the disclosure e.g.
a patch is available .
in practice however due to various reasons e.g.
lacking security domain expertise or the sense of security management many irs that report vulnerabilities are first submitted to publicly accessible issue tracking systems its and then the associated vulnerabilities are officially disclosed.
such vulnerability irs are dangerous irs as the time gap between the ir creation date and the vulnerability disclosure date provides a window of opportunity for attackers to develop and deploy exploits e.g.
zero dayesec fse november singapore singapore pan et al.
attacks .
in particular attackers can take advantage of the leaked vulnerability information e.g.
the reproducible steps of an attack which puts oss users at a great disadvantage in defending against exploitation.
for instance many vulnerability irs are first submitted to the github its then referred by a common vulnerabilities and exposure cve record that officially discloses the vulnerability .
such cve referred irs cirs are a type of typical dangerous irs as the leaked vulnerability information are earlier available with a median time of days see section .
and the reported vulnerability details provides an advantage for attackers see section .
for a motivation example .
it is crucial for oss users especially downstream software vendors to identify dangerous irs at an early stage so that they can take an active role in the race against attackers i.e.
the race between patching and exploiting vulnerabilities .
with the ability of early sensing dangerous irs vendors can start the remediation process earlier instead of waiting for the official disclosure and then rushing to remediate.
since one project may rely on hundreds of oss projects and it takes too much work from oss users to monitor every ir in the upstream oss projects an automated solution is necessary to identify dangerous irs.
furthermore it is also important for its platforms to implement mechanisms to identify emerging dangerous irs.
its platforms as a service provider should take the responsibility of better managing vulnerability reports to comply with the cvd process reducing the threat of dangerous irs and consequently making the oss ecosystem safer.
for example by identifying dangerous irs in advance its platforms can warn reporters before posting the ir and suggest them to privately report to the maintainers instead.
moreover its platforms can automatically hide the existing dangerous irs from the public channel and flag them as priorities for maintainers.
the goal of our work is to provide a tool that can automatically unearth the emerging dangerous irs at their early stage.
given the prevalent usage of cve in oss vulnerability management and the popularity of github its in oss ir management we operationalize dangerous irs as cirs.
in this paper we take a first step to explore the characteristics of cirs and to propose an automated approach to identify them at their creation time.
we first build a large scale dataset consisting of irs from oss systems hosted on github with cirs in total.
the number of cirs in our dataset is larger and more up to date than those of the five datasets in total collected before as proposed by existing studies .
moreover the existing datasets are limited in project scope which hinders the construction and evaluation of a generic approach.
the small proportion of cirs .
agrees with real world distributions and shows the challenge of unearthing dangerous irs.
our preliminary study shows that .
of the cirs are created before the disclosure of the corresponding cve records suggesting that early leakage of vulnerability information through a public ir is very common.
cirs account for only .
of all irs indicating that there is a limited vulnerability knowledge for datadriven models.
moreover all cirs belong to different cwe vulnerability types which can have diverse causes behaviours and consequences.
it is challenging to predict cirs under such a highly imbalanced class distribution and diverse vulnerability types particularly by using existing machine learning approachesthat are adopted from similar tasks e.g.
triaging security bug reports .
to cope with these challenges we propose memvul a deep learning based approach that leverages language models and amem ory component to incorporate the external vulnerability knowledge from cwe common weakness enumeration a curated classification schema for describing vulnerabilities.
the memory component is designed to act as a vulnerability knowledge base during model inference.
memvul predicts whether an input ir is a cir by matching the description of the ir against the knowledge base.
to evaluate the effectiveness of memvul we conduct experiments under a practical scenario where the proportion of cirs .
agrees with the real world distribution.
evaluation results show that our approach achieves an f1 score of .
which outperforms the best baseline by .
with an ablation study we further verify the effectiveness of incorporating the memory component as a knowledge base of vulnerabilities.
in summary our paper makes the following contributions we are the first to introduce the task of unearthing dangerous irs at their early stage.
we build a real world dataset with larger and more up date security related ir data i.e.
cirs from oss systems.
we consider irs linked to cve records as cirs and use them as a proxy to dangerous irs.
we propose memvul a deep learning based approach that uses language models and incorporates external vulnerability knowledge from cwe improving the identification of cirs.
we evaluate memvul under a practical scenario of extreme data imbalance.
memvul achieves an f1 score of .
improving the best performing baseline by .
to foster future work and in line with good research practices we provide a complete replication package of our approach and experiments .
motivation and preliminaries in this section we first introduce the background of our paper section .
.
then we provide a motivation example section .
.
finally we conduct a preliminary study on cirs section .
.
.
background common vulnerabilities and exposure cve cve provides a standardized method to identify define and catalog publicly disclosed software vulnerabilities .
once a vulnerability is discovered developers can request a cve id from the cve numbering authority e.g.
mitre corporation .
the id being reserved is regarded as the initial state of a cve record.
however the record is not publicly available until its publication to the cve list when the minimum required details are prepared.
except for the cve id each cve record includes a brief and project oriented description of the vulnerability and the related