automated detection of password leakage from public github repositories runhan feng ziyang yan shiyan peng yuanyuan zhang shanghai jiao tong university shanghai china fengrunhan yzy123 peng shiyan yyjess sjtu.edu.cn abstract the prosperity of the github community has raised new concerns about data security in public repositories.
practitioners who manage authentication secrets such as textual passwords and api keys in the source code may accidentally leave these texts in the public repositories resulting in secret leakage.
if such leakage in the source code can be automatically detected in time potential damage would be avoided.
with existing approaches focusing on detecting secrets with distinctive formats e.g.
api keys cryptographic keys in pem format textual passwords which are ubiquitously used for authentication fall through the crack.
given that textual passwords could be virtually any strings a naive detection scheme based on regular expression performs poorly.
this paper presents passfinder an automated approach to effectively detecting password leakage from public repositories that involve various programming languages on a large scale.
passfinder utilizes deep neural networks to unveil the intrinsic characteristics of textual passwords and understand the semantics of the code snippets that use textual passwords for authentication i.e.
the contextual information of the passwords in the source code.
using this new technique we performed the first large scale and longitudinal analysis of password leakage on github.
we inspected newly uploaded public code files on github for days and found that password leakage is pervasive affecting over sixty thousand repositories.
our work contributes to a better understanding of password leakage on github and we believe our technique could promote the security of the open source ecosystem.
ccs concepts security and privacy authentication.
keywords password mining software repositories deep learning github acm reference format runhan feng ziyang yan shiyan peng yuanyuan zhang.
.
automated detection of password leakage from public github repositories.
in 44th international conference on software engineering icse may pittsburgh pa usa.
acm new york ny usa pages.
.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
icse may pittsburgh pa usa association for computing machinery.
acm isbn .
.
.
.
introduction github has received much attention since its establishment in .
more and more developers choose to create and host their repositories on github because of its attractive features like free code hosting and collaborative development.
especially in the recent two years the github community has proliferated.
as of september there are million registered developers on github.
in only million new repositories were created .
with so many repositories hosted publicly on github security and privacy issues come naturally.
these repositories may contain important sensitive authentication information such as textual passwords api keys private cryptographic keys etc.
once such sensitive information is leaked it will bring serious security threats to the owners.
due to some developers lack of security consciousness it is not uncommon for such authentication information to be exposed to the public as part of github repositories .
among all these authentication information textual passwords are of great value.
although been blamed for security pitfalls textual passwords have been a mainstream authentication method for decades because of their low deployment cost and simplicity.
especially in development developers tend to use textual passwords to authenticate themselves to remote services.
if such textual passwords are used for authenticating to third party services once they are leaked all the data protected by the passwords would be compromised.
for instance a leaked gmail password can be used to login into many google services including gmail google driver etc.
it can also be used to send phishing e mails spoofed from the owner.
besides the disclosure places the owners all accounts in jeopardy since security insensitive developers tend to reuse their passwords across different services .
worse still if the textual passwords are for enterprise use i.e.
they are hard coded in source code to access or manage the enterprises network database or other system infrastructure such leakage could lead to a severe security breach .
despite the potential threat it remains unknown to what extent passwords are leaked on github and whether the service provider can effectively detect and protect leaked passwords or in other words whether attackers can efficiently harvest them.
both academia and industry have made great efforts to understand and mitigate the leakage of various credentials on github.
sinha et al.
investigated java files in repositories to identify aws keys using regular expressions and lightweight static analysis.
meli et al.
performed a large scale analysis on cryptographic key files and api keys with distinctive formats to characterize the leakage of the secrets on github.
since github has introduced its secret scanning feature which scans public repositories to prevent fraudulent use of secrets committed accidentally .
ieee acm 44th international conference on software engineering icse authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa runhan feng ziyang yan shiyan peng yuanyuan zhang so far secret scanning supports a set of credentials including alibaba cloud access key azure access token and aws access key etc.
besides many open source tools were developed to help prevent developers from pushing their sensitive authentication information to public repositories.
however existing work mainly focuses on structured secrets like api keys which could be easily detected with well crafted regular expressions.
relatively little attention has been paid to textual passwords.
given the serious consequences that password leakage may bring an in depth study to understand the scope and magnitude of textual password leakage on public github repositories at a large scale is necessary.
therefore automated mining techniques towards detecting passwords from github repositories containing code files written in multiple programming languages are badly needed.
they could help better understand and promote the security of the opensource ecosystem.
however it is quite challenging to achieve due to the following barriers.
heterogeneity of passwords.
unlike structured secrets like api keys etc.
textual passwords could be virtually any strings and do not conform to distinct structures thus making them hard to detect with high accuracy.
existing techniques mainly rely on wellcrafted regular expressions or entropy based heuristics .
specifically regular expression based password detection techniques take keywords such as password pwd which are usually used altogether with the actual passwords as a significant basis for identification lacking the ability to model the passwords themselves.
entropy based techniques calculate the shannon entropy of each string implying a hypothesis that passwords have higher entropy than ordinary strings.
however in practice many passwords are chosen by humans but not randomly generated by machines thus violating the assumption .
in general these techniques perform poorly since they cannot properly deal with the heterogeneity of passwords which hinders them from being adopted in practice.
multiformity of source code.
github repositories consist of source code files written in different programming languages following diverse syntax and styles.
such multiformity also diminishes the effectiveness of regular expression based technology.
some work leverages specific static analyzers to bypass the impact of different syntax and styles.
specifically slic considers only puppet an infrastructure as code iac script language and is built based on a dedicated parser .
credminer focuses on android smali code using backward slicing and forward simulation execution engine to reconstruct credentials used as parameters for predefined sink apis in application code .
however this work relies heavily on the sophisticated static analysis tools designed for specific programming languages which are not available for unpopular programming languages thus lacking the generalization ability to analyze files written in different languages.
to deal with the multiformity problem a programming language agnostic technique is needed.
besides such static analysis based methods usually have to statically analyze each file in the codebase to construct interprocedural dataflow lacking scalability to ultra large scale codebases on github .
this paper presents passfinder an automated approach to detecting passwords in code files written in different programminglanguages.
considering the two barriers mentioned above we decompose the password detection problem from two aspects.
on the one hand for the heterogeneity of passwords we construct the password model to extract the intrinsic characteristics of textual passwords.
specifically we divide textual passwords into two main categories i.e.
human chosen passwords and machine generated random passwords.
passfinder models the distribution of humanchosen passwords corpus random passwords corpus and ordinary strings corpus with a deep neural network which further guides predicting strings being passwords or not.
on the other hand considering the multiformity of source code the critical insight is that no matter how the programming language and style change the context of each password i.e.
the surrounding code snippets share similar semantics and structures and thus could be leveraged to determine whether the usage scenario is authentication related or not.
specifically we train the context model to classify the code snippets based on the semantics of program elements methods variables constants etc.
.
figure shows a sample code snippet with the password joe leaked on line .
typically when authenticating with passwords developers have to provide extra information such as identity remote host connection configuration etc.
which constitute the context of the passwords.
combining intrinsic characteristics and context information passfinder can finally identify passwords in source code files.
intuitively our design reflects how a human identifies passwords in source code i.e.
by understanding individual strings and reasoning about the meaning of the context.
essentially compared with existing regular expression based approaches passfinder expands and makes better use of the information sources for detection in a data driven way.
.... htmlemail email new htmlemail email.sethostname smtp.gmail.com email.setcharset utf8 email.setssl true email.setsocketconnectiontimeout email.setauthentication fromaddr gmail.com joe email.setsubject example subject email.setmsg example message .... figure code example based on real leaks we evaluate the approach on our manually labeled ground truth dataset.
the experimental results show that passfinder accurately discovers leaked passwords in source code files with a precision of .
and a recall of .
significantly outperforming existing regular expression based approaches.
armed with passfinder we can harvest passwords from public github repositories on a large scale gaining new insights into the current situation of password leakage.
this paper presents the first comprehensive longitudinal analysis of password leakage on github.
we examine files representing repositories during days from which we identify passwords from .
repositories.
our results indicate that numerous developers on github are faced with a massive threat since data in public github repositories can be accessed by anyone including malicious attackers who use github authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
automated detection of password leakage from public github repositories icse may pittsburgh pa usa as a source for collecting open source intelligence osint .
worse still we investigate the lifecycle of leaked passwords and find that over .
of the passwords remain available in the repositories not being removed within days of being detected which leaves a long window for attacking.
in summary our work makes the following contributions new technique for password detection.
we design and implement a novel technique for automatically detecting passwords in source code.
our approach leverages both intrinsic characteristics of textual passwords and semantic information of program elements to accurately identify the hard coded passwords from code files written in different programming languages.
large scale password leakage analysis.
using our new technique we investigate the password leakage in public github repositories for days.
this is the first large scale systematic study that measures password leakage on github to the best of our knowledge.
we find that thousands of passwords are leaked daily and that the majority of leaked passwords remain available for weeks or longer.
we organize the reminder of this paper as follows we introduce related work of our research in section .
we describe the design of passfinder in section .
we present the implementation and evaluation of passfinder in section .
we report our large scale password leakage analysis in section followed by a discussion in section .
we conclude our paper in section .
related work this section briefly reviews prior research on password security and machine learning on code.
.
password security textual passwords have been ubiquitously used for authentication between end users and computer systems since the 1960s.
to make textual passwords more secure in practical use many password guidelines are proposed by academia and industry .
these guidelines suggest that passwords should be at least eight characters in length should not contain common and easily guessed words should contain multiple character types and ideally be randomly chosen.
despite good faith efforts in the security of their accounts and data users struggle to comply with password creation and management guidelines .
ever since the seminal work by morris et al.
on password cracking researchers have sought to understand how users create their passwords i.e.
the intrinsic characteristics of passwords which could further guide password cracking attacks .
matt et al.
created a probabilistic context free grammar pcfg based upon disclosed passwords and generated word mangling rules automatically which could be used to create password guesses .
wang et al.
performed an empirical study on chinese passwords and improved the pcfg based algorithm to more accurately capture passwords of a monotonically long structure .
ma et al.
developed a novel method using a gram markov model with additive smoothing for modeling english language passwords .
conceptually markov models predict the probability of the nextcharacter in a password based on the previous characters or context characters.
in recent years researchers have proved that deep neural network models have a good performance for modeling the characteristics of passwords .
melicher et al.
constructed a recurrent neural network rnn that outputs the number of guesses likely needed to guess a given password .
hitaj et al.
used deep generative adversarial networks gan to learn the distribution of passwords to generate high quality password guesses .
passfinder also learns the intrinsic characteristics of passwords with a deep neural network model but different from existing work which focuses on password guessing thus using generative models we model the password detection problem as a classification task thus using a discriminative model.
.
learning on big code learning on big code is a new trend since the naturalness of software could be used to assist software engineering and security tasks including identifying code with vulnerability deobfuscation and code summarization among many others .
these approaches analyze large amounts of source code ranging from hundreds to thousands of software projects building machine learning models of source code properties inspired by techniques from natural language processing nlp .
it has been proved that nlp models have the ability to learn both semantics and properties of source code snippets .
nan et al.
utilized nlp techniques to automatically locate the program elements variables methods etc.
of interest in android apks and then performed a learning based program structure analysis to accurately identify those carrying sensitive content to detect privacy leakage on the android platform .
yu et al.
used deep neural network models to extract the semantic information of the binary code for similarity detection .
further they used a deep pyramid convolutional neural network dpcnn and a graph neural network gnn for modeling source code and binary code respectively and achieved binary source code matching at function level .
existing work focuses mainly on one programming language most of which were built on a specific language s abstract syntax tree ast thus lacking the generalization to multiple languages.
in contrast the model used by passfinder applies to different programming languages.
passfinder design detecting hard coded passwords in source code is by no means trivial.
existing heuristic regular expression based approaches perform poorly on both false positives and false negatives especially when it comes to multi million source code files written in different programming languages following diverse programming styles.
in this section we introduce the design of passfinder which addresses the challenges of processing different languages and precisely detects passwords in source code.
.
design overview we model password detection in source code as a discriminative problem.
specifically passfinder inspects each hard coded string to classify it as an ordinary string or a password leveraging both the authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa runhan feng ziyang yan shiyan peng yuanyuan zhang figure design of passfinder intrinsic characteristics of the string sequence and the semantics of the surrounding code snippets i.e.
the context of the string.
figure shows a high level overview of this decomposition.
to empower passfinder with the ability to distinguish between passwords and ordinary strings we train two deep learning models i.e.
the password model and the context model which will be detailed in .
and .
respectively.
intuitively this decomposition reflects how a human identifies a password i.e.
by understanding the individual sequence and reasoning about the meaning of multiple lines.
combining the output of both the models passfinder can finally accurately identify hard coded textual passwords in source code.
the motivation for choosing a learning based approach over e.g.
regular expression based heuristics or static dataflow analysis is three fold.
first deep learning methods have been proved to be capable of performing automatic feature extraction from raw data.
second learning from data retains the possibility of generalizing the approach to multiple languages.
third the models can continuously evolve by re training them with more recent data.
.
extracting candidate passwords given a source code file passfinder firstly preprocesses the whole file by removing non ascii characters.
as for low frequency tokens that cannot contribute to the result of classification i.e.
url and e mail address we replace them with specific tokens url and email respectively.
typically passwords exist in source code in the form of hard coded strings usually wrapped in quotes to distinguish them from other program elements.
therefore we can easily extract hard coded strings precisely with well crafted regular expressions.
note that we focus on strings with the length of to since passwords within this length interval account for the vast majority in previously leaked password datasets .
the exact proportion is .
in the linkedin dataset which will be usedfor training our password model.
besides passfinder filters out strings in the common passwords dictionary because concerning these passwords even human beings who have inspected the context cannot distinguish whether it is an unintentional leakage or the developers deliberately using these common passwords to replace their actual passwords.
the only way to verify the validity of these passwords is to manually use them for authentication which is not allowed in our experiment for ethics problems.
the remaining passwords are considered candidate passwords which will be further inspected by passfinder.
as for each candidate password we also extract the code snippets before and after the line where it is located as the context.
.
modeling the intrinsic characteristics as for a set of strings hard coded in source code files a human observer can tell which strings are more likely to be passwords because the corpus of passwords either human chosen or machinegenerated has a different distribution against ordinary strings used in source code.
intuitively passfinder imitates this ability of human beings.
however such characteristic e.g.
character frequency and order etc.
is hard to model with specific rules.
therefore we use a deep learning model i.e.
the password model to extract the features automatically and further guide prediction.
different from existing work that models only the human chosen passwords to construct a generative model that outputs high quality password guesses in this work we model password detection as a three classification problem.
specifically strings in source code are classified by the password model into human chosen passwords machine generated random passwords and ordinary strings since they follow different distributions.
to train the password model three types of data are needed.
for human chosen passwords we use the previously leaked linkedin authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
automated detection of password leakage from public github repositories icse may pittsburgh pa usa dataset to model.
however after manually scrutinizing the linkedin dataset we find that although the linkedin dataset contains almost exclusively human chosen passwords it still contains a small portion of machine generated random passwords.
we have to filter out these random passwords.
however it is a non trivial task since there is no guaranteed mathematical test for randomness.
similar to previous work we use shannon entropy as an estimator for randomness.
intuitively random passwords should have higher entropy deviating significantly from the dataset s average.
specifically for each password in the linkedin dataset we calculate its entropy and eliminate it if its entropy is more than standard deviations from the mean of all passwords classifying it as an outlier.
then after deduplication we get a human chosen passwords dataset with over million passwords.
as for machine generated random passwords we choose the union of the character sets adopted by popular password managers and use a secure pseudorandom number generator prng to randomly generate million strings with a length between to one million for each length.
concerning the ordinary strings in source code we used hardcoded strings from popular projects on github.
specifically for the ten most popular programming languages used on github we crawled repositories with the most stars for each and got a total of repositories.
we recursively traverse each repository and extract hard coded strings inside.
with all these hard coded strings we can model the distribution of ordinary strings used in practice.
however after manually scrutinizing these popular repositories we find that there exist some hard coded passwords used for testing or demonstration purposes.
based on the observation that these popular repositories usually have an appropriate directory configuration we filter out files that contain test or example in their full path to avoid mixing these dummy passwords into the ordinary strings dataset.
we also filter out strings already in the human chosen passwords dataset to avoid overlapping between datasets.
in total we extract over million unique ordinary strings with a length between to .
finally we have a training dataset that consists of million human chosen passwords million machine generated passwords and million ordinary strings.
although the dataset is not balanced between different categories our password model learns all classes reasonably well see section .
for more details .
as for each string in the training dataset we tokenize it into characters as the basic terms and encode them with one hot encoding.
we train our discriminative model with a text convolution neural network textcnn which is nine layers deep with six convolutional layers and three fully connected layers.
we choose textcnn since it has been proven to be good at extracting local features which is suitable for human chosen passwords which typically consist of sub tokens.
finally our password model will give the probability of strings being human chosen passwords machinegenerated passwords or ordinary strings.
directly using the label with the highest probability as the output is acceptable.
however as for our password model we focus more on precision to alleviate false positives.
therefore we fine tune the threshold for predicting ordinary strings.
finally we set the threshold as .
i.e.
any strings with the probability over .
to be an ordinary string fall into this category.
otherwise same as normal we choose the label with the highest probability as the output.
in this way our password modelachieves a higher precision introducing only a small impact on the model s overall performance.
both those classified as humanchosen and machine generated passwords are taken as positive results i.e.
textual passwords.
.
modeling the context semantics besides the intrinsic characteristics passfinder also inspects the code snippet surrounding each candidate password i.e.
the context to gain more insight about the usage scenario of the candidate password and gives a prediction that whether a code snippet is used for authentication or not.
this can be taken as an essential criterion for judging whether the string is a password.
since there is no available open dataset on the code snippets related to authentication we have to establish a dataset on our own for model training.
for clarity we focus on the ten most popular programming languages on github which account for over in all languages .
these ten languages include javascript python java golang c typescript ruby php c and c. however manually inspecting all newly uploaded files on github to pinpoint code snippets related to authentication is inefficient since code for authentication use occupies only a tiny part of all files.
to improve the effectiveness of collected files and labeling efficiency we filter out non related files with a heuristic method.
the filtering strategy will be detailed in section .
.
we continuously collected candidate files and reviewed all content inside to pinpoint authentication related code snippets for three weeks.
in the labeling process we consider only whether the code snippets are used for authentication even if no actual password leakage occurs.
to guarantee the labeling results correctness we built an inspection team which consisted of two ph.d. students with four master students.
all of them have done intensive research work with software development.
we divided the team into two groups.
each group consisted of a leader and two members.
the leaders reviewed the labeling results from the members.
we only accepted and included code snippets to our dataset when the code snippets received full agreement among the groups.
when a code snippet received different labeling results we hosted a discussion with all six people to decide through voting.
in total we collected code snippets for authentication for each language.
we also selected code snippets for each language that are not related to authentication as negative samples.
the labeling procedure took person hours.
we have made the dataset publicly available for further research .
with the labeled data we can train the context model.
to generalize our context model to files written by different languages we did not laboriously parse the code into corresponding asts which is prevalently used as the input of the deep neural network model in previous work that learns from code .
instead we use the raw source code directly as input relying on the neural network to extract semantics.
like our password model we use the textcnn model on the character level to avoid the out of vocabulary oov phenomena which might weaken the robustness of the models.
we do not use rnn models since it is harder for rnn models to model the dependence on the character level and training rnn models requires more computing resources .
as for the context width i.e.
the number of lines of code snippets used as context we set it as .
in other words passfinder authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa runhan feng ziyang yan shiyan peng yuanyuan zhang extracts code snippets lines before and after the candidate passwords for inspecting.
we made a comparison between the context width ranging from to in our experiment and the context width of achieves the best performance.
.
ensembling models to combine the results of our password model and context model we used model ensembling technology.
specifically we use the majority voting method i.e.
only when the password model and the context model agree will passfinder treat it as a textual password.
specifically as for each candidate password only if the password model predicts it as a human chosen or machinegenerated password and the context model classifies its context as authentication related will it be identified as a textual password.
this is a relatively conservative strategy but it could effectively reduce the false positives.
besides it is relatively easier to deploy since it does not require extra training data.
evaluation of passfinder we evaluate passfinder on different settings and address the following three research questions rq1 how effective are the password model and the context model respectively?
rq2 how effective is passfinder at detecting passwords?
rq3 how effective is the context model in cross language validation?
.
experiment setup we implement passfinder in python.
the deep learning models are implemented with pytorch and scikit learn .
the experiment environment is a core server equipped with a tesla v100 gpu 64gb ram running on ubuntu os with a linux .
.
kernel.
we use grid search as the hyper parameters selection method to obtain the best performance.
the password and context model are trained for and epochs respectively using the adam optimizer with a learning rate of .
.
.
rq1 effectiveness of the models in our evaluation of the password model we divide the dataset collected in section .
into the training set test set and validation set at a ratio of .
we fine tune the hyper parameters on the test set and finally evaluate on the validation set.
as is shown in table on average our password model achieves a precision of .
a recall of .
and an f1 score of .
.
figure shows a confusion matrix of the password model normalized by row.
as we can see the model achieves excellent performance in all three categories.
table performance of the password model precision recall f1 score human chosen .
.
.
random .
.
.
ordinary .
.
.
marco average .
.
.
o h r predicted labelo h rtrue label96.
.
.
.
.
.
.
.
.
.
.
.
.8figure normalized confusion matrix of the password model.
o denotes ordinary strings h denotes humanchosen passwords and r denotes random passwords.
as for the evaluation of the context model we train and test the model on the dataset collected in section .
with fold validation.
for comparison we examine the performance of four widely used text classification approaches including naive bayes nb logistic regression lr k nearest neighbors knn and support vector machine svm .
for these four approaches we consider both camelcase and underscore case naming conventions and split each code snippet into word level tokens with nltk .
to alleviate the influence of word morphology we also perform lemmatization and lowercasing.
after preprocessing we extract the term frequency and inverse document frequent tf idf as feature vectors for each code snippet.
we train and fine tune hyper parameters by a grid search to achieve their best performances.
we assess the classification performance of these four approaches using the same dataset for our context model.
the detailed precision recall and f1 score is shown in figure .
for the context classification task our context model achieves a precision of .
a recall of .
and an f1 score of .
.
overall our context model performs best among all classification approaches.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
cnn lr knn svm naive bayes precision recall f1 score figure performances of different classification methods authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
automated detection of password leakage from public github repositories icse may pittsburgh pa usa table detailed regular expressions from detect secrets which are used for comparison in our experiment.
denylist closing whitespace s ?
quote secret nonwhitespace square brackets .target regular expression example denylist closing ?
whitespace ?
whitespace quote ?
secret password foobar denylist closing ?
whitespace quote ?
secret password foobar denylist closing ?
whitespace quote secret password foobar denylist square brackets ?
optional whitespace optional whitespace ?
secret password foobar denylist closing ?
whitespace whitespace quote ?
secret password foobar denylist closing ?
whitespace whitespace quote secret password foobar denylist nonwhitespace whitespace quote secret password foobar .
rq2 end to end effectiveness end to end ground truth.
to measure how effective passfinder is at detecting passwords in source code we built an endto end ground truth.
specifically we randomly selected files from our candidate files the collection of candidate files will be detailed in section .
we used the same setting as the labeling process for the training dataset of our context model i.e.
we divided the inspection team into two groups each consisted of leader and members for the end to end ground truth.
passwords used for authentication are accepted and included in our ground truth.
as for api keys with a length in the range of to we included them also since they are essentially machine generated passwords and share similar context semantics with passwords.
in total we spent person hours annotating passwords in randomly selected source code files written in ten languages.
we compared passfinder to regular expression based approaches i.e.
the state of the art approaches that apply for multiple programming languages.
the particular patterns used for matching in the regular expression based approaches affect their performance.
therefore we inspected the source code of the most popular tools that claim to be capable of detecting passwords in code to analyze the respective rules used for detection so that we can find the approach with the best performance for comparison.
we finally chose detect secrets from yelp a popular and continuously maintained project with over stars on github as the baseline.
it comes from two reasons.
firstly the regular expressions in detect secrets cover all the patterns supported by the remaining projects.
that means these are the most well crafted regular expressions that can be found in related open source tools.
more importantly it contains many heuristic strategies summarized by the maintainers to filter out false positives making it stand out among all these tools.
we kept these strategies in the comparison.
since detect secrets is designed to detect secrets on a repository basis containing features irrelevant to password detection in our experiment we extracted the code related to password detection from detect secrets commit 488334f and modified it to be consistent with our file based detection workflow with the regex part unchanged.
the specific regular expressions are detailed in table .
as we can see such regular expressions target assignment statements in one line in the source code.
however when encountered a more complex situation where passwords are defined by apis or irregularly organized as is shown in figure regular expression based approaches will fail.
given that no conspicuous patterns exist it is unrealistic to use regular expressions to match all possible situations.
table comparison with the regex based method passfinder regex based detected passwords true positives false positives false negative precision .
.
recall .
.
f1 score .
.
as table shows among the files in the ground truth passfinder reports .
more leaked passwords than the regularexpression based method resulting in a much higher coverage.
this is mainly due to passfinder s in depth modeling for characteristics of human chosen passwords.
besides passfinder has a significantly lower false positive rate than the regular expression based method because our approach analyzes more semantic information.
in contrast due to lacking the ability to deal with the multiformity of source code the regular expression based method has extremely many false positives.
.
.
false positives and false negatives.
the false positive rate is .
.
in most cases this is caused by passfinder erroneously predicting the passwords neighbors such as username database name etc.
which are used together for authentication like passwords since such elements might have a similar distribution as human chosen passwords.
even in some cases the developers use the same database name and passwords which makes it difficult for passfinder to distinguish.
we consider such false alarms as acceptable because such false alarm implies passfinder successfully locates authentication related code and the actual passwords are probable to be identified by passfinder as well.
when it comes to false negatives in many cases it is because the password model fails to correctly classify the hard coded passwords.
with more data used for training the performance of our models will continuously improve.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa runhan feng ziyang yan shiyan peng yuanyuan zhang .
rq3 cross language effectiveness we select code snippets from the ten most popular programming languages on github including javascript python java etc.
for the training of the context model.
to validate whether our approach is generalizable to different languages we iteratively use nine languages for training and the reserving one for testing.
table presents the detailed performance for each language i.e.
the one for testing.
we can see that our context model can also perform well in cross language settings.
performance only slightly declines by .
over average f1 scores.
the result shows that passfinder can learn the common patterns in code snippets written by different languages and be generalized to new languages.
table performance of the cross language effectiveness languages precision recall f1 score php .
.
.
javascript .
.
.
ruby .
.
.
python .
.
.
java .
.
.
c .
.
.
c .
.
.
typescript .
.
.
golang .
.
.
c .
.
.
average .
.
.
large scale password leakage analysis this section reports our empirical study on password leakage from public github repositories.
.
candidate files collection to investigate the password leakage in public github repositories we have to access the content of source code files on github.
a largescale investigation is by no means trivial since it revolves around multi million repositories .
in this work instead of cloning each repository from github and recursively traversing all inside files we leverage the observation that only a tiny fraction of source code files are indeed authentication related leaving numerous files unnecessary to dig.
therefore we firstly collect files of our interest namely candidate files from github and then further inspect the content of the files to determine whether password leakage happens.
generally there are two ways to collect files on github directly with github mirrors like ghtorrent bigquery or with the search api provided by github which supports keywords querying with search qualifiers.
we choose the latter because it can return the latest pushed files indexed by the github search engine i.e.
we can get results in near real time as files are pushed to github.
in contrast github mirrors tend to contain many historical data and are not so frequently updated.
to get files that have a higher chance of containing passwords i.e.
candidate files firstly we have to query github search apiwith keywords.
a naive way is to directly query github api with password related keywords like password pwd etc.
however it could bring many unnecessary indexing results since these keywords are prevalent in source code that implements authenticationrelated features actually not real authentication operations such as user registering.
to avoid such query results to the greatest extent we use the combination of keywords to generate target queries.
specifically as shown in table we select keywords according to different authentication scenes covering e mail service iac and general authentication.
as for the selection of e mail service providers we consider choosing the most popular e mail service since there are numerous providers.
we reference the usage of email service from two leaked datasets i.e.
adobe and csdn and use a weighted sum model to calculate the final proportion of users.
note that csdn is a website for programmers which could give us an insight into the e mail usage among developers.
we use the most popular e mail services including gmail yahoo etc.
which account for .
in the weighted model.
we also add outlook.com and icloud.com which are popular in recent years but not in the leaked dataset for complementary.
with the list of keywords we combine keywords in the category password with keywords in the remaining three categories to generate target queries such as gmail.com password .
the keywords in the password category are collected by inspecting keywords used in existing regex based techniques.
we specify the sort type for querying as indexed so that the github search api returns the most recently indexed results ensuring we receive the latest results.
for clarity we focus on the ten most popular programming languages on github as is detailed in section .
.
we use the language type as a search qualifier to ensure the coverage of our crawling since github search api returns only a maximum of results.
the github api returns a collection of files and their metadata for each query including filename url last modified time etc.
we then perform a content request to get the file s content finally.
we build our file crawling system based on pygithub .
in our crawling process four github api tokens are enough to eliminate the rate limit restrictions on github api.
table keywords used for generating target query category keywords password password passwd pwd secret token auth access e mail gmail.com yahoo.com hotmail.com outlook.com icloud.com qq.com .com .com iac host server ip port general username account during the crawling procedure even with the combination of keywords strategy our target query could still match some files that are not likely to contain passwords.
therefore we also filtered these files based on the file path in the repositories.
we list the keywords we used for filtering in table which could mainly be divided into four categories.
in this way we avoid capturing many forked popular open source projects and third party libraries used in projects.
these keywords were summarized by manually authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
automated detection of password leakage from public github repositories icse may pittsburgh pa usa table the statistics of the large scale analysis language cand.
files cand.
files cand.
repos cand.
repos det.
pwd det.
pwd det.
files det.
files det.
repos det.
repos python .
.
.
.
.
java .
.
.
.
.
javascript .
.
.
.
.
c .
.
.
.
.
typescript .
.
.
.
.
php .
.
.
.
.
golang .
.
.
.
.
c .
.
.
.
.
ruby .
.
.
.
.
c .
.
.
.
.
total one repository may contains different languages we use the number of distinct repositories here.
inspecting the content of files collected by our crawler.
our heuristic filtering strategy effectively filters out non related files allowing us to perform large scale analysis on all files pushed to public github repositories.
table sample keywords used to filter out unrelated files category sample keywords third partysite packages lib include sdk third party 3rdparty plugin vendor external etc.
softwaresymfony openjdk openssl freebsd linux framworks base openwrt jquery jdk etc.
internationalization lang locale i18n zh cn etc.
othersexample github.io test seed mock etc.
the github search api collection began on june and finished on august .
during this period of days we captured distinct candidate files representing repositories.
table shows the distribution statistic of candidate files from different programming languages.
note that the candidate files used for labeling the training dataset for context model and end to end ground truth were collected before the large scale analysis but with the same strategy.
.
landscape as is shown in table passfinder totally discovered passwords in .
files representing .
repositories in days.
on average nearly passwords are leaked per day.
this indicates that such password leakage is indeed pervasive.
table breaks down the total number of leaked passwords by language.
source code files written by python leaked the most passwords followed by php.
among all ten languages the passwordsleaked by most four languages account for .
of all leaks.
this may be caused by the usage scenarios of different programming languages.
.
manual review to further inspect the leaked passwords detected by passfinder we carried out a rigorous manual review of the leakage dataset.
specifically we randomly selected distinct leaks and examined the file and repository containing passwords on the github s website.
sensitivity.
passfinder is able to detect the passwords used for authentication in source code.
however it is not known whether the detected passwords are sensitive or not.
therefore two ph.d. students leaders in previous labeling work inspected each leak to evaluate each leak as sensitive non sensitive or not a password.
specifically we thoroughly examined the context of the passwords and related files in the repositories.
passwords determined to be used only for testing or demonstration are considered non sensitive.
among all detected leaks .
are evaluated as not a password i.e.
false positives of passfinder.
this is consistent with our previous evaluation data.
as for the remaining true positive leaks are sensitive.
therefore we can estimate that the overall sensitivity of our entire data is .
.
this indicates that most of the discovered secrets are sensitive resulting in developers and services at risk of compromise.
authentication scenarios.
we also paid attention to the specific authentication scenarios in the manual review process.
among the sensitive leaks passwords are used for e mail authentication accounting for the most .
.
developers who integrate features involving automating e mail sending may accidentally leave their accounts and passwords in the source code.
the ratio of passwords for iac use including use for database ssh ftp etc.
is .
.
among all these iac leakages we found public hosts ips leaked altogether with the passwords which means the attackers who get the passwords can directly connect to the database without further scouting the deployment information authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa runhan feng ziyang yan shiyan peng yuanyuan zhang of the project if no additional security measures are taken.
there also exist api keys detected by passfinder which do not follow any format.
passfinder can also detect api keys since they are machine generated strings with similar context as password authentication.
we also found wi fi passwords which appeared primarily in c c projects related to iot.
the remaining passwords have different authentication scenarios.
some are used to authenticate to platforms targeted to which the developers develop spiders using tools like selenium.
in some cases the developers authenticate themselves to a remote http server to further carry out automated operations.
also some developers use passwords to request services that deal with captcha and sms etc.
.
repository characteristic popularity.
the popularity of repositories can be characterized with the number of stars forks and watchers.
specifically for each repository that contains passwords we calculated the sum of the number of stars forks and watchers by august .
by this time repositories have been removed from github by the owners.
as for the remaining repositories repositories with no star fork and watcher account for over .
which shows that the vast majority of repositories are unpopular e.g.
probably neglected by all other users except the owners.
however lacking popularity does not mean that the severity of leaks may cause is reduced.
although it is not likely for a curious user to catch such leakage malicious attackers can harvest passwords efficiently as proved in this work.
in a sense such unpopular repositories should be paid more attention since they might contain real world deployed projects.
activeness.
we characterize the activeness of repositories from two dimensions.
one direct dimension is the commit history.
the more commits a repository has the more active it is.
we collected the commit counts for all repositories by august and calculated the cumulative distribution function cdf of the commit counts.
as is shown in figure the commit count of .
repositories is no more than it is a common practice that developers create the initialization commit on the github website and push all files from local which results in commits which means the authors just upload the repositories to github without further maintenance.
over .
repositories are under continuous maintenance with a commit count over .
on the other hand we investigated the existence of the readme file in these repositories since this information implies whether the authors want to promote the repositories or just host them on github.
we found that over one half .
of the repositories have no readme file or have a simple readme file containing only the repository name with a simple description.
this shows that the vast majority of owners are not willing to promote their repositories.
.
password lifetime besides the coverage of password leakage we also tried to characterize the lifetime of these leaked passwords i.e.
after how long would the owners realize the exposure and remove the passwords from public repositories.
we began our monitoring on passwords lifetime since august .
for each leaked password since then we queried github daily to determine if the passwords still existed.
commit counts0.
.
.
.
.
.0cdf of commit countsfigure the cdf of commit counts of different repositories the result of daily monitoring is shown in figure .
as we can see in the first two days the curve drops quickly and .
of the passwords were removed.
then the curve becomes flat.
however after days the passwords were detected less than .
were removed which leaves a long window for attackers.
the proportion of passwords remaining exposed corresponds to api keys leakage in previous work .
further as for the removed leakage we examined whether the users removed their passwords thoroughly i.e.
removed the commits that contain passwords.
after manually inspecting the commit history of repositories that the owners did not delete to our surprise none of these owners rewrote the repository history leaving these passwords still accessible.
.
.
.
.
.
.
.
.
.
16percentage of total still present numbers of days after detectiondaily monitoring of repositories files and passwords after detection repository file password figure password lifetime.
discussion this section discusses ethics consideration mitigations of password leakage problems as well as limitations of our work.
.
ethics consideration in this paper we conducted experiments collecting leaked passwords that revolved public repositories on github that authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
automated detection of password leakage from public github repositories icse may pittsburgh pa usa could have severe consequences if abused.
apart from our search queries our methodology is passive.
all secrets that we collect were already exposed when we find them.
thus this research does not create vulnerabilities where they did not already exist.
furthermore we never attempt to use any of the discovered passwords other than for the analytics in this paper even for innocuous purposes like merely verifying the passwords validity.
it prevents us from obtaining any sensitive proprietary or personal information from the password owners.
as of the camera ready we are currently working to notify vulnerable repository owners of our findings.
.
mitigations we have shown in this work that an attacker with minimal resources could compromise the assets of numerous developers and enterprises by stealing leaked passwords.
we discuss some mitigations for such attacks here.
a naive approach is to impose strict audits for queries to github search api.
if some abnormal behavior is detected github could further block related tokens or accounts.
in this way it would be more difficult for active attackers to harvest passwords from public repositories.
however a motivated attacker could use numerous tokens or accounts to achieve his goal.
such a block strategy could also lead to a decline in common users experience for false positive cases.
what s more this approach does not solve the most fundamental problem.
i.e.
the passwords are still exposed in public github repositories.
it could be noticed by any curious users leaving a security threat for password owners.
the key to thoroughly solving the problem of password leakage is to detect the leakage timely.
github s secret scanning has been proven to be effective in detecting secrets with distinct formats.
we hope github could integrate our detection techniques into secret scanning and instantly alert developers once the password leakage is caught.
in this way the developers could realize the problem.
also we suggest developers use tools such as vault to store secrets.
.
limitations of our work in this section we briefly detail the limitations of our work.
first we do not have ground truth knowledge of whether the passwords we discover are exploitable.
though great efforts were paid to exclude them some passwords may be stale or simply invalid.
without actually testing such passwords which we do not do for ethical reasons it is not possible to have certainty that a secret is exploitable.
second we proved the feasibility of our approach in this paper i.e.
leveraging both intrinsic and contextual characteristics for password detection in source code.
however our two models can continuously evolve with more high quality data used for training as well as more sophisticated algorithms that make better use of collected data.
also our approach can seamlessly be combined with existing methods like regular expression based and entropy based techniques to improve the coverage further.
finally we focus only on password leakage on github in this work.
while github is the largest public code hosting platform many other code hosting services like gitlab or bitbucket.
the leakage in such platforms has not been systematically investigated.
we leave this for future work.
conclusion this paper gives our research on detecting password leakage on github repositories on a large scale.
to address the main challenge that existing approaches cannot effectively identify passwords in source code files we propose passfinder a new technique for automated password detection.
passfinder leverages the intrinsic characteristics of passwords together with the semantic information of code snippet which is authentication related to accurately identify passwords in code files written in different languages.
the evaluation results showed passfinder achieves high precision and outperforms existing heuristic approaches.
using this technique we performed the first large scale and longitudinal analysis of password leakage on github.
our result shows that hundreds of thousands of passwords are leaked at a rate of thousands per day.
our result also highlights the importance of data protection in today s open source ecosystem.