prober practically defending overflows with page protection hongyu liu liu2978 purdue.edu purdue university usaruiqin tian rtian email.wm.edu william mary usa bin ren bren cs.wm.edu william mary usatongping liu tongping umass.edu university of massachusetts amherst usa abstract heap based overflows are still not completely solved even after decades of research.
this paper proposes prober a novel systemaiming to detect and prevent heap overflows in the productionenvironment.
prober leverages a key observation based on theanalysis of dozens of real bugs all heap overflows are related toarrays.
based on this observation prober only focuses on arrayrelatedheapobjects insteadofallheapobjects.proberutilizesstatic analysis to label all susceptible call stacks during the compilation andthenemploysthepageprotectiontodetectanyinvalidaccesses during the runtime.
in addition to this prober integrates multiple existing methodstogether toensure theefficiency of itsdetection.
overall proberintroducesalmostnegligibleperformanceoverhead with .
on average.
prober not only stops possible attacks on time but alsoreports thefaultyinstructions thatcould guidebug fixes.proberisreadyfordeploymentduetoitseffectivenessand low overhead.
ccs concepts softwareanditsengineering automatedstaticanalysis software testing and debugging.
keywords buffer overflow program analysis page protection acm reference format hongyu liu ruiqin tian bin ren and tongpingliu.
.prober practicallydefendingoverflowswithpageprotection.in 35thieee acminternationalconferenceonautomatedsoftwareengineering ase september virtualevent australia.
acm newyork ny usa 13pages.
both authors contributed equally to this work.
this work was initiated and partially conducted while hongyu liu and tongping liu were at the university of texas at san antonio.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe firstpage.copyrights forcomponentsof thisworkowned byothersthan the author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspecificpermission and or a fee.
request permissions from permissions acm.org.
ase september virtual event australia copyright held by the owner author s .
publication rights licensed to acm.
acm isbn ... .
introduction c c applications are prone to memory errors such as buffer overflows including over reads over writes .
buffer overflows will notonlycauseaprogramtocrash butalsocanbeexploitedtoissue securityattacksorcauseinformationleakage .sinceitisnot able to expunge all buffer overflows during development phases highly depending on program inputs significant research has been focused on detecting and preventing buffer overflows dynamically.
among them stack based overflows can be detected with very low overhead less than .
via the shadow stack technique .
but heap basedoverflowsarestillnotsolvedyet sincetheywerestill ranked as top vulnerabilities as shown in table .
table top five vulnerabilities reported in .
vulnerabilities doscode execution overflow xss gain information dynamic detection tools can be further divided into multiple types.
the most common approach is to check the overflow before everymemoryaccess whichcouldstoptheoverflowimmediatelyif amemoryaccessisfoundtoaccessredzonesthatarenotsupposed to be read or written.
existing work such as valgrind dr. memory and addresssanitizer employs this approach but withstatic or dynamicinstrumentation method anddifferent organization of red zones.
however even the state of the art of this type e.g.
addresssanitizer still imposes over performanceoverhead inadditiontoitssignificantmemoryoverhead.therefore this type of approach is only applicable for development phases but not for the production environment.
efficientapproachesexist suchascruiser doubletake heaptherapy or ireplayer .
they detect buffer overflows after the effect typically by checking the evidence of corrupted canaries.
althoughtheyimpose very low overhead generally less than they cannot detect read based overflows because reads do not leave any evidence behind.
also they cannot stop security attackstimely sincethedetectionmayoccurafterexploits.sampler also imposes littleoverhead by only checking sampled