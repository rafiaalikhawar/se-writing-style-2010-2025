a large scale empirical study on vulnerability distribution within projects and the lessons learned bingchang liu liubingchang iie.ac.cn instituteof information engineering chineseacademy of sciencesguozhu meng mengguozhu iie.ac.cn instituteof information engineering chineseacademy of scienceswei zou zouwei iie.ac.cn instituteof information engineering chineseacademy of sciences qi gong gongqi iie.ac.cn instituteof information engineering chineseacademy of sciencesfeng li lifeng iie.ac.cn instituteof information engineering chineseacademy of sciencesmin lin mingo.limz gmail.com institutefornetwork scienceand cyberspace tsinghua university dandan sun sundandan iie.ac.cn instituteof information engineering chineseacademy of scienceswei huo huowei iie.ac.cn instituteof information engineering chineseacademy of scienceschao zhang chaoz tsinghua.edu.cn institutefornetwork scienceand cyberspace tsinghua university abstract the number of vulnerabilities increases rapidly in recent years duetoadvancesinvulnerabilitydiscoverysolutions.itenablesa thorough analysis on the vulnerability distribution and provides support for correlation analysis and prediction of vulnerabilities.
previous research either focuses on analyzing bugs rather than vulnerabilities or only studies general vulnerability distribution among projects rather than the distribution within each project.in this paper we collected a large vulnerability dataset consisting of all known vulnerabilities associated with five representative opensourceprojects byutilizingautomatedcrawlersandspending monthsofmanualefforts.wethenanalyzedthevulnerabilitydistribution within each project over four dimensions including files functions vulnerability types and responsible developers.
basedon the results analysis we presented practical insights on the distribution of vulnerabilities.
finally we applied such insights on several vulnerability discovery solutions including static analysis anddynamicfuzzing andhelpedthemfind10zero dayvulnerabilitiesin target projects showing that our insights are useful.
ccs concepts securityandprivacy softwaresecurityengineering generalandreference empiricalstudies.
also with school of cyber security university of chinese academy of sciences.
corresponding author alsowith beijingnationalresearchcenterforinformationscienceandtechnology permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may23 seoul republic of korea association for computing machinery.
acm isbn ... .
empiricalstudy vulnerability distribution acm reference format bingchangliu guozhumeng weizou qigong fengli minlin dandan sun wei huo and chao zhang.
.
a large scale empirical study on vulnerability distribution within projects and the lessons learned.
in 42ndinternationalconferenceonsoftwareengineering icse may23 seoul republic of korea.
acm new york ny usa pages.
introduction software vulnerability is one of the major threats to cyber security.
for example vulnerabilities like heartbleed sandworm and dirtycow have posed great risks on millions ofusers.duetorecentadvancesofmodernvulnerabilityhunters e.g.
afl aflgo steelix collafl vulnerabilities are being reported at a striking speed.
the number of exposed vulnerabilities recorded by national vulnerability database nvd already exceeds forty thousands let alone the vulnerabilitieswhichremainunknowntothepublic.thislargevolume enables a thorough analysis of vulnerability distribution and providessupportforcorrelationanalysisofvulnerabilities which in turn helps finding new vulnerabilities.
for instance as shown in figure we found new vulnerabilities markedas nvx whenstudyingsomeexistingvulnerabilities marked as msxx i nmicrosoft windows journal .
we figure out that allthesenewvulnerabilitiesareclosetoexistingvulnerabilities markedas msxx inthecallgraph.someofthemevenreside in the same functions as existing vulnerabilities or have similar code snippets.
it therefore implies that vulnerabilities in a project could have locality in space e.g.
function locations and patterns e.g.
codestructures andsuchlocalitycouldbeutilizedtolocate new vulnerabilities around known vulnerabilities in the project.
motivatedbythis example weintendto analyzethevulnerability ieee acm 42nd international conference on software engineering icse icse may seoul republic of korea bingchang liu guozhu meng wei zou qi gong feng li min lin dandan sun wei huo and chao zhang decompbitstoemfstream cepemrin ate emrprocess cepemrin ate emrbltin ate creadptck2rgb init ptcdecinit ptcdecode sub 1dd78641decode stripewrite bitmap rowms15 ms13 ms15 ms15 ms14 038nv1 nv2 nv3 nv4 nv5 figure1 areal worldexample vulnerabilitieshaveastrong correlationwhichcouldhelp findingnew vulnerabilities.
distributionwithinprojects inorderto investigateifsuchvulnerabilitylocalityiscommoninindividualprojects.ifso wefurther intendtoinvestigatewhethersuchlocalitycouldbeutilizedtofind new vulnerabilities around known vulnerabilities.
priorworks havestudiedalargenumber ofbugsandprovidedinsightsforbetterunderstandingthedistributionandrootcauses ofbugs.theseinsightsarefurtherutilized to detect more related bugs .
however these approaches and insights of bugs cannot be well shifted to vulnerabilities since vulnerabilitiesexhibitmanydifferentcharacteristicsfrombugs.for instance vulnerabilities are much more rare than bugs.
anotherline of works concentrate on utilizing individual features of vulnerabilities e.g.
function calls and code complexity topredictnewvulnerabilities.someotherworks focus on studying the life cycle of vulnerabilities and how to fix them.thework studiedthevulnerabilitydistributionacross projects.
however existing works did not study the vulnerabil ity distribution within projects and thus are not able to analyze vulnerabilitylocality in individual projects.
to study vulnerability distribution within projects there are several challenges to address.
first there are no qualified datasets available fora largescale analysis.existing vulnerabilitydatasets focus on covering diversified projects but not all vulnerabilitiesfor a given set of projects.
second a large scale data analysis is time consumingand in general challenging.
inthiswork wemakeafirstattempttostudythedistribution of and correlation between vulnerabilities within projects on a largescale.weselect5typicalopen sourceprojects linux kernel ffmpeg imagemagick openssl and php src as the analysis objects.
for each project we collected all its associated vulnerabilitiesbyaggregatingmultipledatasources includingnvdentries bugzilla reports security bulletins and github commits.
we then attemptto answer the following questions rq1 vulnerability distribution.
how are vulnerabilities distributed?
can it be used for hunting new vulnerabilities?
rq2 vulnerability dependency.
why are vulnerabilities oftentimesfoundwithinashortcoderange?isthereanydependencybetween vulnerabilities?
rq3 vulnerability recurrence.
whydovulnerabilitiesrepeatedly occur in the same function?
is it a general case?
to this end we analyze the collected vulnerability dataset as follows.wefirstassociateeachvulnerabilitywithitsresponsible code commits then localize the vulnerable code snippets related to each vulnerability and then build the call graph for the vulnerable code snippets.
further based on the extracted information we analyzethevulnerabilitydistributionoverspace type andresponsibledevelopers aswellasthedependencybetweenvulnerabilitiesin the call graphand the vulnerabilityrecurrence phenomena.
wefindthat thevulnerabilitydistributionfollowsthepareto law on the dimension of space file not function type and responsibledevelopers.moreover most morethan60 vulnerable functionshaveat leastonevulnerableneighborfunctionlocated in a jump rangein the call graph.
in other words most vulnerable functions do not exist alone.
we also find that incomplete or wrong patches for vulnerabilities are the most common reasons for the existence of high frequency vulnerable functions whereas the patching workflow ropo report one issue and patch one position based on the reference poc is another important reason.
in summary we make the following contributions.
large scalevulnerability dataset.
aiming at studying the vulnerability distribution within projects we spent person months effortstobuildalargest to datevulnerabilitydatasetregardinga set of open source projects.
we share this dataset to the public1 to facilitate other researches.
thorough empirical study.
different from the prior work our study unveils the characteristics of vulnerability distribution overseveraldimensionsincludingfile function typeandresponsibledevelopers.moreover wealsoinvestigatethecorrelationof vulnerabilitiesso as to uncover the causes of their presence.
practical insights.
we present several practical insights based on theanalysisresults.inparticular wefindthatmostvulnerabilities do not exist alone.
we also find that imperfect vulnerability patchesandthepatchingworkflowropoaregeneralphenomena causingvulnerabilities repeatedlyoccur insome functions.
we also propose a solution to mitigate the ropo issue.
newdiscoveries.basedontheconcludedinsights weproposea solutiontousethemtoguidevulnerabilitydiscovery andhaveapplied them to several vulnerability discovery solutions including static analysis and dynamic fuzzing and help them successfully find10 zero day vulnerabilities in target projects.
approach figure2presentstheoverviewoftheapproachweusedinthis empiricalstudy.first weselectseveralpopularopensourceprojects thatrepresentvaryingfunctionalities.then weaggregatemultiple vulnerability data sources including nvd cve and bugzilla to collectalldescriptioninformationofvulnerabilitiesassociatedwith targetprojects.wealsocrawlallcodecommitsoftargetprojects from github to support detailed vulnerability analysis.
further weanalyzetherelationshipbetweennvd cvevulnerabilityentriesandgithubcommits torecognizethecommitsrelatedtoeachvulnerability.then welocalizethevulnerablecodesnippets and construct their call graphs.
at last we perform multiple analysesonthesevulnerabilitiesandconcludemanytake homemessages for future research.
moreover we develop proof of concepts based on these findings to evaluate their practicality.
.
target selection we select popular open source projects written in c c language as our analysis object ffmpeg imagemagick openssl php src andlinuxkernel .ononehand these 1548a large scale empirical study on vulnerability distribution within projects and the lessons learned icse may seoul republic of korea figure the overview of the empirical study table statistics of our dataset including the number of stars forks and commits of each project obtained from github and the number of associated cve entries in nvd as well as the number of vulnerabilities in our dataset in cludingthosewith cveidsandwithoutcveids.
vulnerabilities in our datasetproject stars forks commits cvewith cve w ocve total ffmpeg imagemagick openssl php src 426linux total projects span a wide range of functionalities.
ffmpeg is a multimediaframework imagemagickisarepresentativeraster vector image file processing software suite openssl is an implementation of secure communication protocols php src is the official interpreter for php language and linux kernel is one operating system.thediversityintuitivelyinvolvesdevelopersofdifferent fieldsandvaryingprogrammingstyles.therefore moretypesof vulnerabilitiescanbecovered.ontheotherhand everyprojecthas at least hundreds of cve entries in nvd as shown in table .
notoriousvulnerabilitieslikeimagetragick dirtycow andheartbleed are all discovered in these projects.
.
data collection toobtainsufficientandcomprehensiveinformationforvulnerabilities we collect code commits from github and vulnerability entires from nvd cve for each project.code commits .wescrapeallcommitsfromtheselectedgithub projectswithanimplementedwebcrawlerin8 locofpython.
the crawlerleverages github developer apis and downloads changed code issues pull requests and responsible developers for eachcommit.toreducethedatavolume wesetupacrawlrulethatfiltersoutthecommitswithoutmakinganysemantic awarechange.morespecifically thechangestoconfigurationfiles codecomments and spacing are not substantially related to vulnerabilities and therebynotembodiedinourdataset.afterapplyingthisrule we get a total of commits as shown in table .
vulnerability entries .
it is not always about security when a developer makes a commit to the project.
functionality update performanceoptimization andsoftwarerefactoringareallpossible reasons.
as such we have to first identify vulnerability related commits before the evaluation.
to this end we resort to nvd and cve which maintain a large corpus of vulnerabilities andrecognizetherealvulnerability relatedcommits.notallcve entriesareusefulinthistask sowerestricttheentriesbyspecifyingthe vendors and products.
for example ffmpeg vulnerabilities canbedistilledbysearchingtheentrieswiththeproduct ffmpeg and vendor ffmpeg .
in this way cve entries are obtained.
.
human involved analysis there areseveral tasks requiringprofessionals involvement as indicated in figure .
in this study we recruited security experts all of whomhave more than year experience invulnerability research.intotal theyhavefounddozensofunknownvulnerabilities inbothclose open sourcesoftware andmorethan30vulnerabilities have been assigned with cve identifiers.
one of them was even listed in the msrc top security researchers.
cooperation.
to ensure the correctness of the manual analysis results we employ a customized peer review process.
at first each taskisanalyzedbytwoexperts.thetaskfinishediftheycouldreach an agreement.
otherwise the third expert is involved to resolve thedivergence.ifshe heagreeswitheitheroneoftheprevioustwo experts thenwefollowthesimplemajorityruletoyieldthefinal analysisresult.intheworstcase threeexpertsreportthreedifferentresults thenwefollowaconservativeprincipletoresolvetheissue.
more specifically three experts will discuss together and yield a conservative result.
take the cwe labelling task as an example given a cve vulnerability if three experts report three different cwelabels thenageneralizedcwelabelwhichcoversthemor an unknown label will be yielded as the final result.
.
data processing asfigure2shows weprocessthecollecteddatainthreesteps association analysis vulnerability localization andvcg vulnerability callgraph construction.
they are detailed as follows.
.
.
association analysis.
we first try to associate cve entries withresponsiblecommits.ifonecommitisfoundcontributingto acveentry weregarditasavulnerability relatedcommit.note that cve entries in the nvd cve database often have