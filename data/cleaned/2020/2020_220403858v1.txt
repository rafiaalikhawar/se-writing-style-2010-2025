egen an energy saving modeling language and code generator for location sensing of mobile apps kowndinya boyalakuntla indian institute of technology tirupati india marimuthu c national institute of technology karnataka india sridhar chimalakonda indian institute of technology tirupati india k. chandrasekaran national institute of technology karnataka india the demand for reducing the energy consumption of location based applications has increased in recent years.
the abnormal battery draining behavior of gps makes it difficult for the developers to decide on battery optimization during the development phase directly.
it will reduce the burden on developers if battery saving strategies are considered early and relevant battery aware code is generated from the design phase artifacts.
therefore we aim to develop tool support egen to specify and create native location based mobile apps.
egen consists of domain specific modeling language dsml and a code generator for location sensing.
it is developed using xtext and xtend as an eclipse plug in and currently it supports native android apps.
egen is evaluated through controlled experiments by instrumenting the generated code in five location based open source android applications.
the experimental results show .
minutes of average gps reduction per hour and ma of average reduction in battery consumption while showing only meters degrade in location accuracy over kilometers of a cycling path.
hence we believe that code generated by egen would help developers to balance between energy and accuracy requirements of location based applications.
the source code documentation tool demo video1 and tool installation video2are available at keywords domain specific language code generator energy saving location sensing modeling adaptive strategies mobile apps introduction in recent years software energy consumption is becoming a critical non functional requirement for software developers .
the investigations by pinto and castor and manotas et al .
highlight the significance of reducing software energy consumption.
especially in the mobile application domain reducing the abnormal energy consumption is a concern for both users and developers.
cruz and abreu have performed an empirical evaluation on six popular android applications namely loop habit tracker gnucash and so on to find performance related code smells that cause heavy battery depletion.
they reported that smartphone s battery life can be extended upto an hour if apps are developed by implementing energy aware practices.
this motivates the need for further research towards making energy efficient mobile applications.
research efforts were initially focused on energy measurement energy profiling and energy bugs identification .
of late the focus has been shifted to energy saving solutions and automated repairing of energy bugs .
recently the research community has provided several frameworks 2part1 of installation at and part2 of installation at authors addresses kowndinya boyalakuntla indian institute of technology tirupati settipalli post tirupati india cs17b032 iittp.ac.in marimuthu c national institute of technology karnataka surathkal mangalore india cs15fv08.muthu nitk.edu.in sridhar chimalakonda indian institute of technology tirupati settipalli post tirupati india ch iittp.ac.in k. chandrasekaran national institute of technology karnataka surathkal mangalore india kchnitk ieee.org.
manuscript submitted to acm 1arxiv .03858v1 apr kowndinya and marimuthu et al.
to reduce energy consumption of android apps.
notably the research work by georgiou et al .
highlights the list of techniques and tools to adopt in the software development life cycle to improve energy efficiency.
the energy bugs are induced in the mobile domain by the usage of energy hungry components such as gps gpu camera gyroscope and other smartphone sensors .
notably the energy consumed by location based apps may drain the mobile battery quickly if gps is not appropriately handled by the deveopers .
huang et al .
discussed about the transformative evolution of location based services in mobile applications ranging from navigation health care and social networking to assistive technologies and disaster management.
the ubiquitous presence of location based apps makes the creation of gps efficient patterns even more challenging .
to ease out developers challenges in reducing gps consumption a potential strategy is to consider energy saving decisions during the design phase of software development.
in addition it is important to enable provision for developers to consider energy saving decisions independent of the location sensing libraries and code patterns.
the existing approaches primarily consider energy saving solutions at source code level .
however they do not consider energy saving strategies during early stages of software development such as design which might help developers handle energy related problems.
hence an appropriate tool support to consider energy saving solutions at design time could help developers handle energy related problems more clearly.
in addition automatically generating suitable battery aware code from design phase artifacts might increase the developer s productivity.
to the best of our knowledge tool support for considering energy bugs related to location based apps at the design phase is not widely investigated in the literature.
therefore in this paper we aim at investigating the possibility of having tool support for reducing the battery consumption of location based smartphone applications.
therefore we aim to develop a tool egen that consists of dsml and code generator for location based android applications.
the contributions of this paper are three fold a textual domain specific modeling language dsml for creating battery aware and self adaptive energy saving location sensing strategies.
a code generator to generate the native battery aware java code from self adaptive energy saving location sensing strategies.
controlled experiment based evaluation of the egen generated code on five open source location based android applications where egen s adaptive code produced a savings of 188ma in battery and .
minute reduction in gps usage per hour at the expense of meters degrade in accuracy over a distance of meters.
we have done evaluation through egen and non egen versions.
egen is designed to consider the impact of different context information such as battery charging state battery level foreground or background app execution and sensing interval on energy saving.
further the code generator of egen generates the java code that could be added to the existing android repositories to make them battery aware.
egen is developed using xtext and xtend as an eclipse plugin.
the xtext is used to define the language elements and xtendis used to define the code generator.
egen currently supports the android platform and covers the battery manager api fused location provider client and manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps android activity life cycle .
in future we aim to support the ios platform as well.
the source code of egen is available on github3as an open source repository for others to use.
the efficacy of egen has been evaluated through controlled experiments.
we have selected five opensource android applications that primarily use the location for its operation.
we have used dsml of egen to specify self adaptive location sensing for all subject applications.
the code generated using egen has been instrumented to the subject application to check the improvements in energy saving.
the controlled experiments were conducted on egen and non egen versions of the subject applications.
the google battery historian was used to estimate the gps active time and battery consumption.
the experiment results show that egen provides the ability to specify self adaptive location sensing strategies.
in addition the code generator can generate java code that can be instrumented to the existing apps without affecting its existing functionalities.
the subject applications were instrumented using the generated code and executed on nokia c34smartphone running on android platform.
overall the egen version of the subject application shows reduction of .
minutes in gps active time and ma in battery consumption.
as observed from the results egen generated code show reduced battery usage and negligible accuracy degradation showing initial promise and the need for further research.
the rest of the paper is organized as follows we provide the necessary background information about location based apps along with a motivating scenario in section .
section presents the complete description ofegen s design which is then followed by tool evaluation in section .
threats to validity and related work are discussed in sections and respectively.
finally with pointers to the future work the paper is concluded in section .
background and motivating example this section presents the background information about the location based application the need for selfadaptive location sensing and a motivating example.
.
location based applications user location is important context information to provide location based services to smartphone users.
smartphone users widely use location based services lbs for map navigation discovering nearest places of interest activity or mobility tracking trajectory monitoring location based social networking games advertisement and weather forecasting .
new generation smartphones can handle all types of location based services with their rich hardware and software capabilities .
the smartphones are equipped with gps wifi cell id accelerometer magnetometer barometer gyroscope to position the users current location.
global positioning system gps is widely used to locate the current location of the user.
gps provides high accuracy of user location compared to other location sensing techniques such as wifi positioning and cell id based positioning .
one downside of gps is its abnormal amount of energy consumption for its operation .
therefore gps usage must be reduced to extend the smartphone s battery life.
unfortunately gps usage is a inevitable requirement in map navigation activity tracking and trajectory monitoring applications.
manuscript submitted to acm4 kowndinya and marimuthu et al.
the following strategies were found in the literature to address the abnormal battery draining issues of gps gps alternatives movement detection collaborative strategies and adaptive strategies.
gps alternatives related research efforts use the energy efficient alternatives such as cell id sequencing matching gsm positioning and wifi based positioning .
these approaches are affected by poor location accuracy which is not suitable for continuous location sensing.
the research efforts undermovement detection category includes approaches such as scheduling of location updates turning off gps when not available and postponing gps updates .
these approaches either turn off the gps updates or delay them by combining inertial sensors like accelerometer compass gyroscope barometer etc.
incollaborative strategies the location coordinates are fetched from the other location based apps or neighboring devices .
inadaptive strategies several research efforts uses energy accuracy requirements indoor outdoor detection and context information to dynamically switch between location sources.
these adaptive strategies dynamically select a suitable location strategy based on the dynamic accuracy and energy requirements.
adaptive strategies are better approaches than other approaches as they consider balancing energy and accuracy requirements of location based services.
as reported in fonseca et al .
dynamic adaptability could be one of the important practices to improve software energy efficiency.
therefore introducing dynamic adaptability in existing location based services would reduce the abnormal battery consumption while satisfying accuracy requirements.
nonetheless developing such self adaptive behavior is a difficult task for the developers as it has to deal with a dynamically changing environment.
in particular identifying relevant context information for energy saving at run time is not a straightforward task .
on the other hand few researchers have proposed generic solutions to address energy efficiency issues of android applications by combining self adaptivity and battery awareness.
in this paper we have investigated the impact of a concept called self adaptive location sensing by combining dynamic adaptability andbattery awareness .
the fundamental idea of selfadaptive location sensing is to enforce energy saving policies in the following situations when the battery is discharging and the battery level is critical when the app is in the background.
.
a motivating example this subsection presents the need for self adaptive location sensing through an android application named speedometer5.
it calculates the vehicle speed on a real time basis using gps.
this application uses system location service and requests for location updates for a specific sensing interval.
as highlighted in figure the speedometer app uses fixed sensing interval.
the sensing interval time gap between two location calls plays a significant role in the battery consumption by gps.
the lesser the sensing interval results in higher location accuracy and more battery consumption.
in the case of speedometer app the sensing interval is maintained less and fixed for more accuracy.
this usage scenario is suitable when the battery level is high and connected to the charger.
the fixed sensing interval might deplete the battery quickly if the battery is discharging.
the quick battery discharge problem could be addressed by increasing the sensing interval.
however the location accuracy might degrade if the sensing interval is increased randomly.
hence the sensing interval must be made adaptive in response to the change in battery level to balance location accuracy and battery consumption requirements.
we have experimented with a speedometer app to manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps fig.
.
static location sensing fig.
.
self adaptive location sensing calculate the gps active time battery consumption and distance measured.
as shown in figure the original speedometer app shows ms of gps active timehr .
ma battery consumption and m estimated distance.
to illustrate the efficacy of self adaptive location sensing we instrumented the speedometer app source code to make it battery aware.
in figure the lines of code inside the dashed red box represent the self adaptive code added to the original version of the speedometer app.
predominantly the function batterythresholdpoints takes the battery thresholds as high medium low depending on the remaining battery level.
the functions adaptationpolicy h d fdetermine the dynamic sensing interval by considering the base sensing interval and decreasing factor.
here hrefers to the battery state high d refers to battery status discharging frefers to the application state foreground .
in figure the arrow points to the function returnlevel calculates the dynamic location sensing interval based on the context values.
we have also defined other functions adaptationpolicy m d fandadaptationpolicy l d f to calculate suitable sensing interval based on the current battery level and app state.
as shown in figure the self adaptive location sensing significantly reduces the battery consumption .
ma compared to the original app with static sensing interval.
on the other hand it is observed that the accuracy degrade only meters which is a consequence of reduced gps active time per hour.
the results show that the self adaptive location sensing might help developers reduce significant battery consumption by increasing the sensing interval with lesser degrade in accuracy.
we have carefully selected the self adaptive location sensing policies as battery and location accuracy requirements are conflicting.
specifically the impact of battery level drop and sensing interval increasing rate for each battery drop plays a significant role in determining energy saving adaptation policies.
since this approach involves handling multiple context information such as battery level battery charging state and sensing interval increasing factor it might be wiser to decide the sensing policies before the development phase.
hence there is a need for a suitable methodology and tool support to analyze application requirements and define appropriate energy saving location sensing policies.
therefore this paper aims to present domain specific language support to define location sensing policies before development.
in addition we aim to provide a code generator that the developers may use to introduce battery awareness.
manuscript submitted to acm6 kowndinya and marimuthu et al.
fig.
.
results of self adaptive and non self adaptive versions 3egen design and development with this paper we would like to address the following questions what factors influence battery consumption and how to fine tune those factors?
how to make battery aware decisions during design time?
how to plug battery aware adaptation into an existing android application?
our attempt towards answering all the above questions is the egen framework.
this section presents the overview grammar definition and language elements of dsml developed as part of egen.
.
overview the essential idea of energy saving in location sensing is to enforce energy saving policies in the following situations when the battery is discharging and the battery level is critical when the app is in the background.
therefore egen is designed to assign values for critical battery level and sensing interval based on the application requirements.
egen consists of a domain specific modeling language and automatic code generator.
it has been developed with the help of xtext and xtend .
as shown in figure the usage of egen consists of seven steps step the eclipse editor is used to specify the energy saving location sensing policies using the textual domain specific modeling language.
step the editor creates the .egenmodel.
step thevalidator module of xtextchecks the .egenmodel whether it is following the egen dsml grammar.
step the code generator takes the validated .egenmodel as the input.
step it then generates the java code using model to text transformation.
step the generated code can be added to existing android applications to make it energy aware.
manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps fig.
.
egen eco system step the updated android project can be built and installed on the android device by the user.
.
.
domain model.
as shown in listing the domain model contains the entities adaptationpolicy context feature .
entity adaptationpolicy policyid context adaptation entity context batterystate charging discharging batterylevel low medium high applicationstate foreground background entity feature sensinginterval decreasingfactor batteryawarefunction listing .
domain model for modeling location sensing theadaptationpolicy refers to the self adaptive energy saving location sensing strategies.
it can be defined with the combination of context andfeature.
the entity context refers to the contextual situation suitable for enabling energy saving self adaptation.
the context information includes batterystate batterylevel andapplicationstate .
the batterylevel refers to the amount of battery in left in the smartphone.
the batterystate refers to the charging or discharging status of the smartphone.
the applicationstate refers to the background or foreground execution of the application.
the entity feature includes sensinginterval decreasingfactor and batteryawarefunction .
manuscript submitted to acm8 kowndinya and marimuthu et al.
thesensinginterval refers to the time difference between two subsequent location sensing requests.
the decreasingfactor refers to the numerical value that will be used to calculate the sensing interval for each battery drop in the exponential battery aware function.
the batteryawarefunction refers to the type of change exponential or linear in fixing the sensing interval.
this domain model is used as a basis for defining the grammar of the dsml which is part of egen.
.
dsml grammar this subsection describes the egen grammar along with the structure of the language elements such as features context and adaptationpolicy .
.
.
allowed features.
thefeature element of egen is used to define the application requirements that affect the battery consumption of smartphone devices.
especially in location based services the features likelocation sensing interval and type of change in sensing interval play a significant role in deciding the self adaptive location sensing strategies.
listing .
structure of the features values features sensinginterval decreasing factor batteryawarefunction as shown in listing egen allows following features for specifying energy aware requirements sensinginterval refers to the time difference between two subsequent location sensing requests.
decreasingfactor refers to the numerical value that will be used to calculate the sensing interval for each battery drop in the exponential battery aware function.
batteryawarefunction refers to the type of change exponential or linear in fixing the sensing interval.
.
.
feature definition.
each feature can have their own rules for defining the corresponding values as shown in listing .
the rules for defining feature values are given below the definition of location sensing interval starts with the keyword sensinginterval and can be assigned with an integervalue refer lines in listing .
here the sensinginterval must be assigned in milliseconds.
the definition of decreasing factor starts with the keyword decreasingfactor and can be assigned with the integervalue refer lines in listing as decided by the domain analyst.
the definition of a type of battery aware function starts with defining the value for keyword batteryawarefunction andcanbeassignedwithoneofthefollowingfixedvalues linear exponential referlines in listing .
manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps listing .
structure of feature definition sensinginterval sensinginterval ivalue myint t decreasingfactor decreasingfactor ivalue myint t batteryawarefunction batteryawarefunction value exponential linear .
.
allowed context.
thecontext element of egen is used to define the valid situations to enforce self adaptive energy saving policies of smartphone applications.
for location based services the following context is considered in egen remaining battery percentage charging state of the device and state of the application .
listing .
structure of the context values context batterystate batterylevel appstate threshold medium threshold high as shown in listing egen allows following context for specifying energy saving situations batterystate refers to the charging or discharging status of the smartphone.
batterylevel refers to the remaining battery percentage of the smartphone.
further the context threshold highandthreshold medium is used to define the high and medium battery percentage for triggering self adaptive behavior.
applicationstate refers to the background or foreground execution status of the application.
.
.
context definition.
according to egen grammar the definition of each allowed context can have its pre defined values and domain analyst defined values.
listing .
structure of the context constraints batterystate batterystate value charging discharging batterylevel batterylevel value high medium low threshold high threshold high ivalue myint t threshold medium threshold medium ivalue myint t appstate appstate value foreground background as shown in listing the rules for specifying context values are given below the definition of charging state of the device starts with the keyword batterystate and can have one of the following values charging discharging referlines in listing .
the definition of remaining battery level starts with the keyword batterylevel and can have any one of the following values high medium low referlines in listing .
the values for highand medium can be assigned with an integer value based on the application requirements refer lines in listing .
the value lowwill be inferred by the code generator script based on the range given for highandmedium .
manuscript submitted to acm10 kowndinya and marimuthu et al.
the definition of application execution state starts with the keyword appstate and can have any one of the following values foreground background referlines in listing .
listing .
structure of the adaptation policy model egen adaptationpolicy adaptationpolicy adaptationpolicy ivalue myint t condition situation1 context and value situation2 situation2 block situation3 then adaptation featureblock1 features and value featureblock2 situation3 context context and value situation4 situation4 context context and value situation5 situation5 context context and value context featureblock2 feature2 features and value features .
.
adaptation policy.
according to egen grammar the definition of adaptation policy consists of assigning fivecontexts andthree features .
the specification of a self adaptive location sensing policy can have one or more entries differentiated with a unique id.
as shown in listing a single adaptation policy definition contains following parts starts with the keyword adaptationpolicy to describe an adaptation policy followed by the unique id of type integer referlines in listing .
an opening brace for adaptation policy definition a keyword condition to describe the allowed context changes that trigger the self adaptation an opening brace for context block definition five condition definition each consists of context assigned with allowed values.
the description of context values is given in listing .
here the context definition can be in any order.
however the repetition of context information is not allowed inside the same context block.
multiple valid contexts can be separated by the keyword condition .
a closing brace for context block a keyword adaptation to describe the corresponding set of features to be executed at run time for the contextual changes described with the keyword condition .
an opening brace for a feature block three feature definition each consists of features assigned with allowed values.
the description of feature definition is given in listing .
here the feature definition can be in any order.
however the repetition of feature information is not allowed inside the same feature block.
multiple adaptations can be separated by the keyword condition .
a closing brace for a feature block finally a closing brace for adaptation policy manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps11 fig.
.
a sample .egen model and the generated code .
code generator the code generator uses the following android apis to achieve self adaptation battery manager api fused location api and android activity life cycle .
the code generator is defined by mapping each element in theegen dsml to a corresponding android library.
the batterymanager class is used to fetch the batterystate batterylevel oftheandroiddevicethroughvariables battery property capacity and battery property status .
the application s status is identified using the android activity lifecycle onstart onresume onpause .
as shown in the figure the code generator creates java files mainactivity.java locationutility.java batteryaware.java andadaptationutility.java that contains the artifacts for the self adaptive locationsensing.batteryaware.java is the file that does the adaptive location sensing activity.
mainactivity extends thebatteryaware activity and fetches the location coordinates from the function onlocationupdate defined in the batteryaware class.
the application developers can modify mainactivity.java to write their business logic.
the file adaptationutility.java contains the code that alters the sensing interval based on the context provided.
the battery state defined in the egenmodel is verified against the charging status obtained from thebatterymanager api.locationutility.java contains the code that does the location fetching activity as per the sensing interval interval captured in the adaptationutility.java .
the generated code can be appended to the existing android projects to make their app self adaptive for location sensing.
evaluation of egen in this section we evaluate the effectiveness of egen at reducing the battery consumption of open source location based android applications.
the code generated by egen has been instrumented to the subject applications to show its efficacy.
we call our evaluation controlled experiments as the test smartphone s battery is only subjected to the application being monitored and some mandatory operating internal services which will use battery all the time eg.
screen operating system .
all other apps or services that can be manuscript submitted to acm12 kowndinya and marimuthu et al.
table .
list of subject applications s.no app name play store f droid github url gps logger available not available osm tracker available not available runner up available available opentracks available available kinetie speedometer available not available uninstalled or stopped have been stopped.
this experimental setup enabled us to avoid skewed results and lead us to better investigate the effects of using egen s adaptive code on battery and gps consumption.
in literature several studies have used controlled experiments to evaluate the effectiveness of tool support.
hence we have designed a controlled experiments based empirical study to evaluate the effectiveness of egen.
hence we have designed a controlled experiments based empirical study to evaluate the effectiveness of egen.
.
study design the study was conducted to answer the following research questions rq1 does code generated by egen reduce gps usage?
rq2 how much battery consumption is reduced by code generated from egen?
rq3 to what extent code generated by egen degrade location accuracy?
as the main objective of this study is to analyze the effectiveness of egen on balancing energy accuracy requirements the relevant independent and dependant variables are selected as follows independent variable thebattery drain has been selected as a primary independent variable as location sensing reduces the battery over time based on the gps usage.
dependent variables in this study we have selected the variables sensing interval gps usage battery drop rate and distance covered as dependent variables.
these variables are directly affected by every drop in battery percentage as specified in the adaptation policy.
.
.
subject application selection.
we have used f droid6and google play store7to find out the subject applications.
specifically we have searched for relevant apps with keywords such as gps logging distance measurement path tracker location service speed meter location share live location tracking etc .
finally we have selected the android applications that primarily rely on gps for their operation.
we have considered apps if it is open source and the source code is available on code sharing platforms like github8.
the following inclusion criteria were applied to filter the relevant subject applications if the app is written in native android code if gps is primarily used for location sensing if the source code repository published with an open source license if the recent most commit is published less than two years if the repository is well documented manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps13 table .
github repository profile of subject applications s.no app name contributors stars forks gpslogger osmtracker runnerup opentracks 5kinetie speedometer we found candidate applications by applying the above mentioned inclusion criteria.
further the following exclusion criteria were applied on the candidate applications if the app s android support plugin is incompatible with our intellij idea version.
if the app has missing dependencies or other build errors if it is not compatible with recent versions of android such as .
or .
if the app activity crashes while installing and using the android application we applied the exclusion criteria as mentioned above and removed the apps that satisfy at least one criteria.
finally we found fivesubject applications that are suitable for instrumentation and conducting controlled experiments.
table shows the list of subject applications and their availability on google play store f droid and github.
table shows the demographic data gathered from the source code repository like github.
each of the subject applications except kinetie speedometer have at least contributors stars and forks.
we have chosen kinetie speedometer to verify the usefulness of egen generated for applications that do not rely on other position sensing sensors.
.
.
investigation of subject applications and writing adaptation polices.
the first and second authors have investigated the subject application s source code to identify the modules responsible for location listeners.
we have looked for the location api sensing interval and support for battery awareness.
the subject applications used static sensing intervals and became a candidate for introducing self adaptive location sensing.
apart from other utility files each of the subject application contained location listeners and files detailing track information to the user.
these were the files involved in code instrumentation while apps used different location manager apis the relaxation time between two location updates was found to be static and can be modified independently without disturbing the location fetching process.
hence the adaptation code being added to subject applications only derives gps sensing interval based on battery status and is independent of location manager api used in the subject application.
applications such as runnerup gpslogger provision users to set the gps sensing interval based on their preference however the sensing interval adjusted to user s preference is also static since egen version of the app should contain adaptive code and that of non egen a fixed value we have disabled the user control on changing the sensing interval in the app and code has been instrumented accordingly.
as shown in listing partial we have defined three battery discharging situations to update the location sensing interval.
the full adaptation policies can be found in the readme9.
the first situation is when the battery level is high and above the second situation is when the battery level is medium between to and the third situation is when the battery level is low below .
we have defined an adaptation policy that assigns sensing intervals of manuscript submitted to acm14 kowndinya and marimuthu et al.
listing .
an excerpt of the instrumented adaptation policy adaptationpolicy condition batterystate discharging and batterylevel high and threshold high and threshold medium and appstate foreground then adaptation sensinginterval and decreasing factor and batteryawarefunction linear fig.
.
change in sensing interval seconds seconds and seconds respectively for high medium and low battery level when the battery is discharging.
in addition the decreasing factor for high is set to while and are set for medium and low battery level respectively.
this will ensure that the sensing interval will increase based on the decreasing factor for each battery drop.
as shown in figure the sensing interval is increasing at a slower pace along with each battery drop when the smartphone s battery level is more than .
on the other hand the sensing interval is increasing at a comparatively faster pace when the battery level is medium and low.
especially the sensing interval is increasing at a faster rate when the device battery drops to lowto reduce the number of gps calls.
.
.
instrumentation of subject applications.
in this step we aim at instrumenting the generated code to the subject applications for battery awareness.
for this purpose we downloaded the source code of each subject application from github.
we looked for variables that hold the sensing interval functions that handle location updates and activities that address map features.
we have extracted the generated code frombatteryaware.java and instrumented it in the subject application.
overall the instrumentation step consists of following activities instrumenting for battery aware location sensing the subject applications are instrumented with the generated code such that it will dynamically change the location sensing interval based on the current battery level and charging status.
we found that all the subject applications had static sensing intervals.
therefore we aim to make it dynamically adaptive in this step.
the subject applications are instrumented with the generated code for dynamically changing the location sensing interval based on the current battery level and charging status.
the instrumentation initialized the adaptation policies and made a call to the functions described in the adaptation activity class.
apps such as gpslogger osmtracker provided users the option to decide the minimum distance between two location updates and minimum location accuracy.
in such situations we disabled the original code and replaced it with the generated code to make it consistent with other subject applications.
the subject applications had static gps location update interval.
we brought battery level and status in context to determine the sensing interval on demand for each location update.
this is achieved by initializing the adaptation policies and calling the functions described in the adaptation activity class.
manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps15 instrumenting for estimating distance covered this phase aims to instrument the app to fetch the location coordinates and calculate the distance covered in meters.
as pointed earlier in subject applications such as gpslogger osmtracker the distance measurement is given by default.
however other subject applications cannot measure distance and create a need for measuring distance.
hence we have added functions to collect latitude and longitude information from respective java classes to measure the distance covered.
finally the measured distance meters is annotated on the map view of the subject applications.
while some subject applications have distance measurement given by default others do not measure distance travelled.
the activity that displays the user track location information might not calculate the location related events and use other java classes that do gps location sensing as function calls.
hence we independently added additional functions that collect latitude and longitude information from respective java classes and we annotated the map view with the distance travelled in meters.
rebuilding the application and install on the test device after the instrumentation phase the project has been cleaned and re built for conducting experiments.
we created two versions of executables for each subject application namely egen version and non egen version.
the egen version represents the executable built from the instrumented project with battery aware code.
on the other hand the non egen version represents the executable built from the source code downloaded from github.
after we instrumented the app we cleaned the project and re built it.
we then installed the modified app on the test device and reviewed the app by checking all the ui components and we looked for any activity crashes before the actual trail.
finally the executables were installed on the test device and the ui components were verified to ensure that the instrumentation did not affect the app s behavior.
we also verified that the apps are not crashing before the actual experiments.
.
.
experiment protocol.
we have selected nokia c3 as a test device for conducting the experiments.
nokia c3 comes with a .
inch display and its hardware packs 3gb ram and 32gb in built storage with a mah battery.
this smartphone runs on android and comes with a cleaner version of android which helps us disable all the apps to create an isolated environment for conducting controlled experiments.
each subject application has been given network location related permissions during the trial.
initially we had conducted cycling from the specified source to destination using google fit10to measure the total distance.
the three trails of distance measurement with google fit is depicted in figure .
figure shows the direction of travel from source to source destination figure and show the duration of the trail and distance covered.
three google fit trials with the same source and the destination have been conducted and found an average distance of meters.
the average battery drop percentage was between to .
the distance measured with google fit m is considered a reference distance and used to analyze the location accuracy of subject applications.
we have conducted three trails for both egen and non egen versions of the five subject applications thus conducting trails each of length kilometers approx.
.
for each trial we followed steps mentioned below manuscript submitted to acm16 kowndinya and marimuthu et al.
fig.
.
distance measured by google fit installing the instrumented app on testing device resetting the bug report using android device bridge adb cycling from the defined source to destination exporting the bug report after reaching the destination uploading the bug report in google battery historian to measure the percentage of battery drop record the distance covered in meters on completing each controlled trial we use adbto generate the android test device s bug report in .zip format.
the generated bug report has been uploaded to the battery historian for further analysis.
.
experimental results this subsection presents the experimental results and answers to research questions.
answering rq1 does code generated by egen reduce gps usage?
the purpose of this research question is to check whether the code generated by egen reduces the gpsactivetimeperhour compared to the nonegen version of the subject application.
for this purpose the google battery historian tool was used to fetch thegpsactivetimeperhour for each subject application.
the reduction in gpsactivetimeperhour is calculated as the time difference between the gps active time by non egen version and egen version of each subject application.
a positive value indicates that egen version has managed to bring down the gps active duration per hour.
as shown in table the experimental results show that egen generated code reduces gps active time by a minimum of seconds and a maximum of 6m27s in an hour.
specifically the highest reduction in gps active time was produced by the instrumented version of gpslogger that reduced the gps active time by minutes.
on the other hand the instrumented version of open tracks produced the lowest reduction in gps active time of seconds.
overall the experimental results show that egen reduced the gps active time by .
minutes per hour on average.
manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps17 table .
gps active time reduction of egen over non egen s.no subject appgps active time per hour reduction in gps active time per hour non egen egen gpslogger 50m40s 44m13s 6m27s runnerup 42m38s 43m36s 6m2s 3kinetie speedometer 46m28s 40m27s 6m1s osmtracker 48m52s 46m37s 2m15s open tracks 46m7s 45m9s 58s we observed a significant reduction in gps usage of .
minutes by increasing the sensinginterval with a suitable decreasing factorfor each battery drop.
the results show that adopting dynamic location sensing intervals might help developers reduce the gps usage.
answering rq2 how much battery consumption is reduced by code generated from egen?.
the purpose of this research question is to identify the amount of battery saved by the instrumentation adaptation policies and egen generated code.
we had conducted the trials when the battery level was either low or transitioning from medium to low or high to medium to cover all the possible battery critical situations.
the google battery historian was used to estimate the battery consumed by each subjection application.
it displays battery usage in a chart by taking the bug report as input.
we have estimated the battery consumption in ma by filtering the subject application in the battery usage chart with the help of the subject application s package name.
the battery consumed by non egen and egen version was compared and the difference is reported in table .
the positive value of energy savings in ma implies that the significant amount of battery consumption is reduced by egen version.
overall egen generated code was able to reduce battery consumption in five subject applications.
the results from subject applications show that the egen version shows energy savings ranged from ma approx to ma approx .
the calculated mean reduction in battery consumption is ma as shown in table the code generated by egen can bring a maximum of .
ma approx.
battery savings in opentracks .
overall the instrumented code shows considerable battery savings for the trails that last for minutes.
we believe that the egen generated code might show significant battery savings when the apps are used for a longer time in real world scenarios.
hence writing a battery aware code might help developers to reduce unwanted battery consumption in location based android applications.
answering rq3 to what extent code generated by egen degrade location accuracy?
the purpose of this research question is to find out the extent to which location accuracy is degraded at the cost of reducing battery consumption.
we have considered the distance measured by google fit as the benchmark to measure the deviation in location accuracy of subject applications.
initially we have conducted three trials from the same source to destination using google fit and the averaged distance of .
km has been considered for manuscript submitted to acm18 kowndinya and marimuthu et al.
table .
battery saved by egen over non egen s.no subject appbattery consumption in maenergy savings in maegen non egen opentracks .
.
.
2kinetie speedometer .
.
.
runnerup .
.
.
osmtracker .
.
.
gpslogger .
.
.
the comparison.
we used haversine formula11for calculating the distance by collecting the coordinates of the previous and current locations and cumulatively adding the distance between every two locations for the entire trail.
in table the distance covered by egen and non egen version of the subject applications is presented along with the error in location accuracy compared to the distance measured by google fit.
in addition the degraded location accuracy is reported in table .
the degrade is calculated by subtracting the location error by non egen version and egen.
in table the negative degrade values mean less deviation and positive values signify more deviation in location accuracy.
overall egen version interestingly reported a thin margin of degradation in accuracy when compared to the non egen version of the subject application.
distinctly the application kinetie speedometer brought in a more accurate distance measurement of meters while reducing the battery consumption.
similarly osmtracker showed equally reliable accuracy in distance measurement when compared to that of non egen while results in battery savings of .
ma.
the apps such as open tracks runnerup and gpslogger showed degraded accuracy about and meters respectively.
however this degraded accuracy comes with significant battery savings as reported in answer to rq2.
overall the egen versions of the subject applications resulted in an average distance measurement of meters which is meters lesser than the distance measured by google fit.
as discussed in rq2 the average battery consumption reduction of ma might make the meters degrade inaccuracy negligible.
hence writing a suitable self adaptive location sensing policy would help to balance battery consumption and other conflicting requirements such as location accuracy.
.
implications we believe that the experimental results lay a promising foundation for adopting the energy saving selfadaptive location sensing policies in open source applications in the future for balancing battery and location accuracy requirements.
this subsection presents some of our findings that may further assist domain analysts app developers api developers and researchers in handling self adaptive location sensing.
domain analysts and domain experts.
this study shows the importance of considering energy aware requirements in the early stages of software development.
the self adaptive location sensing framework presented in manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps19 table .
distance covered by egen and non egen s.no subject appdistance covered in kmerror in location accuracydegrade in location accuracy non egen egen non egen egen kinetie speedometer .
.
osmtracker .
.
open tracks runnerup .
.
gpslogger .
.
7google fit benchmark application .
km this approach can balance battery consumption and location accuracy based on the remaining battery level.
hence we suggest domain analysts introduce self adaptive behavior to manage conflicting requirements like battery consumption and location accuracy.
therefore in the future the domain analyst and domain experts may consider battery aware self adaptive solutions for other application domains.
significantly the domain analyst may develop domain specific languages and code generators to address application domain specific energy bugs and corresponding energy saving solutions for domains like games social networks and other resource intensive applications.
app developers and api developers.
as shown in the results the self adaptive location sensing with batteryawareness significantly impacts battery consumption and gps active time.
hence we suggest developers write battery aware code from the initial development itself to handle energy hungry components.
the presented approach is about adding battery awareness in the application developer written code.
in addition we suggest api developers add support for battery awareness in the library to reduce amount development efforts of application developers.
for instance prospective api developers may modify the existing location apis or create a new api with battery aware self adaptive location sensing.
in addition api developers from other application domains also introduce battery awareness in the capabilities provided by their library.
researchers.
the dsml and code generator presented in this paper shows initial promise for considering domain specific energy bugs in the early stages.
hence we suggest potential researchers identify and catalog the domain specific energy bugs and their possible solutions to help developers make energy saving decisions during the development phase.
further researchers may provide suitable domain specific tool support to handle the most commonly occurring domain specific energy bugs.
threats to validity in this section the potential threats to the validity of the presented case study are discussed.
the guidelines given by runeson and h st are followed to categorize and discuss the threats.
construct validity construct validity refers to the degree to which the analysis measures what we aim to study.
in this study we aim to measure the gps usage battery consumption and location accuracy .
there is a high possibility of error in measuring these variables as we do not have widely accepted tools.
in literature several studies manuscript submitted to acm20 kowndinya and marimuthu et al.
use hardware tools to measure energy consumption and use older android phones which might not suit recent android devices.
to address this issue we have decided to use the recent tool developed by google developers namely google battery historian.
the gps usage is estimated as gps active time per hour and the battery consumption is estimated in maby the google battery historian tool.
the location accuracy was calculated in terms of distance covered in meters.
initially we used the google fit application to measure the distance.
we have conducted three trials and considered the averaged value of .
kilometers as the benchmark to compare the location accuracy given by the subject application.
of the subject applications osmtracker cannot calculate the distance covered hence we have instrumented a popularly known method to measure the distance covered using the location coordinates given by the subject applications.
the important validity threat in this category is an error in measuring the gps usage battery consumption and location accuracy.
therefore we conducted three trials for each egen and non egen versions of subject applications.
the averaged values of three trials have been considered to avoid the error caused in single trials.
in addition the subject applications were executed in the controlled environment by disabling all other user applications.
hence we believe that the values measured are from the subject applications and can answer the research questions.
internal validity internal validity is a concern when examining causal relationships.
in this study there is a possibility of validity threats in deciding the factors affecting gps usage battery consumption and location accuracy.
we have conducted preliminary controlled experiments with subject applications developed in our lab with varying location sensing intervals battery level and battery charging state to mitigate this threat.
we have conducted random trials with the sample subject application and analyzed the relationship between variables.
the first two authors have conducted the experiments and all the authors were involved while analyzing the cause effect relationship.
finally we have selected battery drain as a primary independent variable as it affects the location sensing interval gps usage battery consumption and location accuracy.
consequently the affected variables such as sensing interval gps usage battery consumption and distance covered are selected as dependent variable .
in addition we have observed a relationship between the dependent variables .
for instance the sensing interval is set to increase for each battery level drop.
consequently we observed a decrease in gps usage battery consumption and accuracy of distance covered.
therefore we verified this causal relationship also in the trials we conducted for the subject application.
the results show that the mentioned causal relationship has been maintained between the variables.
we believe that we have considered all aspects of causal relationships in this domain which poses less threat to internal validity.
the other possibility of internal threat is in the selection of subject applications.
initially we searched the apps on f droid with keywords such as gps logging distance measurement path tracker location service speed meter location share live location tracking etc .
we believe that the keywords chosen cover all location based applications such as map navigation activity monitoring etc.
in addition we also searched for open source applications through the google play store.
after getting candidate applications we have carefully applied inclusion and exclusion criteria.
the first two authors have primarily worked on applying inclusion and exclusion criteria.
the third and fourth authors have been involved in resolving the conflicts in the selection of subject applications.
to the best of our knowledge we believe that the selected subject applications are more suitable representative subject applications for evaluating egen.
manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps21 external validity the external validity refers to the generalizability of the results presented in this study.
there is a possibility of validity threats in terms of the application domain considered in this case study.
in this study locationbased applications have been selected for evaluating the egen.
hence the results presented in this study is only can be generalized for location based applications.
however the results also can be generalized to the smartphone apps if it uses location as one of the important contexts.
the energy saving opportunities presented in this study can be applied to such applications if location sensing drains a significant amount of battery.
the second possible external validity threat is the ability of dsl and code generator developed as part ofegen.
the domain model of egen is specifically designed for location based applications.
hence the capability of egen can be generalized only to location based applications.
the code generator presented in this paper generated only java code that can be used for android applications.
hence the generated code cannot be used for ios or windows smartphone platforms.
however the support for ios and windows platforms will be added in the future enhancements to egen.
reliability reliability refers to the extent to which the presented case study is repeatable by other researchers.
the first repeatability issue would be possible in specifying self adaptive location sensing policies and generating code.
therefore to mitigate this threat we have uploaded the egen source code to github12 which can be downloaded and used by other researchers.
the second threat in this category is instrumenting the subject applications.
we have uploaded the instrumented subject applications in the replicable package to mitigate this threat which is available in the replication package13.
the other researchers can build the shared source code and conduct the experiments on their testing device.
there may be situations where the source code building might result in build errors and failure to compile the .apk files.
to address this issue we have also shared the .apk for both egen and non egen versions of the subject application.
as we conducted controlled experiments there is a high possibility of getting deviated results when other researchers repeat the same experiment.
therefore to verify the results we have shared the bug reports14that contain the gps usage and battery consumption data.
the bug reports can be uploaded to the google battery historian tool and presented results can be verified.
related work the related works are classified under two categories dsl for design time specification of energy related properties model driven development of android apps.
in this section the related works found from the literature are summarized and compared with the egen.
.
dsl for energy specification we found only one dsl based approach namely energy estimation language eel that considered explicit specification of energy related properties at design time to the best of our knowledge.
the authors have used energy estimation formulas to annotate the xdsls to predict their energy consumption.
in this manuscript submitted to acm22 kowndinya and marimuthu et al.
approach during design time itself energy specialists can define energy estimation models eem for xdsl and predict how much energy it can consume at run time for different run time platforms.
eel is a textual domain specific language written using xtext language development platform.
the authors have conducted a case study on aurdinoml models to evaluate this approach.
the results show that the estimation model produces an estimation error of .
between .
and .
.
eel is related to egen in terms of proposing a textual domain specific modeling language for explicit specification energy related properties.
however it is different from egen as it targets cyber physical systems while egen target android apps.
egen comes with a dsl and code generator for specifying energy saving opportunities.
in contrast eel comes with the only dsl for specifying run time energy consumption and it doesn t have code generation support.
.
model driven development of android apps .
.
existing approaches.
md2 is an approach for developing mobile apps with model driven development methods.
it consists of a domain specific language to specify the data driven business apps.
it also contains a code generator for generating native android and ios code.
the language and code generated by md2follow the model view controller pattern.
the modelcomponent allows the developers to define the application s data model.
the viewcomponent helps in describing the user interface and its elements.
the controller component aids to describe the user interaction and events associated with the apps.
the dsl was defined with xtext15 and xtend16defines the code generator.
the recent version of md2 includes the following capabilities device specific layout extended control structures and offline computing .
xmob is a platform independent dsl for creating mobile applications for multiple platforms.
it is developed with three sub languages xmob data xmob ui xmob event to follow the mvc pattern.
the xmob data helps the developers to specify the way retrieving form database web service or other data sources.
the xmob ui helps the developers to describe the ui elements such as widgets forms buttons etc.
the xmob event helps the developers to link the user interfaces and data sources.
xmob involves model to model transformation and model to text transformation to generate the source code of the desired platform.
the model to model transformation converts the platform independent model to a platform specific model.
the model to text generates the source code corresponding to the elements in a platform specific model.
xmob uses xtext for language definition kermeta for model to model transformation and xpand for the code generator.
adsml is an adaptive domain specific modeling language for native mobile app development.
it relies on meta model extraction meta model elevation meta model alignment and meta model unification to create target apps for the android and ios platforms.
the meta model extraction phase extracts the platform specific meta models from the targeted platforms native apis.
the meta model elevation phase abstracts the platform specific api models and select the sub set for further analysis.
the meta model alignment phase find out the similar meta model elements among different platforms.
finally the meta model unification phase creates the platform independent dsl from the platform specific models identified in the previous phase.
the current implementation of adsml does not have the support for code generation.
dsl comet is the active dsl that targets a smart city or iot applications.
it primarily runs on mobile devices to tag the location and contextual information on the model elements created by dsl comet.
manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps23 table .
comparison of model driven development approaches for mobile app development approach dsl typetargeted platformsdomainmodeling scopecontext awarenessbattery awareness md2 textual android iosdata driven business appsdata ui user interactionno no xmob textualandroid ios windowsall mobile appsdata ui eventsno no adsml textual android iosall mobile appsall aspects no no dsl comet graphical n asmart city applicationsbusiness functionsyes partial rappt graphical textualandroidall mobile appsviews no no moweba mobile graphicalandroid windowsoffline business appsdata layer network connectivityno no egen textual androidlocation based appslocation sensing intervalyes yes the dsl comet includes open geo and contextual dsls to form an active dsl.
the open dsls interact with external apis to retrieve the information related to model elements.
the geo dsls render the models on the map interface to tag the current location on the models associated with geo services.
the contextual dslsare context aware and helps to re organize the model after encountering the contextual changes.
it has ios and eclipse based editors that permits the users to model either on the mobile or desktop.
the ios editor stores the models in json format and the eclipse based editor stores the models in xml format.
the dsl comet does not have a code generator to generate source code for the targeted platform.
rapid application tool rappt aids the developers in specifying the characteristics of mobile applicationsusingdomain specificvisuallanguageandtextuallanguage.initially thedeveloperscanusevisual language to specify the high level architecture and the number of screens with navigation.
the developers can then use textual language to add more specific information such as data schema authentication web service etc.
to define the app.
the model to model transformation then takes place to convert the app model to the android model where high level specification will be transferred to android specific elements such as classes activities fragments etc.
finally the rappt generates the source code from the android model that resembles the developer s written code.
the generated code produces the working prototype and developers need to add the business logic to deliver the working application.
mowebamobile isamodel drivenapproachcoveringthemobileapps datalayer.thisapproachmainly defines the data source of application to develop offline access to business applications in case of network connectivity issues.
this approach consists of three phases problem modeling solution modeling and source code definition.
the problem modeling phase uses the computational independent model cim and platform independent model pim .
the solution modeling phase uses the architecture specific model asm to specify the architectural requirements.
it uses uml profiles to create platform independent models and emf to convert the pim to asm.
finally it uses acceleo17to transform models to generate code for developing native applications for android and windows platforms.
manuscript submitted to acm24 kowndinya and marimuthu et al.
.
.
comparing approaches.
the comparison of the model driven development of mobile apps is given in table .
the approaches are compared based on the following criteria dsl type targeted platform domain modeling scope support for context awareness and support for energy awareness .
as shown in table the considered approaches can be broadly classified into two categories namely textual and graphical based on the dsl type.
the approaches such as md2 xmob adsml uses the textual dsl to specify the app functionalities.
the graphical dsl is used in the approaches like dsl comet rappt and moweba mobile .
in this research work egen framework adopts the textual dsl for modeling the energy saving selfadaptive requirements of smartphone applications.
the target platform criteria refer to the mobile platform for which the source code generated by the code generator associated with the discussed tools.
most of the approaches generate code for multiple platforms such as android ios and windows .
the rappt approach considers only the android platform for code generation.
in this research work the egen framework covers only the android platform and other platforms will be considered in the future releases of the framework.
the domain criteria refer to the application domain covered by the dsl and code generator.
as shown in table most of the approaches cover all the aspects of mobile apps.
in contrast approaches such as md2 dsl comet and moweba mobile covers the specific application domains.
specifically the md2 is for data driven business apps dsl comet is for smart city applications and moweba mobile is for business applications with offline access.
as observed from the table none of the approaches have considered location based android applications.
subsequently in this approach family of location based services has been considered as the application domain for dsl and code generator.
themodeling scope criteria refer to the elements that can be modeled with the dsl provided in the related approaches.
as shown in table most of the approaches cover the data and ui modeling of mobile apps.
none of the existing approaches have considered modeling the location sensing of mobile apps.
on the contrary this research work s modeling scope covers the location sensing of mobile apps.
finally the existing approaches have been compared for self adaptivity and energy awareness support.
as observed from table none of the existing approaches has considered the self adaptivity and energy awareness of the mobile apps which is the essential non functional requirements for the recent generation smartphones.
therefore in this research work the modeling of energy awareness and self adaptivity has been considered for location based android applications.
conclusion and future work this paper presents the egen tool for modeling energy aware self adaptive behaviors of location based mobile applications.
the domain analyst may use the textual dsml to specify the energy saving adaptation plans.
the developer may use the generated battery aware code in the existing repositories.
the preliminary evaluation presented in this paper shows that the instrumented code shows a considerable reduction in battery consumption for the trials that last for minutes.
hence we believe that the egen generated code might show significant battery savings when the apps are used for a longer time in real world scenarios.
therefore writing battery aware code might help developers to reduce unwanted battery consumption in location based android applications.
currently egen grammar covers only gps and does not cover other smartphone sensors for locationsensing.
we plan to cover accelerometer and magnetometer in the next version.
we also intend to perform manuscript submitted to acmegen an energy saving modeling language and code generator for location sensing of mobile apps25 controlled experiments at a large scale on greater number of android applications to device a catalog of adaptation policies for different categories of android applications.
this also would enable us to strengthen the further versions of egen.
the egen generated code cannot be used for ios or windows smartphone platforms.
however the support for ios and windows platforms will be added in the future enhancements toegen.egen has been evaluated by us through controlled experiments.
in future we have plans to evaluate it with mobile app developers for its usability and completeness.