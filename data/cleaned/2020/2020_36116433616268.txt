statistical reachabilityanalysis seongminlee max planck instituteforsecurity and privacy bochum germany seongmin.lee mpi sp.orgmarcel b hme max planck instituteforsecurity and privacy bochum germany marcel.boehme acm.org abstract given a target program state or statement u1d460 what is the probability that an inputreaches u1d460?this is the quantitative reachability analysisproblem.forinstance quantitativereachabilityanalysis can be used to approximate the reliability of a program where u1d460 is a bad state .
traditionally quantitative reachability analysis is solved as a model counting problem for a formal constraint that represents the approximate reachability of u1d460along paths in the program i.e.
probabilisticreachabilityanalysis.however inpreliminaryexperiments wefailedtorunstate of the artprobabilistic reachability analysis on reasonablylarge programs.
inthispaper weexplorestatisticalmethodstoestimatereachability probability.
an advantage of statistical reasoning is that thesizeandcompositionoftheprogramareinsubstantialaslong astheprogramcanbeexecuted.weareparticularlyinterestedin theerrorcomparedtothestate of the artprobabilisticreachabilityanalysis.werealizethatexistingestimatorsdonotexploitthe inherent structure of the program and develop structure aware estimators to further reduce the estimation error given the same number of samples.
our empirical evaluation on previous and new benchmarkprogramsshowsthat i ourstatisticalreachabilityanalysis outperforms state of the art probabilistic reachability analysis tools in terms of accuracy efficiency and scalability and ii our structure aware estimators further outperform blackbox estimators that do not exploit the inherent program structure.
we also identify multiple program properties that limit the applicability of the existingprobabilisticanalysis techniques.
ccsconcepts theoryofcomputation programanalysis mathematics of computing bayesian computation .
keywords quantitativereachabilityanalysis statisticalreachabilityanalysis reaching probability markov chain acm reference format seongminleeandmarcelb hme.
.statisticalreachabilityanalysis.in proceedings of the 31st acm joint european software engineering conference andsymposiumonthefoundationsofsoftwareengineering esec fse december san francisco ca usa.
acm new york ny usa 12pages.
esec fse december san francisco ca usa copyright heldby theowner author s .
acm isbn .
introduction thetraditionalassessmentofthereachabilityofaprogramstate provides only a true false answer either the state is reachable e.g.
theprogrammaycrashforsomeinput ornot e.g.
itnever crashes for any input .
due to the undecidability of the analysis problem andtherestrictedexpressivenessoftheanalysisresult such a binary answer provides only limited information.
instead ofabinaryanswer quantitativereachabilityanalysis providesthe probability of how likely acertain program state is reached given theworkloadoftheprogram.sucha quantitative measureofreachability can provide more comprehensive information about the programsemantics.forinstance itcanestimatehowprobableis to reach a crashing state under normal workload which can be criticalinformation for software reliability security maintenance.
thetypicalmethodconsideredforquantitativereachabilityanalysisiscalled probabilisticreachabilityanalysis whichanalyticallycomputes the reaching probability directly from the source code.
probabilistic symbolic execution pse the pioneering work bygeldenhuysetal.
computesthereachingprobabilityofa programstatebyfindingallthepathconditionstoreachthestate usingsymbolicexecutionandcountingthenumberofinputssatisfyingthepathconditionsusingmodelcounting thesumoftheprobabilitiesbecomestheexactreachingprobabilityoftheprogramstate.
aspsemaysufferfromscalabilityissuesforalargeandcomplex program manyfollow upworkshavebeenproposedtoimprove thescalabilityofprobabilisticreachabilityanalysis .most recently sahaetal.proposedpreachwhichcomputesthereaching probability usingbranch levelprobability information .
whenfacingaproblemtoocomplexfortheanalyticalmethod especially when it is unmanageable to compute a quantity exactly asampling basedstatisticalmethodcanbeusedtoovercomethe limitation .
it is well known that monte carlo methods have been successfully applied to numerous problems across various fields including natural sciences and engineering where the solution is intractable for analytic computation.
recently in the context of program analysis liyanage et al.
proposed a statistical method to approximate the number of elements that can be reached by actual program execution which previously can only be upper boundedbystatic analysis.
this work explores how the statistical method can be applied to quantitative reachability analysis.
we propose a statistical reachabilityanalysis whichtacklesthequantitativereachabilityanalysis problem with random sampling and statistical modeling.
the main issue of statistical reachability analysis is how to estimate the reaching probability of a certain program state that has not yet been observed in the sampling process.
to overcome this issue we first suggest a naive approach of using two well known estimators laplacesmoothingandgood turingestimator that can estimate the non zero probability of unseen events from the thiswork islicensedunderacreativecommonsattribution4.0international license.
esec fse december3 san francisco ca usa seongmin lee andmarcelb hme frequency of the seen events in a blackbox manner i.e.
without considering the structural aspect of the program.
then we further investigate how the intrinsic structural property of the program thedependencybetweenprogramstates canbeusedtoimprove theestimationaccuracyofthestatisticalreachabilityanalysis especially when the number of samples is small the classic problem of sampling basedblackboxestimation.weclaimthatthestructural relation between program states can be an essential ingredient to improving estimation accuracy.
consequently we propose a structure aware estimator a novel statistical reachability estimator that considersthe structuralrelation between program states.
toevaluatetheperformanceofthestatisticalreachabilityanalysis weuseasetofprogramsthathavebeenusedforevaluating thestate of the artprobabilisticreachabilityestimator andcomparethestatisticalreachabilityestimatoragainsttworepresentative probabilisticreachabilityanalysis pse andpreach .our evaluation shows that the statistical reachability estimator can precisely estimate the reaching probability for all subject programs mostly in less than .
seconds while probabilistic reachability analyzers fail or take a significantly longer time to estimate for a considerable amount of programs.
in addition we investigate theeffectofusingstructuralinformationontheestimationaccuracyandtheefficiencyofthequantitativereachabilityanalysis.we evaluatethestructure awareestimatoragainstblackboxestimators withthesiemenssuiteandopen sourcesoftwares.ourempirical resultsshowthat within10 oftheexpectednumberofsamples needed to reach the target state the structure aware estimator can estimate the reaching probability with less than one magnitude of error while laplace and good turing estimator produces the estimates with1.28and2.41magnitudes oferror respectively.
the contributionsofthis paper are as follows we propose statistical reachability analysis a novel samplingbased quantitative reachability analysis that estimates the reachingprobability ofprogram states from astatisticalperspective.
ourempiricalevaluationforasetofprogramsfromsv comp benchmarks shows that the statistical reachability estimator can preciselyestimatethereachingprobabilitywithsmallsamples forallsubjects.incontrast probabilisticreachabilityanalyzers applicablilty andperformance are limited.
wedesignastructure awarereachabilityestimatorthatleverages thedependenceinformationbetweenprogramstatesto provide amore accurateestimationwithasmall number ofsamples.
we evaluate the blackbox and structure aware statistical reachabilityestimators onalarge andcomplex real world software.
our empirical results show that the structure aware estimator is more accurate with a small number of samples than the blackbox estimators indicating the advantage of using the structural information ofthe program.
background .
quantitativereachability analysis quantitativereachabilityanalysis isanextensionofreachability analysisthatcomputestheprobabilityofwhetheracertainprogram stateisreachedforarbitraryprogramexecution.givenaprogram u1d443 asetofprogramstates u1d446 andanarbitraryoperationaldistributionofprogramexecution u1d438 thereachingprobability pr u1d460 ofaprogram state u1d460 u1d446is defined as the probability of a random program execution u1d452 u1d438reachingthe state u1d460 pr u1d460 summationdisplay.
u1d452 u1d438pr u1d452 u1d460isreachedby u1d452 where u1d460isreachedby u1d452 is an indicator function that returns 1if u1d460isreachedby u1d452and0otherwise.
quantitative reachabilityanalysiscanbeaprimarygoalof program analysis for figuring out the reaching probability of a certain critical program state.
for example it can provide how likely a crashing program state is reached in a normal workload of program execution.
such a crashing state could be an assertion that the developer placed in the program assuming it is always true or a recently discovered bug that is not yet fixed.
it can also estimate for load testing a server client program quantifying how often a certain queryis sentto the serverinvariousworkloadsindifferent stagesofsoftwaredeployment.suchaninformationcouldbeuseful fortheserviceprovidertodecidethehowmanyserversareneeded to handle the workload.
theresult of the quantitative reachability analysiscanfurtherbeusedforthedownstreamsoftwaretesting tasks.
one can use it to design an optimal concolic testing strategy by balancing the cost for the concrete execution and the symbolic execution .
.
probabilisticreachabilityanalysis probabilisticreachabilityanalysis theprimaryapproach forquantitativereachabilityanalysis hasbeenwidelystudiedin the last few decades.
based on the symbolic execution and the modelcounting probabilisticreachabilityanalysiscomputes thereachingprobabilityofaprogramstatedirectlyfromthesource code.probabilistic symbolic execution pse is a pioneering techniquethatcomputestheprobabilityofexecutingportionsof theprogramtoperformaquantitativereasoningforsymbolicexecution.
given a path condition for executing a portion of a program pse computes the probability by counting the number of inputsthat satisfythe condition using modelcounting.
psesolves the probabilistic reachability analysis problem by adding up all the probabilities of the paths that reach the target program state.
geldenhuys et al.
show that pse can estimate the probability of triggering a bug in the program with high accuracy.
as the path explosionproblemisawell knownobstacleforsymbolicexecution to analyze a practical program several subsequent works went on toimprovethescalabilityofpse filierietal.
proposedstatistical symbolic execution that still runs the model counting but only for subset of paths sampled from all existing paths and uses the informationforbayesianestimationtoestimatethegrossprobability.
gerrard et al.
proposed conditional quantitative program analysis whichblendsevidencefrommultiplestaticanalysesto reduce the search space of the input reaching a target program statement.
most recently preach has been proposed to overcome the path explosionproblem .toavoiddirectlydealingwiththeprobabilitiesofexecutionpaths preachchoosestocomputetheprobabilities of satisfying branch conditions in the program and use them to estimatethe reachingprobability ofaprogramstatement.branch selectivity whichdenotesthepercentageofvaluessatisfyingthe 327statisticalreachability analysis esec fse december3 san francisco ca usa branch condition is calculated using model counting as the ratio of the number of values in the domain to the domain size of the variable type satisfying the branch condition.
then preach constructs a discrete time markov chain model representing the transitionprobabilitiesofthestatementexecutionusingthecontrol flowgraphtogether withthebranch selectivity.thereaching probability of a program statement is computed by solving the markov chain model.
while preach reduces the cost of the model counting it can only approximate the reaching probability of a program statement since it does not consider the context of the program execution.
the domain of the variable can be changed by the other statements executed before.
thus thebranch selectivity may significantly differ from the actual probability of satisfying the branch condition in the program execution.
to overcome such animprecision preachsuggestsapplyingabstractinterpretation to infer the domain of the variable.
there are two variations of preach preach i whichusestheintervaldomain andpreach p whichuses the polyhedradomain.
.
statistical estimatorforunseenevents in statistics while allobservableeventsinthedomain space have non zero probability some rare events may not be observed in the sample space.
estimating the probability of an unobserved event is thesunrise problem .
to avoid assigning zero probability to unobservedevents several statisticalestimators have been proposed.
laplace smoothing also known as additive smoothing isone of thepopularestimatorsforestimatingthenon zeroprobabilityofan unobserved event by adding a small positive smoothing parameter u1d6fcto all the events.
the laplace smoothing estimator estimates the probability of the u1d456 th category as u1d450 u1d456 u1d6fc u1d45b u1d6fc u1d451 where u1d450 u1d456is the number of u1d456 th category samples and u1d6fc 0isasmoothing parameter.
another well known estimator for estimating the probability of an unseen event is the good turing estimator .
the goodturing estimator estimates the probability of discovering an object ofhithertounseenspeciesfromthenumberofalreadyseenspecies.
it first defines the incidence frequency u1d44c u1d456for a species u1d437 u1d456as the number of times that the species u1d456is observed in the sample u1d442 u1d45b.
then the number of singleton species u1d4531is defined as the number of species that are observed only once i.e.
u1d44c u1d456 u1d456 .
the good turingestimatorestimatestheprobabilityofdiscoveringany unseen species in the next sampling as u1d4531 u1d45b.
the probability of discovering a certain unseen species u1d437 u1d456is u1d4531 u1d4530 u1d45b where u1d4530is the number of unseen species within u1d442 u1d45b.
however in general it is unknownhowmanyspeciesexistand therefore howmanyunseen speciesare inthesample u1d442 u1d45b.therefore goodturingprovides an upper bound on the probability of discovering a certain unseen species u1d437 u1d456.
statistical reachabilityanalysis whileprobabilisticreachabilityanalysiscomputesthetruereaching probability of a program state 1one canapproximate the reaching probability using stochastic sampling.
let us say we want to estimate the reaching probability pr u1d460 of a program state u1d460in a 1while they aim to compute the true probability often the analysis outcome is also an approximation due to theoreticallimitationsand impractical computational cost.program u1d443underacertainworkload where wecansamplearandomprogramexecutionfrom.assumingwehavesufficientnumber u1d45bof program execution samples u1d442 u1d45b the ratio of the number of samples that reach u1d460to the total number of samples i.e.
empirical probability pr u1d460 willbe aclose approximation of pr u1d460 pr u1d460 u1d44b u1d460 u1d45b u1d45b pr u1d460 where u1d44b u1d460isthe number of executionsin u1d442 u1d45bthat reach u1d460.
however foracertainprogramstatethatisextremelyraretoobserve theempiricalprobabilityestimatorcangenerateasubstantial bias e parenleftbigg u1d44b u1d460 u1d45b u1d44b u1d460 parenrightbigg pr u1d460 pr u1d460 u1d45b e parenleftbigg u1d44b u1d460 u1d45b u1d44b u1d460 parenrightbigg if the reaching probability pr u1d460 is very small the empirical probabilitybecomessignificantlylargerthanthetrueprobabilityifitis observed the left equation and underestimated to zero if it is not observed the right equation .
especially suchan underestimation can be detrimental in the program reliability analysis the analysis mayconcludethattheprogramisreliableeventhoughthereisa reachable erroneous state in the program.
therefore the statistical reachability analysis should always deal with the sunrise problem.
.
blackbox reachabilityestimators toestimatethereachingprobabilityforbothobservedandunobserved program states we employ the laplace estimator and the good turing estimator which can deal with the sunrise problem.
for given executions u1d442and the target program state u1d460 thelaplace estimator lap estimates the probability of reaching u1d460as lap u1d460 u1d450 u1d460 u1d6fc u1d45b u1d6fc where u1d450 u1d460isthenumberofexecutionsthatreach u1d460 consideringthere aretwocategories theexecutionsthatreach u1d460andtheexecutions thatdonotreach u1d460.forthesamesetting the good turingestimator gotu estimates the probability of reaching u1d460as gotu u1d460 braceleftbigg u1d450 u1d460 u1d45b if u1d450 u1d460 u1d4531 u1d45b otherwise where u1d4531is the number of singleton program states in u1d45c it gives the empirical probability if the target program state is observed in the executions u1d442 otherwise itgives the good turing estimation.
drawbacksofblackboxestimators.
atypicaldrawbackofsamplingbased estimators is that they may not be accurate for small sample sizes.forexample thetheoreticalbackgroundofthelaplaceestimator lies in the normal approximation of binomial distribution which is sensible if the number of samples is large.
similarly good also described that the estimation is expected to be good if the number ofsample u1d45bislarge and u1d4531isnot toosmall .
another limitation of the above estimators is that they do not exploit the dependencies between the program states.
for example if a statement u1d4602is the statement under the true branch of the if statement u1d4601 thenthereachingprobability pr u1d4602 isalwayssmaller than or equal to pr u1d4601 .
however if they are not reached in the sample executions none of the above estimators can distinguish between the reachingprobability of u1d4601and u1d4602.
328esec fse december3 san francisco ca usa seongmin lee andmarcelb hme .
structuralrelation forbetter estimation program execution is a sequence of program state transitions and therefore there existsa hierarchical dependencerelation between thestates.oftenarareevent suchasacrash ofaprogramexecution is placed deeplyin the program s state hierarchy they mayoccur only if severalpreconditions are satisfiedduringtheexecution.in such a case the hierarchical relation between program states until reaching the rare event becomes a vital factor in estimating the probability ofthe rare event.
a b c figure hierarchical structures of states.
each solid and dashed edges represent the given executions have reached andunreached thetransition respectively.
structural relations between program states can be an indicator distinguishingthereachabilityprobabilityofmultipleunreached programstates.figure 1a forinstance representsthattheprogram state u1d4601is the direct predecessor of u1d4602 similar to the if statement anditstruebranchwediscussedinsection .
.since u1d4602canonly be reached only if u1d4601is reached the reaching probability of u1d4602is less thanorequal to that of u1d4601.
usingthegivenexecutionsandthestructuralinformation we can even quantify the reaching probabilities of different unreached states.
in figure 1b we assume that states u1d4601and u1d4603are reached times and three times respectively from executions and those executions never reached their direct successor states u1d4602 and u1d4604.then weconsiderapplyinglaplaceestimationoneach u1d4601 and u1d4603to estimatethe reachingprobability of u1d4602and u1d4604 pr u1d4602 pr u1d4601 u1d6fc u1d6fc u1d6fc .
pr u1d4604 pr u1d4603 u1d6fc u1d6fc u1d6fc .
.
.
the equation represents that there are more chances to reach u1d4602 by reaching u1d4601than u1d4604by reaching u1d4603 yet if they reach their direct predecessors u1d4604ismore likely to be reachedthan u1d4602.
now we can estimate the reaching probability of an unreached state whichexistsdeepinthestructure usingthereachingprobabilities of its predecessors and the path probability that lead to theunreachedstate.givenastructureandtheexecutions thestate reachedbytheexecutionsconstructsthe frontierofthereaching region.
the frontier consists of states that have an unreached direct successor.
for instance the state u1d445in figure 1cbelongs to the frontier.
then there could be a hypothetical execution that can reach the unreached hidden state u1d43bfrom u1d445following the path u1d445 u1d4602 u1d4605 u1d43b.
we call this path a hypothetical path ora hy pathof u1d43b.thereachingprobabilityof u1d43bbyfollowingthehypothetical path u1d445 u1d4602 u1d4605 u1d43bis the product of the reaching probabilityof u1d445andthetransitionprobabilityateachstateinthe path.assumingthatthereisnopriorinformationontheunreached state wemayestimatethetransitionprobabilityoneachstateas the reciprocal of the number of its direct successors.
then the probability ofexecutingthe hypothetical pathis pr u1d445 u1d6fc u1d445 u1d6fc .
notethatanunreachedstatecanhavemultiplehy paths.ingeneral we can estimate the reaching probability of an arbitrary unreached statehby summing up all the probability of executing the hypothetical path of h. based on this motivation we formally define the structure aware reachabilityestimator inthe nextsection.
.
structure awarereachabilityestimator notations hy path.
structure aware reachability estimation is basedonagivendirectedgraph u1d43a u1d449 u1d438 calledastructuregraph representingthedependencerelationbetweentheprogramstates intheprogram u1d443.nodes u1d449isasetofdiscreteprogramstates and u1d438isasetof edgesrepresentingtheviablestatetransitionsduring the program execution.
a typical example of such a graph can be a control flow graph a data flow graph ora call graph etc.
which are widely used in program analysis but not limited to these it canbeanygraphthat approximates thedependencyoftheprogram states.
we will further discuss the precision of the graph at the end of this section.
a pathp u1d4631 u1d4632 ... u1d463 u1d45b in u1d43ais a sequence of nodes such that u1d463 u1d456 u1d463 u1d456 u1d438for1 u1d456 u1d45b .
we call a path starting from an entry node a node having no predecessor in u1d43a and ending at the exit node a node having no successor in u1d43a a completepath oranexecution asasingleprogramexecutioncanbe treatedas sampling acomplete pathfrom u1d43a.
givenasetofexecutions o wepartition u1d449intotwosets aset of reached nodes u1d449 u1d45fand a set of unreached nodes u1d449 u1d462.
then the definitionofahy pathisas follows definition .
hy path hp .assume a node h u1d449is not reached for a given set of executions u1d442 h u1d449 u1d462.
a pathhp u1d45d1 u1d45d2 u1d45d u1d45b h is ahypothetical path or ahy pathofhif u1d45d1 u1d449 u1d45f u1d45d2 u1d45d u1d45b u1d449 u1d462 and u1d45c o whose executionis o entry u1d45c1 u1d45c2 u1d45c u1d45b u1d45d1 exit suchthat he entry u1d45c1 u1d45c2 u1d45c u1d45b u1d45d1 u1d45d2 u1d45d u1d45b h exit isacompletepath.wecallnode u1d45d1acriticalnode andcompletepath heahypothetical execution ofhp.
probability estimation.
our estimator estimates the reaching probability of an unreached node h u1d449 u1d462bythe sum of the reaching probability of all hy paths of h. the estimator theoretically overapproximatesthe reachingprobabilityof hsince every hypothetical execution reaching hcontains at least one non overlapping hy path of h for any hypothetical execution one can consider the lastreached node u1d45d1in the execution before reaching h. then the sub pathfrom u1d45d1tohisahy pathof h.now thedifferencebetween theestimateandtheestimandistheprobabilityofthehypothetical 329statisticalreachability analysis esec fse december3 san francisco ca usa executionthatcontainsmorethanonenon overlappinghy path ofh.
we claim that the bias is negligible in practice since the node hwewanttoestimateisalreadyahard to reachnodeforalarge number of executions.
considering a hy path instead of a whole hypothetical execution can significantly reduce the graph traversal space and thus the estimation time as the majority of reachable program states can be reached with a relatively small number of executions .
path probability.
the key idea to estimate pr p the probability of executing the path pin u1d43a is to consider a path as the state transitionofthe discrete timemarkovchain definedontopof u1d43a.the probability of hp u1d45d1 u1d45d2 u1d45d u1d45b h is the reaching probability of node u1d45d1multiplied by the product of the transition probabilities ofalledges inthe hy path pr hp pr u1d45d1 pr u1d45d1 u1d45d2 u1d45b productdisplay.
u1d456 2pr u1d45d u1d456 u1d45d u1d456 wherepr u1d465 u1d466.alt denotethestatetransitionprobabilityfromstate u1d465 tostate u1d466.altinthemarkovchain.in hp onlythefirstnode u1d45d1isreached by executions and the restof the nodes u1d45d2 u1d45d u1d45bare not reached.
weusetheempiricalprobabilityforestimatingtheprobabilityof the first node u1d45d1 pr u1d45d1 o o u1d45d1 o o .
we estimate the transition probability pr u1d45d2 u1d45d1 using laplace smoothing for the local executions that reach u1d45d1 given that none of the u1d45b1 number of executions that reach u1d45d1move to u1d45d2 pr u1d45d2 u1d45d1 u1d45b1 u1d6fc u1d45b1 u1d6fc .then fortheremainingtransitionprobability we used the reciprocal of the number of children of the previous node as the transitionprobability pr u1d45d u1d456 u1d45d u1d456 u1d45d u1d456.succ .
cycles.ifthestructurehascycles therecouldbeaninfinitenumber of hy paths of h. such a cycle can be dealt with a stationary probabilitydistributioncalculationforthediscrete timemarkovchain e.g.
the pagerank or the random walk which is a wellknowntechniqueinthefieldofstochasticprocesses.inaddition basedonthe features ofthe given graph structure we can further reduce the search space of the hy paths which will be discussed in section3.4withaconcretizedanalysistaskfor our evaluation.
approximationofstructuregraph.
itisworthnotingthatastructureaware estimator can provide the reaching probability even if the given structure graph is abstracted or less precise compared to the graph with the exact dependence information of the program.
due to the dynamic nature of the program e.g.
dynamic function call obtaining the exact dependence information between the program states is not always possible.
nonetheless as the execution set size increases thefrontierofthereachingregiongetsclosertothetarget state which means the distance between the critical node and the targetstategetssmaller.thus thebiasduetotheimprecisionof thestructuregraphreduces i.e.
theestimationresultisgenerally getting more accurate as the execution set size increases.
such a property of structure aware estimation makes itself more robust to the imprecision ofthe given structure graph.
.4optimizationusingthestructuralproperties we evaluate our structure aware and blackbox reachability estimators on the statement reachability estimation problem a typical problemforevaluatingthereachabilityanalysismethods .forthestructuregraph weusetheinter proceduralcontrol flow graph intercfg as it represents the order of reaching the program statements during execution.
we first set our assumption that the program has a single exit point while we argue about this assumption at the end ofthis section.
thepropertyofthestructuregraphcanbeusedtoavoidunnecessary computation for the structure aware estimator.
in this section wesuggestthreeoptimizationsusingthestructuralpropertiesof the intercfg terminating inter procedural call modularizing the hy path and3 loophandling.
terminatinginter proceduralcall.
aprogramexecutionmay contain zero or more inter procedural transitions.
given a path in intercfg one can identify the terminating inter procedural call by matchingthefunction calledgeandcorrespondingfunction return edge in the path.then the wholesub path underthe terminating inter procedural call can be replaced with a single edge connectingthecallingnode andthenextnode inthecallerfunction the transitionprobabilityofthisedgeisonebecausetheexecutionwill alwaysreturn to the next node after the function call.
modularizingthehy path.
afterremovingtheterminatinginterprocedural calls we can modularize the reduced hy path into a sequenceofintra proceduralpaths called pathunits theprobability of the hy path becomes the product of the probabilities of the path units pr hp productdisplay.
pu rhppr pu wherepudenotesapathunitinareducedhy path rhp.theadvantage of modularization is that the estimator can reuse the probability of the path units for multiple hy paths.
for example if the function u1d453 where the target statement u1d460is located has not been reachedyet everylastpathunitofthehy path hpwillbethesame aspu u1d453 where funcindicates the path unitbelongstothefunction func.therefore untilthefunction u1d453 is reached the probability of the path unit pucan be efficiently reused.
our empirical evaluation shows that modularization can significantly reduce the estimationtime.
loop handling.
the cycle in an inter procedural path occurs either by a loop appearing at a path unit level or a cyclic call sequence appearing at a modularized hy path level.
using the feature of the inter proceduralcontrol flowgraph we can avoidcomputing the stationary probability distribution of the markov process to deal withthe cyclesinthe hy path.
when estimating the probability of a path unit the structureawareestimatorcanonlyconsidertheacyclicpathunitbyadjusting the transition probability so that the probability of an acyclic path includes the chances of the cyclic path.
there are two cases the path unit passes a loop it does not end in the loop the path unitendsintheloop.ifapathunitpassesaloop theadjustment tothetransitionprobability pr loop entry loop exit 1since every loop entrance must reach the loop exit if there is a single program exit.
assume the path unit s last node u1d452is in the loop and let us denote the true branch of the loop a loop start .
the original transition probability pr loop start loop entry before adjustment is loop entry.succ .
let us say the reaching probability of u1d452after entering the loop is u1d45e pr loop start u1d452 330esec fse december3 san francisco ca usa seongmin lee andmarcelb hme u1d45e.2then the reachingprobability of u1d452inany loopiterationafter reachingthe loopentry is u1d45e u1d45e u1d45e parenleftbigg1 u1d45e parenrightbigg2 u1d45e u1d45e u1d45e u1d45e u1d45e.
thus the probability of a path unit can be estimated by starting from the last node of the path unit multiplying the transition probabilityinthereversedirectionofthepathunit and3 ifitmeets theloopentry adjustthetransitionprobabilityto pr loop entry loop start u1d45e where u1d45eis the probability computed until the currentprocess.
asthecycliccallsequence works similarly inthe path level we can make the sameadjustment to avoid computing the stationary probability distributionofthe markov process.
we finally mention the single exit assumption.
in the general case aprogram canhave multipleexits.
whenthere isa program exitbetweenthefrontierofthereachingprogramstatementsand the target statement our estimator may overestimate the reaching probability of the target statement.
the bias dueto the imprecision of the single exit assumption will decrease as the sample size increases since there will be less chance of having a program exit between the frontier andthe target statement.
experimentalsetup .
research questions we mainly ask two research questions to evaluate the performance ofthe statisticalreachabilityanalysis.
rq1 how does the statistical reachability analysis perform compared to the probabilistic reachability analysis?
in this research question we investigate the limitation of existing analyticmethodsandhowthestatisticalreachabilityanalysisperforms comparedtotheprobabilisticreachability analysis.ourinvestigation considers both the accuracy of the estimation for the program with nontrivial semantics and the scalability of the method.
we use pseand preachas baselineprobabilistic reachability analyzers forcomparisonwiththestatisticalreachabilityestimatorsonthe benchmarkprograms usedinthe preach work.
rq2 howdothestructure awareandtheblackboxreachability estimators perform on hard to reach states in a complex program?
we claim that the statistical reachability estimators are scalable regardless of how complex the program semantic is.
to verifythis claim we investigatetheperformanceofthestatistical reachabilityestimatorsforestimatingthereachingprobabilityof hard to reach states in the program with bigger sizes and much more complex semantics than the benchmark programs used in rq1.
we also investigate the efficiency of the structure aware modelcomparedto the blackbox model.
.
subject programsandtargetstatements toevaluatetheperformanceofstatisticalreachabilityestimators compared to probabilistic reachability analyzers we concretize the problem of quantitative reachability analysis into the problem ofstatement reachability analysis and use the same benchmark programsusedinthepreachwork 142javaprogramsfrom competition on software verification sv comp .
the target 2pr u1d465 u1d466.alt isthesumoftheprobabilitiesoftheintra proceduralpathsfrom u1d465to u1d466.alttable rq1subject programs fromsv comp .
jpf regress.
exmit t exe1 f exe2 f exe4 f exe6 f exe8f exe10 f exe10 t exe12 f exe12 t exe13 t exe14 t exe15 t exe18 f exe19 t exe20 f exe20t exe26 f exe27 f fneg t lcmp t simple f simple t suzette f suzette t assign t jbmc regress.
assert3 if icmp1 switch1 token2 algorithms insertsort2 rbtree1 table statistics of rq2 subject programs from siemens suite above five andthe real world programs below five program ncloc func bb gt tcas .37e schedule2 .99e totinfo .2e printtokens2 .82e replace .73e gif2png .95e jsoncpp .28e jasper .48e readelf .99e freetype2 .25e statements arethe assertionsin theprograms.
most142programs have very primitive semantics to reach the assertion a single comparison !
to an input is the only condition for the controlflowtotheassertion.asourinterestisinmorerealisticprograms wefilteredoutthoseprogramswithprimitivesemanticsand leftonly theprogramswhose semantics have meaningfulchanges to the reachingprobability.
our selection criterion is that theprogram semantics should update the domain of the value used in the comparison for reaching the assertion and affecting the branch probability.wemanuallyinvestigateall142programsandselect programs after filtering.
table 1shows the selected programs.
the averagenon comment line of code ncloc is35.
.
sincetheprogramsizeisrelativelysmall thereisnosingleton afterafewiterationsofthesamplingprocess.therefore weonly use the laplace estimator for the statistical reachability analysis methodin rq1.togettheground truthreachingprobabilityofthe assertion wecheckthesemanticsofeachprogramandmanually compute the reaching probability we consider the same domain a signed bit for an integer input and a length of with all printable ascii characters for a string input and assuming the uniformdistributionoftheinputdomainasthepreachwork.to validate the ground truth we seperately run a sufficiently large number of iterations of the sampling process and compare the ground truth withthe empirical reaching probability.
subjects usedin rq1are relatively small sizedwith lesscomplexity.
to evaluate the performance of statistical reachability estimatorsinrealisticprograms wechoosefivemiddle sizedprograms 3the programnamesareabstracted for the space issue.
331statisticalreachability analysis esec fse december3 san francisco ca usa from the siemens suite 4and several large sized free and opensource fos c c applicationsandlibraries.table 2showsthe selectedprograms number oflines functions andbasic blocks.
to remove the selective bias as well as to evaluate estimators with a sufficiently challenging task we select the statement that is most frequently lastly found while running multiple greybox fuzzing on each subject program.
for the siemens suite subjects we run greybox fuzzing for six minutes with repetitions and recordthestatementcoveragehit countsateachsecond.forthe fossubjects weruntenrepetitionsofone week greyboxfuzzing taking more than one cpu year and record the statement coverage hit countsateach15minutes.ifthefuzzingfindsthecrashinginput duringthe campaignfor fossubject we use the last statementof the crashing path as the target statement considering the practical reliabilityanalysisscenario.
.
sampling process weusethegreyboxfuzzingdatatogeneraterandomsamplesforthe statistical reachability analysis.
instead of using the raw statement coverage hit count from the fuzzing campaign which contains the adaptivebiasduetotheguidanceofthegreyboxmanner wecreate a simulated random sampling that is representative of theaverage behavior of multiple greybox fuzzing campaigns.
the simulated randomsamplingprocessisasfollows foreachgreyboxfuzzing campaignthatdiscoversthetargetstatementinitscampaign we record the hit count of the statement coverage at the timestamp wherethetargetstatementisreachedfirst.thehit countdatadivided by the number of samples until the timestamp i.e.
empirical probability becomes the expected coverage per sample of the certain fuzzing campaign.
by averaging the expected coverage per sampleforallthecampaigns wegettheaverageexpectedcoverage persampleofthesimulatedrandomsampling.weusethetarget statement sground truthreachingprobability gt astheempirical probabilityofthisaverageexpectedcoverage whichispresentedin table2.then wecansimulatethehit countdataforanarbitrary numberofsamplesby multiplying theaverageexpected coverage persamplebythenumberofsamples.forexample thehit countof astatementwhoseaverageexpectedcoveragepersampleis0.
with samples is .
.
the implementation of the simulatedrandomsamplingcanbefoundinthepublicrepository.
forrq2evaluation wegenerate10 ofthesamplesexpectedto reachthe target statement gt 10per subjectprogram.
there are two main advantages of using simulated random sampling.
first it can be a representative of the average behavior of multiple fuzzing campaigns.
different fuzzing campaigns can have different hitting behaviordueto randomness.
sucha randomness highlyaffectsthegood turingestimator whichusesthenumber ofsingletons andthestructure awareestimator whichconsiders whatthecriticalnodeisandhowmanytimesitishit.therefore representative of the average behavior is needed to remove the random bias for the evaluation.
second random sampling from an expected coverage per execution can simulate the hit count datafor anarbitrarysamplesize.
sincerecordingeveryhit count 4we remove schedule and printtokens as they have the same semantics with schedule2 and printtokens2 butdifferentimplementation next to the subject name indicates the target node of the subject is the final statement of the crashing path.data for each new sample for a long fuzzing campaign of large programsisnotfeasible thehit countdataforourfiveopen source programsareonlyavailableevery15minutes.therefore thedatais coarse grained as the total number of data points is limited which deteriorates the statistical reachability analysis evaluation.
conversely hit countdataforanarbitrarysamplesizecanprovidea fine grainedevaluation of the statisticalreachabilityanalysis.
.
evaluationmetric environment forrq1 we record the wall clock time taken to measure the scalabilityofthemethods.
the wall clocktimetaken forthestatistical reachabilityestimatoralsoincludesthe timeforthesamplingprocess asthecomputingcostoflaplaceestimatorispracticallynegligible.whileitisclearthattheaccuracyofthestatisticalreachability estimatorwould increase as thesamplesize increases we define a thresholdofthesuccessfulestimationtomeasurehowmuchcostis needed to get an accurate estimation.
we say the statistical reachabilityestimatorsucceedsintheestimationwith u1d441 u1d460executionsifall the errorsof tencontinuing estimates until u1d441 u1d460 thestimation e.g.
lap u1d460 u1d441 u1d460 lap u1d460 u1d441 u1d460 forlaplaceestimator fallbetween and of the ground truthprobability in logarithmic scale.
.
barex barexlog10 gt barex barex barex barexlog10 e barex barex .
barex barexlog10 gt barex barex where u1d452is the estimated probability and u1d43a u1d447is the ground truth probability.weuselogarithmicscalesinceitismoresensitiveto theestimationerrorwhentheprobability issmall.thewall clock time takenfor the statistical reachability estimator in rq1is then thetimetakenuntilthe u1d441 u1d460 thestimation.ourtimeoutthreshold fortheestimationis15minutes.iftheestimationdoesnotfinish within minutes we considerthe estimationas failed.
forrq2 we compute the accuracy of the estimated probability bycomputingthelogarithmicerrorbetweentheestimatedprobabilityandthe ground truth probability log err u1d452 u1d43a u1d447 log10 e log10 gt .
if the log err is it means that the estimated probability is one orderofmagnitudedifferentfromtheground truthprobability.we measure the time taken for both the sampling process and estimation in rq2.
in addition we also record the time taken of the estimation for the structure aware estimator explicitly to compare thescalabilityofthestructure awareestimatoritselfwiththeblackboxestimatorwhosetimetakenfortheestimationisnegligible.for all the experiments including the greybox fuzzing campaigns and the estimation process we repeat the process ten times and report the averagevalueto reduce the random bias.
for the experiments we use the pse implementation in which is implemented on top of symbolic pathfinder spf as the original work does and uses latte model counting tool.
since the implementation does not support a signed bit domain we use a signed bit domain for pse.
for the laplace and the structure aware estimator we use the smoothing factor u1d6fc 2as it is the representative value driven from the mid point of the wilson interval with confidence .
we use preach implementationprovidedbytheauthors withthepolyhedra domainasthedefaultabstractinterpretationdomain preach p .all the experiments are performed in a ubuntu .
docker container with64coresof amdepyc7713p .0ghz and251gb memory.
332esec fse december3 san francisco ca usa seongmin lee andmarcelb hme result .1rq1 analytic method vs. statistical method table3 quantitativereachabilityestimationforsv comp 2021benchmarks.esti andt aretheprobabilityestimate andthetimespentfortheestimator to nl dtmc arethe failure states of the estimation.
o x in the parenthesis after thevalue representswhether theestimator succeeds.
program gtesti pse t pse esti pr t pr esti lap t lap exmit t .7e o .866s .6e o .9s .0e o .044s exe1 f .
nl x .
o .5s .
o .006s exe2 f .
nl x .
x .6s .
o .003s exe4 f .
nl x .
x .7s .
o .014s exe6 f .
nl x .3e x .8s .
o .001s exe8 f .
nl x .
x .7s .
o .005s exe10 f .
nl x .
o .5s .
o .005s exe10 t 0nl x .2e o .5s .0e o .085s exe12 f .
.
o .934s .
o .6s .
o .004s exe12 t .
.
x .966s .
o .6s .
o .007s exe13 t o .909s .0e o .7s .0e o .087s exe14 t .
.
x .860s .
o .9s .
o .018s exe15 t .
.
x .910s .
o .1s .
o .011s exe18 f .
nl x .
o .5s .
o .011s exe19 t .
.
x .950s .
o .5s .
o .015s exe20 f .
nl x .
x .6s .
o .008s exe20 t .
.
o .903s .
o .5s .
o .008s exe26 f .
nl x .
x .7s .
o .006s exe27 f .
.
o .849s .
o .7s .
o .004s fneg t o .850s .
x .5s .0e o .045s lcmp t o .832s .
x .9s .0e o .044s simple f o .854s to x .0e o .048s simple t o .844s to x .0e o .047s suzette f .
.
o .910s .7e x .8s .
o .030s suzette t .6e o .926s .6e o .4s .0e o .084s assign t o .841s .
x .6s .0e o .045s insertsort2 .1e to x .5e x .8s .1e o 904s rbtree1 .
to x dtmc x .4s .
o .002s assert3 .7e o .847s .3e o .6s .0e o .044s if icmp1 o .856s .0e o .5s .0e o .045s switch1 .
o .03s .
o .9s .0e o .044s token2 .8e nl x to x .2e o .545s q uantitative results.
table3shows the quantitative reachability estimation result for the programs we select from the sv comp benchmark.
the first and second columns show the program name and the ground truth reaching probability of the target assertions.
each 3rd 4th 5th 6th and 7th 8th column represents the result from pse preach and laplace estimator.
esti and t are estimator sprobability estimateandtime spent.
among subject programs pse successfully estimates the reachingprobabilityof15programs.thesymbolicexpressionof thepathconditiontoreachthetargetassertioncontainsnon linear termsin11programs nlinthetable whichisnotsupportedby pse implementation.
pse timeouts to in the table for the two programs which are the exact two programs containing a loop.
pseestimatesthewrongprobabilityfortheotherfourprograms because the implementation does not consider the overflow underflowoftheintegervariables.onaverage psespends 1secondon the estimation.
in the case of preach the estimation succeeds only for17outof32programs.for15failingestimations thereisone timeoutduringtheabstractinterpretation twotimeoutsduringthe model counting to in the table and one divergence of dtmc dtmc .fortheremainings preachestimatedfarsmaller larger probabilitiesthanthegroundtruth.withoutthecaseswherethe estimationfails the time spentfor estimationisover tenseconds.1voidtest string line 2string toks line.split 3inti 4for string t toks 5if i assert false i a tokentest021voidtest intx intz 2if z return instead of int y 4inty call .
ret3.sh 5z x y 6if x z 7assert false 8else 9print b4 b exe13 t 1voidtest inti 2if i 3if !
i assert false c assert31voidtest intz 2z z 3if z print b1 4else assert false d exe8 f figure simplified pseudocodes ofrq1subjects.
on the other hand the laplace estimator successfully estimates the reaching probability for all programs.
except insertsort thetimespentisstrictlylessthanonesecond includingthetime for the sampling program executions .
among the programs the average time spent estimating the assertion statements with feasiblereachingprobabilities gt is0.039seconds median .
and the average number of samples needed u1d441 u1d460 is median .
to achieve an estimated probability of 6for thestatementsinfeasibletoreach thelaplaceestimatorrequires 106samples and the average time spent for it is .
seconds median .
.only insertsort2 takes4 904seconds mostlyon thesamplingprocess nottheestimation.thisisbecause insertsort runs the insertion sort in the worst case scenario u1d442 u1d45b2 for a random positive integernumber length array.
our result shows that the laplace estimator can successfully estimate the reaching probability of all subjects in table 3with highprecision generally inashortperiodoftime.ontheother hand pse and preach fail to estimate the accurate reaching probability ofnearly halfof the subjects.
q ualitative analysis.
we further investigate the properties of the programsthatpreventtheanalyticapproachfromestimatingthe correctreachingprobability of the program state.
token2 figure2a epitomizesthe limitationof the previously proposed probabilistic reachability analysis.
an arbitrary size of the array significantlyincreases the domain space line whose complexity becomes squared after the string api splitis applied line .
it is non trivial and requires manual effort to interpret the semanticsofanyapicall line2 .theloopinlines4 9areatypical example of the path explosion problem the number of paths to consider would grow exponentially with the size of the array if the true branch were not terminating the loop.
the non deterministic loop iterations line also obstructs the scalability precision of theanalysis asitneeds to consider themaximumnumber ofiterations.
finally the domain of variable iin line keeps changing at each loop iteration which makes branch selectivity based analysis difficult to compute the correct probability.
according to the result 333statisticalreachability analysis esec fse december3 san francisco ca usa pse fails to estimate the reaching probability for token2due to thelimitedsupportforthestringapi.evenifthestringapiissupported thepathexplosionproblemwouldstillmaketheanalysis hardly feasible as we have seen for the programs insertsort2 and rbtree1 intable3.bothoftheabstractinterpretation interval and polyhedra of preach reaches the timeout limit for token2.
the ground truthreachingprobability of token2is parenleftbigg94 parenrightbigg15 u1d43611 parenleftbigg94 parenrightbigg14 u1d4362 parenleftbigg1 parenrightbigg2 parenleftbigg94 parenrightbigg13 .
u1d452 whichistheprobabilityoftheinputstringhavingmorethan two spaces.
the vanilla preach without the abstract interpretation fails to estimate pr .
the correct reaching probability to the assertion.
conversely the laplace estimator successfully estimates theprobabilitywithlessthan1 oflog scaleerrorinahalf second.
by computing the branch selectivity probability and inducing thepathprobabilityusingdtmc preachavoidsthepathexplosion problem.
however applying the model counting to each branch ignores the domain change of variables during execution which mayleadtoasignificantinaccuracyintheprobabilityestimation.
for instance without abstract interpretation preach computes thereachingprobabilityoftheassertionin assert3 figure2c as .
where1 2stands for the branch selectivity for each branch yet the true probability is .
abstract interpretation thesolutionbypreach canpartiallysolvetheproblemof domainchange.whileitcanassisttheprogramlike assert3 which stillhas auniformdistributionafterthedomainchange itfailsto handle the case of exe8 f figure2d where the domain space becomesnon uniform thevaluedistributionofvariable zatline3 infigure 2disanon uniformdistributionbetween where has a double probability than other values due to thepreviousinstructions.therefore whilethetrueprobabilityof reachingtheassertionstatementatline9is .
themodel counting method computes .
ignoring the non uniform distribution of the domain space.6in addition a disjoint domain spaceoradomainspacethatrequiresacomplexdomainabstraction existsinthe real world whichalsohindersthe analytic approach.
finally we mention the opaque code problem.
by simply changingtheexpression ontherighthandsideofline3in exe13 t figure2b toanexternalcalltoashellscriptthatreturns3 sothat the semantics of the program remains unchanged pse and preach failtodeterminetheinfeasibilitytoreachtheassertion returning .25ofreachingprobability becausethecodeisunavailable.forthe same program with the shell script the laplace estimator correctly estimates that the assertion statementisinfeasibleto reach.
our qualitative investigation illustrates the limitation of the probabilistic reachability analysis to scale to real world programs.ontheotherhand thestatisticalreachabilityanalysis can scale independently of the complexity of the program semantics as it requiresonly thesamples ofprogram executions.table the average estimation time and the total time to produce the estimated probability u1d452oflog err u1d452 u1d43a u1d447 .
denotes that the estimator cannot produce the estimated probabilityoflog err u1d452 u1d43a u1d447 2within ofthe samples.
program esti struct total lap total gotu total struct tcas .14e 04s .53e 01s .04e 01s .63e 02s schedule2 .43e 04s .54e 01s .75e 01s .88e 02s totinfo .20e 04s .18e 01s .30e 02s printtokens2 .28e 04s .54e 03s .67e 03s replace .74e 04s .07e 01s .32e 00s .65e 03s gif2png .06e 03s .03e 01s .07e 00s .24e 02s jsoncpp .30e 04s .83e 02s .39e 03s jasper .48e 04s .37e 01s .40e 01s readelf .56e 02s .82e 02s .83e 02s freetype2 .77e 02s .04e 02s .41e 00s .
rq2 evaluationofstructuralinformation figure3ashowstheestimationresultsofthethreestatisticalreachabilityestimatorsontheprogramsfromthesiemenssuiteandfos c c programs libraries.the upperside ofthe figure shows the raw estimated reaching probability of the target statements and the below side shows the log err compared to the ground truth reaching probability.
for all the subject programs the result shows that the structure aware estimator is the most accurate and the good turing estimator is the least accurate across the different sample size the structure aware estimator is always better than or equal to the laplace estimator and so is to the good turing estimatorexceptforveryfewcasesduetotheunpreciseestimation withaverysmallsamples.duetothenon existence ofthesingleton thegood turingestimatorproducesnoestimationforsome sample size.
for instance it does not produce any estimation for the printtokens2 and jsoncpp.
figure3bpresents the average log err of the three statistical reachability estimators across the programs in the log scale.
in general theerrorofallthreeestimatorsdecreasesasthenumber of samples increases.
each laplace good turing and structureawareestimatorhasthelog errorof3.
.
and1.
respectively when .
of the expected number of samples needed to reach the targetstatementisprovided.onlythestructure awareestimator reaches a log error below .
while laplace and good turing estimators get to .
and .
respectively.
the below side of figure3bpresents the difference in the average log err between the structure aware estimator and the other twoestimators.
the maximumdifferencebetweenlaplace good turing andstructureaware estimator until of the samples is .
.
and the difference decreasesas the number of samples increases.
itisworthnotingthatthestructure awareestimatorisalsocostefficient.
table 4shows the average time spent by the structureaware estimator across the programs on average it took .
seconds for the estimation median 5e 04s which is comparable to the two other estimators whose computation formula is 6in table3 preach pestimated .5due to missmanagingthe operator.
7the horizontal dashed lines in the estimation plots represent the ground truth reachingprobabilityofthe targetstatements.they axisscaleof readelf and freetype2 estimationplotsislogarithmic.
334esec fse december3 san francisco ca usa seongmin lee andmarcelb hme a individual plotsfor each subject7 y of samples b averagelog err and differences figure three statistical reachability estimators good turing orange laplace blue structure aware green reaching probabilityestimationandtheerroroftargetstatementsintheprogramsfromsiemenssuiteandfosc c programs libraries.
rudimentary.thelastthreecolumnsoftable 4showthetotal sampling estimation time spent by the three estimators to reach the estimated probability of log err u1d452 u1d43a u1d447 2within of the executions where the bold values denotes the least time among the three estimators.
to reach means that everyestimate after the shown time is within the error bound.
the structure aware estimator requires the least time for most programs.
in contrast the good turing estimatorcould not produce the estimatewithin the error bound using of the executions for several programs.
since the structure aware estimator gives a more accurate estimationgiventhesamenumberofsamples oftentheoveralltime spentbythestructure awareestimatorislessthantheothertwo estimators.
thestatisticalreachabilityestimatorsareabletoestimatethe reachingprobabilityforpractical sizedprograms.ourstructureawareestimatoristhemostaccurateamongthethreeestimators within of the expected number of executions needed to reach the target statement the the estimate is less than one order ofmagnitude awayfrom the ground truth probability.
threats to validity various threats to the validity need to be concerned about as we evaluatetheperformanceofthereachabilityestimatorsempirically.
externalvalidity concernswhethertheresultsfromthestudycan be generalized.
to mitigate this concern we use various programswith different sizes and complexity sv comp siemens suite andfossoftware.in rq1 weusethesamebenchmarkusedbythe formerstudyforafaircomparisonandchoosethesubjectsbasedon the selection criteria.
we extend our investigation to the programs withalargersizeandcomplexityin rq2foramoregeneralevaluation.internalvalidity concernsthedegreeofconfidenceofour study havingnotbeen influencedbyanyfactorbeyondthescope ofthestudy.first tomitigatetherandomnessoftheexperiment weusenumerousrepetitionsofgreyboxfuzzingcampaignsandrun every estimator with ten repetitions.
second to avoid missing any potential error in our evaluation and to facilitate the reproduction ofour study we make our scripts anddata publiclyavailable.
related work beyondthequantitativereachabilityanalysis b hmeandcolleagues studytheempiricalmethodandthestatisticalframeworkforprogramanalysisingeneral andforsoftwaretestingspecifically .forinstance theyappliedthestatisticalapproachtoanalyzevariouspropertiesofblackboxfuzzingcampaigns including thetotalfeasiblebranchcoverage theadditionaltimerequiredto cover more branches and the residual risk that a vulnerability exists when no vulnerability has been discovered so far.
later they extended the approach to greybox fuzzing where the sampling distribution is updated during the testing process suggesting a methodology to avoid the adaptive bias in the statistical model .
335statisticalreachability analysis esec fse december3 san francisco ca usa another line of work that exploits the observation based statistical approach to estimating the program properties has been explored in the program dependency analysis .
binkley et al.
first proposed an observation based slicing orbs a program slicingtechniquethatcanbeappliedtoaprogramwritteninmultipleprogramminglanguages.ithasshownthat regardlessofhow actuallytheprogramisimplemented iftheruntimebehaviorofa programstateischangedafterperturbinganotherprogramstate thereisadependencybetweenthetwostates.usingthisobservation orbs can approximate the program dependency even for the dependencythatcannotbecapturedbythestaticanalysis .later leeetal.adoptedstatisticalmodelingandextendedthisslicingtechniquetoageneralprogramdependencyanalysistechnique .
discussion futurework throughouttheevaluation wehaveshownthatthestatisticalreachability analysis is a promising approach to estimating the reaching probability of a program.
not only is it scalable but it can also provide probability estimation with high precision for programs thatarenotamenabletotheprobabilisticreachabilityanalysis.furthermore ournovelstructure awareestimatordemonstratesthe benefitofincorporatingstructuralinformationintothestatistical reachability analysis.
the structure aware estimator can provide a moreaccurateestimationevenwithasmallnumberofexecution samples.
the main advantage of our structure aware reachability estimatoristhatitsystematicallyconsidersthehierarchicalrelationbetween the reached and unreached states.
therefore the estimation is well grounded interms ofthegivenstructure as we illustrated in figure and expected to be more accurate than the existing statistical estimators thatconsider the program asa blackbox.
at the sametime thestructure awarereachabilityestimatorismuchmore scalable than the probabilistic reachability analysis.
our estimator canemployanystructuralinformationthatcanbedrivenfroma light weighted static analysis which is more applicable than the symbolicexecutionandthemodelcounting.forthefuturework we willinvestigatehowthoseadvantagesofstatistical structure aware reachability analysis can actually benefit the concrete downstream applicationsonsoftware testingandmaintenance.
the probability distribution of reaching the successor program statesfromtheunreachedprogramstateshasbeenapproximated bytheuniformdistributioninourstructure awareestimator.while thisapproximationisreasonablewhenthereisnopriorknowledge any prior knowledge can be integrated into the structure aware estimatorbymodifyingtheprobabilitydistribution.forinstance the branch selectivity from preachcan be usedfor the probability distributionofreachingthesuccessorprogramstates.employing theinformationfromthestaticanalysiscanalsobehelpfultoimprovetheprecision soundnessoftheestimationresult.forinstance some statistical estimator e.g.
laplace may assign nonzero probability to the unreachable program states which can be avoided by using the information from the static analysis.
nonetheless we avoid using the model counting based methods in this study since it still requires considerable computational effort to run the model counting for every branch in a large program and it will restrict the domain of the variable to the integer domain.
in the future wewill investigate the beneficial integration of analytic and statistical methods.
data availabilitystatement all data scripts are publicly available through zenodo https .