empirical review of automated analysis tools on ethereum smart contracts thomas durieux inesc id and ist university of lisbon portugal thomas durieux.mejo o f. ferreira inesc id and ist university of lisbon portugal joao joaoff.com rui abreu inesc id and ist university of lisbon portugal rui computer.orgpedro cruz inesc id and ist university of lisbon portugal pedrocrvz gmail.com abstract overthelastfewyears therehasbeensubstantialresearchonautomatedanalysis testing anddebuggingofethereumsmartcontracts.
however itisnottrivialtocompareandreproducethatresearch.
toaddressthis wepresentanempiricalevaluationof9state of theart automated analysis tools using two new datasets i a datasetof annotated vulnerable smart contracts that can be used toevaluate the precision of analysis tools and ii a dataset with all the smart contracts in the ethereum blockchain that have solidity sourcecodeavailableonetherscan atotalof47 518contracts .the datasets are part of smartbugs a new extendable execution frameworkthatwecreatedtofacilitatetheintegrationandcomparison betweenmultipleanalysistoolsandtheanalysisofethereumsmart contracts.
we used smartbugs to execute the automated analysis toolsonthetwodatasets.intotal weran428 337analysesthattookapproximately564daysand3hours beingthelargestexperimental setup to date both in the number of tools and in execution time.
wefoundthatonly42 ofthevulnerabilitiesfromourannotated datasetaredetectedbyallthetools withthetool mythrilhaving the higher accuracy .
when considering the largest dataset we observed that of contracts are tagged as vulnerable thus suggesting a considerable number of false positives.
indeed only a small numberof vulnerabilities and ofonly two categories were detected simultaneously by four or more tools.
ccs concepts software and its engineering software defect analysis software testing and debugging.
keywords smart contracts solidity ethereum blockchain tools debugging testing reproducible bugs acm reference format thomas durieux jo o f. ferreira rui abreu and pedro cruz.
.
empirical review of automated analysis tools on ethereum smart permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe firstpage.copyrights forcomponentsof thisworkowned byothersthan the author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspecificpermission and or a fee.
request permissions from permissions acm.org.
icse may seoul republic of korea copyright held by the owner author s .
publication rights licensed to acm.
acm isbn ... .
42ndinternationalconferenceonsoftwareengineering icse may23 seoul republicofkorea.
acm newyork ny usa pages.
introduction blockchaintechnologyhasbeenreceivingconsiderableattention fromindustryandacademia foritpromisestodisruptthedigital onlineworldbyenablingademocratic open andscalabledigital economybasedondecentralizeddistributedconsensuswithoutthe interventionofthird partytrustedauthorities.amongthecurrently available blockchain based platforms ethereum is one of the most popular mainly because it enables developers to write distributed applications dapps based on smart contracts programs thatareexecutedacrossadecentralisednetworkofnodes.themain language used to develop ethereum smart contracts is solidity1 a high levellanguagethatfollowsajavascript like object oriented paradigm.contractswritteninsolidityarecompiledtobytecode that can be executed on the ethereum virtual machine evm .
smart contracts are at the core of ethereum s value.
however asnotedbysomeresearchers duetotheidiosyncrasiesof the evm writing secure smart contracts is far from trivial.
in a preliminarystudyperformedonnearlyonemillionethereumsmart contracts using oneanalysisframework forverifyingcorrectness 200ofthemwereflaggedasvulnerable .also luu etal.
proposedthesymbolicexecutiontooloyenteandshowedthatof 366ethereumsmartcontractsanalyzed around46 were flaggedasvulnerable.famousattacks suchasthedaoexploit and the parity wallet bug illustrate this problem and have led to huge financial losses.
there has been some effort from the research community to developautomatedanalysistoolsthatlocateandeliminatevulnera bilitiesinsmartcontracts .however itisnoteasyto compareandreproducethatresearch eventhoughseveralofthe toolsarepubliclyavailable thedatasetsusedarenot.ifadeveloperofanewtoolwantstocomparethenewtoolwithexistingwork the current approach is to contactthe authors of alternative tools and hope that they give access to their datasets as done in e.g.
.
the aim of this paper is twofold.
first to be able to execute and compare automated analysis tools hence setting the groundfor fair comparisons we provide two datasets of solidity smart contracts.thefirstdatasetcontains69manuallyannotatedsmart contracts that can be used to evaluate the precision of analysis tools.theseconddatasetcontainsallavailablesmartcontractsin 1interested readers on solidity refer to ieee acm 42nd international conference on software engineering icse theethereumblockchainthathavesoliditysourcecodeavailable on etherscan a total of contracts at the time of writing.
we have executed state of the art automated analysis tools on the two datasets and analyzed the results in order to provide a fair point of comparison for future smart contract analysis tools.
in total theexecutionofallthetoolsrequired564daysand3hours to complete analyses.
second tosimplify research on automated analysistechniques for smart contracts we provide a novel extendable and easy touse execution framework called smartbugs to execute these tools on the same execution environment.
this framework currently contains configured smart contract analysis tools.
in summary the contributions of the paper are a dataset of annotatedvulnerablesoliditysmartcontracts adatasetthatcontainsalltheavailablesmartcontractsfromtheethereumblockchain thathavesoliditysourcecodeavailableinetherscan anexe cution framework that includes pre configured smart contractanalysis tools and an analysis of the execution of tools on smart contracts.
ourstudydemonstratesthatthereareseveralopenchallenges that need to be addressed by future work to improve the quality ofexistingtoolsandtechniques.wereportthatthecurrentstateof the artisnotabletodetectvulnerabilitiesfromtwocategories of dasp10 bad randomness andshort addresses.
also the tools are only able to detect together of the vulnerabilities fromour dataset of annotated vulnerable smart contracts out of .
the most accurate tool mythril is able to detect only of the vulnerabilities.
when considering the largest dataset of contracts are tagged as vulnerable thus suggesting a considerable number of false positives.
in conclusion we show that state ofthe art techniques are far from being perfect still likely producing too many false positives.
on the positive side the best performing techniques do so at a marginal execution cost.
smartbugs is available at study design blockchain technologies are getting more and more attention from theresearchcommunityand also more importantly fromindustry.
asmore blockchain basedsolutions emerge thereis ahigher reliance on the quality of the smart contracts.
the industry and the research community came up with automatic approaches that analyzesmartcontractstoidentifyvulnerabilitiesandbadpractices.
themaingoalofthispaperistoreportthecurrentstateoftheartof currentlyavailableautomatedanalysistoolsforsmartcontracts.to facilitatereproducibility andcomparisonbetweentools thestudy is performed using a new extendable execution framework that we call smartbugs see section .
.
in this section we present the design of our study including the research questions the systematic selection of the tools and datasets of smart contracts the execution framework and the data collection and analysis methodology.
.
research questions in this study we aim to answer the following research questions rq1.
what is the effectiveness of current analysis tools in detecting vulnerabilities in solidity smart contracts?
in this first research question we are interested in deter mining how precise state of the art analysis tools are in detecting vulnerabilities in known faulty smart contracts.
rq2.
how many vulnerabilities are present in the ethereum blockchain?
in this research question we investigate the vulnerabilities that are detected in contracts pulled from the ethereum blockchain.weconsiderthemostpopularvulnerabilities theevolution of the vulnerabilities over time and the consensus among different combinations of automated analysis tools.
rq3.
how long do the tools require to analyze the smart contracts?
and finally we compare the performance of the analysis tools.
the goal is to identify which tool is the most efficient.
.
subject tools in order to discover smart contract automated analysis tools we startedoffbyusingthesurveyofangelo etal.
andweextended their list of tools by searching the academic literature and theinternet for other tools.
we ended up with the tools that are listed in table .
notalltheidentifiedtoolsarewellsuitedforourstudy.onlythe tools that met the following three inclusion criteria were included in our study criterion .
the tool is publicly available and supports a command line interface cli .
the cli facilitates the scalability of the analyses.
criterion .
thetooltakesasinputasolidity contract.
this excludes tools that only consider evm bytecode.
criterion .
thetoolrequiresonlythesourcecode of the contract to be able to run the analysis.
this excludes tools that require a test suite or contracts annotated with assertions.
criterion .
thetoolidentifiesvulnerabilities or bad practices in contracts.
this excludes tools that are describedasanalysistools butonlyconstructartifactssuchas control flow graphs.
after inspecting all analysis tools presented in table we found tools that meet the inclusion criteria outlined.
table presentstheexcludedandincludedtools andfortheexcludedones it also shows which criteria they did not meet.
honeybadger isdevelopedbyagroupofresearchersatthe university of luxembourg and is an oyente based see below tool thatemployssymbolicexecutionandasetofheuristicstopinpoint honeypotsin smartcontracts.honeypots aresmart contractsthat appearto have an obvious flaw in their design which allows an arbitrary user to drain ether2from the contract given that the user transfers a priori a certain amount of ether to the contract.
whenhoneybadgerdetectsthatacontract appearstobevulnerable it means that the developer of the contract wanted to make the contract look vulnerable but is not vulnerable.
maian developedjointlybyresearchersfromthenational university of singapore and university college london is also based on the oyente tool.
maian looks for contracts that can be 2ether is the cryptocurrency of ethereum.
531table tools identified as potential candidates for this study.
tools tool urls contractlarva e evm echidna erays ether n a ethersplay ethertrust ethir fsolidm gasper n a honeybadger honeybadger kevm madmax maian manticore mythril octopus osiris oyente porosity rattle reguard n a remix sasc n a scompile n a securify slither smartcheck solgraph solhint solmet teether vandal verisol zeus n a table excluded and included analysis tools based on our inclusion criteria.
inclusion criteria tools that violate criteriaexcluded available and cli c1 ether gasper reguard remix sasc scompile teether zeus compatible input c2 madmax vandalonly source c3 echidna verisolvulnerability finding c4 contractlarva e evm erays ethersplay ethertrust ethir fsolidm kevm octopus porosity rattle solgraph solmet solhintincluded honeybadger maian manticore mythril osiris oyente securify slither smartcheck self destructedordrainedofetherfromarbitraryaddresses orthat accept ether but do not have a payout functionality.
a dynamicanalysis in a private blockchain is then used to reduce the number of false positives.
manticore developedbytrailofbits alsousessymbolic execution to find execution paths in evm bytecode that lead to reentrancy vulnerabilities and reachable self destruct operations.
mythril developedbyconsensys reliesonconcolicanalysis taintanalysisandcontrolflowcheckingoftheevmbytecodeto prune the search space and to look for values that allow exploiting vulnerabilities in the smart contract.
osiris developed by a group of researchers at the universityofluxembourg extendsoyentetodetectintegerbugsinsmart contracts.
oyente developed by melonport ag is one of the first smartcontractanalysistools.itisalsousedasabasisforseveral other approaches like maian and osiris.
oyente uses symbolic execution on evm bytecode to identify vulnerabilities.
securify developedbyicecenteratethzurich statically analyzesevmbytecodetoinferrelevantandprecisesemanticinformation about the contract using the souffle datalog solver.
it then checks compliance and violation patterns that capture sufficient conditions for proving if a property holds or not.
slither developedbytrailofbits isastaticanalysisframework that converts solidity smart contracts into an intermediate representation called slithir and applies known program analysis techniquessuchasdataflowandtainttrackingtoextractandrefine information.
smartcheck developedbysmartdec isastaticanalysis tool thatlooks for vulnerabilitypatterns and badcoding practices.
it runs lexical and syntactical analysis on solidity source code.
.
datasets of smart contracts for this study we crafted two datasets of solidity smart contracts withdistinctpurposes.thefirstdataset sbcurated consistsof69 vulnerable smart contracts see section .
.
.
contracts in this datasetareeitherrealcontractsthathavebeenidentifiedasvulner ableorhavebeenpurposelycreatedtoillustrateavulnerability.the goalofthisdatasetistohaveasetofknownvulnerablecontracts labelled with the location and category of the vulnerabilities.
thisdataset can be used to evaluate the effectiveness of smart contract analysis tools in identifying vulnerabilities.
the second dataset is named sbwild see section .
.
and contains47 518contractsextractedfromtheethereumblockchain.the set of vulnerabilities of those contracts is unknown however this datasetcan beusedto identifyrealcontracts thathave potential vulnerabilities and have an indication of how frequent a specific problemis.itcanalsobeusedtocompareanalysistoolsinterms of metrics such as performance.
.
.
sbcurated a dataset of vulnerable smart contracts.
goal.our objective in constructing this dataset is to collect a set of solidity smart contracts with known vulnerabilities from deployed contracts in the ethereum network to examples provided to illustrate vulnerabilities that can serve as a dataset suite for researchinthesecurityanalysisofsoliditysmartcontracts.weuse thetaxonomypresentedinthedasp3todescribevulnerabilitiesof 3decentralized application security project or dasp 532ethereumsmartcontracts seecategoriesintable3 .eachcollected contract is classified in one of the ten categories.
we also manually taggedthelinesthatcontainthevulnerability.thisclassification allows for new smart contract analysis tools to be easily evaluated.
collection methodology.
this dataset has been created by collectingcontractsfromthreedifferentsources .githubrepositories .blogpoststhatanalyzecontracts and3.theethereumnetwork.
ofthecontractswerecollectedfromgithubrepositories.we identifiedgithubrepositoriesthatmatchrelevantsearchqueries vulnerable smart contracts smart contracts security solidity vulnerabilities and contain vulnerable smart contracts.
we searched google using the same queries.
we found several repositories with vulnerablesmartcontractssuchas not so smart contracts4andswc registry5.
the latter is a classification scheme for security weaknesses in ethereum smart contracts that is referenced in mythril s githubrepository.wealsoextractedvulnerabilitiesthatcomefrom trusted entities in blog posts where smart contracts are audited tested or discussed such as positive.com 6and blockchain.unica7.
and finally we used etherscan8to collect smart contracts that are deployed on the ethereum network and are known to contain vulnerabilities e.g.theoriginalsmartbillionscontract .notethatall thecontractswerecollectedfromtrustedentitiesinthefield.we also ensure the traceability of each contract by providing the url from which they were taken and its author where possible.
dataset statistics.
the dataset contains contracts and tagged vulnerabilities divided into ten categories of vulnerabilities.
table presents information about the contracts.
each line contains a category of vulnerability.
for each category we provide a description the level at which the attack can be mitigated thenumberofcontractsavailablewithinthatcategory andthetotal number of lines of code in the contracts of that category.
dataset availability.
the dataset is available in the repository of smartbugs .
the dataset is divided into ten folders named withthe dasp categories andthe folders contain thecontracts of that category.
moreover the dataset contains the file vulnerabilities.json which contains the details of each vulnerable contract.
it details the name the origin url the path and the lines and the category of the vulnerabilities.
.
.
sbwild contracts from the ethereum blockchain.
goal.the goal of this second dataset is to collect as many smart contracts as possible from the ethereum blockchain in order to have a representative picture of the practice and potential vulnerabilities that are present in the production environment.
collection methodology.
the data collection for the second dataset follows a different strategy.
in this dataset we collect all the different contracts from the ethereum blockchain.
etherscan allowsdownloadingthesourcecodeofacontractifyouknowits address.therefore wefirstlyusegooglebigquery tocollect the ethereum contract addresses that have at least one transaction.
weusedthefollowingbigqueryrequesttoselectallthecontract 4not so smart contracts 5swc registry 6positive.com 7blockchain.unica 8etherscan and count the number of transactions that are associated with each contract9 select contracts.address count as tx count from ethereum blockchain.contracts as contracts join ethereum blockchain.transactions as transactions on transactions.to address contracts.address group by contracts.addressorder by tx count desc after collecting all the contract addresses we used etherscan and its api to retrieve the source code associated with an address.
however etherscandoesnothavethesourcecodeforeverycontract.therefore attheendofthisstep weobtainedasolidityfile foreachcontractthathasitssourcecodeavailableintheetherscan platform.
the finalstep wasto filterthe set ofcontracts toremove duplicates.indeed weobservethat95 oftheavailablesoliditycontracts are duplicates.
we consider that two contracts are duplicates when the md5 checksums of the two source files are identical after removing all the spaces and tabulations.
datasetstatistics.
table4presentsthestatisticsofthisdataset.
the query on google bigquery retrieved smart contract addresses.
we then requested etherscan for the solidity source codeofthosecontracts andweobtained972 975solidityfiles.this means that of the contracts do not have an associated sourcefileinetherscan.thefilteringprocessofremovingduplicate contractsresultedin47 518uniquecontracts atotalof9 lines .accordingtoetherscan 47contractsthatwerequesteddo not exist we labelled those as unaccessible .
dataset availability.
the dataset is available on github .
the dataset contains the solidity source code of each of the contracts.thecontractsarenamedwiththeaddressofthecontract.
we also attached with this dataset additional information in order to use this dataset for other types of studies.
it contains the nameofthecontract thesolidityversionthathasbeenusedto compilethecontract theaddressesoftheduplicatedcontracts the number of transactions associated with the contract the sizeofthecontractinlinesofsoliditycode thedateofthelast transactionsforthe2 096contracts thedateofcreationfor the contracts and the ethereum balance of contracts that have their source code available.
.
the execution framework smartbugs wedevelopedsmartbugs anexecutionframeworkaimingatsimplifying the execution of analysis tools on datasets of smart contracts.
smartbugs has the following features a plugin system to easily add new analysis tools based on docker images parallel execution of the tools to s peed up the ex ecution time an output mechanism that normalizes the way the tools are outputting the results and simplify the process of the output across tools.
smartbugs currently supports tools see section .
.
9the query isalso available at the followingurl savedquery 47fd9afda3f8495184d98db6ae36a40c 533table categories of vulnerabilities available in the dataset sbcurated.
for each category we provide a description the level atwhichtheattackcanbemitigated thenumberofcontractsavailablewithinthatcategory andthetotalnumberoflinesof code in the contracts of that category computed using cloc .
.
category description level contracts vulns loc access control failure to use function modifiers or use of tx.origin solidity arithmetic integer over underflows solidity bad randomness malicious miner biases the outcome blockchain denial of service the contract is overwhelmed with time consuming computations solidity front running twodependent transactionsthat invokethe same contractare includedin oneblock blockchain reentrancy reentrant function calls make a contract to behave in an unexpected way solidity short addresses evm itself accepts incorrectly padded arguments evm time manipulation the timestamp of the block is manipulated by the miner blockchain unchecked low level callscall callcode delegatecall or send fails and it is not checked solidity unknown unknowns vulnerabilities not identified in dasp n a total table statistics on the collection of solidity smart contracts from the ethereum blockchain.
solidity source not available solidity source available unaccessible total unique solidity contracts loc .
.
architecture.
smartbugs is composed of five main parts thefirstconsistsofthecommand lineinterfacetousesmartbugs see section .
.
.
the second part contains the tool plugins.eachtoolplugincontainstheconfigurationofthetools.theconfiguration contains the name of the docker image the nameof the tool the command line to run the tool the description of thetool andthelocationoftheoutputofresults.
thedocker imagesthatarestoredondockerhub.weusedockerimagesof the tools when a docker image is already available otherwise wecreate our own image all docker images are publicly available on docker hub including our own .
the datasets of smart contracts seesection2.
.
thesmartbugs runnerputsalltheparts ofsmartbugstogethertoexecutetheanalysistoolsonthesmart contracts.
.
.
datasetinterfacedetails.
smartbugsprovidesacommandline interface that simplifies the execution of the smart contract analysistools.ittakesasetoftoolnamesandapathtosolidityfiles to analyze and produces two files per execution a result.log filethatcontainsthestdoutoftheexecutionand2 a result.json file that contains the results of the analysis in a parsable format.
moreover weprovidescriptsthatprocessthoseoutputsandrender them in readable tables such as the one presented in this paper.
.
data collection and analysis toanswerourresearchquestions weusedsmartbugstoexecute the9toolsonthetwodatasetsdescribedinsection2.
.wecollected the output and used it for further analysis.
in this section wedescribethesetupofthetools section2.
.
andtheirexecution section .
.
.
.
.
tools setup.
for this experiment we set the time budget to minutes per analysis.
in order to identify a suitable time budget foroneexecutionofonetooloveronecontract wefirstexecuted allthetoolson sbcurateddataset.wethenselectedatimebudget that is higher than the average execution time one minute and seconds .
if the time budget is spent we stop the execution and collect the partial results of the execution.
during the execution of our experiment manticore was the only tool that faced timeouts.
.
.
large scale execution.
to our knowledge we present the largest experimental study on smart contract analysis both in the numberoftoolsandinexecutiontime.intotal weexecuted9analysis tools on contracts.
this represents analyzes which took approximately days and hours of combined execution morethanayearofcontinuousexecution.weusedtwocloud providers to rent the servers required for this experiment.
the first provider was scaleway where we used three servers with32vcpuswith128gbofram.weaddedabudgetof500 e and we spent .
e. thesecondproviderwasgooglecloud11 wherewealsoused threeserverswith32vcpuswith30gbofram.wespent1038.
e with google cloud.
in total we spent .
eto execute the experiments discussed in this paper.
we used two cloud providers due to administrative restrictions on our budget line.
we were initiallytargetingscalewaybecauseitischeaperthangooglecloud but we were not able to spend more than ewith this provider.
all the logs and the raw results of the analysis are available at .
results the results of our empirical study as well as the answers to our research questions are presented in this section.
.
precision of the analysis tools rq1 toanswerthefirstresearchquestion weused sbcurated thedataset of69contractsdescribedinsection2.
.
.sinceeachcontractofthis 10scaleway 11google cloud 534table5 vulnerabilitiesidentifiedpercategorybyeachtool.thenumberofvulnerabilitiesidentifiedbyasingletoolisshown in brackets.
category honeybadger maian manticore mythril osiris oyente securify slither smartcheck total access control arithmetic denial service front running reentrancy time manipulation uncheckedlowcalls other total table total number of detected vulnerabilities by each tool including vulnerabilities not tagged in the dataset.
category honeybadger maian manticore mythril osiris oyente securify slither smartcheck total access control arithmetic denial of service front running reentrancy time manipulation unchecked low level calls unknown unknowns total dataset is categorized in one of the ten dasp categories we can compute the ability of the tools in detecting the vulnerabilities present in the69 contracts.
themethodology that we followedto answerthisresearchquestionwasthefollowing weexecuted the tools on the contracts.
the result of this execution is available on github .
we extracted all the vulnerabilities that were detected by the tools into a json file.
we mapped the detectedvulnerabilitiestoacategoryofvulnerabilities seetable3 .toachievethistask wemanuallyannotatedallthevulnerabilitytypes thathavebeendetectedintooneofthetendaspcategories.for example oyentedetectsavulnerabilitycalled integer overflow that we link to the category arithmetic.
in total we identify vulnerability types and of them have been tagged in one of the ten categories.
the remaining do not fit the dasp taxonomy for example some tools warn about the use of inline assembly which is considered a bad practice but does not necessarily lead to vulnerablecontracts atthispoint wewereabletoidentify which vulnerabilities the tools detect.
unfortunately we found out that none of the tools were able to detect vulnerabilities of the categories bad randomness andshort addresses.
this is unsurprising it is expected that tools do not detect vulnerabilities of certain categories since they are not designed to identify all types of vulnerabilities.
despite not seeing this as a limitation of the studied tools we argue that our analysis gives insight on opportunities to improve them since it provides an overview on how tools perform with respect to the taxonomy used.
theresultsofthisfirststudyarepresentedintable5andtable6.
thefirsttablepresentsthenumberofknownvulnerabilitiesthat 12the mapping that we created is available at smartbugs wiki vulnerabilities mapping.have been identified.
a vulnerability is considered as identified whenatooldetectsavulnerabilityofaspecificcategoryataspecific line and it matches the vulnerability that has been annotated in thedataset.eachrowoftable5representsavulnerabilitycategory and each cell presents the number of vulnerabilities where the tooldetectsavulnerabilityofthiscategory.somecellsintable5 have numbers enclosed in brackets these denote the number of vulnerabilities identified by a single tool.
this table summarizes the strengths and weaknesses of the current state of the art of smartcontractanalysistools.itshowsthatthetoolscanaccuratelydetectvulnerabilitiesofthecategories arithmetic reentrancy time manipulation unchecked low level calls and unknown unknowns.
withrespecttothecategory unknownunknowns thetoolsdetected vulnerabilities such as the presence of uninitialized data and the possibilityoflockingdownether.however theyw erenotaccurate in detecting vulnerabilities of the categories access control denial ofservice and frontrunning.thecategories badrandomness and short addresses are not listed since none of the tools are able to detectvulnerabilitiesofthesetypes.thisshowsthatthereisstill room for improvement and potentially for new approaches to detect vulnerabilities of the ten dasp categories.
table5alsoshowsthatthetoolsofferdistinctaccuracies.indeed thetoolmythrilhasthebestaccuracyamongthe9tools.
mythril detects27 ofallthevulnerabilitieswhentheaverageofalltools is .
the ranking of the tools is comparable to the one observed by parizi et al.
.
however the average accuracy is lower on our benchmark sbcurated.
moreover mythril manticore slither andsmartcheck are the tools that detect the largest number of differentcategories 5categories .wecanalsoseethat slitheristhe tool that uniquely identifies more vulnerabilities vulnerabilities 535across5categories .despiteitsgoodresults mythrilisnotpowerful enoughtoreplaceallthetools bycombiningthedetectionabilities ofallthetools wesucceedtodetect42 ofallthevulnerabilities.
however depending on the available computing power it might not be realistic to combine all the tools.
therefore we suggest the combination of mythrilandslither.
thiscombinationdetects42 uniquevulnerabilities.thiscombinationoffersagoodbalancebetweenperformanceandexecution cost.thiscombinationisthebestpossiblecombinationbyaconsiderable margin.
the second best combination mythrillandoyente only succeeds to detect of all the vulnerabilities.
wenowconsiderallthevulnerabilitydetectionsandnotonlythe ones that have been tagged in sbcurated.
table presents the total numberofvulnerabilitiesdetectedbythetools.thistableallows thecomparisonofthetotalnumberofdetectedvulnerabilitieswith the number of detected known vulnerabilities shown in table .
the tools that are performing the best are also producing much more warnings i.e.
their output is more noisy making it difficult for a developer to exploit their results.
answer to rq1 .what is the accuracy of current analysis tools in detecting vulnerabilities on solidity smart con tracts?
by combining the tools together they are only able todetect42 ofallthevulnerabilities.thisshowsthatthereis stillroomtoimprovetheaccuracyofthecurrentapproachesto detectvulnerabilitiesinsmartcontracts.weobservethatthetools underperform to detect vulnerabilities in the following three categories access control denial of service and front running.
they areunable todetect by designvulnerabilities from bad randomnessandshort addresses categories.
we also observe that mythril outperformstheothertoolsbythenumberofdetectedvulnerabilities and by the number of vulnerability categories thatittargets 9categories .thecombinationof mythriland slitherallows detecting a total of vulnerabilities which is the best trade off between accuracy and execution costs.
.
vulnerabilities in production smart contracts rq2 to answer the second research question we analyzed the ability of the9selectedtoolstodetectvulnerabilitiesinthecontractsfrom the dataset sbwild described in section .
.
.
we followed the same methodology asin the previous research question however forsbwild we do not have an oracle to identify the vulnerabilities.
table7presentstheresultsofexecutingthe9toolsonthe47 contracts.
it shows that the tools are able to detect eight different categories of vulnerabilities.note that the vulnerabilities detected byhoneybadger arecontractsthatlookvulnerablebutarenot.they are designed to look vulnerable in order to steal ether from people thattriestoexploitthevulnerability.intotal 589contracts have at least one vulnerability detected by one of the tools.
suchahighnumberofvulnerablecontractssuggeststhepresenceofaconsiderablenumberoffalsepositives.
oyenteistheapproachthatidentifiesthehighestnumberofcontractsasvulnerable mostlyduetovulnerabilitiesinthe arithmetic category.this observation is coherent with the observation of parizi et al.
050100honeybadger1234 050100maian 050100manticore 050100mythril 050100osiris 050100oyente 050100securify 050100slither 050100smartcheck access control arithmetic denial of service front running reentrancy time manipulation unchecked calls unknown unknowns050100total figure proportion of vulnerabilities identified by exactlyone two or three tools and by four tools or more .
536table the total number of contracts that have at least one vulnerability analysis of contracts .
category honeybadger maian manticore mythril osiris oyente securify slither smartcheck total access control arithmetic denial of service front running reentrancy time manipulation unchecked low calls0 unknown unknows26 total sincetheydeterminethat oyentehasthehighestnumberoffalse positives when compared to mythril securify and smartcheck.
since we observed a potentially large number of false positives weanalyzedtowhatextentthetoolsagreeinvulnerabilitiesthey flag.
the hypothesis is that if a vulnerability is identified exclusively by a single tool the probability of it being a false positive increases.
figure presents the results of this analysis.
this figure shows the proportion of detected vulnerabilities that have been identified exclusively by one tool alone two tools three tools and finallybyfourormoretools.
honeybadger hasapeculiar butuseful role ifhoneybadger detects a vulnerability it actually means that thevulnerabilitydoesnotexist.so consensuswith honeybadger suggests the presence of false positives.
it is clear from the figure that the large majority of the vulnerabilities have been detected by one tool only.
one can observe that there are .
of the arithmetic vulnerabilities found by more than one tool.
it is also the category with the highest consensus betweenfourandmoretools 937contractsareflaggedashavingan arithmetic vulnerability with a consensus of more than three tools.
it is followed by the reentrancy category with contracts receiving a consensus of four tools or more.
these results suggest that combiningseveralofthesetoolsmayyieldmoreaccurateresults with fewer false positives and negatives.
the toolhoneybadger is different instead of detecting vulnerabilities it detects malicious contracts that try to imitate vulnerable contracts in order to attract transactions to their honeypots.
therefore when honeybadger is detecting a reentrancy vulnerability it means that the contract looks vulnerable to reentrancy but it is not.
figure shows that contracts identified by honeybadger withvulnerabilitiesoftype reentrancy havebeendetectedbythree other tools as reentrancy vulnerable.
wealsoanalyzedtheevolutionofthevulnerabilitiesovertime.
figure presents the evolution of the number of vulnerabilities by category.
it firstly shows that the total number of unique contracts started to increase exponentially at the end of when ether wasatitshighestvalue.secondly wecanobservetwomaingroups of curves.
the first one contains the categories arithmetic and unknown unknowns.
these two categories follow the curve of the total number of contracts.
the second group contains the othercategories.
the growing number of vulnerable contracts seemsto slow down from july .
finally this figure shows that the evolutionofcategories reentrancy anduncheckedlowlevelcalls is2015 creation date010000200003000040000 contracts unknown unknowns access control arithmetic denial of service front running reentrancy time manipulation unchecked low level calls contracts figure evolution of number of vulnerabilities over time.
figure3 correlationbetweenthenumberofvulnerabilitiesand balance in wei one ether is 18wei .
extremelysimilar thegreenlineof reentrancy isalsohiddenbythe blue line of unchecked low level calls .
this suggests a correlation between vulnerabilities in these two categories.
andlastly figure3presentsthecorrelationbetweenthenumber ofvulnerabilitiesandthebalanceofthecontracts.itshowsthatthe contracts that have a balance between 1014wei and 1020wei have morevulnerabilitiesthanothercontracts.hence therichestandthemiddle class seem to be less impacted.
per category we have not observed any significant differences worth reporting.
537answer to rq2 .how many vulnerabilities are present in the ethereumblockchain?
the tools identify vulnerabilities in of the contracts which suggests a high number of false positives.
oyente alone detects vulnerabilities in of the contracts.
by combining the tools to create a consensus we observe thatonlyafewnumberofvulnerabilitiesreceivedaconsensusof four or more tools for arithmetic and for reentrancy.
.
execution time of the analysis tools rq3 in this section we present the execution time required by the tools to analyze the of the sbwilddataset see section .
.
.
in ordertomeasurethetimeoftheexecution werecordedforeach individualanalysiswhenitstartedandwhenitended.theduration of the analysisis the difference betweenthe starting time andthe ending time.
an individual execution is composed of the following steps startthedockerimageandbindthecontracttothedocker instance clean the docker container and parse and output the logs to the results folder.
table8presentstheaverageandtotaltimesusedbyeachtool.
the average execution time is per contract.
it considers the execution of the tool on a contract including compilation construction of ir graphs analysis andparsing theresults.
in thetable wecan observethreedifferentgroupsofexecutiontime thetoolsthattake a few seconds to execute the tools that take a few minutes and manticore that takes minutes.
oyente osiris slither smartcheck andsolhintaremuchfastertoolsthattakebetween5and30seconds on average to analyze a smart contract.
honeybadger maian mythril and securifyareslowerandtakebetween1m24sand6m37s toexecute.finally manticoretakes24m28s.thedifferenceinexecu tiontimebetweenthetoolsisdependentonthetechniquethateach tool uses.
pure static analysis tools such as smartcheck andslither are fast since they do not need to compile nor execute contracts to identify vulnerabilities and bad practices.
securify maian mythril and manticore analyzetheevmbytecodeofthecontracts.itmeansthatthosetoolsrequirethecontract tobecompiledbefore manticore istheslowestofallthe tools because this tool only analyzes an internal contract at a time soliditysourcefilescancontainanarbitrarynumberofcontract definitions .
consequently this tool has the major drawback of having the compilation overhead for each internal contract that it analyzes.
theaverageexecutiontimedoesnotreflectthecompletepicture of the performance of a tool.
for example maianandmanticore use several processes and maianuses up to 16gb of ram.
consequently maianandmanticore aredifficulttoparallelize.wewere abletorunonlyfour andtenparallelexecutionsforrespectively maianandmanticore on a core server with 30gb of ram.
this alsoexplainswhywewerenotabletoexecutethosetwotoolson the complete dataset of smart contracts.
interestingly the slowest tools do not have better accuracy see section .
.
mythril for example which has the best accuracy accordingtoourevaluation takesonaverageof1m24stoanalyzeacontract.itismuchfasterthan manticore thatonlyhasanaccuracy of compared to the of mythril.table average execution time for each tool.
toolsexecution time average total honeybadger days maian days manticore days mythril days osiris days oyente days securify days slither days smartcheck days total days theexecutiontimeof maianissurprisingcomparedtotheresults that have been presented in the maianpaper .
indeed the authors claimed that it takes on average seconds to analyze a contractwhileweobservethatittakes5m16sinourexperimentonsimilarhardware.the difference inexecution timescanpotentiallybeexplainedbythedifferenceofinputusesinthetwoexperiments.
weusethesourcecodeofthecontractasinput and maian sauthors use the bytecode.
the overhead for the compilation of the contract seems to be the major cost of execution for this tool.
answer to rq3 .how long do the tools require to analyze the smart contracts?
on average the tools take 4m31s to analyze one contract.
however the execution time largely varies between the tools.
slitheris the fastest tool and takes on average only5secondstoanalyzeacontract.
manticore istheslowesttool.
ittakesonaverage24m28stoanalyzeacontract.wealsoobserve thattheexecutionspeedisnottheonlyfactorthatimpactsthe performance of the tools.
securifytook more time to execute thanmaian but securifycan easily be parallelized and therefore analyze the contracts much faster than maian.
finally we have not observed a correlation between accuracy and execution time.
discussion wediscussthepracticalimplicationsofourfindingsfromtheprevious section as well as outline the potential threats to their validity.
.
practical implications and challenges despitetheadvancesinautomaticanalysistoolsofsmartcontracts during the last couple of years the practical implication our study highlightsisthatthereremainseveralopenchallengestobetackled by future work.
we identify four core challenges increasingand ensuring the quality of the analysis extending the scope of problemsaddressedbythesetools integratingtheanalysisintothe development process and extending the current taxonomy.
quality thischallengeisaboutincreasingthelikelihoodthat a tool identifies real vulnerabilities yielding close to zero false positivesandfalsenegatives.ourstudydemonstratesthatthisis far from being the case and future work should be invested inimproving the quality of the tools.
addressing this challenge is perhaps an important step toward real life adoption of these tools and techniques.
538scope although there might not be a technique that finds all sorts of vulnerabilities this challenge is about further extending existing techniquesso thatmore real vulnerabilitiescan be found.
in the previous section we briefly discussed a potential way to address thischallenge craftinga noveltechnique combiningcomplementarytools.combiningstaticwithdynamicanalysismight also be an interesting avenue for future work.
developmentprocess thischallengeisaboutintegratingthese toolsintothedevelopmentprocess thuscontributingtoreal life adoption.
to ease the interaction of developers with these tools hencemakingthemusefulduringthedevelopmentlife cycle the following could bring added value integration with other orthogonal techniques such as bug detection tools dynamic analysis techniques and generic linters integration with popular ides interactivereports e.g.
highlightvulnerablecode andexplainable warnings.
taxonomy anotherpracticalimplicationofourworkisthatthe current state of the art set of categories in dasp10 does not seem to be comprehensive enough to cover all vulnerabilities that affect smart contracts deployed in ethereum.
dasp10 includes the category unknown unknowns because as the creators of the dasp taxonomyobserved aslongasinvestorsdecidetoplacelargeamounts ofmoneyoncomplexbutlightly auditedcode wewillcontinuetosee newdiscoveriesleadingtodireconsequences.ourworkshedslight on potential new categories that could extend dasp10 such as dependence on environment data andlocked ether.
the latter could includenotonlythecaseswhereetherislockedindefinitely but also cases of honeypots as defined by torres et al.
since ether becomes locked except for the attacker .
our findings suggest new categoriescomparabletothoseproposedintherecentsurveyby chenet al.
available online on august .
.
threats to validity a potential threat to the internal validity is that due to the complexityofthesmartbugsframework theremayremainanimplementation bug somewhere in the codebase.
we extensively tested theframeworktomitigatethisrisk.furthermore theframework andtherawdataarepubliclyavailableforotherresearchersand potential users to check the validity of the results.
apotentialthreattotheexternalvalidityisrelatedtothefactthat thesetofsmartcontractswehaveconsideredinthisstudymaynot beanaccuraterepresentationofthesetofvulnerabilitiesthatcan happen during development.
we attempt to reduce the selectionbias by leveraging a large collection of real reproducible smartcontracts.
another potential threat is that we may have misseda tool or failed to reproduce a tool that excels all other tools.
to mitigatethisrisk wecontactedtheauthorsofthetoolsifnosource code was found.
we also aim to reduce threats to external validity andensurethereproducibilityofourevaluationbyprovidingthe source of our instrumentation tool the scripts used to run the evaluation and all data gathered.
apotentialthreattotheconstructvalidityrelatestothefactthat we needed to manually label the vulnerable smart contracts into one of the dasp categories and these could be mislabeled.
this riskwas mitigated asfollows all authorslabeledthe contracts andthen disagreements were discussed to reach a consensus.
another potential threat to the validity is the timeout used for the analysis minutes.
this threat was mitigated by executing all the tools on the sbcurateddataset.
the analysis based on the dataset sbwildis valuable for it gives a sense of the potential noise that tools might generate whenanalysing contracts.
however with suc h a large dataset the discussiononthenumberoffalsepositivesischallengingandthere is a risk that too many false positives are identified.
to mitigate this risk we decided to use consensus as a proxy the hypothesis isthat the greater the number of tools identifying a vulnerability the more likely that vulnerability is a true positive.
related work as discussed in section .
there are several automated analysis toolsavailable.notwithstanding despitetherecentincreaseinterest in the analysis of smart contracts to the best of our knowledge ourworkisthefirstsystematiccomparisonofrecentlyproposed techniques to better understand their real capabilities.
datasets and repositories reproducibility is enabled by a benchmark containing smart contracts that other researchers canuseoff the shelf.
there are just a few repositories of smart contracts available to the research community such as verismartbench13 evm analyzer benchmark suite14 ethbench15 smartcontract benchmark16 andnot so smart contracts17.
these however areessentiallycollectionsofcontractsandarenotdesignedtoenablereproducibilitynortofacilitatecomparisonofresearch.
our dataset sbcuratedoffers a known vulnerability taxonomy positioning itself as a reference dataset to the research community.
empiricalstudies chenetal.
discussedanempiricalstudyon codesmellsforethereumsmartcontracts.basedonpostsfromstack exchange and real world smart contracts they defined distinct code smells for smart contracts and categorized them into security architecture andusabilityissues.furthermore theymanuallylabeledadatasetofsmartcontracts.18pinnaetal.
performeda comprehensive empirical study of smart contracts deployed on the ethereum blockchain with the objective to provide an overviewofsmartcontractsfeatures suchastypeoftransactions theroleof the development community and the source code characteris tics.
parizi et al.
carried out an experimental assessment of static smart contracts security testing tools.
they tested mythril oyente securify andsmartcheckontenreal worldsmartcontracts.
concerning the accuracy of the tools mythril was found to be the most accurate.our results corroboratethe findings but in amore systematic and comprehensive manner.
execution frameworks execution frameworks to simplify and automate the execution of smart contract analysis tools are scarce.
solhydra is a cli tool to analyze solidity smart contracts with several static analysis tools.
it generates a report with results of 13verismartbench 14evm analyzer benchmark suite 15ethbench 16smart contract benchmark 17not so smart contracts 18codesmell 539thetoolanalysis.unlikesmartbugs whichwasdesignedtoease the addition of new analysis tools solhydra does not offer thisflexibility.
furthermore solhydra has not been updated in more than a year.
conclusion in this paper we presented an empirical evaluation of automated analysistoolson69annotatedvulnerablecontractsandon47 contracts taken from the ethereum s network.
the goal of thisexperiment was to obtain an overview of the current state of automatedanalysistoolsforethereumsmartcontracts.duringthis empiricalevaluation weconsideredallavailablesmartcontracts analysis tools and all the available ethereum contracts that haveat least one transaction.
we used the dasp10 category of smart contract vulnerabilities as the reference to classify vulnerabilities.
we found out that the current state of the art is not able to detectvulnerabilitiesfromtwocategoriesofdasp10 badrandomnessandshort addresses.
also the tools are only able to detect together of the vulnerabilities from our sbcurated dataset.mythrilis the tool that has the higher accuracy and is able to detect of the vulnerabilities.
during the evaluation of the tools on sbwild we observe that of the contracts are identified as vulnerable.
this suggests a considerable number of false positives.
oyenteplays an important roleinthis sinceitdetectsvulnerabilitiesin73 ofthecontracts mostly due to arithmetic vulnerabilities .
finally we observe that the tools or more succeed to find a consensus for arithmeticvulnerabilities and reentrancy vulnerabilities.
wearguethattheexecutionframeworkandthetwonewdatasets presentedherearevaluableassetsfordrivingreproducibleresearch in automated analysis of smart contracts.