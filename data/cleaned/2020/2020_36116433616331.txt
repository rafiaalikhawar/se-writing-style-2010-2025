alarge scaleempiricalreviewof patchcorrectnesscheckingapproaches junyang universityofillinois urbana champaign unitedstates jy70 illinois.eduyuehanwang universityofillinois urbana champaign unitedstates yuehanw2 illinois.edu yilinglou fudanuniversity china yilinglou fudan.edu.cnmingwen huazhonguniversity ofscienceandtechnology china mwenaa hust.edu.cnlingmingzhang universityofillinois urbana champaign unitedstates lingming illinois.edu abstract automatedprogramrepair apr techniqueshavedrawnwideattention from both academia and industry.
meanwhile one main limitationwiththecurrentstate of the artaprtoolsisthatpatches passing all the original tests are not necessarily the correct ones wanted by developers i.e.
the plausible patch problem .
to date variouspatch correctnesschecking pcc techniqueshavebeen proposedtoaddressthisimportantissue.however theyareonly evaluatedonverylimiteddatasetsastheaprtoolsusedforgeneratingsuchpatchescanonlyexploreasmallsubsetofthesearch spaceofpossiblepatches posingseriousthreatstoexternalvalidity to existing pcc studies.
in this paper we construct an extensive pccdataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e thelargestmanuallylabeledpccdatasetto ourknowledge torevisitallninestate of the artpcctechniques.
morespeci f ically ourpccdataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e includes1 988patches generatedfromtherecentprapraprtool whichleverageshighlyoptimizedbytecode levelpatchexecutionsandcanexhaustivelyexploreallpossibleplausiblepatcheswithinitslargeprede f inedsearch space includingwell known f ixingpatternsfromvariouspriorapr tools .
our extensive study of representative pcc techniques on u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e hasrevealedvarious f indings including theassumptionmadebyexistingstaticpcctechniquesthatcorrectpatches aremoresimilartobuggycodethanincorrectplausiblepatchesno longerholds state of the artlearning basedtechniquestendto sufferfromthedatasetover f ittingproblem whiledynamictechniquesoverallretaintheireffectivenessonournewdataset their performancedropssubstantiallyonpatcheswithmorecomplicated changesand4 theveryrecentnaturalness basedtechniquescan the f irsttwoauthorscontributedequallytothiswork.
correspondingauthors.
permissionto make digitalor hard copies of allorpart ofthis work for personalor classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed forpro f itorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe f irstpage.copyrightsforcomponentsofthisworkownedbyothersthanthe author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspeci f icpermission and orafee.requestpermissionsfrompermissions acm.org.
esec fse december3 sanfrancisco ca usa 2023copyrightheldbytheowner author s .publicationrightslicensedtoacm.
acmisbn979 ... .
promisingdirectionforpcc.basedonour f indings wealsoprovide variousguidelines suggestionsforadvancingpccinthenearfuture.
ccsconcepts softwareanditsengineering softwareveri f icationand validation softwaretestinganddebugging keywords patchcorrectness programrepair empiricalassessment.
acmreferenceformat junyang yuehanwang yilinglou mingwen andlingmingzhang.
.
alarge scaleempiricalreviewofpatchcorrectnesscheckingapproaches.
inproceedingsofthe31stacmjointeuropeansoftwareengineeringconferenceandsymposiumonthefoundationsofsoftwareengineering esec fse december3 sanfrancisco ca usa.
acm newyork ny usa 13pages.
introduction automatedprogramrepair apr aimsto f ixsoftware bugswithminimalhumaninterventiontospeedupsoftwaredevelopment.recentlyvariousaprtechniqueshavebeenproposedand extensivelystudiedinacademia anddrawnwide attentionfromtheindustry .atypicalaprtechnique f irstgeneratesvariouscandidatepatchesbasedondifferentstrategies such as template based heuristic based constraint based andlearning based ones then itvalidatesallthecandidatepatchesviasoftwaretesting staticanalysis orevenformalveri f ication .todate mostaprsystemsleveragesoftwaretestingforpatchvalidation duetothepopularityandeffectivenessoftestinginpractice.
althoughtest basedpatchvalidationhasbeenshowntobepractical itsuffersfromthe testover f ittingissue patchespassingall thetests i.e.
plausiblepatches maynotalwaysbecorrectforallinputs becausesoftwaretestscanhardlycoverallpossibleprogram behaviorsforreal worldsystems.therefore thedevelopersarerecommendedtomanuallyinspecttheplausiblepatchesto f indthe f inal correctones.however suchmanualinspectioncanbeextremelychallengingandtimeconsuminggiventhelargenumberofpotentially esec fse december3 sanfrancisco ca usa junyang yuehanwang yilinglou mingwen andlingmingzhang plausiblepatchesandcodecomplexityforreal worldsystems .
torelievetheburden varioustechniqueshavebeenproposedtoautomatepatch correctnesschecking pcc whilestatictechniques inferpatchcorrectnessbasedonpatchedcodesnippetsanalysis dynamictechniquesrelyonruntimeinformationtodeterminepatchcorrectness .inrecentyears researchershavealso leveragedtherecentadvancesindeepcodeembeddingforpcc .
whileexistingpcctechniqueshaveshownpromisingresults theyaremostlystudiedonlimitedpccdatasets sincetheaprtools usedforconstructingsuchdatasetscanonly exploreaverysmallportionofthepossiblepatchsearchspace andareappliedonalimitednumberofsubjects.first theleveragedaprtoolsoftenincorporateaggressivepatchpruningstrategiessoasto f ixmorebugsontheirstudiedsubjects whichmakesthesetoolsonlyexploreasmallportionof thepossiblepatchsearchspaceandmayfailto f ixbugsonothersubjects.forexample theseaprtoolshavebeenshowntobeover f itting tothestudiedsubjects e.g.
showedthatthestudied11tools f ix signi f icantlymorebugsindefects4jv1.2thanotherbenchmarks.in addition thewidely adoptedsimfix capgentools canonly f ix 0and2morebugsrespectivelyonanewerversionofdefects4j with 200morebugs .inthisway thepossibleplausiblepatches arealsomissedbysuchaprtools andthusabsentintheresulting pccdataset.second duetotheefficiencyissue moststudiedapr tools e.g.
simfix terminatepatchexplorationassoonasthey f ind the f irstplausiblepatch.inthisway alargenumberofpossibleplausiblepatchescanalsobemissedbysuchtechniques.forexample even including21aprtools thecurrentlargestmanuallylabeledpcc dataset onlyhas902patchesfordefects4jv1.2intotal.third mostofthepccdatasetsarebuiltonthepopularoldversiondefects4jv1.2withalimitednumberofsubjects i.e.sixsubjects makingitunclearwhetherthe f indingscangeneralizetoothersubjects.
inthispaper weaimtorevisitnineexistingstate of the artpcc techniqueswithamoreextensiveandreal worlddatasettomore faithfullyevaluatetheireffectivenessinpractice.tothisend we f irstconstructanextensivedataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e datasetfor practical patchcorrectnesschecking forpccbasedontherecentprapr repairsystem .wechoosepraprgiventhefollowingreasons itsprede f inedpatchsearchspaceislarge sinceitappliespopularwellknown f ixingtemplatesfromvariousprioraprwork it istheonlyavailableaprtool toourknowledge thatcanexhaustively exploretheentireprede f inedpatchsearchspace sinceitgeneratesand validatespatchesbasedonitshighlyoptimizedon the f lybytecode manipulation.inthisway praprcangenerateallplausiblepatches withinitsclearlyde f inedpatchsearchspace whichcanlargelyavoid thedatasetover f ittingissue asanidealcandidateforconstructingpccdatasets.weapplypraprtoboththewidelystudieddefects4jv1.2dataset with395bugsandthelatestdefects4jv2.
datasetwith11additionalsubjectsystemsand401additionalbugs.in total ourdataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e contains1 988plausiblepatches including83correctpatchesand1 905over f ittingpatchesaftermanuallabeling.toourknowledge thisisthelargestmanuallylabeleddataset forpcc.
then basedonournewdatasets weperformanextensive studyofpriorpcctechniques includingstate of the artstatic dynamic andlearning based pcctechniques.ourempiricalstudyrevealsvarious f indingsandprovidevariousguidelines suggestionsforfurtheradvancingpcctechniques.
overall thispapermakesthefollowingcontributions real worlddataset.
wecreatealarge scalerealisticdataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e for pcc.
to our knowledge this is the f irst dataset basedonexhaustivepatchsearchspaceexploration aswellas thelargestmanuallylabeledpatchdatasetforpcctodate.
extensivestudy.
weperformanextensivestudyofstate of theartpcctechniques includingstatic dynamic andlearning based ones onournewlyconstructeddataset.intotal ourexperiments cost580cpudays includingstaticanalysis codeembedding test generation andtestexecutionforallpatcheswithinourdataset.
practicalimpacts.
ourempiricalstudyrevealsvarious results thecommunityshouldbeawareof aswellasprovidingvarious practicalguidelinesforfuturepccwork e.g.
thedynamicpcc techniquescannolongerworkforpatchesonmorecomplexand real worldbugsandshouldbelargelyimproved.
backgroundandrelatedwork in this section we f irst introduce the background on automated programrepairandpatchcorrectnesschecking andthenmotivate ourstudybysystematicallyrevisitingdatasetsusedintheliterature.
automatedprogramrepair.
automatedprogramrepair apr aimsat f ixingbugswithminimalhuman intervention.researchershaveproposedvariousaprtechniques whichcanbecategorizedaccordingtohowpatchesaregenerated heuristic basedapr leveragesheuristics toexplorethe searchspaceofpatches template basedapr incorporatespatternssummarizedfromhistoricaldeveloperpatchestoguide patchgeneration constraint basedapr leveragesconstraint solving to directly synthesize patches learning based apr utilizeslearningtechniques includingrecentlargelanguagemodels llms togenerate patches.aprtoolsthenleveragesoftwaretesting static analysis orevenformalveri f ication tovalidatethepatches.
patchcorrectnesschecking.
mostaprtechniquesrelyonsoftwareteststovalidatepatches assumingthatpatchesthatpassalltests arecorrect.however thisassumptioncanbeproblematicastestsmay notdetectallpossiblebugs.toaddresstheissueofover f ittingpatches patchcorrectnesschecking pcc techniqueshavebeenproposedtodifferentiateover f ittingpatchesfromcorrectpatches.
there are two application scenarios for pcc techniques with oraclepatchinformation orwithout.inthe oracle based scenario the plausiblepatchesthatexhibitdifferentlyfromtheoraclepatchare deemedasover f itting.
notethat oracle based pccisusuallyused foraprexperimentation andcannotbeappliedtoreal worldbug f ixingwheretheoraclepatchinformationisunavailable.incontrast oracle absent pcccanidentifypotentialover f ittingpatcheswithout oracle thuscanbeappliedinreal worldbug f ixing.therefore we onlyfocusonthe oracle absent techniques.
accordingtowhetherdynamicpatchexecutioninformationis required traditionalpcctechniquescanbecategorizedinto static anddynamictechniques.inparticular statictechniquesleverage static code features pre de f ined anti patterns or evencodenaturalness topredictpatchcorrectness.dynamic techniquesleveragerun timeinformation suchascrashormemorysafety issues used in opad and test execution traces used in patch sim .recently researchershavealsostartedexploring advancedmachinelearninganddeeplearningtechniquesforpcc.
1204alarge scaleempiricalreviewofpatchcorrectnesscheckingapproaches esec fse december3 sanfrancisco ca usa seminal research characterizes patch code with pre de f ined features while more recent work directly encodes patch codeviaembeddingmodels e.g.
bert andlearnstopredict theprobabilityofeachpatchesbeingover f itting.
existingpccdatasets.
werevisittheexistingpeer refereedliteratureonautomatedprogramrepairandpccbasedontheapr review before2022 andsummarizethedatasetsusedintheir evaluation.table 1presentsthecharacteristicsofdatasetsusedin existingwork.
notethatforthepatchesgeneratedbyaprtools wecheckwhethertheearlystopmechanismisenabledduringapr procedureasshownincolumn earlystop .fromthetable wecan f indthatalthoughinvolvingvariousaprtools subjects andpatches existingpccdatasetscanstillbeinsufficientforevaluatingpcc sincetheycanonlyexploreaverysmallportionofthepossiblepatch searchspaceon limitedbugs duetothefollowingreasons.
first existingdatasetsmainlyincludetheplausiblepatchesgeneratedbyover f ittingaprtools whichincorporateaggressivepruning strategiesandthuscouldonlyexploreasmallratioofpatchsearch spaces.asshowninrecentwork mostexistingaprtoolsare over f ittingtothedefects4jv1.
benchmark.themainreasonis thatsuchaprtoolsoftenleverageaggressiveandspeci f icpatchpruningstrategiessoasto f ixmorebugs whichcouldexploreasmallratio ofpatchsearchspacesandmaysufferfromthedataset over f itting issue .forexample therecentsimfix capgentools can only f ix0 2morebugsonadditional 200morebugs also aprtoolshavebeenshowntoperformsubstantiallyworseonother benchmarksthanthewidely useddefects4jv1.
.inthisway thepossibleplausiblepatchesthatshouldhavebeengeneratedare missed andthusabsentintheresultingpccdataset.
second existing datasets only include the f irst one fewplausible patchesgeneratedbyaprtoolsduetoefficiencyissue.
asshownin thetable mostaprtools e.g.
simfix employthe earlystop mechanism whichterminatespatchexecutionassoonasthey f ind the f irstplausiblepatchforthesakeofefficiency.therefore existing pccdatasetmaymissalargenumberofpossibleplausiblepatches thatcanbepotentiallygeneratedbytheseaprtools.accordingto nolleretal.
developersexpectaprquickly 60min generate 10patcheseachbug.butamongthe16aprtoolsstudiedin themosteffectiveone simfix setatimeoutof300minutesforeach bugbutonlygenerated68patchesondefects4jv1.
.therefore apr toolsforpreviousdatasetsareneitherpracticalnorefficient.infact evenwith21aprtools theexistinglargestmanuallylabeledpcc dataset hasonly902patchesfordefects4jv1.
meanwhileasingleapr i.e.
sequencer canonlygenerateatmost73patches.
third mostpccdatasetsarebuiltonthepopulardefects4jv1.
old version withonlysixsubjects makingitunclearwhetherthe f indings cangeneralizetoothersubjects e.g.
thenewerversiondefects4jv2.
with11moresubjects .
asshowninthetable themajorityofexisting pccdatasetsaregeneratedfromthesubjectsinthemostwidely usedbenchmarkdefects4jv1.
.therefore itremainsunknownhow existingpcctechniquesperformonpatchesfromothersubjects.
toaddressthelimitationsabove inthiswork weconstructamore extensiveandreal worlddataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e soastorevisitallrepresentativepcctechniques.inparticular ourdataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e isbuilt ontheplausiblepatchesgeneratedbytherecentbyte codelevelapr toolprapr .wechoosepraprsince1 its prede f inedpatchsearch spaceislargesinceitappliespopularwell known f ixingtemplatesfromvariousprioraprwork and2 itisthebaselineapr toolthatcanexhaustivelyexploretheprede f inedpatchsearchspace duetoitshighlyoptimizedon the f lybytecodemanipulation.here theprede f inedpatchsearchspace referstoallthepossiblepatchesthat anaprtoolcouldtheoreticallygenerateforagivenbug withallits applicable f ixpatternsinallsuspiciousbuggylocations .forexample thetemplate basedaprtoolspraprandtbarcouldgenerate3 and3 375patches whicharetheprede f inedpatchspaceforprapr andtbar withtheirownde f ined f ixpatternsforthebugchart respectively.an exhaustiveexploration meansthatallthepatchesin theprede f inedpatchsearchspacearegeneratedandvalidatedbythe aprtool.typically existingaprtoolssufferfromlargesearchspace andtime consumingnon trivialvalidation therefore theycannot affordtheexhaustiveexplorationandadopttheearlyexitmechanism tocontroltheexplorationcosts whileprapristheonlytoolthatis abletoperformtheexhaustiveexplorationsinceitshighlyoptimized on the f lybytecodemanipulationsigni f icantlyacceleratesthepatch validation.inparticular praprishighlyefficient becauseitdoes notrequirecompilation itdirectlygeneratespatchesonbytecode level anditcanvalidateabunchofpatchesinonejvm.forexample for the bug chart it only takes prapr 149s in total to generate validate all the patches while it would take tbar 34s for evenvalidatingonesinglecompilablepatch.inthisway praprcan generateallplausiblepatcheswithintheclearlyde f inedpatchsearch space whichotheraprtoolsfailtoreach.furthermore inaddition tothemostwidelyuseddefects4jv1.2dataset wefurtherapply praprtothemostrecentversionofdefects4jdataset i.e.
defects4j v2.0with11additionalsubjectsystemsand401additionalbugs.
datasetconstruction .
subjects ourdatasetsareconstructedwithpatchesgeneratedforthesubjects indefects4j duetothefollowingreasons defects4jcontains hundredsofrealbugsforreal worldprojectsandhasbecomethe mostwidelystudiedaprbenchmarkintheliterature mostprior pccstudieswereperformedondefects4j thus enablingamoredirect faircomparisonwithpriorwork.weinclude allsubjectsfromdefects4jv1.
with395bugsfrom6projects since itisthemostwidelyuseddefects4jversioninprioraprandpcc work .furthermore wealsostudythelatestdefects4jv2.
whichincludes11additionalprojectswith401additionalbugs 17projectswith796bugsintotal tostudythedataset over f ittingissueofexistingpccwork i.e.
whetherthepriorpcc experimentalresultscangeneralizetothenewerdefects4jversion.
pleaserefertoourwebsite fordetailedstatisticsofsubjects.
.
patchcollection plausiblepatchcollection.
foreachstudiedbuggyversionfrom defects4j we f irstrunprapronittogenerateallpossibleplausible patches i.e.
thepatchespassingallthetests inthebytecodelevel.we furtherdecompilethesebytecode levelplausiblepatchesintosourcecode levelpatchessinceexistingpcctechniquesworkatthesourcecodelevel.wemakethefollowingeffortstoensurethedecompilation processaspreciseaspossible.first wecon f igurepraprtoincludeall therequireddebugginginformationintheresultingbytecode level patches.
second we leverage the state of the art decompiler jdcore todecompilepatchedbytecode f iles.third weonlylocate 1205esec fse december3 sanfrancisco ca usa junyang yuehanwang yilinglou mingwen andlingmingzhang table1 datasetsusedinexistingpccwork work studiedtechnique scale ratiodatasetsource correct over f itting subjectsource patchsource earlystop tanetal.
anti patterns corebench genprog allfromaprtools genprog mgenprog spr mspr xinetal.
difftgen defects4jv1.2allfromaprtools jgenprog jkali npolandhdrepair4 leetal.
s3 100bugsfrom62subjectsallfromaprtools s3 enumerative cvc4 angelix yangetal.
opad 45bugsfrom7subjectsallfromaprtools genprog ae kali andspr4 xinetal.
ssfix 31defects4jv1.
excludemockitoallfromaprtools ssfix jgenprog jkali nopol hdrepair acs5 xiongetal.
patch sim 110defects4jv1.
excludeclosure mockitoallfromaprtools jgenpro nopol jkali acs hdrepair5 yeetal.
rgt defects4jv1.2allfromaprtools acs arja capgen etc.
14toolsintotal10 wenetal.
capgen 174defects4jv1.
excludeclosure mockitoallfromaprtools capgen0 xinetal.
sharpfix 26bugs.jar 127bugsfrom7projectsinbugs.jarallfromaprtools sharpfix ssfix tianetal.
embedding based defects4jv1.2778fromaprtools rsrepair a jkali acs simfix tbar etc.
17toolsintotal 232fromdeveloperpatches supplementedtobalancethedataset wangetal.
12pcctechniques defects4jv1.2allfromaprtools jgenprog dynamoth sequencr etc.
21toolsintotal16 linetal.
cache repairthemall manysstubs4j over f ittingpatchesfromaprtoolsandcorrectpatchesfromdeveloperpatches jgenprog jkali nopol etc.
11aprtoolsintotalandhumanpatches11 yeetal.
ods repairthemall defects4jv2.0developerpatchesover f ittingpatchesfromaprtoolsandcorrectpatchesfromdeveloperpatches jgenprog jkali nopol etc.
11aprtoolsintotalandhumanpatches11 u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e 9pcctechniques defects4jv2.0allfromaprtools prapr0 thepatchedlineinthedecompiled f ile notethatprapronlychanges onelineonbytecodelevelpatches andpatchtheoriginalbuggy source f iletoobtainapotentialpatchatthislevel.finally weperform thesanitychecktoensurethedecompiledsource code levelpatches indeedpassallthetests.finally weobtain1 988plausiblepatches.
patchcorrectnessidenti f ication.
foreachplausiblepatch we thenmanuallydetermineitscorrectnessbycomparingittothedeveloperpatch.wefollowthelabelingprocedureinpreviouswork and the patches that satisfy the following criteria are labeled as correct thepatchesaresyntacticallyidenticaltothedeveloper patches or thepatchesaresemanticallyequivalenttothedeveloperpatchesaccordingtotherulessummarizedbyexistingwork .
duetospacelimits thedetailedrulesarelistedonourwebsite .
otherwise thepatchesarelabeledasover f itting.weinvolvethree participantswith3 yearsjavadevelopmentexperienceinthemanuallabelingprocedure twoparticipants f irstlabeleachplausible patchindividually andathirdparticipant isthenintroducedtoresolvethecon f licts.
theagreementratioofthe f irsttwoparticipantsis .
andthereare20outof1 988patches .
thatreceivecon f lictannotationsfromthetwoparticipants.forthese20con f lictcases thethirdparticipantwould f irstre checkwhethertheyfollowtheten semantically equivalentrules.ifthecaseisnotcoveredbytherules he she would determine the correctness of the plausible patches basedontheprojectcontextaswellasthereferencetotheissuelink orbugreport.inthisway amongallthe1 988newplausiblepatches 83arelabelledascorrectand1 905labelledasover f ittingones.
studydesign .
researchquestions basedonournewlyconstructeddatasets werevisitallstate of theartpcctechniquesviathefollowingresearchquestions rq1 howdoes staticpccperformonourdatasets?
rq2 howdoes learning based pccperformonourdatasets?
rq3 howdoes dynamicpccperformonourdatasets?
.
studiedtechniques ourstudyselectsexistingstate of the arttechniquesthataredesignedfororcanbeadaptedtothepcctask.speci f ically theselected techniquescanbebroadlycategorizedintothreecategories includingstatic dynamic andlearning based techniques.weonlyinclude thosetechniquesthatdonotrequiretheoracleinformation i.e.
the developerpatches sincethepracticalusefulnessofthosetechniques requiringtheoracleinformationiscompromised .
.
.
statictechniques.
wangetal.haveempiricallyinvestigated theeffectivenessofstaticfeaturesextractedfromthreetools namelyssfix s3 andcapgen andthenutilizedsuch featurestocheckpatchcorrectness.weuseidenticalexperiment settingsandmethodologytoassesspatchcorrectnessinnewdataset.
s3 s3proposedsixfeaturestomeasurethesyntacticandsemantic distancebetweenpatchedcode andtheoriginalbuggycode .
amongthem astdifferencing andcosinesimilarity areutilizedto prioritizeandidentifycorrectpatches.speci f ically thesumofthese featuresiscomputedasthesuspiciousnessscore.patcheswithhigher scoresaremorelikelytobeover f ittingaccordingtotheprevious study whichclaimscorrectpatchesaremoresimilartotheoriginal buggycode andthuspossessfewermodi f ications.inaddition weexcludetheotherthreefeaturesinthisstudyfollowingpriorwork .
speci f ically modelcounting andoutputcoverage areexcludedsince theycannotbegeneralizedtoallthegeneratedpatches .besides anti patterns utilizedins3isexcludedheresinceweutilizeitasa stand alonetool followingthepreviousstudy .
ssfix ssfixfocusedonthetoken basedsyntaxrepresentationof codetoidentifysyntax relatedcodefragmentstogeneratecorrect patches.speci f ically structuraltokensimilarity andconceptualtoken similarity arecalculatedtomeasurethesimilaritybetweenthebuggy codeandpatchedcode.similarto s3 thesumofthesefeaturesis usedtorankpatches.patcheswithhigherscoresarerankedhigher.
capgen capgendesignedthreecontext awarefeaturestoprioritizecorrectpatchesoverover f ittingones namelythe genealogy 1206alarge scaleempiricalreviewofpatchcorrectnesscheckingapproaches esec fse december3 sanfrancisco ca usa similarity variablesimilarity anddependencysimilarity respectively.
althoughsuchfeaturesarenotinitiallyproposedforpcc theycan stillbeadaptedtoassesspatchcorrectnessfromtheviewofstatic features.speci f ically followingtheexistingstudy theproduct ofthesesimilarityscoresisusedtorankandprioritizepatches and patcheswithhigherscoresareconsideredmorelikelytobecorrect.
fortheabovethreestatictechniques weapplythetop nstrategy toidentifycorrectpatchesfollowingpriorwork .speci f ically the top nprioritizedpatchesarelabeledascorrectwhileothersasover f itting wherenisthenumberofcorrectpatchesinourdatasetfollowingpriorstudies .tomitigatetheeffectofn wealsoshowtheaveragerankingofcorrectpatchesperbug i.e.
denotedasavr toevaluatetheabilityofprioritizingcorrectpatches detailedinsection .
.
anti patterns anti patternsprovidesasetofgenericforbidden transformationstohelpobtainprogrampatcheswithhigherqualities withminimaleffort.toapplytheseanti patternsonourowndataset we f irstmaptheanti patternstoprapr smutationrules through manualinspection.iftherulesfallintoaspeci f icpattern wedeem thosepatchesgeneratedbythemutationruleasover f itting.sucha strategyisthesameasthatadoptedbytheexistingstudy .inthis way weobservethatpatchesgeneratedbypraprmainlyfallinto fourofthesevenanti patterns includinga1 anti deletecfgexit node a2 anti deletecontrolstatement a5 anti deleteloop counter anda6 anti appendearlyexit .therefore weclassifythepatches thatfallintotheserulesasover f ittingandtheothersascorrect.
codenaturalness crossentropy forcodemeasuresthenaturalnessofcodeagainstthecodelanguagemodel .veryrecently researchershaveshownthatcodenaturalnessintermsofentropy valuescomputedbyllmscanhelprankpatchesforfasterprogram repair .furthermore xia etal.
demonstratedforthe f irst timethatitispossibletousesuchentropyvaluestoperformpatch correctnesschecking i.e.
correctpatchescanbemorenaturalthan over f ittingpatches.
however thereisnocomprehensivestudyon howsuchentropy basedtechniquesperforminpccdatasetstoour knowledge.foralistoftokensinthecorpusofllm themeanentropy canbecalculatedasthenegativelogprobabilityofeachtokenas u1d45a u1d452 u1d44e u1d45b u1d452 u1d45b u1d461 u1d45f u1d45c u1d45d u1d466.alt summationtext.
u1d45b u1d456 u1d459 u1d45c u1d454 u1d45d u1d461 u1d456 u1d45b where u1d461 u1d456referstotheithtokenofthe sequenceand u1d45d u1d461 u1d456referstothemodelprobabilityoftoken u1d461 u1d456.similarly thesumentropycanbecomputedas u1d460 u1d462 u1d45a u1d452 u1d45b u1d461 u1d45f u1d45c u1d45d u1d466.alt summationtext.
u1d45b u1d456 u1d459 u1d45c u1d454 u1d45d u1d461 u1d456 .
patcheswithlowersumormeanentropiesareconsideredmore naturalandwillberankedhigher.inourevaluation weusethemodel codet5 large andfollowthesameexperimentalsettingwith priorwork .forentropy basedtechniques weonlyuseavr asdescribedinsection .
toevaluatetheeffectivenessofpatch rankingsincetheentropyisdependentonthecontextofbugsand improperforcomparingpatchesacrossdifferentbugs.
.
.
dynamictechniques.
dynamictechniquescancapturetestingbehaviorandresultforpatchassessment.
speci f ically weinclude sotatechniqueswidelystudiedintheliterature opad opad is designed based on the hypothesis that patches shouldnotintroducenewcrashormemory safetyproblems .therefore anypatchviolatingthoserulesisregardedasover f itting.note thatopadisoriginallydesignedforcprogramsutilizingfuzzing techniquestogeneratenewtestcases.toadaptitonjava weleveragetwostate of the arttestgenerationtools i.e.
evosuite and randoop to generate test cases based on the buggy version.opadbasedon evosuiteandrandooparedenotedase opadand r opadrespectively followingthepreviousstudy .speci f ically forevosuiteandrandoop wegenerate30testsuitesforeachbuggy programwithatimebudgetof600secondsforeachtestsuiteutilizing existingtestgenerationmoduleindefects4jframework.we f inally successfullygenerate44 937testsuiteson796buggyprogramsin total.aftertestgeneration we f irstrunthegeneratedtests for f ive times ontheoriginalbuggyprogramstoremove f lakytests.after that weruntheremainingonesonthepatchedprograms.ifany crashoccursoranyexceptionisthrown opadwillidentifythepatch asover f itting otherwiseitwillidentifythepatchascorrect.
patch sim patch simisasimilarity basedpcctoolutilizing thetestsgeneratedbyautomatedtestgenerationtools randoopin theoriginalstudy andbothrandoopandevosuiteinwang et al.
sstudy asthetestinputs.itassumesthattestswithsimilar executionsarelikelytohavesimilarresults.thebasicideaofpatchsimisthat ifthepatchedprogrambehavessimilarlyonthepassed testsandbehavesdifferentlyonthefailedtestscomparedwiththe originprogram thepatchtendstobecorrect.patch simproposesto calculatethesimilarityofprogramexecutionbehaviors denotedas patchdistance andthenclassi f iespatcheswithit.notethatinthe originalstudy xiong etal.usedrandooptogeneratetestsuites .
besides accordingtowang etal.
sstudy thetestsgeneratedby randoopperformbetterthanthosebyevosuite.we thus choose randoopasthetestgenerationtoolinthisstudy.toapplypatch sim on u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
we generate test cases for related projects in totalbyourselves.combiningwiththetestsuitesgeneratedbythe existingstudy weobtain10 404testcasesforpatch sim.
.
.
learning basedtechniques.
besidesthetraditionalpcctools weincludenovellearning basedembeddingtechnique hereafterdenotedasembedding .wealsoincludeodsproposedbyye etal.
whichaimstolearnpatchcorrectnessviafeatureengineering.lin et al.
proposedcachewithsimilarideasbuttheirtoolsarecurrentlynotexecutableduetobrokenscriptsandincompleteartifacts.
embedding codeembedding cantransformsourcecodeinto distributedrepresentationsas f ixed lengthvectorsbyutilizingsupervisedmachinelearningalgorithms.tian etal.initiallyproposed utilizing code embedding techniques to identify correct patches amongplausibleones .tobespeci f ic tian etal.fedboththe buggyandpatchedcodefragmentforeachpatchtoembeddingmodels e.g.
bert toobtainembeddingvectors.aftergenerating theinitialvectors theymergedthepairofvectorsforeachpatch accordingtotheclassi f icationalgorithm .withtheembedding vectors tian etal.capturedthecrossedfeatures e.g.
cosinesimilarity requiredintheclassi f ication.intheend thesefeatureswerefed totheclassi f ierforidentifyingifthepatchiscorrectorover f itting.
otherembeddingtechniques mostlyfollowhighlysimilar ideasandcannotoutperformtian etal.
swork .therefore we utilize the best performing model in tian et al.
s study denoted asbert lr astherepresentativeinthisstudyforfurtherinvestigation.speci f ically weappliedthemodellearnedbythebert lr methodtoourdataset toinvestigatehowitperforms.followingthe experimentalsettingasadoptedbytheexistingstudy weutilizethe datasetusedin fortrainingandourcollectedbenchmarkfor testing.notethatwe f ilteredoutthoseoverlappingpatchesbetween tian sandourdatasetsinthetrainingprocess.
1207esec fse december3 sanfrancisco ca usa junyang yuehanwang yilinglou mingwen andlingmingzhang ods ods over f itting detectionsystem extractsalargenumber ofstaticcodefeaturesandleveragesensemblelearningbasedondecisiontreestopredictpatchcorrectness .foragivenpatch ods extracts202codefeatures including150codedescriptionfeatures representingthecharacteristicsofthepatch singredientsandits contextatdifferentgranularity 26repairpatternfeaturesencoded withhumanknowledgeonrepairstrategiesand26contextualsyntacticfeaturesthatencodethescopeandsimilarityinformationin thesourcecode.toevaluateodsinourdataset wefollowtheexperimentalsetupintheoriginalpaper .we f irstusethecodeanalyzer providedbyodstoextractfeaturesofpatchesinourdatasetand thenreusethemodeltrainedbytheauthorsforprediction.
.
studieddatasets table2 thepatchdatasetsinthisstudy subdatasetid subjects aprtools patch over f it correct u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2defects4jv1.
prapr u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0defects4jv2.
prapr u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.0defects4jv2.
prapr 21tools u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.0defects4jv2.
prapr 21tools .
.
u1d44a u1d44e u1d45b u1d454 u1d4631.
.wanget al.
collected patches on defects4j v1.
from apr tools including apr tools evaluated under the same con f iguration by a previous study and other wellknownaprtoolsthatwerenotincludedin includingjaid sketchfix capgen sofix andsequencer .they performedaplausibilitychecktoseewhethertheselectedpatches areindeedplausibleanddiscardedothers.finally theyobtained902 patchesintotal including248correctand654over f ittingpatches.
.
.
u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e .theplausiblepatchescollectedfromsection .
constituteourmainsubdataset u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
with1 988plausiblepatches generatedbypraprondefects4jv2.
.basedonthemaindataset wefurtherconstructthreesub datasetsformorethoroughstudyof pccwork.table 2presentsthedetails.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
thisdatasetincludesall1 311plausiblepatchesgeneratedbypraprondefects4jv1.
separatedfromthemaindataset tocomparewithpriorpccstudiesonthesamedefects4jversion.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.thoughpraprcontainsoverlappingpatch f ixingpatternswithmanyotheraprtools itisstillimportanttoconsider patchesfromotheraprtoolsformorecomprehensivepccevaluation.hence wefurthercombineour u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0withtheexisting largestlabeleddatasetderivedfromaprtools i.e.
u1d44a u1d44e u1d45b u1d454 u1d4631.
that includes902plausiblepatchesgeneratedby21otheraprtools.after carefullyremovingtheduplicatesbetween u1d44a u1d44e u1d45b u1d454 u1d4631.2andourdataset we f inallyobtain2 760plausiblepatchesinthismergeddataset.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.table2showsthatthe u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.0datasetislargely imbalanced with mostly over f itting patches.
while pcc studies frequentlyleverageimbalanceddatasets wefurtherconstructabalanceddatasetbasedon u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.0formorethoroughevaluations.
speci f ically we keep all correct patches from u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.0and randomlysamplethesamenumberofover f ittingpatches.
tomitigate thebiasinrandomness werepeattherandomsamplingprocessfor tentimesandpresenttheaverageresultson u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
toourknowledge thedatasetsnewlyconstructedinthisworkare thelargestmanuallylabeleddatasetsforevaluatingpcc.forexample prapralonegenerates1 988plausiblepatcheswhiletheexistinglargestpccdatasethasonly902plausiblepatches lin etal.
and yeetal.
havedatasetswith 000and 000patchesbutthey arenotmanuallylabeled .inaddition mergingthepatchesgeneratedbypraprwiththeexistingdatasetscouldfurtherformalarger labeleddataset i.e.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.thelargescaleofournewdatasets iscreditedtothehighefficiencyandexhaustivesearchstrategiesof prapr whichhelpcollectmanyplausiblepatchesthataremissed bytheotheraprtoolsduetotheirefficiencyissuesortheirearly termination.forexample prapralonegenerates39uniqueplausible patchesforthedefects4jbugmath whiletheotherexisting21apr toolsgenerate7plausiblepatchesintotal 5ofthemareunique .the mainreasoncouldbethatothertoolsearlystopafter f indingthe f irst plausiblepatchwhilepraprexhaustivelyexploresthewholesearch space.therefore atleast34outofthe39plausiblepatchesgenerated bypraprarenotvisitedbytheexisting21aprtools.weevaluate theninepcctechniquesonboth u1d44a u1d44e u1d45b u1d454 u1d4631.2and u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e .notethat u1d44a u1d44e u1d45b u1d454 u1d4631.2isusedasthebaselinedatasetfromthepreviousstudy .
.
metrics followingtherecentworksonpatchcorrectnesschecking weevaluatepcctechniquesagainstfollowingmetrics tp oftrulyover f ittingpatchesidenti f iedasover f itting.
tn oftrulycorrectpatchesidenti f iedascorrect.
fp oftrulycorrectpatchesidenti f iedasover f itting.
fn oftrulyover f ittingpatchesidenti f iedascorrect.
precision u1d447 u1d443 u1d447 u1d443 u1d439 u1d443 .denotedas u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b .
recall u1d447 u1d443 u1d447 u1d443 u1d439 u1d441 .denotedas u1d445 u1d452 u1d450 u1d44e u1d459 u1d459.
recallofcorrect u1d447 u1d441 u1d447 u1d441 u1d439 u1d443 .denotedas u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450.
pr auc areaunderprecision recallcurve .
avr theaveragerankingofcorrectpatchesforbugswhichhave bothover f ittingandcorrectpatches.
correctpatchratio u1d447 u1d441 u1d447 u1d441 u1d439 u1d441 .denotedascpr.
accuracy u1d447 u1d443 u1d447 u1d441 u1d447 u1d443 u1d439 u1d443 u1d447 u1d441 u1d439 u1d441 .denotedasacc.
studiessuggestthatpcctechniquesshouldnotmistakenlyexclude correct patches i.e.
the fp should be as low as possible.however whenthedatasetisimbalanced i.e.
mostlyover f ittingpatches u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b canbebiasedandoverratedsince u1d439 u1d443is oftenmuchsmallerthan u1d447 u1d443 thusposingsigni f icanteffectstothe f inalresults.therefore followingthepreviousworkonimbalanced datasets we further include the metric u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 the ratio of correctlyidenti f iedcorrectpatches forcomplementaryfaircomparisons.infact u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450iscrucialsincerejectingacorrectpatchmay causeabugtobeun f ixed.besides wealsoutilizethepr auc metrictoeliminatetheeffectscausedbyimbalanceddatasets .
note that pr auc is not applicable for rule based techniques including opad patch sim anti patterns and ods since the resultsarediscrete either0or1 .forthestatictechniques s3 capgen ssfix and code naturalness based on feature score ranking weleverageavrtoshowtheiraveragerankingofcorrectpatches i.e.
the smaller ranking is better.
for example given avr a b a istheaveragerankingofthe f irstcorrectpatchineachbugwhile bis the average number of patches in each bug.
note that avr is calculated on the subset of bugs that have both over f itting and correctpatches sincepatchrankingtechniqueswouldperformthe same when there are only correct or over f itting patches.
in addition thenumbersofbugswithbothpatches numbersofpatches perbugare50 .
u1d44a u1d44e u1d45b u1d454 u1d4631.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
1208alarge scaleempiricalreviewofpatchcorrectnesscheckingapproaches esec fse december3 sanfrancisco ca usa .
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
respectively.insummary aneffectivepcctechniqueshouldachievehigh u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450andpr auc withlowavr.forodsevaluationwereusetheirmetricswithtwo additionalonescprandaccfollowingtheoriginalstudy .
.
threatstovalidity thethreatsto internalvaliditymainlylieintheimplementationof studiedpcctechniques.toreducesuchthreats wereuseexisting implementationswheneverpossible andhavecarefullyreviewed allourcodeandscript.inaddition tomitigatethebiasinthepatch correctnesslabeling weinvolvemultipleparticipants followwidelyusedcriteriasummarizedfromexistingwork andhavereleased allourpatchesforpublicreview.tomitigatethepotentialbiasofrandomnessinsampling werepeatthesamplingprocessfortentimes andusetheaverageresults.thethreatsto externalvalidityaremainly concernedwiththegeneralizabilityofour f indings.wemitigatethe threatsfromasingleaprtoolbyfurthermergingourdatasetswith previousdatasets.thethreatscanbefurtherreducedbyincluding morenewbugs e.g.
withthe growingbugs dataset .
thethreats toconstruct validitymainlylieinthemetricsusedinourstudy.to mitigatethethreats wehaveincludedallpopularmetricsforpcc including u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 avr pr auc cprandacc.
resultanalysis .
rq1 statictechniques .
.
staticcodefeatures.
forstudyingallthestaticcodefeatures wefollowthesameexperimentalsettingastherecentstudy .
thedetailedexperimentalresultsforthethreestudiedtechniques areshownin table .fromthetable wecanobservethatcompared withoriginalscoreson u1d44a u1d44e u1d45b u1d454 u1d4631.
the u1d445 u1d452 u1d450 u1d44e u1d459 u1d459scoresallincreasewhile the u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450scoresallsubstantiallydecrease onthe u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2and u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0datasets.onedirectreasonisthatthetwonewdatasetsare extremelyimbalanced withmostlyover f ittingpatches .meanwhile theextremelylow u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450scores i.e.
only5 ofcorrectpatches areidenti f iedascorrect stilldemonstratethatsuchtechniquescan hardlybeusefulinpractice.thepr aucscoresofallfeaturesfor alldatasetsarebeloworaround50 .taking u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.0datasetfor example twoofthefeaturesgetapr aucscoreslightlyover50 the proportion of positive sample and the expected pr auc for randomclassi f icationmodel andoneofthemgetslessthan50 indicatingthatthesefeaturesarehardlyusefultoidentifyover f itting patches.theexperimentalresultsonthemorebalanced u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
and u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.0datasetsfurthercon f irmthisobservation.forexample onthebalanceddataset u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
the u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450remainssimilar to the prior study on u1d44a u1d44e u1d45b u1d454 u1d4631.
i.e.
while the u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 substantiallydropsover30percentagepointsforallthreestatictechniques e.g.
.
.
forssfix .avrisabettermetricforsimulating actualeffortsofselectingonecorrectpatchfromplausiblepatches.
fromthetables wecanobservethatfor u1d44a u1d44e u1d45b u1d454 u1d4631.2dataset developers wouldexamine2.
.8patchesonaverage dependingonthechosentechnique untilthe f irstcorrectpatchisfound.however when praprdatasetisconsideredormergedwith u1d44a u1d44e u1d45b u1d454 u1d4631.
theavrsrise to5.
.
.inotherwords whenlargerpatchspaceisincluded effectivenessofallsimilarity basedstatictoolssigni f icantlydegradesand thecosttoidentifycorrectpatchforeachbugsigni f icantlyincreases.
tounderstandthereasonsbehindtheseresults wefurtherinvestigatethedetailedrawpatchscorescomputedbydifferenttoolsastable3 performanceofstaticfeaturesondifferentdatasets dataset tpfptnfn u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450pr auc avr s3 u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
.
.
.
ssfix u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
.
.
.
capgen u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
.
.
.
table4 averagescoresbasedonstaticfeatures patches ssfix s3capgen u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0correct .
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0over f itting .
.
.
u1d44a u1d44e u1d45b u1d454 u1d4631.2correct .
.
.
u1d44a u1d44e u1d45b u1d454 u1d4631.2over f itting .
.
.
developer .
.
.
shownintable .notethatforssfixandcapgen thescoresreveal thesimilarity betweenthebuggycodeandthepatches whilefor s3 thescoresrepresentthe editdistance ofthepatches.suchtechniquesaredesignedbasedonthewidely acceptedassumptionthat correctpatchesshouldbemoresimilartothebuggycode.
toinvestigate thevalidityofsuchawidely acceptedassumption wesplitallthe patchesintofourgroups u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2correctpatches u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2over f itting patches u1d44a u1d44e u1d45b u1d454 u1d4631.2correct patches and u1d44a u1d44e u1d45b u1d454 u1d4631.2over f itting patches.furthermore wealsoincludethe developerpatches forcomparison.asshownintable ifwefocusonthedatasetof u1d44a u1d44e u1d45b u1d454 u1d4631.
theaveragescoresofcorrectpatchesforssfixandcapgenare10.
and76 higherthantheover f ittingpatchesrespectively.
besides theaveragescoreofthecorrectpatchesfors3is55.
lowerthanoftheover f ittingpatches.amann whitneyutest is conductedtoevaluatethesigni f icanceofthedifferenceanditshows thatthep valuesarerelatively .
.
11and9.
forssfix capgenands3respectively.thatistosay correctpatches in u1d44a u1d44e u1d45b u1d454 u1d4631.2ingeneralsharehighersimilaritieswiththebuggycode andintroducefewermodi f icationsthanover f ittingpatches.suchresultsactuallysupportthewidely acceptedassumption andcanalso explainwhythesetoolsexhibitpromisingresultson u1d44a u1d44e u1d45b u1d454 u1d4631.
andtheiroriginalpublications .
however suchanassumptionmightnolongerholdonourdatasets.
speci f ically on u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
forssfixandcapgen theaveragesimilarityscoresoftheover f ittingpatchesareeven2.
and10.
higherthanthoseofthecorrectpatches thep valuesare0.070and .
respectively .
moreover if we compare with correct developerpatches theaveragescoreofssfixonover f ittingpatchesin u1d44a u1d44e u1d45b u1d454 u1d4631.2isalso14.
higherthanthatofdeveloperpatches with p valueof .
whileaveragescoresofssfixandcapgenon u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0over f ittingpatchesare34.
and57.
higherthanthat ofdeveloperpatches withp valuesof .
54and5.
.
suchresultsarecontradictorytothoseobservedmerelybasedon u1d44a u1d44e u1d45b u1d454 u1d4631.
.
for s3 despite the results observed on u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
shareasimilartrendwiththoseon u1d44a u1d44e u1d45b u1d454 u1d4631.
wecanstillobserve contradictoryresultsifcomparedwithdeveloperpatches.specifically theaveragedistancescoresofs3ondeveloperpatchesare 1209esec fse december3 sanfrancisco ca usa junyang yuehanwang yilinglou mingwen andlingmingzhang .
higher in u1d44a u1d44e u1d45b u1d454 u1d4631.2and .
higher in u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0than over f ittingpatches p valuesof .
25and4.
.wealso investigatethedifferenceof8correspondingsub featuresseparately whichshowsimilartrend presentedonourwebsite .
finding1 thewidely acceptedassumptionmadebyexisting similarity basedstatictechniquesthatcorrectpatchesingeneral sharehighersimilaritieswiththebuggycodeisnolongervalid onournewdatasetwithexhaustivepatchgeneration.
throughfurtherinvestigation weobservethatonemajorissue ofsimilarity basedstatictechniquesisthattheycanproducediverse similarityscoresforsemantic equivalentpatches.
forinstance listing1showsasimpleexamplepatch.
if this.rightblock !
null if false rectangleconstraint c4 newrectangleconstraint... listing1 apraprpatchreplacingconditionwith false table5 staticpcconsemanticallyequivalentpatches chart mutant tokenstrct tokenconpt astdist astcosdist mutateconditiontofalse .
.
.
removewholeblock .
.
.
chart mutant variabledist variablesimi syntaxsimi semanticsimi mutateconditiontofalse .
.
.
removewholeblock .
.
.
thispatchsimplyreplacestheconditionalexpressionwith false which is semantically equivalent to removing the whole if block.
thescoresgeneratedbythethreestatictechniquesaretotallydifferent as shown in table .
the mutate condition to false row displaysthescoresoftheoriginalpatch i.e.
replacetheconditional expressionwith false whilethe removewholeblock rowdenotes thescoresofthesimpli f iedpatch i.e.
simplyremovingthewhole ifblock.amongtheeightstaticfeatures thesimilarityscoresof ssfixfeaturesoforiginalpatcharesigni f icantlyhighercompared with the simpli f ied patch i.e.
the patch with the whole ifblock removed .
and84.
respectively whiletheeditdistance scoresfors3oftheoriginalpatchhavemuchlowerscoresthanthe simpli f iedpatch.forcapgenfeatures thescoresarealsocompletely differentfromeachother.thesecasesarefrequentlyobservedin our dataset i.e.
a patch can be simpli f ied to its equivalent patch.
there are mutating condition to false patches among the u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2patches inadditiontootherpatcheswithsimilarpatterns.
suchresultsprovidestrongerevidencethatmerelyconsideringthe syntactic similarity is inadequate for pcc while more advanced semantics basedtechniquesshouldbeproposed.
finding all three studied static techniques can compute totallydifferentscoresforsemanticallyequivalentpatches indicatingthatfuturestaticpcctechniquesshouldincorporate moreadvancedsemanticsanalysis.
.
.
anti pa t terns.
table6presentstheresultsofanti patterns onourfournewdatasetsanditsoriginalresultsinpreviouswork .
fromthetable wecanobservethatanti patternsperformssignificantlyworseonpraprpatchesbymisidentifyingalargerproportionofcorrectpatchesasover f ittingandomittingmoreover f itting patches.comparedtothepreviousdataset anti patternsexhibitsboth lower u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450and u1d445 u1d452 u1d450 u1d44e u1d459 u1d459on u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
although u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b hasasuspectedimprovement theactualcauseistheheavilyimbalanceddatasets i.e.
theoverwhelmingnumberofover f ittingpatches overthecorrectones.actually theresultsonthebalanceddataset u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.0furthercon f irmtheworseperformance.
table6 performanceofanti patterns datasets tpfptnfn u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
wefurtherlookedintotherootcauseofanti patterns poorperformanceonourdatasetswithamisclassi f iedexamplegenerated exclusively by prapr and has not been included in any previous dataset.listing 2presentsanfnexamplethatanti patternsfailsto f ilter.theover f ittingpatchmakesasubtlemodi f icationbyremovingthemethodinvocation calculatebottominset i.e.
onlyone tokenchanged .suchamodi f icationdoesnotfallintoanyexisting anti patterns thuscannotbeexcludedduringpcc.actually the lossofefficiencyderivesfromtheoriginalintentionofanti patterns.
anti patternswasdesignedinitiallyto f ilteroutover f ittingpatches that have major wrongness instead of capturing subtle changes.
however mostofthepatchesinourdatasetcontainsubtlechanges.
meanwhile otheraprtoolsarealsopronetogeneratepatcheswith subtlechangesinpractice.asaresult anti patternsisfacedwith theriskofinsufficiencyinevaluatingpccinfuturework.
doubleb calculatebottominset h doubleb h 3area.setrect area.getx l 4area.gety t w l r h t b listing2 anover f ittingpatchmisclassi f iedbyanti patterns finding3 derivingfromtheoriginalintention anti patterns performsmuchworseonourdatasetsduetoitslimitedcapabilityofidentifyingsubtlechangesinpatches.consideringthe widespreadoccurrenceofsubtlechangesinallapr generated patches anti patternsmaynotbeagoodchoiceforevaluating pccinfuturework.
.
.
naturalness basedtechniques.
table7showsinalldatasets bothsumentropyandmeanentropycanoutperformallthreestatic techniques.
the box plot of distribution of rankings is listed on ourwebsite.speci f ically intermsofavr thesum meanentropy outperformsthebestperformedstatictechniqueby11.
.
on u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
on u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
on u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
on u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
and .
.
on u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.interestingly ourresultsalsocon f irmpriorwork thatsumentropyperformsslightlybetterthanmeanentropyfor pcc.thereasonisthatsumentropycalculatestheentiresequence entropyforcodenaturalnesscomputation andconsidersbothcode naturalnessandlengthinformation.toconclude naturalness based techniquesshowgreaterpotentialinpccandthisisthe f irst toour bestknowledge evaluationofnaturalness basedtechniquesonpcc datasets.weappealtothecommunitythatmoreattentionshould bedrawnintothisdirection.
1210alarge scaleempiricalreviewofpatchcorrectnesscheckingapproaches esec fse december3 sanfrancisco ca usa table7 performanceofcodenaturalness avr ssfix s3capgen sumentropy meanentropy u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
.
.
.
.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
.
.
.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
.
.
.
.
.
.
.
finding4 naturalness basedtechniquescansubstantiallyoutperformallstaticcodefeaturesinpatchranking andsumentropyperformsslightlybetterthanmeanentropy.
.
rq2 learning basedtechniques table8 performanceoftheembedding basedtechnique datasets tpfptnfn u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450pr auc u1d447 u1d456 u1d44e u1d45b u1d4631.
.
.
.
n a u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
u1d4631.
.
.
.
.
.
.
embedding technique.
table8presents the results of the embedding based technique on our datasets i.e.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
and u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
since there is a large overlap between the trainingsetoftheembeddingtechniqueand u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
i.e.
patchescollectedbyliu etal.
wedonotconsider u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.0or u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.0inthisrq.forcomparison wealsopresenttheresultsof theembedding basedtechniqueinitsoriginalpaper i.e.
u1d447 u1d456 u1d44e u1d45b u1d4631.
.
wecanobservethatthe u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b increasesinournewdatasets whilethe u1d445 u1d452 u1d450 u1d44e u1d459 u1d459and u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450droponboth u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2and u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
thedecreaseof u1d445 u1d452 u1d450 u1d44e u1d459 u1d459and u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450becomesevenlargerinthenewly addedpatches i.e.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
u1d4631.
.suchabnormalperformanceis due to the heavily imbalanced dataset.
therefore we should pay more attention to pr auc the metric which is least affected by theimbalanceddataset.obviously theembedding basedtechnique tendstoperformbadlyonpraprpatcheswithpr auctobeless than20 onallournewdatasets.furthermore withthedatasets tobegraduallymorebalancedthrough u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0and u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
u1d4631.
i.e.
exclusivebugsin u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
theperformanceof u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459and u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450keepsdroppingwhilethepr aucincreases whichindicatestheworseperformanceismorecredible.the resultsfurthercon f irmsthattheembedding basedtechniquesuffers fromthedatasetover f ittingissue itperformsworseonthepatchesof subjectsthataredifferentfromtrainingset.thus weencouragefuturelearning basedpccworktoconsideracross datasetevaluation.
we then look into the potential reasons for such a decrement.
theintuitionofembedding basedpcctechniquesisthatthecosine similaritybetweentheembeddingvectorsofcorrectpatchesand buggycodeshouldbelargerthanthecosinesimilaritybetweenthe embeddingvectorsofover f ittingpatchesandbuggycode.tian et al.
showthatcorrect over f ittingpatchesintheirdatasetperfectly follow such an assumption.
however this assumption no longerholdsontheadditionalpatchesgeneratedbyprapr.figure presentsthedistributionofthecosinesimilaritybetweentheembeddingvectorsofcorrect over f ittingpatchesandbuggycodeonthe originaldatasetintheembeddingwork i.e.
u1d447 u1d456 u1d44e u1d45b u1d4631.
andour datasetsbuiltondefects4jv1.2andadditionalbugsindefects4jv2.
i.e.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2and u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
u1d4631.
.fromthe f igure weobservethat differentfromthepriorwork correctpatchesandover f ittingpatchesshareveryclose distributionsofsimilarityscores onour datasets whichexplainswhytheembedding basedtechniqueexhibitsworseperformanceonpraprpatches.furthermore correct patcheseventendtohavelowermediansimilaritythanover f itting patcheson u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
u1d4631.
demonstratingthattheassumptionmade bytheembedding basedworknolongerholdsonournewdataset.
figure1 similaritydistributionondifferentdatasets finding5 theassumptionthatthecosinesimilaritybetween theembeddingsofcorrectpatchesandbuggycodeshouldbe largerthanthatbetweentheembeddingsofover f ittingpatches andbuggycodenolongerholds.
also theembedding based techniquetendstosufferfromthedatasetover f ittingissue.
.
.
ods.
table9shows the result of ods in our dataset.
for u1d44a u1d44e u1d45b u1d454 u1d4631.
wedirectlyreusetheresultsfrom .itturnsoutthat theperformanceon u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2and u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.0signi f icantlydropfor u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 cpr and acc e.g.
cpr drops from to which meansalotofover f ittingpatches escape odsandgetmisidenti f iedascorrect.similarly the u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450dropsbecausemorecorrect patchesareclassi f iedasover f itting.
table9 performanceofods ods tpfptnfnprecision recall u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450f1cpraccuracy u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
.
.
.
doubleb calculatebottominset h doubleb trimwidth h listing3 anover f ittingpatchthatescapesods moreinterestingly weevaluateodsondeveloperpatchesand foundthatthefprate ratioofdeveloperpatchesidenti f iedasover f itting is43.
and41.
ondeveloperpatchesv1.2andv2.
.to f igureoutthepotentialreasonthattheperformancedrops wecarefullycheckthefeaturede f initionsinodsandunderstandwhyprapr patchescanescapeods.odsde f ines202featuresintotal inthree groups .accordingtothefeatureanalysisofods theorder ofimportanceofthreegroupsoffeaturesis contextualsyntactic features code description features repair pattern features .notethatodsfeaturesarespeci f iccharacteristicsof programslikewhetherthepatchvariablesarelocal global primitive etc.
orwhetherthere scodemove.forsingle linereplacementrepair toolprapr itnormallymakessimplechangelikereplacingavariable constant methodwithanotheroneofthesametypeaccording 1211esec fse december3 sanfrancisco ca usa junyang yuehanwang yilinglou mingwen andlingmingzhang tothemutatorsde f inedin .therefore mostpraprpatchesdo notaffectthemajorityoftheodsfeaturesatall.
listing3isanexamplepatchforbugchart 26showinghowprapr patchesescapeods.praprgenerates103patchesforthisbugand23 ofthemareclassi f iedascorrectbyods whileactuallyonlytwoof themarecorrect .11ofthemsimplyreplace calculateleftinset withotherapisandareallidenti f iedascorrectbyods.suchcases producelargeamountoffnsandthusleadtoverylowcpr .
finding6 featuresofodsaretooweaktoidentifyover f itting patchesandmissalotofover f ittingpatchesinourdataset.plus thehighfprateondeveloperpatchesisunbearableforpcc.
.
rq3 dynamictechniques .
.
opad.
table10andtable 11respectivelyshowtheresultsfor e opad opadwithevosuite andr opad opadwithrandoop .
table10 performanceofe opadondifferentdatasets e opad tpfptnfn u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
table11 performanceofr opadondifferentdatasets r opad tpfptnfn u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4632.
.
.
.
u1d440 u1d452 u1d45f u1d454 u1d452 u1d4632.
.
.
.
u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
.
.
.
we can observe that except for r opad on u1d435 u1d44e u1d459 u1d44e u1d45b u1d450 u1d452 u1d4632.
opad achievesaprecisionover95 onallthedatasets whiletheachieved recallrangesfrom11.
to18.
.thehighprecisionwithlow recallachievedbyopadisconsistentwithpreviousstudies .
besides the u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450alsosigni f icantlyoutperformsothertechniques withrespecttoprecision.suchresultsindicatethatopadcanidentifymostofthecorrectpatchesandrarelyclassi f iescorrectpatches asover f ittingones.
inotherwords theperformancedoesnotdegrademuchinournewdatasets andopadismorestablethanstatic techniques.thisfallsintoourintuitionsincesuchdynamictools basedontestgenerationconcernmoretowardscodesemanticsinsteadofsyntacticelements.meanwhile similartothe f indingsfrom priorwork opadachievesaratherlowrecallonourdatasets indicatingthatasubstantialratioofover f ittingpatchesarenotdetected.thisisstillacriticalissueinpccsincemanually f ilteringout over f ittingpatchescanbeextremelycostlyfordevelopers .
finding7 theperformanceofopadoveralltendstoremain similaronournewdatasets demonstratingtherobustnessof suchdynamictechniques.meanwhile consistentwiththe f indingsinpriorwork itachievesaratherlowrecallforincorrect patches whichcompromisesitspracticalusefulness.
thoughtheprecisionachievedbyopadisstillhighinournew datasets itcannolongerachieve100 preision i.e.
afewcorrect patchesaremisidenti f iedasover f itting.thisisinconsistentwiththeresultsinpreviousstudiesforpcc .motivatedbythis wefurtherinvestigatedthefpcasesandmadethefollowingobservations.
if property null return this 4jsonformat.
valueformat findformato serializers property handledtype ... listing4 acorrectpatchmisclassi f iedbyopad for instance listing 4shows a correct patch which is identi f iedasover f ittingbyopad.speci f ically thispatchremovesa null checkfor property .however opadisdesignedbasedonthetests generatedontheoriginalbuggyprograms thusbeingunawareof suchsemanticchanges.whensteppingintomethod findformato at line from a test property is null which is unexpected to thetestsgeneratedontheoriginalbuggyprogram.consequently a nullpointerexception wasthrownandin findformato andthus opadmis identi f iedthispatchasover f itting.manyothersimilar caseshavebeenobservedforopad.thereasoncouldbethatsome testsaregeneratedonthebuggyprograms basedonsomeincorrect contractsorpreconditions.whenthesemanticsofaprogramchange thosepreconditionsmaynotholdandthusfailageneratedtest.
finding8 theeffectivenessofopadmightdecayanditmight mistakenlyidentifycorrectpatchesasincorrectwhenthesemanticchangesofthepatchesbreakcertainconditions.
sincedeveloperpatchesmightevenincurlargersemanticchanges wearecurioustoseewhethersuchcasesalsohappenondeveloper patches.
unfortunately there are no existing studies to our best knowledge.
however this is an important study since apr techniquescanpotentially f ixmorebugsandproducemoredeveloper patches in the near future.
as shown in table e opad and ropadachieve u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450of86.
and79.
respectively whichis signi f icantlylowerthanthatonotherdatasetsexceptfor u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
speci f ically opadproducesmorefpsandachieveslower u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 comparedwithpreviousstudy .
table12 opad patch simondeveloperpatches tp fp tn fn u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 e opad .
r opad .
patch sim .
public static intformatlongoctalorbinarybytes ... if length ... else formatbigintegerbinary value buf offset length negative formatbigintegerbinary value buf offset length negative buf byte negative ?0xff 0x80 returnoffset length listing5 adeveloperpatchmisclassi f iedbyopad wefurthermanuallycheckedsomefpcasesindeveloperpatches andlisting 5isanexample.speci f ically thedeveloperpatchmoved astatementintoan elseblockwithacondition length .the failingtestexpectsan illegalargumentexception triggeredbyinvalidparametersof formatbigintegerbinary .theoriginalstatementthrowingthatexceptionwasnotexecutedinthepatchedprogram.therefore theprogramsteppedoverthatstatementandwhen 1212alarge scaleempiricalreviewofpatchcorrectnesscheckingapproaches esec fse december3 sanfrancisco ca usa executingthenextstatement line7 theparameter offsetis triggeringan arrayindexoutofboundsexception .
similartothepreviousexample opadisnotawareofsuchsemanticchangesandmisclassi f iedthatpatchasover f itting.actually opad couldproducemorefpswhenthepatchesgetmorecomplicated i.e.
differentcodestructureorlogic.thiscanbeanimportant f inding sinceeventuallyaprtechniqueswillbeconqueringmoreandmore complicatedbugs withmoreandmorecomplicatedpatches.
finding opad performs worse on developer patches and shouldbeappliedwithcautionon future automatedaprtools thatcangeneratemorecomplicatedpatches.
.
.
patch sim.
table13presentstheperformanceofpatch sim onpreviousdatasets i.e.
u1d44b u1d456 u1d45c u1d45b u1d454 u1d4631.2fromitsoriginalpaper and u1d44a u1d44e u1d45b u1d454 u1d4631.2fromthepreviousstudy andourdataset.notethat duetoanimplementationissue patch simdoesnotsupport defects4j v2.
and subjects closure and mockito from defects4j v1.
.hence followingpriorwork weonlyconsiderthepatches supportedbypatch simfromdefects4jv1.
.overall 493over f itting and10correctpatchesin u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2areused.
table13 performanceofpatch simondifferentdatasets datasets tpfptnfn u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450 u1d44b u1d456 u1d45c u1d45b u1d454 u1d4631.
.
.
.
u1d44a u1d44e u1d45b u1d454 u1d4631.
.
.
.
u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.
.
.
.
asshown inthetable patch simperformsmuchworseon our dataset compared with initial u1d44b u1d456 u1d45c u1d45b u1d454 u1d4631.2results.
for example patch simachieves100 u1d443 u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b and u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450onitsoriginaldataset whereasonpraprpatches bothmetricsaredegraded aligningwith previous f indings .patch simisdesignedbasedonthe mildconsequenceassumption thatapassingtestshouldbehavesimilarlyonthe correctpatchandthebuggycode.therefore thepatchsubstantially changingthebehaviorofpassingtestswouldberegardedasover f itting.listing 6presentsasamplefpofpatch sim.inthisexample the correctpatchmodi f iesthecondition leadingtosigni f icantcontrol f lowchanges onthebuggycode somepassingtestscanenterthe if blockandthenthrowtheexception whereasonthepatchcodethese testsskipthe ifblockandexceptionstatement.therefore patchsimconsidersthebehaviorsofthesepassingtestschangedsubstantially andfurtherregardsthepatchasover f itting.however correct patchesarealsolikelytointroducelargebehavioralchangeswhereas over f ittingpatchescanalsoinducetinyimpactonpassingtests.
if fa fb .
if fa fb .0d throw new convergenceexception... listing6 acorrectpatchmisclassi f iedbypatch sim finding10 theassumptionthatpassingtestsshouldbehave similarlyoncorrectpatchcodeandbuggycodecaneasilybe brokenwhenalargerpatchspaceisconsidered especiallyforthe correctpatcheswithnon trivialmodi f icationsoncontrol f low.
table12presentstheperformanceofpatch simon175 developer patchesfromdefects4jv1.2wherepatch simcanbesuccessfully applied.interestingly patch simperformsevenworseondeveloperpatcheswitha u1d445 u1d452 u1d450 u1d44e u1d459 u1d459 u1d450ofonly62.
i.e.
mis classifying37.
correctpatchesasincorrect.aftermanualinspection we f indthatdeveloperpatchesofteninvolvesophisticatedmodi f icationsandthuspassingtestsbehaveverydifferentlyfrombuggycode.forexample listing7presentsadeveloperpatchwhichmis identi f iedasover f itting bypatch sim.thepatchmodi f iesmultiplelines andseveral if else statements.thus itsigni f icantlyaffectsthepathsofsomepassing tests.
in fact it is prevalent that developer patches contain such sophisticatedchanges andthustheassumptionmadebypatch sim canbeeasilyviolatedondeveloperpatches.suchresultsshowthat futurepccworkshouldexercisecomplexpatchessinceadvanced aprtoolscangeneratemorecomplexpatchesinthenearfuture.
if ... index seqend ... if ... index seqend ... ... if start seqend return0 ... while input.charat end !
while end seqend input.
charat end input.charat end input.charat end a input.charat end f input.charat end a input.charat end f ... boolean seminext end!
seqend input.charat end return2 end start ishex?
return2 end start ishex?
seminext ?
listing7 adeveloperpatchmisclassi f iedbypatch sim finding11 patch simmisclassi f ies30 correctpatchesasincorrecton u1d443 u1d45f u1d44e u1d443 u1d445 u1d4631.2andtendsperformevenworsewith38.
misclassi f ion rate on complicated developer patches.
our resultsalsosuggestthatfuturedynamicpcctechniquesshould considermorecomplexpatchesforevaluation.
conclusion this paper constructed a comprehensive pcc dataset u1d443 u1d45f u1d44e u1d443 u1d44e u1d461 u1d450 uni210e for revisiting state of the art pcc techniques.
our study has revealedvariousinteresting f indings suchas1 thesimilarity based assumptionsnolongerholdinthenewdataset naturalness based techniques can substantially outperform static code features embedding basedtechniquesandfeatureengineering ods canmisclassifyalotofcorrectpatchesand4 performanceofdynamictechniquesremainstableinthenewdatasetbutwilldecaywhenhandling patcheswithcomplexsemanticchanges likedeveloperpatches .
these f indingsmaysavealotresearcheffortsfortheresearchcommunityandpointoutfuturedirections likeleveragingllmsforpcc andincludingmorerealisticbugstoenhancediversityofthedataset.
dataavailability please see or our archivedartifact .