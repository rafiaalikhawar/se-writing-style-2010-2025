large scale security measurements on the android firmware ecosystem qinsheng hou1 wenrui diao1 yanhao wang3 letter xiaofeng liu1 song liu3 lingyun ying3 shanqing guo1 letter yuanzhi li3 meining nie3 and haixin duan4 1school of cyber science and technology shandong university 2key laboratory of cryptologic technology and information security of ministry of education shandong university 3qi anxin technology research institute 4institute for network science and cyberspace tsinghua university 5tsinghua university qi anxin group jcns 6quancheng laboratory jinan china houqinsheng mail.sdu.edu.cn wangyanhao136 gmail.com guoshanqing sdu.edu.cn abstract androidisthemostpopularsmartphoneplatformwithover85 marketshare.itssuccessisbuiltonopenness andphonevendors can utilize the android source code to make products with unique software hardware features.
on the other hand the fragmentationandcustomizationofandroidalsobringmanysecurityrisks that have attracted the attention of researchers.
many efforts were put in to investigate the security of customized android firmware.
however most of the previous work focuses on designing efficient analysistoolsoranalyzingparticularaspectsofthefirmware.there stilllacksapanoramicviewofandroidfirmwareecosystemsecurity and the corresponding understandings based on large scale firmware datasets.
in this work we made a large scale comprehensive measurement of the android firmware ecosystem security.
ourstudyisbasedon6 261firmwareimagesfrom153vendorsand 602android relatedcves whichisthelargestandroidfirmware dataset ever used for security measurements.
in particular our study followed a series of research questions covering vulnerabilities patches security updates and pre installed apps.
to automate theanalysisprocess wedesignedaframework andscanner to complete rom crawling rom parsing patch analysis and app analysis.
through massive data analysis and case explorations several interesting findings are obtained.
for example the patch delay and missing issues are widespread in android images say .
and .
of all images respectively.
the latest images of severalphones still contain vulnerable pre installed apps and even the correspondingvulnerabilitieshavebeenpubliclydisclosed.inaddition to data measurements we also explore the causes behind thesesecuritythreatsthroughcasestudiesanddemonstratethat thediscoveredsecuritythreatscanbeconvertedintoexploitable vulnerabilities via38 newfound vulnerabilitiesby our framework 32ofwhichhavebeenassignedcve cnvdnumbers.thisstudy providesmuchnewknowledgeoftheandroidfirmwareecosystem withdeepunderstandingofsoftwareengineeringsecuritypractices.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may pittsburgh pa usa association for computing machinery.
acm isbn ... .
concepts software and its engineering software safety.
keywords android firmware ecosystem security measurements security patches pre installed apps acm reference format qinshenghou wenruidiao yanhaowang xiaofengliu songliu lingyun ying shanqingguo yuanzhili meiningnie andhaixinduan.
.largescale security measurements on the android firmware ecosystem.
in 44th internationalconferenceonsoftwareengineering icse may21 pittsburgh pa usa.
acm new york ny usa pages.
.
.
introduction nowadays android plays a fundamental role in people s daily life with an market share of smartphones .
besides smartphones otherdevicesrunningandroidoscanbeseeneverywhere like smartwatches and smart tvs.
such success is largely credited with the openness of android which allows vendors to build their own customized rom images for different devices based on aosp android open source project .
ontheotherhand theopennessofandroidcomeswithrisks.
the large number of customized rom images built by different vendors make the android ecosystem seriously fragmented whichisabigchallengetoguaranteethesecurityoftheandroid ecosystem.
to vendors the technical abilities and the attitudes towards security result in the differential security of their romimages.
for example although google releases security patchesto the security bulletins every month many vendors did not follow up the patches in time even some vendors just change the updated date without fixing vulnerabilities .
also the preinstalledappsmayhavesecurityproblems.itcouldbecausedby thephonevendorsthemselves likethemes cve in samsungdevices whichisavulnerablepre installedappwithanar bitrary app installation vulnerability.
some problems are caused by thesuppliers apps likewfoservice cve inapanasonic device a pre installed appfrom the chip supplier mediatek allowinganyappco locatedonthedevicetomodifyanysystem properties.
in recent years many efforts have been taken to investigate and improve the android ecosystem security.
for example elsabagh ieee acm 44th international conference on software engineering icse authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
etal.
presentedfirmscope anautomatedanalysissystemto uncover different types of vulnerabilities in pre installed apps.
lell et al.
implemented an app named snoopsnitch to do binaryonly analysis on android patches without access to source code.
zhang et al.
investigated the android kernel patch ecosystem revealing the relationship among different parties as well as the bottleneck in patch propagation.
gamba et al.
studied the ecosystemofpre installedandroidappsanditspotentialimpact on consumers.
however most of the previous work focuses ondesigning efficient analysis tools or analyzing particular aspectsof the firmware.
there still lacks a panoramic view of android firmwaresecuritybasedonlarge scalefirmwaredatasetsandthe correspondingunderstandingbehindthecurrentsecuritysituations.infact someresearchquestionscannotbesolvedwellwithoutlargescale measurements and numerous case studies.
for example it hasbeennotedthatsomephonevendorsfailedtofixsomecves confirmed by google .
however is the security patch missing issueacommonsecurityriskorafalsestatement withrarecases ?
whydothevendorsmisssomepatches?whichphonemodelsperformwell orpoorly inthepatchmissingaspect andwhatarethereasons?
ourwork.
inthiswork wecarriedoutalarge scalecomprehensive security measurement of the security of android firmware fromboth the system and pre installed app levels.
also we try to uncover the causes and influences behind the security risks.
to guide ourmeasurement werefinefour importantresearchquestions on android firmware security including q1do the android phone vendors follow up the releasedaosp security patches in time?
regular security update playsanessentialroleinprotectingmobiledevices.android partners vendors are notified of all vulnerability details at least a month before the public disclosure and they haveenough time window to update their firmware.
however whetherthevendorsindeedfollowupthesecurityupdate ofaospintimeisstillaquestion.wearealsocuriousabout the causes of the patch delay.
q2whether the patching claims of phone vendors are re liable?
though the phone has been updated to the latest securitypatchlevel there isstillnoguaranteethatthecorrespondingvulnerabilitieshavebeenfixedbythevendorscompletely.
it needs to answer whether the patch missing issue is a widely existing security practice mistake.
the further question is why vendors missed some patches provided by google say deliberately or technical issues.
q3how many pre installed apps containing unfixed vul nerabilities cves ?
in addition to the os patch missing issue mentioned by q2 pre installed apps also may have known and unfixed vulnerabilities.
that is the rom images contain vulnerable apps with cves which attackers will quickly exploit.apart from the detectionstatistics we also wanttoexplorethesourcesofthesevulnerablepre installed apps and the actual scope of influence.
q4whetherthe non vulnerable pre installedappsarese cure?
thesecurityrisksofpre installedappsarenotlimited tocves.manycommonconfigurationmistakescanresultinseveresecurityissues likeexportedcomponentsandcryptographicmisuse.weplantomeasuretheoverallsecurity situations of pre installed apps from multiple levels and explore whether these configuration mistakes can result in practical security threats.
toanswertheproposedquestionsandexplorethereasonsbehindthem webuiltalarge scalefirmwaredataset covering6 android firmware images from phone vendors with pre installed apk files in all unpacked images .
to the best of our knowledge itisthelargestandroid firmwaredatasetever used for security measurements .
also apart from the android officiallyreleased411cves wecollected191cvesassociatedwithpre installedapps.inparticular wedesignedanautomatedanalysis framework named andscanner to execute a series of targeted measurements and primarily explorations.
after massive data analysis and case studies finally we can answer the above researchquestions and provide new knowledge of the android firmwareecosystem with deep understandings to the security practices insoftwareengineering.inthiswork wehopetohelp consumers learn more about the security knowledge of android phones such asthetimelinessandefficacyofsecurityupdatesandwhetherthere are security vulnerabilities in pre installed applications.
therefore they can have security relevant