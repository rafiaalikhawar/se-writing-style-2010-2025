finding a needle in a haystack automated mining of silent vulnerability fixes jiayuan zhou michael pacheco zhiyuan wan xin xia bardbl david lo y uan wang and ahmed e. hassan centre for software excellence huawei college of computer science and technology zhejiang university hangzhou china faculty of information technology monash university melbourne australia school of information systems singapore management university singapore software analysis and intelligence lab sail queen s university jiayuan.zhou1 michael.pacheco1 yuan.wang1 huawei.com wanzhiyuan zju.edu.cn xin.xia monash.edu davidlo smu.edu.sg ahmed cs.queensu.ca abstract following the coordinated vulnerability disclosure model a vulnerability in open source software oss is suggested to be fixed silently without disclosing the fix untilthe vulnerability is disclosed.
yet it is crucial for oss usersto be aware of vulnerability fixes as early as possible as oncea vulnerability fix is pushed to the source code repository amalicious party could probe for the corresponding vulnerabilityto exploit it.
in practice oss users often rely on the vulnerabilitydisclosure information from security advisories e.g.
nationalvulnerability database to sense vulnerability fixes.
however the time between the availability of a vulnerability fix andits disclosure can vary from days to months and in somecases even years.
due to manpower constraints and the lackof expert knowledge it is infeasible for oss users to manuallyanalyze all code changes for vulnerability fix detection.
therefore it is essential to identify vulnerability fixes automatically andpromptly.
in a first of its kind study we propose vulfixminer atransformer based approach capable of automatically extractingsemantic meaning from commit level code changes to identifysilent vulnerability fixes.
we construct our model using sampledcommits from projects and evaluate using the full set ofcommits from additional projects.
the evaluation results showthat vulfixminer outperforms various state of the art baselinesin terms of auc i.e.
.
and .
on java and python dataset respectively and two effort aware performance metrics i.e.
effortcost p opt .
especially with an effort of inspecting of total loc vulfixminer can identify of total vulnerabilityfixes.
additionally with manual verification of sampled commitsthat were identified as vulnerability fixes but not marked assuch in our dataset we observe that out of of thecommits are for fixing vulnerabilities indicating vulfixminer isalso capable of identifying unreported vulnerability fixes.
index t erms software security vulnerability fix open source software deep learning i. i ntroduction coordinated vulnerability disclosure also known as responsible disclosure is a widely used vulnerability disclosuremodel 3in which the relevant information of a vulnerability is only disclosed after a period of time that allowsfor the vulnerability to be fixed.
following this process a bardblcorresponding author.
in an open source software oss is suggested tobe reported privately to the oss maintainers who silently fix the vulnerability i.e.
push the commit s to the sourcecode repository without explicit log messages indicating thevulnerability .
they then integrate the fix publicly into theoss e.g.
including the fix in a new release and finallydisclose the vulnerability and its fix.
it is important for oss users to be aware of vulnerability fixes and apply fixes in time.
in equifax suffered froma data breach compromising the personal information ofover million u.s. consumers due to a missed securityupdate .
to be aware of vulnerability fixes oss usersusually monitor the vulnerability disclosure information frompublic vulnerability advisories.
common vulnerabilities and exposures cve and the national vulnerability database nvd are two of the mostpopular public vulnerability advisories.
nvd is a robust andwidely used vulnerability advisory fully synchronized withcves and provides additional information e.g.
the severity regarding vulnerabilities.
thus it is a common practice foross users to monitor nvd primarily as a method of becom ing aware of vulnerabilities and their fixes.
however due tothe slow progress in disclosing reported vulnerabilities itis challenging to promptly discover vulnerability fixes.
also the time interval between the availability of a vulnerabilityfix and its disclosure can vary from days to years and the median of this time interval was reported to be more than oneweek in nvd .
as an example cve is aremote code execution vulnerability in apache struts whichis the same type as the critical vulnerability that led to thedata breach of equifax.
this vulnerability was silently fixedin the public code repository in june though thepatch was disclosed two months later.
given the public natureof oss development once a vulnerability fix is pushed tothe source code repository a malicious party could infer thecorresponding vulnerability and exploit it before the securitypatch is publicly integrated or disclosed.
as a result the users 36th ieee acm international conference on automated software engineering ase 36th ieee acm international conference on automated software engineering ase .
ieee .
ase51524.
.
.
ieee of apache struts were exposed to huge security risks during the two months between patch availability and disclosure.
the disclosure latency will extend the vulnerability s window of exposure and it makes oss users especially theenterprise users who use oss in their products at a greatdisadvantage in defending security attacks.
hence it is crucialto facilitate the awareness of vulnerability fixes for oss users so that they can react to the vulnerabilities as early as possible.for example when enterprise users receive the notifications ofvulnerability fixes they can infer the corresponding vulnerabil ity and evaluate the security impact on their product and takeactions e.g.
recompile the software to incorporate the criticalfixes that might cause huge loss before the vulnerability ispublicly disclosed.
without the early awareness oss usersneed to rush to address the vulnerability at the date of thedisclosure.
hence early awareness helps oss users reducethe stress of keeping their system safe.
in addition beingaware of the fix earlier could help shorten the vulnerabilityremediation time for oss users.
for example with the help ofhot patching frameworks hot patches can be derivedfrom the original vulnerability fixes to ease the deployment ofsecurity updates.
following coordinated vulnerability disclosure in oss contexts a vulnerability is suggested to be fixed silently which means that any information indicating the nature ofthe vulnerability should not be exposed.
for example thevulnerability handling process of apache 5suggests messages associated with commits should not make any reference toany security related nature.
hence for general oss users theonly way to be aware of silent vulnerability fixes promptly isto monitor and analyze the commit code changes constantly which is infeasible due to manpower constraints.
therefore itis essential to propose approaches that automatically identifysilent vulnerability fixes in real time.
previous studies leverage vulnerability related artefacts e.g.
commit messages and issue reports to identifyvulnerability fixes.
they extract features from textual data andleverage machine learning techniques to predict whether acommit is for fixing a vulnerability or not.
different from pre vious work we incorporate a deep learning solution designedfor analyzing the code of commits.
in our work we propose vulfixminer a transformerbased model to automatically identify silent vulnerabilityfixes in a practical setting i.e.
extremely imbalanced classdistribution of the fixes .
since we are interested in silentvulnerability fixes of which the commit message should notleak information related to the vulnerability we only con sider code change information.
given the outstanding abilityin learning effective contextual representation we leveragethe transformer based language model codebert which is pre trained on a large programming language corpus to learn the semantic meaning of code changes.
we first fine tune codebert to learn the semantic meaning of file levelcode changes to generate contextual embedding vectors for files.
the vectors are then aggregated to generatea commit level contextual embedding vector which is usedfor classification.
vulfixminer is capable of cross project andcross language just in time vulnerability fix identification.
we construct our model using commits from projects and evaluate it using commits from 52projects that are unseen during the training phase.
the evalua tion results show that vulfixminer outperforms various state of the art baselines in terms of auc i.e.
.
and .
onjava and python dataset respectively and two effort awareevaluation metrics i.e.
effortcost p opt .
particularly with an effort of inspecting of the total loc vulfixminercan identify of total vulnerability fixes.
additionally by manually investigating a sample of commits identified asvulnerability fixes that are not marked as vulnerability fixes inour dataset we observe out of of them are forfixing vulnerabilities indicating vulfixminer is also capableof identifying unreported vulnerability fixes.
in summary this paper makes the following contributions we propose the use of vulfixminer to automaticallyidentify silent vulnerability fixes supporting both cross project and cross language scenarios.
to the best of our knowledge we are the first to use deeplearning techniques to identify silent vulnerability fixes ina practical setting.
vulfixminer achieves higher discriminative power andefficiency compared to state of the art baselines in identi fying silent vulnerability fixes when evaluated on a com plete set of commits from java and python projects.
we find that vulfixminer is capable of identifying unre ported vulnerability fixes.
to promote future work we release the vulnerability fixesin our study .
paper organization.
this paper is organized as follows section ii introduces background information.
we elaborateon our approach on section iii.
section iv presents theexperimental procedures and results.
in section v we discussthe unreported vulnerability fixes the ethical consideration the other application scenarios the commit messages of silentvulnerability fixes and time efficiency.
sections vi and viicover the possible threats to validity and highlight relatedwork respectively.
we conclude this paper and discuss futurework opportunities in section viii.
ii.
p reliminaries in this section we briefly introduce the vulnerability disclosuremodels common vulnerabilities and exposures national vul nerability database and pre trained nlp models for naturallanguage tasks.
a. vulnerability disclosure models full disclosure.
in the full disclosure model the vulnerability is fully disclosed onto public disclosure channels as early as possible.
the idea behind this model is that the early 6note that we are undergoing the company s internal process for model publishing.
ylh lk i hy 4j4vyypz myvt ol 5v u 7yvqlj ylh lk i 1hzvu 9v sl myvt ol 5v u 7yvqlj ylh lk i ljypz myvt ol 5v u 7yvqlj ylh lk i ukylqz 2pyth myvt ol 5v u 7yvqlj ylh lk i ukylqz 2pythmyvt ol 5v u 7yvqlj commit ylh lk i ukylqz 2pyth myvt ol 5v u 7yvqlj ylh lk i ukylqz 2pythmyvt ol 5v u 7yvqlj commit ylh lk i 1hzvu 9v sl myvt ol 5v u 7yvqlj pre trained language model file level contextual embedding vectorfile level change code input tokensfile change transformerneural network classifier ylh lk i ukylqz 2pyth myvt ol 5v u 7yvqlj ylh lk i ukylqz 2pyth myvt ol 5v u 7yvqlj ylh lk i ukylqz 2pyth myvt ol 5v u 7yvqlj ylh lk i ukylqz 2pyth myvt ol 5v u 7yvqlj new commits oss users ylh lk i wyp hurh myvt ol 5v u 7yvqlj vulfixminerphase fine tuning phase training phase application commit change aggregator ... ... ... .
c5 ... ... ...rank commit score .
c1c3 .
ylh lk i ljypz myvt ol 5v u 7yvqlj ylh lk i ljypz myvt ol 5v u 7yvqlj code change preprocessor code change preprocessor commit level contextual embedding vectorlegend fig.
the overall framework of vulfixminer.
public awareness of the vulnerability will benefit users who are vulnerable more than malicious actors.
coordinated vulnerability disclosure.
in the coordinated vulnerability disclosure model a vulnerability remains undisclosed or silent as long as possible to provide developersof the software enough time to fix it.
after a new releaseincluding the fix is published the vulnerability is disclosed.this model is commonly and widely applied in many ossorganizations .
in this disclosure model users remain at risk as long as they are unaware that they are vulnerable.also a fix for the vulnerability might be committed to an ossrepository before the vulnerability is disclosed which we referto as a silent fix .
due to the lack of public exposure of thevulnerability it is expected that exploitation from malicioususers will be less likely.
however given the public nature ofoss development if a vulnerability is silently fixed beforethe fix is integrated a malicious party can discover these fixesfrom the public code repository and exploit the vulnerabilityin the vulnerable systems.
non disclosure.
in the non disclosure model no details of a vulnerability nor its fix are disclosed.
the software developers users and malicious attackers do not have accessto any public information regarding these vulnerabilities.
therisk involved with this model appears as users are never noti fied of vulnerabilities within the software.
although the non disclosure model prevents attackers from analyzing securityfixes and stops them from further finding similar vulnerabil ities 10oss users might not be aware of the urgency of a security fix and do not apply the fix.
in this case oss usersare always exposed to security risks.
in our paper we referto these fixes as unreported vulnerability fixes .
we discussthe capability of vulfixminer in identifying such fixes insection v a. common vulnerabilities and exposure cve and thenational vulnerability database nvd cve developed by the mitre corporation mitre provides a standardized method for software developers to disclose identify and manage software vulnerabilities.
once a vulner ability is identified the oss developers can request a uniquecve id from a cve numbering authority cna such asmitre for the vulnerability.
once this id is assigned thecve will be included in a vulnerability database for publicdisclosure.
cve is one of the most popular vulnerabilityadvisories oss users monitor them to discover vulnerabilitiesthat might impact them and the fixes to defend againstexploitation.
nvd 11is a popular cve database maintained by the national institute for science and technology nist .
nvd is automatically synchronized with the mitre database andincludes all cve information included in mitre as well asadditional information.
more specifically nvd assigns labelsto each url in the list of