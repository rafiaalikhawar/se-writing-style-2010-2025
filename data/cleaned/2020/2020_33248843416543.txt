understanding performance concerns in the api documentation of data science libraries yida tao college of computer science and software engineering shenzhen university china yidatao szu.edu.cnjiefang jiang college of computer science and software engineering shenzhen university china jiangjiefang2018 email.szu.edu.cnyepang liu department of computer science and engineering southern university of science and technology china liuyp1 sustech.edu.cn zhiwu xu college of computer science and software engineering shenzhen university china xuzhiwu szu.edu.cnshengchao qin school of computing engr.
digital technologies teesside university uk college of computer sci.
software engr.
shenzhen university china s.qin tees.ac.uk abstract the developmentof efficient datascience applications is oftenimpeded by unbearably longexecution time and rapid ram exhaustion.sinceapidocumentationistheprimaryinformationsource for troubleshooting we investigate how performance concerns are documented in popular data science libraries.
our quantitative resultsrevealtheprevalenceofdatascienceapisthataredocumented in performance related context and the infrequent maintenance activities on such documentation.
our qualitative analyses further reveal that crowd documentation like stack overflow and github arehighlycomplementarytoofficialdocumentationintermsofthe api coverage the knowledge distribution as well as the specific information conveyedthrough performance relatedcontent.
data sciencepractitionerscouldbenefitfromourfindingsbylearning amoretargetedsearchstrategyforresolvingperformanceissues.
researcherscanbemoreassuredoftheadvantagesofintegrating both the official and the crowd documentation to achieve a holistic view on the performance concerns in data science development.
keywords api documentation performance data science empirical study acm reference format yidatao jiefangjiang yepangliu zhiwuxu andshengchaoqin.
.understanding performance concerns in the api documentation of data sciencelibraries.in 35thieee acminternationalconferenceonautomatedsoftware engineering ase september virtual event australia.
acm newyork ny usa 12pages.
shengchao qin is the corresponding author.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september virtual event australia association for computing machinery.
acm isbn ... .
introduction data science is an emerging field that combines mathematics statistics machine learning and domain knowledge to derive insights fromdata .asthevolumeandcomplexityofdatagrowrapidly the painfully slow execution time and quickly exhausted ram are becomingthemajorbottlenecksfordevelopingefficientdatasci ence applications .
since external data science libraries such aspandas numpy and tensorflow are often used in these applications theirgoodperformanceisalsovitalforimprovingapplication efficiency and developer productivity.
nevertheless weobservepersistentandactivediscussionsonthe performance problems of data science libraries.
take the pandas libraryforexample.asofapril2020 thereare853questionsonstack overflowthataretaggedwithboth pandasandperformance and togetherthesequestionshaveoveronemillionviews.furthermore theansweracceptancerateforthesequestionsis58 withanaverage of days between the creation of questions and the proposal of accepted answers.
on the github repository of pandas issues labeled with performance have been reported.
while of theseissuesareclosed theaverageresolutiontimeisupto134days.
these observations imply that data science developers may suffer from recurring interruptions caused by intractable performanceproblems.existingworkhasalsorevealedperformanceissuesin other data science libraries that cause runtime inefficiency .
when data science developers are troubleshooting performance problems documentation will likely be their first resort.
for this reason understanding how performance related concerns are documented in data science libraries is crucial for steering effective performanceoptimizations.whilepreviousstudieshaveexplored the quality accessibility and knowledge types o f api documentation none of them targets on data science libraries andfewfocusontheperformanceaspects.tobridgethisgap we conduct an empirical study on popular data science libraries to understand the documentation practice on performance concerns whichdenotedescriptionsanddiscussionsrelatedtoruntimespeed and memory consumption.
in addition to the official api documentation maintained by library developers we also consider two 35th ieee acm international conference on automated software engineering ase .py .md .rst .ipynbapi docstring user guidestack overflow github performance concerns extraction api linking performance concerns in official documentationperformance concerns in crowd documentation knowledge classification evolution analysis consistency analysis evolution patterns of performance related documentationknowledge types of performance related documentationconsistency between official and crowd documentation figure overview of our methodology.
typesof crowd documentation stackoverflow soforshort and github whicharewell recognized resources fortroubleshooting development problems .
the research questions we aim to address include rq1 how common are data science apis documented in performance relatedcontext?howdoesperformance related documentation evolve over time?
rq2 whattypesofknowledgeareprovidedbyperformancerelated documentation?
rq3 whatarethedifferencesbetweentheofficialandcrowd documentation in terms of performance related content?
oursubjectsincludesixwidelyusedlibrariesfromthepython datascienceecosystem .weleveragedprogramanalysis natural language processing routines and traceability heuristics to automatically extract performance relatedsentences from documentation and establish links between the sentences and correspondingapis.weanalyzedtheextracteddatatostudythestatistics ofapisthataredocumentedinperformance relatedcontext.we also qualitatively analyzed the extracted performance concerns to understand their knowledge types evolution reasons and content consistency.
our major findings include from .
to .
apis of the target libraries have been documented in performance related context indicating the prevalenceofperformanceconcernsfordatasciencelibraries.
performance concerns in crowd documentation covers a differentsetofsubjectapiscomparedtoofficialdocumentation only apis have been mentioned in both data sources.
officialdocumentationfrequentlyprovidesthe functionknowledge e.g.
the runtime efficiency of a certain functionality whilecrowddocumentationfocusesmoreon practicesand alternatives types of knowledge.
so rarely provides explanatory knowledge types such as purpose rationale.
the vast majority .
of performance concerns from the crowddocumentationprovidenewinformationthatisnot present in the official documentation only a very few .
are inconsistent with the official documentation.
performance concerns in the official documentation are typically added long after the introduction of corresponding apis with an average of .
follow up updates that consist mostly of trivial semantic changes.table dataset statistics.
library version apis s o github threads issues numpy .
.
pandas .
.
scipy .
.
scikit learn .
.
tensorflow .
gensim .
.
in general we empirically analyzed how performance concerns on data science apis are documented in terms of their occurrences knowledge distributions information consistencies and evolution patterns.
our results further reveal how official documentation andcrowddocumentationcomplementeachotherinprovidinga holistic view of data science performance issues.
we hope that our work byprovidingabetterunderstandingofthedocumentation practice on performance concerns will benefit both data science practitionersandresearchersintheirbattlesagainstperformance bottlenecks.
our data are released for public usage .
methodology inthissection wepresentourmethodologyindetail.theoverall workflow is shown in figure .
.
data collection .
.
targetlibraries.
asshownintable1 wefocusonsixwidelyused libraries all of which are core packages in the python ecosystem for data science.
these libraries solve different classes of problems and together support various important tasks in data science.
inparticular numpyandpandasprovidefunctionalitiestowork with arrays and tabular data scipy and scikit learn providecommonnumericalroutinesforstatisticsandmachinelearning tensorflow is a general purpose deep learning framework while gensim is primarily used for natural language processing tasks .
.
.
officialdocumentation.
officialapidocumentationistypically authored and maintained by library developers.
we consider two types of official documentation the api docstrings and the officialuserguide.apythondocstringisastringliteral surroundedby tripledoublequotes thatappearsasthefirststatementofanapi definition.developersoftenusedocstringstoexplainthegeneral purpose of an api and how it should be used.
users can invoke python sbuilt in help functiontocheckthedocstringofagiven api .
to collect the docstring data we perform a depth first traversalontheabstractsyntaxtreebuiltfromtherootmoduleofeach target library to extract all the public apis i.e.
classes functions andattributes as shown in table .
we then leverage python s introspectioncapability toobtainthefilepath linerange and textual content of the docstrings for each api.
while docstrings provide succinct api level descriptions the official user guide provides a more high level overview of a library.
usersmayfindvarioustypesofinformationinauserguide suchas the basic concepts and algorithms used in the library the tutorials 896and caveats on api usages the guidance for extending the library and so on.
compared to api docstrings a user guide is more flexible in terms of the content syntax and structures.
to collect the userguidedata wetraversethesourcedirectoriesofeachlibrary recursivelytosearchforfileswiththeformatofrestructuredtext .rst markdown .md andjupyternotebook .ipynb .theformer two file formats correspond to light weight markup languages widely used for technical documentation while jupyter notebook is an interactive computing interface often used for developing debugging and demonstrating data science applications .
.
.
crowd documentation.
as online q a forums and social codingsitesarereshapingtheknowledgesharingindevelopercommunities research has proposed that sites like stack overflow and githubcanbeleveragedasessentialcomplementstoofficialapi documentation .for thisreason crowd documentation is also considered as an important data source in our study.
we used the official stack exchange rest api and github rest api to crawl so threads and github issues of our target libraries.notethatansothreadincludesaquestionpostandall ofitsanswerpostsandcomments whileagithubissueincludes anissuedescriptionandfollow upcomments.table1showsthe details of our dataset.
.
extraction of performance concerns and api linking given the collected documentation we identify performance concernsatthesentencelevelbyfirstapplying spacy forsentence segmentation.
we then formulate a list of performance relatedkeywords based on literature and common knowledge.
the keywords include fast slow expensive cheap performance speedup computation accelerate intensive scalable efficient and their inflections e.g.
efficiency efficiently .1sentences containing these keywords are extracted as candidates that possibly discuss perfor mance concerns.
next we identify the subject apis that are being discussed in eachcandidatesentence aproblemoftenreferredtoas apitraceability .inthiswork weusedthe declaration based hyperlink based andmention based heuristics proposed in to establish links between natural language sentences and apis.
first sentences from an api s docstring are directly linked to this particular api i.e.
declaration based .second sentencesfromtheofficialuserguide and crowd documentation are linked to an api if they contain hyperlinkstothatapi sreferencepage i.e.
hyperlink based .third weleverageregularexpressionsandthehtmltag code toextract explicitcodementionsfromcandidatesentencesintheofficialuser guideandcrowddocumentation i.e.
mention based .notethata codementionmaycontainexpressionsorstatements.tofurther identify the exact api s referred to in a code mention we traverse itsabstractsyntaxtreetosearchfor callandattribute nodes.we then resolve each of these nodes to its fully qualified api names bymatchingitagainstapisofthesubjectlibrary whichisdeterminedbysotagsandtheidentifierofthereceiverobject.forexample for acodemention for row in df.iterrows w e first extract iterrows as a function call.
since the code mention 1inflection denotes different forms e.g.
noun adjective adverb of a word.is froman so threadtagged with pandasand theidentifier dfis a common abbreviationfor pandas.dataframe wefinally link it to thepandas.dataframe.iterrows api.
sentences that cannot be linked or resolved to any of our target apis are removed.
note that sentences containing both the performance related keywords and proper api links may not always address performanceconcerns.forexample thechoiceofddofisunlikelytoaffect modelperformance f r o mt h e sklearn.preprocessing.scale docstringdiscussestheperformanceofmachinelearningmodels e.g.
accuracy rather than runtime performance and memory consumption.thesentence convolvein1andin2usingthe fastfourier transformmethod fr om scipy.signal.fftconvolve isalsonot related to performance although it includes the keyword fast .
toeliminatesuchfalsepositives wemanuallyvalidatedwhether the automatically extracted candidates truly address api performanceconcerns seesection3.2fordetailsofthemanualvalidation .onlytruepositivesentenceswereconsideredasvalidperformancerelated documentation and used in subsequent analyses.
.
knowledge classification after identifying performance related documentation we first analyzed the different types of knowledge provided by such documentation.tothisend wereferredtotheworkofmaalejandrobillard whichproposedataxonomyof12knowledgetypesderivedfrom theapidocumentationofjavasdk6and.net4.
.whilethis taxonomyhasbeendevelopedtobemeaningfulandreliable itis unclearwhetheritcanbedirectlyappliedtoourtask.amajorconcern is that the taxonomy was originally proposed to characterize general api documentation whereas our goal is to characterize documentation specific to performance concerns.
toaddressthisissue weappliedthe inductivecoding method to better adapt the taxonomy to our performance specific data.
initially the first author used the original taxonomy to classify randomlyselectedperformance relatedsentences.as partofthis process the first author removed existing knowledge types that are no longer applicable and added new knowledge types emerged from our data.
the second author then repeated this process usingtheadjustedtaxonomy.thethirdauthorhelpedreconcilethedisagreementoncethefirsttwoauthorshaddifferentopinionsof thetaxonomy.thisprocesscontinueduntilthenewtaxonomywas fixed.
table shows the details of our new taxonomy which includes 11knowledgetypes.amongwhich sixaredirectlyreusedfrom and five are newly emerged from our data.
in particular we isolated the performance attributes knowledge type from the original quality attributes and internal aspects knowledge type.
we merged internal aspects with the original control flow and structure types to form the new implementation or internal aspects knowledge type.
we introduced the usage practice knowledgetype whichcombinestheoriginal patterns and code examples typessincebothdescribehowapisshouldbeusedin practice.wealsoaddedthe alternatives knowledgetypethatis observedexclusivelyfromourperformance specificdata.accordingly each performance related sentence was labeled with one or more knowledge types from this taxonomy.
897table taxonomy of knowledge types in performance related documentation.
knowledge type description example performance attributesdescribestheperformanceofanapi ortheperformanceimplicationsofdifferentargumentsor dataset.setting to false will improve the performance of this method.
pandas.dataframe.set index function ality behavior describes what the api does or does not do in terms of functionality or features.theseries.align method is the fastest way to simultaneously align two objects.
pandas.series.align implementationor internal aspectsexplains an api s internal implementation that is only indirectly related to its observable behavior....internallythisversionusesamuchfasterimplementationthatneverconstructstheindicesandusessimple slicing.
numpy.fill diagonal purpose rationale explainsthepurposeofprovidinganelementor the rationale of a certain design decision.thevectorize function is provided primarily for convenience not for performance.
numpy.vectorize alternatives describes a more less efficient alternative of an api orcompares theperformancebetweenalternative apis.mini batch sparse pca minibatchsparsepca is a variant of sparsepca that is faster but less accurate sklearn.decomposition.minibatchsparsepca usagepractice describes common usage scenarios for an api.
describesgood recommendedorbadapiusage practices.to construct a matrix efficiently make sure the items are pre sorted by index per row.
scipy.sparse.lil matrix concepts explains the meaning of terms used to name or describe an api element or describes design or domainconceptsusedorimplementedbytheapi.themain theoreticalresult behindthe efficiencyof random projection is the johnson lindenstrauss lemma.
sklearn.random projection directives specifies what users are allowed not allowedto do with the api element.
directives are clear contracts.we do require that your array be convertible to a numpy array even if this is relatively expensive.
pandas.api.extensions.extensionarray environment describes aspects related to the environment in which the api is used.these modes will have different performance profiles on different hardware and for different applications.
tensorflow.keras.layers.lstmcell