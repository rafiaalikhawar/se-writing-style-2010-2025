ls sampling an effective local search based sampling approach for achieving high t wise coverage chuan luo microsoft research beijing chinabinqi sun microsoft research beijing chinabo qiao microsoft research beijing chinajunjie chen tianjin university tianjin china hongyu zhang the university of newcastle callaghan australiajinkun lin institute of software chinese academy of sciences beijing chinaqingwei lin microsoft research beijing chinadongmei zhang microsoft research beijing china abstract there has been a rapidly increasing demand for developing highly configurable software systems which urgently calls for effective testing methods.
in practice t wise coverage has been widely recognized as a useful metric to evaluate the quality of a test suite for testing highly configurable software systems and achieving high t wise coverage is important for ensuring test adequacy.
however state of the art methods usually cost a fairly long time to generate large test suites for high pairwise coverage i.e.
wise coverage which would lead to ineffective and inefficient testing of highly configurable software systems.
in this paper we propose a novel local search based sampling approach dubbed ls sampling for achieving hight wise coverage.
extensive experiments on a large number of public benchmarks which are collected from real world highly configurable software systems show that ls sampling achieves higher wise and wise coverage than the current state of the art.ls sampling is effective since on average it achieves the 2wise coverage of .
and the wise coverage of .
through generating a small test suite consisting of only test cases smaller than the test suites generated by its state of the art competitors .
furthermore ls sampling is efficient since it only requires an average execution time of less than one minute to generate a test suite with high wise and wise coverage.
ccs concepts software and its engineering software testing and debugging search based software engineering .
keywords combinatorial interaction testing local search sampling chuan luo is the corresponding author email addresses chuan.luo microsoft.com chuanluophd outlook.com .
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse august athens greece copyright held by the owner author s .
publication rights licensed to acm.
acm isbn .
.
.
.
reference format chuan luo binqi sun bo qiao junjie chen hongyu zhang jinkun lin qingwei lin and dongmei zhang.
.
ls sampling an effective local search based sampling approach for achieving high t wise coverage.
in proceedings of the 29th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse august athens greece.
acm new york ny usa pages.
introduction highly configurable software systems play critical roles in many real world applications .
such highly configurable systems usually expose many configuration options which can be controlled by users to customize the systems .
however testing highly configurable systems is challenging since it is impractical to test all possible configurations.
in practice the number of possible configurations increases exponentially with the rise of the number of options but only a small subset of configurations would cause systems to fail .
for instance given a configurable system containing options where each option has possible values the number of total possible configurations for that system is more than one trillion i.e.
in the worst case.
combinatorial interaction testing cit is a practical dominant testing paradigm for detecting option interaction faults in highly configurable systems .
given a configurable system the primary goal of cit is to generate a small test suite to achieve high interaction coverage .
at wise option combination is an option combination of toptions and t wise coverage which aims to achieve high interaction coverage of all t wise option combinations has been broadly recognized as a useful metric to evaluate the quality of a test suite for testing configurable systems .
in classical cit various approaches e.g.
have been proposed to build test suites with fullt wise coverage i.e.
all possible valid t wise option combinations in the entire configuration space are covered .
however in practice achieving full t wise coverage is difficult or even infeasible when a configurable system has a large number of configuration options .
also it is acknowledged that for highly configurable systems test suites with full t wise coverage are usually large and using such test suites would exceed the testing budget .
hence for testing highly configurable systems compared to classical approaches that focus on achieving full t wise coverage an esec fse august athens greece chuan luo binqi sun bo qiao junjie chen hongyu zhang jinkun lin qingwei lin and dongmei zhang advisable solution is to solve the t wise coverage maximum t wise covmax problem which aims to generate a fixed sized test suite that maximizes t wise coverage .
for configurable systems there usually exist hard constraints mutual dependencies and exclusiveness among different configuration options.
for the sake of the accuracy and the efficiency of the testing procedures these hard constraints must be satisfied when generating test suites which makes thet wise covmax problem more complex.
effectively solving thet wise covmax problem is challenging from the practical perspective.
in practice achieving high t wise coverage is difficult when the value of tis large or when the option combination space is large .
also extensive empirical studies on many systems indicate that cit with high wise coverage can detect around faults and cit with high wise coverage is able to reveal around faults.
actually recent works focus on solving the wise covmax problem .
in cit uniform sampling has been recognized as a dominant domain agnostic method for testing highly configurable systems .
previous studies show that uniform sampling exhibits its effectiveness in solving the t wise covmax problem .
uniform sampling tries to sample each valid configuration with equal probability and has been utilized to test highly configurable systems .
however uniform sampling suffers from a severe issue that it cannot well handle configurable systems with complex constraints .
due to the existence of complex inter option constraints option combinations are not uniformly distributed among the configurations.
for example a number of option combinations can appear in millions of configurations while some option combinations can only appear in tens .
this phenomenon hinders uniform sampling from achieving high t wise coverage.
an empirical study shows that for a configurable system uniform sampling can only achieve the wise coverage less than after generating 107test cases.
besides uniform sampling baranov et al.
proposed an adaptive weighted sampling approach called baital which is the current state of the art approach for solving the t wise covmax problem.
as discussed before the t wise covmax problem is a typical combinatorial optimization problem and effectively solving combinatorial optimization problems requires to directly optimize the optimization objective .
however baital does not optimize the objective of the t wise covmax problem explicitly during its sampling process which would make baital ineffective.
moreover baital handles hard constraints through knowledge compilation techniques but the costly process of knowledge compilation would make baital inefficient.
in fact our experiments section also confirm the ineffectiveness and the inefficiency of baital .
our experiments present that baital has to generate a large test suite consisting of test cases to achieve the average wise coverage of .
and the average wise coverage of .
while a relatively small test suite consisting of test cases generated by baital can only obtain the average wise coverage of .
and the average wise coverage of .
.
however the capability of generating a small test suite is important since manually configuring and testing real world highly configurable systems through a large test suite can be very expensive.
our experiments also show that using baital for test suite generation is time consuming.
for instance the average execution time required by baital to generate1 test cases is .
seconds.
however for those projects that adopt agile software development rapid generation of highquality test cases is important which urgently calls for efficient and effective test suite generation methods.
in this work we propose a novel approach dubbed ls sampling local search based sampling for achieving high t wise coverage.
compared to state of the art approaches which do not optimize the optimization objective explicitly during its sampling process ls sampling is designed on top of an effective local search framework whose search process is directly guided by the optimization objective.
actually local search has exhibited its effectiveness in solving various combinatorial optimization problems e.g.
.
during the local search process lssampling constructs the test suite in an iterative manner in each iteration a candidate set of valid test cases is first sampled from the entire configuration space and then from that candidate set a valid test case that optimizes the objective most is selected.
also lssampling adopts a new dynamic mechanism for updating sampling probabilities to enhance its local search process.
furthermore different from state of the art approaches ls sampling incorporates a novel diversity aware heuristic search algorithm to handle hard constraints more efficiently.
in addition before the local search process ls sampling employs powerful formula simplification techniques to equivalently simplify hard constraints which would make our approach more efficient and effective.
through extensive experiments ls sampling achieves much highert wise coverage than uniform sampling and baital .
our experiments are conducted on a large number of public benchmarks collected from real world highly configurable systems.
our experiments demonstrate that ls sampling is effective since on average it can achieve the wise coverage of .
and the wise coverage of .
through generating a small test suite consisting of only test cases both of which are higher than the average wise and wise coverage achieved by the test suites consisting of test cases generated by state of the art approaches.
also ls sampling is efficient since it only requires the average execution time less than one minute to generate a test suite with high wise and wise coverage.
we summarize our major contributions of this work as follows.
we propose a novel approach dubbed ls sampling which is designed on top of an effective local search framework for achieving high t wise coverage.
our ls sampling approach leverages a number of core algorithmic mechanisms including formula simplification dynamic mechanism for updating sampling probabilities and diversity aware heuristic search to enhance its both effectiveness and efficiency.
we perform extensive experiments indicating that our lssampling approach can achieve higher wise and wise coverage through generating much smaller test suites than current state of the art approaches.
also ls sampling requires much less execution time to achieve considerably higher wise and wise coverage compared to baital .
furthermore our experimental results demonstrate the effectiveness of each core algorithmic mechanism underlying our ls sampling approach.
1082ls sampling an effective local search based sampling approach for achieving high t wise coverage esec fse august athens greece preliminaries in this section we introduce cit and also formally describe the t wise covmax problem.
.
combinatorial interaction testing here we introduce necessary notations related to cit as follows.
system under test sut an sut is a pair t p h wherep denotes a set of options and hdenotes a set of hard constraints on the permissible combinations of values of the options in p. following the recent study of t wise coverage without loss of generality this work focuses on the scenario where each option takes binary values so in this work each option pi ptakes binary values .
the general scenario where each option takes multiple discrete values can be transformed to the binary scenario and the benchmarks adopted in this work are all collected from the general scenario.
also the configurations of an sut can be expressed as a boolean formula .
option combination given an sut t p h the definition of the option combination also known as tuple is a set of pairs i.e.
pi1 vi1 pi2 vi2 pit vit wherepij pandvij indicating that option pijtakes value vij.
specifically an option combination of size tis calledt wise option combination.
test case given an sut t p h a test case also known as configuration is an option combination that covers all options in p. that is a test case is a complete assignment to p. in practice the assignment to the options of a configurable system cannot violate hard constraints.
testing configurable systems with invalid test cases i.e.
violating at least one hard constraint would waste much testing time so it is critical to ensure that all generated test cases are valid.
given an sut t p h an option combination or a test case is valid if it satisfies all hard constraints inh.
also an option combination iscovered by a test case if which means that each option in takes the same value as the one in .
.
thet wise coverage maximum problem in this subsection we first introduce boolean formulae and then describe the t wise coverage maximum problem.
given a set of nboolean variable si.e.
x1 x2 xn aliteral is a boolean variable xi or its negation xi and a clause is a disjunction of literals.
a boolean formulafin conjunctive normal form cnf is a conjunction of mclauses i.e.
f c1 c2 cm.
given a formula fin cnf v f denotes the set of boolean variables inf and c f denotes the set of clauses in f. a mapping v f is called an assignment off.
given an assignment each clause has two possible states satisfied orunsatisfied a clause is satisfied if at least one literal in that clause evaluates to true under otherwise that clause is unsatisfied.
a satisfying assignment or solution offis an assignment that satisfies all clauses in f. an sut can be represented as a boolean formula in cnf .
given an sut t p h and its corresponding boolean formula fin cnf t s option set pdirectly corresponds tof s boolean variable set v f wheren v f p t s hard constraint set hcan be encoded into a set of clauses c f .
furthermore a valid test case oftis actually a satisfying assignment off.
atest suite is a set of valid test cases.given a valid test case we use the notation comb t to denote the set of all valid t wise option combinations covered by .
given a test suite a we can extend the notation comb and use comb a t to denote the set of all valid t wise option combinations covered bya i.e.
comb a t acomb t .
we note that for a single valid test case comb t p t however this does not imply comb a t a p t since given two different valid test cases 1and 2 comb 1 t comb 2 t is not necessarily equal to comb 1 t comb 2 t .
actually in practice there are intersections among the sets of valid t wise option combinations covered by different test cases .
given an sut tand a test suite a thet wise coverage of ais calculated as the ratio between the number of valid t wise option combinations covered by a i.e.
comb a t and the total number of all possible valid t wise option combinations during the entire configuration space of t. given an sut tand its corresponding boolean formula f we use s f to denote the set of all satisfying assignments of f which can also represent the set of all valid test cases for t. hence the t wise coverage of acan be formally described as cov a t comb a t comb s f t .
in practice for testing an sut the number of test cases is proportional to the time required by the entire testing process so it is critical to generate relatively small test suite with high t wise coverage.
to this end this work studies the t wise coverage maximum t wise covmax problem aiming to generate a test suite consisting of a fixed number of test cases such that the t wise coverage is maximized.
the t wise covmax problem is formally described as follows given an sut t t s corresponding boolean formula f size of option combination t allowed number of valid test cases k thet wise covmax problem is to find a test suite asuch that a arg max a s f a kcov a t given an sut tandt s corresponding boolean formula f maximizing cov a t is equivalent to maximizing comb a t since the denominator i.e.
comb s f t can be regarded as a constant.
hence thet wise covmax problem can be expressed as follows a arg max a s f a k comb a t actually the t wise covmax problem is a challenging combinatorial optimization problem which calls for a practical solution.
the ls sampling approach this section proposes ls sampling local search based sampling a novel approach for achieving high t wise coverage.
we first introduce the top level design of ls sampling which is an effective local search framework for solving the t wise covmax problem.
then we present the core algorithmic mechanisms underlying ls sampling .
.
top level design of ls sampling as introduced before the t wise covmax problem is a combinatorial optimization problem .
since local search has exhibited its effectiveness in a variety of combinatorial optimization problems e.g.
we are devoted to proposing a novel local search based sampling approach for solving the t wise covmax problem.
1083esec fse august athens greece chuan luo binqi sun bo qiao junjie chen hongyu zhang jinkun lin qingwei lin and dongmei zhang algorithm top level design of ls sampling input f boolean formula k allowed number of valid test cases output a the set of generated valid test cases 1f simplifyfthrough a simplification tool 2a 3initialize prob xi as .
for each boolean variable xiinf 4foriter 1tokdo 5 picktestcase f prob a 6a a foreachxi v f do prob xi updateprob xi a 9returna here we present and describe the top level design of ls sampling a local search framework that forms the core of ls sampling .
the top level design of ls sampling is outlined in algorithm and needs two inputs the boolean formula encoded from the target sut denoted by f the allowed number of valid test cases for the target sut denoted by k. the output of our ls sampling approach is a test suite denoted by a. as demonstrated in algorithm our ls sampling approach is comprised of two essential phases initialization phase and local search phase.
in the initialization phase necessary initialization steps are performed and the given boolean formula is equivalently simplified lines in algorithm .
in the local search phase ls sampling constructs the test suite ain an iterative manner until a k lines in algorithm .
once the local search phase is terminated ais output as the generated test suite line in algorithm .
.
initialization phase given a boolean formula f the approaches for solving the t wise covmax problem aim to identify a set of satisfying assignments i.e.
valid test cases for fthat maximizes t wise coverage.
existing state of the art approaches for solving the t wise covmax problem including uniform sampling and baital directly sample the satisfying assignments for the original formula f. however finding satisfying assignments for a boolean formula is challenging in theory even seeking one satisfying assignment for a boolean formula which is also known as boolean satisfiability sat solving in the research community of sat is np hard due to the complex hard constraints .
it is recognized that simplifying boolean formulae can considerably reduce the number of hard constraints and extensive empirical studies e.g.
show that simplifying boolean formulae can significantly improve the effectiveness of seeking satisfying assignments.
hence it is advisable to equip ls sampling with formula simplification techniques.
in the context of sat solving the primary goal is to find only one satisfying assignment for the given formula so the widely used simplification tools are designed to incorporate satisfiability preserving techniques which do not change the satisfiability status of the original formula fbut alter the set of all satisfying assignments i.e.
s f .
however as discussed in section .
such satisfiabilitypreserving techniques are not applicable to solving the t wise covmax problem which aims to find a subset of s f that maximizes thet wise coverage.
hence the core problem in the initialization phase is how to identify an effective formula simplification tool that is suitable in our scenario.
for solving the t wise covmax problem equivalencepreserving techniques are required which can considerably reduce the number of constraints and meanwhile guarantee that the simplified and the original formulae are equivalent.
among existing simplification tools we adopt coprocessor since it is publicly available1and integrates a number of effective equivalence preserving techniques e.g.
hidden tautology elimination probing asymmetric branching and extended resolution .
in the initialization phase ls sampling first simplifies the given formulaf resulting in the simplified formula f through the formula simplification tool coprocessor with the hyper parameter setting that only activates equivalence preserving techniques and switches off all satisfiability preserving techniques.
after that lssampling initializes the set of valid test cases aas empty set and initializes the sampling probability for each boolean variable appearing inf which is an important concept in the local search phase and will be introduced in detail in section .
.
.
local search phase once the initialization phase is finished ls sampling steps into the local search phase.
in the local search phase ls sampling works in an iterative manner to construct a test suite a lines in algorithm in each iteration ls sampling first selects a valid test case from the set of all satisfying assignments of the simplified formulaf i.e.
s f through the picktestcase component then lssampling adds intoa at the end of each iteration ls sampling adaptively updates each boolean variable s sampling probability through the updateprob component a novel dynamic mechanism for updating sampling probabilities.
the iteration process would be terminated once there are kvalid test cases in a. here we define each variable xi s sampling probability denoted byprob xi as follows.
definition .
.
given a boolean formula f for each boolean variablexi v f prob xi denotes the sampling probability associated with xi representing the probability that the value of boolean variable xiis sampled as .
that is to say the probability that the value of boolean variable xiis sampled as 0can be calculated as prob xi .
we note that each variable s sampling probability would be dynamically updated during the iterative search process.
from algorithm it is apparent that the picktestcase component line in algorithm and the updateprob component line in algorithm are crucial.
we will present the picktestcase component as follows and will describe the updateprob component in section .
.
.
2for the first iteration all variables sampling probabilities are initialized as .
which is equivalent to uniform sampling line in algorithm .
1084ls sampling an effective local search based sampling approach for achieving high t wise coverage esec fse august athens greece algorithm the picktestcase component input f simplified boolean formula prob vector of all variables sampling probabilities a current set of valid test cases output the selected valid test cases 1c 2forj 1to do 3 j generate a test case by sampling the value of each variablexiaccording to prob xi 4 j dahs f j prob 5c j calculate score j for the valid test case j 7 the valid test case in cwith the largest score 8return thepicktestcase component works in a greedy manner and the primary goal of the picktestcase component is to select a valid test case whose addition into amaximizes the t wise coverage of a from s f .
however there are two challenges in this component i.e.
metric challenge and scale challenge as described as follows metric challenge given a set of different valid test cases c it is critical to design a metric that can effectively quantify the benefit of each valid test case cwith regard to aif is added into a. scale challenge in practice the cardinality of s f would be extremely large and s f grows exponentially with the rise of the number of variables in f .
therefore it is infeasible to traverse the entire set s f and select one satisfying assignment from s f due to the scale challenge.
in order to address the metric challenge we design a scoring function score to reflect the benefit of each valid test case over a. definition .
.
given a valid test case and a test suite a score denotes the increment of the number of covered t wise option combinations if is added into a i.e.
score comb a t comb t comb a t .
according to definition .
our scoring function can directly quantify each valid test case s unique contribution to the optimization objective of the t wise covmax problem equation .
given a valid test case the computational complexity for calculating comb t iso n t wherenrepresents the number of variables.
it is obvious that calculating score with large value of tis time consuming.
therefore it is important to propose an alternative scoring function that can be calculated efficiently.
it is recognized that given a test suite a ifacould achieve high wise coverage then awould also obtain high t wise coverage with t and the empirical evidences can be witnessed in an empirical study and our experiments in section .
thus in ls sampling score is implemented as score comb a comb comb a so its computational complexity is just o n2 which in turn makes the process of calculating score much more efficient.
we note that through such efficient implementation of score the test suite generation process ofls sampling is independent of the value of t. thus given an sut algorithm the updateprob component input xi boolean variable a current set of valid test cases output prob xi updated sampling probability for xi 1b the set of all xi false test cases in a 2prob xi b a 3return prob xi the final test suite generated by ls sampling remains the same for solving thet wise covmax problem on that sut even with different values oft.
here we switch to introduce how to address the scale challenge.
ls sampling first tries to sample a candidate set of valid test casesc s f and then select a valid test case with the largest score fromc.
through this way in each iteration ls sampling only needs to traverse the candidate set cconsisting of valid test cases rather than traversing the entire set s f .
hence this practical method effectively alleviates the scale challenge.
we note that is a hyper parameter of ls sampling which controls the trade off between the effectiveness and the efficiency of ls sampling and makes our ls sampling approach flexible if is set to a relatively large integer then ls sampling would achieve higher t wise coverage but requires longer execution time otherwise ls sampling would run faster with a relatively lower t wise coverage.
the effect of hyper parameter will be analyzed in section .
.
the picktestcase component is outlined in algorithm .
the picktestcase component generates the candidate set cconsisting of valid test cases one by one.
when generating j th valid test case picktestcase first generates a test case jby sampling the value of each boolean variable xiaccording to its sampling probability prob xi .
recalling that there are hard constraints with regard to formulaf since jis sampled without considering such hard constraints jwould possibly be invalid.
to address this issue we propose diversity aware heuristic search dahs a novel algorithm that conducts heuristic search to modify j resulting in a valid test case j our dahs algorithm will be presented in section .
.
.
once the candidate set cis constructed the picktestcase component returns the valid test case cwith the largest score .
different from baital the local search process of ls sampling is explicitly guided by the optimization objective of the t wise covmax problem since our proposed metric score utilized in the picktestcase component can reflect each valid test case s unique contribution to the optimization objective.
.
.
dynamic mechanism for updating sampling probabilities.
as presented in section .
the value of each variable s sampling probability directly impacts the quality of the valid test case selected bypicktestcase .
actually picktestcase aims to select a valid test case whose addition into amaximizes the t wise coverage of a .
hence the test cases in aneeds to be diversified so there is a requirement of diversification when generating test cases.
for solving the t wise covmax problem uniform sampling as a dominant domain agnostic method adopts a simple static mechanism to decide the values of those sampling probabilities i.e.
setting 3actually ls sampling is a randomized approach.
this conclusion holds when the random seed for ls sampling is fixed.
1085esec fse august athens greece chuan luo binqi sun bo qiao junjie chen hongyu zhang jinkun lin qingwei lin and dongmei zhang algorithm the dahs algorithm input f simplified boolean formula the input possibly invalid test case prob vector of all variables sampling probabilities output the modified valid test case 1 2while is invalid do ifdv then 4x the variable with the largest gain indv breaking ties by preferring the variable with the largest priority else 6c a random unsatisfied clause 7x the variable with the largest priority inc 8 withx flipped 9return each boolean variable s sampling probability to .
such that the value of each boolean variable is sampled uniformly at random.
however the static mechanism utilized by uniform sampling keeps all the sampling probabilities as fixed values during the entire process of test suite generation so it neither considers the current status ofanor reflects the requirement of diversification when generating test cases.
to meet the requirement of diversification an advisable method is to dynamically update each boolean variable s sampling probability according to the test cases in aso far.
to this end we propose a novel dynamic mechanism for updating sampling probabilities.
given a boolean variable xi a test case is defined as xi false test case ifxi s value under is0 and a test case is defined as xi true test case if xi s value under is1.
according to definition .
given a variable xi prob xi is the probability that xi s value is sampled as .
considering the current status of a it is advisable to updatexi s sampling probability as the ratio between the number ofxi false test cases in aand the number of all test cases in a. the procedures of our proposed dynamic mechanism for updating sampling probabilities are outlined in algorithm .
.
.
diversity aware heuristic search.
as discussed in section .
directly sampling test cases according to sampling probabilities prob would possibly result in invalid test cases due to hard constraints with regard to f .
hence given an invalid test case it is important to design an effective method to modify and convert it to a valid test case .
actually heuristic search based sat algorithms e.g.
repeatedly modifies the input assignment through flipping the truth value of a single boolean variable until a satisfying assignment is reached.
since a test case is an assignment regarding the input formula f as previously discussed in section thus in our scenario a simple idea is to adopt an existing heuristic search based sat algorithm in ls sampling to process the possibly invalid test case .
however existing heuristic search based sat algorithms focus on finding a satisfying assignment fast but does not consider the requirement of diversification during its assignment modification process.
as discussed in section .
.
ignoring the requirement of diversification would make those test cases in aless diversified and thus hinders the t wise coverage of afrom being maximized so inour opinion this is a severe issue when directly applying existing heuristic search based sat algorithms in our scenario.
in order to address this issue we propose a novel diversity aware heuristic search dahs algorithm.
as discussed in section .
.
sampling probabilities can effectively reflect the requirement of diversification.
hence different from existing heuristic search based sat algorithms our dahs algorithm innovatively makes the use of sampling probabilities during its modification process and thus is capable of being aware of diversity.
before presenting our dahs algorithm we formally define two crucial metrics to select flipping variables i.e.
gain andpriority .
definition .
.
given a boolean variable xi the gain ofxi denoted by gain xi is the decrement in the number of unsatisfied clauses by flipping the current truth value of xi.
we note that a variable s gain could be negative since it is possible that flipping a variable might result in more unsatisfied clauses.
for a variable xi xiis adecreasing variable ifgain xi .
also we use notation dvto denote the current set of all decreasing variables.
dahs prefers to flip decreasing variables since flipping decreasing variables would reduce more unsatisfied clauses.
definition .
.
given a boolean variable xiandxi s current truth valuevi the priority ofxi denoted by priority xi is calculated as vi prob xi vi prob xi .
according to definition .
if variable xi s current truth value viis0 then priority xi becomes prob xi otherwise if viis1 priority xi is calculated as prob xi .
our priority metric is designed based on sampling probability and thus utilizing priority to select flipping variables can make dahs be aware of diversity.
to this end dahs prefers to flip such variables with large priority .
our dahs algorithm is presented in algorithm .
given a possibly invalid test case dahs repeatedly selects a variable x and flips the truth value of x until a valid test case is reached.
for dahs when selecting a flipping variable x if the set of decreasing variables dvis not empty then the variable with the largest gain indvis selected as the flipping variable x breaking ties by preferring the variable with the largest priority otherwise the variable with the largest priority in a random unsatisfied clause is selected as the flipping variable x .
through this way dahs can return a valid test case and meanwhile can better reflect the requirement of diversification than existing heuristic search based sat algorithms.
experimental design in this section we describe the experimental design of this work.
particularly we first introduce the benchmarks adopted in our experiments.
then we describe the state of the art competitors of ls sampling .
after that we present the research questions of this work.
finally we describe the experimental setup.
.
benchmarks in order to study the practical performance of ls sampling in our experiments we adopt a benchmark set consisting of public benchmarks.
all benchmarks adopted in our experiments are originally collected by baranov et al.
.
also each benchmark is collected from a real world configurable system and is expressed as a boolean formula in cnf.
those benchmarks have been well 1086ls sampling an effective local search based sampling approach for achieving high t wise coverage esec fse august athens greece table results of wise coverage achieved by ls sampling uniform sampling and baital on representative benchmarks.
benchmark totalocuniform k baital k baital k ls sampling k ls sampling k oc cov oc cov oc cov oc cov oc cov busybox 1 28 0 .
.
.
.
.
.
.
.
.
.
csb281 .
.
.
.
.
.
.
.
.
.
dreamcast .
.
.
.
.
.
.
.
.
.
ebsa285 .
.
.
.
.
.
.
.
.
.
ecos icse11 .
.
.
.
.
.
.
.
.
.
financial .
.
.
.
.
.
.
.
.
.
freebsd icse11 .
.
.
.
.
.
.
.
.
.
hs7729pci .
.
.
.
.
.
.
.
.
.
integrator arm9 .
.
.
.
.
.
.
.
.
.
linux .
.
.
.
.
.
.
.
.
.
mpc50 .
.
.
.
.
.
.
.
.
.
ocelot .
.
.
.
.
.
.
.
.
.
olpce2294 .
.
.
.
.
.
.
.
.
.
olpcl2294 .
.
.
.
.
.
.
.
.
.
pati .
.
.
.
.
.
.
.
.
.
pc i82544 .
.
.
.
.
.
.
.
.
.
phycore .
.
.
.
.
.
.
.
.
.
refidt334 .
.
.
.
.
.
.
.
.
.
vrc4373 .
.
.
.
.
.
.
.
.
.
xsengine .
.
.
.
.
.
.
.
.
.
studied in literature .
for all benchmarks in our benchmark set the number of boolean variables ranges from to and the number of clauses varies from to .
all benchmarks used in our experiments are available online.
.
competitors in our experiments ls sampling is compared against two state ofthe art competitors i.e.
uniform sampling and baital .
uniform sampling has been recognized as a dominant domainagnostic method to achieve high t wise coverage and it is capable of generating test suites for highly configurable systems .
in our experiments we adopt the same implementation of uniform sampling as the one evaluated in the literature .
baital is a recently proposed adaptive weighted sampling approach which is the current state of the art approach for solving thet wise covmax problem .
as reported in the literature baital achieves higher wise coverage than uniform sampling.
we note that the implementations of both uniform sampling and baital are available online.
.
research questions to evaluate the effectiveness of ls sampling we aim to answer the following research questions rqs .
in practice t wise coverage has been widely recognized as a critical metric to evaluate the quality of a test suite for testing highly configurable systems .
since achieving high t wise coverage can be difficult for large values of t the practitioners mainly generate test suites with high wise or wise coverage when testing configurable systems .
hence in our experiments we focus on advancing the current state of the art in achieving high wise coverage and high wise coverage.
can ls sampling achieve higher wise coverage than its state of the art competitors i.e.
uniform sampling and baital ?
in this rq ls sampling is compared against two state of the art competitors i.e.
uniform sampling and baital for solving the wise covmax problem.
rq2 can ls sampling achieve higher wise coverage than its state of the art competitors i.e.
uniform sampling and baital ?
empirical studies on many real world configurable systems present that test suites with high wise coverage and with high wise coverage can detect around faults and faults respectively indicating that achieving high wise coverage is important and is complementary with achieving high wise coverage.
in this rq ls sampling is compared against uniform sampling and baital for solving the wise covmax problem.
rq3 how efficient is ls sampling to generate a test suite with high wise and wise coverage?
in this rq we evaluate the execution time of ls sampling to generate a test suite with high wise and wise coverage.
rq4 how effective is each core algorithmic mechanism underlying ls sampling ?
in this rq we study the effectiveness of ls sampling s core algorithmic mechanisms including formula simplification section .
dynamic mechanism for updating sampling probabilities section .
.
and diversity aware heuristic search section .
.
.
rq5 how does the hyper parameter setting affect the performance of ls sampling ?
in this rq we analyze how the setting of hyper parameter in algorithm affects the performance of ls sampling .
.
experimental setup all experiments in this work were conducted on a workstation equipped with intel xeon e5 cpu and gb memory running gnu linux.
since ls sampling and its two competitors i.e.
uniform sampling and baital are all randomized approaches we 1087esec fse august athens greece chuan luo binqi sun bo qiao junjie chen hongyu zhang jinkun lin qingwei lin and dongmei zhang table results of wise coverage achieved by ls sampling andbaital on representative benchmarks.
benchmark totalocbaital k baital k ls sampling k ls sampling k oc cov oc cov oc cov oc cov busybox 1 28 0 .
.
.
.
.
.
.
.
csb281 .
.
.
.
.
.
.
.
dreamcast .
.
.
.
.
.
.
.
ebsa285 .
.
.
.
.
.
.
.
ecos icse11 .
.
.
.
.
.
.
.
financial .
.
.
.
.
.
.
.
freebsd icse11 .
.
.
.
.
.
.
.
hs7729pci .
.
.
.
.
.
.
.
integrator arm9 .
.
.
.
.
.
.
.
linux .
.
.
.
.
.
.
.
mpc50 .
.
.
.
.
.
.
.
ocelot .
.
.
.
.
.
.
.
olpce2294 .
.
.
.
.
.
.
.
olpcl2294 .
.
.
.
.
.
.
.
pati .
.
.
.
.
.
.
.
pc i82544 .
.
.
.
.
.
.
.
phycore .
.
.
.
.
.
.
.
refidt334 .
.
.
.
.
.
.
.
vrc4373 .
.
.
.
.
.
.
.
xsengine .
.
.
.
.
.
.
.
performed independent runs per benchmark for each approach.
for solving the t wise covmax problem with t 2andt the allowed number of valid test cases kis set to following the experimental setup of the most recent study .
besides we also conduct experiments to compare ls sampling against its competitors on solving the wise and wise covmax problems with k to show that ls sampling can achieve both high wise and wise coverage through generating much smaller test suites.
in our experiments for ls sampling is set to .
we note that the impact of different hyper parameter settings of is studied in section .
.
for uniform sampling we adopt its implementation as the same one used in the literature .
for baital it is evaluated using the default configuration recommended by its authors .
when solving the t wise covmax problem with t andt for each approach on each benchmark we report the average number oft wise option combinations covered by the generated test suite over runs denoted by oc as well as the average t wise coverage achieved by the generated test suite over runs denoted by cov in tables and .
furthermore we also summarize the averaget wise coverage over all benchmarks in tables and .
in our experiments for each benchmark or benchmark set we use boldface to indicate the best results with regard to oc and cov within the comparisons.
besides for each benchmark we also list the total number of possible valid t wise option combinations in the entire configuration space denoted by totaloc for reference.
to save space in tables and figure we use uniform to denote uniform sampling.
in addition to demonstrate the efficiency of ls sampling we present the average execution time over all benchmarks denoted by time in tables and .
as discussed in section .
given a benchmark the final test suite generated by ls sampling with the fixed random seed is the same for solving the t wise covmax problem regardless of the value of t. similarly according to the literature uniform sampling and baital with fixed randomseeds would also generate the same test suite for solving the t wise covmax problem on the given benchmark regardless of the values oft.
hence on the same benchmark set the average execution time required by each of ls sampling uniform sampling and baital for solving the wise covmax problem is the same as that for solving the wise covmax problem respectively.
moreover in tables and regarding the metrics of oc and cov for each benchmark we individually compare the performance of ls sampling against that of each competitor we conduct wilcoxon signed rank tests to check the statistical significance of the results and calculate the vargha delaney effect sizes for each pairwise comparison between ls sampling and each of its competitors.
for each benchmark if all the p values of wilcoxon signed rank tests at confidence level are smaller than .
and the vargha delaney effect sizes for all pairwise comparisons are larger than .
indicating large effect sizes we consider the performance improvement of ls sampling over all its competitors statistically significant and meaningful and mark these results with underline .
in addition in tables and for each benchmark set we conduct the similar process to examine whether the improvement of ls sampling ont wise coverage over all its competitors statistically significant and meaningful and mark the results of ls sampling with underline if this is the case.
experimental results in this section we first report the experimental results and then we discuss the threats to validity.
.
rq1 comparison on wise coverage the results of the wise coverage achieved by ls sampling uniform sampling and baital on selected benchmarks are demonstrated in table .
for those selected benchmarks of them are identified as representative ones by baranov et al.
and the other benchmarks are selected randomly.
to save space table does not report 1088ls sampling an effective local search based sampling approach for achieving high t wise coverage esec fse august athens greece table average wise coverage and average wise coverage achieved by ls sampling uniform sampling and baital on all benchmarks.
uniform baital ls sampling cov cov cov wise k .
.
.
wise k .
.
.
wise k .
.
.
wise k .
.
.
table average execution time required by ls sampling uniform sampling and baital for test suite generation on all benchmarks.
uniform baital ls sampling time k .
sec .
sec .
sec time k .
sec .
sec .
sec the wise coverage achieved by uniform sampling with k on those representative benchmarks.
actually the wise coverage achieved by uniform sampling with k 100is considerably lower than that achieved by other competing approaches.
the full results of the wise coverage achieved by all competing approaches with bothk andk on all benchmarks are available online.
also table summarizes the average wise coverage achieved by ls sampling uniform sampling and baital on all benchmarks.
from tables and for both scenarios under k andk ls sampling achieves considerably higher wise coverage than uniform sampling and baital .
also from table ls sampling with k achieves the average wise coverage of .
on all benchmarks while the existing state of the art approach baital with k andk obtains the average wise coverage of .
and .
respectively indicating that our ls sampling approach achieves higher wise coverage through generating much smaller test suites than the current state of the art.
.
rq2 comparison on wise coverage table reports the results of the wise coverage achieved by lssampling and baital on representative benchmarks.
to save space table does not report the wise coverage achieved by uniform sampling on those representative benchmarks.
in fact uniform sampling obtains much lower wise coverage than lssampling andbaital .
the full results of the wise coverage achieved by all competing approaches including uniform sampling on all benchmarks are available online4.
also the average wise coverage achieved by ls sampling uniform sampling and baital on all benchmarks are presented in table .
from tables and for both scenarios under k andk the wise coverage achieved by ls sampling is much higher than that achieved by uniform sampling and baital .
more encouragingly from table ls sampling withk achieves the average wise coverage of .
on all benchmarks while that figure for baital withk is .
.
also the average wise coverage achieved bybaital withk is only .
which is significantly worse than that achieved by ls sampling withk .
the results clearly demonstrates that ls sampling obtains considerably higher wise k3 wise coverage ls sampling baital uniformfigure wise coverage achieved by ls sampling uniform sampling and baital on benchmark financial .
coverage through generating much smaller test suites than the current state of the art.
furthermore we illustrate the wise coverage achieved by lssampling uniform sampling and baital withkup to for the financial benchmark in figure .
the financial benchmark is particularly interesting and has been well studied in previous studies since both uniform sampling and baital do not achieve high wise and wise coverage even with large test suites .
according to figure ls sampling achieves consistently higher wise coverage than uniform sampling and baital in various scenarios under different values of k confirming the effectiveness of ls sampling for achieving high wise coverage.
.
rq3 comparison on efficiency to study the efficiency of ls sampling we present the average execution time required by ls sampling uniform sampling and baital for test suite generation on all benchmarks in table .
for the scenario under k ls sampling requires the average time of .
seconds which is faster than uniform sampling .
seconds andbaital .
seconds .
for the scenario under k the average execution time required by ls sampling uniform sampling andbaital is .
.
and .
seconds respectively.
the results in tables and indicate that ls sampling withk is both efficient and effective since it requires much less execution time but achieves considerably higher wise and wise coverage compared to baital .
.
rq4 effects of algorithmic mechanisms there are core algorithmic mechanisms underlying ls sampling including formula simplification section .
dynamic mechanism for updating sampling probabilities section .
.
and diversityaware heuristic search section .
.
.
to evaluate the effectiveness of each algorithmic mechanism we modify ls sampling by removing each of formula simplification dynamic mechanism for updating sampling probabilities and diversity aware heuristic search resulting in three alternative versions of ls sampling dubbed lssampling alt1 ls sampling alt2 ls sampling alt3 respectively.
table summarizes the average wise coverage and the average wise coverage achieved by ls sampling and its three alternative versions on all benchmarks.
table reports the average execution time required by ls sampling and its three alternative versions 1089esec fse august athens greece chuan luo binqi sun bo qiao junjie chen hongyu zhang jinkun lin qingwei lin and dongmei zhang table average wise coverage and average wise coverage achieved by ls sampling and its three alternative versions on all benchmarks.
alt1 alt2 alt3 ls sampling cov cov cov cov wise k .
.
.
.
wise k .
.
.
.
wise k .
.
.
.
wise k .
.
.
.
table average execution time required by ls sampling and its three alternative versions for test suite generation on all benchmarks.
alt1 alt2 alt3 ls sampling time k .
sec .
sec .
sec .
sec time k .
sec .
sec .
sec .
sec on all benchmarks.
to save space in tables and we use alt1 alt2 and alt3 to represent ls sampling alt1 ls sampling alt2 and ls sampling alt3 respectively.
according to tables and ls sampling is able to achieve both higher wise and wise coverage than all its alternative versions.
also ls sampling runs faster than all its alternative versions.
hence the results in tables and indicate the effectiveness of each core algorithmic mechanism underlying ls sampling .
furthermore from tables and each alternative version of ls sampling achieves both higher wise and wise coverage through generating much smaller test suites than uniform sampling and baital indicating the effectiveness of the local search framework of ls sampling .
.
rq5 effect of hyper parameter setting table reports the average wise coverage and the average wise coverage achieved by ls sampling with different hyper parameter settings of on all benchmarks and table shows the average execution time required by ls sampling with different hyper parameter settings of on all benchmarks.
tables and demonstrate that when the value of becomes larger the wise coverage and the wise coverage achieved by ls sampling become higher and meanwhile the execution time required by ls sampling becomes longer.
the results in tables and demonstrate the flexibility of lssampling since controlling can achieve a trade off between coverage and execution time.
also ls sampling can achieve a good balance according to our default hyper parameter setting i.e.
.
.
threats to validity there are two potential threats to validity of our experiments experimental setup for k recalling that kdenotes the number of valid test cases a potential threat to validity of our experiments is the value of kwe set in our experiments.
following the most recent work we conduct experiments with k .
to reduce this threat we also conduct experiments with k as well.
our experimental results in tables present that ls sampling with k can still achieve higher wise coverage and higher wise coverage than uniform sampling with k and baital with k .
furthermore we illustrate the wise coverage achievedtable average wise coverage and average wise coverage achieved by ls sampling with different hyperparameter settings of on all benchmarks.
10 50 100 500 cov cov cov cov cov wise k .
.
.
.
.
wise k .
.
.
.
.
wise k .
.
.
.
.
wise k .
.
.
.
.
table average execution time required by ls sampling with different hyper parameter settings of for test suite generation on all benchmarks.
10 50 100 500 time k .
sec .
sec .
sec .
sec .
sec time k .
sec .
sec .
sec .
sec .
sec byls sampling uniform sampling and baital withkup to for the financial benchmark in figure .
our experiments show that ls sampling can consistently outperforms uniform sampling andbaital in various scenarios under different values of k. generality of our experiments in order to reduce the threat of limited generality of our experiments we conduct our experiments to evaluate all competing approaches for solving the t wise covmax problem with both t andt while the most recent work only focuses on solving the wise covmax problem.
furthermore in our experiments we adopt a large number of benchmarks to evaluate each competing approach.
those benchmarks cover diverse numbers of variables and hard constraints and have been extensively studied in previous work .
related work combinatorial interaction testing cit is an important research topic in software engineering and has been extensively studied in past decades.
comprehensive literature review can be found in the book by kuhn et al.
and survey articles .
in classical cit researchers aim to build the minimum sized test suite with full t wise coverage also known as covering array such that all possible valid t wise option combinations in the entire configuration space are covered.
existing methods for building covering arrays include mathematical construction methods e.g.
greedy heuristic based methods e.g.
and meta heuristic search methods e.g.
.
in practice achieving full t wise coverage is difficult or even infeasible when there are large numbers of configuration options .
also it is recognized that covering arrays would possibly be large for highly configurable systems and would exceed the testing budget .
hence for testing highly configurable systems compared to building covering arrays an advisable solution is to solve the t wise coverage maximum t wise covmax problem studied in this work which aims to generate a fixed size test suite that maximizes the t wise coverage.
for solving the t wise covmax problem previous studies present that uniform sampling which tries to sample each valid configuration with equal probability shows its effectiveness .
apart 1090ls sampling an effective local search based sampling approach for achieving high t wise coverage esec fse august athens greece from solving the t wise covmax problem a number of research works tries to incorporate uniform sampling as a dominant domainagnostic method with combinatorial solving and knowledge compilation techniques.
in particular lopez herrejon et al.
evaluated the relationship between interaction coverage and the test suite size in a multi objective way.
oh et al.
studied uniform sampling by incorporating it with binary decision diagrams.
plazar et al.
conducted extensive empirical evaluations to assess two uniform sampling tools unigen2 and quicksampler .
unfortunately uniform sampling suffers a severe issue that it cannot well handle configurable systems with complex constraints .
besides uniform sampling recently baranov et al.
proposed an adaptive weighted sampling approach baital which is the current state of the art approach for solving the t wise covmax problem.
the experiments in the literature present that baital can achieve higher wise coverage than uniform sampling on most benchmarks.
however baital does not optimize the objective of the t wise covmax problem explicitly during its sampling process which makes it ineffective in the meanwhile baital handles hard constraints through costly knowledge compilation techniques which makes it inefficient.
compared to uniform sampling and baital our ls sampling approach is based on an effective local search framework whose search process is directly guided by the optimization objective.
also ls sampling leverages the effectiveness of a number of core algorithmic mechanisms including formula simplification dynamic mechanism for updating sampling probabilities and diversity aware heuristic search in order to strengthen its both effectiveness and inefficiency.
as reported and analyzed in section our extensive experimental results on a large number of public benchmarks collected from real world highly configurable systems confirm both the effectiveness and the efficiency of our ls sampling approach.
conclusion in this paper we propose a novel approach dubbed ls sampling local search based sampling for achieving high t wise coverage.
extensive experiments on a large number of public benchmarks which are collected from real world highly configurable software systems demonstrate that ls sampling can achieve much higher t wise coverage than its state of the art competitors i.e.
uniform sampling and baital .
the results indicate both the effectiveness and the efficiency of our ls sampling approach.
more encouragingly ls sampling can achieve higher wise coverage and higher 3wise coverage through generating much smaller test suits than its state of the art competitors.
furthermore ls sampling requires much less execution time to generate test suites with higher wise coverage and higher wise coverage compared to baital .
the implementation of ls sampling the benchmarks used in our experiments and the detailed experimental results including the full results of the wise coverage and the wise coverage achieved by ls sampling and its competitors i.e.
uniform sampling andbaital with both k andk on all benchmarks are available at