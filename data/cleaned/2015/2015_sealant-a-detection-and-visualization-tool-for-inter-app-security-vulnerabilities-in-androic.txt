sealant a detection and visualization tool for inter app security vulnerabilities in android y oun kyu lee peera y oodee arman shahbazian daye nam and nenad medvidovic computer science department university of southern california bloom walk los angeles california usa younkyul yoodee armansha dayenam neno usc.edu abstract android s flexible communication model allows interactions among third party apps but it also leads to interapp security vulnerabilities.
specifically malicious apps can eavesdrop on interactions between other apps or exploit the functionality of those apps which can expose a user s sensitiveinformation to attackers.
while the state of the art tools have focused on detecting inter app vulnerabilities in android they neither accurately analyze realistically large numbers of appsnor effectively deliver the identified issues to users.
this paper presents sealant a novel tool that combines static analysis and visualization techniques that together enable accurate iden tification of inter app vulnerabilities as well as their systematic visualization.
sealant statically analyzes architectural information of a given set of apps infers vulnerable communicationchannels where inter app attacks can be launched and visualizes the identified information in a compositional representation.
sealant has been demonstrated to accurately identify interapp vulnerabilities from hundreds of real world android appsand to effectively deliver the identified information to users.
demo video i. i ntroduction modern mobile devices handle users private information such as contacts passwords and text messages.
android the most widely adopted mobile operating system today implements various security measures to protect user infor mation from attackers.
however android still has knownsecurity vulnerabilities .
one well known vulnerability resides in the design of android s communication model in which components within an app or across apps communicate by exchanging messages called intents.
specifically if app developers do not carefully control the incoming and outgoing intents inter component communication icc via intent can expose vulnerable surfaces to inter app attacks such as intent spoofing unauthorized intent receipt and privilege escalation .
a number of techniques have been proposed to detect interapp vulnerabilities in android .
however existing techniques target only single app analysis orsupport limited types of inter app attacks .
while the state of the art techniques provide compositional analysis of multiple apps they have been shown to encounter scalability problems in analyzing large numbers of apps and or to suffer from a potentially large number of false alarms.
furthermore these techniques lack a systematic representation of their analysis results which hinders effective and intuitive understanding of inter app vulnerabilities by the end users.this paper presents sealant a novel tool for automated analysis and visualization of android inter app vulnerabilities which extends our prior work .
sealant combines static analysis with visualization techniques to enable compositional security analysis and systematic assessment of a set of android apps.
given a set of apps sealant statically analyzes their architectural information and identifies vulnerable icc paths between the apps by leveraging data flow analysis and icc pattern matching.
it then visualizes the combination of architectural information of the target apps with the identified vulnerable icc paths between them enabling users to associate an appropriate action with each vulnerable path.
sealant is distinguished from the existing tools because it simultaneously detects multiple types of inter app attacks i.e.
intent spoofing unauthorized intent receipt and privilege escalation it extends the detection coverage andaccuracy in identifying inter app vulnerabilities it supports a compositional analysis that scales to hundreds of real world apps it provides an efficient analysis by reusing prior analysis results and it effectively delivers to end users a composition of large number of apps as well as their identified vulnerabilities via a systematic visualization.
the rest of this paper is organized as follows.
section ii depicts examples of inter app attacks that motivate our tool.section iii presents sealant s architecture along with the description of major components and their implementations.
section iv highlights sealant s key features and section v demonstrates its evaluations.
section vi discusses related work and section vii concludes the paper.
ii.
m otiv a ting examples in this section we present two simplified examples of interapp attacks intent spoofing and unauthorized intent receipt.
figure a depicts intent spoofing.
component m1 of a malicious app malicious1 can send an intent to component v2 of a victim app victim1 in order to exploit victim1 s functionalities.
for example if v2is designed to dispatch an sms to the number bundled in an incoming intent from v1 whenever m1injects a spoofed intent to v2along with unsafe number and text v2 will subsequently send an sms to the unintended number.
in this case a vulnerable icc path exists between m1andv2.
figure b illustrates an unauthorized intent receipt.i n case when an intent is sent or broadcast without particular .
c circlecopyrt2017 ieeease urbana champaign il usa t ool demonstrations883 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
v1 victim1 b unauthorized intent receipt a intent spoofing v2 m1 malicious1 v3 victim2 v4 m2 malicious2 fig.
inter app attacks a intent spoofing and b unauthorized intent receipt protection any component can receive it by declaring attributes matching those of the intent.
for example component v3 ofvictim2 is designed to broadcast an intent in order to deliver an account s information to the other component within the same app i.e.
v4 .
by listening to the intent although not an intended receiver component m2 of a malicious app malicious2 can eavesdrop on the information bundled in the intent.
in this case a vulnerable icc path exists between v3 andm2.
as shown in the examples inter app attacks are not easy to distinguish from ordinary iccs between apps.
since iccs are essentially invisible to users it is difficult for users to recognize where the attacks are actually launched.
furthermore depending on the types of apps composing a user s device vulnerable icc paths will vary.
these characteristics make detection and assessment of inter app vulnerabilities quite challenging.
iii.
sealant sdesign and implement a tion sealant is a tool that automatically identifies icc paths in a set of target apps that are vulnerable to inter app attacks and visualizes the identified paths using the architectural information of those target apps.
sealant processes a set of apk1files as input and displays the output in a pre defined representation.
as shown in figure sealant is designed to have two layers.
sealant sfront end is responsible for providing the interactive user interface.
the sealant client component belongs to this layer.
sealant sback end is responsible for identifying vulnerable icc paths from target apps managing the extracted information and transforming the information into a visually representable format.
the back end comprises three main components sealant core sealant analyzer and sealant repository.
in the rest of this section we will describe the details of sealant s four components and their implementations.
a. sealant client sealant client facilitates a user s interaction with the back end layer.
once the user selects a set of apk files that were automatically pulled from the user s device or manually downloaded from online app stores the sealant client forwards the files to the sealant core and informs 1apk android package kit is an archive file format that distributes and installs android apps on top of the android operating system.the user of the analysis status e.g.
displaying the analysis progress .
the sealant client renders the combined information obtained from the sealant core i.e.
app models and identified vulnerable icc paths in tailorable visual notations.
for example a component may be depicted as a black dot and a vulnerable path as a red line as shown in figure a .
the sealant client provides interactive interfaces that enable users to customize display settings e.g.
size font and color or highlight particular architectural elements e.g.
component or icc path .
the sealant client optionally contacts users to assess each vulnerable icc path.
since sealant s static analysis may over approximate control flow paths which in turn may result in spurious vulnerable icc paths in some cases a user s assessment can reduce the falsely identified paths in subsequent analyses.
furthermore referring to an expert user s assessments may aid non expert users to isolate the falsely identified paths.
b. sealant core sealant core is responsible for controlling every operation and transforming the analyzed information into a visually representable format.
it handles every request from sealant client.
if a set of apk files is requested the core component first checks if prior analysis results are stored in the sealant repository.
if the corresponding results exist the core reuses them.
otherwise it decompiles the apk files and passes them to the sealant analyzer.
the core subsequently combines and transforms the app models and vulnerable icc paths it receives back from the analyzer into a pre defined format compatible with the sealant client.
the core stores the user s assessments received from the sealant client in the sealant repository.
c. sealant analyzer given a set of apps sealant analyzer extracts each app s architectural information and summarizes the information as a model of each app.
the analyzer identifies vulnerable icc paths between the apps using data flow analysis and icc pattern matching.
it consists of two sub components model extractor and vulnerability identifier.
model extractor inspects each app s android manifest file and bytecode to extract the app s architectural information e.g.
components intent filters permissions and intents .
for each app component model extractor performs data flow analysis between sensitive apis and icc call apis .
a component that contains such a data flow is marked as a vulnerable component.
model extractor then builds a summarybased model that captures the information of each app andstores every model in the sealant repository for reuse in subsequent analyses.
vulnerability identifier analyzes vulnerable icc paths from a set of app models.
to this end it first builds an icc graph by matching intents and intent filters of each component based on the rules from android s api reference documentation .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
fig.
sealant s architecture in an icc graph a node represents a component and an edge is defined as a tuple s r i where sis a sender and ra receiver component and iis an intent between them.
sealant then traverses the icc graph and marks an edge as vulnerable based on two criteria if there is a vulnerable component at one or both ends and if it is a part of a particular compositional icc patterns that may be vulnerable to inter app attacks.
specifically two different edges one across apps and the other one within an app that direct to the same component with the same type of intent represent a vulnerable icc pattern susceptible to intent spoofing.
conversely two different edges one across apps and the other one within an app that start from the same component with the same type of intent represent a vulnerable icc pattern susceptible to unauthorized intent receipt.
the identified vulnerable icc paths are stored in the sealant repository for reuse in subsequent analyses.
d. sealant repository sealant repository maintains the extracted app models in its model database sub component and the identified vulnerable icc paths in the path database sub component.
model database manages each app s model by its package name and versions in order to enable reusing the extractedinformation for further analyses.
when apps are installed or updated on a user s device subsequent to running sealant sealant extracts the architectural information only from the installed or updated apps and reuses the prior analysis results for the rest.
this can greatly reduce the total analysis time as evaluated in section v .
path database maintains the identified vulnerable icc paths.
for each vulnerable icc path it also maintains each user s assessment that indicates whether the icc path is indeed exposed to inter app attacks or not.e.
implementation we have implemented the sealant analyzer as a standalone java application that uses a set of apk files as its input.
it combines approximately newly written loc with offthe shelf tools.
specifically to enable a complete extraction of architectural information from apps the analyzer integrates two static analysis tools ic3 and covert .
to perform data flow analysis on each component the analyzer leverages flowdroid an intra component taint analysistool for android.
the analyzer combines the outputs from those tools into complete app models.
the app models for architectural objects and identified vulnerable icc paths are respectively transformed into two different json files with pre defined formats.
the json file for vulnerable icc paths is also compatible with interceptor an extension module we have developed for the android framework to control runtime iccs based on a given list of icc paths.
we implemented the sealant core using java and shell script code that integrates different components totaling around loc.
we implemented the sealant repository as a file systembased repository.
it maintains three different types of files app models vulnerable icc paths and assessments of each vulnerable icc path.
finally we implemented the sealant client as a web application using html5 with the off the shelf javascript libraries that include jquery for event handling web pages bootstrap for developing a responsive web application and d3 for a data driven visualization.
the size of the sealant client is approximately loc.
we extended the display notation for the sealant client by specifying a meta model in d3.
the notation includes the essential elementsrepresenting android app architectures i.e.
components apps and icc paths .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
iv .
k ey tool fea tures sealant s key features are intended to automatically identify icc vulnerabilities among a given set of apps and effectively deliver the identified information to users.
the features also enable users to assess each identified vulnerable icc path selectively focus on particular architectural elements e.g.
paths components or apps and reuse prior analysis results.
the features that can be accessed via the sealant client are shown in figure .
automated detection of vulnerabilities.
given a set of apk files or app models from prior analyses sealant automatically processes the detection of inter app vulnerabilities.
the entire detection process takes place in the backend.
during the process progress bars display the status of each analysis step i.e.
extraction of architectural information and identification of vulnerable icc paths .
once the analysis is completed sealant provides options for exporting the identified vulnerabilities in a textual format or visualizing them in pre defined notations.
visualization of architecture and vulnerabilities.
to effectively visualize a number of components in androidapps sealant displays the integrated and compositional view of target apps as shown in figure a .
sealant depicts each component as a labeled dot each app as a cluster of components and each icc path between a pair of components as a gray line connecting the respective dots.
the vulnerable icc paths are presented as colored lines with different colors for each vulnerability type intent spoofing is red unauthorized intent receipt is blue and privilege escalation is green.
a user can customize display options such as font size display size and line tension.
as part of the visualization feature if a user hovers the pointer over an app or a component name sealant shows its detailed information such as type intent filters and permissions.
as shown in figure b sealant also presents detailed information for each vulnerable iccpath and a user can assess whether a given path is indeedunsafe or not.
the user assessments can provide a reference point for future analyses as detailed below.
selective visualization.
for a set of apps that contain a large number of components and icc paths displaying all the components and paths may be incomprehensible to users.
to handle this sealant provides a selective visualization that allows a user to focus on a particular set of apps components or vulnerabilities.
for example if a user clicks on a desired component s name sealant highlights the icc paths and the corresponding components that are connected to it and fades out the other parts.
sealant also enables users to choose different visualization types that use different notations and topologies.
reuse of prior analyses.
when apps are installed or updated rerunning the sealant analyzer is required to identify vulnerable paths in the new icc graph.
to effectively handle this sealant supports reusing prior analysis results by maintaining the models for apps and vulnerable icc paths respectively.
whenever the analysis is requested sealantautomatically checks if the same apps models or corresponding vulnerable icc path information exist in its repository.
consequently the analysis time will primarily depend on the number of newly analyzed apps.
v. e v alua tion in this section we evaluate sealant s accuracy scalability performance and usability.
accuracy.
our prior research has evaluated accuracy ofsealant in terms of detecting vulnerable icc paths from real world apps.
specifically we created a test suite comprising the apps from existing benchmarks and externally developed apps in total apps with vulnerable icc paths .
from the test suite sealant detected vulnerable icc paths with precision2and recall3 both of which are higher than those of existing tools separ and respectively icct a and respectively .
scalability.
to evaluate sealant s scalability we extended the above test suite by randomly including apps from public sources .
the selected apps were divided into non overlapping bundles comprising apps each.
these bundles are larger than the number of apps an average android user is shown to regularly use each month .
from the bundles sealant flagged icc paths with precision.
the results demonstrated that sealant successfully works on representative sets of real world apps with improved scalability as compared to existing tools.
performance.
we evaluated sealant s performance in detecting vulnerable icc paths .
from the extended test suite used above we randomly selected four categories of ten different bundles of apps.
a category comprised or apps.
as shown in figure since sealant maintains a summary based model of each app as expected the analysis time scaled linearly with the number of apps and components.
on average extracting architectural information from each app took .
sand identifying vulnerable icc paths took .
s per app.
although the extraction is relatively time consuming sealant s feature for reusing prior analysis can reduce up to .
of the analysis time in subsequent analyses.
usability.
to confirm that sealant s visualization helps the users understanding of inter app vulnerabilities we conducted a user study.
our participants included computer sciencegraduate students at the university of southern california recruited via an e mail list.
the background survey indicated that of the participants .
used android as their primary mobile platform while the remaining .
had prior experience using it.
the analysis results of vulnerableicc paths of ten android apps that form five inter app vulnerabilities were given to each participant via two different representation methods a textual list and sealant s visualization.
participants were asked to evaluate the level of difficulty in understanding vulnerabilities for each method using a pointlikert scale very difficult very easy .
we also asked 2precision the ratio of vulnerable icc paths to identified icc paths.
3recall the ratio of identified to all vulnerable icc paths.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
fig.
two different screenshots of sealant s user interface authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
fig.
sealant s performance on different numbers of apps and components them about the factors that affected their evaluation.
according to the responses the mean degrees of sealant s visualization mean .
std.
.
was higher than that of textual representation mean .
std.
.
.
the factors that affecttheir preference for sealant s visualization were intuitiveness .
ease of understanding .
compositional view .
and others .
.
the results support the conclusion that sealant s visualization successfully aids a user s understanding of inter app vulnerabilities.
vi.
r ela ted work icc analysis is used to detect android s inter app vulnerabilities.
although amandroid identifies privacy leaks by tracking interactions between components it has shown its inaccuracy when it comes to content provider components and certain icc methods.
icct a detects privacy leaks between components using a taint flow analysis.
while its bytecode instrumentation resolves the icc paths between components it is not scalable to a large number of apps.
covert introduces a compositional analysis of a set of apps to identify permission leakage.
however it does not target other types of inter app attacks such as unauthorized intent receipt.
icc visualization is employed to aid understanding the systems that use icc mechanism.
viv a is our prior visualization and analysis tool for event based systems which visualizes a target system s architectural information messagebased dependencies between components and runtime messageexchanges.
however it neither detects inter app vulnerabilities nor supports android.
although covert has a feature that visualizes its vulnerability analysis results it does not support a compositional visualization of a large number of apps or a dynamic user interface.
vii.
c onclusion our experimental results of applying sealant to hundreds of real world android apps have demonstrated that it accurately identifies vulnerable icc paths.
our user study also hasshown that it successfully aids users in understanding the identified vulnerabilities.
we plan to extend sealant to support other types of inter app attacks that exploit covert channels in the android core system components such as the file system.
another potential direction for future work is evaluating different types of displays e.g.
different notations and colors to find the most efficient way of delivering android inter app vulnerabilities.