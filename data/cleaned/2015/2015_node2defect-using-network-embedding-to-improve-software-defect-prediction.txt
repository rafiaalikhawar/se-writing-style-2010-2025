node2defect using network embedding to improve software defect prediction yu qu ministry of education key lab for intelligent networks and network security xi an jiaotong university china quyuxjtu xjtu.edu.cnting liu school of electronic and information engineering xi an jiaotong university china tingliu xjtu.edu.cnjianlei chi xi an jiaotong university china chijianlei stu.xjtu.edu.cn yangxu jin xi an jiaotong university china jyx530 stu.xjtu.edu.cndi cui xi an jiaotong university china cuidi stu.xjtu.edu.cnancheng he xi an jiaotong university china hg19941996 stu.xjtu.edu.cn qinghua zheng xi an jiaotong university china qhzheng xjtu.edu.cn abstract networkmeasureshavebeenprovedtobeusefulinpredictingsoftware defects.
leveraging the dependency relationships between softwaremodules networkmeasurescancapturevariousstructural features of software systems.
however existing studies have relied on user defined network measures e.g.
degree statistics or centrality metrics which are inflexible and require high computation cost todescribethestructuralfeatures.inthispaper wepropose a new method called node2defect which uses a newly proposed network embedding technique node2vec to automatically learn to encodedependencynetworkstructureintolow dimensionalvector spacestoimprovesoftwaredefectprediction.specifically wefirstly construct a program s class dependency network.
then node2vec isusedtoautomaticallylearnstructuralfeaturesofthenetwork.after that we combine the learned features with traditional software engineeringfeatures foraccuratedefectprediction.weevaluate our method on open source programs.
the experimental results show that in average node2defect improves the state of the art approach by .
in terms of f measure.
ccs concepts software and its engineering risk management maintaining software keywords softwaredefect defectprediction softwaremetrics networkembedding permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september montpellier france association for computing machinery.
acm isbn ... .
reference format yu qu ting liu jianlei chi yangxu jin di cui ancheng he and qinghua zheng.
.
node2defect using network embedding to improve software defectprediction.in proceedings of the 33rd acm ieee international conference on automated software engineering ase september montpellier france.
acm new york ny usa 6pages.
org .
.
introduction softwaredefectpredictionistheprocessofbuildingmachinelearning classifiers to predict code regions that potentially have defects .
defect prediction techniques can provide useful guidancesforcodereviewersorsoftwaretesterstoallocatetheirlimited resourcesmoreeffectively thusisveryusefulinsoftwareengineering practices .
networkmeasureshave beenprovedtobeusefulin predicting softwaredefects e.g.
.exploitingthedependency relationships between software modules network measures cancapturevariousstructuralfeaturesofsoftwaresystems.thus they are very useful in software defect prediction.
for instance in their seminal study zimmermann and nagappan p r o po s edt o use network measures on the dependency graph of a software system in defect prediction.
recently ma et al.
further evaluated the predictive effectiveness of network measures in effort awarebug prediction.
chenet al.
usednetworkmeasures to predict high severity software bugs and they found that most network measuresweresignificantlyrelatedtohighseveritybug proneness.
however these network measures e.g.
degree statistics or centralitymetrics aretraditionallyuser defined whichhasbeenbelieved to be inflexible and require human designing efforts .
these measures are also believed to suffer from the high computationandspacecost .thus network embedding graphembedding techniques whichautomaticallylearntoencodenetwork structureintolow dimensionalvectorspace havedrawnincreasing attentions in the machine learning community and shown their advantages over user defined measures in many machine learning tasks .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france yu qu ting liu jianlei chi yangxu jin di cui ancheng he and qinghua zheng consideringthisnewresearchtrend inthispaper wepropose a new method called node2defect which uses a new network embedding technique node2vec to automatically learn structural featuresofsoftwareclassdependencynetworktoimprovesoftware defect prediction.
innode2defect the class dependency network cdn of the programunderanalysisisfirstlyconstructed.then node2vec isused toautomaticallylearnstructuralfeaturesofcdn.foreachnode i.e.
each class in cdn node2vec automatically learns a vector to encode its structural feature.
then node2defect concatenates the class s feature vector with its traditional software engineering features suchascohesionandcouplingmetrics toformthenew featureofthisclass.thenthenewfeatureisusedinsoftwaredefect prediction.experimentalresultsshowthattheproposed node2defect approach can improve software defect prediction nontrivially.
the f measure is improved by .
in average.
in summary we makethe following contributions in this paper anewnetworkembeddingtechnique node2vec isusedtoautomatically learn structural features of software class dependency networks we propose a new method named as node2defect whichexploitsnetworkembeddingtechniqueandcombineswith traditional software engineering metrics to improve defect prediction experimentson15javaopensourceprogramsshowthat the proposed method can nontrivially improve defect prediction models performances.
background .
class dependency network in this section the basic concept of class dependency network is introduced based on an illustrative example.
for an oo program p its class dependency network cdn pis a directed network cdn p v e where each node v v represents a class in p and the edge set erepresents the class dependency relationships.
let cidenotes the class that virefers to.
thenvi vj eifandonlyif cihasatleastoneclassdependency relation with cj.
figure1 a givesanillustrativeexamplejavacodesnippet.for thiscodesnippet figure b showsitsclassdependencynetwork cdn .althoughotherwork usuallyonlygavethe processes to construct the class networks the intrinsic nature of these networks is the same as cdn s. in cdn nodes are classes andedgesrepresentclassdependencyrelations.asshowninfigure these dependency relations include aggregation a b a c andb d inheritance d c interfaceimplementation d i parameter types c b and return types.
.
the node2vec technique in this section we firstly give a brief introduction on network embedding followed by a brief discussion on node2vec.
for a network n v e a network embedding is a mapping f vi yi rd vi vsuch that d lessmuch v and the function f preserves some proximity measure defined on network n .
the conceptual framework of node2vec is shown in figure .
briefly node2vec algorithm is based on and motivated by a naturallanguageprocessing nlp model skip gram andthena b dc iinterface i public int add int i public class a public static void main string args b b new b system.
out.println b.counter b.m1 c c new c c.m2 b class b public int counter private d d new d public void m1 counter d.add counter system.
out.println counter class c public void m2 b b b.counter b.counter system.
out.println b.counter class d extends c implements i public int add int i return i a b figure a class dependency network example.
proposes a flexible random walk approach to generate sample network neighborhoods for nodes.
specifically skip gram modelisone ofthetwo basicmodelsof the nlp technique word2vec the other one is continuous bag of words model cbow .
skip gram aims to maximize the co occurrenceprobabilityamongthewordsthatappearwithina slidingwindow.suchprocessisrealizedbysolvinganoptimization problemusingstochasticgradientdescent sgd andbackpropagation on single hidden layer feedforward neural network.
as shown in figure node2vec firstly samples a set of paths walks fromtheinputnetworkusingtheirnewfixedlengthrandom walk approach.
each path sampled from the network corresponds toasentencefromthecorpusinnlp whereanodecorrespondsto a word.
then skip gram is applied on the paths to maximize the probability of observing a node s neighborhood conditioned on its embedding.astheauthorsstated giventhelinearnatureof textinnlp thenotionofneighborhoodcanbenaturallydefined usingaslidingwindowoverconsecutivewords.however networks such as cdns in this paper are not linear thus a richer notion of neighborhoodisneeded.inaword thekeycontributionof node2vec isindefiningaflexiblenotionofanode snetworkneighborhood by providing a trade off between breadth first sampling bfs and depth first sampling dfs graph searching strategies.
figure also shows bfs and dfs examples given a source node c7.
ane w2ndorderrandomwalkisdefinedin node2vec withtwo parameters pandqwhich control the transition probability during the walk as shown in figure .
the parameters pandqare named asreturn parameter andin out parameter respectively.interested readers are referred to the original paper for more details.
itisworthnotingthatthetimecomplexityof node2veciso v d .
existing network measures usually have more expensive time complexities.forinstance themetric betweenness centrality has beenintensivelyused in existingresearches .
thetimecomplexityofbetweennesscentralityis o v e onunweighted network .
considering d lessmuch v v is usuallysmaller than e see the statistics in table and there are usually more than10metricsarecomputedinexistingresearches sotheexisting methods usually require much higher computation and space cost.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
node2defect using network embedding to improve software defect prediction ase september montpellier france c11c13 c9c8c12c3c2c1 c10c7 c6c5 c4walk c7 c4 c8 ... walk c5 c7 c3 ... walk c9 c8 c10 ... ...... dfsinpu t layerhidden layeroutpu t layer ... bfsskip gram model a pa q a qa figure the conceptual framework of node2vec.
the proposed approach node2defect inthissection weintroduce node2defect sframeworkbasedona real and simple example.
figure 3shows the process of node2defect when a package of ant org.apache.tools.ant.input is considered in the analyzing process of node2defect.
for this package figure3depicts its cdn when only considering the class dependency relationships within this package in practice the dependency relationships within the whole system are considered .
based on the constructed cdn node2vec is used to automatically learn a vector for each node i.e.
each class in the cdn.
for the simplicity of illustration as shown in figure the vector s dimension d i s setas8.inexperimentsinthispaper weuse32asthedimension of the learned vector.
since the learned vector only quantify the structuralfeaturesofaclass butthedefectivenessofaclassaretheconsequencesofmanycomplicatedandinter playedqualityfactors e.g.
the software architecture and the programmer s perception on the programming language.
to more accurately predict defects node2defect alsocomputestraditionalsoftwareengineeringmetrics e.g.
lack of cohesion in methods lcom coupling between objectclasses cbo anddepthofinheritancetree dit .then node2defect concatenatesthelearnedvectorwithtraditionalmetricsandusestheconcatenatedvectorasthefeaturesthatarefed into the subsequent machine learning classifiers.
in the evaluation partofthispaper traditionalsoftwareengineeringmetricsalone areusedasthe traditional approach andbaseline metrics.table 2in the appendix part of this paper shows the traditional software engineering metrics used in this study.
experiments .
subject software systems to evaluate the practical application of node2defect a data set containing15largeopen sourceandwidely usedjavasoftwaresystems is collected as shown in table .
antisacommand linetoolforautomatingsoftwarebuildprocesses camel is an integration framework drjava is a java development environment genoviz is a tool for data visualization and sharing in genomics jedit is a text editor ivy is a transitive dependency manager jmri is a building tool for modelling rail road computer control jmol is a browser based html5 viewerand stand alone viewer for chemical structures in 3d jppf is an open source grid computing solution lucene is a searching and information retrieval library poi a library to process microsoftoffice files synapse is a high performance enterprise service bus esb tomcatisawebserverandservletcontainer velocityisa template engine to reference objects defined in java code xalan is a library for processing xml documents.
all the defect data of these subject systems is collected from publicly available software defect data repository.
among these subjectsystems thedefectdataofant camel jedit ivy lucene poi synapse tomcat velocity and xalan is obtained from thetera promise data repository .
the defect data of drjava genoviz jmri jmol and jppf is obtained from a newly released dataset2whichhasbeencontributedbyshippeyetal.intheiresem paper .
to ensure the reproducibility of this study we use themetricsextractedandcontainedinthesetowdatasetsasthe traditionalsoftwareengineeringmetrics.table 2intheappendix part of this paper shows the metrics in tera promise data set.
table1givesthestatisticsofthesesystemsandtheircdns.the data in each column in table 1is interpreted as follows column version shows the version of the corresponding systemthatiscontainedintheaforementionedtwodefectdatasets.
columnssloc class showthe source linesofcodeandthe number of classes of the subject systems respectively.
column ncdnandecdnshow the number of nodes and edges of each cdn respectively.
in the construction processes of cdns only whenaclasshascertaindependencyrelationswithotherclasses its corresponding node is added into cdn.
thus ncdnis slightly smaller than the total number of classes in column class.
column crd intersectiontext.1ccdn showsthenumberofclassesthatappear bothincdnandthedefectdatasets inthelattertheyhave records to signify they are defective or not.
pdef ectis the percentage of defective classes in crd intersectiontext.1ccdn.
the last column shows the websites of these systems.
.
experiment design in the evaluation we investigated the effectivenessof node2defect in the following two defect prediction experiments cross validation cross validationisamostwidely usedmethodtoevaluatedefect predictionmodels.
weused three fold cross validation in this experiment.
specifically in each single run of this experiment the originalbugdatasetisrandomlysplitintothreeparts twothirds oftheinstancesareusedtotrainthebugpredictionmodel andthe authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france yu qu ting liu jianlei chi yangxu jin di cui ancheng he and qinghua zheng !
!
!
!
figure node2defect s framework.
a java library and command line tool ant s cdn is depicted as an illustrating example.
table subject software systems system version sloc class ncdn ecdn crd intersectiontext.1ccdn pdef ect website ant .
.
.
camel .
.
.
drjava .
genoviz .
.
jedit .
.
ivy .
.
jmri .
.
jmol .
.
jppf .
.
lucene .
.
.
poi .
.
synapse .
tomcat .
.
.
velocity .
.
.
xalan .
.
.
restoftheinstancesareusedtoevaluatethemodel.foreachsubject system we repeated the experiment for times to reduce the biascausedbytherandomsplitofinstances.themachinelearning algorithm random forest is used in this experiment.
adaptiveselectionofclassifiersinbugprediction asci asciisanadaptivedefectpredictionmethod whichhasbeen recently proposed by nucci et al .
asci can dynamically select among a set of machine learning classifiers the one which is more suitable to predict a class s defectiveness.
the original implementationofasci hasintegratedfivedifferent machinelearningclassifiers namelylogistic regression log naivebayes nb radialbasisfunctionnetwork rbf multi layerperceptron mlp anddecisiontrees dtree .thus ascicanprovidemore thorough evaluation on node2defect.
we adopted asci s original implementation in which fold cross validation is used.
toevaluatethedefectpredictionmodel sperformance weuse widely adopted metrics in literature the f measure which istheharmonicmeanofprecisionandrecall and theareaunderthecurve auc whichquantifiestheoverallabilityofaprediction model to discriminate between defective and clean classes.
auc represents an ideal prediction result.
.
experimental results and discussion figure4and5showtheexperimentalresultsofthecross validation and asci experiments respectively.
in each figure the average mean valuesoff measureandaucareshown.basedonfigure4 it can be observed that in the cross validation experiment the defect prediction model s performance is improved for all the subjectsystems when node2defect isused.thevalueoff measureis improved by .
in average and the value of auc is improved by .
in average.
similarly based on figure it can observed that in the asci experiment thedefectpredictionmodel sperformanceisimproved foralmostallthesubjectsystems when node2defect isused.the value of f measure only declines slightly for ivy and velocity and thevalueofaucalsoonlydeclinesslightlyforjmriandtomcat when node2defect is used.
the value of f measure is improved by .
in average and the value of auc is improved by .
inaverage.
we also used the wilcoxon signed rank test s to evaluate the differences between results of approaches.
the p values of the wilcoxonsigned ranktestsconfirmthatthedifferencesbetween results of approaches are significant at the .
level.
inaword intheexperiments theproposedapproach node2defect improves the performances of defect prediction models in mostof the cases.
and the improvements are nontrivial greater than intermsoff measure whichmeanthatnetworkembedding techniquesareindeedhelpfulinsoftwaredefectprediction asthey can learn the structural features of software modules automatically which can reflect the ways how the modules depends on and interact with each other.
herewegiveapossibleexplanationfortheseexperimentalresults.asdiscussedin predictiontasksonnodesinnetworks authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
node2defect using network embedding to improve software defect prediction ase september montpellier france f measure comparison between traditional approach and node2defect in cross validation ant camel drjava genoviz ivy jedit jmol jmri jppf lucene poi synapse tomcat velocity xalan subject systems00.
.
.
.
.
.
.
.8f measure valuestraditional node2defect auc comparison between traditional approach and node2defect in cross validation ant camel drjava genoviz ivy jedit jmol jmri jppf lucene poi synapse tomcat velocity xalan subject systems00.
.
.
.81auc valuestraditional node2defect figure f measure and auc comparisons between traditional approach and node2defect in cross validation.
f measure comparison between traditional approach and node2defect with asci ant camel drjava genoviz ivy jedit jmol jmri jppf lucene poi synapse tomcat velocity xalan subject systems00.
.
.
.81f measure valuestraditional asci node2defect asci auc comparison between traditional approach and node2defect with asci ant camel drjava genoviz ivy jedit jmol jmri jppf lucene poi synapse tomcat velocity xalan subject systems00.
.
.
.81auc valuestraditional asci node2defect asci figure f measure and auc comparisons between traditional approach and node2defect with asci.
often shuttle between two kinds of similarities homophily and structural equivalence.homophilymeans thatnodesbelongingto similar communities should be embedded closely.
structural equivalencemeansthatnodesthathavesimilarstructuralrolesshouldbe embeddedclosely.amongthetwosamplingstrategies bfsleads to structural equivalence and dfs leads to homophily .
ontheotherhand asdiscussedbynguyenetal.
thenetworkmetric nweakcomp in which isthenumber ofunconnected componentsintheincomingegonetwork isagooddefectpredictor.
it means that for a certain class if all the dependent classes arecompletelyindependentfromeachother thentheriskoffailurefor thisclassishigherthanwhentheyareinterdependent.asshown infigure nodec7andc8havehigh nweakcomp in scores which is repectively .
from network embedding perspective c7 and c8 plays similar roles in their communities they are hubs of their corresponding communities thus their structural equivalence can be captured by bfs and finally be reflected in the embedding vectors.
tosumup networkembeddingtechniquescancapturesimilar structural properties of classes thus classes with similar structural defectrisksareclosetoeachotherinthelowdimensionalvector authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france yu qu ting liu jianlei chi yangxu jin di cui ancheng he and qinghua zheng table traditional software engineering metrics metrics name symbol average method complexity amc average mccabe avg cc afferent couplings ca cohesion among methods of class cam coupling between methods cbm coupling between object classes cbo efferent couplings ce data access metric dam depth of inheritance tree dit depth of inheritance coupling ic lack of cohesion in methods lcom lack of cohesion in methods lcom3 lines of code loc maximum mccabe max cc measure of function abstraction mfa measure of aggregation moa number of children noc number of public methods npm response for a class rfc weighted methods per class wmc space.
such properties might be one of the reasons that network embedding can improve defect prediction.
conclusion inthispaper wehaveproposedanewmethodcalled node2defect which uses a newly proposed network embedding technique based onrandomwalk node2vec toautomaticallylearnstructuralfeatures ofsoftwareclassdependencynetworkstoimprovesoftwaredefect prediction.
network embedding technique can encode classes dependency relationshipsinto low dimensional vectorspace thus provideanewperspectivefordefectprediction.
node2defect also combines the learned structural vector with traditional software engineering metrics to predict defects more accurately.
experimentalresultsbasedon15 opensourcejavaprograms have shownthat node2defect can improve the state of the art approach in which the traditional software engineering metrics are used alone by .
in terms of f measure.
in the future we plan to use more networkembeddingtechniquesinsoftwaredefectprediction.we also plan to study the approach that are suitable for cross version and cross project defect prediction.
a appendix traditional metrics table2showsthemetricsofsubjectsystemsintera promisedata set whichareusedastraditionalsoftwareengineeringmetrics inthisstudy.theotherfivesubjectsystems traditionalmetricsare extracted using the jhawk tool3 .