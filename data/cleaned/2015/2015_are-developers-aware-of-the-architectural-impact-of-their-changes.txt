are developers aware of the architectural impact of their changes?
matheus paixao jens krinke donggyun han chaiyong ragkhitwetsagul and mark harman university college london united kingdom matheus.paixao.
j.krinke d.han.
chaiyong.ragkhitwetsagul.
mark.harman ucl.ac.uk abstract although considered one of the most important decisions in a software development lifecycle empirical evidence on how developers perform and perceive architectural changes is still scarce.
given the large implications of architectural decisions we do not know whether developers are aware of their changes impact on the software s architecture whether awareness leads to better changes and whether automatically making developers aware would prevent degradation.
therefore we use code review data of open source systems to investigate the intent and awareness of developers when performing changes.
we extracted reviews for which the commits are available.
of the commits have changes in their computed architectural metrics and present significant changes to the architecture.
we manually inspected all reviews for commits with significant changes and found that only in of the time developers are discussing the impact of their changes on the architectural structure suggesting a lack of awareness.
finally we observed that developers tend to be more aware of the architectural impact of their changes when the architectural structure is improved suggesting that developers should be automatically made aware when their changes degrade the architectural structure.
index terms software architecture code reviews i. i ntroduction architectural decisions are among the most important decisions to be taken by practitioners due to the high risks and costs accrued by poor decisions .
recent studies have empirically shown that bug prone files are more architecturally connected than clean files and that architectural flaws can lead to increased maintenance effort .
the notions of cohesion and coupling as guides for software architecture design have been extensively associated with different aspects of software quality including but not limited to maintainability comprehensibility and code smells .
structural dependencies between code components were the most used assets for cohesion and coupling measurement for many years where other sources of information have been taken into account more recently such as semantics and revision history .
nevertheless recent studies have revealed structural dependencies to be one of the best proxies for developers perception of cohesion and coupling.
despite the large body of work aimed at aiding developers in the structural organisation of systems we still see evidence of architectural erosion as systems evolve .
developers sometimes choose to accept suboptimal solutions in order to achieve a desired goal such as short term delivery thereby accruing technical debt .
nevertheless the reasons for a developer to accept a solution that will damage thesoftware architecture or to neglect the refactoring of an eroded architecture are still open for investigation.
as pointed out by recent studies with developers different systems and different developers work under different conditions and have different perspectives regarding architectural quality.
this diversity indicates the need for studies aimed at better understanding how developers deal with architectural changes.
in this paper we extend the body of empirical knowledge regarding architectural changes in software systems by studying these changes on a day to day basis.
we investigate the intent of developers when performing changes that will impact the system s architecture.
moreover we also assess whether developers are aware of the architectural impact of their changes at the time these changes are being made.
to the best of our knowledge no existing work addresses developers intent and awareness when performing architectural changes on a day to day basis.
quantitative studies evaluating metrics and techniques for structural optimisation show how much architectural improvement can be achieved in software systems but the feedback from developers is usually insufficient.
qualitative studies interview developers regarding architectural quality by either using toy systems or selected past changes .
since surveys are subjective to bias and the questionnaires usually target the software system as whole such studies fail to capture details and nuances of each particular architectural change.
in order to understand the intent and the architectural awareness of developers when performing architectural changes on a day to day basis we mined code review data to extract significant architectural changes and infer the developers intent and architectural awareness.
during the process of code review a change is only incorporated into the system after an inspection of the patch being submitted.
the author of the change submits the patch and a natural language description of the change where other developers will have the opportunity to review the code and provide feedback.
reviewers may request the author to improve the patch and the author will do so until the change is incorporated in the system or discarded.
the code review process provides detailed information about each change which enables us to perform the empirical study on which we report here.
for each change we have the source code from which cohesion and coupling metrics can be computed and a natural language description that was submitted alongside the change from which the intent can be inferred.
based on the change s description and the .
c ieeease urbana champaign il usa technical research95 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
feedback provided by other developers we can seek evidence of developers awareness at the time the change was being made of the architectural impact of each specific change.
after mining a total of code reviews from software systems we used a metric based approach to identify reviews that changed the structural architecture of the systems.
for architectural changing reviews we performed a manual analysis and classification of the reviews according to the intent of the review and the architectural awareness of the developers involved in the review.
the inference of each review s intent and architectural awareness is based on the reviews description and feedback provided by developers no interviews have been performed .
the main contributions of the paper are listed as follows we found that developers discuss the architectural impact of their changes in only of the reviews with significant impact to the system s architecture.
in addition reviews in which the architecture is discussed tend to have higher structural improvement than reviews where the architecture is not discussed.
this provides evidence and reasoning for the introduction of tools for automated architectural analysis at reviewing time where the developers would be automatically made aware of the architectural impact of their changes.
a dataset of manually classified code reviews that include the intent of each review and the architectural awareness of developers involved in each review.
a dataset of structural architectures extracted from the source code of open source software systems which corresponds to a total of years and months of development time.
ii.
b ackground in an object oriented context structural metrics of cohesion and coupling assess how the code is organised in terms of its structural dependencies between classes and packages.
these dependencies capture compile time dependencies such as method calls data access and inheritance.
in this paper the architectural structure of a system is represented as a module dependency graph mdg .
once the mdg of a system is computed structural cohesion and coupling measurements can be used to assess the system s structure.
in this paper we employ a set of structural metrics for cohesion and coupling measurement that have been quantitatively and qualitatively evaluated in a recent study .
the structural cohesion of the mdg mof a certain system consisting of mpackages p1 ... pm is assessed by measuring the lack of structural cohesion which is computed as lstrcoh m summationtextm j 1lcof pj m wherelcof pjrepresents the lack of cohesion of files for package pj.lcof pjis computed as the number of pairs of files in pjwithout a structural dependency between them.
packages with a high amount of unrelated files will be scoreda highlcof and accordingly packages with only a few unrelated files will be scored a low lcof .
consider a review that changed the system s structural architecture.
lstrcoh is used to measure the cohesion of the system both before m i and after m i the review.
in this case lstrcoh is an inverse metric where a positive difference inlstrcoh m i lstrcoh m i indicates higher lack of cohesion and therefore a degradation in structural cohesion as a result of the review.
similarly a negative difference in lstrcoh indicates an improvement in structural cohesion.
the structural coupling of m strcop is computed as strcop m summationtextm j 1fanout pj m wherefanout pjindicates the number of files outside package pjthat depend on files inside pj.
similarly to lstrcoh a positive difference in strcop m i strcop m i after a review indicates a degradation in structural coupling and a negative difference after a review indicates an improvement in structural coupling.
iii.
e xperimental design the goal of this paper is to study the intent and the architectural awareness of developers when performing architectural changes on a day to day basis.
to this end we ask the following research questions rq1 what are common intents when developers perform significant changes to the architecture?
this research question investigates architectural changes and identifies common intents behind these changes.
thus we classify architectural changes regarding their intent at the time the change was reviewed such asnew feature bug fixing and so on.
using this approach we can perform our analysis on the most recurrent intents thereby achieving a better understanding of the conditions under which architectural changes were performed.
rq2 how often are developers aware of the architectural impact of their changes on a day to day basis?
given the large number of ramifications of an architectural change this research question investigates how often developers are aware of the impact of their changes on the system s structure.
to answer it we inspect changes that had an impact on the architectural structure to identify whether developers discuss the system s architecture during the review of that change.
rq3 how does awareness and intent influence architectural changes on a day to day basis?
considering changes with common intents we assess how the architectural awareness of developers influences the improvement or degradation of cohesion and coupling for each change.
the rest of this section reports the experimental methodology we used to answer the research questions presented above.
a. code reviews data mining code review in modern software development is a lightweight process in which changes proposed by developers are first reviewed by other developers before incorporation in the system.
in this paper we focus on gerrit one authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
of the most popular code review systems currently in use by large open source communities such as eclipse and couchbase .
although we focus on gerrit in this paper the methodology presented here is adaptable and extensible for other code review systems.
in gerrit a developer submits a new patch for review in the form of a git commit where the commit message is used as the review s description and the commit id is stored for future reference.
for each new submission gerrit creates a change id to be used as a unique identifier of that review throughout its reviewing cycle.
other developers of the systems will then inspect the patch and provide feedback in the form of comments.
improved patches are submitted according to the feedback until the review is merged orabandoned where the first indicates the patch was incorporated to the system and the latter indicates the patch was rejected.
for the rest of this paper we use review and change interchangeably to indicate a code submission that was manually inspected by developers and later merged or abandoned.
after selecting the subject systems for our empirical study section iii b we mined the systems code review data from gerrit and downloaded the systems git repositories.
since the goal of this study is to better understand how architectural changes are performed we focus our analysis on the merged reviews.
hence with the aid of the review s original commit id and gerrit s change id we linked each merged review to the commit in the git repository where the review was incorporated1.
moreover we also identify the commit that immediately preceded each review.
finally for each review we collected the author s description of the change the feedback provided by other developers and the commits that represent the state of the system before andafter the review.
b. subjects selection for empirical investigation as we needed systems with a rich review history the number ofmerged reviews was one of the criteria used when selecting the subject systems for investigation.
moreover since our static analysis framework can only be applied to java systems see section iii c we used the proportion of java code in the system as the other selection criteria.
thus we selected the two systems with the most merged reviews and the highest proportion of java code in two open source communities i.e.
egit andlinuxtools for eclipse andcouchbase java client andcouchbase jvmcore for couchbase.
for brevity the couchbase systems will be abbreviated as java client andjvm core respectively.
the consideration of these systems yielded a manual inspection and classification of code reviews highlighting the high level of manual analysis involved in this study.
this high level of painstaking manual analysis is required to form a ground truth which will assist other researchers in subsequent studies facilitating greater automation.
table i reports the number of merged reviews for each system and the time span of the system s history we are investigating.
moreover we also 1in rare cases a link cannot be established and we discarded such reviews.report the proportion of java code for each system and size metrics.
since the proportion of java code and the size of the systems change throughout their history we additionally report median maximum and minimum values for these statistics.
bothegit andlinuxtools are plugins for eclipse where the first is aimed at providing git support in eclipse and the second provides a c c ide for linux developers.
couchbase as a whole is a nosql database solution for both server side and mobile where java client is the official driver to access the couchbase database using java and thejvm core is a low level api mostly used by the java client implementation.
considering the systems we have access to a rich review history with a combined total of years and months of development time.
c. computing the difference in structural cohesion and coupling for reviewed changes for each system selected to participate in our empirical study we computed the difference in structural cohesion and coupling for the changes that have undergone a process of code review as described in section iii a where the formal definitions of the metrics being computed are presented in section ii.
the computation of the difference in structural cohesion and coupling for all code reviews we mined is depicted in the first steps of the framework presented in figure .
for each code review we revert the system to the states before and after the review took place creating two snapshots where the difference between them was induced by the merged review.
we subsequently filter all the test code in the system s code base.
although part of the project test code is not included in the end product and so we chose not to include it as part of the structural architecture.
in this paper we employ a two stage procedure for test code filtering.
in the first stage every file under atest folder is filtered.
next all remaining files with test ortest in the file name are manually analysed by two of the authors where a decision is reached to either include or filter the file from the structural architecture analysis.
after filtering test code we extract the mdg representing the structural architecture of the system for the snapshots before and after the review.
previous studies that performed architecture analyses in java systems relied on bytecode analysis for structural architecture extraction .
however building and compiling the systems for each commit is a time consuming and error prone activity.
hence for this investigation we extract the architectural structure of a system directly from its source code by using understand a commercial tool for static code analysis whose set of features include dependencies extraction and visualisation.
given the system s mdg before and after the review we compute the structural cohesion and coupling as defined in equations and and compare the cohesion and coupling of the system before and after the review.
the measurements of structural cohesion and coupling are separately computed for each package in the structural architecture and then aggregated in an overall score.
hence when comparing the cohesion and coupling for before and after the review we store not only the authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table i descriptive statistics for the systems under study .
w e report the number of merged reviews in each system and the time span of our investigation .
w e report the median maximum and minimum values of size metrics .
systemsno.
of reviewstime span months proportion of ja va code klocnumber of packagesnumber of filesnumber of dependencies med max min med max min med max min med max min med max min egit to linuxtools to jav a client to jvm core to ...code r eviews description comments c1cnsbefore safterar chitecture extractionmdg before mdg afterfor each code r eview c .. cn outliers test filteringsystem s cxcy description comments cohesion couplingcohesion coupling computationsignificant r eviews cohesion coupling fig.
framework for the identification of code reviews with significant changes to the system s architecture.
given a set of code reviews our automated framework identifies significant reviews in terms of the impact to system s architectural structure.
overall difference but also the biggest difference in a single package.
we thus expand our analysis to consider not only changes to the overall structural architecture but also changes that highly affect a single package.
at the end of this process four different values are stored for each review each of which indicate the difference in overall cohesion coupling and the biggest difference in cohesion coupling for a single package respectively.
in this paper we computed the differences in cohesion and coupling for code reviews which generated a dataset of structural architectures automatically extracted from source code.
the dataset of all extracted structural architectures and the respective cohesion and coupling values computed for each review is available at our supporting webpage .
d. identification of reviews with significant architectural changes in order to identify the reviews that performed significant changes to the system s architecture we employed an outlierbased approach.
at first we grouped the set of code reviews according to the following criteria.
we identified all reviews that showed an improvement in overall cohesion followed by all reviews with an improvement in overall coupling.
we then identified all reviews that showed a cohesion improvement for a certain package followed by all reviews with a coupling improvement for a certain package.
similarly we identified all reviews that showed a degradation in the cohesion and coupling measurements presented above.
in total we grouped the reviews on different subsets which stand for the reviews that improve or degrade the cohesion and coupling of either the overall structural architecture or a single package.
next for each of the subsets we identified the outliers using tukey s method and defined the upper outlier fence as1.
iqr interquartile range from the third quartile q3 over the distribution of measurements in the specific subset.
the outliers indicate the reviews with significant differencestable ii number of reviews identified as outliers according to different architectural aspects .
w e report the number of outliers for the reviews with an overall improvement or degradation in cohesion and or co upling .
w e also report the number of outliers for a single package .
the number of unique outliers considers all aspects discussed above .
systemcohesion couplingunique outliersoverall single p. overall single p. egit linuxtools jav a client jvm core all in cohesion and coupling relative to the overall distribution.
table ii presents the number of reviews identified as outliers for each subset discussed above and for each system under study.
additionally since reviews can be identified as outliers in more than one subset we also report the number of unique reviews identified as outliers when considering all subsets.
as one can see from the table reviews were automatically identified as the ones presenting the biggest changes in structural cohesion and coupling indicating that these reviews are the ones that performed significant changes to the systems architecture.
the subset of unique reviews identified as outliers stand for of all reviews with architectural change.
e. manual inspection and classification of reviews following the automated process described in the previous section we considered all outlier reviews and performed a manual inspection and classification inspired by the work of tufano et al.
.
the manual classification process consisted of two authors analysing each review and providing values for a set of tags.
each tag can assume true orfalse and aim at describing a review in two dimensions intent of change authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
andarchitectural awareness.
in order to identify the reviews intent we performed an open coding classification process.
as a starting point we considered the set of tags originally proposed by tufano et al.
during the open coding classification we augmented the set of tags with different intents that emerged from the reviews data in a bottom up fashion.
the final set of tags used in the reviews classification is presented in table iii alongside a short description of each tag.
to assess architectural awareness we rely on the review s description and or comments to ascertain the developers awareness of the architectural impact of the change.
when developers discuss the structural architecture in the review s description or comments we can be certain of the developer s awareness.
however when the architecture is not discussed two scenarios are possible.
in the first scenario developers do not discuss the architecture because they are not aware of the impact of their changes.
in the second scenario developers are aware of the architectural impact but choose not to discuss it during code review.
we are therefore careful to couch over scientific conclusions in the conduct of our analysis which is a conservative safe under approximation of developer awareness.
in this paper our analysis is focused on reviews that performed significant changes to the system s structural architecture.
in this case when the author do not discuss the architecture in the review s description reviewers who are not familiar with the change might not be able to understand its impact in the architecture.
similarly if a reviewer do not raise the architecture discussion during the reviewing process the author of the change might not perceive the ramifications of the change being performed.
in both cases the lack of discussion in regard to the system s architecture during code review will lead to a lack of awareness of some developers involved in the review which will ultimately lead to a poor reviewing process.
therefore the lack of discussion of structural architecture during code review can be used as proxy for the developers awareness regarding the impact of their changes.
in order to mitigate threats to internal validity during the classification process we employed a two stages classification.
in the first stage each author solely inspected and classified the reviews according to a guideline that was discussed reviewed and agreed by all authors.
in the second stage the authors discussed all the reviews for which there was a disagreement in the classification.
for this paper there was no disagreement in any reviews after the second stage of classification.
the set of manually classified code reviews is available at our supporting webpage .
f .
pre study for validation of experimental design we focus on the reviews with significant changes as identified by the outliers.
we assume that reviews with no significant impact on the structural architecture will have fewer discussion as developers may not expect a significant change i.e.
they are aware of the low impact and see no need to discuss it .
moreover we also assume that the structural metrics of cohesion and coupling are indeed capturing changes in structural architecture and not only fluctuations in the system stable iii tags being used in the manual classification of code reviews .
intent of change new feature dev eloper is adding a new feature to the system enhancement developer is enhancing an existing feature or code feature removal developer is removing an obsolete feature platform update developer is updating the code for a new platform api refactoring developer is refactoring the system bug fixing developer is fixing a bug not clear there s no evidence to suggest any of the previous architectural awareness in description architectural impact is discussed in the description in comments architectural impact is discussed in the comments never architectural impact is never discussed size.
to validate these assumptions we performed both a qualitative and a quantitative pre study.
first we assessed whether an analysis of only outliers is suitable to answer the research questions we proposed.
thus we collected all reviews from the couchbase projects including reviews with significant changes see section iii d and reviews with no significant change as identified by the outliers .
on the set of non significant changes we performed an inspection as described in section iii e and identified reviews in which the architecture is discussed .
the ratio is much higher for the reviews with significant changes developers discuss the architecture in out of reviews.
the difference in the two groups of reviews is statistically confirmed by a two tailed pooled test in which the statistical difference is confirmed at the .
level.
it is therefore safe to assume that developers tend to discuss the structural architecture when they expect a significant change.
next we performed an analysis to assess whether structural metrics of cohesion and coupling correlate with size and churn.
in terms of size metrics we used loc number of packages number of files and number of dependencies.
for churn we used number of files changed number of lines changed and number of hunks.
we employed the kendall correlation test and the correlation coefficients were interpreted as proposed by cohen .
for all systems under study structural metrics presented either noorsmall correlation to both size and churn metrics where most of correlation coefficients lie below .
.
an exception was observed when considering structural coupling and number of dependencies where the correlation coefficients for these metrics varied from .
to .
between systems.
this correlation was expected as structural coupling is directly computed from dependencies.
nevertheless structural coupling performs a qualified assessment of the system s structural cohesion as it evaluates not only the number of dependencies as it is but also how dependencies affect each other in an overall fashion.
iv.
e xperimental results this section describes the results we found for each of our research questions.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
a. rq1 what are common intents when developers perform significant changes to the architecture?
table iv reports the number of reviews identified under different intents for the outliers.
most of the reviews that caused a significant change to the system s structural architecture were introducing a new feature to the system followed by enhancement refactoring bug fixing feature removal and platform update respectively.
an interesting observation is that most architecturally significant changes introduce a new feature even though we have found weak correlation between the metrics we used for architectural change and metrics of size and churn see section iii f .
this is expected because new code usually has dependencies to existing code which affects the structural architecture of the system where changes that add modify several lines of code but that do not affect the dependencies will have no effect in the architecture.
a surprising result is that of architectural reviews are classified as bug fixing as one would expect that bug fixing would not alter the system s architectural structure.
after an in depth analysis we noticed that the majority of bugs being fixed in these reviews are bugs that affect the behaviour of the system instead of bugs that simply cause an error or throw an exception.
for these kind of bugs developers had to rework the code so that the system would exhibit the correct behaviour which in turn would result in significant architectural changes.
we found few reviews that performed a feature removal or a platform update in comparison to the other intents.
in fact only and of architecturally significant changes updated the platform or removed a feature respectively.
note that we found a non negligible number of reviews where we could not infer the intent behind the change.
in most of the not clear changes the review had a very short description and no comments from which we could infer the intent.
when considering the most common intents behind the architectural changes i.e.
new feature enhancement refactoring and bug fixing we noticed that of the reviews have more than one intent.
this is also an expected finding since architectural changes are usually large and touch several files at once.
figure iv a presents the number of reviews for each of the most common intents including the number of reviews that share more than one intent.
the biggest intersection occurs between new feature and enhancement.
this happens due to the incremental nature of software development where a system is developed in an iterative fashion and existing features are improved by small increments of new functionality.
according to our manual inspection of the reviews that enhance an existing feature are so by introducing new features and of reviews introducing a new feature also have the intent of enhancing an existing feature.
as an answer to rq1 we found that new feature enhancement refactoring and bug fixing are the most common intents behind architectural changes accounting for of the significant architectural changes we collected and inspected.
moreover of these changes have more than one intent new featur e enhancement refactoring bug fixing .
.
.
.
.
.
.
.
.
.
.
fig.
classification of reviews with significant architecture changes for each of the most common intents.
and of changes enhancing an existing feature do so by adding a new feature.
b. rq2 how often are developers aware of the architectural impact of their changes on a day to day basis?
considering the intents behind architectural changes described in rq1 table v reports the number of reviews with different levels of architectural awareness according to our inspection and classification.
reviews for which the intent is not clear were left out of the analysis.
in total the number of reviews where the architecture is never discussed is higher than the number of reviews where the architecture is discussed in the description comments or both.
this indicates a substantial lack of architectural awareness from developers when performing changes with significant impact to the system s architecture.
for reviews where developers are adding a new feature only in and of the time the architecture was discussed in the description comments or both respectively.
considering enhancements of existing feature the architecture was discussed of the time in the description of the time in comments and of the time in both.
given that these are the most common intents when developers are performing architectural changes see rq1 these results point to an alarming lack of architectural awareness from developers during the changes where the architectural impact is the greatest.
finally for all architecturally significant reviews we could find evidence of architectural awareness in the reviews description comments and both in only and of the reviews respectively.
for the reviews which performed a refactoring to the system the total number of reviews where the architecture is discussed either in the description comments or both is higher than the number of reviews where the architecture is not discussed.
developers were aware of the architectural impact of their refactorings in of the cases.
we noticed that most of the reviews with a refactoring intent but no architectural awareness were removing dead code.
dead code removal is indicated as an architecturally significant change because of the amount of apparent static dependencies usually removed by such operations.
however this is a straightforward operation in which its impact to the system as a whole is minimum and only apparent dependencies are removed by definition.
as an answer to rq2 by inspecting and classifying reviews that performed significant architectural changes we authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table iv num ber of reviews that performed architecturally significant changes grouped by different intents .
systemsnew featur efeature enhancementfeature removalplatform updaterefactoring bug fixing not clear egit linuxtools jav a client jvm core all systems table v number of reviews for each intent where the architecture is not discussed is discussed only in the review s description only in its comments or in both .
intentdiscussion awareness none description comments both new feature enhancement featur e removal platform update refactoring bug fixing total found that developers were aware of the impact of their change in only of the time.
although being one of the most common intents when performing architectural changes reviews that add a new feature or enhance an existing feature present a poor level of architectural awareness.
finally developers present a high level of awareness when refactoring the systems where the architecture is discussed in the reviews description comments or both in of the cases.
c. rq3 how does awareness and intent influence architectural changes on a day to day basis?
table vi reports the number of reviews that either improved or degraded the cohesion and coupling of each system under study for different intents.
in rq1 we showed that there is a considerable overlap of reviews introducing a new feature and reviews enhancing existing features.
therefore since both these intents are concerned with augmenting and improving the system s features we combined these two intents under feature in table vi.
finally we consider under awareness all reviews in which the structural architecture was discussed in the review s description or comments as absolute numbers and as percentage of the total number of reviews .
consider the coupling degradation of egit for example.
when the intent was to add a new feature and or enhance a feature we found reviews where the change led to a degradation of either the overall coupling of the system or the coupling of a single package.
for reviews corresponding to the architecture was discussed during the review.
similarly we identified a total of reviews that improved the coupling oflinuxtools through refactoring.
however in only of these the architecture was discussed.
when one compares the reviews that improve cohesion coupling to the reviews that degrade cohesion coupling developers tend to be more aware of the architectural impact when theirchanges have a positive effect.
this indicates that developers are often not aware of the impact of their changes when they are degrading the structural architecture.
moreover most of the reviews identified as performing significant archiectural changes caused a degradation in the systems structural cohesion and coupling.
this is arguably the moment which developers should be mostly aware of the architectural impact of their changes since poor architectural decisions might lead to bug proneness and increased maintenance effort .
considering only the reviews in which a refactoring was performed this behaviour is not so pronounced.
based on our inspection developers tend to have a similar level of awareness when the cohesion coupling of the system is both improved and degraded.
as an example we found that developers of linuxtools are aware of the architectural impact in and of the refactorings that improved and degraded the system s cohesion respectively.
this is a counterintuitive finding as one expects that refactorings should lead to improvements instead of degradations.
in order to shed light into this issue we present two examples of refactorings in which developers were aware of the architecture but the change resulted in a degradation of the system s structural architecture.
in review of linuxtools the author of the change describes the refactoring as internalize remaining classes.
they were not exported so not a real change which clearly indicates an attempt of structural improvement.
for this purpose a set of files were moved from their original package to an internal package.
as a result the cohesion of the original package was improved but the amount of dependencies the files had to other files in the system caused a degradation of overall coupling and overall cohesion.
this is an example of a developer who although being aware of the system s structural architecture and having the intent of refactoring it failed to do so.
this is an indication that even with the intent of improving the system s architecture developers sometimes are not able to see all the ramifications of their architectural changes.
review of linuxtools in another example where the author described the refactoring as move input validators to where the y are actually used .
in this case the developer is also performing an improvement to the code base but this time the reasoning behind the change seems to be semantical rather than structural.
hence the author moved two validators files from thevalidators package to a package with files that use the the validators functionality.
due to the number of dependencies the validators have to their original package this change caused a degradation in both the structural cohesion authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table vi number of reviews that either improved or degraded the systems cohesion and coupling for different intents and the subset of reviews with signs of awareness .
system intentcohesion coupling improvement degradation improvement degradation total awareness total awareness total awareness total awareness egitfeature refactoring bug fixing linuxtoolsfeature refactoring bug fixing java clientfeature refactoring bug fixing jvm corefeature refactoring bug fixing and structural coupling of the system.
with this example we provide evidence that developers consider not only structural cohesion and coupling but also other aspects when carrying out architectural changes.
such observation is aligned with findings reported in previous empirical studies .
in order to assess the effect that architectural awareness has on the improvement and degradation of structural cohesion and coupling we report in figure the distribution of cohesion and coupling for reviews we found evidence of architectural awareness and for reviews where we did not.
we report boxplots for both egit andlinuxtools because these are the systems with the largest number of architecturally significant reviews.
for each system we computed box plots.
first we report the distribution of cohesion and coupling for the reviews that improved or degraded the overall cohesion and coupling of the system.
next we report cohesion and coupling for the reviews that improved or degraded the cohesion and coupling of a single package in the system.
in all box plots smaller values of cohesion and coupling are more desirable for the system s structural architecture.
consider the box plots that depict the distribution of cohesion and coupling for the reviews that improved either the system s overall cohesion coupling or the cohesion coupling of a single package.
in every case a b e f i j m n the reviews in which the architecture was discussed presented larger improvements in structural cohesion and coupling.
when looking at egit in particular reviews with evidence of architectural discussion presented considerably larger improvements to the system s overall cohesion and overall coupling as can be seen in boxplots a and b respectively.
when considering the reviews that degraded the system s cohesion and coupling we found two cases in which the reviews with evidence of architectural discussion caused less degradation than reviews in which the architecture was not discussed.
in the first one g reviews with architectural discussion caused less degradation to single packages of egit than their counterparts with no architectural discussion.
a similar behaviour was identified for the reviews that degraded the overall cohesion of linuxtools .
however this did not replicate to the other cases where both reviews withand reviews without architectural discussion had a similar degradation in cohesion and coupling.
the observations from the box plots provide evidence that architectural awareness has a positive effect in the cohesion and coupling of the systems for the reviews in which the structural architecture was improved.
however for reviews that degrade the system s architecture apart from specific cases architectural awareness does not have a noticeable effect in the actual degradation caused by the review.
in summary we found that the architecture is more often discussed in the reviews that improve the cohesion and coupling of the system when compared to reviews that degrade the cohesion coupling.
differently the architecture is similarly discussed in reviews that perform a refactoring.
moreover we found evidence that refactorings that degrade the systems cohesion coupling are not caused only by poor implementation but also by the fact that developers may consider other properties when performing refactorings.
finally by assessing the distribution of cohesion and coupling of the reviews we studied we noticed that reviews in which we found evidence of architectural awareness tend to present larger improvements in cohesion and coupling when compared to reviews where the architecture was not discussed.
as an answer to rq3 architectural awareness is mostly found in reviews that improve the system s architecture where the architecture discussion often leads to larger improvements in cohesion and coupling in these reviews.
the results for rq1 lead to actionable findings for tool builders practitioners and researchers.
we have observed that architectural awareness during code review leads to better architectural changes.
thus tool builders should provide plugins for code review systems that will automatically identify significant architectural changes and make the reviewers aware of the architectural impact of the change.
practitioners should understand the importance of discussing the system s architecture when performing architectural changes and more importantly adopt tools to assist in this dicussion.
finally researchers can use code review not only to study architectural changes but also as technique to perform architectural improvements and prevent architectural degradation.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
aware not aware a improvement of overall cohesion .
.
.
.
aware not aware b improvement of overall coupling aware not aware c degradation of overall cohesion .
.
.
.
.
aware not aware d degradation of overall coupling aware not aware e improvement of single cohesion aware not aware f improvement of single coupling aware not aware g degradation of single cohesion aware not aware h degradation of single coupling .
.
.
.
.
aware not aware i improvement of overall cohesion .
.
.
.
aware not aware j improvement of overall coupling .
.
.
.
aware not aware k degradation of overall cohesion .
.
.
aware not aware l degradation of overall coupling aware not aware m improvement of single cohesion aware not aware n improvement of single coupling aware not aware o degradation of single cohesion aware not aware p degradation of single couplingegit linuxtoolsfig.
distribution of cohesion and coupling for reviews where we found evidence of architectural awareness and for reviews where we did not.
we report box plots for the reviews that improve and degrade the overall cohesion coupling of the system and also for the reviews that improve and degrade the cohesion coupling of a single package in the system.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
v. t hreats to the va lidity internal validity we use a metric based approach to automatically identify reviews that performed significant changes to the system s structural architecture.
using this approach one cannot guarantee all architecturally significant reviews were inspected.
to alleviate this threat we performed a pre study in which we inspected all reviews from the couchbase systems that presented any change to structural cohesion and coupling.
with statistically significance at the .
confidence level we showed that the number of reviews discussing the architectural impact among the reviews with significant changes is higher than among those with negligible changes.
the metrics of structural cohesion and coupling we used are based on structural dependencies between files in which differences in size might affect the cohesion and coupling measurement.
in our pre study we collected size and churn metrics of all systems and performed a correlation analysis with the cohesion and coupling metrics we employed.
most of the correlation coefficients were identified as low or medium which is aligned with what is usually expected from objectoriented metrics computed from source code .
the low and medium correlation indicates that the cohesion and coupling metrics we employed are indeed capturing changes in structural architecture of the system and not only size fluctuations.
manual classifications are naturally subjective to bias.
to mitigate this threat we employed a two stage manual classification procedure.
in the first stage all reviews were separately classified by two authors following a strict guideline previously discussed and agreed by all authors.
in the second stage for all reviews in which a disagreement was found both authors discussed the review until a unified classification was reached.
external validity our study focuses on four java projects which we carefully chose so that we could study them in detail both quantitatively and qualitatively.
however the results may not be generalisable to projects in other languages.
the analysis of the systems architecture is based on structural metrics of cohesion and coupling.
one might expect different results using different metrics.
however we rely on structural cohesion and coupling since they are widely adopted for architecture analysis and have been thoroughly evaluated in previous studies .
vi.
r elated work tufano et al.
performed an empirical study to understand the lifecycle of code smells in software projects.
they manually inspected and classified commits in regard to commit goal project status and developer status.
while their classification is mostly based on commit messages and patches the code review process adopted in our analysis provides a richer set of artefacts for each software change.
besides having access to each commit and patch a review also includes feedback provided by other developers and often links to tickets in the issue tracking system and links to related reviews performed in the past.
as such during our manual inspection we extend tufano et al.
s classification of the commit goal to include a wider set of intents we found during our open coding analysis.several studies have been performed to qualitatively evaluate the developer s perception of cohesion and coupling metrics.
simons et al.
prepared a set of toy examples and surveyed developers to assess whether metrics represent the developer s perception of quality.
bavota et al.
and candela et al.
also surveyed developers with the same purpose where in this case the questionnaire was focused on selected past changes.
by inspecting code reviews we are able to assess developers intent and awareness on a day to day basis focusing on how developers perceive the architectural changes at the time these changes are being reviewed.
as a result we can study the developers behaviour for each different architectural change in particular without the bias of interviews that involve toy systems or past changes.
recent studies have evaluated different metrics of structural cohesion and coupling as suitable measurements for architectural quality.
in a context of search based software modularisation paixao et al.
compared the modularisation developers implemented in their systems against baselines generated by different search procedures.
in a similar setting cinn ide et al.
evaluated a set of structural cohesion metrics for automated refactoring.
although providing quantitative evidence on how structural cohesion measurement can be used to improve software systems these work lack a qualitative analysis to better understand how developers perform architectural changes on a day to day basis.
vii.
c onclusion architectural decisions have large implications on the development and evolution of software systems.
in this context a better understanding of how developers perform architectural changes on a day to day basis is required as a foundation for the improvement of automated decision support tools.
thus we performed an empirical study that involved the inspection and classification of architectural changes mined from software systems.
we limited our study to reviews with good quality description and feedback provided by developers.
after analysing reviews that performed significant changes to the system s structural architecture we found that the architecture is only discussed in of the reviews we studied which indicates a lack of architectural awareness when performing significant architectural changes.
nevertheless developers tend to be more often aware of the architecture when the change is actually improving the system in terms of cohesion and coupling.
finally we noticed that changes in which developers are aware of the architectural impact tend to present larger improvements in cohesion and coupling than changes where the architecture is not discussed.
such observation indicates that architectural awareness during code review has the potential to aid developers on their day to day activities.
hence we lay as future work the automation of architectural analysis during code review time where authors and reviewers would automatically be made aware of the architectural impact of their changes.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.