custodes automatic spreadsheet cell clustering and smell detection using strong and weak features shing chi cheung wanjun chen yepang liu and chang xu dept.
of computer science and engineering the hong kong university of science and technology hong kong china state key lab for novel software technology and dept.
of computer sci.
and tech.
nanjing university nanjing china scc wchenah andrewust cse.ust.hk changxu nju.edu.cn abstract various techniques have been proposed to detect smells in spreadsheet s which are susceptible to errors .
these techniques typically detect spreadsheet smells through a mechanism based on a fixed set of patterns or metric thresholds.
unlike conventional programs tabulation styles vary greatly across spreadsheets.
smell detection based on fixed patterns or metric thresholds which are insensitive to the varying tabulation styles can miss many smells in one spreadsheet while reporting many spurious smells in another.
in this paper we propose custodes to effectively cluster spreadsheet cells and detect smells in these clusters.
the clustering mechanism can automatically adapt to the tabulation styles of each spreadsheet using strong and weak features.
these strong and weak features capture the invariant and variant parts of tabulation styles respectively.
as smelly cells in a spreadsheet normally occur in minority they can be mechanically detected as clusters outliers in feature spaces.
we implemented and applied custodes to spreadsheets files randomly sampled from the euses corpus .
these spreadsheets contain formula cell clusters.
experiment al results confirmed that custodes is effective.
it successfully detected harmful smells that can induce computation anomalies in spreadsheets with an f measure of .
outperforming stateof the art techniques.
ccs concepts software and its engineering software creation and management software verification and validation software defect analysis software testing and debugging applied computing computers in other domains personal computers and pc applications spreadsheets.
keywords spreadsheets cell clustering smell detection feature modeling end user programming.
.
introduction spreadsheets are a popular computation paradigm used for data storage and analysis decision support financial reporting and quality control .
despite their popularity spreadsheets are shing chi cheung and chang xu are the corresponding authors.
found to be error prone .
conventional quality assurance measures for software such as unit tests and assert statements are generally inapplicable to spreadsheets.
to improve spreadsheet quality researchers have proposed various quality assurance techniques among which smell detection draws much attention.
the concept of spreadsheet smell is inspired by code smell which was originally introduced by fowler .
in conventional programs code smells refer to those bad designs that are not necessarily errors themselves but likely degenerate into faults in subsequent program development and maintenance.
in the spreadsheet domain researchers study smells mainly from two perspectives.
one is to apply the conventional principles of code smells to spreadsheets .
formula cells with complexity exceeding certain pre defined metric thresholds are detected as smells in the sense that they hinder spreadsheet understanding.
the other is to consider spreadsheet specific characteristics such as statistical properties of data and computation semantics of formulas .
from the latter perspective spreadsheet smells usually refer to the discrepancies between a group of similar cells that are usually neighbors.
there is so far no systematic way to characterize smells in spreadsheets and address the problem uniformly.
users need to apply various techniques individually under different settings and validate their results one by one.
moreover smells detected as violations of pre defined patterns or metric thresholds fail to adapt to diverse tabulation styles which reflect different user formula design practices and application domains.
as a result the smell detection can miss many smells in one spreadsheet while reporting many spurious smells in another.
we made two observations from the existing literature on spreadsheet smells.
one is that the studied smells are mostly related to formulas.
these smells occur at formula operations cell