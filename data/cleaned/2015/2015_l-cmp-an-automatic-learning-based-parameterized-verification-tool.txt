l cmp an automatic learning based parameterized verification tool jialun cao the state key laboratory of computer science institute of software chinese academy of sciences university of chinese academy of sciences beijing china caojl ios.ac.cnyongjian li the state key laboratory of computer science institute of software chinese academy of sciences beijing china lyj238 ios.ac.cnjun pang faculty of science technology and communication interdisciplinary centre for security reliability and trust university of luxembourg esch sur alzette luxembourg jun.pang uni.lu abstract this demo introduces l cmp an automatic learning based parameterized verification tool.
it can verify parameterized protocols by combining machine learning and model checking techniques.
given a parameterized protocol l cmp learns a set ofauxiliary invariants and implements verification of the protocol using the invariants automatically.
in particular the learned auxiliaryinvariantsarestraightforwardandreadable.theexperimental results show that l cmp can successfully verify a number ofcache coherence protocols including the industrial scale flash protocol.
the video presentation of l cmp is available at https youtu.be 6dl2hiiis4e and the source code can be downloaded at ccs concepts theoryofcomputation verificationbymodelchecking keywords parameterized verification model checking association rule learning machine learning acm reference format jialuncao yongjianli andjunpang.
.l cmp anautomaticlearningbased parameterized verification tool.
in proceedings of the 33rd acm ieeeinternationalconferenceonautomatedsoftwareengineering ase september montpellier france.
acm new york ny usa 4pages.
introduction parameterized concurrentsystems inparticular cachecoherence protocols exist in many practical applications .
verifying such corresponding author permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe firstpage.copyrights forcomponentsof thisworkowned byothersthan the author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspecificpermission and or a fee.
request permissions from permissions acm.org.
ase september montpellier france copyright held by the owner author s .
publication rights licensed to acm.
acm isbn ... .
has attracted considerable academic interests due to its practicalimportance .aparameterizedprotocol p n contains nhomogeneousnodes seesub figure a infigure sometimes also contains a heterogeneous node e.g.
flashprotocol contains a home node seesub figure c infigure .thetargetistoverify that the properties are satisfied for arbitrary sizes of instances.
although the correctness of fixed number of instances can be proved their correctness cannot imply the correctness of protocols of arbitrary sizes.
this problem has been proved to be undecidable .
toaddressthisproblem manyapproacheshavebeenproposed .
among them parameterized abstraction and guardstrengthening method alsoknownascmp hasbeen widely applied to verify large scaled and industrial protocols including intel s chipset and flashprotocols .
the main idea of cmp is to construct an abstract protocol ap m mis usually or .apcontainsmnormal nodes plus an abstracted node other whichsimulatesthebehavioroftherestnodes.aswecanseefrom figure1 insub figure b mis2 becauseonly homogeneousnodes in protocol a while in sub figure sub figure d mis set to be becausethereisaheterogeneousnode homeinsub figure c .in general apmay fail to satisfy the desired properties because it is too permissive soresearchers need tocome up manually withasetofauxiliaryinvarianttorestrictitsbehavior.however to construct auxiliary invariants manually is often error prone especially when the protocol description is large and complex .
figure1 differenttypesofparameterizedprotocolsandcorresponding abstracted protocols after cmp inthis paper weproposel cmp which canautomaticallylearn auxiliary invariants abstract and strengthen the parameterized protocolsinaunifiedframework.withl cmp asetofauxiliaryinvariantscanbelearnedfromthereachablestatesetsoftheinstances authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france jialun cao yongjian li and jun pang of protocols and be applied to verify the protocol automatically.
the soundness of l cmp is guaranteed in .
figure the envisioned users a distinguished novelty of our tool lies in two aspects.
firstly the combination of association rule learning and parameterized verification automates the verification process and expands the applicationareaofmachinelearningalgorithms.itmayalsoshed somelightonthefurthercombinationofthesetwoareas.secondly the invariants it obtains can not only help to automate the verification but also provide deep insights for researchers to better understand the mechanism of protocols because the form of these invariants are straightforward and understandable.
therefore our envisioned users are protocol designers and researchers who want togainbetterunderstandingandinsightsofprotocols andbusiness analystswhowanttocheckthecorrectnessofpracticalprotocols see figure .
related works there have been many studies who tried to address the problem of parameterizedverificationwiththeaidofcomputer.arons etal.proposedtheconceptof invisibleinvariants whicharecomputedina finite system instance to aid inductive invariant checking .
conchonetal.cameupwiththebrabalgorithmwhichisimplemented in an smt based model checker.
it computes over approximations of backward reachable states that are checked to be unreachablein the parameterized system .
liet al.
proposed a method to automatically generate auxiliary invariants from a small reference instanceofprotocolsandconstructaparameterizedformalproof in the theorem prover isabelle .
compared with these works l cmpprovidesasimplerwaytoverifyparameterizedprotocols andtheauxiliaryinvariantsitobtainsaremoreunderstandableand straightforward.
an overview of l cmp thearchitectureofl cmpisshowninfigure .wecanseethat there are two main phases in the framework.
the first phase is regardedasthe learningphase.itreceivesaparameterizedprotocol written in the input language of the model checker murphi and returns a set of auxiliary invariants.
this phase consists of threeparts.
preprocessor utilizes murphi to enumerate the reachableset of the instance of protocols and transforms it into a dataset consistingofnumericvectors.then learnerlearnsassociationrules fromtheconstructeddataset.notethatthelearnedassociationrules are not necessarily invariants so selectoris executed with the help of murphi to select invariants.
after selection what remained is regarded as auxiliary invariants and will be used in the second phase.thesecondphaseisan advancedcmp phase.unlikecmp whose strengtheningprocesscomesafterabstraction theadvancedcmpcarriesoutstrengtheningprocessbeforeabstractionsothatmorepredicatescan beadded intoguardof rules.phasetwo alsoconsists of threemainsteps.
strengthener strengthenstheguardofeachrule using auxiliary invariants.
it is noteworthy that not all auxiliary invariantswillbeusedinthisstep andoncesomeofthemareused theywillberecordedandverifiedinthefinalstep.next abstractor abstractslocalvariablesintherules.afterthisstep anabstracted protocolisgeneratedanditwillbesubjectedtomurphitogether with the used auxiliary invariants.
if it passes the model checking then l cmp comes outputs the result.
otherwise parameters in learnerwill be adapted and the next round of execution will start.
figure the architecture of l cmp implementation details .
phase one givenaparameterizedprotocolinthemurphilanguage thefirst step is to generate the reachable set of its instance.
we use murphi tocomputethe reachableset whichcanwrite allreachablestates atleastonce.ingeneral weassumethattheprotocolcontainsonly homogeneous nodes so the size ofinstance is set tobe .
if there is a heterogeneous node in the protocol e.g.
the flashprotocol thenthesizeofinstancewillbesettobe3 includingtwonormal nodes and one homenode.
note that there are two possible forms to represent parameters digits i.e.
or labeled type names i.e.
node 1 node 2 where node isauser defineddatatype .
the first form is the ordinary expression and the second form is used when the protocol applies symmetry reduction to reduce the searchingspace.l cmpwillrecordtheformofparametersanduse it as identifiers.
then the reachable set is transformed into a new dataset.
we extract atomic predicates from the guard of rules and properties.
thisstepiscrucialbecausewithoutitthefollowinglearningprocessmaynotbeabletoobtainsufficientauxiliaryinvariants.we also build a map to record all the possible values for each variable.
according to the atomic predicates the reachable set can be transformedintostatevectorswhichcontainonlypredicates.tobemore specific if the predicate holds at one state then we can add the original predicate to the state.
otherwise the negative form of the predicate will be added.
note that because of symmetry reduction the value of some variables could be undefined meaning that the value of the variable is unknown.
in this case whether the predicateholdsinthatstateisunknown sothepredicatewillbe deleted from the corresponding state.
after this step we acquire a authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
l cmp an automatic learning based parameterized verification tool ase september montpellier france newdatasetconsistingofrecords whereeachrecordrepresentsa reachablestateinthereachableset andthelengthofrecordsare not necessarily the same.
theassociationrulelearningisappliedtothedatasetinthethird step.association rulesare strongrelations betweenitemsin large databases.
assume that a database contains records each of which includesseveralitems thenthelearningresultwillbetherelations in the database in the form of where and are sets of items.inourcase therecordsinthedatasetarealreadyconstructed whileitemsofassociationrulelearningarecorrespondenttothe predicatesintherecords.toimplementassociationrulelearning thereareseveralalgorithmssuchaseclatandfp growth.inthis paper we apply the apriori algorithm because it is more convenient to constrain the size of frequent set.
the frequent set is a set ofitemsthatfrequentlyappearsinthedataset.wesetthesizeofthe frequentsettobeatmost k wherekisaparameterthatisinitially set to be .
it may be fixed according to the subsequent steps.
note that the minimum support and minimum confidence in apriori are also parameters which are set to be .
and .
respectively.
figure the process of minimizing association rules the number of learned association rules is generally large so weneedasteptominimizeit seefigure .therearetwopossible forms of parameters as mentioned above so we need to replace themwithaunifiedform.wereplaceparameterswith p1 p2inthe orderofappearance.thisiswhythe node 2 ofsecondstatement in top left of figure 4will be replaced by p1.
moreover those symmetrical association rules will be unified as one.
note thatsome of association rules are axiomatic but useless see the first association rule in the top of figure so they will be removed.
then the parameterizedassociation rules will be instantiatedby i andj respectively.finally webuildadictionarytorecordallthe left sides of association rules which have same right side.
for each right side we build an index to represent all the left sides.
note thateachleftsideisaset.ifoneleftsideisthesubsetofanother then the index of that larger set will be removed.
for example if association rules p randp q rare obtained then after this step only p rwill remain.
selector as its name implies selects auxiliary invariants from theassociationrules.thisstepneedsthehelpofmurphi.although it is impossible to verify all the association rules for protocols with arbitrary sizes we can check them in several small instances.
to realizeit weconstructatranslatorwhichtranslatestheassociation rulesinto themurphi language so thatwe checkthem inmurphi.
then these translated association rules together with the original instancefromwhichthereachablesetcalculatedaresubjectedto figure the process of selecting auxiliary invariants murphi.wheneveranassociationrulefailstopassthemodelchecking step l cmp removes it and continues to check the rest.
when alltheremainingassociationrulespasstheverification l cmpwill increase the size of instance and repeat the above process.
this selectionstepproceedsuntilnoassociationrulescanberemoved or the searching space is getting too large.
note that we apply multiprocessing to accelerate this step as shown in figure each processchecksapartofassociationrules andreturnswhethertheypasstheverification.thenthemainprocessorcollectsalltheresult andremovesthefailedonesfromtheassociationruleset.finally theremainingassociationrulesareregardedasauxiliaryinvariants.
.
phase two before going into details we need to elaborate the structure of protocolrules.aruleconsistsoftwomainparts guardandaction.
if the predicates in guard are satisfied the statements in action canbeexecuted.aswecansee theguardisaconjunctionofpredicates whiletheauxiliaryinvariantsareinformof where are sets of predicates.
thus it is straightforward to add the conclusion i.e.
ofauxiliaryinvariantstotheguardofrulesifitsantecedent i.e.
is a subset of the guard.
this strengthening step iterates until no more predicates can be added into the guard.
ruleset parameters definition do for example i node rule rule name guardpart conjunction of predicates actionpart a set of statements endrule endruleset phase2startsatpartitioningtherulesintofourparts definition rulename guardandaction.thenweparsetheguardintopredicatesandexecutetheabove mentionedstrengtheningprocess.theauxiliary invariants which are used to strengthen the guard will be recorded.
besides a dictionary is exploited to map the antecedents ofusedauxiliaryinvariantstothecorrespondingconclusions.next the abstraction step is implemented by removing the predicatesand statements relating to parameters in the definition part.
forexample if a rule has two parameters iandj at first we remove thoserelatedtoparameter iandgeneratethefirstabstractedrule anddothesameforparameter j.further thoserelatedtoeither ior jare all removed and a third new rule is generated.
hence if a rule has one parameter then after strengthening and abstraction steps itwillgenerateatmostonenewrule.whileifithastwoparameters the answer will be three.
it is noteworthy that if the right side of a statement is about to be abstracted then the dictionary we build previously will be used to check whetherthe right part is a key.
if it is a key then it will be replaced by its corresponding value.
this process prevents the loss of data during abstraction.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france jialun cao yongjian li and jun pang tool usage hereisanexampleshowinghowl cmpworks.afterdownloading l cmpandinstallingmurphiandpython itisimportanttoinlcudethepathtomurphiintothefile murphi url.txt .weprovideseveralprotocolsinl cmp.thehelpdocumentisillustratedinfigure .t o verifyflash forexample wecansimplytype python3main.py p flash n and the verification will be executed automatically.
becauseflashis fairly large so it takes some time to verify.
after it finishes the result will be printed out and several important files such as verified protocols association rules auxiliary invariants and other backup files will be saved in the corresponding folder.
figure the help document of l cmp experimental evaluation weappliedl cmptoseveraltypicalparameterizedprotocols.among them moesi mesi mutualexclusion abbrv.mutualex mutualexclusion with data abbrv.
mutdata are small scale protocols while germanandflashprotocolsaremorecomplicated1.thesizeof instance for most protocols is set to be while for flash i ti ss e t to be .
table experiment results protname states assorules auxinvs usedf time s result moesi .
check mesi .
check mutualex .
check mutdata .
check german .
check flash .
check the experimental results for each of these protocols are summarized and presented in table .
each record includes protocol name sizeofreachablesets numberofassociationrules numberof auxiliary invariants number of used auxiliary invariants running time andresult.wecanseefromthetablethatreachablesetsofthefirstfourprotocolsarerathersmall followedby german whilethe reachablesetof flashisenormouscomparingwith theprevious 1the version of germanandflashprotocols we use are the same as those used in chouet al.
s work ones.
as for running time almost the first five protocols can be verifiedwithinaboutoneminute whereas flashtakesabout11 hours.mostofthetimeisspentonselectingauxiliaryinvariants fromassociationrules.thisprocesscanbeacceleratedbyallocating more processors to l cmp.
if we allocate processors to l cmp the total running time for verifying flashis approximate hours.
concluding remarks in this paper we present an easy to use tool l cmp which can verifyparameterizedprotocolsautomatically.itprovidesstraightforward and understandable invariants.
besides it also has solid theoreticalbackground.theverificationresultsoftypicalbenchmarks are reported in detail.
experiments demonstrate both feasibility and effectiveness of l cmp.
in the future we plan to extend the ability of l cmp to verify more general safety and liveness properties.