descartes a pitest engine to detect pseudo tested methods tool demonstration oscar luis vera p rez inria rennes bretagne atlantique rennes france oscar.vera perez inria.frmartin monperrus kth royal institute of technology stockholm sweden martin.monperrus csc.kth.sebenoit baudry kth royal institute of technology stockholm sweden baudry kth.se abstract descartesisatoolthatimplementsextrememutationoperatorsand aimsatfindingpseudo testedmethodsinjavaprojects.itleverages the efficient transformation and runtime features of pitest.
the demonstrationcomparesdescartes withgregor thedefaultmutationengineprovidedbypitest inasetofrealopensourceprojects.
it considers the execution time number of mutants created andthe relationship between the mutation scores produced by both engines.
it provides some insights on the main features exposed by descartes.
ccs concepts software and its engineering software testing and debugging keywords pseudo testedmethods extrememutation mutationtesting software testing pitest acm reference format oscarluisvera p rez martinmonperrus andbenoitbaudry.
.descartes a pitest engine to detect pseudo tested methods tool demonstration.
in proceedings of the 33rd acm ieee international conference on automated software engineering ase september montpellier france.
acm newyork ny usa 4pages.
introduction mutation analysis or mutation testing evaluates the fault detectioncapabilitiesofatestsuite.itdoessobyinsertingartificial bugs in the form of subtle code changes.
then it verifies if the test suite is able to detect those changes.
the usual outcome from this analysis is the mutation score that is the ratio of planted faults mutants that has been detected to the total of mutants created.
niedermayr and colleagues recently introduced extreme mutation analysis.
it is an alternative to traditional mutation that performsmore coarse grainedtransformationsby eliminating at once all side effects of a method.
for a voidmethod this approach removes all instructions from its body.
if the method is not void then the body is replaced by a single returninstruction with a permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september montpellier france association for computing machinery.
acm isbn ... .
1showsasimplejavamethodandlisting 2shows two variants or mutants that could be created for this method using extreme mutation in this case with constants and .
besides removing all side effects the technique ensures that the mutated method will always return the same value.
extreme mutation addresses two challenges of the traditional approach.itcreatesmuchlessmutantsandcanautomaticallyavoid most transformations that could be equivalent to the original code.
thesetwoaspectsareusuallyquotedasdrawbacksthatpreventthe wideuseofmutationtestinginpractice .anotherbenefitof thisapproachisthatitoperatesatthemethodlevelwhicheasesthe understandingoftheunderlyingtestingproblem.inadditiontothe mutationscore extrememutationpinpointsalistofworsttested methods.inparticular thetechniquehiglightsmethodsexecuted by the test suite but where no extreme mutant is detected while runningthetests.thesemethodsarelabeledaspseudo testedin the work of niedermayr et.
al.
.
inthisdemonstration wepresentdescartes anextrememutationengineforpitest astate of the artmutationtestingtool for java projects.
pitest is a popular tool that works with all major buildsystems ant gradle mavenandcanhandlejunitandtestng test suites.
descartes brings a set of extreme mutation operators topitestanddiscoverspseudo testedmethods.wealsocompare theresultprovidedbydescarteswiththeoutcomeofgregor the default mutation engine for pitest.
our goal is to determine if extrememutationcanbeusedasaviabletrade offbetweencode coverage which assesses only test inputs and traditional mutation analysis whichalsoaddressestheoraclesbutataveryhighcost.
thisisanovelcontributionwithrespecttotheworkofniedermayr et al whose focus is on checking whether code coverage is a good indicator of test quality when discerning between system and unit tests.
original method public static long factorial int n if n return long result for int i i n i result i return result listing a simple java method.
extreme mutant public static long factorial int n return extreme mutant public static long factorial int n return listing two mutans created with extreme mutation.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france oscar luis vera p rez martin monperrus and benoit baudry an overview of descartes descartesisatooltoautomaticallydetectpseudo testedmethods in java programs tested with junit test suites.
this detection relies on extreme mutation analysis.
we implement this analysis as a mutationengineforpitest.inpitest sjargon amutationengineis apluginthathandlesthediscoveryandcreationofmutants.such apluginshouldalsomanageasetofmutationoperators whichare models of the transformations to be performed.
our extreme mutation engine provides a set of configurable mutationoperators.amutationoperatorisconfiguredbyspecifying the literal value it should use to modify the method.
descartes supportsliteralsofalljavaprimitivetypes strin thenullvalue and has two special operators one to target voidmethods and another to return an empty array where possible.
the engine does not mutate constructors.
figure1illustratestheinteractionbetweenpitestanddescartes.
pitesthandlestheinspectionofthetargetprojecttodiscoverall dependencies creates execution units composed by the mutants and the tests to be executed and ultimately runs the test cases.
themutationengineleveragesallthesefunctionalitiesandhandles mutant discovery and creation.
relying on the infrastructure and architecture of pitest allowed us to speed up the development of descartes and its adoption in production.
so far the biggest challenges we have faced have been the lack of documentation describing how to create mutation enginesforpitest thedesignandimplementationofmeaningful mutation operator abstractions and their interaction with the rest ofthepitestframework maintainingtheengineuptodatewiththeregularchangesandreleasesofpitest makingthetooluseful to developers.
to overcome this last challenge we have augmented descartes with custom reporting capabilities and functionalities toreducethenumberofpotentialfalsepositives forexample we provide method filtersbased onthe methodstructurerather than its signature.
to the best of our knowledge descartes is the only available alternative to the default engine provided by pitest.
our project couldbeusedasanadditionalsupportingmaterialforthosewho are willing to create their own extensions.
descartes vs gregor gregor is the default mutation engine for pitest.
it provides most traditionalmutationoperators1.theseoperatorsworkattheinstruction level.
listing 3shows examples of the transformations thatcanbeproducedbygregoroverthemethodexposedinlisting1.
the first variant of the method shown in line 2negates the condition in line .
the second variant shown in line modifies the return value by adding in line .
mutant .
changes by !
public static long factorial int n if n!
return long result for int i i n i result i return result gregor mutant .
changes the result value by adding 1the full list is available here public static long factorial int n if n return long result for int i i n i result i return result listing examples of mutants produced by gregor.
wecomparetheexecutionofgregoranddescartesinaselection ofjavaprojects.theseareallprojectsthatusemavenasmainbuild system junitasmaintestingframeworkandareavailableforma version control hosting service mostly github.
table2showsthemetricsrecordedforthecomparison.foreach mutationenginethetableshowstheexecutiontimeandnumber of mutants created.
the covered columns show the number of mutants actually executed by the test suite and planted in methodsthatweremutatedbybothengines.thisdistinctionremoves fromthecomparisonmutantsthatgregor maycreateinmethods not analyzed by descartes and vice versa.
for example mutants createdinconstructorsareleftout.the killed columnscontain the number of mutants from the respective covered column that were detected killed bythe test suite.
the score columns show the corresponding mutation score that is the ratio of killed t o covered .
table extreme mutation operators used in the comparison.
method type transformations void empties the method reference types returns nullboolean returns true or falsebyte short int long returns or 1float double returns .0o r0 .
char returns o r a string returns or a t returns new t forgregor allstandardmutationoperatorswereused.descartes usedthesamemutationoperatorsasniedermayrset.al.
plus two additional transformations one to return nullfor reference typesandanothertoreturnanemptyarray.thefulllistofextreme mutation operators is shown in table .
one can observe that descartes creates much less mutants than gregor which is reflected in the difference between the times to execute the analysis of each engine.
in all cases descartes completed thetaskinmuchlesstime.someinterestingcontrastsinthismatter come from projects like spoonwhere descartes took a little less thantwohoursandahalfwhilegregortookmorethan56hours java git with one hour and a half for extreme mutation and hours for gregor and jaxen xpath engine with less than two minutesagainstnearly25minutes.whilethenumberofmutants createdandcoveredaffectstheexecutiontime theteststhemselves play an important role as they can involve heavy computation.
take forexample thedifferencebetween apache commons lang andscifiowith similar numbers of mutants and very different execution times.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
descartes a pitest engine to detect pseudo tested methods ase september montpellier france figure interconnection between pitest and descartes.
table list of projects used to compare both engines the execution time for the analysis the number of mutants created mutants covered and placed in methods targeted by both tools mutants killed and the mutation score.
descartes gregor project timecreated covered killed score timecreated covered killed score authzforce pdp core .
.
amazon web services sdk .
.
apache commons cli .
.
apache commons codec .
.
apache commons collections .
.
apache commons io .
.
apache commons lang .
.
apache flink .
.
google gson .
.
jaxen xpath engine .
.
jfreechart .
.
java git .
.
joda time .
.
jopt simple .
.
jsoup .
.
sat4j core .
.
apache pdfbox .
.
scifio .
.
spoon .
.
urban airship client library .
.
xwiki rendering engine .
.
asforthescores onecannoticethatthereisacertaincorrelation between the values obtained by both engines.
figure 2shows a scatter plot in which each point represents a project.
the coordinatesforeachpointaregivenbythescores the xaxiscorresponds to thescore fromdescartes while the yrepresents thescore from gregor.
the figure corroborates the tendency for a positive monotonic correlation between both scores which means that if the score with gregor is high it is more likely that the mutation score withdescarteswillbealsohigh.thespearmancorrelationcoefficientresultsin0.6fortheprojectsstudiedwitha p valueof0.
whichindeedindicatesthatthereisamoderatepositivecorrelation.
anyways there are cases such as scifioandxwiki renderingenginewhich produce a medium to low mutation score with gregor and scores above with descartes.
pseudo tested methods the results of extreme mutation are not limited to produce a score for a given project.
the proposal of niedermayr et.
al.
classifies methods according to the extreme mutant detection.
a method is said to be pseudo tested if it is covered by the test suite but norelatedextrememutantiskilled.thesemethodsaretheworst tested in the code base.
extreme mutation provides a framework todetect suchmethods moreefficiently thantraditionalmutation testing.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france oscar luis vera p rez martin monperrus and benoit baudry figure visual correlation between scores public static boolean isvalidxmlchar int ch return ch 0x9 ch 0xa ch 0xd ch 0x20 ch 0xd7ff ch 0xe000 ch 0xfffd ch 0x10000 ch 0x10ffff listing real example of a pseudo tested method.
listing4shows a method belonging to one of the projects included in table .
it was found to be pseudo tested by descartes.
onlytwoextrememutationsarerequiredtodetectthatthevalue of thismethod isnot correctly verifiedby thetest suite if verified atall whilegregorcreated45mutants.thisisanexampleofthe utility of extreme mutation.
nevertheless the result of descartes is coarse grained.
methods where extreme mutants are killed are not exempt from having testingissues.listing 5showsarealexampleofamethodwhere allextrememutantsweredetectedbutgregorcreatedmutantsthat survived the analysis.
in particular one of the traditional mutation operators changed the value of lon .min valuein line2.
the modification was unnoticed by the test suite which indicates that thecornercaseisnotbeingtested.thislevelofdetailcannotbe reached with the use of extreme mutation alone.
for a deep analysis regarding the utility in practice of descartes in the search of pseudo tested methods we invite the reader to check our work on the matter .
there we analyze whether thesemethodsarevalidhintstoimproveexistingtestcasesandwe provideasetoftestingissuesfoundwiththehelpofdescartesin real and well tested open source projects.
public long subtract long instant long value if value long.
min value throw new arithmeticexception ... return add instant value listing example of a non pseudo tested method.
demonstration scope thedemonstrationwillbedirectedtoresearchersanddevelopers whowishtoexperimentswithtraditionalandextrememutation.
it will be focused on the practical comparison of both mutationapproaches.wewilldiscusshowtointerprettheresultsgivenbydescartesandhowpractitionerscanusetheseresultstoenhance theirtest suites.wewillshowexamples ofrealtesting faultsfound withtheuseoftheextrememutationengine.thedemowillalso showcase the integration of descartes and the latest check github api2to discover pseudo tested methods in commits and pull requests.
supporting materials allmaterialsrelatedtothetoolareavailableonline.hereweprovide a list with the main resources descartes code repository main code repository hosted in github.itcontainsthecode documentationandinstructions to build the tool.
experimental data consistsinasetoffileswiththeoutput obtainedfrombothmutationenginesaswellasdataconcerning the studied projects.
experimental material github repository with additional experimental data and scripts to support the analysis and comparison of both mutation engines.
maven central artifacts compiledversionsofdescartesare available for use from maven central.
github application repository codeoftheprototypeapplication to integrate descartes in a github repository.