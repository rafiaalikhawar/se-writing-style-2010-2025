artinali dynamic invariant detectionforcyber physical systemsecurity maryam raiyat aliabadi universityof british columbia departmentof electrical and computerengineering vancouver bc canada raiyat ece.ubc.caamitaajith kamath national institute of technology karnataka departement of computerscienceand engineering mangalore india amita.a.kamath ieee.org juliengascon samson universityof british columbia departmentof electrical and computerengineering vancouver bc canada julien.gascon samson ece.ubc.cakarthikpattabiraman universityof british columbia departmentof electrical and computerengineering vancouver bc canada karthikp ece.ubc.ca abstract cyber physicalsystems cpses arebeingwidelydeployedinsecurity criticalscenarios suchassmarthomes andmedicaldevices.
unfortunately theconnectednessofthesesystemsandtheirrelative lackof security measures makes them ripe targets for attacks.
speciication basedintrusiondetectionsystems ids havebeen showntobeefectiveforsecuringcpss.unfortunately derivinginvariantsforcapturingthespeciicationsofcpssystemsisatedious and error prone process.
therefore it is important to dynamically monitor the cps system to learn its common behaviors and formulateinvariantsfordetectingsecurityattacks.existingtechniques forinvariantminingonlyincorporatedataandevents butnottime.
however time is central to most cps systems and hence incorporatingtimeinadditiontodataandevents isessentialforachieving lowfalse positives andfalse negatives.
thispaperproposesartinali whichminesdynamicsystem properties by incorporating time as a irst class property of the system.
we build artinali based intrusion detection systems idses for two cpses namely smart meters and smart medical devices and measure their eicacy.
we ind that the artinalibasedidsessigniicantlyreducetheratiooffalsepositivesandfalse negatives by to average .
and to average .
respectivelyover otherdynamicinvariantdetection tools.
ccs concepts security and privacy intrusion detection systems software securityengineering domain speciic security and privacy architectures softwareanditsengineering real timesystemssoftware thisworkwas doneduring a summer internshipat ubc.
permissionto make digitalor hard copies of allorpart ofthis work for personalor classroom use is granted without fee provided that copies are not made or distributed forproitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the irst page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspeciicpermissionand ora fee.
request permissions from permissions acm.org.
esec fse september 4 8 paderborn germany associationfor computing machinery.
acm isbn ... .
multi dimensional model security cyber physical system cps software engineering acmreference format maryam raiyat aliabadi amita ajith kamath julien gascon samson and karthik pattabiraman.
.artinali dynamicinvariantdetection for cyber physicalsystemsecurity.in proceedingsof201711thjointmeeting of the european software engineering conference and the acm sigsoft symposiumonthefoundationsofsoftwareengineering paderborn germany september 4 8 esec fse 13pages.
introduction cyberphysicalsystems cpses arebeingincreasinglyusedinsecurity criticalcontexts such as smartmedical devices smart grids smartcars andunmannedaerialvehicles uav .
unfortunately thesesystemsarevulnerabletocyberattacksdue totheirinterconnectednessandrelativelackofprotection.many attacks have been demonstrated against cpses such as cars smart medical devices andsmart meters .
intrusiondetectionsystems idses havebeenwidelyusedto monitor computer systems and detect security attacks.
typical idsesfallintooneofthreecategories signature based anomalybased andspeciication based .signature baseddetectiontechniques comparetheruntimebehaviorofthesystemagainstknownsecurity attacks and hence cannot detect unknown attacks .
the latterisespeciallyimportantforcpsesastheyareoftendiicultto patch or upgrade in the ield.
in contrast both anomaly based and speciication basedtechniquesuseabehavioralmodelofthesystem to compare with suspicious behaviors and can detect unknown attacks.
anomaly based techniques learn the system s behavior by observingitsoperationsatruntimeandformulatingthemodelof the system while speciication based techniques rely upon apriori knowledge of the systems behaviour to detect attacks.
unfortunately anomalybasedsystemsincurconsiderableoverheadtolearn the system model at runtime and also sufer from high rates of false positives.thesefactorsinhibittheiruseincpseswhichare often resource constrained and operate autonomously for long 349esec fse september4 8 paderborn germany aliabadim.
kamatha.a.
gascon samson j. andpatabiramank.
periodsoftime.therefore speciication basedsystemshavebeen proposedas the bestitfor cps security .
speciication based techniques build a model for a system based onitscodeandthespeciicationsdeinedbythedeveloper.however there are often inconsistencies between what developers describe their system does and what the system does in practice .
moreover codealonedoesnot provideinformationabouttheruntime behavior of the system in its operational environment.
in contrast dynamicanalysis basedtechniquesprovideanalternative way to understand the system by observing the run time behavior.
there has been a signiicant amount of work on using dynamic analysis to ind likely invariants for program understanding and debugging .thesesystems mine execution traces of the system for deriving invariants on the data values of the system the events or both.
however we ind that many of these systems incur signiicant false positives and or false negatives whenusedinthecontextofanids whichmakes themchallenging to deploy.
thispaperintroducesartinali areal time speciicinvariant inference algorithm for mining likely invariants through dynamic analysis in cps systems for speciication based idses.
the main innovation in artinali is that it incorporates time as a irst classnotionintheminedinvariants inadditiontothetraditional data and event invariants.
this is important for two reasons.
first mostcpseshavereal timeconstraints andhencetheiroperational correctness depends on both logical correctness and correct timing behavior .
hence incorporating time is essential for detecting many common security attacks in these systems.
secondly cpseshavepredictabletimingbehaviorstoairstorderof approximation and hence leveraging this predictability leads to higheraccuracy i.e.
lowerfalse positivesandnegatives .however incorporatingtimeindynamicinvariantdetectiontechniquesincreases the complexity of the learning due to the much larger state space that needs to be covered.
to alleviate this issue we break uptheproblemoflearninginvariantsalongthethreedimensions intoproblemsoflearninginvariantsalongtwodimensions namely data events and events time and then combine them into dataevents timeinvariants.
tothebestofourknowledge artinaliis the irst dynamic invariant detection system that mines invariants along the three dimensions of data event and time and uses the mined invariantsforintrusiondetection .our contributionsare we designed artinali an algorithm that generates a multi dimensionalmodelforcpsesbymininginvariants alongthe data eventandtime dimensions section .
we built an artinali based ids prototype and used it in the context of two emerging cps systems namely i advanced meteringinfrastructures and ii smart artiicial pancreas section .
weevaluatedtheeicacyofartinalifor6targetedattacks on the two systems.
we ind that the artinalibased ids can detect all attacks while none of the other dynamicinvariantdetection systemsdo so section .
we also evaluated our artinali based ids prototype on the two systems and compared it with several existing state of the art dynamic invariant detection techniques.
overall we ind that the artinali based ids exhibitssigniicantly lower false negativesand false positives for arbitrary attacks emulated by fault injection compared to the other techniques section .
furthermore itincurs about performance overhead which is comparable to otherinvariantdetection techniques.
background weirstsurveyrelatedworkintheareaofdynamicinvariantdetectionandhowartinalidifersfromthem.wethenpresenta motivatingexamplefromsmartmeterstoillustratewhyweneed data time eventinvariantslike the ones generatedbyartinali.
.
related work dynamic analysis based techniques that model the behavior of software systems can be categorized into four classes based on the modelsthattheygenerate i datainvariants ii eventrelationships iii dataandeventrelationships andiv timedependenciesofevents.
figure1showsthemaindynamicanalysis basedtechniques and where they fall alongthe data eventandtime axes.
daikonwastheirstdynamicanalysis basedtechniquetoderive likely invariants about data value relations and falls into the irstclassoftechniques.daikoncanbeplacedonthe dataaxisasit produces a model for data constraints without taking into account theeventsortimingofthesystem.dysy whichusessymbolic executionto derive invariants isanotherexample of this class.
thesecondclasscapturesthesequenceofeventswithinaprogam s execution paths by inferring inite state machines from a set of traces.
relevant examples include perracotta and texada both of which derive temporal logic propositions and capturesequencesofeventsbytrackingdynamictraces.thesetools fall along the eventaxis since they only capture the constraints on eventrelations independent of data ortiming information.
thethirdclassoftechniquesgenerateintegrationmodelsthat capture the relationship between data and events.
for example the gk tail algorithm merges temporal speciications and data invariants into extended finite statemachine models .
it represents sequencesof methodinvocationsthat areannotatedwithdata and is hence limited to classifying data invariants that arise among methodcalls.
quarryinds datainvariantsateachprogrampoint and then inds temporal relationshipsbetween the invariants .
neithertechniqueconsiderstiming information however.
the fourth class consists ofa singletechnique perfume which isa speciication mining tooldesigned for modellingsystemproperties based on resource time and storage consumption .
it generates an integration model of event relations and their time constraints.althoughperfumeconsiderstimeasapartofmodel it does not considerthe relationship between data andtime.
overall none of the current techniques consider the interplay among time events and data in formulating invariants which we believeis anessential characteristic ofcpssystems.
.
a motivating example we consider an example of a smart electric meter to illustrate why the existing dynamic analysis based techniques are often insuicientforcapturingthekeypropertiesofacpssystem.wealsouse this as amotivatingexample to illustrate artinalilater.
350artinali dynamicinvariant detectionfor cyber physicalsystemsecurity esec fse september4 8 paderborn germany figure scope ofdynamic invariantdetection techniques weuseanopen sourcesmartmetercalledsegmeterasoneof thetestbedsfor our implementationand our evaluations seesection4.
.segmeteriscomposedoftwomaincomponents themeter component and a controller.
the meter component is in charge of measuringandcollectingpowerconsumptiondatacomingthrough its serial ports and storing them in memory.
the controller acts as thecommunicationbridgebetweenthemeterboardandtheserver and is in charge of passing server commands to the meter board as well as transmitting power consumption data to the server at speciic time intervals.
the serial talker function in the controller program of the smart meter is in charge of receiving power consumption data at speciic time intervals and bufering them for billing calculationpurposes luacode showninfigure .
figure asnippet ofserial talker codeforthesegmeter figure shows the execution path of serial talker .
the argument seg data can take two diferent values aorb in predeterminedtimeintervals.thesequenceofeventsthatareinvoked in this function varies based on the value passed in argument seg data .
ifais passed line in figure then the program emitstheevent send followedby read.alternatively if bispassed to the function line in figure then the program emits events receiveandwriterespectively.
weexaminedtheinvariantsinferredbythediferentdynamic analysis basedtoolsforthisexample.daikoninfersthevaluesof variableseg data withinserial talker during normal execution as the set a b namelyseg data .
a typical temporal speciicationminersuchastexadaidentiiesthelegalsequences ofevents e.g.
g send xf read whichmeansthatuponevent sendhappening it is always followed by event read.
the invariantinferredbyperfume send receive .
.
complementthe figure the statechart ofserial talker temporal invariant by adding time boundaries between events i.e.
send isfollowedbyread within atime intervalof0 .1to .
ms. assume that an adversary s goal would be to perform energy fraudandlowertheirenergybills.onepossibleattackwouldbefor the attacker to tamper with the synchronization between the send andreceivemodes in the smart meter.
as a result a part of the energy usage would not be written to the memory bufer which is used for future energy usage calculations and billing.
for instance should the value bbe passed to the function instead of a then it wouldleadtotheexecutionof receive andwriteinsteadof send andread hence the billing information wouldbe incorrect.
none of the above techniques can detect the attack as the incorrect occurrence of sequences are triggered by legal values of seg data occurringatthewrongtime e.g.
seg data t1 b .
more speciically daikon would notice a valid value for seg data texada would notice a normal sequence of receive andwrite events and perfume would also observe valid time intervals betweenevents receiveandwritewithintheexecutedpath.thus none of them would detect the attack.
even if all three models are used jointly they would still not detect the intrusion as the diferent models either capture the legal data values or the legal sequence of events with their time diference but not the interplay among them.this interplayisessentialfor detecting the attack.
approach inthissection weintroducethesecuritymodelthatartinaliuses and we explain its design.
we irst deine our multi dimensional model and the diferent classes of invariants.
next we explain how to relate diferent dimensions to generate real time data invariants.
finally we present the artinaliworklowandalgorithm.
.
multi dimensionalmodel we modelacps inthree dimensions as follows datareferstodatavaluesassignedtothevariablesofaprogram.
itincludesneitherthetimingofprocesses northesequenceand concurrency ofprocesses.
eventrefersto an actionthata system takes to respondtoan external stimulus.
timerefers to real time constraints and includes both the constraints on physical timing of various operations and those where the system must guarantee response within a speciied time frame.
we model the security policy of a cps by inferring the set of invariants tobe preservedduringruntime.
an invariant or interchangeably a property is a logical condition that holds true at a particularsetofprogrampoints.likeinpriorwork we usetheterm invariants asashortcutfor likelyinvariants whichare 351esec fse september4 8 paderborn germany aliabadim.
kamatha.a.
gascon samson j. andpatabiramank.
thepropertiesthatwe observetobetrueaccrossasetofdynamic executiontraces.correspondingtothedimensionsdeinedabove we deine six major classes of invariants that form the basis of the cps model as follows data invariant captures the expected range of values of selected data variables during normal execution of program.
event invariant captures common patterns in the system s eventssuch as the order ofthe events occurrence.
time invariant captures the normal time boundaries such as durationorfrequency ofan event.
data per event d e invariant captures the temporal relationship between data and events.
it allows the ids to checkthe validity ofdata invariantsbaseduponevents.
eventpertime e t invariant capturestheconstraintsover eventandtime.itrepresentstheboundariesoftransition time from one eventto anotherinan eventsequence.
data pertime d t invariant captures the relational constraints of time and data invariants.
it represents the data invariantas afunctionoftime.
.
data event time interplay in a cps an event is deined as an instance of an action that leads to a change of condition e.g.
message send receive sensor datareading oractivatinginsulininjection .eventshavethreekey features.first theyrelectinteractionsbetweensystemcomponents andobservationsratherthaninternalstate.thesecondfeatureis the notion that events are separated in space and time and hence there is no concurrency among event executions.
moreover in the case of dependent events i.e.
one event triggers theother oncetheirstevent task isdone ittriggerstheexecution ofthesecondevent.thirdly thelocationsinthecodewhereevents aretriggeredareusually systemcalls thatareaccessiblebyattackers.
froma security perspective events are importantas theyplay the roleofaninputchannelformaliciouscommunicationwiththecps.
forinstance thosepointsinwhichanewmeasurementisreadfrom sensors oractuationcommandsaresenttophysicalcomponents are more vulnerable to spooingattacks .
finding a direct relationship between time and data is challengingfromboththe learninganddetection perspectives.sincetime is a continuous phenomenon we cannot deine a sharp time for transitions in data values or changing states of the system instead adistributionoftimevalueshastobelearned.asexecutiontime variations might be caused by diferences in input sets ordiferent executionlows ratherthanmaliciousactivities theinvariantinferencetechniqueshouldlearnthenormaltimevariationsofthe system.
the ids also has todistinguish legitimate time variations from any time deviation that indicates an intrusion.
to overcome thesechallenges we leveragetheevent based nature ofa cps in whichevery event takes place in an unique timeframe.
we discretize the timeby theevents and use these for learning invariants.
after so we irst examine the relationship betweendataandeventdimensionstoproduceinvariantsthatintegrate event information with constraints on data values d e invariants .secondly wediscovertherelationalconstraintsover time and event dimensions to calculate the physical time boundariesofevents eitherindependently timeinvariants orinrelationtoeachother e tinvariants .finally wecombinetheresultofthe previous steps to infer d tinvariants.
inthefollowingdiscussion weillustratehowweinferthe d t invariantsgiventheconditionalprobabilityofhaving datadgiven eventeinvariant p d e and given the conditional probability of havingeventegiventimetinvariant p e t .
considering data d eventeand time tas random variables equation expresses the joint probability distribution of variables d eandt.werewriteittoobtainequation2.fromthesetwoequations wethenderiveequation3 whichexpressestheprobability ofhaving dande givent.
p d e t p d e t p t p d e t p d e t p e t p t p d e t p d e t p e t using the marginal probability mass function of dshown in equation weformalize p d t theprobabilityofhaving dgiven t in equation as the sum of the probabilities of data dand event ejgiven time tfor all events ej which can then be rewritten as equation using equation .
p d summationdisplay.
p d ej ej p d t summationdisplay.
p d ej t ej p d t summationdisplay.
p d ej t p ej t ej for example assuming that at time t eventejoccurs and that uponejoccurring thenvariable dgetsassignedaspeciicvalue.
this implies that tis the cause of ej and that dis the efect of ej.
thus variable disconditionally independent of time variable tgiven event ej.
consequently dandtare conditionally independent and p d ej t p d ej .
hence we can simplify the formulation of p d t as follows p d t summationdisplay.
p d ej p ej t ej according to the event based semantics of cps any givenevent takesplaceinauniquetimeframe.thisimpliesthattwoormore events cannot take place at the same time t i.e.
p ej t p ei t ei nequalej.
given this assumption we irst rewrite equation to obtain equation .
then we simplify it to obtain equation which captures the relationship between data dand timetbyexploitingtherelationalconstraintsofbothdataandtime over thesameevent ejwhichtakes placeat time t. p d t p d e ej p e ej t summationdisplay.
p d ei p ei t ei nequalej p d t p d e ej p e ej t inotherwords foragivenevent ej ad tinvariantholdstrue i.e.
happenswithahighprobability ifandonlyifboththecorresponding d einvariantand e tinvariantholdtrue.
.
artinali worklow artinali is a dynamic analysis based technique that generates modelsofdynamicsystembehavior andproposesamulti dimensional 352artinali dynamicinvariant detectionfor cyber physicalsystemsecurity esec fse september4 8 paderborn germany modelbasedonthedesignconceptsintroducedintheprevioussection.figure 4showsthe key blocksofartinali s worklow.
figure worklow ofartinali in order to generate logs for mining invariants we manually instrument events and their associated data variables1.
we assume that cps source code is available and that it can be modiied to instrumentevents thisisreasonableasweenvisionourtechnique tobeusedbycpsdevelopers ifnot onecanuseabinaryinstrumentationengine .inourtechnique eventsaresystemcalls.hence we capture all system calls as events.
however the user can optionallyprune the space ofevents by specifying only the important systemcallsbasedonthesystem srequirements.weinstrumentthe events programlocationsbyinsertingcallstothe artinaliapi functions thatwedevelopedforcollectinglogs beforeandafterthe event.duringtheattack freeruntimeexecutions thesefunctions collectdataandtimeinformationassociatedwiththeinstrumented eventsinseparatelogiles namely delogsandtelogs .thelogged information isusedas the basisfor mininginvariants.
block .
artinali d eminerthe artinali d eminer learnsinvariantsaboutthevariablevalues andhowthesevalues relatetoaparticulareventinthesystemusingathree stepprocess.
first thed eminertakestheloggedinformation andgroupsthem within each trace into distinct classes labeled with the events.
it thenmergesclassesacross delogs.second withineachclass using the frequent item set mining algorithm it merges the data variableswhilecalculatingthelevelofthe conidence andsupport for every variable.
asinprior work supportisthefraction of tracesinwhichthevariable xwithinclass ejisseen and conidence is the fraction of supported classes where variable xis assigned to the same value s .
finally the d eminer infers the data invariants associated with eachclass event .
d einvariantsaremulti propositionaldatainvariants as they all hold true within the same observed event at the same time .
the d einvariants are stated in the form of ei d1 d2 ...dn whereeidenotes the name of i thevent and d1 dndenote the range of concrete values ofndata variables mapping to the event ei.
for the example in section .
the invariant receive seg data false command nil status len.partial 0represents the data invariants that are valid duringthe event receive andishence a d einvariant.
1thisissimilartowhatalmostallotherinvariantdetectiontechniquesdo withthe exception of daikon whichhas anautomated instrumentation engine.table e tand d tinvariant types e t invarianttype typei ei t ei t freqi typeii ej ei tjimax tjimin typeiii ei timax timin d t invarianttype typei dm ti t tj typeii dm dn tjimax tjimin block2.
artinali e tminerartinali s e tminer infers thee tinvariants in four steps.
first it creates all consecutive event pairs within one trace annotated with their time diferences.
second it groups the pair of events that are labeled with the same pair name.
third artinali s e t miner looks for the pair wise events that are observed in the same order within te logs and calculatestheirsupport.finally itmergesthetimevariableswithin each class to calculate the time boundaries of the paired events aswellasthefrequencyandtheaveragedurationofeveryevent execution.
the e t invariants are classiied into three types as shownintable1.typeiindicatesthatevent eiisrepeatedevery freqiseconds.typeiiindicatesthatthepairofevents eiandejare repeatedinalltracesinthesameorder andtheirtimediference is bounded within tjimaxand tjimin.
type iii indicates the maximumandminimumdurationofevent ei.fortheexamplein section2.
send t send t showingthefrequencyof send occurrences in the system and the invariant send receive .
.5representingthetimeboundary between1.5and14.
and thelogicalorderingoftheevents i.e.
sendbeforereceive areboth examples of e tinvariants.
block3.artinali d tmineraccording to the formulation describedfor d tinvariants artinalicombinestheoutputsof d eande tminers to generate the real time data invariants d t invariants .wedeinetwotypesofdatainvariants and we explaineachtype using the example insection .
.
typeirepresentsthedistributionofvaliddatavaluesofvariable dmwithintimeslot ti t tj.forexample seg data t1 t t2 ameansthattheonlyvalidvalueofvariable seg data isa during the time interval t1 t t2.
note that we difer here from daikondatainvariants e.g.
seg data a b astheyonlyexpress the valid valuesofdata invariantswithoutconsidering the time.
type ii captures the relationship of data invariants between two consecutive events.
as explained in previous section every two consecutiveeventshaveaboundedtimediference ti tjimin tj ti tjimax .as a result the data invariantsassociatedwith thoseeventshavethesametimediference.inotherwords datainvariantdj holds true untildata invariant di becomes true while tjimaxand tjiminspeciiesthetimediferenceboundaries between thosedatainvariants.
in the previous example figure artinali d tminergeneratesoneinvariantofthistype asfollows seg data a seg data b .
.
i.e.
seg data a holds true untilseg data is assigned value b in a time interval ranging between1 .5and14.3seconds.
block4.ids prototype as explained in the previoussections theartinaliminersderivethreeclassesofinvariantsthatcomprisetheinalcpsmodel.thecpsmodelisusedasaninputtoour 353esec fse september4 8 paderborn germany aliabadim.
kamatha.a.
gascon samson j. andpatabiramank.
ids prototypefor monitoringattacks.ourids prototypeconsists oftwocomponents the tracingmodule andtheintrusiondetector .
the tracing module is in charge of collecting the required informationfromtheprogram sexecutionandloggingit.thismodule is the same as the artinali logger that instruments the code andcollectslogs but with thediference thatit is deployed onthe production system.
the collected information is fed to the intrusion detector whichperiodicallyprocesses the logileandchecks itagainst the invariantsderivedfrom the cps model.
experimentalsetup this section irst presents the details of two cpses and then the experimental procedure for evaluating the ids on the two platforms.
finally it presents the attack models that we considered for evaluation followedbythe evaluation metrics.
.
cpsplatforms wechosetwocpsplatformsascasestudiestoevaluatetheeicacy of the invariants generated by artinali and the other tools.
note that unlike generic applications there are few publicly available open sourcecpsplatformsthatarealsosecurity critical.furthermore there is a signiicant amount of efort involved in setting up acpsplatformandgeneratingexecutiontracesfromit.sowelimit ourselves to 2cps platformsinthe paper.
advanced metering infrastructure ami advanced metering infrastructure ami systems are deployed on smart electric powergrids.smartmetersarekeycomponentsofamithatprovide a two way communication with the utility provider .
the large scaledeploymentofsmartmetersandthediscoveryofmanyvulnerabilitiesinthesesystems makethemgoodcandidates to evaluate ourwork.
agenericsmart meteriscomposedoftwo main components namely the meter and the controller.
the metercomponentreceivespowerconsumptiondatathroughanalog frontendsensors andstorestheminthememory.thecontroller component is the communication bridge between the meter and theutilityprovider sserver passingservercommandstothemeter and sending consumption data back to the server at speciic timeintervals moredetailsin .weusesegmeter anopen source smart meter to evaluate our ids prototype.
segmeter is implemented using the lua language and consists of lines of code excluding libraries .
smartartiicialpancreas sap diabeticpatientsaremigratingfromthetraditionalglucosemeterandmanualinsulininjection systemstocontinuousglucosemonitoringandautonomousinsulin delivery devices which are referred to as smart artiicial pancreas sap .sinceattackstoasapcanthreatenthepatient slife thesesystemsarehighlysecurity critical .hence weselected sap as our second case study to evaluate artinali.
the main buildingblocksofagenericsapareacontinuousglucosemonitor cgm an insulinpump and acontroller.the cgm samples the patient sbloodglucose bg levelsonaregularbasisandsendsit to the controller.
the insulin pump is a wearable medical device that is used for automatic injection of insulin through subcutaneous infusion.
the controller controls the closed loopin the sap.
it receives the measured bg from cgm and issues the suitable actuationcommandforcorrectingthesugarlevel.weusedopenartiicial pancreas system openaps an open source sap asasecondusecasetoevaluateouridsprototype.openapsimplements the controller component of an sap in javascript and consists of lines of code excluding libraries .
we simulated a simplecgmandaninsulinpumptoclosetheloop aswedidnot haveaccesstoapatientwitharealinsulinpumpandglucosemeter.
openapsprovidesasetoftestcasesthattakediferentbgvaluesas input and process them for calculating basal rate of insulin which we use as abaselinefor our experiments.
.
experimentalprocedure figure shows the overall procedure that we follow.
in addition togeneratingthecpsmodelusing artinali we generatethree othermodels invariantssets usingdaikon texada andperfume for comparison purposes.
we have made artinali publicly available .
we downloaded the latest versions of these tools from theirrespectivewebsites .wedonotruntheinstrumentationfront end ofdaikon i.e.
kvasir asour goal was togenerate data invariants based on the event traces we logged.
we choose these three tools to represent the irst second and fourth classes of invariants as described in section .
we do not choose the tools in thethirdcategory namelygk tailandquarry asweusedaikonto ind data invariants for the events that we identiied in the system.
therefore theinvariantsgeneratedbydaikoncoverthethirdclass ofinvariantsinour experiments i.e.
d einvariants .
thereare22systemcallsinsegmeter scode and4systemcalls intheopenapscode.weconsiderallofthemasevents.tables2 and present the types of invariants and the number of invariants generated by the three tools and artinali for the segmeter andopenapsplatformsrespectively.ascanbeseen artinali generates invariants in the time d e e t andd tcategories while daikon texada and perfume only generate invariants in thed e eventand e tcategoriesrespectively.
because the format of the invariants generated by these other tools may be diferent from that expected by our ids we wrote scripts to convert the invariants to be in the format expected by theidsinterface.artinalidirectlygeneratedinvariantsinthe properformat.incaseatooldidnotgenerateacertainkindofinvariant e.g.
d e weleavethatinvariantileblank.thegenerated invariant sets are all fed into the ids as inputs and their eicacy is evaluatedondiferentplatforms.
we divide the experiment into a training phase and a testing phaseforeachsystem.weirstobtainexecutiontracesfromthetwo platformsundernormaloperation andrandomlydividethemintoa setoftrainingtraces train andtestingtraces test .wethenchoose diferenttrainingsetsizesforeachinvariantdetectionsystemto optimize the false positive fp and false negative fn ratios for that system.
finally we evaluate the fp ratios of the invariants using the testtraces and the fn ratios using the attack models describedinthe nextsection.
theidsisimplementedinpython andconsistsofabout1000 lines of code.
since the ids is run on the cps platform which is oftenresourceconstrained itisimportanttominimizeitsoverheads.
wemeasuretheids stimeandspaceoverheadforthesegmeter platform in section .
because we run the openaps platform in 354artinali dynamicinvariant detectionfor cyber physicalsystemsecurity esec fse september4 8 paderborn germany figure overallexperimentalprocess ofrunningtheids table types and number of inferred invariants for segmeter across tools event timed ee td t daikon texada perfume 158artinali table type and number of inferred invariants for openaps across tools event timed ee td t daikon texada perfume 57artinali asimulator aswedidnothaveaccesstoitshardware wedonot measure the idsoverheadsonopenaps.
.
attackmodels traditionally security techniques are evaluated using a small number of targeted hand crafted attacks.
unfortunately this is not suicientforcpssystemsforthreereasons.first cpsesarenew systems for which there are few real attacks hence they need protection from zero day or unknown attacks.
this is especially the casefor security criticalcpses suchassmartmedical devices.
secondly unlikegeneral computersystems cpsescanbe diicult toupgradeandpatchfrequently.thirdly thereisnostandardset ofattacksoncpsesunlikegeneral purposecomputersystems so wewouldhavetohand craftindividualattacksonthesesystems whichwouldpotentiallyintroduce biasinthe evaluation.
targetedattacks to evaluate our idss against known attacks weusethreeattacksforeachsystemthatwediscoveredbasedon manual analysisofthe cps section .
arbitraryattacks weusefaultinjection i.e.
mutationtesting to emulate arbitrary attacks.
fault injection has been used to study the efects of attacks in previous work .
note that these are not complete attacks but rather form the building blocks of attacks.
we deploy diferent types of mutation in the program s code as follows.
datamutations whichchangetheruntimevaluesofdata variables inthe code branchlipping whichchangethenormalexecutionlow ofthe program bylipping branchconditions table the number of mutations in each attack category forsegmeterandopenaps.
cps attack category data mutation branch lip artiicial delay segmeter openaps artiicial delay insertion which modifythe normal timing behaviorofthe program.
eachoftheabovecategoriesemulatediferentsecurityissues.by performing data mutations an attacker can change critical data in the program to their advantage.
such attacks can be accomplished byexploitingmemorycorruptionvulnerabilitiesorraceconditions intheprogram.likewise branchlippingcanleadtoillegitimate controllowpathsbeingtakenintheprogram toaccomplishthe attacker s ends.
such attacks can occur due to code injection or sematic vulnerabilities.
finally artiicial delays can allow attackers to change the timing of the system s actions and delay essential functions orcauseotherfunctionalitytobesuppressed againto their advantage.through these mutations we canemulate a wide varietyofattacks withoutapredeinedtarget thusavoidingbias andallowing modelling of hitherto unknownattacks.
table presents the number of mutations performed in each categoryforsegmeterandopenaps.wemanuallyseededeach of these mutations in the source code of the respective systems by randomly sampling the corresponding program points in the program scode.whilethiscouldhavebeenautomatedbyafault injectiontool e.g.
llfi thelanguagesinwhichthetwosystems were implemented javascript and lua were not supported by existingtools.therefore wehadtoperformmutationsmanually.
however we attempted to choose the program points randomly before performingthe experiment toavoidbiasingour evaluation.
after mutatingthe code we can observe one of fouroutcomes.
crash inwhichthe program isaborted exception hang inwhichtheprogramgoesintoanininiteloopor deadlocks sdc silent data corruption in which the outcome of the program isdiferentfrom afault free execution nocorruption inwhichtheoutcomeoftheprogramdoes notshowanyobservableimpactwithrespecttofaultmaskingornon triggeringfaults.internalstatesmighthowever be corrupted.
note that in the context of this paper we are interested only in sdcandno corruption outcomes as the crashandhangoutcomes can easily be detected without an ids.
therefore we only present theresultsforthefault injectionexperimentsthatresultedinthe sdcandno corruption outcomes and which need an ids these compriseabout75 ofthe outcomes onaverage .
.
evaluationmetrics accuracy we use three metrics to measure the efectiveness of our idsfrom the accuracypointof view.
false negative ratio fn which is the ratio of attacks that were undetected by the ids to the total number of attacks 355esec fse september4 8 paderborn germany aliabadim.
kamatha.a.
gascon samson j. andpatabiramank.
false positive ratio fp which is the ratio of execution traces that were incorrectly reported as attacks to the totalnumber ofnormal traces f score whichis acomputation ofthe harmonic mean ofthe true positive ratio tp fpandfn.
thevariationsoftheargument inf score allowustoweigh the above metrics diferently and obtain diferent trade of between fp and fn ratios based on the system requirements.
a valueof 1weighsfnshigher whileavalueof 1weighsfps higher.avalueof 1weighsthembothequally.wehypothesize that fps are more important in smart meters as a false alarm leads toaddedcosttotheutilityproviderwhoneedstodeployservice personnel to investigate the false alarm.
an occasional fn may be acceptable in smart meters as the consequence is only a loss of revenue.
in the openaps on the other hand even a single fn can be fatal to the patient while a fp may be acceptable if there are other checks in place to ilter out fps e.g.
patient intervention .
hence for segmeter we select f score .
and for openaps we choose f score as our reference metric.
overheads in addition to the accuracy we also measure the memory andperformance overheadsofthe ids.
memory overhead is deined as the actual memory usage of the ids.
it depends on the size of ids the number of invariants that accountforthecpsmodel andthecomplexityofinvariants e.g.
theinvariant ej ei tjimax tjimincarriesmoreinformation thanthe invariant ej ei andishence more complex .
performanceoverheadistheincreaseinexecutiontimeasaresult of running the cps on the target platform.
this metric relects the overheadofboththe tracingmodule andtheintrusiondetector .since cpsesruncontinuouslyforlongperiodsoftime wemeasurethe performance overhead per cycle where a cycle refers to one full execution of the main loop of the cps both the segmeter and openaps consist ofasinglemain loopthat runscontinuously .
targetedattacks inthissection wediscussthepotentialtargetedattacksandhowwe derivethemforbothplatforms.wethenevaluatetheidsseeded by artinali and other tools against the attacks.
note that we used attack trees based on prior attacks against similar systems to generatetheattackstominimizebiasandmodelrealisticattacks.
wefoundthatartinaliwasabletodetectalltheattacks while none of the other tools do.
this is because all the attacks involved violations ofthe interplayamong data events andtime.
.
ami attacks energy fraud is a major class of ami attacks and can result in power consumption data pcd loss and improper billing .
we cameupwithanattacktreeforenergyfraudinami showninfigure6 basedonattacksintroducedinpreviouswork .
there are three major branches in this tree namely i measurementtampering ii storagetampering andiii networktampering.
correspondingtoeachbranch wedevelopedtheconcreteattack actions as the leaves ofthe tree as follows.
synchronizationtampering blocks a1 a4 occurs due to modiication of the time of sendandreceivemodes in ami.
we found that the communication between the ami and the server figure attack tree forami table5 artinaliinvariantstodetecttheexampleattacks inami.
attack detecting invariant synchronization send t0 k send t0 k tampering k message dropping recv t1 recv t1 meterspooing node name t0 n nodeb n issynchronizedbyavulnerablefunction get data timer inthe controller unit.
the controller frequently checks the time with the sever to decide when to request for data measured by the meter.
if a malicioususer modiies the timeonthe server thecontroller will not receive data in the expected time which leads to data loss and improper calculationofinal pcd.
meter spooing blocks b1 b5 inasmartgrid amiscommunicatewiththeserverusingauniquenameorid.thecontroller unit is able to be connected to more than one meter collects the pcds andsendthemalongwiththemeter sidtotheserver.as thecontrollercannotdiferentiatebetweennormalandabnormal messages itcanbetrickedbyfalsiiedinputssentbyanattacker instead of the meter.
this attack is called meter spooing attack .
we found that spooing themeter only requires the meter s id that is printedonthe meter snameplate.
messagedropping blocks c1 c5 anattackermaybeable todropthemessages i.e.
apartofenergyusage afterbypassing themeterandremoving theloggedpcdhistory.asimple wayto mountthisattackistointerceptthecommunicationbetweenthe meterandthecontroller andcontrolwhattraictoblockandwhat to pass through e.g.
through a irewall .
hence the blocked traic wouldnot be includedinpcd calculations.
.
detectionofami attacks werantheartinali basedidsontheexampleattacks andfound that it detected all of them.
table indicates the important invariants that are derived by artinali which detect the attacks presentedinthe previous section.
synchronization tampering as synchronization tampering attackmodiiesthetimingof sendandreceiveoperationsofsegmeter we picked events sendandreceiveas relevant events to explain this attack.
we can see in row of table that the artinali invariant captures the sequence of these events during normal operation i.e.
sendoperation happens every seconds and receive 356artinali dynamicinvariant detectionfor cyber physicalsystemsecurity esec fse september4 8 paderborn germany figure attacktree forsap isrepeatedevery1second.thus thisinvariantdetectstheattack as the timing ofthe eventsisviolatedbythe attack.
messagedropping ifweassumetheattackerdropsoneormore messages frommeter the droppedmessages willnot be receivedat the expected time slots by the controller.
as a result the frequency of receiving messages in controller will change.
this attack breaks the invariant number in table which represents the time frequencyofreceivefunctionwhichis1003milliseconds simequal1sec within one full executionpath.thus this attackisalsodetected.
meter spooing to detect meter spooing attack we selected tworeceiveevents recvaandrecvb from two diferent meters nodeaand node b that are connected to the same controller and analyzedtherespectiveinvariants.forexample nodename t0 n node b n speciies that the valid value of nodename at t0 n isnode b. if the identity of node ais stolen by node b it sends its messages every seconds under the name nodea.
as a result variable nodename attached to event recvb becomes nodea.
thus the invariantnumber intable5isviolated.
.
sap attacks diabetictherapytampering isoneofthehighestseveritythreats forpatients asitcanresultindeathorseverehealthcomplications.
we developed an attack tree for diabetic therapy tampering based onpubliclyavailablereportsofattacksonsaps infigure7.
we considerthree classesofattacksbasedonthe tree.
cgm spooingattack blocks a1 a4 injects false into the communication channelbetween cgm and controller making the controller think that the glucose level is either higher or lower thanitactuallyis.therearetwowaysthatcgmspooingcanbe accomplished.first ifthesensordataformatisunknown thena replay attack can be used.
in this case a sensor value read in the pastcanbere sent e.g.
byarfmodule tothecontroller.this would cause the controller unit to indicate an outdated glucose level rather than the actual one.
second if the format of sensor dataisknowntohacker shecansendthefalsedataatrandomtime intervals to mislead the controller.
basal tampering blocks b1 b5 the basal tampering attack may be accomplished in two diferent scenarios.
the attacker may issue a command for i stopping the basal injection e.g.
basal.rate when it is required for patient or ii resume the basal injection basal.rate when it has to be stopped.
these attacks may be mounted using a software radio board that fullytable artinali invariants to detect example attacks in openaps.
attack detecting invariant cgmspooing read t read t stop bg basalinjection .
basal.rate .
.
.
resume bg basal.rate basalinjection .
.
controlsthesap andtransmitsthemaliciouscommands to the pump.
to accomplish the attack the attacker needs to spoof thepinnumberofthecontroller andtheformatoftransmission packets both ofthesecan be done byan eavesdroppingattack.
.
detectionofexample attacksin sap wemountedtheattackexamplesonthesapsystemweconsidered i.e.
openaps and found that the artinali based ids is able todetectallofthem.therearefoureventsinthesap namely1 send bg orsendingbloodglucosebycgm read bg orreading bg by the controller send basal.rate or sending basal rate to pump by the controller and recv basal.rate or receiving basal rate by pump.
we used these events as the basis for mining invariants for openaps s ids model.
due to space constraints we donotpresentallinferredinvariants butonlythosethatdetectthe example attacks .
cgm spooing attack we selected read bg in controller as the relevant event and analyzed the inferred invariants for this eventtoanalyzecgmspooingattack.undernormalconditions thetransmissionofmeasuredbloodglucose bg tocgmoccursat deterministic periodictimes e.g.
everyiveminutes .thisproperty is represented in our model as time frequency of event read bg thatisread t read t .usingtheaboveproperty itwouldbe possibletodetectmalicioussensorreadingfromanyexternalsource that performs replay attack or transmits wrong data at random time intervals to the controller as the frequency of reading data by controllerwouldchange.
basal tampering attack as previously explained the basal tampering attack may be accomplished in two diferent scenarios i stopbasal injection basal.rate when it is required and ii resume basal injection basal.rate when it is not required.
these attacks break the invariants shown in table .
the invariant number indicates that if bgis higher than the normal range the patient needs insulin i.e.
basal.rate .
however the stop insulin injection attack makes the basal.ratevalue to be which breaks invariant number .
similarly the invariant number in table shows that for low bg ranges e.g.
bg the patient doesnotneedinsulin i.e basal.ratemustbe0 but resumebasal injectionattack sends a command basal.rate to the sap to injectinsulin.
as aresult invariantnumber isviolated.
evaluation inthissection wepresenttheresultsofthefaultinjectionexperimentstoemulatearbitraryattacks andtheoverheadmeasurements.
weirstpresenttheresearchquestions rqs weask.wethenaddresseachofthe rqsinaseparate sub section.
357esec fse september4 8 paderborn germany aliabadim.
kamatha.a.
gascon samson j. andpatabiramank.
.
research questions rqs rq1.how do we choose the training set size to obtain the bestf score for eachtool?
rq2.what is the fn ratio incurred by the ids using the invariantsderivedbyartinaliandthe othertools?
rq3.what is the fp ratio incurred by the ids using the invariantsderivedbyartinaliandthe othertools?
rq4.whatisthememoryoverheadoftheidswhenusing the invariantsderivedbyartinaliandthe othertools?
rq5.whatistheidsperformanceoverheadwhenusingthe invariantsderivedbyartinaliandthe othertools?
.
rq1.
f score as mentioned in section we obtain two setsof tracesfrom each system namely trainandtest.inthisrq weaskwhatshouldbethe optimal trainingsetsize foreachsysteminorder to maximizethe correspondingf score values.toanswer thisquestion we obtain a total of training traces and test traces for each system.
we then vary the training set size from to in increments of .
we then run each of the invariant detection tools including artinali on the same training set to derive invariants.
we then measure the fp fn and f score values .
for each invariant detection toolandsystem as afunctionofthe training setsize.
figures and show the distribution of the amount of false positives fp false negatives fn and the f score computed with .
2inrelationtotheamountoftrainingtraces respectively for segmeter and openaps corresponding to each of the four invariant detection tools including artinali.
as expected as the amountoftrainingtraces increases the fpratiodecreases since a broader set of invariants are extracted thus a lower amount of legitimateactionsarelaggedaspotentialattacks.aconsequenceis thatmoreattacksareundetected fnincreases asamorerestricted setofinvariantscanleadtosomeattacksbeingundetected.overall an increase in the amount of training traces lead to an increase ofthef scoreatirst thenitstabilizes atwhichpointan optimal amountoftrainingtraceshavebeenfound foragivenvaluesof .
tables and show the optimal amount of training traces optimalf score foreachinvariantdetectiontool forsegmeterand openaps respectively.
recall that we choose f score .
for segmeterandf score foropenaps andhencethesearethef score values we chooseforthe optimalnumberof traces.forexample in segmeter atrainingsetsizeof20resultsinthemaximumvalue of the f score .
value of artinali whereas for openaps a training set size of results in the maximum value of f score .
.
likewise wecomputetheoptimaltrainingsetsizesforthethree other tools on both platforms.
these are the values of the training set sizes we use for deriving the invariants for each tool in the rest of this section.
in other words we ind the best coniguration of each tool on each platform and generate invariants using this conigurationforcomparingthecorrespondingidses.
.
rq2.
falsenegatives inthissection wecomparethevariationinthefnratioincurred by the ids using invariants extracted by artinali and the other tools.
tables and also show the fn ratios for each tool for the segmeter and openaps systems respectively.
we observe thattable7 optimaltrainingsetsizeformaximumf score .
forsegmeteracross tools and the fpand fnratios.
daikon texada perfume artinali f score .
.
.
.
.
num oftraces fp fn .
table optimal training set size for maximum f score foropenapsacross tools and the fpand fnratios.
daikon texada perfume artinali f score .
.
.
.
num oftraces fp .
fn overall artinaliwasabletodetectaround97.
ofattacks which meansithasanaveragefnratioof2.
.incontrast inperfume texada and daikon the fn ratio was respectively .
.
and onaverage acrossthetwoplatforms.
thus theartinali based idsreducestheratiooffalsenegativesby89to95 average93.
over otherdynamic invariantdetectiontools.
figure and figure illustrate the fn ratio of the ids for the threecategoryofattacks codemutations aswellastheaggregated fn ratio for eachtool inboth segmeter andopenaps.
datamutations artinaliexhibitsthelowestfnratefordata mutations 2to3 .
thisisfollowedbydaikon whichprovides a muchlowerfnratioin datamutation attacks insegmeeter and17 inopenaps thanperfume insegmeeterand78 in openaps andtexada insegmeeterand87 inopenaps .
this is because daikon focuses on data invariants while texada andperfumedonotincludedatainvariantsintheirmodel.however the daikon data model does not include other properties like artinalidoes resultinginmuchhigher fnsthanartinali.
branchflipping among the other three tools artinali has thelowestfnrateforbranchlippingattacks .perfume texadaandartinaliexhibitalowerfnratiocomparedtodaikon forbranchlippingattacks.as theseattacksimpact theorderand sequence oftheeventsinan executioninstance anddaikon does not have eventinvariants itshowsless sensitivity.
artiicial delay again artinali has a much lower fn ratio thanallthreetoolsforartiicialdelayattacks followedby perfume.
this is because they both include time in their model.
nevertheless daikonandtexadaarestillabletodetectattacksthat impact data variables oralterthe executionlowof the program.
overall theresultssupportourhypothesisthatamorecomprehensiveinvariantmodel suchasartinali whichcanindinvariants andtheirconstraintsalongthreedimensions candetectasigniicantly larger amount ofattacks and hence has fewer fns .
.
rq3.
falsepositives in this section we compare the fp ratio incurred by our ids when usingtheinvariantsderivedbyartinaliagainsttheinvariants generated by the other tools daikon perfume and texada .
the results are shown in table and for the segmeter and openaps 358artinali dynamicinvariant detectionfor cyber physicalsystemsecurity esec fse september4 8 paderborn germany figure fn fp and f score variations based on number of training traces for segmeter across tools a daikon b texada c perfumeand d artinali.
x axisisthetraining set size.
figure fn fp and f score variations based on number of training traces for openaps across tools a daikon b texada c perfumeand d artinali.
x axisisthetraining set size.
figure fn of ids for segmeter for diferent attack typesacross thetools.errorbars areshownforthe conidence interval.
figure fn of ids for openaps for diferent attack typesacross thetools.errorbars areshownforthe conidence interval.systemsrespectively.wecanobservethatinbothcpses theuseof theartinali generated invariants lead to signiicantlyless false positives comparedto theinvariantsgenerated bytheothertools.
moreprecisely artinaliprovidesa20 to48 improvementof the fp ratio for segmeter a to improvement of the fp ratioforopenaps andaveragely30.
improvementofthefp ratiofor both platforms over the othertools.
these results can be explained by the fact that artinali leveragesthecorrelationsamongdata eventandtimedimensionsduring correctsystembehaviortogeneratemorestableinvariants.artinaliinferseventinvariantsthatpreciselydescribetheorderingof events in a sequence within an execution low and then associates data and time constraints to the events within every path d eand e t .
therefore during normal operation the system is unlikely to followthesamepathwithdiferentassociateddataandtimevaluesina givenexecution whichinturn reducestheprobability of false positives.
although the ids uses the same traces for all tools none of these tools other than artinali look at the relational constraints of both data and time along the events paths resulting inahigher ratiooffalse positives.
while the fp ratio for the artinali based ids is lower than the other tools itis still highfor both platforms.to reduce the fp ratio one can deploy multiple variants of the code and switch to a diferent variant when an attack is detected.
if the invariant is not violatedinthesecondversion itmaybeafalsepositive.another solution is to remove invariants that exhibit high fp ratios but this mayalsoincreasethe fn ratio.
359esec fse september4 8 paderborn germany aliabadim.
kamatha.a.
gascon samson j. andpatabiramank.
table memory and performance overhead of ids seeded by artinaliandtheother tools runningon segmeter.
daikon texada perfume artinali memory usage mb .
.
.
.
tracing overhead .
.
.
.
detectoroverhead .
.
.
.
overall overhead .
.
.
.
full cycleexecution s .
.
.
.
idsexecution time s .
.
.
.
.
rq4.
memoryoverhead we measured the memory consumption of our ids running on the segmeter platform using the invariants generated by diferent tools.
we also calculated the number of invariants that artinali and the other tools inferred for both platforms.
our results are shown in table memory usage row .
generally invariants that involve two or more dimensions e.g.
e tinvariants carry more information than the invariants of one dimension e.g.
event invariants and hence are more complex.
we observe that the memory usage grows as the number and complexity of invariants increases.forexample theidsconsumesthemaximummemory usage .
mb when it uses the perfume generated invariants which straddle two dimensions and have the maximum number of invariants table .
overall we ind that the memory consumption of the ids with artinali generated invariants is lower than those with perfume or texada generated invariants but higher than those with daikon generated invariants.
however the memory usage for all tools is much lower than the available memory insegmeter mb .
.
rq5.
performance overhead in this section we discuss the performance overhead of our ids running on the segmeter platform.
recall that the ids consists of two components namely tracing module and intrusion detector module.
table middle part shows the overheads of the two modules separately for each tool.
each of these measurements is an average of the overhead of execution traces for each tool where an execution trace is deined as one complete execution of the meter s main loop.
we ind that artinali and perfume havethehighestaggregateoverhead followedbydaikon andthen texada.thediferenceintheoverheadisduetothediferencein thetracingmodule whichneedstocollectbotheventanddata time information for artinali and perfume compared with texada eventsonly anddaikon data only .
in addition to the performance overheads the ids execution time should be lower than the execution time of the system s cycle orelseit willbeunabletokeepupwiththe system.we measure the raw execution times of a full cycle in table last part .
as can beseenfromthetable theentirecycletakesabout60seconds minute .
however the execution of the ids for each tool takes less than20secondsevenintheworstcase forperfume whichisonly a third of execution time of the full cycle.
therefore the ids is not abottleneckinanyofthefoursystems andiseasilyabletokeep upwiththe system.notethattheinvariantminingprocesstakesplaceoline and hence does not contribute to the performance overhead of the idsrunningonthecpsplatform.nonetheless wemeasuredthe time to mine invariants using artinali on a standard desktop system intel core i7 processor with gb ram .
we found that thetimerangesfrom8to96secondsinsegmeter andfrom6to 36secondsinopenaps.thoughthisoverheadmaybehigherfor largersystems thisprocessneedstobedoneonlyonacodeupdate.
discussion inthissection weirstexaminethethreatstothevalidityofourexperiments followed by relections on artinali s generalizability.
threats to validity anexternal threat to the validity is the limitednumberofcpsplatformsconsidered two .however aswe have mentioned indingcpsplatformsthat arepubliclyavailable and security critical is a challenge.
we have attempted to mitigate this threat by choosing two fairly diverse platforms with diferent tradeofs in terms of fp and fn ratios.
we acknowledge that these platforms exhibit somewhat simple behaviors however many cpsesfallintothiscategory .aninternalthreat tovalidityisin our evaluation of the eicacy of the invariants for attack detection throughfaultinjectionexperiments.whilenotnecessarilyrepresentativeofallsecurityattacks faultinjectionallowsustoemulate thebehaviorofpotentialattackers without biasing theevaluation towardsknownvulnerabilities atthetime oftheevaluation .we have attempted to mitigate this threat by using mutation operators that were used for emulatingattacksin prior work .
finally a constructthreat tovalidityistheevaluationmetricsusedformeasuringeicacy.fpandfnratioshavehoweverbeenusedinalot ofpriorworkonintrusiondetection ashavef scores andhence we do not believe this is a signiicant threat.
another potential constructthreatisthechoiceoftoolsweuseforcomparingwith artinali butwemitigatedthistoanextentbyirstsystematically classifying the space of invariant detection techniques and then choosing the toolsineachcategory.
generalizability of artinali artinali relies upon two features namely event based semantics andconditional independence of time and data section .
.
events are operations that involve interaction with the outside world.
event based semantics implies that every event takes place in a unique time frame and hence there is no concurrency among event executions.
secondly artinali assumes an event occurs at a speciic time interval and subsequently datavariablesareassignedtospeciicvalues.thus the time and data corresponding to a particular event are conditionally independent regardlessofthe dependency among events.
thesetwo features are acommonparadigm for cpses andhence artinalican be generalizedto othercps platforms.
however artinali is not applicable to non cps platforms for two reasons.
first the non concurrency of events does not holdinnon cpsplatformssuchasmobilephones.secondly cps events have limited functionality and hence inferring invariants for each event is straightforward.
unlike cpses in general realtime systems tasks can be of unbounded complexity.
furthermore general purpose computers with full preemptive i.e.
non realtime operatingsystemshave a largespace of behaviors.
therefore learninginvariantsfor such systemsischallenging.
360artinali dynamicinvariant detectionfor cyber physicalsystemsecurity esec fse september4 8 paderborn germany conclusion cyber physical systems cpses are becoming increasingly subject tosecurityattacksduetotheirinterconnectednessandrelativelack ofprotection.inthispaper weattempttousedynamicinvariant detectiontechniquestobuildintrusiondetectionsystemsforcpses.
ourkeyinsightisthattimeisairstclassconstraintincpssystems and hence we incorporate time into the invariants in addition to data and events.
we devise an eicient algorithm for learning invariants over the three dimensions of data events and time and implementitinatoolcalledartinali.wedemonstratetheuseof artinaliontwo cpsplatforms for intrusiondetection.
we ind that artinali has signiicantly lower false negatives and false positives thanotherdynamicinvariantdetection tools.
acknowledgement this work was supported in part by the natural sciences and engineeringresearchcouncil ofcanada nserc andthe mitacs.