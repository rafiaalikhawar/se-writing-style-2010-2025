on evidence preservation requirements for forensic ready systems dalal alrajeh imperial college london london ukliliana pasquale university college dublin dublin irelandbashar nuseibeh the open university uk lero ireland abstract forensic readiness denotes the capability of a system to support digital forensic investigations of potential known incidents by preserving in advance data that could serve as evidence explaining how an incident occurred.
given the increasing rate at which potentially criminal incidents occur designing software systems that are forensic ready can facilitate and reduce the costs of digital forensic investigations.
however to date little or no attention has been given to how forensic ready software systems can be designed systematically.
in this paper we propose to explicitly represent evidence preservation requirement s prescribing preservation of the minimal amount of data that would be relevant to a future digital investigation.
we formalise evidence preservation requirements and propose an approach for synthesising specifications for systems to meet these requirements.
we present our prototype implementation based on a satisfiability solver and a logic based learner which we use to evaluate our approach applying it to two digital forensic corpora.
our evaluation suggests that our approach preserves relevant data that could support hypotheses of potential incidents.
moreover it enables significant reduction in the volume of data that would need to be examined during an investigation.
ccs concepts software and its engineering requirements analysis applied computing evidence collection storage and analysis keywords forensic ready systems requirements specification synthesis acm reference format dalal alrajeh liliana pasquale and bashar nuseibeh.
.
on evidence preservation requirements for forensic ready systems.
in proceedings of 11th joint meeting of the european software engineering conference and the acm sigsoft symposium on the foundations of software engineering paderborn germany september esec fse pages.
introduction digital forensic investigations are concerned with the discovery collection preservation analysis interpretation and presentation permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse september paderborn germany association for computing machinery.
acm isbn .
.
.
.
digital data from digital sources for proof of incident and ultimately for prosecution of criminal activity .
such data often comprises log entries indicating the occurrence of events in the digital sources placed within the environment in which an incident can occur.
despite the availability of digital forensics tools for evidence acquisition and examination e.g.
these tools are designed to be used only after an incident occurs and an investigation commences.
however some of the relevant data may not be available then because for example it was stored in a volatile memory or it has been intentionally tampered with by an offender.
moreover digital forensic tools do not select among the data that might be relevant for investigating a specific incident thus requiring investigators to sift through large volumes of data to determine what may be considered as relevant evidence.
this can be a cumbersome and an error prone process .
software systems should be forensic ready i.e.
able to support digital forensic investigations of potential known incidents by preserving in advance data that may serve as evidence explaining how an incident occurred.
given the increasing rate at which potentially criminal incidents occur designing software systems that are forensic ready can facilitate and reduce the costs of digital forensic investigations.
however existing research has provided only generic guidelines capturing operational and infrastructural capabilities for organisations to achieve forensic readiness .
little or no attention has been given to how forensic ready systems can be designed and verified systematically nor to how to ensure their suitability for the specific environments in which they will be deployed .
without a formal conceptualisation of a forensicready system and a software design methodology for achieving it ensuring the soundness of any automated investigative process or its outcome becomes difficult or even impossible .
forensic ready systems should satisfy evidence preservation requirements i.e.
ensure preservation of relevant andminimal evidence.
on the one hand preservation of an excessive amount of data often introduces resource and performance issues and increases the cognitive load on investigators who have to make sense of a large data set.
on the other hand preservation of an insufficient amount of data provides an incomplete picture of how an incident would have occurred thus making way for misguided decisions and potentially wrong convictions .
this paper addresses some of the challenges in the systematic design of forensic ready systems by making the following contributions i precise definition of evidence preservation requirements and the concepts upon which these requirements depend ii a method for generating preservation specifications that satisfy evidence preservation requirements and iii a prototype tool for generating such specifications automatically which we use to evaluate our approach.
more specifically we first provide formal definitions esec fse september paderborn germany dalal alrajeh liliana pasquale and bashar nuseibeh of the domain model of a forensic ready system including the environment in which incidents may occur and hypotheses about such incidents.
we also formalise preservation specifications and requirements.
we then present a synthesis approach that combines deductive reasoning and inductive learning to generate preservation specifications from a formal description of an environment and hypotheses.
to the best of our knowledge this is the first work that conceptualises the requirements of evidence preservation and demonstrates its benefits in reducing data needed to be examined during an investigation.
in this work we assume a domain expert provides a set of correct incident hypotheses.
to achieve this aim s he can follow a proper risk assessment methodology using approaches such as over the threats incidents considered most likely and highly critical.
specifications are expressed declaratively in linear temporal logic ltl a commonly used formalism for specifying a system behaviour and prescribe constraints over when events happening at the digital sources in the environment must be logged.
we also assume that a designated software controller the forensic readiness controller is responsible for the enactment of the specification by interacting with the digital sources through a uniform interface.
we evaluate our approach by applying it to two substantive case studies publicly available.
our evaluation suggests that our approach preserves relevant data to explain potential incidents and enables significant reduction in the volume of data that would need to be examined during an investigation.
the rest of the paper is organised as follows.
section presents a motivating example and an overview of our approach.
sections and formalise the domain model of a forensic ready system and preservation specifications and requirements.
sections and explain our approach to generate specifications and its implementation.
section presents the results of our evaluation.
section gives an overview of related work and section concludes.
motivating example and overview we motivate our work using an example of a corporate fraud incident inspired by the galleon group case .
we consider an environment within an enterprise building where two employees bobandalice work and are provided with laptops m2 andm3 respectively by the company.
a sensitive document docis stored on the server machine m1located in the office r01.
access tor01is controlled by an nfc reader nfc and is monitored by a cctv camera cctv .
both alice andbobare authorised to access r01and to login to m1.
suppose that a digital investigation related to the exfiltration of thedocis initiated.
an investigator may hypothesise that the doc was copied onto a storage device mounted on m1.
to verify this she must first speculate the activities that may have occurred within the environment and reconstruct different possible scenarios based on these activities.
a possible scenario is that alice enters room r01 logs into m1 mounts usb1 onm1andcopies doconto usb1.
another is that bobenters room r01butlogs into m1using alice s credentials and then copies thedoconto usb1.
once the scenarios have been identified the investigator must establish which of the digital devices holds data that might be relevant to the scenarios.
then she must search through the storage of employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfccamera cctv storage usb1 a fr controllerstorage domain expertenvironmenthypotheses investigatorspecificationgenerationpspreserve event cctvnfc computer receive event b figure setting of our example a and overall approach b these devices e.g.
logs for all readers and cctvs and hard drives for all computers for relevant information.
however the investigator may fail to find information about storage devices mounted on m1because the system log of m1only retains information about the last device that was mounted.
the large number of events that can occur also does not make it plausible to preserve all events in advance for later examination.
for example corporate computers can generate over millions of events per week1 while the number of accesses recorded by cctv cameras and card readers can exponentially grow with the number of employees and rooms in a building.
moreover not all the events are relevant to support the speculated scenarios.
for instance only copies of the doctaking place while a storage device is mounted and a user is logged on m1 are relevant for our example.
our approach aims to design a fr controller thatreceives events from digital sources within the environment and selectively preserves them in a secure storage.
these events can be acquired and examined by an investigator during future digital investigations.
we provide an automated approach specification generation to generate a preservation specification ps for the fr controller.
we assume a domain expert e.g.
security administrator or software engineer provides a description of the environment and a predefined set of hypotheses about incidents of concern.
the description of the environment also includes information about what activities can be monitored by the digital sources.
to generate a specification we first check whether the hypotheses are feasible within the environment i.e.
they may hold if certain activities take place in the environment .
if this is the case the approach generates a set of possible sequences of low level system events called potential histories that demonstrate this.
the approach then verifies whether the existing specification already ensures the preservation of events that correspond to these generated histories.
if not then our approach inductively synthesises a preservation specification that configures when an event occurring in a digital source within 1we estimated having events per second eps during non peaks and eps during peaks.
an organisation that experiences peaks for of the total time will have an average of eps eps for non peak and for peak .
560on evidence preservation requirements for forensic ready systems esec fse september paderborn germany the considered environment should be preserved according to their relevance to the hypotheses.
for our motivating example our approach would prescribe preservation of events indicating copies of the doconly if a storage device was previously mounted and a user has previously logged on m1.
in the next two sections we define the artefacts which constitute the domain of a forensic ready system environment histories and hypotheses and their relation to preservation specifications and requirements.
forensic domain model we provide here a formal underpinning of the concepts and terminology that are commonly used in digital forensic domain to describe the environment in which an incident can occur histories and the incident hypotheses.
.
environment description the environment description is a set of descriptive statements about i the context in which an incident may occur ii the behaviour that may be exhibited within the environment and iii their interactions .
acontext description cis a collection of descriptive non behavioural declarations about the types e.g.
employees and locations and instances of entities present in an environment e.g.
boband r01 and relations between instances such as bobis entitled to access r01 hasbadge bob r01 .
definition .
context description .
a context description cis a tuple y i k where yis a set of types ia set of instances i yis function that assigns an instance in ito its type in y andkis a set of context relations over instances in i such that for every k k k i1 ... in.
we denote the universe of context relations as k. acontext relation literal is an expression of the form kor kfor some k k. given a set of context relation literals kl we write kl to denote the set of unique context relations in kl.
returning to our running example a context description in this case includes types such as emp andcomp instances including bob andm1with assignments bob emp and m1 comp and context relations such as islocatedin m1 r01 meaning that computer m1is placed in location r01 and isstoredin doc m1 meaning that docis stored in m1.
abehavioural description bspecifies the events that may occur within an environment.
in a digital investigation setting these may be at different levels of abstraction.
similar to we distinguish between two types of events to represent these levels of abstraction primitive and complex.
a primitive event represents the occurrence of an atomic action that can be observed by an investigator from a digital device e.g.
using a hard drive analysis tools .
an example of primitive event can be swipe card alice nfc indicating the nfcreading alice s card tag.
a complex event indicates the execution of complex human activities and can involve one or more primitive events other complex events and contextual conditions.
for example a complex event indicating alice entering room r01involves the following primitive events alice s card tag being read by the nfcreader and her entrance in r01being recorded by the cctv.
these events can happen at the same time or in any order.
the complex event also involves the following contextualconditions alice is not inside r01and does not possess a badge to access r01.
this is expressed through a composite definition.
definition .
composite definition .
letapandacbe the universe of primitive and complex events respectively.
a composite definition is a tuple ap ac kl l where ap ap ac ac kl k lis a finite set of time labels l lis a partial order relation over l that is reflexive anti symmetric and transitive and l p ap ac kl is a labelling function.
letdbe a set of composite definitions.
we define a relation ac d to associate a composite definition d d with the complex event e acit defines.
in our example the complex event enter alice r01 may be defined as enter alice r01 swipe card alice nfc cctv access alice r01 cctv1 in alice r01 hasbadge alice r01 l1 l2 l1 swipe card alice nfc in alice r01 hasbadge alice r01 l2 cctv access alice r01 cctv1 in alice r01 .
for our example to trigger complex event enter alice r01 primitive events swipe card alice nfc and cctv access alice r01 cctv1 can occur in any order however both have to occur.
when swipe card alice nfc and cctv access alice r01 cctv1 occur alice should not be in r01.
moreover alice should be authorised to access r01 hasbadge when swipe card alice nfc occurs.
moreover complex event mount usb1 m1 event occurs when the system log in m1records the mounting of a storage device primitive event sys mount usb1 m1 while alice orbobare logged to m1 context condition lo ed e m1 .
this is defined as mount usb1 m1 sys mount usb1 m1 lo ed e m1 l1 l1 sys mount usb1 m1 lo ed e m1 .
a behavioural description includes the composite definitions associated with the complex events that can occur in the environment.
a behavioural description is formally defined as follows.
definition .
behavioural description .
a behavioural descriptionbis a tuple ap ac k d such that for every e d e ac d ld d d ap d ac d kld d ap d ap ac d acand kld k .
complex events are expected to interact and bring about changes to the context in which they occur.
to capture this effect we adopt notions of fluents for event driven systems .
given the set kof context relations each k k is defined by two disjoint sets of complex events from ac called initiating and terminating events respectively and an initial value true or false written according to the following schema k ink trk initk such that ink trk andink trk ac.
the set of associations of this form are called interaction definitions and are denoted i. in our running example the interaction definition of context relation in alice r01 is defined by enter alice r01 exit alice r01 false .
this interaction indicates that context relation in alice r01 is initially false it is initiated by complex event enter alice r01 and terminated by complex event exit alice r01 .
fromc bandiwe define an environment description.
definition .
environment description .
an environment descriptioneis a tuple c b i wherec y i k is a context description b ap ac k d a behavioural description andiis a set of context relation definitions such that k ink trk initk i .k k andink trk ac.
561esec fse september paderborn germany dalal alrajeh liliana pasquale and bashar nuseibeh .
histories ahistory is a sequence of concurrent events that captures the evolution of an environment in which the digital devices and evidence sources operate .
it is potential if it refers to at least one event that has been speculated and actual if all the events have been observed from digital sources within the environment.
in this paper we focus on potential histories for defining preservation requirements.
a history may describe events at various levels.
it is called a primitive resp.
complex history denoted resp.
if all the events that appear in it are primitive resp.
complex .
we write ce1 ...cento denote a complex history where ceiis the set of complex events occurring concurrently at position i and similarly for a primitive history .
an environment description eis interpreted over a sequence of primitive and complex events referred to as a hybrid history .
its satisfaction is determined with respect to the satisfaction of complex events composite definitions in bw.r.t.
toi.
for the satisfaction of an event s composite definition we consider the notion of a narration a total order over the partial order given in a complex event s definition .
for a narration to be constructed each complex event appearing in a definition is refined until all complex events are reduced to their primitive events and context relation literals.
the result of this refinement procedure applied to definition dis a set of composite definitions d .
given d a narration of dis captured with respect to one of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events in ap resp.
ac .
definition .
narration of composite definition .
letb ap ac k d be a behavioural description and d ld d d ap d ac d kld a composite definition in d. let d be the set of definitions obtained refining d. a narration of dis a hybrid history he1 ... hem if there exists a d d and a total order l1 ... lnover ld such that for all li lj ld ifli ljthen a b where a b m d li ap hea ap d li ac hea ac.
where l apand l acdenote the set of primitive events and complex events respectively assigned to time label l. for instance the following are three example narrations for enter alice r01 s composite definition 1 swipe card alice nfc cctv access alice r01 cctv1 enter alice r01 2 swipe card alice nfc cctv access alice r01 cctv1 enter alice r01 3 cctv access alice r01 cctv1 swipe card alice nfc enter alice r01 interaction descriptions are interpreted over complex histories.
given k ink trk initk i kis true at position bin a complex history ce1 ... ceb ... ceniff either the following holds initk a n etrk trk.
a b etrk cea 2see for an outline of a refinement algorithm for obtaining d .
a n. a b eink cea n etrk trk.
a b etrk ce otherwise it is said to be false.
we assume histories in which terminating and initiating events for a context relation do not occur concurrently.
we define below satisfaction of a complex event.
definition .
complex event satisfaction .
given an environment description e b c i a composite definition dassociated with complex event e e d b and a hybrid history is said to satisfy e dwith respect toeif for every decomposition xyz if y hea ... he ... hebis a narration of dwith respect to d d and order l ... l j ... l nthen e heb ac ifkl d l j klthen ac kl where l kldenotes the set of context relation literals assigned to time label l. the environment description eis said to be satisfied in a hybrid history if every complex event in acis satisfied in that history.
we write e to denote the set of hybrid histories that satisfy e. figure shows a hybrid history satisfying eof our example.
we project the primitive and complex events composing the hybrid history onto primitive and complex histories respectively.
the primitive history represents the case in which the nfcreads alice s card tag the cctvrecords alice passing through the door ofr01 and m1logs the login performed by user bob the mount of storage device usb1 the copy od the docby user bob and theunmount ofusb1.
if a portion of the primitive history represents a narration of a composite definition associated with a complex event such event is assumed to occur.
for example the sequence of primitive events at time 1and 2corresponds to narration v2of the composite definition of enter alice r01 .
while the primitive event at time 4represents a narration for the composite definition of event mount usb1 m1 .
on top of figure we indicate the context relations that hold at each time instant and omit those that are not satisfied e.g.
mounted usb1 m1 starts holding when complex event mount usb1 m1 occurs and stops holding when complex event unmount usb1 m1 happens.
legendprimitive eventcomplex eventswipe card alice nfc 1345primitivehistorycctv access alice r01 cctv sys login bob m1 sys mount usb1 m1 sys copy bob doc m1 enter alice r01 contextrelationscomplexhistorylogin bob m1 mount usb1 m1 copy bob doc m1 sys unmount usb1 m1 6unmount usb1 m1 2logged bob m1 mounted usb m1 in alice r01 logged bob m1 in alice r01 in alice r01 in alice r01 logged bob m1 mounted usb m1 logged bob m1 in alice r01 figure example of hybrid history .
hypotheses the term hypothesis in a digital investigation is a conjecture that may refer for instance to past events in the lifetime of digital devices .
in this paper we focus on one type of hypothesis 562on evidence preservation requirements for forensic ready systems esec fse september paderborn germany relevant to developing forensic ready systems the environment construction hypothesis .
this form of hypothesis postulates about the feasibility of events occurrence and presence of contextual conditions of interests within the environment.
it may be captured as an event s composite definition h d where his a complex event marking the satisfaction of a hypothesis and with apind being empty and acandklcontaining only complex events and context relation literals respectively.
the events and the contextual conditions expressed in the hypothesis represent how an incident may occur within the environment.
the incident of our example refers to the unauthorised exfiltration of the sensitive document doc.
one way in which the doccan exfiltrate is because an unauthorised copy to an external storage device was performed.
this hypothesis is defined as illegalcopy copy bob doc m1 mounted usb1 m1 l1 l1 mounted usb1 m1 copy bob doc m1 in other words a copy of the document is performed while an external storage device usb1 is mounted on m1.
hypotheses are interpreted over finite complex histories.
their satisfaction is given by the definition below.
definition .
hypotheses satisfaction .
a hypothesis h with definition h d is said to be satisfied in a complex history at position b i.e.
b h if there exists a decomposition xyz such thaty cea ... ce ... cebis a narration of dwith respect to d d and order l ... l j ... l nand if kl d l j kl then ac kl.
we distinguish between supportable andrefutable hypotheses in environmente.
definition .
hypotheses supportability and refutability .
let e be the set of hybrid histories satisfying e. a hypothesis h with definition h d is said to be supportable ineif there exists a hybrid history e such that for some b ac b h. it is said to be refutable if there exists a history e such that for allb ac b h. we sometime abstract away from the position band write ac h for a history satisfying hat some point b. we will denote the set of hybrid histories in e supporting at least one hypothesis in has e and those refuting every hypothesis in has e .
returning to our example the illegalcopy hypothesis is supportable in our example environment e since there exists a decomposition of a hybrid history see figure satisfying e that yields a narration of the definition of the illegalcopy hypothesis i.e.
x swipe card alice nfc cctv access alice r01 cctv1 enter alice r01 sys login bob m1 login bob m1 sys mount usb1 m1 mount usb1 m1 y sys copy bob doc cctv1 copy bob doc cctv1 z sys unmount usb1 m1 such that ac mounted usb1 m1 .
as we will see later in section we are interested in minimal hybrid histories that satisfy a hypothesis.
we define minimality of histories with respect to hypotheses as follows.
definition .
.
let e be a set of hybrid histories satisfying eandhbe a hypothesis supportable bye.
the hybrid history he1 ... hem e is said tobe minimally supportive of hineiff the history obtained be removing any primitive event a apfrom hei apof is in e and no longer supports h. for instance the hybrid history in figure is not minimally supportive of the hypothesis illegalcopy since the history obtained by removing sys unmount usb1 m1 from 6 apstill satisfies illegalcopy .
we sometimes write min h resp.
min h as a shorthand for the minimally supportive history v resp.
histories of h obtained from .
preservation specifications we are concerned with deriving specifications psfor a forensic readiness controller comprising domain pre and post conditions as well as required pre and trigger conditions expressed in ltl.
these conditions control the execution of operations of the form preserve a ts where aindicates the occurrence of a primitive event in the environment and tsmarks the time stamp from the system clock at which the occurrence was observed by the fr controller.
we consider tsito be an abstraction over real time clock variables that may be obtained following techniques such as .
the generation of such abstractions is outside the scope of the paper.
we assume an ordered set of timestamps to be isomorphic to the set of natural numbers.
the domain pre condition of operation preserve a ts specifies that this operation cannot take place if the occurrence of event aattshas already been preserved.
the domain post condition specifies that operation preserve a ts ensures preservation of the occurrence of event aattsin the next time instant.
we assume these ar given for each operation.
we assertions and specify respectively the domain pre and post conditions of operation preserve sys copy e d m ts ts timestamp e emp d doc m comp g preserved sys copy e d m ts preserve sys copy e d m ts g preserve sys copy e d m ts xpreserved sys copy e d m ts required pre conditions are assertions that condition the execution of preserve a ts upon having received notification about the occurrence of a primitive event in the environment receive a ts .
required trigger conditions are conditions upon the non preservation of other primitive events.
an example of a preservation specification of operation preserve sys copy e d m ts is ts timestamp e emp d doc m comp g received sys copy e d m ts x preserve sys copy e d m ts ts timestamp e emp d doc m comp ts1 ts2 timestamp .ts1 ts2 ts2 ts g received sys copy e d m ts preserved sys login e d m ts1 preserved sys mount s m ts2 ts3 ts4 timestamp .
ts3 ts1 ts3 ts ts4 ts2 ts4 ts preserved sys logout e m ts3 preserved sys unmount s m ts4 xpreserve sys copy e d m ts assertion specifies the required pre condition i.e.
receiving notification of the occurrence of sys copy e d m .
assertion expresses 563esec fse september paderborn germany dalal alrajeh liliana pasquale and bashar nuseibeh a trigger condition forcing the fr controller to preserve occurrence ofsys copy e d m if it has already preserved information about an employee s logging onto a computer and the mounting of a storage device on that computer but no subsequent occurrence about the employee logging out or unmounting of the storage device is recorded.
the preservation specification psdefines a fr controller s storage capacities as a set of executable sequences of preserve operations of the form preserve a1 ts1 ... preserve ak ts1 ... preserve a1m tsm ... preserve arm tsm m we say that is a potential log if satisfies ps according to standard trace semantics of ltl and for each preserve ai j tsj j its required trigger condition is non vacuously satisfied in at position j. the notation j indicates the set of operations that occur at position j. we restrict our definition of preservation specifications to those that ensure the minimality and relevance of all potential logs to hypotheses under consideration.
such a specification is referred to as forensic ready.
to express forensic ready preservation specifications we first consider the notion of a specification covering potential histories.
definition .
.
let psbe a preservation specification and he1 ... hen a hybrid history.
then psis said tocover iff there exists a potential log fe1 ... fen ps isomorphic to ap i.e.
for every primitive event a hei ap preserve a tsi fei.
the isomorphism with respect to potential histories guarantees the preservation of events related to an incident.
furthermore since the isomorphism is defined with respect to minimally supportive histories of hypotheses in hthis ensures minimality of preserved event occurrences.
it also together with the requirement for hypotheseshto be refutable by potential histories of e e supports relevance of events stored through preserve operations.
definition .
.
let ebe an environment description and ha hypothesis that is both supportable and refutable ineby e and e respectively.
let psbe a preservation specification.
then psis said to be forensic ready with respect tohineiffpscovers every history in min e h for every h h and does not cover any e .
any fr controller whose specification is forensic ready with respect tohineis sufficient to guarantee evidence preservation requirements of relevance and minimality.
specification generation based on our formulation above we propose a systematic approach figure for generating forensic ready preservation specifications.
our approach takes as input an environment description e a set of speculative incident hypotheses h elicited for instance by a domain expert and an initial preservation specification ps written in ltl which contains domain pre and post conditions of preservation operations.
we assume that the description of the environment is correct and the speculative hypotheses of concern are known at design time.
the approach provides as output either i a confirmation that some hypotheses are not supportable in the environment ii a confirmation that the fr controller does not have the capabilities to ensure the forensic readiness of itspreservation specification or iii a preservation specification that is guaranteed to be forensic ready with respect to hine.
the approach comprises three phases as described below.
someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesise h e e our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes history generation1yes a revise preservation specification synthesisyesspecificationverificationspecificationsynthesis23no b to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalnodomain expertenvironment hypotheses a someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesise h e our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes softwareengineer history generation1yes revise preservation specification synthesisnospecificationverificationspecificationsynthesis23environment a history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil yesa history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements .
the controlled oper ations for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved by the controller in the storage if the latteralready contains entries about the occurrences of employee slogging to a computer and the mounting of a storage device onit and no entries about employee s logging out from computerand unmounting of the storage device from the computer arestored.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.
we...definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesisour approach for synthesising the preservation specification see figure requires as input an environment descriptione and a set of speculative incident hypotheseshthat aresupportable and refutable bye.
such inputs can be provided for instance by the software engineer.
we assume that thedescription of the environment is correct and the speculativehypotheses are known a priori before an investigation starts.preservation specification synthesis is performed in threephases.
history generation.in this phase we search for hybridhistories e and e with respect toh.
the existenceof histories in e ensures that the hypotheses of inter est are feasible within the intended environment.
if e is empty this means that the either the hypothesis cannotoccur within the environment described and thus may notbe a security concern or that the environment descriptionand or the speculative hypotheses are incorrect and need tobe revised e.g.
by a security administrator .
the histories e operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.
specification verification.given the generated e wecheck if the primitive history projection for each history is covered by the preservation specification i.e.
there existscorresponding potential log.
if this is the case then thecurrent preservation specificationossatisfies the preservationrequirements and the process terminates.
if some primitivehistory projection is not then new operational preservationspecification must be synthesised in the next phase.
specification synthesis.the synthesis aims to learn anewreqpreand required trigger conditionsreqtrighat wouldprescribe the preservation of the potential histories e and not those in e .
the output is a set of required pre conditions .
the new specificationos0is given as input to theforensic ready controller that is responsible for its enactmentduring the system operation.to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalhypotheses no fig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesis e our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes softwareengineerhistory generation1yes revise preservation specification synthesisnospecificationverificationspecificationsynthesis23environment a history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil yesa history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements .
the controlled oper ations for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved by the controller in the storage if the latteralready contains entries about the occurrences of employee slogging to a computer and the mounting of a storage device onit and no entries about employee s logging out from computerand unmounting of the storage device from the computer arestored.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.
we...definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesisour approach for synthesising the preservation specification see figure requires as input an environment descriptione and a set of speculative incident hypotheseshthat aresupportable and refutable bye.
such inputs can be provided for instance by the software engineer.
we assume that thedescription of the environment is correct and the speculativehypotheses are known a priori before an investigation starts.preservation specification synthesis is performed in threephases.
history generation.in this phase we search for hybridhistories e and e with respect toh.
the existenceof histories in e ensures that the hypotheses of inter est are feasible within the intended environment.
if e is empty this means that the either the hypothesis cannotoccur within the environment described and thus may notbe a security concern or that the environment descriptionand or the speculative hypotheses are incorrect and need tobe revised e.g.
by a security administrator .
the histories e operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.
specification verification.given the generated e wecheck if the primitive history projection for each history is covered by the preservation specification i.e.
there existscorresponding potential log.
if this is the case then thecurrent preservation specificationossatisfies the preservationrequirements and the process terminates.
if some primitivehistory projection is not then new operational preservationspecification must be synthesised in the next phase.
specification synthesis.the synthesis aims to learn anewreqpreand required trigger conditionsreqtrighat wouldprescribe the preservation of the potential histories e and not those in e .
the output is a set of required pre conditions .
the new specificationos0is given as input to theforensic ready controller that is responsible for its enactmentduring the system operation.to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalhypotheses nofig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described b someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesise h e os os our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes softwareengineer history generation1yes revise preservation specification synthesisnospecificationverificationspecificationsynthesis23environment a history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil yesa history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements .
the controlled oper ations for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved by the controller in the storage if the latteralready contains entries about the occurrences of employee slogging to a computer and the mounting of a storage device onit and no entries about employee s logging out from computerand unmounting of the storage device from the computer arestored.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.
we...definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesisour approach for synthesising the preservation specification see figure requires as input an environment descriptione and a set of speculative incident hypotheseshthat aresupportable and refutable bye.
such inputs can be provided for instance by the software engineer.
we assume that thedescription of the environment is correct and the speculativehypotheses are known a priori before an investigation starts.preservation specification synthesis is performed in threephases.
history generation.in this phase we search for hybridhistories e and e with respect toh.
the existenceof histories in e ensures that the hypotheses of inter est are feasible within the intended environment.
if e is empty this means that the either the hypothesis cannotoccur within the environment described and thus may notbe a security concern or that the environment descriptionand or the speculative hypotheses are incorrect and need tobe revised e.g.
by a security administrator .
the histories e operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.
specification verification.given the generated e wecheck if the primitive history projection for each history is covered by the preservation specification i.e.
there existscorresponding potential log.
if this is the case then thecurrent preservation specificationossatisfies the preservationrequirements and the process terminates.
if some primitivehistory projection is not then new operational preservationspecification must be synthesised in the next phase.
specification synthesis.the synthesis aims to learn anewreqpreand required trigger conditionsreqtrighat wouldprescribe the preservation of the potential histories e and not those in e .
the output is a set of required pre conditions .
the new specificationos0is given as input to theforensic ready controller that is responsible for its enactmentduring the system operation.to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalhypotheses no fig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described fig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described and thus it will not required to be considered during a digitalinvestigation or that the environment description and or the history generation1yes a revise specification generationnospecificationverificationspecificationsynthesis23yes b nodomain expertenvironment hypotheses a someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesise h e e our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes history generation1yes a revise preservation specification synthesisyesspecificationverificationspecificationsynthesis23no b to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalnodomain expertenvironment hypotheses a someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesise h e our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes softwareengineer history generation1yes revise preservation specification synthesisnospecificationverificationspecificationsynthesis23environment a history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil yesa history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements .
the controlled oper ations for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved by the controller in the storage if the latteralready contains entries about the occurrences of employee slogging to a computer and the mounting of a storage device onit and no entries about employee s logging out from computerand unmounting of the storage device from the computer arestored.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.
we...definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesisour approach for synthesising the preservation specification see figure requires as input an environment descriptione and a set of speculative incident hypotheseshthat aresupportable and refutable bye.
such inputs can be provided for instance by the software engineer.
we assume that thedescription of the environment is correct and the speculativehypotheses are known a priori before an investigation starts.preservation specification synthesis is performed in threephases.
history generation.in this phase we search for hybridhistories e and e with respect toh.
the existenceof histories in e ensures that the hypotheses of inter est are feasible within the intended environment.
if e is empty this means that the either the hypothesis cannotoccur within the environment described and thus may notbe a security concern or that the environment descriptionand or the speculative hypotheses are incorrect and need tobe revised e.g.
by a security administrator .
the histories e operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.
specification verification.given the generated e wecheck if the primitive history projection for each history is covered by the preservation specification i.e.
there existscorresponding potential log.
if this is the case then thecurrent preservation specificationossatisfies the preservationrequirements and the process terminates.
if some primitivehistory projection is not then new operational preservationspecification must be synthesised in the next phase.
specification synthesis.the synthesis aims to learn anewreqpreand required trigger conditionsreqtrighat wouldprescribe the preservation of the potential histories e and not those in e .
the output is a set of required pre conditions .
the new specificationos0is given as input to theforensic ready controller that is responsible for its enactmentduring the system operation.to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalhypotheses no fig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesis e our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes softwareengineerhistory generation1yes revise preservation specification synthesisnospecificationverificationspecificationsynthesis23environment a history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil yesa history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements .
the controlled oper ations for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved by the controller in the storage if the latteralready contains entries about the occurrences of employee slogging to a computer and the mounting of a storage device onit and no entries about employee s logging out from computerand unmounting of the storage device from the computer arestored.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.
we...definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesisour approach for synthesising the preservation specification see figure requires as input an environment descriptione and a set of speculative incident hypotheseshthat aresupportable and refutable bye.
such inputs can be provided for instance by the software engineer.
we assume that thedescription of the environment is correct and the speculativehypotheses are known a priori before an investigation starts.preservation specification synthesis is performed in threephases.
history generation.in this phase we search for hybridhistories e and e with respect toh.
the existenceof histories in e ensures that the hypotheses of inter est are feasible within the intended environment.
if e is empty this means that the either the hypothesis cannotoccur within the environment described and thus may notbe a security concern or that the environment descriptionand or the speculative hypotheses are incorrect and need tobe revised e.g.
by a security administrator .
the histories e operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.
specification verification.given the generated e wecheck if the primitive history projection for each history is covered by the preservation specification i.e.
there existscorresponding potential log.
if this is the case then thecurrent preservation specificationossatisfies the preservationrequirements and the process terminates.
if some primitivehistory projection is not then new operational preservationspecification must be synthesised in the next phase.
specification synthesis.the synthesis aims to learn anewreqpreand required trigger conditionsreqtrighat wouldprescribe the preservation of the potential histories e and not those in e .
the output is a set of required pre conditions .
the new specificationos0is given as input to theforensic ready controller that is responsible for its enactmentduring the system operation.to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalhypotheses nofig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described b someb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements .
the controlled opera tions for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved if the controller already preserved infor mation about an employee s logging onto a computer and themounting of a storage device on it but not a subsequent entryabout his her logging out or unmounting of the storage device.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesise h e os os our approach for synthesising the preservation specification see fig.
takes as input an environment descriptione and aset of speculative incident hypothesesh elicited for instance by a domain expert software engineer or security administra tor .
we assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design time.
the approach comprises three phases.
yes softwareengineer history generation1yes revise preservation specification synthesisnospecificationverificationspecificationsynthesis23environment a history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil yesa history may occur at various levels .
it is called aprimitive resp.
complex history denoted resp.!
if allthe events that appear in it are primitive resp.
complex .wewrite!
ce1 .
.
.cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni and similarly for a primitive history .an environment descriptioneis interpreted over a sequenceof primitive and complex events we refer to as a hybridhistory .
its satisfaction is determined with respect to thesatisfaction of complex events composite definitions inbaccording toi.for the satisfaction of an event s composite definition weconsider the notion of a narration a total order over thepartial order given in a complex event s definition .
for anarration to be constructed each complex event appearing ina definition is refined until all complex events are reduced totheir primitive events and context relation literals.
the resultof this refinement procedure applied to definitiondis a set ofcomposite definitions d .
note that context relation literalsare not refined by their initiating and terminating events.1given d a narration of adis captured with respect toone of the elements in d .
we will use the notation ap reps. ac to denote the projection of over primitive reps. complex events inap resp.ac .definition narration of composite definition letb hap ac k d ibe a behaviour description andd hld d d apd acd kldia composite definition ind.
let d bethe set of definitions obtained refiningd.
a narration ofdisa hybrid history he1 .
.
.
hem if there exists ad02 d and a total orderl1 ... lnoverld0such that for allli lj2ld0 ifli ljthena b where1 a b m d0 li ap hea ap d0 li ac hea ac.where l apand l acdenote the set of primitive eventsand complex events respectively assigned to time labell.for instance the following are three example narrations forenter alice r01 s composite definition swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 swipecard alice nfc cctvaccess alice r01 cctv1 enter alice r01 cctvaccess alice r01 cctv1 swipecard alice nfc enter alice r01 context descriptions relations are interpreted over complexhistories.
givenk hink trk initki2i kis true at positionbin a complex history!
ce1 .
.
.
ceb .
.
.
ceniff either thefollowing holds initk 8a2n etrk2trk.
a b !etrk62cea 9a2n.
a b eink2cea 8g2n etrk2trk.
a g b !etrk62ceg .otherwise it is said to be false.
we assume histories in whichterminating and initiating events for a context relation do not1see github an outline of a refinement algorithm?
?for obtaining d .occur concurrently.
we now define the satisfaction of complexevent definitions histories as follows.definition complex event definition satisfaction givenan environment descriptione b c i a complex event def initione d2band a hybrid history is said to satisfye dwith respect toeif for every decomposition xyz ify hea .
.
.
heg .
.
.
hebis a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nthen e2 heb ac ifdis a composite definition andkl2 d0 l0j klthen ac g klwhere l kldenotes the set context relation literals assignedto time labell.the environment descriptioneis said to be satisfied ina hybrid history if every complex event definition inbissatisfied in that history.
we write e to denote the set ofhybrid histories that satisfye.c.
hypothesesthe termhypothesisin a digital investigation is a conjecturethat may refer for instance to past events in the lifetimeof digital devices the time span during which a system wasoperational system capabilities and configurations .in this paper we focus on one type of hypothesis rel evant to developing forensic ready systems theenviron ment construction hypothesis.
this form of hypothesis pos tulates about the feasibility of events occurrence and pres ence of contextual conditions of interests.
it may be cap tured as an event s composite definitionh d wherehis a complex event marking the satisfaction of a hypoth esis and withapindbeing empty andacandklcontaining only complex events and context relation lit erals respectively.
for instance the hypothesisillegalcopy h l1 copy bob doc m1 mounted usb1 m1 l1!
mounted usb1 m1 copy bob doc m1 i.hypotheses are interpreted overfinitecomplex histories.their satisfaction is given by the definition below.definition hypotheses satisfaction a hypothesish withdefinitionh d is said to be satisfied in a complex history!at positionb i.e.
!
b h if there exists a decomposition!
xyzsuch thaty cea .
.
.
ceg .
.
.
cebthat is a narration ofdwith respect tod02 d and orderl01 ... l0j ... l0nand ifkl2 d0 l0j klthen ac g kl.we distinguish betweensupportableandrefutablehypothe ses in environmente.definition hypotheses supportability and refutability let e be the set of hybrid histories satisfyinge.ahypothesish with definitionh d is said to besupportableineif there exists a hybrid history e such that forsomeb ac b h. it is said to be refutable if there exists ahistory e such that for allb ac b6 h.we will denote the set of hybrid histories in e supportinghas e and those refuting it e .
consider thepotential hybrid history shown in fig.??
since there is a de composition of that yields a narration of the definition ofil legalcopyhypothesis such that ac mounted usb1 m1 thenillegalcopyis supportable ine.d.
operational preservation specificationoperational preservation specificationsosspecify the op erations that can be performed by the controller componentin terms of domain specific conditions as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements .
the controlled oper ations for the controller are a set ofpreserve a ts operationswhereaindicates the occurrence of a primitive event in theenvironment andtsmarks the time stamp instance from thesystem clock at which the occurrence was observed by thecontroller.
the monitored event and condition are the receiptof a notification of occurrence captured by thereceive a ts operation whereaandtsare as before.thedomain specific conditioncaptures the basic state tran sitions defined by the application of an operation in thedomain.
it is specified as a pair containing a domain pre condition dompre and a domain post condition dompost e.g.
preserved a ts andpreserved a ts .required condi tions on the other hand capture strengthened conditionson the software controlled operations that contribute to thesatisfaction of the requirements.
they are expressed in theform ofrequired pre andtrigger conditions.required pre conditions reqpre are conditions that capture apermissiontoperform apreserveoperation.required trigger conditions re qtrig are conditions that capture anobligationto perform apreserveoperation.
an example of an operational preservationrequirements for the operationspreserve syscopy e d m ts for some employeee documentdand computerm isdompre preserve syscopy e d m ts preserved syscopy e d m ts dompost preserve syscopy e d m ts preserved syscopy e d m ts reqpre preserve syscopy e d m ts received syscopy e d m ts reqtrig preserve syscopy e d m ts 9ts1 ts2 ts3 ts42clock s2str.ts1 ts3 ts2 ts3 ts3 t s4 ts preserved syslogin e d m ts1 preserved sysmount s m ts2 preserved syslogout e m ts3 the above says that the occurrence of the eventsyscopymust be preserved by the controller in the storage if the latteralready contains entries about the occurrences of employee slogging to a computer and the mounting of a storage device onit and no entries about employee s logging out from computerand unmounting of the storage device from the computer arestored.an operational preservation specificationosdefines all ad missible preservation capacities potential logs as sequencesofpreserveoperations that may be executed by the con troller and devices .
we call each sequence a potential logand write it in the form preserve a11 ts1 ... preserve a1m tsm m .
the set of potential logs admissiblebyosis denoted as os .we now define the forensic readiness specification.
notethat we considertsito be an abstraction over real time clockvariables that may be obtained following techniques such as .
the generation of such abstractions is outside thescope of the paper.
we...definition preservation coverage and completeness given an environment descriptioneand a hypothesishthat isboth supportable and refutable ine.
letosbe an operationalpreservation specification.
thenosis said to becoverapotential history he1 .
.
.
hen e if there exists apotential log fe1 .
.
.
fen os such that for everya2 hei ap preserve a tsi 2fei oscovers for short.
itis said to bepreservation complete w.r.t.eandhif it coversall potential histories in e and not any history in e .we say the any specification that meets the preservationcompleteness described above achieves the preservation re quirement forhine denotedrh and by abuse of notationdenote this ase h os rh.v.
preserv ationspecificationsynthesisour approach for synthesising the preservation specification see figure requires as input an environment descriptione and a set of speculative incident hypotheseshthat aresupportable and refutable bye.
such inputs can be provided for instance by the software engineer.
we assume that thedescription of the environment is correct and the speculativehypotheses are known a priori before an investigation starts.preservation specification synthesis is performed in threephases.
history generation.in this phase we search for hybridhistories e and e with respect toh.
the existenceof histories in e ensures that the hypotheses of inter est are feasible within the intended environment.
if e is empty this means that the either the hypothesis cannotoccur within the environment described and thus may notbe a security concern or that the environment descriptionand or the speculative hypotheses are incorrect and need tobe revised e.g.
by a security administrator .
the histories e operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.
specification verification.given the generated e wecheck if the primitive history projection for each history is covered by the preservation specification i.e.
there existscorresponding potential log.
if this is the case then thecurrent preservation specificationossatisfies the preservationrequirements and the process terminates.
if some primitivehistory projection is not then new operational preservationspecification must be synthesised in the next phase.
specification synthesis.the synthesis aims to learn anewreqpreand required trigger conditionsreqtrighat wouldprescribe the preservation of the potential histories e and not those in e .
the output is a set of required pre conditions .
the new specificationos0is given as input to theforensic ready controller that is responsible for its enactmentduring the system operation.to the best of our knowledge this paper is the first to defineand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising specifications that satisfy them.ii.
motivatingexampleour motivating example is a corporate fraud incident inspired by the galleon group case .
we consider anenvironment within an enterprise building where two employ ees aliceandbob work see fig.
.bobandalicehavelaptops m2andm3 respectively provided by the company.a sensitive documentdocis stored on the server machinem1that is located in the officer01.
access tor01is controlledby anfcreader and is monitored by acctvcamera.
bothaliceandbobare authorised to accessr01and to login tom1.
anincident of concern is related to the exfiltration of thedoc.activities such entering a room may be observed inferred through low level system events that can be observed fromdigital devices referred to as evidence sources.
examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door or annfclog entry recording the reading of acard tag.
employee aliceemployee bob laptop m2laptop m3 desktop m1file doc location r01 reader nfc1camera cctv1 storage ubs1 fig.
.
setting of our motivating example.suppose that a digital investigation related to thedocexfiltration is initiated.
an investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis.
however she is uncertainabout what exact events must have occurred for this hypothesisto be true.
hence she reconstructs various scenarios about pos sible system events that could have occurred i.e.
histories .one possibility is thataliceenteredr01 performed the logintom1 mountedusb1onm1and copied thedoc.
anotheris thatbobentered the room but usedalice s credentials tologin tom1and copy the file ontousb1.
a more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device and she subsequently copied thedocin thestorage remotely.
each of these possibilities would require theinvestigator to identify the relevant devices search through therecords for each of these devices e.g.
logs from all readers cctv recordings and hard drives for all machines and checkif they support or refute her hypothesis.given the multitude of histories that could be constructedwithin an environment a sound investigation would be depen dent ona the investigators ability to reconstruct all possiblehistories b the devices to preserve the required activitiesthat correspond to such histories andc the investigators toexamine all these against the hypotheses.
as the volume ofdata to analyse is high the context of incident unfamiliar and pressure to deliver results ever increasing the cognitiveload on investigators escalates making way for evidence andnegative biases to go unnoticed .
furthermore as eventsfrom devices could be concealed by offenders clearing hard drive system history or might not be retained by a device filecopies events potential evidence may be lost.although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible examination of large data sets is often expensiveand time consuming and may mask what is truly relevant forthe investigation.
for example days cctv footages wouldoccupy tb while a hard drive occupies gb onaverage.
in the example not all file copy events are relevant tosupport the speculative hypothesis but only those taking placewhile a storage device is currently mounted.
therefore thereis a pressing need for developing systems that areforensic ready i.e.
that can preserve relevant evidence proactively.iii.
problemstatementin this paper we attempt to address two questions canpreservation requirements be formulated precisely?
whatare the system specifications that could achieve them and canthese by synthesised automatically?to articulate the problem we follow jackson and zave approach to requirements definitions and satisfaction.in their requirements reference model to guarantee thata machine achieves its requirementsr it is necessary toshow that its specificationssatisfiesw s r wherewcaptures some domain knowledge descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine.
in our settingwcomprises theenvironmentdescriptione and thespeculative incident hypothesesh.
the specification srepresents operational constraints over whatand when the machine must preserve having speculatedover events lying in the shared phenomena.
in our case thesespecifications asoperational preservation specifications os.with this frame of mind thepreservation requirementsareproperties overe handosrequiringosto preserve anyevent belonging to any history that shows howemay satisfyh i.e.
e h os rh whererhdenotes the requirementpreservations with respect to hypothesesh.section iv formalises the concepts needed for defining thepreservation requirement problem preciesly.
section v pro poses an approach for synthesising preservation specificationsfrom speculated hypotheses and environment descriptions.for the latter we assume the design choice of having asingle controller that interacts with the individual evidencesources and whose preservation specification we synthesise see fig.
.
the controllerreceives events from the digitalhypotheses no fig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described fig.
.
our approach for synthesising preservation specifications.
history generation.in this phase we search for hybridhistories e and e supporting and refutinghre spectively.
the existence of histories in e ensures thatthe hypotheses of interest are feasible within the intendedenvironment.
if e is empty this means that either thehypothesis cannot occur within the environment described and thus it will not required to be considered during a digitalinvestigation or that the environment description and or thepsps fr controller12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758on evidence preservation requirementsof forensic ready systems esec fse september paderborn germany3 speci cation synthesis.
e synthesis phase considerse h ps i and j .
from this it learns a new set of required pre and trigger conditions that would prescribe the preservation of allpotential logs i but not in j are learned and added tops.
e new speci cationps0is given as provided to the controller thatis responsible for its enactment.note the steps above suppose a design time synthesis approach rather than a run time one.
e la er is constitutes future work.
tool implementationas a proof of concept we have implemented a prototype tool forsynthesising forensic ready preservation speci cations.
our solu tion uses a i declarative language based on the event calculuslogic program2 to represent and reason about the environmentdescriptions speculative hypotheses preservation speci cationsand potential histories and logs in a uniform way ii a booleanconstraint solver for logic programs called clingo to computepotential histories and logs that satisfy or refute hypotheses and iii and a logic based learner called xhail to synthesise preser vation speci cations from examples of potential logs.
e encodingof the input as well as the execution of the three phases in section5 are done automatically.
e user is expected to provide the initialinput and the maximum length of the potential histories to beconsidered in the approach.in brief the history generation phase rst tries to nd two setsof models called answer sets of the program denotedans le lh nandans le lh n where each element in the rst com prises a historyl ans le lh nofeof lengthnminimallysupportive of a hypothesis inhand each of the second containsa historyl ans le lh nthat refutes a hypothesis inh.
is is done through by solving a constraint that requires ahypothesislh2lhto be satis ed by at least one potential historyconsistent withle.
e solver searches for the optimal solutionwhich equates to the minimally supportive or refutive history ofh.we denote the set of minimally supportive hypotheses asl e and the minimally refutive asl e .
e speci cation veri cation phase then considers the computedhistoriesl e l e programle lhand programlps.
ephase performs several calls to the solver to check for coverage andnon coverage of each historyl e andl e respectively bythe controller speci cationlps phase .
if this is not the case thenpotential logs i and j that correspond tol e l e respectively andle tocompute pre and trigger conditions to ensure the preservations ofthese.to conduct the analysis our implementation translates the inputmodel into an event calculus ec logic program a formalism .
however the same technique is implementable in any languagesupporting some form of behavioural modelling and declarativesynthesis of temporal speci cations.
it has been successfully de ployed in the context of specifying requirements operationalisation and reasoning about evidence in digital investigations .it runs an o the shelf model generation tool clasp gebser to compute histories.
our use of asp as the underlying veri cation2an logic program is a collection of rules of the formlk lk .
.
.
ln not ln .
.
.
not lmengine is motivated by its capacity to handle di cult np hard search problems for ec programs.
e analysis in clasp is boundedup to a user speci ed scope on the size of the domains which corre sponds to the number of entities events and the maximum lengthof histories that will be generated.
details of the encoding areavailable on h ps github.com lpasquale minorityreport.
evaluationour evaluation aims to assess whether the quality of the synthe sised preservation speci cation particularly whether it prescribesto preserve i relevant eventsand ii the minimum amount of eventsnecessary to support speculative hypotheses of potential incidents.to achieve this aim we developed a prototype tool implemented inpython and used two incident scenario data sets that are availablepublicly for research and training purposes.
each data set includesthe data that an investigator would have to examine to explain if possible how the associated incident scenario occurred.
etool and case study application are available online3.
for eachscenario we manually modelled the environment and the specula tive hypotheses in ec.
note that each log entry and event type inthe data sets is mapped to a primitive event modelled in the envi ronment.
from this we used our tool to automatically synthesisepreservation speci cations.
i j to assess whether the synthesised speci cation prescribes to pre serve relevant events we veri ed whether the primitive events thatthe speci cation prescribes to preserve are relevant to support someof the speculative incident hypotheses.
note that although some ofthese primitive events may correspond to log entries events in thedata set others might not be available because they have not beenretained by the digital source.
to assess whether the synthesisedspeci cation prescribes to preserve the minimum amount of events we measured whether the speci cation would prescribe the preser vation of fewer log entries events compared to those included inthe data set.
we also measured how many of the log entries eventsfrom the data set which our speci cation prescribed to preserve were irrelevant to support the satisfaction of the speculative hy potheses.
at the end of the section we discuss threats to validity ofour approach.
.
relevance and minimality e rst incident scenario we considered is set in a university wherestudents and academic sta can send emails by using the universityand students residence internal network.
e data set4includes thetcp packets captured from the routers located inside the students residence.
erefore we considered the routers as the digital sourceswithin the environment and adopted primitive events to representspeci c network tra c that may berelated to emails exchanges.we modelled the following primitive events imap pop networktra c sue related to emails sent from external addresses to anacademic sue incoming http tra c adopted to set up a cookie3h ps github.com lpasquale minorityreport4h p digitalcorpora.org corpora scenarios nitroba university harassment scenariob ps figure specification generation approach.
history generation.
in this phase we search for hybrid histories e and e that minimally support and that refute h respectively.
the existence of histories in e ensures that the hypotheses of interest are feasible within the intended environment.
if e is empty this means that either the hypothesis cannot occur within the environment described and thus it will not require to be considered during a digital investigation or that the environment description and or the speculative hypotheses are incorrect and need revision.
the histories e operate as a proxy for the synthesis phase to ensure only relevant event occurrences are preserved.
specification verification.
given the generated e we check if each history is potentially covered by the preservation specification i.e.
there exists a corresponding potential log in ps .
if some history in e is not then this may be owing to one of two cases i the fr controller and the digital devices do not have the capabilities needed to respectively preserve the potential logs and monitor the relevant events or ii they do but require an operational preservation specification to be synthesised to ensure their preservation.
in the case of the former the approach terminates indicating a need for additional capabilities.
in the latter case corresponding potential logs i and j are produced and passed onto the third phase.
specification synthesis.
the synthesis phase considers e h ps i and j .
it searches within a space of candidate expressions restricted to safety ltl expressions a new set of required preand trigger conditions that would prescribe the preservation of all potential logs i but not in j .
these are added to ps.
the new specification ps is given as provided to the fr controller that is responsible for its enactment.
note the steps above are conducted for a set of given hypotheses.
if new ones are provided then a new specification must be generated.
tool implementation as a proof of concept we have implemented a prototype tool3for synthesising forensic ready preservation specifications.
our solution uses a i declarative language based on the event calculus ec logic program to represent and reason about the environment 3the source code of the tool is publicly available at keeper tree keeper cli.
564on evidence preservation requirements for forensic ready systems esec fse september paderborn germany descriptions speculative hypotheses preservation specifications and potential histories and logs in a uniform way ii an off the shelf boolean constraint solver for logic programs called clingo to compute potential histories and logs that satisfy or refute hypotheses and iii and a logic based learner called xhail to synthesise preservation specifications that cover all histories supportive of a hypothesis.
our choice of ec logic program as a language is due to its successful deployment in the context of requirements operationalisation and reasoning about evidence in digital investigations .
the encoding of the input as well as the execution of the three phases in section are done automatically.
the user is expected to provide the initial input and the maximum length of the potential histories to be considered in the approach.
our use of the solver as the underlying history generation and specification verification engine is motivated by its capacity to handle difficult np hard search problems for ec programs.
for encoding of preservation specifications we follow the translation in .
details of the encoding for the environment description and hypotheses are available at runningexample.
although the approach is demonstrated for a particular language the principles behind it could be applied to other formalisms and solvers.
in brief the history generation phase first tries to find two sets of models of the program le lh.
each element in the first set is a model of le lhthat comprises a history l of maximum length nthat is minimally supportive of a hypothesis in h. each element in the second set contains a history l of length nthat refutes all hypotheses in h. this is done by solving a constraint that requires a hypothesis lh lhto be satisfied by at least one potential history consistent with le lh.
the solver searches for the optimal solution being defined as the fewest event occurrence in a history which equates to the minimally supportive history of h. we denote the set of minimally supportive histories as l e and the minimally refuting histories as l e .
the specification verification phase considers the histories l e andl e program le lhand program lps.
this phase performs several calls to the solver to check for consistency of each history l e andl e respectively with the specification lps phase .
the solver searches for models that satisfy the program le lh lps l for each l l e l e and a constraint requiring there to be an isomorphic potential log l iin the model.
if a potential log for a supportive history cannot be found then the program is unsatisfiable.
in this case the approach outputs those potential histories to the user for further consideration e.g.
amending the fr controller s capabilities .
otherwise all computed potential logs l ps andl ps that correspond to histories in l e l e respectively and the program le lpsare passed to a logic based learner.
the aim of the learner is to search through a candidate space given by a language bias as in to compute required pre conditions lreqpre and required trigger conditions lreqtrig such that le lps l ps where is an entailment operator defined with respect to stable model semantics whilst ensuring that le lps l for any l l ps .
the programs lreqpre lreqtrig are then translated back to ltl following the method described in .
evaluation our evaluation aims to assess whether the synthesised preservation specification prescribes to preserve i relevant events and ii the minimal amount of events necessary to support speculative hypotheses of potential incidents.
to achieve this aim we apply our prototype tool to two case studies publicly available for research and training purposes.
each case study comprises data that would normally be available to an investigator for examination when a fr controller is not implemented .
the investigator can use this data to explain if possible how a particular incident occurred.
for each incident we manually modelled the environment and the speculative hypotheses in ec.
from this we used our tool to generate preservation specifications automatically.
the ec models of the case studies and the generated specifications are available online4.
we compare the events that the generated specification prescribes to preserve with those that would be available to an investigator when the system that does not satisfy evidence preservation requirements i.e.
the information available to an investigator is represented by the data sets provided with the case studies.
to assess relevance we verify whether our specification prescribes to preserve events that were relevant to satisfy the speculative hypotheses.
we also check if occurrence of those events can be inferred from the available data set.
to assess minimality we verify that our approach prescribes preserving fewer events.
in particular we compare the number of events that our approach prescribes to preserve with those that can be inferred from the data set.
we also measure the number of events whose occurrence can be inferred from the data set which were irrelevant to support the satisfaction of the hypotheses.
.
relevance and minimality the first incident scenario we considered is set in a university where students and academic staff can send emails by using the university and students residence internal network.
the model of the environment includes different agents who can be academics or students and can teach or attend courses respectively.
it also includes locations such as university and students residences routers each of them placed in a location emails and their corresponding sender recipient email and ip addresses.
we also model whether an email address is a university address for staff and students or it is an external address.
the primitive events we model cover events whose occurrence can be inferred from the data set5.
this includes the tcp packets captured from the routers located inside the students residence.
therefore we consider the routers as digital sources within the environment and use primitive events to represent network data streams.
we model the following primitive events imap pop network traffic we indicate primitive events related to emails sent from external addresses to an academic as sue incoming http traffic we indicate http messages used to set up a cookie as sc general outgoing http traffic em and specific outgoing http traffic towards anonymous email services sae .
some of the complex events we model include i emails received by a specific email address ii cookie setting from an external address to an ip iii 565esec fse september paderborn germany dalal alrajeh liliana pasquale and bashar nuseibeh sending of http messages from an ip address and a browser agent iv sending of anonymous emails from an ip address and a browser agent.
the complex event indicating setting of a cookie initiates the state cookieset for a specified email and ip address.
an incident of concern is related to the receipt of harassment emails by academics.
the following speculative hypotheses were constructed h1 an email is sent to an academic by someone using an external address h2 an anonymous email is sent by an individual who can be identified for example through the cookie and his her browser agents h3 an anonymous email is sent by an individual who cannot be identified.
h1is satisfied when complex event i takes place for which the sender email address is external and the recipient email address is owned by a university staff member.
for supporting h1 the implemented specification recommended preserving all incoming imap pop network traffic sue related to emails sent from external addresses to an academic.
h2is satisfied when a cookie is set for a specific email and ip address complex event iii takes place for which http traffic originates from the same ip address with which the cookie is associated and subsequently complex event iv takes places for which the ip address and the browser agent have been previously associated with outgoing http traffic.
for h2 the specification required preserving a incoming http traffic adopted to set up a cookie sc b outgoing http traffic from the same address to which the cookie was set em and c outgoing http traffic to send anonymous emails sae .h3is satisfied when complex event iv takes place.
therefore forh3the specification requires preserving all sae events.
table shows the total time necessary to generate a specification for each hypothesis and the time required by each phase of the approach histories generation hg specification verification sv and specification synthesis ss .
for each hypothesis the number of supporting histories out of the total number generated and negative histories necessary to compute a specification including the maximum length of the histories are shown.
a higher number of positive and negative histories could have been given as input to the synthesis activity without affecting the generated specification.
the maximum time was taken for the most complex hypothesis h2 which also required the provision of negative histories.
table performance in the harassment case study.
instances execution time s pos neg length hg sv ss total h1 .
.
.
h2 .
.
.
.
h3 .
.
.
.
we implemented the specification of a fr controller able to extract data stream from the data set.
extracted data streams can support h2since an incoming set cookie message associated with jcoach gmail.com and received by ip .
.
.
was preserved.
outgoing http messages from the same ip address and associated with a mozilla browser have also been recorded the same browser appears to have been used to send the anonymous email.
this supports our theory that our approach would preserve data that might represent relevant evidence if such an incident were to occur.
this would support investigators in prioritising their efforts while ensuring that other events related to alternativescenarios would have been preserved if such scenarios occurred.
moreover our approach also prescribes to preserve events that might not be proactively retained by digital sources.
for example the data set does not include events about imap pop network traffic sue necessary to support hypothesis h1.
this might be due to the fact that network traffic was collected for a limited amount of time and was not retained.
to assess minimality we compare the total number of events whose occurrence can be inferred from the data set with those that our specification would prescribe to preserve.
the full data set includes 760data streams application level messages exchanged in15 508communications between different ip addresses.
the number of data streams corresponds to the total number of events that an investigator would normally have to examine.
the number and type of event that our specification prescribed to preserve for each hypothesis is shown in table the total number of events is only .
of the data streams in the entire data set.
moreover not all the events preserved were necessary to support the hypotheses.
for our scenario only data streams corresponding to http traffic originating from the mozilla browser were necessary to support h2.
therefore although our specification consistently reduces the amount of data to be analysed by an investigator it does not completely ensure the minimality requirement since data streams were not relevant to support h2.
table number of events preserved.
sue sc em sae eventsh1 h2 3830300h3 total events we also applied our approach to a more complex corporate exfiltration scenario6.
the model of the environment includes the company s employees their email addresses computers employees access rights to computers storage devices that could be mounted and programs that are installed on each computer.
the available data set consists of an image of the hard drive of a windows machine.
thus primitive events we modelled represent changes in the file system of a window machine that can be observed from a hard drive image.
these include users logins mount and unmount of devices installation of programs and sent or received emails.
owing to space we will not provide details of the model and the specification generated for all the hypotheses of this example and refer the reader to the project webpage.
an incident of concern is related to the exfiltration of a confidential document of a company from the computer of the chief financial officer cfo .
six hypotheses were constructed for this incident.
examples of these hypotheses are h2 the document is sent via email to an external email address and h5 the document is copied while an external storage device is mounted.
to support h2 the specification requires preserving user logins to a computer in which the document is stored and while a user is logged sending of emails to a non corporate address including the confidential document attached.
as h5is equal to the hypothesis of our running example it lead to the same preservation specification.
for this 566on evidence preservation requirements for forensic ready systems esec fse september paderborn germany incident scenario the hypotheses we modelled were more complex and a higher number of supporting and refuting histories were generated.
this increased the time the approach took to learn a specification.
table shows the time to generate a preservation specification for each hypothesis.
we manually acquired the events identified from the computer hard drive using autopsy .
these were not sufficient to support any of the hypotheses because some of the events that our approach prescribes to preserve are not retained in a computer hard drive image.
for example we cannot support hypothesis h2speculating that the document might be sent as an email attachment by an employee to a non corporate email address.
in particular although an event in the data set indicates that an email with the attached confidential document was sent from the cfo s email address jean m57.biz to an external address tuckgorge gmail.com we cannot conclude which user was logged on the machine since the data set only provides information about the last user login.
a similar situation arise with hypothesis h5speculating that the document may be copied to an external device because mounting of a storage device and copy of a file are events that are not retained.
if our specification was implemented it would have ensured preservation of events necessary to support h2andh5when they occurred.
table performance in the exfiltration case study.
instances execution time s pos neg length hi sv sg total h1 .
.
.
.
h2 .
.
.
.
h3 .
.
.
.
h4 .
.
.
.
h3 .
.
.
.
h4 .
.
.
.
h5 .
.
.
.
h6 .
.
.
.
to assess minimality fig.
shows for each hypothesis the number of events our approach would have preserved from the hard drive image.
we compared these figures with those that an investigator would have examined from the data set no fr .
our approach would have resulted in significantly fewer events to be examined for hypotheses h1 h6.
for example to support h2it would be necessary to identify the mail clients among the installed applications inspect all the outboxes associated with the accounts registered with the mail clients 23emails for the cfo s outbox and no emails for the administrator outbox and identify the users last login .
we cannot claim the same for h5the generated specification requires preserving users last logins mounted devices and file access operations which are not present in the data set.
.
discussion the paper aims to ensure relevant events are preserved that may serve as evidence thus reducing the amount of data investigators would have to search through.
this is what is evaluated.
the paper is not concerned with reactive investigations nor aiding open ended investigations.
we make the assumption that the speculative hypotheses of an incident are given in advance.
therefore a forensicready system will be prepared to investigate only the incidents known a priori.
this the assumption on which forensic readiness figure number of events to be examined.
guidelines for organisations are based on.
training experts e.g.
system security administrator to identify these is part of the business requirements for implementing forensic measures and is outside the scope of our work.
furthermore as the environment and the speculative hypotheses are expected to be known a priori there is a risk that this knowledge can be used to thwart the forensic ready system itself an individual might adjust her behaviour to avoid preservation of events indicating her involvement in an offense.
thus applications of our approach would require maintenance of confidentiality of the system specification.
the performance of our approach decreases when richer positive and negative histories are used a saturation point is reached for histories .
this is caused by the increase in the ec model size when grounded.
the time taken to synthesise a specification increases linearly with the length of the considered preservation histories.
a saturation point is reached with histories having length .
note that the scalability results purely depend on the open source prototype tool7used to support the specification synthesis.
this could be significantly improved by deploying learning techniques for context dependent learning and distributed reasoning .
to show that our formalisation could yield a practical solution we provide a proof of concept implementation putting aside usability issues.
the definition of the model of the environment and the hypotheses of the university harrassment and the corporate exfiltration scenarios required and .
days of work respectively to one of the paper s authors.
we are developing a graphical interface that would mask the complexity of the formal specification and help practitioners represent potential incidents and how they may occur in the environment.
such graphical interface is based on the model driven engineering principle to hide the complexity of the ec language used to represent the environment and hypotheses within a model.
a model based representation has the potential to ensure correctness of the models by design and encourage re usability of the environment and hypotheses among experts.
related work existing research on forensic readiness has mainly focused on identifying high level strategies which organisations can implement to be forensic ready.
for example elyas et al.
use focus groups to elicit required forensic readiness objectives e.g.
regulatory compliance legal evidence management and capabilities organisational factors and forensic strategy .
reddy and venter present a forensic readiness management system taking into account event 567esec fse september paderborn germany dalal alrajeh liliana pasquale and bashar nuseibeh analysis capabilities domain specific information e.g.
policies procedures and training requirements and costs e.g.
staff infrastructure and training costs .
however none of these approaches has addressed the problem of how to implement forensic readiness in existing it systems inspite of the standardisation of forensic readiness processes iso iec which prescribes the planning and implementation of pre incident collection and analysis of evidence activities.
shield et al.
propose performing continuous proactive evidence preservation.
however in large scale environments like cloud systems monitoring all potential evidence is not a viable solution as it might be cumbersome to analyse.
pasquale et al.
propose a more targeted approach where evidence preservation activities aim to detect potential attack scenarios that can violate existing security policies.
however this approach is less selective as it prescribe to preserve any type of event within a history leading to an incident independently of other events that have previously occurred or preserved.
existing work on data extraction for investigative purposes such as e discovery although supporting retrieval of data for an investigation it does not provide a solution to engineer a forensic ready system prescribing what data should be preserved depending on its relevance to future investigations.
with the growth of digital forensics as a discipline interest in rigorous approaches has increased.
for example carrier provides guidelines about the types of hypotheses that should be formulated and the analysis to be performed to verify those hypotheses during a digital investigation.
others have focused on providing a unified representation of heterogeneous log events to automate event reconstruction.
similar to us all these approaches distinguish between primitive events having a direct mapping to raw log events and complex level events which can be determined by the occurrence of primitive ones.
formal techniques have also been used to represent and analyse the behaviour of the environment in order to identify the root causes that allowed an incident to occur or possible incident scenarios .
other work is specialised on identifying attackers traces e.g.
evidence and timestamps improperly manipulated by an attacker from violations of invariant relationships between digital objects or by applying model checking techniques on a set of events expressed in a multi sorted algebra .
however none of this work addresses the problem of how hypotheses can be expressed formally how they relate to sequences of primitive and complex events supporting them and how to achieve preservation requirements.
the requirements engineering community proposed numerous techniques for modelling security and privacy requirements to enable the design of systems less vulnerable to potential attacks and privacy breaches.
however only preliminary attempts have been made towards engineering forensic ready systems and investigating how forensic readiness requirements are considered during systems development lifecycles .
although preservation requirements can be considered as a specific type of monitoring requirements the nature of the specifications for forensic ready systems is different in its csnumber 44407scope environment and hypotheses and characteristics.
these are aspects that have not been covered in previous work.
recent studies in program analysis such as have highlighted the importance of providing software developers with automated support in making logging decisions and difficulty in constructing specifications to guide logging behaviour.
in for instance the authors present a method for learning what and when to log from past logs of software developers.
this differs conceptually from what we present here since incident related histories are domain specific showing how particular hypotheses may be met within particular environments.
for forensic ready systems justification of preservations need to be made explicit and in readable form which is supported by the learning technique that we deploy.
we believe however that our approach could help software developers in making informed decisions and insights on what logs to preserve to enhance forensic readiness of systems.
closest to our work with in a forensic setting is that of .
however focuses on defining ideal logging preferences for databases that is independent of the incidents of concern and hence still poses a risk of inadequate logging.
the work of instead is limited to eliciting from natural language descriptions of software artefacts the set events as verb object pairs and an empirical classification of such events to determine logging requirements.
conclusion this paper represents a first step towards a rigorous approach to developing forensic ready systems.
we defined a framework for formalising evidence preservation requirements of such systems.
we use this to synthesise specifications that guarantee a minimal amount of data constituting potentially relevant evidence to support given speculative hypotheses of incidents of concern is preserved.
we also provided a proof of concept implementation that has been evaluated on two incident scenarios.
our results demonstrate that our approach preserves relevant events and provides insight into whether existing software devices have the necessary capabilities for preserving evidence.
moreover the size of preserved data is smaller than what would have been examined during an investigation otherwise.
our approach does not propose replacing the role of engineers nor investigators.
it also assumes that domain experts are involved in modelling the environment and selecting the relevant histories to be covered by the preservation specifications.
in the future we plan to investigate how our approach may be adapted to dynamic situations at run time in which environments and hypotheses may change over time.
we are developing a graphical designer aimed to facilitate the practitioners task of designing the model of the environment and generation of hypotheses.
finally when generating a preservation specification we will consider systematic approaches for synthesis when conflicts with other requirements such as legal requirements are present which may forbid preserving relevant data for privacy reasons.