nemo multi criteria test suite minimization with integer nonlinear programming jun wei lin university of california irvine junwel1 uci.edureyhaneh jabbarvand university of california irvine jabbarvr uci.edu joshua garcia university of california irvine joshug4 uci.edusam malek university of california irvine malek uci.edu abstract multi criteria test suite minimization aims to remove redundant test cases from a test suite based on some criteria such as code coverage while trying tooptimallymaintainthecapability ofthe reducedsuite basedon othercriteriasuch asfault detection effectiveness.
existing techniques addressing this problem with integer linear programming claim to produce optimal solutions.
however the multi criteria test suite minimization problem is inherentlynonlinear due to the fact that test cases are often dependent on eachotherintermsoftest casecriteria.inthispaper weproposea frameworkthatformulatesthemulti criteriatest suiteminimization problem as an integer nonlinear programming problem.
to solve thisproblem optimally we programmaticallytransform this nonlinear problem into a linear one and then solve the problem using modern linear solvers.
we have implemented our framework as a tool called nemo that supports a number of modern linear and nonlinear solvers.
we have evaluated nemo with a publicly available dataset and minimization problems involving multiplecriteria including statement coverage fault revealing capability and test execution time.
the experimental results show that nemo can be used to efficiently find an optimal solution for multi criteria test suite minimization problems with modern solvers and the optimalsolutionsoutperformthesuboptimalonesbyupto164.
in terms of the criteria considered in the problem.
ccs concepts software and its engineering software testing and debugging keywords test suite minimization integer programming acm reference format jun wei lin reyhaneh jabbarvand joshua garcia and sam malek.
.
nemo multi criteria test suite minimizationwithinteger nonlinearprogramming.
in proceedings of icse 40th international conference on software engineering gothenburg sweden may june icse pages.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may june gothenburg sweden association for computing machinery.
acm isbn ... .
introduction softwaretestingplaysanessentialroleinsoftwaredevelopment providing a means to determine automatically whether a program behavesasexpected.toensurethecorrectnessofaprogramasit evolves engineers should perform regression testing on it to ensure that modified or introduced code does not break the program s originalfunctionality.toexercisenewbehaviorsordetectnewly discoveredfaultsinsoftware testsuitesforregressiontestingare continuously expanded and hence may become too large to execute in their entirety .
for example a test suite for a system with about source lines of code may require seven weeks torun .moreover duringthedevelopmentofmicrosoftwindows .
more than million test executions were performed .
consequently large test suites can make regression testing impractical.
to address this problem several approaches for test suite maintenance such as test suite minimization test case selection and test caseprioritizationhavebeenproposed .specifically testsuite minimization aims to find the minimal subset of the original test suite which satisfies the same testing requirements .
although an existing minimization technique may work well with respecttoasinglecriterion thecapabilityofaminimizedtestsuite may be severely compromised in terms of other criteria such asfault revealing power .
as a result a tester may consider multiple criteria when performing the reduction.
for instance she may want to generate a reduced suite with the same statement coverage and maximal fault detection capability.
toaccommodatemulti criteriatest suiteminimization mctsm problems existing techniques model the problems as binary integer linear programming ilp problems.
a binary ilp problem optimizes a linear objective function consisting of binary variables under a set of linear constraints .
by encoding test case criteria e.g.
faultsorstatementscoveredbytests asconstraintsor objective functions of a binary ilp problem existing techniquesclaim that the computed solutions are optimal for the minimization problem .
however an ilp formulation actually results insub optimal solutions since themctsm problemis inherently nonlinear.
the nonlinearity arises due to the fact that test casesare often dependent on each other in terms of test case criteria.
for example consider the case where the goal of the test suite minimization is to select test cases in a suite that maximize the fault detectioneffectivenessofthereducedsuiteand maintain thesamecodecoverageastheoriginalunminimizedtestsuite.in this example simply selecting test cases that reveal morefaults ignores the possibility of the same fault being revealed by multipletestcases which ourresultsindicateactuallyoccursoften.
to acm ieee 40th international conference on software engineering authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden jun wei lin reyhaneh jabbarvand joshua garcia and sam malek ensure that test cases cover a diversenumber of faults a nonlinear formulation of the test suite optimization problem is required.
to deal with dependencies among test cases in a mctsm problem we formulate the problem as an integer nonlinear programming problem.
to solve this problem optimally we present a novel approachthatprogrammaticallytransformsthisnonlinearproblem into a linear problem and then solves the problem using modern ilpsolvers.weevaluateourproposedapproachusingapublicly available dataset of open source projects .
our experiments for bi criteria test suite minimization problems show that modeling the objective functions nonlinearly results in minimized test suites that on average cover more faults.
for our experiments involving atri criteraproblem thetestsuitesreducedbyanonlinearformulationalwaysobtainsuperiorstatementcoverageandfault detection effectiveness given an execution time budget for the test suite.
the contributions of this paper are as follows weproposethefirstapproachforoptimallysolvingmctsm problemsinvolvingdependenciesamongtest casecriteria.
ourapproachtakesintoaccountthe inherentnonlinearity oftheproblem unlikepreviousapproachesthatmodelthe problem linearly.
we implement a prototype tool called nemo nonlinear testsuiteminimization allowingtesterstospecifymctsm problems.the toolprogrammaticallytransforms nonlinear problems into linear ones so that modern ilp solvers can be leveragedtocomputeoptimalsolutions.wealsoprovidea version of nemo that leverages nonlinear solvers.
we conducted an empirical study in which the proposed approach is evaluated with a publicly available dataset of open source projects.
therestofthispaperisorganizedasfollows.section2introduces backgroundonilpproblems particularlyinthecontextofmctsm andprovidesamotivatingexample.wedescribeournovelapproach for formulating mctsm problems nonlinearly in section andits corresponding implementation in section .
we empirically evaluate nemo in section .
section describes work related to nemo.
section concludes the paper.
background and example inthissection wediscussamotivatingexampletodemonstratethat formulatingmctsmproblemslinearlymayresultinsuboptimal solutions.
an mctsm problem is a multi objective optimization probleminwhichthebestsubsetoftheoriginaltestsuiteisselected fromavailablealternativesbasedonsomeminimizationcriteria.as aresult integerlinearprogramming ilp formathematicaloptimizationcanbeadoptedtomodelandsolvetheproblem.specifically existingapproaches formulatethemctsmproblemas abinaryilpproblem.suchaproblemtriestofindtheoptimalvalue of a linear objective function consisting of binary decision variables which are restricted to be or while satisfying a set of linear in equalityconstraints whichwerefertoas constraintcriteria.the objectivefunctionmaximizesorminimizesoneormore optimizationcriteria.althoughfindingasolutionforabinaryilpproblem is np complete some important subclasses of the problem are efficientlysolvablebymodernilpsolvers duetorecentalgorithmic and implementation advances .toaidinillustratingtheencodingofanmctsmprobleminto abinaryilpproblem considertheexampleintable1 whichdepicts a set of three test cases with each test case s corresponding statementandfaultcoverage.inthisexample theproblemunder consideration involves the following criteria a constraint criterion c1 i.e.
maintaining the same statement coverage as the original test suite and an optimization criterion o1 i.e.
maximizing the fault detection effectiveness of the reduced suite.
criteriatest casest1t2t3statementstmt1 stmt2 stmt3 011faultf1 f2 f3 f4 table1 anexampletestsuitewithcoverageandfaultdetection data we model the problem based on state of the art formulations provided in previous work .
first we let a binary decision variabletirepresent whether the ith test case is included in the reduced suite i.e.
each titakes a if the corresponding test case is selected and0otherwise.next wemodelconstraintcriterion c1 asfollows toensurethateverystatementcoveredbytheoriginal suite is covered at least once by the reduced suite t summationdisplay.
i 1 ijti j q t is the number of test cases in the test suite and qis the total number of distinct statements covered by the test suite.
ijis a binaryvariableindicatingwhetherstatement stmtjiscoveredby testcaseti.fortheexampletestsuiteintable1 equation1becomes t1 t3 t2 t2 t3 we express the goal to minimize the test suite and optimization criteriono1as a linear objective function as follows min t summationdisplay.
i 1 ti ti the minimum function tries to select the smallest subset of the originaltestsuite.thefunction ti modelsthecapabilityofthe test casetito find faults specifically the optimization criterion o1.
atestdetectingmorefaultswouldhaveasmallervaluereturned by andthusmorelikelytobeselected.
isformulatedasfollows ti w ti w ti summationtext.1m j 1vij m mis the total number of distinct faults covered by the test suite.
vijis a binary variable indicating whether test case tireveals fault fj.inthisformulation vijis1iftirevealsfault fj otherwise vij is .
for the example test suite in table the values assigned by are shown in the equation below min3 summationdisplay.
i 1 ti ti t1 t2 t3 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nemo multi criteria test suite minimization with integer nonlinear programmingicse may june gothenburg sweden the formulated problem can then be solved by using an ilp solver.
werefertothisapproachas lf ls linearformulation linearsolver whichmodelsanmctsmproblemwithalinearformulationand solvesitwithalinearsolver.thisistheapproachthathasbeenfollowedinpriorwork includingageneraltoolfortest suite minimization by hsu and orso called mints .
the optimal solution for this binary ilp problem is t2 t3 with a minimal value1 2under the constraints.
however from table we can see that t2 t3 detects only three of the four faults i.e.
it misses fault f4 and hence is not the optimal solution for the minimization problem which is actually t1 t2 .
note that t1 t2 obtains a value of for equation .
the correct solution can not be computed by lf ls because the linear objective function tends to selecttestcasesrevealing morefaultsbutnotnecessarily distinct faults.forexample once t2isselected nofurtherdistinctfaultscan berevealedby t3 butt3wouldstillbeselectedbecauseitreveals more faults than t1 i.e.
three faults instead of just one .
in fact t1should be selected for the minimization problem instead of t3 becauset1reveals a fault distinct from the faults in t2andt3.
suchdependenciesamongtestcasescannotbeencodedwitha linearobjectivefunction theymustbeencodedusinganonlinear objective function.
specifically the test cases currently selected are dependent on the test cases previously selected.
to model such dependencies among test cases the optimization problem must be formulated in a manner such that the decision variables i.e.
tis inthepreviousequations aremultipliedwitheachother making them inherently nonlinear.
in the next section we describe this formulation.
nonlinear problem formulation tononlinearlymodelthemctsmproblem wedescribetheproblem more formally illustrate how our nonlinear formulation models test casedependenciesandmultipleobjectivecriteria anddescribe the manner in which we utilize linear solvers to optimally solve the nonlinear formulation of the problem.
.
problem definition to clarify our proposed idea we formally define the mctsm problem as follows given a test suite t t1 t2 ... tn a set of constraint criteria c c1 c2 ... ck which must be satisfied by t a set of optimization criteria o o1 o2 ... ol i.e.
the criteria to be optimized by an objective function anon negativefunction t thatrepresentsthesignificance of a test case t twith respect to the optimization criteria.
t is a weighted sum of functions indicating the capability oftwith respect to each of the optimization criteria.
for example iftheoptimizationcriteriaare o1 maximizingfault detection effectiveness and o2 minimizing test execution time wecandefine t as t 1 1 t 2 2 t .here 1 t representsthefault detectioncapabilityof t 2 t represents theexecutiontimeof t.eachfactor isaweightprioritizing a criterion.
problem find a minimum test suite t prime tsuch that p1 t primesatisfiesc p2 t prime primesatisfying c t prime t prime prime p3 t prime primesatisfying c summationtext.
ti t prime ti summationtext.
tk t prime prime tk this minimization problem is np complete because it is in np and can be reduced from the minimum set covering problem in polynomial time .
todeal withdependenciesamongtests overmultipleoptimization criteria we must formulate the criteria in a nonlinear fashion.
specifically when our new formulation computes the capability of atestwithrespecttoeachoptimizationcriterion theformulation needs to consider if the criterion is satisfied by other selected tests.
tothatend wealterequations2 3toaccountfor multipleoptimization criteria and dependencies among test cases over a specific optimization criterion using the following equation min summationdisplay.
o o o t summationdisplay.
i 1 o ti ti o ti wo ti o ois an optimization criterion ois the assigned weight for o o ti isafunctioncomputingthecapabilityofatestcase tiin termsofacriterion o.anoveltyofourapproachisthatweconsider dependenciesamongtestcasesinmodeling wo ti whichmakes the formulation nonlinear more details in section .
.
wo ti is a function computing the problem specific significance of a test caseand thus canbedefinedasneededfordifferentcriteriaand minimizationproblems.forexample wo ti canmodelwhethertest casetiidentifies faults distinct from previously selected test cases.
asanotherexample wo ti canmodelwhether testcase ticovers themostfrequentlyexecutingstatementsacertainnumberoftimes.
we next illustrate an instantiation of wo ti for the fault detection criterion from the example of section .
.
modeling test case dependencies in this subsection we illustrate an instantiation of the proposed formulation for an mctsm problem involving the two criteria from our motivating example a constraint criterion c1 that maintains the same statement coverage as the original test suite and an optimization criterion o1 that maximizes the fault detection effectiveness of the reduced suite.
note that this instantiation involves a single constraint criterion and a single optimization criterion eventhoughourformulationcanhandlemultipleconstraintand optimization criteria due to space limitations and to maximizereadability of our nonlinear formulation.
first for optimizationcriterion o1 wesettheweightasone i.e.
1 andassignthe objective function using equation as follows min summationdisplay.
o o o t summationdisplay.
i 1 o ti ti t summationdisplay.
i 1 o1 ti ti t summationdisplay.
i wo1 ti ti furthermore tomodeldependenciesamongtestsover o1 i.e.
faultdetectioneffectiveness whencalculatinghowmanyfaultsarerevealedbyatest wehavetoconsider ifthefaultsare alreadyrevealed by selected tests.
as a result we can define wo1 ti as follows wo1 ti f f summationdisplay.
j 1vijdij dij productdisplay.
t tj t t nequalti authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden jun wei lin reyhaneh jabbarvand joshua garcia and sam malek f is the number of distinct faults in f f1 f2 ... f f revealed byt.tjis the set of test cases that reveal fj.dijaccounts for dependenciesamongtestcasesintermsofeach fj ifatleastoneof thetestcasesin tjisselected dijevaluatestozero whichdecreases thevalueof wo1 ti contributedby tiandfj and thelikeliness oftibeing selected.
to illustrate the use of equations and we apply it to the exampleintable1.intheexampleintable1 t t1 t2 t3 and f f1 f2 f3 f4 .
consequently the objective function for this scenario is the following min summationdisplay.
o o o3 summationdisplay.
i 1 o ti ti o1 t1 t1 o1 t2 t2 o1 t3 t3 wo1 t1 t1 wo1 t2 t2 wo1 t3 t3 summationdisplay.
j 1v1jd1j t1 bracehtipupleft bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehtipdownright bracehtipdownleft bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehtipupright test case t1 summationdisplay.
j 1v2jd2j t2 bracehtipupleft bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehtipdownright bracehtipdownleft bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehtipupright test case t2 summationdisplay.
j 1v3jd3j t3 bracehtipupleft bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehtipdownright bracehtipdownleft bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehext bracehtipupright test case t3 in the above formulation test case t1reveals fault f4 andf4is not revealed by any other test case.
as a result the set of test cases revealing f4 i.e.
t4 is t1 andthecoefficientfor t1inequation is expanded as follows summationdisplay.
j 1v1jd1j t1 v11d11 v12d12 v13d13 v14d14 t1 0d11 0d12 0d13 1d14 t1 1d14 t1 productdisplay.
t t4 t t1 t nequalt1 t1 t1 the above equation expresses t1as independent of other test cases since it reveals a fault that no other test case in the suite reveals.
recallthattestcases t2andt3revealthesamesetoffaults i.e.
f1 f2 f3 .
as a result the set of test cases revealing each of those faultsarealsothesame i.e.
t1 t2 t3 t2 t3 .consequently the coefficient of t2in equation is expanded as follows summationdisplay.
j 1v2jd2j t2 v21d21 v22d22 v23d23 v24d24 t2 1d21 1d22 1d23 0d24 t2 1d21 1d22 1d23 t2 productdisplay.
t t1 t productdisplay.
t t2 t productdisplay.
t t3 t t2 t nequalt2 t3 t3 t3 t2note that the equation above shows an interaction or dependency betweentestcases t2andt3 asrepresentedbythemultiplicationof those two decision variables clearly showing their formulation as nonlinear.recallthatthisdependencyisexpectedsincebothtest cases detect the same set of faults.
finally due to test case t3revealing the same faults as t2 thet3 coefficientofequation14canbeexpandedinamannersimilarto that oft2 summationdisplay.
j 1v3jd3j t3 v31d31 v32d32 v33d33 v34d34 t3 1d31 1d32 1d33 0d34 t3 1d31 1d32 1d33 t3 productdisplay.
t t1 t productdisplay.
t t2 t productdisplay.
t t3 t t3 t nequalt3 t2 t2 t2 t3 for constraint criterion c1 we adopt constraints similar to those inequation1becauseallrequirementsofaconstraintcriterion e.g.
allstatements for c1havetobesatisfied e.g.covered atleastonce by the reduced suite t summationdisplay.
i 1 ijti j c1 c1 is the size of constraint criterion c1 ijis a binary variable indicating whether tisatisfies the jth requirement of c1 e.g.
the jth statement .
with the above objective function andconstraints the proposed formulation for table results in the following assignment for the optimization problem minimize t1 t3 t3 t3 t2 t2 t2 t2 t3 under the constraints t1 t3 t2 t2 t3 withthisnonlinearformulation theoptimalsolutionforinteger nonlinear programming inp problem is t1 t2 with a minimal value1.thissolutionisthecorrect optimalsolutionfortheminimization problem.
note that the solution selected by the linear objectivefunctioninequation3 i.e.
t2 t3 obtainsavalue2using the nonlinear objective function thereby it will not be selected as the final solution.
the above nonlinear formulation can be supplied directly to a nonlinear solver which is an approach for solving an mctsm problem that we refer to as nf ns nonlinearformulation nonlinearsolver .
however utilizing nonlinear solvers does not guarantee optimalsolutions leading usto proposeadifferentapproach to solving the nonlinear formulation as described in the next subsection.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nemo multi criteria test suite minimization with integer nonlinear programmingicse may june gothenburg sweden .
transformation to linear programming thereisnoknownefficientalgorithmforsolvinganinpproblemoptimallyotherthantryingeverypossiblecombination.furthermore for problems with non convex functions such as mctsm nonlinearsolversarenotguaranteedtofindanoptimalsolution makingnf nsnotnecessarilyoptimal.asaresult insteadofdirectlysolvingthenonlinearformulation weinvestigatedhowto transform the nonlinear formulation into a linear one.
a linear formulationcanbesolvedoptimallygiventherecentadvancesin ilp solver technology .
we refer to this approach of solving the nonlinear formulation using linear solvers as nf ls nonlinearformulation linearsolver and describe it in the remainder of this section.
toallowtheuseoflinearsolversfornf ls wetransformthe nonlinearmctsmproblemintoalinearonebyintroducingnew auxiliary variables .wedemonstratetheapproachusingthe instantiation of the mctsm problem in section .
.
we introduce up to f t new decision variables vijdefined as follows vij vijdijti vijis a binary variable indicating whether a fault fjis revealed bytior any other previously selected test case viji s1i ftireveals fjandisnotrevealedbythepreviouslyselectedtestcases and0 otherwise.usingthenewlyintroducedvariables equation8canbe rewritten as follows min t summationdisplay.
i ti f f summationdisplay.
j vij noticethatinthisformulation decisionvariables tarenolonger multiplied.
however the transformation has resulted inthe introduction of new decision variables v. we add an additional set of constraints to the model to avoid having an unselected test case affect the minimized value of a solution.
specifically vijshould be subject to the selection of ti i.e.
vijmatters only when tiis selected resulting in the following constraints vij ti fjrevealed by ti theseconstraintsillustratethatifatestcase tiisnotselected vijis forced to be .
however if tiis selected vijcould be either or0 dependingonwhether fjisrevealedbythepreviouslyselected test cases.
inaddition weaddconstraintstomaketheselectedtestcases more diverse in terms of fj t summationdisplay.
i 1vij vij j f theconstraintsin modelourpreferenceforselectingtest cases revealing faults that are not revealed by the previously selectedtestcases ifafault fjisrevealedbyaselectedtestcase tiand its vijis set to then for all other test cases revealing fj their vij has to be .
for example for the constraint v21 v31 obtained fromequation17 where v21 v31 onlyt2ort3canbeselected but not both.
toillustratetheproposedtransformation i.e.
theobjectivefunctioninequation15andadditionalconstraintsinequation16and we apply it to the example of table i.e.
t t1 t2 t3 f f1 f2 f3 f4 and 1 and transform the nonlinear formulation discussed in section .
to the following assignment minimize t1 v14 t2 v21 v22 v23 t3 v31 v32 v33 under the constraints t1 t3 ori inal t2 ori inal t2 t3 ori inal v14 t1 from v21 t2 v22 t2 v23 t2 from v31 t3 v32 t3 v33 t3 from v21 v31 from v22 v32 from v23 v33 from v14 from notice that the decision variables are no longer multiplied in the objective function making the formulation linear while still solving the nonlinear problem.
the optimal solution for this transformedlinearproblemis t1 t2 v14 v21 v22 v23 withaminimal value .
this minimal value is identical to the optimal value for the untransformed nonlinear problem.
the computed solution for the minimization problem i.e.
t1 t2 is also the optimal solution.
optimality of nf ls.
nf lsyieldstheoptimalsolution.the usage of auxiliary variables to transform a nonlinear problem formulationtoalinearoneiswellstudiedintheliteratureandhasbeen proventogenerateanequivalentformulation .aftertransforming the nonlinear mctsm problem to an instance of an ilp problem the optimalsolution can be foundby leveraging modern solvers.notethatthemctsmproblemisknowntobenp complete whichmeansthatanoptimalsolutioncannotbefoundinpolynomial time.however thatdoesnotprecludemodernsolversfrom finding optimal solutions through utilization of branch and bound andotheralgorithmicadvancementsforsizableproblems .that is ilp solvers do not guarantee to return a solutionwithin a time limit but guarantee that the returned solution is optimal1.
implementation figure1depictsourframeworkforsolvingthemctsmproblems asimplementedinourtool callednemo.thetooltakes test related dataand aconfiguration as input.
test related data includes the original test suite and the corresponding coverage data such as statement and fault coverage of the test suite.
in the configuration file userscanspecifytheoptimizationandconstraintcriteria.users can also specify which of the three approaches i.e.
lf ls nf ns and nf ls should be used in the minimization of the test suite.
theformulator component takes the input and expresses the minimization problem as an integer programming problem.
formulatoriscapableofrepresentingtheproblemaseitherlinearor nonlinear as well as transforming the nonlinear formulation into a linearform.theoutputmodelcanthenbefedintoexternalsolvers 1inourexperiments weactuallyneverencounteredaproblemforwhichnf lscould not find a solution.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden jun wei lin reyhaneh jabbarvand joshua garcia and sam malek figure overview of our approach to compute the solution.
for now our tool supports lpandampl formats which many modern solvers such as lp solve cplex and couenne use.
once the solution for the encoded problem is computed the generator component produces the minimized test suite in various formats for presentation to the user.
currently our tool handles solutionsgeneratedbytheaforementionedsolversandwebservices usingthosesolvers suchastheneosserver anddropsolve .
the proposed tool is the only one of its kind to formulate and consider the inherent nonlinearity of the mctsm problem and isavailablefordownload .inthenextsection weevaluateour approach using nemo to answer a set of research questions.
empirical evaluation weassessthreeapproachesforsolvingthemctsmproblem lf ls see section nf ns see section .
and nf ls see section .
.
for lf ls we reimplemented the technique in a tool called mintsproposedbyhsuandorso .wecouldnotusetheoriginalimplementationofmintsbecausethesolversitsupportsare outdated and not scalable for our dataset.
using these approaches we investigate the following research questions rq1.
how does nf lscompare against lf lswith respect toeffectivenessandruntimeperformance?
toassessthisresearch question we use the size of the reduced test suite and the satisfaction of the minimization criteria to characterize effectivenessofeachapproach.forperformance wemeasurethetimeit takes to solve each approach s formulation of the problem.
rq2.
howdoes nf lscompareagainst nf nswithrespect toeffectivenessandperformance?
giventhatnemoisthefirst approach to model general test suite minimization in a nonlinear manner we assess which nonlinear formulation is superior or whetherthereareempiricaltradeoffsbetweenthetwoversions of nemo.
rq3.
how does nf lsscale in relation to the size of subject apps and test suites?
nf lssolvesthenonlinearproblem optimally whichisacomputationallyexpensiveprocess.weinvestigate how the introduction of auxiliary variables impacts the scalability of nf ls.
.
experimental setup subject programs our experimental subjects include the following five open source c projects grep flex sed make and gzip collectedfromapubliclyavailabledataset .theseprogramsare well knowngnusoftwareandwidelyusedinsoftwaretestinganddebugging research .
each subject program in the original dataset has five versions we selected the latest version of each program for our experiments.
table depicts the following detailed pieces of information about our subject programs theselected version a description of the program its size loc and the number of tests and faults available with each version.
test suites each subject program in comes with a test suiteanda setoffaults.weaugmentedavailabletest suiteswith additional tests since their coverage of the subject apps core functions were low i.e.
average coverage was below and can result in test suites that do not comprehensively test the subject programs.tothatend weused klee toensurethatsubjecttest suites achieve a coverage higher than on average for the core functions.tomeasurestatementcoverageoftestsuites weused gcov .
faults theoriginaldataset includesasetoffaultsforeach test suite.
these faults are generated by injecting mutants and purifiedbyremovingequivalentandduplicatemutantsusingtrivialcompilerequivalence tce ascalableandeffectiveapproach tofindequivalentandduplicatemutantsthatcomparesthemachine code of compiled mutants.
we followed the same technique to generate additional unique mutants for the newly generated tests added to the dataset.
minimization problems we compare the minimization techniques using the following three minimization problems classic bi criteria variant bi criteria and tri criteria.
a classicalbi criteria test suite minimization problem minimizes the test suite such that statementcoverageoftheoriginaltestsuiteismaintained while maximizingitsfault detectionability.the variantbi criteria problem is a classic bi criteria problem whose segments of code e.g.
specific api calls methods or classes are more important than others andtherebyneedtobecoveredmultipletimes.examplesof scenarioswherecoveringthesamecodesegmentmultipletimesare importantincludeenergytesting performancetesting orfieldfailurereproduction .thetri criteria problemisamulti criteria minimization problem where the minimized test suite needs to satisfy a budget constraint while maximizing the statement coverage and fault detection ability of the test suite.
since available time for regressiontesting isoften an importantconstraint weconsiderexecutiontimeasthebudgetinourevaluation.note that for these two optimization criteria i.e.
statement coverage and fault detection nf ns and nf ls model dependencies among testcases whilelf lsdoesnot.theweightsforbothoptimization criteria are the same in our experiments.
solvers we used cplex and couenne as linear and nonlinear solvers respectively.
for a fair performance comparison ofdifferentsolvers weusedthesesolversonneos afreeweb service for solving numerical optimization problems.
.
rq1 nf ls vs. lf ls weassesstheeffectivenessandperformanceofeachapproachin terms of the three mctsm problems described in section .
.
effectiveness .wemeasuredtheeffectivenessofeachminimization technique in terms of the size of reduced suites t and corresponding fault detection ability i.e.
the number of faults detected f .forourexperiments thesamesetoffaultsforeachsubjectprogramisusedtoevaluatethefault detectionabilityofthereduced suites because the main objective of our evaluation is to show that the non linear formulation of the mctsm problem can produce authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nemo multi criteria test suite minimization with integer nonlinear programmingicse may june gothenburg sweden table subject programs used in the empirical evaluation.
program version description loc tests faults grep .7pattern search and matching utility flex .
.
lexical analyzer sed .2command line text editor make .80executables builder and generator gzip .3data compressor table effectiveness of different methods modeling the classic bi criteria problem.
the percentage improved by nf ls compared to lf ls and nf ns methodsprograms grep flex sed make gzip t f t f t f t f t f original lf ls nf ls nf ns n an a4432122514134549 nf ls over lf ls .
.
.
.
nf ls over nf ns n an a0 .
n a the solver timed out after eight hours asolutionthatissuperiortoitslinearformulation.bycomparing the solutions produced from approaches using the same exact versionofsoftware faults andcoverageinformation weareableto unequivocallyshowthe superiorityof non linearformulation to linear formulation in a controlled setting.
table3 shows the effectiveness of different minimization techniques for solving the classic bi criteria problem.
these results demonstratethatnf lsachievesanequalorgreaterfault detection abilitycomparedtolf lsandthesametest suitesize.morespecifically the minimized suites of nf ls detected more faults on average than those of lf ls without compromising test suite size.
we observed that the improvements achieved by nf ls vary among different subject programs.
intuitively for an mctsm problem nf ls works better than lf ls if test cases for the same constraintcriterion e.g.
coveringthesamestatement satisfyan optimizationcriterioninadifferentway e.g.
revealingdifferent faults .
for instance in the example of table t1andt3both cover stmt1 butrevealdifferentfaults f4fort1 f1 f2 andf3fort3 .asa result this difference in fault revealing ability can be identified by thenonlinearformulationwhenitselectsatestcaseforcovering stmt1in the minimization process.
to investigate the aforementioned property in our experimental dataset we clustered test cases by the statements they covered for each subject program.
then we calculated average similarity of faultsrevealedamongthetestsinthesamecluster usingthejaccard similarity metric .
jaccard formulates the similarity between two sets a and b as follows j a b a b a b in our experiments a and b are two sets of faults covered by two tests within the same cluster.
for example suppose tests t1 andt2cover the same set of statements causing the tests to be clustered together.
if execution of t1revealsa f1 f2 andt2 revealsb f2 f3 thejaccard similarityfor these twotests are computed as j a b .
for a given a program effectiveness of the nonlinear formulation will degrade as the average similarity among all clusters intable4 averagejaccardsimilarityofthefaultsetsrevealed by the test cases covering the same set of statements program grep flex sedmake gzip similarity .
.
.
.
.
that program approaches .
this effect occurs since tests coveringthesamestatementsalsocoverincreasinglysimilarfaults.as that average similarity approaches the nonlinear formulation performs more effectively i.e.
tests covering the same statements cover increasingly different faults.
table 4shows the jaccard similaritycalculated for each subject program.toobtaintheseresults wefirstcalculatedthesimilarity betweeneachpairoftestcasesinthesamecluster.wethencomputedtheaveragesimilarityamongallpairswithinacluster.for gzip the similarity is and the nonlinear formulations obtains no improvementinthenumberoffaultsrevealed asshownintable3.
however inthecaseofgrep theaveragesimilarityamongallclustersis0.
thelowestsimilarityamongallprograms andalso obtains the greatest improvement in the number of faults revealed as shown in table .
note that the effectiveness of the nonlinear formulationisalsoinfluencedbyotherfactors e.g.
totalnumber of faults and hence cannot be solely predicted by fault similarity.
forthevariantbi criteria problem thegoalistomaximizethe fault detection abilityof the reducedsuite while maintainingthe same statement coverage.
additionally we selected the top of statements executed most frequently to identify the potentially mostimportantstatementstoexecute.foreachofthesestatements we forced them to be executed at least of the number of times they were executed by the entire test suite.
table shows the ef fectiveness of different minimization techniques on the variant bi criteria problem.
these results demonstrate that nf ls s test suiteshaveasuperiorfault detectionabilitythanlf ls stestsuitesforallsubjectprograms.specifically thereducedsuitesofnf lsdetected17 morefaultsonaveragethanthesuitesoflf lswithout increasing the size of the test suite.
forthetri criteria problem weformulatedtheproblemtoconstrainthesizesofthereducedsuitesto5 and20 andto maximize the statement coverage and fault detection effectiveness with the same weights.
given that even test suites of only 20kloc authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden jun wei lin reyhaneh jabbarvand joshua garcia and sam malek table effectiveness of different methods modeling the variant bi criteria problem.
the percentage improved by nf ls compared to lf ls and nf ns methodsprograms grep flex sed make gzip t f t f t f t f t f original lf ls nf ls nf ns n an an an an an a1715n an a nf ls over lf ls .
.
.
.
.
nf ls over nf ns n an an an an an a0 n an a n a the solver timed out after eight hours table6 effectivenessofdifferentmethodsmodelingthe tri criteria problem.
thepercentageimprovedbynf lscompared to lf ls size constraintmethodsprograms grep flex sed make gzip t stmt f t stmt f t stmt f t stmt f t stmt f original lf ls nf ls nf ls over lf ls .
.
.
.
.
.
.
.
.
.
lf ls nf ls nf ls over lf ls .
.
.
.
.
.
.
.
.
.
lf ls nf ls nf ls over lf ls .
.
.
.
.
.
.
.
.
.
lf ls nf ls nf ls over lf ls .
.
.
.
.
.
.
.
.
.
cantakeweekstorun selectingtestsuitesthatareafractionof the total number of existing test cases is a sensible testing strategy.
the results for this experiment are depicted in table .
our resultsdemonstratethatnf lsconsistentlyoutperformslf lsfor allsubjectappsandsizeconstraints.particularly testsuitesreduced by nf ls executed more statements and more faults than thesuitesbylf lson average.wecanseethattheimprovement achieved by nf ls in this problem is larger than the previous two problems.
this could be attributed to the looser constraints in this problem and hence the larger solution space for all the techniques.
for instance given that the constraint is to reduce the test suite of grep to the size of the solution space for this problem is parenleftbig746 parenrightbig .
.iftherearemoreconstraints e.g.
constraints forstatementssuchasthoseincludedinthepreviousproblems the solution space would be further limited because some solutions in it do not satisfy the additional constraints.
as the solution space grows larger the effectiveness gap between the solutions returned by nf ls and lf ls is expected to increase.
performance .tables7and8showcasetheexecutiontimesthat solversofdifferentapproachestooktosolvethe classicbi criteria and thevariant bi criteria problems respectively.
we retrieved the results from reports generated by neos .
these results demonstrate that nf ls can solve these two problems as efficiently as lf lsdoes andthesolutionsforallsubjectappswerefoundwithin a second.
forthetri criteria problem wewerenotabletosubmitthemodel files to neos due to its size limitations for uploaded files.
we thus ran the solver locally and report the execution times in table .
theseresultsindicatethatnf lstakesalongertimethanlf ls to solve the problem.
the difference between the performancetable performance of different methods modeling the classic bi criteria problem methodsprograms solving time in seconds grepflexsedmakegzip lf ls nf ls nf ns n a170821854 n a the solver timed out after eight hours table performance of different methods modeling the weighted bi criteria problem methodsprograms solving time in seconds grepflexsedmakegzip lf ls nf ls nf ns n an an a530n a n a the solver timed out after eight hours table9 performanceofdifferentmethodsmodelingthe tricriteriaproblem with a size constraint methodsprograms solving time in seconds grep flexsedmakegzip lf ls nf ls of nf ls and lf ls for the tri criteria problem comes from the higher complexity of the problem compared with the first two minimization problems.
while those two problems have a single optimization criterion i.e.
maximizing fault detection ability the tri criteria problem has an additional optimization criterion i.e.
maximizingstatementcoverage .tosolvethissignificantlymore complexproblem auxiliaryvariablesintherangeofhundredsof thousandswereintroducedinnf lsbecausetherearethousandsof authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nemo multi criteria test suite minimization with integer nonlinear programmingicse may june gothenburg sweden statements for the subject apps.
nevertheless the optimal solution foundbynf lsforthis tri criteria problem asshownintable6 vastly outperforms the solution found by lf ls.
for gzip under a10 sizeconstraint lf lssolvedtheproblemwithinasecond whilenf lstookabout26minutes.however thesuitereducedby nf ls executed more statements and more faults than the suite reduced by lf ls.
althoughnf lstakeslongertoproduceasolution theapproach produces immensely improved solutions.
for instance testers may run nf ls for a few minutes to hours rather than a few seconds inthecaseoflf ls buttheyobtainasolutionthatrevealsmuch more faults with fewer tests which in turn can save engineers time and effort from having to examine and run more tests.
.
rq2 nf ls vs. nf ns similar to the previous rq we compared nf ls and nf ns in terms of effectiveness and performance.
we further discuss the advantages or disadvantages of selecting among the two nonlinear approaches based on our empirical results.
effectiveness .table3showsthat forthe classicbi criteria problem nf nswas able to findthe optimal solutionsfor only three subject programs flex sed and make.
the solver timed out after eight hours for grep and returned a suboptimal solution for gzip.table5furthershowsthat forthe variantbi criteria problem nf ns only found the optimal solution for make and the solver timedout aftereight hoursfor othersubject programs.we donot reporttheeffectivenessofnf nsforthe tri criteria problem because we were not able to use neos to solve it due to the size limitation of neos for uploaded files.
the reported results indicate that as expected the nonlinear solver is not guaranteed to find anoptimalsolutionforthenonlinearformulationiftheobjective function is non convex .
however nf ls can optimally solve mctsm problems formulated nonlinearly.
performance .
for theclassic bi criteria problem table shows nf nstakesmuchlongertimetosolvetheproblemthannf ls.
while nf ls solved the problem within a second for all subject apps the solver used by nf ns timed out for grep and took from 20secondstosixhourstofinish.forthe variantbi criteria problem table indicates that nf ns was able to finish only for make and the solver timed out for other subjects.
the results indicate that off the shelf nonlinear solvers cannot solve mctsm problems in a timelymanner whichconfirmstheneedtotransformthenonlinear problem formulation toa linear one.
overall nf ls is superior to nf ns in terms of both effectiveness and performance.
.
rq3 scalability given nf ls s superior performance over nf ns we focus on studyingthescalabilityofnf ls.specifically weinvestigatethe mannerinwhichnf lsscaleswithrespecttothesizeofsubject programsandtestsuites.intuitively thetimenf lstakestosolvea minimizationproblemdependsonthecomplexityoftheformulated model intermsofthenumberofdecisionvariablesandconstraints.
thiscomplexityisdeterminedbythecharacteristicsoftheproblem e.g.
number of test cases requirements and criterion entities .
weconductedasensitivityanalysisofnf lsonthe tri criteria problem i.e.
the most complicated problem in our evaluation.
for each program starting from the size of of the test suite we gradually increased the size of test suites to and reported thenumberofvariablesintheformulation and theexecution figure sensitivity of the test suite size to number of variables for nemo on the tri criteria problem figure3 sensitivityofthetest suitesizetosolvingtimefornemo on the tri criteria problem timeforsolvingtheproblem.werepeatedtheexperiments30times and reported the average with a confidence interval.
figure depicts the relation between the size of a test suite and the number of variables used in the problem formulation.
while the number of variables range in the hundreds of thousands for each problem the number grows linearly as does the size of the test suite.
figure depicts the relation between the size of a test suite and solver execution time.
as the size of a test suite grows linearly the timerequiredtofindanoptimalsolutionincreasesexponentially.
nevertheless nf ls is optimal and can be adopted to compute op timalsolutionsasefficientlyaslf lsforsimplermctsmproblems suchasthe classicbi criteria andvariantbi criteria problems and optimallysolvespractical complexproblems suchasthe tri criteria problem in a reasonable amount of time.
related work single criterion test suite minimization problem.
a significant number of previous studies have examined obtaining the minimalsubsetoftheoriginaltestsuite thatsatisfiestheoriginaltest requirements .chvatal proposesaclassical greedy heuristic that iteratively selects test cases covering mostunsatisfiedrequirementsuntilallrequirementsarecovered.
harroldetal.
presentagreedyheuristicthatconsidersthetestingsetsthatsatisfyeachtestrequirement andrepeatedlyselects test cases from the testing sets with minimal cardinality.
chen and lau propose another heuristic that identifies two special kinds of test cases from the original suite essentialand1 to redundant.
the approach iteratively picks essential removes to redundant authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden jun wei lin reyhaneh jabbarvand joshua garcia and sam malek andgreedilyselectstestcasescoveringamaximalnumberofunsatisfiedrequirements.offuttetal.
proposeaheuristiccombining different test execution orderings i.e.
forward reverse and insideout toreducethesizeoftestsuiteswhilemaintainingthemutation score or statement coverage achieved by the original suites.
anotherheuristicbytallamandgupta called delayed greedy isbasedonformalconceptanalysisandcombinesbothperspectivesoftestcasesandrequirements.theirexperimentsshowthat delayed greedycanachieveequalorbettersizereductionthanprevious heuristics.
by formulating the problem as finding a spanning set over a graph marre and bertolino propose a technique to reducethenumberoftestcasesrequiredtosatisfytherequirements.
leitneret al.
propose atechnique combiningprogram slicing anddeltadebuggingtominimizefailingtestcasesinrandomized unittestgeneration whichisfocusedonreducingindividualtest cases rather than the sizes of test suites.
all of these approaches focus on a single criterion and generate approximate solutions.
multi criteriatest suiteminimizationproblem.
whileprevious approaches can be adopted to efficiently find a solution a majorconcern ofsingle criterion minimizationisthat minimizing a test suite could severely compromise its ability to reveal faults .
toaccount foradditional criteria such as fault detection capability severalapproacheshavebeendevelopedthatconsider additional information including hybrid combinations of different coveragecriteria intheminimizationprocessandgeneratinga reducedsuitewhichhasbettereffectivenesswithrespecttovariouscriteria suchasfaultdetection and energy consumption .
with respect to improving fault detection effectiveness of the reduced suite a few techniques are heuristics based.
jeffery and gupta proposeaheuristicthatselectivelypicksredundanttest casesforthereducedsuitebyusingadditionalcoverageinformation.aheuristic bylinandhuang usesan additionaltesting criterion to break ties in the minimization process.
inadditiontotheheuristics ilpisadoptedtocomputesolutions for the problem.
black et al.
formulate the problem as a binary ilpmodel.theydirectlytake thefault rev ealingabilityoftestcases into account encodeit into the objective function andcompute a solution for the problem using an ilp solver.
hao et al.
collect statistics on fault detection loss at the statement level and encode theinformationintotheconstraintsoftheformulatedilpmodel to control the fault detection loss of the reduced suite.
anothersetofpreviousworkconsidersotheraspectsofminimizingatestsuitewhilemaximizingitsfault detectioncapability.this workincludesusingdifferentcoveragecriteriasuchascall stack coverage adopting different reduction algorithms or applyingtechniquessuchasdelta debugging non adequate reduction i.e.
onlyacertainpercentageoftheoriginalcoverage is retained or a combination of test reduction and selection .
other work also addresses the trade offs specific for reused software and an industrial system .
with respect to criteria other than fault revealing capability li etal.
takeenergyconsumptionoftestcasesintoconsideration andadoptanintegerprogrammingapproachtogenerateminimized testsuiteswhichareenergy efficientforpost deploymenttesting on embedded systems.
similarly jabbarvand et al.
propose an integer programming approach as well as a greedy algorithm to minimize test suites while trying to maintain the capability of the reduced suites to reveal energy bugs.unlike nemo all of these mctsm approaches focus on specific bi criteriaproblemsanddonotallowtesterstospecifyawiderange ofmctsmproblems cannotcomputeoptimalsolutionsforthem and cannot deal with dependencies between test cases over any testing criteria.
hsu andorso proposedmints aframework for mctsm that is able to accommodate an arbitrary number of objectives and provides flexibility for testers to combine weight and prioritize theirobjectives.recallthatlf lsisare implementationofmints sincetheoriginalimplementationusesoutdatedsolversanddoes notscaletoourexperimentaldataset seesection5 .theirapproach formulates the problem as one or more ilp problems in which the testrequirementsareencodedasconstraints andtheobjectivescanbeeitherassociatedasweightsinobjectivefunctions orprioritized as invocation orders of ilp problems.
while their work focuses on ageneralized approachfor mctsm their problemformulationis linear which as shown both in theory section and empirically section5 inthispaper producessub optimalsolutions duetothe inability to model dependencies among test cases over specified criteria which must be modeled nonlinearly.
conclusion and future work multi criteriatest suiteminimizationtechniqueshelpreducethe cost of regression testing by removing redundant tests based on somecriteria whiletryingtooptimallykeepthecapabilityofthereducedsuiteintermsofothercriteria.alloftheexistingapproaches sufferfromatleastoneofthetwoshortcomingsdiscussedinthis paper theyeitheruseheuristicalgorithmsorignoretest case dependencies among minimization criteria and hence generate approximateorsuboptimalsolutions and theyhandleminimization problems involving only limited and pre specified criteria.
in this paper we proposed a general framework for the multicriteriatest suiteminimizationproblem.ourapproachtakesinto account the inherent nonlinearity of the problem and models it usingintegernonlinearprogramming.tosolvethenonlinearformulation optimally we developed a technique that programmatically transforms it to a linear form so that modern ilp solvers can be leveraged.
we have implemented our approach as a tool called nemo and empirically evaluated it.
our experimental results show that nemo can be used to find optimal solutions for several min imization problems within a reasonable time.
nemo was able to produce reduced test suites that could execute up to more statements and detect more faults than those produced using prior work.
aninterestingdirectionforfutureworkistoinvestigateapplicability of our approach in other test maintenance activities such as test selection and prioritization.
we also plan to conduct experimentsinvolvingmorecomplexcriteria suchasmc dc toassess theeffectivenessof anonlinearapproachinsatisfying suchcriteria in test suite minimization.
finally we plan to empirically evaluate the fault detection ability of the reduced test suites when executed on previously unseen faults.
acknowledgement this work was supported in part by awards ccf cns1629771andccf from the national science foundation hshqdc c b0040 from the department of homeland security andfa95501610030 from the air force office of scientific research.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nemo multi criteria test suite minimization with integer nonlinear programmingicse may june gothenburg sweden