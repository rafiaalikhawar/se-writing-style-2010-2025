stubdroid automatic inference of precise data flow summaries for the android framework steven arzt secure software engineering group ec spride technische universit t darmstadt darmstadt germany steven.arzt cased.deeric bodden software engineering group paderborn university fraunhofer iem paderborn germany eric.bodden uni paderborn.de abstract smartphone users su er from insu cient information on how commercial as well as malicious apps handle sensitive data stored on their phones.
automated taint analyses address this problem by allowing users to detect and investigate how applications access and handle this data.
a current problem with virtually all those analysis approaches is though that they rely on explicit models of the android runtime library.
in most cases the existence of those models is taken for granted despite the fact that the models are hard to come by given the size and evolution speed of a modern smartphone operating system it is prohibitively expensive to derive models manually from code or documentation.
in this work we therefore present stubdroid the rst fully automated approach for inferring precise and e cient library models for taint analysis problems.
stubdroid automatically constructs these summaries from a binary distribution of the library.
in our experiments we use stubdroid inferred models to prevent the static taint analysis flowdroid from having to re analyze the android runtime library over and over again for each analyzed app.
as the results show the models make it possible to analyze apps in seconds whereas most complete re analyses would time out after minutes.
yet stubdroid yields comparable precision.
in comparison to manually crafted summaries stubdroid s cause the analysis to be more precise and to use less time and memory.
categories and subject descriptors f. .
semantics of programming languages program analysis keywords static analysis summary library framework model model inference during the time this research was conducted eric bodden was at fraunhofer sit technische universit at darmstadt.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
icse may austin tx usa c acm.
isbn .
.
.
.
introduction over the past years the android operating system has become the most prevalent platform in the smartphone market with a market share of more than .
applications for the platform are provided by many vendors.
as of now there are more than one million applications available through the o cial google play store alone and numerous other app markets exist as well.
with these numbers the quality and security of android applications has become a major concern which can no longer be addressed by manual code inspection.
indeed researchers have already proposed various static code analysis tools for android mostly addressing dataow problems .
analyzing the application alone however is insu cient as applications make heavy use of the android framework s application programming interface.
in version .
android o ers over public methods and the number constantly grows with every new release.
for an analysis to be precise it must not only analyze the application code but also consider the e ect of these library methods on data ows inside the application.
existing approaches to static analysis deal with library methods in one of three ways.
the rst class of analyses precisely models a subset of these framework methods manually while the second class analyzes the entire android framework together with every application .
the third class uses simple rules of thumb such as taint return value of call if one or more arguments are tainted which are expected to cover the most common cases .
all of these approaches exhibit serious drawbacks.
providing hand written models for the framework is cumbersome to implement and requires manual re evaluation of and possibly changes to the model for every new framework version which is a prohibitive e ort given the size of the code to be understood and modeled.
chex for instance opts to not analyze the framework together with the application and instead resorts to externally de ned models.
however the source of the models is mostly left open e ectively burdening the user with this non trivial task.
including the framework in the automated code analysis evades this manual e ort but it introduces an often prohibitive overhead on the code analysis in terms of the overall code size to be analyzed.
the android operating system consist of millions of lines of code thereby greatly exceeding the size of usual applications to be analyzed causing the analysis to spend signi cantly more time in analyzing library code than in analyzing application code i.e.
the code that is of actual interest to most analyses.
in previous work on flowdroid we found such an approch to induce a sig2016 ieee acm 38th ieee international conference on software engineering ni cantly increased analysis time for every single app over and over again.
applying rules of thumb instead of a proper library implementation or external model evades the problems of high runtime overhead and high manual e ort.
however it remains unclear to what extent these rules actually cover all important libraries or whether false negatives may occur due to missing taint propagations.
worse if these rules are designed to avoid false negatives they necessarily need to over approximate the behavior of method calls and can thus lead to an increased number of false positives.
recall that these rules are oblivious to the individual callees but aim at a generic model for all library calls.
in conclusion none of the approaches presented so far solves the challenge of handling libraries during static analysis to full satisfaction.
in this work we thus present stubdroid the rst fully automated approach for inferring taintow models from binary library distributions such as the android framework.
stubdroid rst performs a taint analysis on selected public methods.
we demonstrate this for the collections api which is the most commonly used part of the framework.
stubdroid then generalizes the resulting source to sink dataow mappings and stores them in a summary le.
when a static client side taint analysis later processes the invocation of a framework method within the code of an android app the analysis can simply plug in the information from the summary le and short circuit further analysis of the framework call and all its transitive callees.
while seemingly simple a signi cant challenge lies in establishing summaries that are eld sensitive and handle aliasing and in treating correctly the various callbacks that the framework code might use to interact with the application.
furthermore note that the generated summaries are independent of any concrete client application.
they must thus abstract from all possible state or call sequences while still retaining maximum precision.
we show that on commodity hardware it is usually possible to generate library summaries in under three minutes per framework class a one time e ort.
using stubdroid s summaries for conducting a taint analysis on client applications with the flowdroid taint tracking tool can improve the analysis performance by over .
for many applications the use of summaries even enables the analysis as the full analysis of those apps would time out after spending minutes and consuming tens of gigabytes of memory if summaries were not used.
stubdroid avoids these blowups because opposed to client analyses its analysis can focus on one framework entry point method at a time.
to summarize this paper presents the following original contributions stubdroid a method for automatically generating correct and precise models of the android framework methods with respect to taint analysis a full open source implementation of the above as an artifact taint summaries for various important android apis and an evaluation of the peformance e ect of summary usage in the flowdroid taint analysis tool.
stubdroid s full source code and the library summaries generated with it are publicly available as an open source project at remainder of this paper is structured as follows.
in section we motivate why simple rules of thumb are not su cient to handle library methods in a taint analysis.
section shows what taint summaries for a method look like and also introduces the concept of access paths which stubdroid uses to model eld