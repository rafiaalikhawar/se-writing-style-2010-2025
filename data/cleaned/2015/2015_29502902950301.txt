keep it simplex satisfying multiple goals with guarantees in control based self adaptive systems stepan shevtsov linnaeus university v xj sweden stepan.shevtsov lnu.sedanny weyns ku leuven belgium linnaeus university sweden danny.weyns kuleuven.be abstract an increasingly important concern of software engineers is handling uncertainties at design time such as environment dynamics that may be di cult to predict or requirements that may change during operation.
the idea of self adaptation is to handle such uncertainties at runtime when the knowledge becomes available.
as more systems with strict requirements require self adaptation providing guarantees for adaptation has become a high priority.
providing such guarantees with traditional architecture based approaches has shown to be challenging.
in response researchers have studied the application of control theory to realize self adaptation.
however existing control theoretic approaches applied to adapt software systems have primarily focused on satisfying only a single adaptation goal at a time which is often too restrictive for real applications.
in this paper we present simplex control adaptation simca a new approach to self adaptation that satis es multiple goals while being optimal with respect to an additional goal.
simca o ers robustness to measurement inaccuracy and environmental disturbances and provides guarantees.
we evaluate simca for two systems with strict requirements that have to deal with uncertainties an underwater vehicle system used for oceanic surveillance and a tele assistance system for health care support.
ccs concepts software and its engineering !designing software computing methodologies !computational control theory keywords self adaptive system control theory simplex multiple goals .
introduction the ever growing demand on software has drastically increased the burden on software engineers.
customers expect software to cope with continuously changing conditions.
theyexpect the software to deal seamlessly with varying resources mask sudden failures and adapt to changes in system goals.
often these changing conditions are di cult to predict at design time and handling these uncertainties has become an important concern of software engineers.
self adaptation is widely encouraged to address such uncertainties .
self adaptation handles uncertainties at runtime when the knowledge becomes available.
to that end the system is equipped with a feedback loop that monitors the system and environment and adapts the system to meet the requirements under changing conditions.
as more systems with strict requirements require self adaptation providing guarantees for adaptation has become a high priority concern .
architecture based approaches for self adaptation where feedback loops consist of components that realize monitor analyze plan execute mape functions have been widely used to ensure system goals under uncertainty.
however recent research has pointed out that providing assurances for such systems is very challenging calling for new perspectives on engineering self adaptive systems.
more then a decade ago hellerstein et al.
argued for using principles from control theory as a solution for runtime adaptation with formal guarantees.
this viewpoint has recently gained increasing attention e.g.
.
in this approach a software system is treated as a plant to be controlled1 and a control feedback loop empowers the software with self adaptation capabilities providing formal guarantees regardless of uncertain operating conditions .
recently a strategy for applying control theory to computing systems in a general way has been proposed in the form of the push button methodology pbm .
pbm can automatically build a controller of an adaptive software system that rejects environmental disturbances while providing control theoretical guarantees for key properties.
as the approach is automated pbm can be used by practitioners with little control theoretical background.
however pbm deals only with one quanti able goal at a time which is often too restrictive for real applications.
for example consider an e commerce website that should guarantee particular response times for di erent categories of customers using available resources while maximizing pro t from advertisements.
another example is a video streaming service that should provide a particular video quality for each class of costumers employing the available computation facilities while minimizing congestions along the streaming paths to consumers.
1in control theory terminology plant usually refers to a physical system that is adapted.
it is often called the managed system by software engineers.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
fse november seattle wa usa c acm.
... .
in our research we focus at one relevant adaptation problem that requires satisfying multiple goals while optimizing the solution according to an additional goal such as the examples given above.
a well known approach to handle such problems is the simplex method and its variations.
however simplex cannot be applied as is to realistic software problems as it can not handle the variety of uncertainties and disturbances that are inherent to software systems.
simplex has no mechanism for rejecting disturbances transient noise measurements inaccuracies etc.
nor does it guarantee system stability or absence of errors in the system output.
recent work has explored a control based approach to handle multiple objectives and pointed to its relevance for practice.
however that approach has restrictions regarding the guarantees it can provide and the engineering support it o ers.
we further elaborate on this in section .
in this paper we present a new approach called simplex control adaptation simca that aims at solving the problem of adaptation for multiple objectives with guarantees.
simca builds upon pbm and the simplex method combining strengths of both approaches.
simca is able to nd a system con guration that satis es multiple goals reaches optimality with respect to an additional goal achieves robustness to environmental disturbances and measurement inaccuracy and provides control theoretical adaptation guarantees.
to that end simca runs on the y experiments on the software in an automated fashion builds a set of linear models of the software at runtime creates a set of tunable controllers that operate on these models and combines controller outputs using the simplex method to adapt the system.
the controllers of simca use kalman lters to dynamically adapt the linear model in order to cope with disturbances and non linearities.
the evaluation of simca is conducted in two steps.
first we evaluate the control theoretical guarantees provided by the approach including system stability settling time absence of overshoot and steady state error solution optimality robustness and detection of infeasible solutions.
not achieving these guarantees may violate certain software qualities.
for example lack of robustness guarantees may lead to instability under disturbances violating reliability requirements.
a more detailed mapping between guarantees and software qualities is given in section .
second the e ectiveness and generality of simca is demonstrated on two cases a uuv unmanned underwater vehicle system performing surveillance missions and a service based system for health care.
these systems are from di erent domains but self adaptation must guarantee that the strict requirements of both systems are achieved at runtime regardless of the disturbances.
in addition we provide a qualitative comparison of simca with the approach presented in .
the remainder of the paper is structured as follows.
a motivating scenario for simca is introduced in section .
section presents simca and explains how to build selfadaptive systems with the approach.
the formal evaluation of guarantees provided by simca is given in section .
in section simca is empirically evaluated using two cases.
section discusses related work.
finally conclusions and directions for future research are presented in section .
.
motiv ating scenario uuv system we describe a uuv system based on that we use as one of the cases to evaluate simca in section and to illustrate the technical description of simca in the next section.
uuvsare increasingly used for a wide range of tasks.
here we look at uuvs used for oceanic surveillance e.g.
to monitor pollution of an area.
uuvs have to operate in an environment that is subject to restrictions and disturbances correct sensing may be di cult to achieve communication may be noisy etc.
requiring a uuv system to be self adaptive.
furthermore there is a need for guarantees as uuvs have strict requirements i.e.
the system should not impact the ocean area and since vehicles are expensive equipment that should not be lost during missions.
the self adaptive uuv system in our study that is used to carry out a surveillance and data gathering mission is equipped with on board sensors that can measure the same attribute of the ocean environment e.g.
water current or salinity .
each sensor performs scans with a certain speed and accuracy while consuming a certain amount of energy see table .
a scan is performed every second.
table parameters of sensors of the uuv.
uuv energy cons.
scan speed accuracy on board sensor j s m s sensor1 .
sensor2 .
sensor3 .
sensor4 .
sensor5 .
the uuv system has to satisfy the following requirements r1 a segment of surface over a distance of s 100km should be examined by the uuv within a given time t hours in the scenario r2 to perform the mission a given amount of energy eis available .
mj in the scenario r3 subject to r1 and r2 the accuracy of measurements should be maximized.
to realize the requirements sensors can be dynamically turned on and o during a mission.
we assume that only one sensor is active at a time however we use a combination of sensors during each adaptation period.
for example to perform a mission with energy consumption of j s we may either use sensor2 of the time or use sensor1 of the time using .
j s and sensor4 of the time using .
j s .
the requirements r1 and r2 are critical to the success of the surveillance mission but they may change at runtime due to unpredictable events in the environment.
in addition the adaptation task is not trivial because the system is a ected by di erent disturbances such as fluctuations in the expected behavior of the uuv actual scanning speed or energy consumption di ers from the speci cation up to of the expected values inaccurate measurements e.g.
the monitoring mechanism reports a scanning speed of .
m s instead of the actual value of .
m s constant deviations of the sensor output due to a sensor problem e.g.
a sensor starts consuming more energy than stated in the speci cation sensor failures gaussian or random noise in the communication channel which may cause errors of the communicated data.
in summary to realize its mission the uuv needs to selfadapt to changes in requirements and rejects di erent types of disturbances.
the achievement of goals must be guaranteed.
230problem de nition the general adaptation problem we aim to solve is the following to guarantee the satisfaction of multiple goals and optimize the solution according to another goal regardless of possible uctuations in the system parameters measurement accuracies requirement changes and dynamics in the environment that are di cult to predict.
the uuv scenario o ers one concrete instance of this general problem.
de ning and developing an adaptive solution for this general problem introduces several key challenges.
first the appropriate adaptation sensors measured variables and actuators knobs that can in uence the software behavior must be carefully chosen.
second the software system must be modeled.
third the appropriate adaptation mechanism that controls the model and satis es multiple goals while rejecting external disturbances must be developed.
fourth the system must incorporate an optimization approach to optimize the solution according to additional goal.
the following section proposes simca that aims to address these challenges.
.
simplex control adaptation to build an adaptive system with simca the approach requires four elements from a software engineer .
a working prototype of the software plant .
.a set of quanti able goals to be controlled plus one optimization goal.
for requirements with time dependent constraints e.g.
a constraint on the available energy to be used in time window we transfer the constraints to setpoints that satisfy the constraints over time.
.tunable parameters actuators that can be used to adapt the running system to address the goals.
.adaptation sensors2to measure the e ect of the adaptation on the system.
with these four elements simca is able to build a selfadaptive system that solves the adaptation problem formulated in section .
in order to use simca engineers do not need to construct software models.
instead the approach works in three runtime phases first in the identi cation phase simca synthesizes models that capture the dependency between the adaptation parameters and the measured system outputs.
second in the controller synthesis phase simca constructs an appropriate set of controllers for the synthesized models.
third in the operation phase the controllers carry out control and the outcome of multiple controllers is combined using the simplex method to optimally drive the outputs of the system towards the set goals.
the three phases of simca are performed during system operation.
we describe the phases in detail in the following subsections.
2not to be confused with uuv sensors in the motivating case.
control signal goalmeasured output tran s. ui si oimodel buildingplantfigure identi cation phase of simca.
uuv scenario before that we illustrate the four elements required from a software engineer to apply simca to the uuv system .
a working prototype is the uuv system itself.
.the quanti able goals are the scanning speed and energy consumption the optimization goal is the measurement accuracy.
we transform requirements r1 and r2 into quanti able goals as follows we keep the average scanning speed on a particular level such that the target area of surface is examined in the given amount of time similarly we keep the average energy consumption on a particular level such that the mission is performed with the available energy.
.the actuator of the uuv system is the combination of sensors that are used for performing the mission.
.the sensor is the monitoring mechanism that measures the scanning speed and energy consumption of the uuv system during the mission.
.
identification phase during the rst phase a set of nlinear models of the controlled system is automatically built where nis the total number of goals excluding the optimization goal.
each model mi i2 is responsible for one goal si.
similar to basic pbm identi cation starts by systematically feeding sampled values of the goal siin the form of a control signaluito the plant and measuring their e ect on the system outputoi see figure .
the vector of control signals ui used for identi cation looks as follows ui wheremin iandmax iare the minimal and maximum achievable values for the i th goal is the sampling rate.
is a tunable parameter chosen by the system engineer by default max i mini .
a higher sampling rate will provide a more accurate model but increase the identi cation time whether this is required depends on the domain.
during the identi cation phase and the control synthesis phase see below the control signal ui k is automatically translated marked trans.
on figures and to an actuation signal before feeding it to the plant.
a control signal may for example be translated to the change of a parameter setting of the system or the selection of a component or a service.
this translation is performed by the simplex method that serves as a straightforward translator of control signals to an actuation signal during the identi cation and control synthesis phases.
such simpli ed translation works because at this stage we need an approximate model and not an optimal solution.
after recording all combinations of control signals and resulting system outputs the dependency between the control signalui k and its e ect on the measured output oi k is captured by the coe cient iwhich is further used to build 3uiis an array of elements with ui k being thek th element of that array where kequals to one adaptation period 231controllerci.
coe cient iis calculated based on linear regression using the apre tool .
as a result a set of rst order linear models is obtained representing the reaction of the system to control signals for the di erent goals oi k i ui k mi the modelmidescribes the system behavior but does not take into account small disturbances or sudden failures that typically can occur in practical software systems.
for example this model may not be able to deal with a particular component failure at runtime.
earlier work has show that miis a linear model that is practical and works for a variety of applications and this is con rmed by the two studies presented in section .
the di erent cases have shown that to be e ective the model does not need to capture the precise usually non linear relationship between the control signal and the system output.
in addition the synthesized controller has mechanisms see the following section that allow to use mieven for non linear systems working under disturbances.
exploring the e ect of a range of values of a goal on the system output during identi cation may a ect the realization of a temporal constraint associated with that goal.
this e ect was not taken into account in the original pbm .
to ensure that the constraint is not violated the model building module measures the time tiand resources rispent for identi cation subtracts this amount from the available time tiand resources rirespectively and automatically adjusts the quanti able goal siaccordingly si ri ri ti ti uuv scenario we illustrate the identi cation phase for the energy consumption goal of the uuv system.
according to table the minimal available energy consumption is min e 78j s while the maximum is max e 170j s. then by default max e min e .
the model identi cation starts with sending ui min e 78j sto the plant that is automatically translated by simplex to use sensor all of the time because sensor consumes exactly that amount of energy according to speci cation.
the goal of this procedure is to measure and record the actual output energy consumption of the vehicle oe .
after that the plant receivesui min e 6j s simplex translates it to a corresponding combination of sensors to be used and the output oe is measured again.
when the values of oiare measured for all k coe cient iis calculated with the apre tool resulting in a system model for the energy consumption goal of the uuv system.
we observed a typical value of ifor this model in the range .
.
.
.
.
.
after the identi cation the goal seis adjusted according to the amount of consumed energy and time see eq.
for the uuv case se j s .
controller synthesis phase the second phase of simca labeled controller synthesis consists of two sub phases controller building and controller re building see figure .
controllers are built once when the system starts and may be rebuilt during system operation.
controller building during this rst sub phase a set of n controllers is built using the set of models mi i2 control signal goalmeasured output error controller uiei si oitran s.plantcifigure control synthesis phase of simca.
each controller managing one goal.
a controller cihas one tunable parameter called pole denoted with pi.
to maintain stability and avoid oscillations the pole value should belong to the open interval .
the pole is chosen by the controller designer and allows to trade o certain system properties see discussion in section .
as shown in the system output equation representing the measured output oi k in response to a unit step4setpoint siis de ned as follows oi k si pk i by using z transform a frequency domain representation of a discrete time control signal on mi and and by analyzing the system input output relationships the following controller equation can be obtained ui k ui k pi i ei k ci the synthesized controller ci i2 calculates the control signalui k at the current time step kdepending on the previous value of control signal ui k model adjustment coe cient i controller pole piand the error ei k with ei si oi.
controller rebuilding during the second sub phase the controllers handle inaccuracies in mi.
to that end the controllers of simca incorporate two additional mechanisms introduced by pbm .each controller uses a kalman lter to constantly update the value of adapting the linear model at runtime.
this mechanism allows to cope with small perturbations that could not be tracked by non adaptive miand assures robustness for non linear behaving systems.
.each controller is equipped with a change point detection mechanism which allows to react to unexpected critical changes in the system.
the mechanism updates the system parameters or in some scenarios re initiates the identi cation phase and rebuilds mi.
an example of a critical change may be a software component that suddenly becomes unavailable.
although requiring extra computations the mechanism is quite simple and makes the controller extremely robust.
uuv scenario we illustrate control synthesis with examples.
assume that the identi cation phase has produced a model for the energy consumption goal with e .
if the engineer has set the pole for the controller to pe then the controller building phase will synthesize the following controller ue k u1 k ee k 4step in the setpoint of magnitude one for example when scanning speed is required to change from to m s. 5pk iispito the power k. 232if during system operation the uuv slows down due to unexpected underwater streams in some area the kalman lter will change eaccordingly and trigger controller rebuilding.
if the change point detection mechanism detects a critical change e.g.
some of the uuv sensors fail a reidenti cation will be triggered resulting in a new value of e which will be updated in the controller equation.
.
operation phase the third phase of simca labeled operation also consists of two sub phases control and optimization see figure .
control in the rst sub phase the set of controllers e ectively perform control.
each controller cimanages one goal si rejects disturbances acting on the according output oi k and provides an output signal ui k that is fed to simplex see optimization below .
the ivalue of the controller can be updated on the y by the embedded kalman lter to handle non linear system behavior see controller rebuilding .
the change point detection mechanism can interrupt the controller to deal with invasive changes of the system.
simca will then restart identi cation followed by controller building.
optimization during the second sub phase simca collects all control signals ui k and the system parameters p k and passes these data to the simplex block.
simplex calculates the actuation signal usxthat drives the system towards an output that satis es all adaptation goals.
control signal goal 1measured output planterror 1disturbances controller c1simplexactuation signal control signal n error n controller cnparameters p o1...ono1 ongoal ns1 sne1 enu1 unusxoptimization goal figure operation phase of simca.
generally the simplex method allows to nd an optimal solution to a linear problem written in the standard form maxfctxjax b x 0g wherexrepresents the vector of variables to be determined candbare vectors of known coe cients ais a known matrix of coe cients and tis the matrix transpose .
simca uses a simplex variant with equalities ax b because we do not want simplex to change the e ect of control signals on the output signals.
instead simplex is responsible for seamless translation of control signals to actuation signals.
in simca each equation except the last one represents a goal to be satis ed.
the last equation ensures that the system selects a valid actuation signal by constraining the values that can be taken by elements of the vector x e.g.
x .
the control signals ui k produced during the control phase replace constants b whereas matrix aand vector ct are substituted with the monitored parameters p k of the system.
the goal of simplex is to nd a proper actuation signalusx i.e.
vector x. for details on how simplex solves the system of equations we refer to the linear programming literature .
6p k contains relevant parameters of system components that can be measured.uuv scenario assume that the energy consumption goal is set to se j s. we illustrate how the controller calculate the control signal at time k assuming that the control signal at the previous adaptation step ue and the amount of energy consumed by the uuv at the previous adaptation periodoe j s. by substituting the according values in we get the control signal value ue the controller will send this value to the simplex block.
to illustrate the optimization sub phase we rewrite as a system of equations using the uuv scenario maximizeaccuracy max subject to e1 x1 e2 x2 e5 x5 u1 v1 x1 v2 x2 v5 x5 u2 x1 x2 x5 where xj withj2 is the portion of time in decimals the sensor jshould be used during system operation accjis the accuracy of sensor j ejis the energy consumed by sensorj vjis the scanning speed of sensor j for the concrete values of accj ej vj see table and u1andu2are control signals received from energy consumption controller and scanning speed controller respectively.
as it can be observed from the comparison of and the monitored parameters p k of the system are the sensor energy consumption ejand the scanning speed vjwith the active sensor j. vectorctis replaced with accuracies accjof sensors.
the last equation of ensures that at each time instance during the mission one sensor is working.
the vector xrepresents the portion of time each sensor should be used during system operation.
.
ev aluation of guarantees we start the evaluation of simca by formally analyzing the adaptation guarantees provided by the approach.
.
guaranteed goal achievement the achievement of system goals except the optimization goal is guaranteed by the controllers used in simca.
speci cally by using controllers we can formally prove the following four system properties stability steady state error settling time and overshoot.
stability relates to most software qualities that are subject of adaptation and shows the ability of an adaptation mechanism to achieve goal si.
for example lack of stability for a security goal implies periods with high vulnerability of the system.
if the system has zero steadystate error its goal siis reached after a certain time kand oi k si k k k. kis called settling time and shows the time it takes for an adaptation mechanism to bring measured quality properties close to their goals.
settling time is computed for a step in the setpoint of magnitude one e.g.
demanding the scanning speed to vary from to m s. settling time and steady state error are also related to most software qualities that are subject of adaptation.
for example fast achievement of an energy consumption goal with low settling time means spending less resources in a transient state.
233avoiding overshoot that is the controlled signal does not exceed the goal before reaching its stable area avoids penalties on the respective software quality.
e.g.
an overshoot of system response time may violate a service level agreement.
figure illustrates these system properties.
goalcontrolled variable timetransient state steady state settling timeovershootsteady state error figure properties guaranteed by the controllers the control system used in simca is designed to be stable and avoid overshoots since it has only a single pole and its valuepibelongs to the open interval .
to evaluate the steady state error e and unit step settling time k we recall the output equation .
first we calculate the system output during steady state i.e.
when k!
.
as p2 in this case pk!
.
from oi k!
si pk si based on the steady state error equals e si oi .
theoretically it will take in nite time for oito converge to the exact value of goal si i.e.
to make ezero we need k!
.
however the settling time is formally de ned as the time kin which the measured variable reaches a value very close to the goal usually it has reached a certain percentage of the goal value we denote this value with s i .
based on this oican be replaced with si si where siis the di erence between siands iin percents.
from we get si si si pk i k ln si lnjpij from this equation it can be concluded that the settling time kof every controller cidepends on the pole pi higher values ofpilead to slower output convergence to the goal value.
siis a constant chosen by the system engineer.
according to the common value of sis .
.
as we are using an instance of simplex method with equalities see section .
it will not change the e ect of control signaluion the output signal oi.
hence simplex will not alter the mentioned above guarantees provided by controllers.
.
guaranteed optimality and scalability simplex guarantees the optimization goal of the obtained solution.
the simplex method was proven to always nd an optimal solution if it exists to a linear problem such as the one formulated in section .
.
the scalability of simca is also inherited from simplex.
to understand the scalability of simplex an interested reader may ask about the number of iterations required to solve a problem using this algorithm.
examples shown in require 2m iterations worst case with mthe number of equations.
such cases would require too much computation.
for practical problems the method usually nds a solution in just a few iterations .
the mismatch between theory and practice is not formulated yet although a number of e orts have been conducted incl.
the use of probabilistic models to synthesizeand solve linear programs to calculate the number of required iterations.
additional details are provided in section .
.
guaranteed robustness byrobustness we mean the amount of perturbation the system can withstand while remaining in stable state or the amount of inaccurate estimate in the model the system can tolerate.
robustness directly in uences system reliability.
in line with the formal assessment of basic pbm conclusions about the system robustness can be derived for simca in a similar fashion the value of the pole piallows to trade robustness for settling time k. formally the amount of disturbance the system can withstand d by using a controller presented in section .
can be estimated as follows d pi .
this means that the value of the pole pide nes how simca will react to disturbances.
for pi which is used in most of our experiments the measurement can be inaccurate by a factor of and the controller of simca will still adapt the system to follow the goals.
in general higher values of pilead to better robustness while lower pidecreases the settling time.
.
detection of infeasible solution the simplex method brings an additional guarantee for the adaptation strategy it detects infeasible solutions.
according to the principles of linear programming every linear program including those solved by simca is subject to one of the following has an optimal solution has no feasible solution e.g.
setting the scanning speed of a uuv to m s which is unreachable with any of the sensors has an unbounded optimal solution i.e.
the objective function value seeks1 or which occurs if variable values can grow inde nitely without violating any constraint.
as simca uses only equalities it cannot produce an unbounded solution.
however when the goal is infeasible simca will converge to the nearest achievable value of the according goal and alert the user that the goal is not reachable.
such clear detection of an infeasible solution o er an advantage with respect to the basic pbm approach for which it is unclear if a non zero error appears due to disturbances or due to an unfeasible goal being set for the system.
.
boundaries of guarantees first of all the guarantees are achieved on the model if the system is not capable to identify a su ciently good model then the controller will not be able to achieve its goals and guarantees.
the importance of successful identi cation is one of the main reasons to perform it at runtime in real operating conditions.
however as practice shows even with poor testing of corner cases or transient behavior during identi cation the model is representative enough to provide the guarantees.
second the guarantees on achieving time dependent requirements depend on correct measuring the time and resources spent during identi cation and computing the adjustment of the corresponding goal.
third the guarantees are provided after controllers are built meaning that control theoretical guarantees do not apply during the identi cation and controller synthesis phases.
fourth in the current realization simca cannot provide guarantees when goals are added removed at runtime or when the system behavior architecture is invasively changed.
details on how to obtain this formula can be found in .
.
experimental ev aluation we empirically evaluate simca with two cases.
section .
describes the experimental setting of the uuv case.
section .
shows the software adaptation performed by simca when the goals of the system are changed and in response to variations in the sensor behavior at runtime.
in section .
we show the guarantees provided by simca with the case study.
the scalability of our approach is tested by adding a panel of sensors to the uuv in section .
.
the second case with tele assistance system is described and evaluated in section .
.
in addition we provide a qualitative comparison of simca with the approach presented in in section .
.
finally section .
discusses threats to validity.
the experiments are performed on a dell notebook with .
ghz core i7 processor and gb 1600mhz dd3 ram.
all evaluation material is available at the project website.
.
experimental setting uuv case we use the uuv system described in section as a primary case to evaluate simca.
the system is implemented in a java simulation environment that allows to model and study the behavior of software systems.
the initial parameters of the sensors are speci ed in table .
the actual data that is used by the adaptation mechanism at runtime is subject to a randomly distributed disturbance up to of the expected values simulating uctuations of actual parameters of sensors compared to their speci cation .
adaptation is performed every surface measurements of the uuv system k measurements and a measurement is performed each second.
at each adaptation step the application calculates the average measured value of the i th goal e.g.
energy consumption during the past measurements.
then it calculates the error eias the di erence betweeni th setpoint e.g.
target energy consumption and the measured value of the i th goal.
the application also monitors the accuracy of surface measurements.
the task of simca is to maximize the measurement accuracy by exploiting the available energy and set the scanning speed to examine the required surface in the given time frame.
simca achieves this task by calculating the value of the actuation signal which represents the portion of time each sensor fs1 s5gis used during every adaptation period.
as an indication of the complexity of the data used in the evaluation the total number of sensor con gurations that can be selected in the uuv scenario is .
due to high dynamics and the unpredictable nature of the environment the controller pole piin simca is set to .
which allows to reject errors disturbances of high magnitude.
is kept at a default value max i mini .
the application collects the uuv data to build performance graphs which are used to evaluate simca in the following sections.
the x axis of the graphs are time instants k. thus they axis shows the average values of the measured feature per surface measurements of the uuv system.
.
adaptation results figure shows the adaptation results of simca on the uuv system con gured according to table and requirements set according to uuv scenario section .
adaptation starts with the identi cation phase that is clearly visible when k is between and .
at time k the energy consumption daweaa simplex.htm050100150j s energy consumption meas ured goal error 0123m s scanning speed meas ured goal error sensor usage time fractions s1 s2 s3 s4 s5 300k607590 accuracy opti mal figure uuv adaptation with runtime changes.
setpoint slightly increases based on the energy consumed during identi cation see section .
.
the control synthesis phase followed by the optimization phase starts after the relationship between control signals ui k and system outputs oi k is identi ed from kequals onwards .
the two upper plots in figure show that during operation the system is stable i.e.
the measured energy consumption and scanning speed follow their goals.
at k we change the available energy change from .
to .
mj at k we change the distance to be scanned from to .
km.
the plots show that these changes in requirements lead to corresponding changes in goals and adaptation of the system output.
figure also shows how simca reacts to changes in sensor parameters and sensor failures.
at k the measurement accuracy of sensor s3 drastically decreases from to .
with such a low accuracy s3is not a part of the optimal solution anymore and the system selects a better sensor s4 atk see the sensor usage plot.
at k s4 stops working which again leads to switching the sensors to the optimal solution while the measured energy consumption and scanning speed of the uuv remain on the required level.
at this point the measurement accuracy decreases from to .
it happens because without s4 to satisfy all goals the system is forced to use s5 which has lower accuracy.
the experiment ends at k i.e.
after hours of time.
the total distance scanned is .
km the amount of consumed energy is mj.
over a series of experiments we measured an error of less than .
on these values.
.
adaptation guarantees we now con rm the guarantees formally evaluated in section with the uuv case study.
guaranteed goal achievement.
simca s guarantees for achieving the are con rmed by the data shown on figure 235050100150j s energy consumption energy consumption meas ured goal error 0123m s scanning speed scanning speed meas ured goal error sensor usage sensor usage s1 s2 s3 s4 s5 050100150200k607590 polepi .9accuracy 050100150200k polepi .2accuracy opti mal figure the in uence of controller pole on simca.
the system is stable and converges without overshooting since it is designed to have only a single pole piwhich belongs to the open interval according to the system output equation the output oiduring steady state equals siwhich leads to a zero steady state error e si oi .
the absence of a steady state error can be observed for example on the scanning speed plot when k the settling time kof every controller cidepends on the polepiand a constant sichosen by the system engineer k ln si lnpi.
according to the commonly used value of sis .
.
hence k ln ln adaptation steps.
this means that changing the scanning speed from .
to .
step of amplitude .
would take around k adaptation steps.
this guarantee can be observed on the scanning speed plot of figure when kis between and guaranteed robustness.
the next experiment shows the e ects of the controller pole pion the tradeo between system robustness and settling time.
for this we add a random disturbance of amplitude up to of the expected values to the energy consumption output signal.
figure compares the performance of controllers with pi andpi in such conditions.
as described in section adaptation with simca is in uenced by the values of the pole.
first a smaller pole leads to a shorter settling time.
this effect can be observed when the distance requirement is changed atk .
the system with a smaller pole right plots converges to a new operational goal almost immediately while a system with a higher pole left plots needs adaptation steps to converge.
experimentally we determined that due to0306090120k050100150j s simcaenergy consumption 0306090120k simplex methodenergy consumption meas ured goal error figure simca vs simplex constant disturbance.
fast convergence the total average accuracy of measurements is .
higher for controller with lower pole.
second despite the decrease of the settling time lowering pileads to weaker disturbance rejection.
this property of adaptation mechanism of simca can be observed after k .
the system with pi 2unsuccessfully tries to nd an optimal solution until k .
the system with pi continues working as expected.
hence the system with lower pole is not reliable under disturbances of high magnitude.
another bene t of a high pivalue is less oscillation of sensor usage and a smoother accuracy curve compare according plots on figure .
this means that a higher pole value leads to a system that is less responsive to variations in parameters but at the same switches less between solutions.
in addition to rejecting noise and measurement inaccuracy simca can reject constant disturbances.
e.g.
due to an error a monitor that measures the vehicle energy consumption can constantly decrease the measured value by j s. the plot on the left side of figure shows the behavior in such a scenario.
although monitoring is not working properly simca still adapts the system by de ning proper relationship between control signal ui k and system output oi k .
unlike simca the pure simplex method fails at guaranteeing the control theoretical properties such as disturbance rejection.
hence the simplex method produces an incorrect output see the right plot of figure .
detection of infeasible solution.
figure shows the detection of an infeasible solution.
the energy consumption remains at the required level during the entire experiment.
initially we set the goal distance to be examined to km.
after identi cation k the system functions normally.
atk the total distance to be examined changes to km hence the output scanning speed grows until reaching its maximum feasible value of .
m s atk and the user is 050100150j s energy consumption meas ured goal error 300k0123m s scanning speed meas ured goal error figure detection of infeasible solution in simca.
2360120160j s energy consumption meas ured goal error 067m s scanning speed meas ured goal error sensor combination useds1 s6 s2 s6 s2 s7 s3 s6 s3 s7 s4 s6 300k607590 accuracy opti mal figure simca with sensor combinations.
noti ed about the infeasible solution.
atk we change the distance requirement to an unreachable value of km and the scans start with the minimum possible speed among those sustaining energy consumption at the goal and the user is noti ed of the infeasible goal.
it is worth mentioning that getting an infeasible solution does not necessarily mean that the concrete goal is entirely unreachable.
for example the scanning speed of .
m s can be achieved by using s2ands5.
however the energy consumption goal of j swill be violated in such scenario as both mentioned sensors has lower energy consumption.
hence in case of an infeasible solution the system may inform the user about the contradictory goals set for the system.
.
scalability of simca to demonstrate the scalability of simca we extend the uuv case by signi cantly increasing the number of possible actuation options combinations of sensors .
in particular we consider now an uuv equipped with two sensor panels one on the left side and one on the right side.
each panel is provided with on board sensors that monitor a surface equal to the surface monitored by the single panel in the original case.
the panels simultaneously monitor the respective surface hence a combination of two sensors one from each panel is used at the same time.
the sensors have characteristics similar to those in table .
due to space constraints we refer to the project website for a detailed overview of the parameters of sensor combinations energy consumption scanning speed and accuracy .
the task of simca is to choose among sensor combinations in order to satisfy the following goals r1 the underwater vehicle must examine s 210kmof surface within a period of t hours i.e.
the scanning speed s t .83m s .
r2 the amount of available energy eis limited to .
mj i.e.
mission energy consumption e s 147j s .
note that the scanning speed speci ed for a combination of two sensors is double the value of the vehicle speed as both panels scan surface in parallel.
figure shows results of a scalability scenario with sensor panels working in parallel.
the sensor data as in the previous experiments is subject to random disturbances of small amplitude.
in general the system shows the same adaptation behavior convergence to the goal value adaptation to sensor parameters change etc.
as in the case of a single sensor panel e.g.
the change of goals at k and160switches the sensor combination of the optimal solution.
the sensor combination used plot shows that during operation only of the sensor combinations are used for this scenario.
however note that during identi cation k to other sensor combinations are tested as well.
as simca has the scalability properties of simplex we can conclude that increasing the number of on board sensors will not change the adaptation outcomes.
.
evaluation scenario tas to show the generality of simca we evaluate the approach with a second case the tas exemplar .
tas is a serviceoriented application that provides remote health support to patients.
the main goal of tas is to track a patient s vital parameters in order to adapt the drug or drug doses when needed and take appropriate actions in case of emergency.
to satisfy this goal tas combines three types of services in a work ow shown on figure .
medical servicedrug service alarm serviceincoming requestchange drug trigger alarmchange dosestas output figure tas work ow.
for service based systems such as tas the functionality of each service can be implemented by multiple providers that o er services with di erent quality properties reliability performance and cost.
the system design assumes that these properties can be quanti ed and measured.
e.g.
reliability is measured as a percentage of service failures while performance is measured as the service response time.
at runtime it is possible to pick any of the provided services.
we consider that ve service providers o er the medical service three providers o er the alarm service and only one table properties of all services used in tas.
service namefail.rate resp.time cost time units s1 medical service .
.
s2 medical service .
.
s3 medical service .
.
s4 medical service .
.
s5 medical service .
.
as1 alarm service .
.
as2 alarm service .
.
as3 alarm service .
.
d drug service .
.
requirements min 237051015c costmeas ured goal error 0102030tu response time meas ured goal error medical service invocationss1 s2 s3 s4 s5 alarm service invocationsas1 as2 as3 050100150200250300350400450k00.
.
fail rateopti mal ave rage figure simca on tas scenario.
provider o ers the drug service.
table shows example properties of available services based on data from .
the properties of the whole tas system depend on the choice of concrete service providers that process user requests.
for example invoking s1andas1will lead to the failure rate tas fr s1fr as1fr while invoking ms2 and dwill lead to the failure rate tas fr s2fr dfr the system requirements are the following r1.
the average cost for invoking tas service is set to r2.
the expected average response time is time units r3.
subject to r1 and r2 the failure rate of tas should be minimized.
unlike the uuv case the tas is expected to run continuously.
the requirements r1 r3 and the properties of the services may change at runtime and the system should adapt accordingly.
the adaptation task is to decide for each request with a patient s vital parameters which combination of services to select such that the requirements are satis ed.
the tas case is realized based on the tas exemplar .
the results of simca applied to a tas scenario are shown in figure .
the adaptation works as intended system outputs follow the goal changes at k and the optimal solution is changed when s5 stops responding at k .
as services in tas fail randomly the optimal value of fail rate oscillates.
however on average see the purple line on the fail rate plot it decreases from .
to .
when more resources are available to the application at k .
note that simca manages to keep the failure rate low with a more strict demand of response time from k onwards.the tas case con rms the results obtained with the uuv study.
it supports the generality of the approach by showing that simca is e ective in adapting software systems independent of concrete goals or software components that take part in the adaptation.
.
comparison of simca with amocs recently proposed an interesting approach for automated multi objective control of self adaptive software design amocs in short .
amocs automatically constructs a system of cascaded controllers to deal with multiple goals.
unfortunately no replication package was available to quantitatively compare amocs with simca.
therefore we perform a qualitative comparison based on the reported results.
compared to simca amocs has the advantage that it does not require the extra optimization step with simplex.
furthermore the approach supports two schemes for ordering goals user de ned prioritization of goals and automatic ordering where the controller automatically ranks goals based on available actuators to achieve as many goals as possible.
however simca s formal guarantees go signi cantly beyond these of amocs reported in simca provides guarantees for robustness and steadystate error amocs robustness analysis is systemdependent and unsuitable for an automated control strategy while steady state error is not analyzed.
simplex provides optimal solutions while amocs uses systematic or randomized exploration of solution subspace which introduces an approximation of the optimal solution .
amocs cannot provide guarantees for time dependent goals such as the energy consumption goal in the uuv case because it does not take into account resources spent on learning.
short overshoots are expected in amocs simca can avoid overshoots.
simca also provides important engineering support not covered by amocs simca supports trading settling time with robustness pole placement .
in amocs settling time can just be set based on domain characteristics.
sampling and model learning is automated in simca.
amocs requires specialized knowledge and extra e orts for this e.g.
quasi montecarlo and grid sampling .
amocs requires the number of knobs to be greater than or equal to the number of goals .
finding enough knobs may not be trivial or even be arti cial consider for example the tas case .
in conclusion simca contributes with a novel controlbased approach for satisfying multiple goals that signi cantly improves over amocs both in terms of the guarantees it provides and the engineering support it o ers.
.
threats to validity simca can handle one class of adaptation problems satisfying multiple goals while optimizing one additional goal but this class of problems applies to a signi cant number of 238systems as illustrated with the cases used in this paper and for example also those used in .
supporting other types of adaptation goals is subject of future work.
we used standard controller guarantees.
in section .
we provide an initial mapping of the controller guarantees to software quality guarantees.
however additional research is required both to re ne and extend this mapping and to understand the coverage of the guarantees that can be provided with the standard controller properties.
we did not test the impact of on the model quality guarantees in di erent operating environments this could be a part of future work.
regarding the scope of applicability of simca.
first the approach is not applicable to systems undergoing drastic changes in their behavior at runtime as continuous re identi cation is very costly.
second simca requires that goals can be quantied as a setpoint which may not be easy for all properties an example is security.
third in the experimental setting we have used only some types of disturbances e.g.
sensor failures and noise .
understanding the impact of other disturbance on the adaptation properties of simca requires additional evaluation.
we want to highlight that in the current state of the research in control based software adaptation it is di cult to outline precise criteria that delineate which systems can cannot be supported by simca and other approaches such as amocs .
the study and empirical evaluation of new approaches can contribute to build up this knowledge.
we evaluated simca in two domains focusing on adaption for a typical set of stakeholder requirements resource usage performance reliability cost .
while these systems can be considered as representative instances of a signi cant family of contemporary software systems additional evaluation is required to validate simca for other types of systems.
finally we evaluated simca for simulated systems.
this is inline with the evaluation conducted by others such as .
however further evaluation of simca is required to con rm the evaluation results in real deployed systems.
.
related work the problem of handling multiple goals in self adaptation is obviously not new.
most of the existing research including those in architecture based adaptation and linear programming solve this problem by introducing an optimization task that trades o the con icting qualities looking for an optimal solution.
these solution uses many di erent techniques such as preemption to give preference to more time critical adaptation requirements utility functions to optimize component service selection based on weights of qos criteria estimates of performance models to select services with optimal response time linear programming to deal with di erent operating environments and con icting qos requirements or combine linear programming with local search to nd con gurations with minimum cost and hybrid approaches that rst decompose end to end qos constraints into local qos constraints and then perform local selections.
most of these approaches do not provide the broad set of formal guarantees provided by simca.
furthermore the computational costs of most of the proposed solutions grow exponentially with the size of the problem.
simca can rely on the scalability of simplex as shown in the evaluation.
an advanced example of an architecture based solution is the qosmos framework which also uses the tas exemplar for evaluation.
qosmos employs runtime quantitative veri cation to provide formal guarantees for satisfying multipleqos goals while optimizing cost.
the control theoretical guarantees provided by simca are out of focus in .
however the main di erence is that qosmos requires a set of tools that need to be glued together to realize the feedback loop while with simca the feedback loop is relatively straightforward and derived automatically.
besides another approach that trades o di erent qualities and provides adaptation guarantees is presented in casting a discrete time markov model for reliability requirements to a dynamic system.
the synthesized controller trades reliability for cost by solving an optimization problem.
in compared an initial version of simca with activforms a formally founded architecture based approach for self adaptation.
the evaluation underlines the pros and cons of both approaches in terms of robustness to disturbances and types the guarantees that can be provided.
simplex is a proven and practical optimization method .
several variants have been developed for speci c classes of problems e.g.
.
simplex and its variants do not require an exponentially growing number of iterations when the problem space increases and do not depend on the structure of equations.
today simplex remains a very popular optimization method that is used in a wide variety of domains recent examples are where the method was used to support exploring optimal controller parameters for complex industrial systems and where simplex was used to support the exploration of the large design space of a cyber physical system architecture.
another widespread method to solve optimization tasks is called the interior point method.
the choice of simplex over the interior point method in simca was based on the scope of the problem the interior point method is faster but only for speci c usually very large problems .
compared control theoretical and optimization approaches showing that continuous controller feedback o ers higher potential to meet system goals under constantly changing loads and provides better settling time and less overshooting.
contrary to using either a control theoretical or an optimization approach simca integrates the simplex optimization method with a control theoretic method enhanced version of pbm to endow software systems with the selfadaptive capabilities exploiting the best of both worlds.
.
conclusions in this paper we presented simca a new approach that allows building self adaptive software systems that satisfy multiple goals while reaching optimality with respect to an extra goal.
in addition simca achieves robustness to environmental disturbances and measurement inaccuracy and provides guarantees for the adaptation results.
the e ectiveness of simca was formally evaluated and demonstrated on two cases with strict requirements.
simca contributes towards the application of formal techniques to adapt the behavior of software systems which is one key approach for providing guarantees.
at the same time by automatically building a control mechanism that adapts the software simca does not require a strong mathematical background from a designer which is a key aspect to pave the way for software engineers to use the approach in practice.
in future research we plan to study the impact of on the model and extend simca to handle on the y adding and removing goals.
our long term goal is to study and develop reusable control based adaptation solutions that provide assurances for di erent types of goals.
.