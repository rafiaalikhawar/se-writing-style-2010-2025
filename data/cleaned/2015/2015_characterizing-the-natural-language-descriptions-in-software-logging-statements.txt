characterizing the natural language descriptions in software logging statements pinjia he the chinese university of hong kong hong kong shenzhen research institute the chinese university of hong kong shenzhen china pinjiahe gmail.comzhuangbin chen the chinese university of hong kong hong kong shenzhen research institute the chinese university of hong kong shenzhen china zbchen cse.cuhk.edu.hk shilin he the chinese university of hong kong hong kong shenzhen research institute the chinese university of hong kong shenzhen china slhe cse.cuhk.edu.hkmichael r. lyu the chinese university of hong kong hong kong shenzhen research institute the chinese university of hong kong shenzhen china lyu cse.cuhk.edu.hk abstract loggingisacommonprogrammingpracticeofgreatimportance in modern software development because software logs have been widely used in various software maintenance tasks.
to provide high quality logs developers need to design the description text in loggingstatementscarefully.inappropriatedescriptionswillslow downorevenmisleadthemaintenanceprocess suchaspostmortem analysis.however thereiscurrentlyalackofrigorousguideand specifications on developer logging behaviors which makes the constructionofdescriptiontextinloggingstatementsachallenging problem.
to fill this significant gap in this paper we systematically study what developers log with focus on the usage of natural language descriptions in logging statements.
we obtain valuable findingsbyconductingsourcecodeanalysison10javaprojectsand 7c projects whichcontain28 975locand115 159logging statementsintotal.furthermore ourstudydemonstratesthepotentialofautomateddescriptiontextgenerationforloggingstatements by obtaining up to .
bleu score and .
rouge l scoreusing a simple information retrieval method.
to facilitate future research in this field the datasets have been publicly released.
ccs concepts softwareanditsengineering softwaredevelopmentmethods computing methodologies natural language processing permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september montpellier france association for computing machinery.
acm isbn ... .
logging natural language processing empirical study acm reference format pinjiahe zhuangbinchen shilinhe andmichaelr.lyu.
.characterizingthe naturallanguage descriptionsinsoftware loggingstatements.
inproceedings of the 33rd acm ieee international conference on automated software engineering ase september montpellier france.acm montpellier france 12pages.
introduction loggingisacommonprogrammingpracticeofpracticalimportance formodernsoftwaredevelopers.developersmainlyconductloggingbywritingloggingstatements e.g.
printf logging.info and insertingtheminto thecodesnippets.asin house debuggingtools e.g.
debugger alltoooften areinapplicableinproductionsettings softwarelogshavebecometheprincipalsourceofinformation when diagnosing a problem.
specifically software logs have been usedinvariousreliabilityenhancementtasks includinganomaly detection fault diagnosis program verification performance monitoring etc.
the performance of thesetaskshighlydependsonthequalityofthecollectedlogs.thus formodernsoftwaredevelopmentandmaintenance appropriate logging statements are of great importance.
typically aloggingstatementcontainsdescriptiontextandvariables.
real world examples of logging statements can be found infig.
.descriptiontextdescribesthespecificsystemoperation inruntime whichisthemainfocusofthispaper whilevariables record necessary system status e.g.
ip address .
elaborate description text can accelerate reliability enhancement tasks by providing better understanding of the system runtime information.
on the contrary immaturedescriptiontext e.g.
outdatedtext slowsdown the log analysis process or may even mislead the developers .
however loggingisnoteasybecauseofthefollowingreasons.
first there iscurrentlyalack ofrigorousspecificationon logging authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france pinjia he zhuangbin chen shilin he and michael r. lyu practice.
for example fu et al.
find that even in a leading software company like microsoft it is difficult to find rigorous i.e.
thoroughandcomplete specificationsfordeveloperstoguidetheir logging behaviors.
moreover with the popularity of source code sharingplatforms e.g.
github modernsoftwaremayconsistof componentswrittenbymultipledevelopersallovertheworld.this further increases the difficulty for a developer to align with the project logging style.
this problem is compounded by the fact that logging statements update frequently in modern software development e.g.
hundreds of new logging statements every month .althoughtherearesomeexistingloggingframeworks e.g.
microsoft suls andapache slog4net developersstillneed tomaketheirownloggingdecisions .thus wheretologand what to log have become crucial but challenging problems.
recently cinqueetal.
summarizeempiricalrulesregarding logging placement.
zhu et al.
propose logadvisor which recommends whether developers should write a logging statement in a code snippet or not.
they focus on the where to log problem while do not consider what to log .
yuan et al.
develop logenhancer atoolthatcanenhanceloggingstatementsbyadding informativevariables.however theirmethodfocusesonexisting statements and does not consider the description text.
tofillinthissignificantgapof whattolog weconductthefirst empiricalstudyonthecontextofloggingstatements withfocus ontheirnaturallanguagedescriptions.specifically wecollect10 apachejavaprojectsand7c projects whichcontain28 loc and logging statements in total.
we first study the purpose of logging by manually inspecting logging statements and their surrounding code snippets.
then we study the repetitiveusageofcertainn grams i.e.
asequenceof ntokens which wecalln grampatterns inthenaturallanguagedescriptions.for simplicity in the following we use logging descriptions to represent the natural language description text in logging statements.
in particular could we generate the logging descriptions based on historicallogsusingn gramlanguagemodel ?areloggingdescriptions locally repetitive e.g.
in a source file ?
moreover based onthemanualinspectionexperienceandquantitativeevaluation wefurtherstudythepossibilityofautomatedloggingdescription generation.
in particular is it potentially feasible to implement alogging description suggestion tool to assist developers in deter mining what to log?
by answering the above questions throughsystematic analysis this investigation helps to characterize thecurrent usage of logging descriptions and serves as the first step towards automated logging description generation.
the results of our study show that there are generally three categories of logging descriptions including description for program operation .
description for error condition .
and description for high level code semantics .
finding .
besides compared with common english the repetitiveness in loggingdescriptions can be better captured by statistical language models.
finding2 .however then grampatternsindifferentprojectsvary alot finding whichiscausedbythelocalness oflogging descriptions.
in particular the n gram patterns in logging descriptions are endemic to one source file or frequently used in a fewsourcefiles findings .inaddition weevaluatethepotential feasibility to automatically generate logging descriptions based on historical logs.
the high bleu score and rouge score implythatautomatedloggingdescriptiongenerationisfeasibleand deserves more future exploration finding .
in summary our paper makes the following contributions thispaperconductsthefirstempiricalstudyontheusage ofnatural languagein loggingpractice byan evaluationof java projects and c projects.
it summarizes three categories of logging descriptions inlogging statements including description for program operation descriptionforerrorcondition anddescriptionfor high level code semantics covering all the scenarios observed in our study.
wedemonstratetherepetitivenessinloggingdescriptions globally i.e.
in a project and locally i.e.
in a source file and further present the potential feasibility of automated logging description generation.
the datasets studiedhave been publicly released allowingeasyusebypractitionersandresearchersforfuturestudy.
theremainderofthispaperisorganizedasfollows.section 2explainsthemethodologyinourstudy.section 3summarizeslogging descriptionsintodifferentcategories.section 4characterizesthe natural language descriptions by quantitative analysis.
based on theevaluationresults thepotentialfeasibilityofautomatedloggingdescriptiongenerationisassessedinsection .wediscusspotential directions to improve logging in section .
section 7introduces related work.
finally we conclude this paper in section .
study methodology inthispaper westudytheloggingstatementsof10javaprojects and7c projects whichcontain28 975locand115 159loggingstatementsintotal.inparticular thejavaprojectsarecollected from apache project list with more than committers while thec projectsarewidely usedsoftwarewithmorethan1 000stars on github.
table1presents the details of these open source projects.
these projects are of great variety ranging from distributed system database enterpriseservicebus sdk toide.
description presentsabrief introduction of the project.
versionshows the date of the last committothemasterbranchintherepositorywhenwedownloadedtheproject source code.
locindicates thecorresponding project sline ofcode.
of logging statements isthenumberofloggingstatements in the project.
of logging descriptions is the number of logging statements that have natural language descriptions.
tokens in logs counts the total tokens extracted from the logging descriptions while distinct tokens counts the distinct tokens.
wecanobservethatamajorityoftheloggingstatementscontain logging descriptions.
in particular .
of the logging statements in activemq have logging descriptions while the average per centage of all projects is .
.
thus we can find that logging descriptions are important and widely adopted by developers.
the lengths of the logging descriptions in all of the projects are illustratedinfig.
.inthispaper bylength wemeanthenumber oftokensinaloggingdescription.thelengthsofmorethan90 of theloggingdescriptionsareinrange .differentfromother textinsoftwareengineering suchascodeordocumentation the lengthofloggingdescriptionisshorter.thus weexpectdifferent characteristicsofthenaturallanguageusedinloggingdescriptions.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
characterizing the natural language descriptions in software logging statements ase september montpellier france table java and c project details.
of logging of logging description version statements descriptions total distinct activemq message broker .9k .8k .6k .
ambari hadoop monitor 798k 5k .7k .
brooklyn distributed system manager .5k .5k .6k .
camel integration framework .8m .7k .8k .
cloudstack cloud computing software .8k 12k .8k .
hadoop distributed computing platform .9m .9k .0k .
hbase distributed database 957k .3k .6k .
hive data warehouse .5m .3k .9k .
ignite distributed database .6m .6k .5k .
synapse enterprise service bus .3k .1k .1k .
of logging of logging description version statements descriptions total distinct azure sdk azure tools for visual studio .1m .
corert .net core runtime .6k .
corefx .net core foundational lib.
.6m .5k .7k .
mono .net framework .5m .1k .9k .
monodevelop cross platform ide .2m .6k .0k .
orleans distributed virtual actor model .6k .
sharpdevelop cross platform ide .5k .1k .1k .
190tokens in logs c project loctokens in logsjava project loc number of tokens0.
.
.
.
.
.
.2number of logging descriptions 1e4 distribution of logging statements of logging statements .
.
.
.
.
cumulative distribution of logging descriptions .
.
figure1 distributionsofthelengthofloggingdescriptions.
theseprojectsaresupposedtohavegoodloggingpractice especially appropriate logging descriptions for the following two reasons.
first these projects are maintained by developers fromlarge organizations or companies which provide important softwaresolutionspoweringmodernitindustry.forexample hadoop is used by a large amount of companies to process large scale data.
second theseprojectshavebeenservingusersgloballyforalong time and thus their logging statements have fulfilled the use of daily development and maintenance.
we characterize the logging descriptions by both manual inspection and these evaluation metrics.
to study the purpose of logging descriptions we first randomly sample a subset of logging descriptionsandtheircorrespondingcodesnippets.aftermanually exploring these samples in detail we categorize logging descrip tions into groups.
then to further study the characteristics ofthem we evaluate the global and local repetitiveness in loggingtable categories from sampled logging descriptions.
samples completed .
current .
next .
exception .
value check .
variable .
function .
branch .
categories program opeartion of samples error message semantic description37.
.
.
descriptions by the evaluation metrics proposed in previous empirical studies on source code .
in all the experiments using evaluationmetrics weregardtheloggingdescriptionsasplaintext and study them from the natural language perspective.
categories of logging descriptions tocharacterizetheusageofnaturallanguageinloggingdescriptions thefirststepistounderstandthepurposeofthesedescriptions.
thus in this section we manually inspect the logging descriptions and summarize them into different categories.
since the total number of logging descriptions is large it is prohibitivetomanuallyinspectalltheloggingdescriptionsandanalyze the corresponding code snippets.
thus we randomly sample a subsetofloggingdescriptionstogetherwiththecorrespondingcode snippets from all the projects in table .
similar to existing studies wecalculatethenumberofsamplesbystandardtechniques .specifically thenumberofsamplesisdeterminedbyadesired margin of error confidence level and the data size.
there are totally logging descriptions in our study.
thus we determine authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france pinjia he zhuangbin chen shilin he and michael r. lyu example function description public void forget xid xid throws xaexception log.debug forget xid ... example completed operation final lbmonitor monitorobj lbmonitor .get netscalerservice nsmonitorname monitorobj.set respcode null lbmonitor .delete netscalerservice monitorobj s logger .info successfully deleted monitor nsmonitorname example next operation log.info close consumer on a clienta.close example exception try count c.readandprocess catch interruptedexception ieo log.info thread.currentthread .getname readandprocess caught interruptedexception ieo throw ieo example value check if jobid null s logger .error unable to get a jobid return null example variable description string messageid string element.get jmsmessageid log.debug messageid messageid example current operation while nm.getservicestate !
state.stopped waitcount !
log.info waiting for nm to stop.. thread.sleep example branch description if blobitem instanceof cloudblockblobwrapper blobitem instanceof cloudpageblobwrapper log.debug found blob as a directory using this file under it to infer its properties blobitem.geturi ... figure real world examples of logging statements.
the sample size as after setting margin of error and confidence.
to figure out the purpose of logging descriptions we assign eachloggingstatementanditssurroundingcodesnippettothree researcherswith6years programmingexperienceinaverage.each researcher labels the category of the logging description after manual analysis.
then we compare the labels returned by different researchers.
if all the labels for a logging description are the same weregarditasthefinallabel.otherwise theresearchersre visit thecasetogetherandproducethefinallabelafterdiscussion.table 2shows the details of the categories and the number of samples in each category.
in particular we summarize main categories underwhichtherearetotally8mutuallyexclusivesubcategories.
inaddition weprovideaselectedexamplefromthestudiedproject foreachsubcategoryinfigure .thedetailsofthesecategoriesare introducedasfollows.inthisstudy westartwith7subcategories based on previous experience and preliminary inspection on the logging statements.
afterexploring all the 383samples we find a newsubcategory i.e.
branchdescription andfinallysummarize with subcategories in this paper.
category1 programoperation.
loggingdescriptionsinthis categorysummarizethedetailedactionsorintentionsofthesurrounding program.
based on the position of the described programstatements this category can be further divided into three subcategories including completed operation current operation and next operation.inparticular a completed operation loggingdescription concludes the behavior of program statements preceding a logging statement.
this kind of logging statements are often placed at the end of a function block scope.
example shows a completed operation that deletes a monitor successfully.
in current operation developerslogthecurrentstatusofaprogramtotracetheprogress of an action.
typical usage of such description is in a whileloop or aforloop asillustratedinexample2.comparedwithaforementioned two types next operation is more widely utilized to forecast the following behaviors of a program which often indicates thestart of some operations.
in example developers log the next operationofclosingtheconsumeronclienta.inourstudy more than of samples belong to the program operation category.
category error message.
it is a common practice for developers to log the error message for maintenance.
in this category loggingdescriptions mainlypresent theoccurrenceor thebehindreasonsofanerror exception.therearetwotypesofloggingdescriptioninthiscategory exception andvalue check.
exception uses thetry catch blockandtheloggingdescriptionisoftenwrittenin thecatchclause.
some error related keywords e.g.
failed error exception arefrequentlyemployedandoftenindicateafailedexecution in the try block.
example is a representative example.
value check logging descriptions explain errors without explicitly employingthe try catch block.instead an if statement isusually applied tocheck thevalue of avariable incurrentprogram orthe returnvalueof aspecificfunction.for instance example5shows the value checking of a variable against null.
other values such as false emptyarealsowidelycheckedandthecorrespondingerror messages are then logged.
most samples around in our study are categorized into the error message category.
category3 semanticdescription.
inthiscategory thereare three subcategories of logging descriptions according to the object they describe i.e.
variable description function description and branch description .
in particular variable description records the value of a pivotal variable during execution.
as shown in example thedetailedvalueofmessageidislogged.
function description is widelyutilizedtodepictthefunctionalityandusage ofafunction anditsarguments.generally function description isplacedatthe beginningofafunctionbody asillustratedinexample7.
branch description describesthesemanticmeaningofabranch path.different from program operation and error message branch description is mainly used in if elseblocks to indicate the execution path in software runtime.
example presents a logging description that capturesthesemanticmeaningofthisbranch.
.
ofourstudied samples are in the semantic description category.
finding there are three main categories of logging descriptions i.e.
descriptionforprogramoperation description for error condition and description for high level codesemantics.
language patterns of logging descriptions in thissection we try toanswer the followingresearch questions rq1 is there any repetitiveness in logging descriptions?
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
characterizing the natural language descriptions in software logging statements ase september montpellier france rq2 can the repetitiveness be captured by cross project n gram models?
rq3 are there any n grams in logging descriptions appearing in only one source file?
rq4 are n grams in logging descriptions locally specific to a few source files?
by answering these research questions with quantitative analysis of the open source projects we aim to facilitate better understanding of the current logging description usage by developers.
in addition the answers to these questions demonstrate the potential of automated logging description generation.
.
rq1 is there any repetitiveness in logging descriptions?
therepetitivenessofn gramsincommonenglishhasalreadybeen successfully used in various tasks such asspeechr ecognition machine translation and code completion.
thus it would be of great interest to explore whether logging descriptions are also repetitive andpredictable forpotential applications e.g.
automateddescription generation .
to answer this question in this section we try tousen gramlanguagemodelstopredictthenexttokeninalogging description.
intuitively if there is observable repetitiveness in logging descriptions the models should have decent prediction performance.inthefollowing wefirstintroducethen gramlanguage model and the evaluation metric.
after that we analyze the experimental results and summarize with a finding.
n gramlanguagemodel.
languagemodelsarestatisticalmodelsthatpredicttheprobabilityofsequencesofwords.n grammodelsassumea markov property i.e.
theprobabilityofatokenonly dependsonthepreceding n 1tokens.forexample for4 grammodels theprobability pofatokeniscalculatedbasedonthefrequency counting of the previous tokens as the following p a4 a1a2a3 count a1a2a3a4 count a1a2a3 .
ifthereisobservablerepetitivenessinloggingdescriptions anngrammodelmshouldbeabletolearntheprobabilitydistributions of n grams from a corpus.
in practice the n gram model often encounters some unseen n grams during prediction.
this makesthe probability pm ai a1...ai .
smoothing is a technique that can handle such cases and assign reasonable probability tothe unseen n grams.
in this paper we use modified kneser ney smoothing which is a standard smoothing technique and can give good results for software corpora .
evaluationmetric cross entropy.
weuse10 foldcrossvalidation where of the logging descriptions are the training data and the remaining are the testing data.
to evaluate the performanceofthen grammodels weuse cross entropy whichisdefined as follows hm s nn summationdisplay i 1logpm ai a1...ai hmis the cross entropy of the n gram model m sis a logging description of length nands a1...an andpmis the probability that the next token is aigiven the preceding token sequencetable english corpora.
version total distinct brown gutenberg 253tokens english corpus lines a1...ai .
a good model has low cross entropy for logging descriptions.forexample ifamodelcancorrectlypredictallthetokensinaloggingdescription theprobability pm ai a1...ai willbe1for alltokens ai andhencethecross entropywillbe0.wecalculatethe cross entropy for projects in table .
specifically for each project we calculate the cross entropy for every logging description using equ.2and use their average as the cross entropy for the project.
results.
thecross entropyresultsofjavaandc projectsare demonstrated by the boxplots in fig.
.
in this experiment we evaluatetheprojectswithmorethan1 000loggingdescriptions.to figureoutthepotentialdifferencesbetweenloggingdescriptions andcommonenglish wealsocalculatethecross entropyof twocommon english corpora which is demonstrated by the singlelines in fig.
.
the details of these two corpora are illustrated in table3.by repetitivenessofnaturallanguageinloggingdescriptionsandincommon english.
we analyze each project separately boxplots while we analyze the two english corpora as a whole a line .
we can observe that both the single lines and boxplots have similartrends.thesinglelinesstartat11for1 grammodelsand traildowntoabout8.5for8 grammodels.thismeansthatforboth loggingdescriptionsandcommonenglish usingmorepreceding tokens i.e.
larger n can lead to more accurate results.
besides accordingtothefigures cross entropysaturatesaround3 or4 grams.
thus or gram models are the best choice for the investigated projectsconsideringthetrade offbetweencross entropyandmodel complexity.
in addition compared with common english the cross entropy oftheloggingdescriptionsisgenerallysmaller whichmeansthe tokens in logging descriptions are easier to predict.
this phenomenonismoreobviousforloggingdescriptionsinjavaprojects.we think this is mainly because all the java projects are collected from apacheprojectlist whichsharesimilarloggingstyles.theobservable repetitiveness in logging descriptions is encouraging and it is promisingtoutilizetherepetitivenessforautomatedlogginginthe future.
finding compared with common english the repetitiveness of logging descriptions can be better captured by statisticallanguage models.
.
rq2 can the repetitiveness be captured by cross project n gram models?
inthissection wefurtherstudytherepetitiven grampatternsin loggingdescriptions.specifically doesrepetitivenessexistacross different projects or does it lie in individual projects locally?
toanswer this question we conduct the cross project experiments.for each java project we train a gram model based on of the project logging descriptions.
then we use the model to predict authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france pinjia he zhuangbin chen shilin he and michael r. lyu order of n grams3456789101112cross entropy with fold cross validation english cross entropy java projects cross entropy a java projects order of n grams3456789101112cross entropy with fold cross validation english cross entropy c sharp projects cross entropy b c projects figure cross entropy of natural language descriptions in logging statements.
tokens in the remaining of the logging descriptions and the logging descriptions of all other java projects.
we chose 3gram models because they do not require too much memory while achievingdecentperformance.wemainlyfocusonjavaprojects becausetheyareallapachejavaprojectswhichmaysharemore cross project similarities than c projects.
theresultsareshowninfig.
.thex axislistsalltheprojects that are used to train the n gram models.
the single line illustrates the cross entropy of the models on the remaining logging descriptions in project whiletheboxplotshowsthecross entropy of the models on all other projects cross project .
we can observe that the cross project cross entropy is clearly larger than the in project cross entropy.
this indicates that the repetitive n grampatterns in different projects are quite different and thus the ngram patterns can hardly be captured by cross project models.
the in projectcross entropyofprojectsynapseisverylowbecauseit contains many identical logging descriptions.
finding n gram models trained on other projects cannot capture repetitive n gram patterns well indicating that then gram patterns in different projects vary a lot.hadoopcloudstackcamel hbase synapse activemq ambari brooklynignite hive corpus projects3456789101112cross entropy with fold cross validation in project cross projects figure4 cross projectcross entropyversusin projectcrossentropy of the java projects.
table percentage of the endemic n grams.
lang.
freq.
gram gram gram gram .
.
.
.
java log .
.
.
.
.
.
.
.
java code .
.
.
.
.
.
.
.
c log .
.
.
.
.
.
.
.
c code .
.
.
.
.
rq3 are there any n grams in logging descriptionsappearinginonlyonesource file?
resultsintheprevioussectionindicatethatn grampatternstendto appearlocallyinsidetheproject.tofurtherstudytherepetitiveness inlocalcontext inthefollowing weexplorewhethersomen grams in logging descriptions can be found in only one source file.
these n grams are called endemic n grams.
table 4demonstrates the percentageofendemicn gramsinthestudiedprojects.forexample if the logging descriptions of a project have grams and of themcanonlybefoundinonesourcefile thepercentageofendemic2 gramsis20 .wecanobservethat28.
gramsinjavalogging descriptions and .
grams in c logging descriptions are endemic.
the percentage rapidly increases for settings with longer n grams becauseitismoredifficulttospotidenticallongern grams indifferentsourcefiles.inaddition amongtheendemicn grams .
endemic grams and .
endemic grams are found morethanonceinjavaprojects.forc projects thepercentagesare evenlarger.theseendemic butlocallyrepeatingn gramsfurther demonstrate the local repetitiveness in source file level.
besidesloggingdescriptions wealsocalculatethepercentageof n grams from all code statements that only appears in one source authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
characterizing the natural language descriptions in software logging statements ase september montpellier france file.
as illustrated in table the percentages of the endemic ngrams in logging descriptions are generally larger than that in source code which indicates that logging descriptions are more locally endemic than source code.
as reported by a previous paper localnesscannotbefoundincommonenglish soweregardit asaspecialfeature ofthenaturallanguageinloggingstatements.
we think this feature can be utilized to improve the automated logging method.
for example we can improve the performance of language models with a cache mechanism similar to that proposed in .
finding logging descriptions are locally endemic.
a number of n grams are repetitively used in the logging descriptions inonly one source file.
.
rq4 are n grams in logging descriptions locally specific to a few source files?
we have studied the endemic n grams that only appear in one source file.
in this section we further explore whether the nonendemic n grams in logging descriptions also favor a specific locality.bydefinition eachnon endemicn gramcanbefoundinasetof filesf and thus there is a discrete probability distribution pforf.
forexample ifann gramisuniformlydistributed theneachfilein fcontains the same number of this n grams.
we hypothesize that if the non endemic n grams favor specific locality the distribution pwill be skewed.
for example an n gram which is found in source files appears times in one source file and once in the remaining source files.
inspired by we use locality entropy hl which is defined as follows to measure the skewness of the distribution of an n gram inf.
hl summationdisplay f fp f log2p f wherep f is defined as follows p f count n gram inf count n gram inproject notefis a source file that contains the non endemic n gram projectisthecollectionofallthesourcefilesinaproject and count calculates the number of n grams.
intuitively the more skewed thedistribution thelowertheentropy.forexample ifann gram is found only in the logging descriptions of one source file the entropy will be the lowest i.e.
.
on the contrary if an n gram is uniformlydistributedintheloggingdescriptionsofsourcefiles f the entropy will be the highest.
thus the lower the entropy the more the logging descriptions are locally specific.
the entropy of both java and c projects is shown in fig.
.
the x axis is the number of files that contain the non endemic n gram.wecanobservethatalmostallnon endemicn gramshavelowerentropythanuniformdistribution whichdemonstratestheir locallyspecificproperty.besides then gramwithvaryingorders which are marked by different colors share similar trends.
we can also observe that some grams have much lower entropy than the others.this isbecausesomecommon tokensareintensively used intheloggingdescriptionsofafile.forexample inprojecthive token writing isfoundintheloggingdescriptionsin169source files i.e.
f which is non endemic.
while token writing number of files log scale 12345678910java projects locality entropyuniform gram gram gram gram a java projects number of files log scale 123456789c projects locality entropyuniform gram gram gram gram b c projects figure5 entropyofthefiledistributionsfornon endemicn grams.
uniform denotes that the n grams are distributeduniformly in the files.
onlyappearsonceinmostofthesesourcefiles itappears366times inonesourcefile becauseloggingdescription exception writing tointernalframebuffer isrepetitivelyusedfor366timeslocallyin that file.
finding logging descriptions are locally specific.
the non endemicn gramsarerepetitivelyusedinafewsourcefiles.
automated logging description generation basedontheexperimentalresultsinsection 3and4 itisvaluableto explorewhetheritispossibletoautomaticallygeneratethelogging description for a logging statement.
if shown possible such an automated toolwill beof greathelp fordevelopers becauseit can greatlyacceleratethedevelopmentprocessandpotentiallyimprovethequalityoftheirloggingdescriptions.inthissection wepropose a simple but effective automated logging description generation method in order to demonstrate the potential feasibility of logging automation.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france pinjia he zhuangbin chen shilin he and michael r. lyu .
methodology our method is based on an assumption similar code snippets tend to contain similar logging descriptions.
this assumption is triggered by the results and findings in previous sections.
in particular as explained in section all categories of logging descriptions are used to describe certain code statements thus the logging descriptions should be closely related to the corresponding code snippets.
additionally in section the locality experiments demonstrate that similar n gram patterns are repetitively used in a local context sourcefile level wherecodeprovidingsimilarfunctionalities gathers.basedonthisassumption weproposeasimpleinformation retrieval basedmethod.
inparticular to generatethe logging descriptionforaloggingstatement weextractitscorresponding codesnippet andsearchforthemostsimilarcodesnippetinthe corpus i.e.
existing code .
then we use the logging description in the searched code snippet as the description for current logging statement.
the similarity is measured by levenshtein distance which regards a code snippet as a string and calculate the distance usingcharacter basededitdistance.forexample thelevenshtein distance between public boolean createfile and public booleannewfile is5 becauseweneed5substitutions i.e.
change cr to n and ate to w to make them identical.
in this experiment for each project we use fold cross validation.
specifically we first extract the code lo pairs from the training data.
considering the code snippet we study two code ranges pre 10andsur where pre 10indicates the lines of codeprecedingtheloggingstatementand sur 20indicatesthe10 lines of code preceding and succeeding the logging statement.
we generatetheloggingdescriptionforeachcodesnippetinthetestingdatabysearchingthemostsimilarcodesnippetinthetrainingdata.
.
evaluation metrics .
.
bleu.
to measure the accuracy of automated logging description generation we use bleu a popular evaluation metricusedintextsummarizationandmachinetranslationtasks .weusebleubecauseit canmeasurethesimilarity betweenthecandidateandthereference.inourexperiments the logging description generated by our method is regarded as the candidate while the original logging description written by the developerisregardedasthereference.specifically bleuiscalculated as follows bleu bp exp n summationdisplay n 1wnlogpn wherebpisabrevitypenaltythatpenalizesoverlyshortcandidates nisthemaximumnumberofgramsusedintheexperiments pn is themodified n gram precision and wnis theweight of each pn.
bleu 1meansthebleuscoreconsideringonlythe1 gramsinthe calculation where w1 1andw2 w3 w4 .specifically bp is calculated as follows bp 1i f c r e r c ifc r whereristhelengthofthereference cisthelengthofthecandidate.
the modified n gram precision is defined as follows pn n grams appear in the reference n grams in the candidate fromthedefinitionofbleu weknowthatthehigherthebleu thebettertheloggingstatementgenerationperformance.therange of bleu is which is often presented as a percentage value i.e.
.
thus if none of the n grams in the candidate appear inthereference bleuscoreis0.inthecontrary ifthecandidate is exactly the same as the reference bleu score is .
.
.
rouge.
bleu measures how many n grams in the generated logging statement appear in the reference which enjoys similarsense as precision .
comparedwith bleu rouge is like recall whichmeasureshowmanyn gramsinthereference appear in the generated logging statement.
specifically rouge is defined as follows rouge n summationtext s ref summationtext ram n scountmatch ramn summationtext s ref summationtext ram n scount ramn wherenrepresentsthelengthofthen gram ramn sisareference refisthesetofallreferences countmatch ramn isthemaximum numberofn gramsco occurringinthecandidateandthereference andcount ramn isthenumberofn gramsinthereference.inour experiments wecalculaterouge 1torouge androuge l. rouge l does not require a predefined n gram length.
instead it measures the longest matching sequence of words using lcs longest common subsequence .
similar to bleu the range of rouge is which is often presented as a percentage value i.e.
.
.
results the bleu scores and the rouge scores are shown in table .w e run the experiments on java projects and projects which are selectedbasedonthenumberofloggingdescriptions.wecanobservethatthebleu 1scoresonalltheevaluatedprojectsarelarger than and the bleu score on corefx is .
which means that .
of the tokens in the generated logging descriptions can be found in the ground truth.
the bleu scores gradually decrease asthen gramsbecomelonger.forexample thebleu 1scoreon hadooppre 10is36.
whilethecorrespondingbleu 4scoreis .
.thisisreasonablebecausebleu 4scoreconsidersthematch of consecutive tokens.
besides the bleu scores and rougescores for java projects hadoop cloudstack camel hbase and hive andc mono corefx monodevelop aresimilar whichshow that the effectiveness of our approach is robust against different programming languages.
inaddition previouslyweexpecttoobtainlargerbleuscores androugescoreswithsur 20thanwithpre sinceweconsider more code statements in the information retrieval process.
we are surprised to observe that the bleu scores and rouge scores with pre are better in most cases.
after manual inspection of thecorresponding code snippets we think it is caused by two mainreasons.
first considering the succeeding lines of code may bringinsomenoises whichmisleadthemethod.recallthemanual categorizationintable wecanobservethatonly17.
ofthe loggingdescriptionsareusedtoexplainthesucceedingprogram authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
characterizing the natural language descriptions in software logging statements ase september montpellier france table log generation results.
code scope avg l pre .
.
.
.
.
.
.
.
.
sur .
.
.
.
.
.
.
.
.52pre .
.
.
.
.
.
.
.
.97sur .
.
.
.
.
.
.
.
.43pre .
.
.
.
.
.
.
.
.53sur .
.
.
.
.
.
.
.
.79pre .
.
.
.
.
.
.
.
.76sur .
.
.
.
.
.
.
.
.69pre .
.
.
.
.
.
.
.
.41sur .
.
.
.
.
.
.
.
.12pre .
.
.
.
.
.
.
.
.69sur .
.
.
.
.
.
.
.
.66pre .
.
.
.
.
.
.
.
.17sur .
.
.
.
.
.
.
.
.86pre .
.
.
.
.
.
.
.
.95sur .
.
.
.
.
.
.
.
.05rougedataset hadoop cloudstack camel hive mono corefx monodevelopbleu hbase operation.second inthissection weproposeasimpleinformation retrieval method based on levenshtein distance which gives equal weightstotheeditdistancesofallthetokens.however inpractice sometokensorstatementsaremoreimportantinthiscontext.thus the performance of our model is affected.
this paper presents the first step towards automated logging description generation and thus there is no existing baseline method tocomparewith.however insoftwareengineering somesimilar tasksalsogeneratenaturallanguagetextusingcorrespondingcode snippets suchascodesummarization whichaimstogeneratealine oftexttosummarizeacodesnippet.thebleu 4scoresreported in the state of the art code summarization papers range from .
to .
.
meanwhile the bleu scores of our simpleinformationretrieval basedmethodrangefrom16.
to49.
withthe pre setting whichisencouraging.notethatwedonot intendtodirectlycomparetheperformanceofmethodsfordifferent tasks.
however we want to provide an intuitiveunderstanding of thebleuscoresandrougescoresweachieve.furthermore we visionplentyofspaceforimprovementbyadoptingmoremature models or specialized feature engineering.
however this is not the focus of this paper so we leave it as our future work.
finding a simple information retrieval based method which generates logging descriptions by finding similar code snippets can achieve decent performance in terms of bleu score and rouge score.
future directions this paper aims to study the usage of natural language in logging practiceandfurthertriggerfollow upresearchworkinthisfield.
in thissection we presentsome potential directionsbased on our study of software logs.
improved information retrieval models.
to this end we use a simple character similarity based method to find suitable naturallanguagedescriptionsforloggingstatements whichdemonstrates decent performance.
however it has obvious limitations.
for example as a reviewer mentioned a method being called at differentprogramlocationscanhavedifferentloggingdescriptions whichcannotbeaddressedbythismodel.thereareseveralavenues for extension.
first as explained in very large bodies of code can be readily parsed typed scoped and even subject to simple semanticanalysis.thus allthesedatacouldbeusedtodevelopa more sophisticated approach to search similar code snippets.
besides codeclonedetection isaclassicaltopicthathas been widely studied in software engineering area.
based on the results of our automated logging generation experiments we believe it is promising to adapt code clone detection methods to further improve the generation performance.
loggingstatementgenerationfromcode.
althoughthepotentialofinformationretrieval basedloggingdescriptiongeneration has been validated in the experiments the model has some limitations.
in particular it assumes thatthe current code snippet can be described by an existing logging description.
however new projectsoftencontainonlyafewloggingstatements whichmay maketheproposedmodelineffective.thisisalsoatypicalproblem knownas coldstart inthefieldofinformationretrieval.thus it will be of great help if we can generate the logging descriptions based on the corresponding code snippets.
we vision it is feasi ble because logging descriptions are mainly used to explain the surroundingcodes.toachievethisgoal existingworkoncodesummarization code comment generation and commit message generation are good starting points.
data augmentation.
compared with most nlp natural language processing applications in software engineering such ascode completion the data volume of what to log is not large.
as illustrated in table the largest java project in our experiments i.e.
hadoop contains1.9mlocbutonly13.9klogging statements.
the relatively small data volume could stay in the way oftheapplicationofdeeplearning basedalgorithms which dominates many difficult research problems in recent years.
we think what to log is such a difficult problem because researchers need to understand the semantic meaning of the corresponding codesnippets.thus effectivedataaugmentationtechniques which aim at the generation of more training data is in high demand.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france pinjia he zhuangbin chen shilin he and michael r. lyu the basic idea of data augmentation for what to log is to generate more code lo pairs using existing data.
for example a simple data augmentation method is to change the identifier names in a code snippet and keep the original log which leads to a new code lo pair.
towards this end researchers could start withdata augmentationmethods inimage processingfield which have been widely studied.
related work .
log analysis softwarelogscontainawealthofruntimeinformation andthus have been widely used in various software reliability enhancement tasks includinganomalydetection faultdiagnosis program verification performance monitoring etc.
most of these tasks use data mining models to extract criticalruntimeinformationfromalargevolumeofsoftwarelogs.to facilitate log analysis researchers also focus on related log data preprocessing topics including log collection and log parsing .
these existing papers study how to utilize logs printed by existing logging statements in software.
instead in this paper wefocus on the designof logging statements andthus can potentially benefit these log analysis tasks.
.
logging practice currentresearchhasmostlyfocusedontheusageoflogsprinted byexistingloggingstatements butlittleonloggingitself.recently some empirical studies have been conducted to characterize logging practice.
specifically yuan et al.
study the logging practice of open source software and furtherproposeproactiveloggingstrategy.
characterizethe loggingpracticeofjavaprojects.consideringloggingpracticein industry fuetal.
conductanempiricalstudyonthelogging practice of software used in microsoft.
pecchia et al.
study the logging practice in a critical software development process.
all thesestudiesprovideinsightfulfindingsonloggingpractice which shedlightsintoourstudyofthenaturallanguagedescriptionsin software logs.
.
improving logging towards improving logging practice there are two categories of work wheretolog and whattolog .
wheretolog studies focus on strategic logging which recommends developers the suitable logging places.
specifically cinque et al.
propose a logging method based on a set of rules about logging placement which makes the logs able to detect more software failures.
zhu et al.
design a tool logadvisorthat informs developers whether they should place a logging statement in a code snippet or not.different from these methods we focus on the contents of thelogging statements which is the goal of what to log research work instead of logging placement.
yuan et al.
propose a tool logenhancer that can enhance existing logging statements by augmentingimportantvariables.lietal.
designaregression model to recommend the log level in a logging statement.
our paperalsotargetsonimprovingthe whattolog partoflogging practice.
different from we focus on the natural language descriptionsinloggingstatements.besides wepresentasimplebuteffective description generation tool.
thus we believe our study can complement existing logging improving work.
.
nlp in software engineering naturallanguagewidelyexistsinsoftwareartifacts suchasdesign documents user manuals bug reports source code comments and identifiernames .inrecentyears varioustechniqueshavebeen proposedbyresearcherstoanalyzenaturallanguagetextforthe improvementofmodernsoftwareengineering.gabelandsu study the syntactic redundancy of source code which reveals a general lack of uniqueness in software.
hindle et al.
study the naturalness of software showing that repetitive and predictableregularities of source code can be captured by a simple n gramlanguage model.
tu et al.
further explore the localness characteristicsofsoftware.thesethreestudiesregardsourcecodeas natural language text and study the related characteristics of them.
inspiredbythesestudies inthispaper westudythecharacteristics of natural language in logging statements.
additionally nlp methods have been adapted to many software engineering scenarios including defect prediction code completion program synthesis api recommendation identifier method name suggestion etc.
different from these papers we study what tolog withthefocusonthenaturallanguagedescriptionsinloggingstatements.webelievethisstudypavesthepathforthedesign of nlp techniques for the what to log problem.
conclusion to facilitate software development and maintenance developers are expected to provide informative and appropriate logging descriptions.
however there is currently a lack of investigations and specificationsonstudyingsuchdescriptionsinloggingpractice.tofillthissignificantgap thispaperpresentsanempiricalstudyontheloggingstatementsin10javaprojectsand7c projects withfocus onwhat to log.
we summarize with valuable findings ranging fromtheloggingdescription scategories thegloballyandlocally repetitiveusageofn grampatterns toanencouragingindication towards automated logging description generation.
in addition some valuable directions for improving current logging practice are discussed.
in summary this paper systematically characterizes thenatural languagedescriptions usedinlogging practice which serves as the first work towards automated logging description generation.
with our datasets released we hope to trigger relatedresearch projects and push this field forward.
acknowledgment the authors thank the anonymous reviewers for their feedback which helped improve this paper.
the work described in this paper was fully supported by the national natural science foundation of china projectnos.61332010and61472338 theresearchgrants council ofthe hong kong special administrative region china no.cuhk14234416ofthegeneralresearchfund thenational basic research program of china project no.
2014cb347701 and microsoft research asia microsoft research asia collaborative research award .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
characterizing the natural language descriptions in software logging statements ase september montpellier france