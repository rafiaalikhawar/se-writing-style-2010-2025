cascade a universal programmer assisted type qualifier inference tool mohsen vakilian amarin phaosawasdi michael d. ernstx ralph e. johnson university of illinois at urbana champaign urbana il usa fmvakili2 phaosaw2 rjohnson g illinois.edu xuniversity of washington seattle wa usa mernst cs.washington.edu abstract type qualifier inference tools usually operate in batch mode and assume that the program must not be changed except to add the type qualifiers.
in practice programs must be changed to make them type correct and programmers must understand them.
c ascade is an interactive type qualifier inference tool that is easy to implement and universal i.e.
it can work for any type qualifier system for which a checker is implemented .
it shows that qualifier inference can achieve better results by involving programmers rather than relying solely on automation.
i. i ntroduction atype qualifier system or just qualifier system augments an existing type system with type qualifiers to check more properties.
a type qualifier or just qualifier is an annotation that the programmer adds to declarations and uses of types.
researchers have developed many qualifier systems to check software properties such as concurrency ownership immutability safety against null dereferences and security .
java supports the syntactic features required by qualifier systems .
the benefits of a qualifier system such as safety guarantees and machine checkable documentation come at the cost of adding the qualifiers to code.
the burden of annotating code with qualifiers is a major obstacle to the adoption of qualifier systems.
realizing the burden of adding qualifiers researchers have developed myriad qualifier inference tools .
these tools employ static analysis dynamic analysis or a combination of the two.
existing qualifier inference tools operate in batch mode.
that is they take the source code as input analyze it and insert all the qualifiers at once.
while batch qualifier inference tools can add qualifiers to large pieces of code without involving the programmer these tools have several weaknesses.
first they are imprecise because inferring precise qualifiers requires knowledge of programmer intent and of the run time behavior of the program e.g.
application invariants aliasing and interprocedural control and data flow for all possible inputs.
second they are rigid .
that is they assume that the code does not have to be changed while usually programmers have to refactor the code to a form that the qualifier system canexpress .
third they are unpredictable because they add many qualifiers to the code and it is difficult for the programmer to tell why a particular code change was applied.
fourth they are specific to a single qualifier checker.
while frameworks such as the checker framework reduce the cost of developing a checker developing a qualifier inference tool is still a nontrivial engineering task.
this paper introduces cascade auniversal and easy touse tool for inferring type qualifiers.
cascade takes a typechecker for a qualifier system as input and uses it to assist the programmer in inferring the qualifiers.
type inference and refactoring changing code without changing the program s behavior are usually thought of as unrelated concepts.
however we consider qualifier inference a refactoring because inserting qualifiers in a program does not alter the behavior of the program.
in addition qualifier inference often goes beyond inserting qualifiers and requires code refactorings.
cascade was inspired by our work on compositional refactoring .
in the compositional paradigm a refactoring tool designer decomposes a refactoring into a set of primitive changes and automates them.
following the compositional paradigm cascade decomposes qualifier inference into primitive changes.
each primitive change resolves one or more of the errors reported by the qualifier checker.
another inspiration for cascade is speculative analysis which is a technique that assists programmers in decision making by presenting the consequences of their actions ahead of time.
speculative analysis improves programmers productivity by showing potential future versions of the program and helping programmers avoid undesirable versions and unnecessary backtracking.
cascade is an interactive tool that assists programmers in adding qualifiers by guiding them through a tree of changes and error messages.
it repeatedly runs the qualifier checker on variants of the source code to compute a tree of error and change nodes.
the error nodes correspond to the error messages that the qualifier checker reports and the change nodes correspond to potential code changes that resolve the type qualifier inference usually refers to only inserting type qualifiers in a piece of code.
however programmers often need to make other nontrivial code changes to use the type qualifiers appropriately.
therefore we take a broader point of view.
we consider type qualifier inference to encompass any code change that is required to take full advantage of a type qualifier system.
ieee acm 37th ieee international conference on software engineering .
ieee ieee acm 37th ieee international conference on software engineering .
ieee ieee acm 37th ieee international conference on software engineering .
ieee ieee acm 37th ieee international conference on software engineering .
ieee error messages.
a programmer can expand the tree to explore the effects of the changes on the errors before applying the changes.
expanding an error node shows its children which are the changes that resolve the error.
expanding a change node shows its children which are the new errors that the change introduces.
figure shows a c ascade tree.
the compositional aspect of cascade is computing the change to fix each error message.
the speculative aspect of cascade is computing the effect of each change on the error messages reported by the qualifier checker and the required follow up changes.
an advantage of cascade s design is that it is easy to implement.
this makes it easy to port c ascade to different programming environments.
we conducted a lab study with programmers to compare cascade with julia .julia is the state of the art static analysis tool for inferring nullness qualifiers.
the study participants finished the task faster with cascade and inserted better qualifiers.
the participants also felt more in control with cascade and said that they are more likely to use cascade in the future.
this paper makes the following research contributions it introduces cascade which is the first universal usable and easy to implement tool that assists programmers in inferring type qualifiers.
cascade is open source and publicly available .
it compares cascade aprogrammer assisted qualifier inference tool with julia a state of the art batch qualifier inference tool through a user study.
ii.
t ype qualifiers type qualifiers are light weight specifications that augment an existing type system to enable static verification of desired properties of software.
a qualifier system provides a set of qualifiers and a set of rules to check the use of the qualifiers.
for example one can add the qualifier nonnull to the type of a string variable s written in java as nonnull string s to indicate that the variable scannot be null .
a nullness qualifier checker would ensure that the annotations are accurate and that only nonnull