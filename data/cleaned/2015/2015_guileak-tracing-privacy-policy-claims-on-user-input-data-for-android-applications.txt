guileak tracing privacy policy claims on user input data for android applications xiaoyin wang xue qin university of texas at san antonio xiaoyin.wang xue.qin utsa.edumitra bokaei hosseini rocky slavin university of texas at san antonio mitra.bokaeihosseini rocky.slavin utsa.edu travis d. breaux carnegie mellon university breaux cs.cmu.edujianwei niu university of texas at san antonio jianwei.niu utsa.edu abstract the android mobile platform supports billions of devices across more than countries around the world.
this popularity coupled with user data collection by android apps has made privacy protection a well known challenge in the android ecosystem.
in practice app producers provide privacy policies disclosing what information is collected and processed by the app.
however it is difficult to trace such claims to the corresponding app code to verify whether the implementation is consistent with the policy.
existing approaches for privacy policy alignment focus on information directly accessedthrough the android platform e.g.
location and device id but are unable to handle user input a major source of private information.
in this paper we propose a novel approach that automatically detects privacy leaks of user entered data for a given android app and determines whether such leakage may violate the app s privacy policy claims.
for evaluation we applied our approach to popular apps from three privacy relevant app categories finance health and dating.
the results show that our approach was able to detect strong violations and weak violations from the studied apps.
ccs concepts software and its engineering software verification and validation keywords mobile privacy policy android application user input acm reference format xiaoyin wang xue qin mitra bokaei hosseini rocky slavin travis d. breaux and jianwei niu.
.
guileak tracing privacy policy claims on user input data for android applications.
in proceedings of icse 40th international conference on software engineering gothenburg sweden may june icse pages.
.
.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
icse gothenburg sweden acm.
.
.
.
.
.
.
introduction mobile applications apps are becoming increasingly pervasive.
by june the google play store surpassed three million apps and the android platform held of the smartphone os market share .
among these apps some categories of apps can be particularly privacy sensitive.
in health apps were downloaded by of mobile phone users .
such apps collect information on body measurements diet exercise and medical treatment among others.
similarly of the personal finance app mint s million users pay their balances every month through the app .
with ease of access to personal information and the large scale of mobile app deployment developers need better tools to help protect user privacy.
google encourages app developers to provide users with privacy policies however innovation and competition among mobile app developers can introduce inconsistencies between the application code and privacy policies.
unlike security threats where malicious developers hoard personal data the privacy threat motivating our work is the developer who unintentionally collects personal data without informing the policy author or where the software changes over time to yield and outdated policy.
prior work by slavin et al.
and zimmeck et al.
traced privacy policy statements about the collection of platform information to application program interface api calls using static programanalysis.
these api calls concern personal information that is automatically collected from the device such as user location device identifiers contact information and sensor data.
this prior workis limited because it does not account for personal data that users provide directly through an app s graphical user interface gui .
figure shows an example where sensitive data is provided to the app via the interface and is thus disconnected from any api call.
in figure the user manually enters the steps they have taken usinga text field.
there are many ways both static and dynamic to render the field and link the information provided through the field to program level data types.
furthermore the field itself may not have tight constraints on the input values making it difficult to determine the information type.
these unaddressed gui related challenges further widen the gap between privacy policies and app based data practices.
to bridge this gap we identified two new technical challenges that we address in this paper tc1 vague and unbounded information types for user input data.
the information types automatically collected through acm ieee 40th international conference on software engineering authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden xiaoyin wang xue qin mitra bokaei hosseini rocky slavin t ravis d. breaux and jianwei niu platform api methods are constrained to what is collectible by hardware commonly shared across mobile devices.
this constraint limits the terminological space to only a few general category names e.g.
location voice camera .
in contrast developers can design novel user interfaces that ask users to provide potentially any kind of information which includes unstructured and semi structured personal information in different formats and language types.
tc2 varying gui implementation techniques.
unlike platform api method calls that can be detected by scanning the app byte code user interfaces can be implemented using static declarations in resource files or programmatically in the code.
techniques such as supor and uipicker can be used to identify input views gui views accepting user inputs receiving sensitive user input but they do not map these views to relevant policy terms nor do they identify programmatically generated input views.
in this paper we present a novel technique to detect privacypolicy violations on user provided information for android apps.
the approach maps each input view to policy terminology through an ontology and then performs static information flow analysisto detect information flows that violate relevant policy statements.
to address tc1 for each input view in a new app we use phrase similarity measurements to map gui labels together with its context to ontology concepts.
the ontology is then matched to the policy text.
to address tc2 we developed a gui analysis technique to estimate the structure of programmatically generated guis and collect all gui labels in the context of a given input view.
our analysis is based on ga tor an existing gui analysis framework for android.
to validate our approach we focus on three app categories in the google play store health finance and dating.
these three categories are important because they can require access to sensi tive personal information.
furthermore the first two domains are regulated by the health insurance portability and accountability ac hipaa and gramm leach bliley ac glba respectively.
in our experiment we collected of the most popular apps and their privacy policies apps for each category setting aside of the apps for training.
using the privacy policies from the training apps we constructed an ontology for each of the three domains.
we then applied our approach to the remaining apps and detected violations which we manually confirmed by recording the runtime network requests with the xposed framework .
the contributions are as follows.
we developed a novel gui analysis approach to detect inconsistencies between the app s code collection behavior of user input data and collection statements in mobile app privacy policies.
using crowd sourcing tools we developed domain specific privacy ontologies for three privacy sensitive domains health finance and dating.
we experimentally evaluated the approach on most popular apps in the health finance and dating and detected strong violations and weak violations.
this paper is organized as follows section presents motivation and an example section describes our framework and approach section describes the evaluation with the discussion in section section includes related work and we conclude with future workin section .
figure screenshots from pacer motiv ating example in this section we demonstrate the difficulties of understanding input views due to their varying implementations.
linearlayout android gravity center horizontak ... cc.pacer.androidapp.ui.common.fonts.typefacetextview ... android id id title ... cc.pacer.androidapp.ui.common.fonts.typefacededittext ... android id id et content ... linearlayout ... button ... android id id btnleft ... android text string btn cancel ... linearlayout linearlayout listing partial code from common input dialog.xml 1const v2 0x7f07011a 2invoke virtual v1 v2 lcom afollestad materialdialogs materialdialog builder title i lcom afollestad materialdialogs materialdialog builder 3move result object v1 listing virtual invoke example in goalsetcheckinginreqdialog.smali linearlayout android gravity center horizontak ... cc.pacer.androidapp.ui.common.fonts.typefacetextview ... 3android text string goal set requirements ... listing partial code from goal create details fragment.xml dynamic layouts.
alayout in the android framework defines the visual structure of the gui including locations for views buttons windows and widgets.
layouts are defined in two ways either using xml to define the placements of elements or they are created programmatically at runtime.
the latter is necessary when layouts need to be dynamically changed based on runtime states.
these dynamic layouts eliminate the need to pre draw multiple guis.
these two methods can be combined flexibly.
for example a label or view can be programmatically added to a statically defined layout typically after inflation .
the example in figure shows two gui screenshots from pacer a popular fitness app depicting the gui when a user creates a new authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
guileak t racing privacy policy claims on user input data for android applicationsicse may june gothenburg sweden exercise goal.
besides editing goal descriptions and changing goal types such as steps and diet the user also needs to set the check in requirement by clicking the button in the red oval on the leftscreenshot.
the right screenshot shows the pop up window that appears after clicking this button.
here users will be asked to type in the desired number of check in steps.
the right screenshot utilizes a combination of both static and dynamic layouts.
listing shows the static definition of the rightscreenshot which is a layout template defining the basic layout structure and the font style information.
all the labels and ids are vaguely defined e.g.
dialog title is undefined and et content is used as the view id of the input box .
thus this layout template can be used in multiple places in the project for user input and the labels e.g.
set check in requirements for title will be transferred from the parent activity e.g.
the activity in the left screenshot when the dialog is opened.
listing shows the smali code decoded android bytecode in inputdialogfragment.smali which dynamically adds the label for set check in requirement .
the string is fetched at line 1a sv2 with the id 0x7f07011a .
here the id