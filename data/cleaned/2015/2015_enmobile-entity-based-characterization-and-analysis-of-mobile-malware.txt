enmobile entity based characterization and analysis of mobile malware wei yang university of illinois at urbana champaign weiyang3 illinois.edumukul r. prasad fujitsu laboratories of america sunnyvale california mukul us.fujitsu.comtao xie university of illinois at urbana champaign taoxie illinois.edu abstract modernmobilemalwaretendtoconducttheirmaliciousexploits throughsophisticatedpatternsofinteractionsthatinvolvemultiple entities e.g.
the mobile platform human users and network locations.suchmalwareoftenevadethedetectionbyexistingapproaches due to their limited expressiveness and accuracy in characterizing and detecting these malware.
to address these issues in this paper we recognize entities in the environment of an app the app sinteractionswithsuchentities andtheprovenanceofthese interactions i.e.
theintentandownershipofeachinteraction asthe keytocomprehensivelycharacterizingmodernmobileapps and mobilemalwareinparticular.withthisinsight weproposeanovel approach named enmobile including a new entity based characterization of mobile app behaviors and corresponding static analyses toaccuratelycharacterizeanapp sinteractionswithentities.we implement enmobileand provide apractical application ofenmobile in a signature based scheme for detecting mobile malware.
we evaluate enmobile on a set of apps consisting of malware fromgenomeanddrebinalongwithbenignappsfromgoogleplay.
ourresultsshowthatenmobiledetectsmalwarewithsubstantially higherprecisionandrecallthanfourstate of the artapproaches namely apposcopy drebin mudflow and appcontext.
ccs concepts programreasoning programanalysis systemssecurity mobile security acm reference format wei yang mukul r. prasad and tao xie.
.
enmobile entity based characterization and analysis of mobile malware .
in icse icse 40th international conference on software engineering may june gothenburg sweden.
acm newyork ny usa 11pages.
.
.
this author was an intern at fujitsu labs.
of america for part of this work.
thisworkwassupportedinpartbynationalsciencefoundationundergrantsno.
ccf cns cns1564274.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe firstpage.copyrights forcomponentsof thisworkowned byothersthan the author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspecificpermission and or a fee.
request permissions from permissions acm.org.
icse may june gothenburg sweden copyright held by the owner author s .
publication rights licensed to the association for computing machinery.
acm isbn ... .
introduction the explosive growth in mobile devices and mobile applications or apps has spurred the growth of mobile malware.
a case in point is the number of unique android malware samples which increasedfrom10.7millionsamplesin2015tomorethan19.2million indecember2016 .malwaredetectionbasedonbehaviorsisa prominent class of malware detection approaches where characteristics of known malware samples are used as a basis of identifying new malware .
these approaches typically work in two phases malicious behavior characterization and malicious behavior detection.
thebehavior characterization phase creates a specification of the malicious behaviors in the form of manually specified malware signatures or as automatically minedmalwaremodels inasuitablerepresentation.inthebehaviordetection phase techniques based on static or dynamic program analysisareusedtoanalyzeagivenmobileappforpossiblematches against the specified signatures or mined models.
limitationsofexistingapproaches.
existing malware detectionapproaches sufferfrom the overfitting problem these approaches are tailored to detect onlythe malware samples used for deriving the signatures or models.thetwomainreasonsarethe limitedexpressiveness andlimited accuracy of these approaches.
limited expressiveness.
the existing approaches primarily use information leakingdataflows withintheappasthebasisofamaliciousbehavior.however theexistingapproachestypicallyfailto capturemalicious behaviorsinitiatedandcontrolled bymalicious servers such as initiating spams or launching denial of service attacks.intheseexploits the intentisnotinformationleakage.further a key indicator of the malicious intent in these cases is the controlof the malicious interactions by an external server.
without a proper characterization for these key aspects the existing approaches turn to easily mutable features shared across malware samples of the same family such as network addresses or other string constants to detect these behaviors allowing malware developers to easily change these features to evade detection.
limited accuracy.
the existing approaches fail to recognize and expressend to end interactions between a malware sample and entities in its environment.
instead they characterize segments ofthese interactions using implementation specific structures e.g.
api methods objects asend points.
forexample consider asample of the gingermaster malware with the following four phase malicious behavior the app retrieves and preprocesses a phone number from the telephony manager entity a the app writes the preprocessed phone number into a temporary file entity b the app reads the preprocessed phone number from the same acm ieee 40th international conference on software engineering authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june gothenburg sweden wei yang mukul r. prasad and tao xie temporary file entity b the app sends the preprocessed phone number to a malicious server entity c .
a typical malware signature based on the existing approaches would characterize this behavior as four interactions.
further the existing approaches see the app interacting with somejava fileobject in phases and withoutrecognizingthatsuch fileobjectisthe samefilewritten to and later read from.
therefore theexistingapproachescanproducefalsepositivesby matching the preceding behavior with that of a benign app where thepreprocessedphonenumberissavedtoafile andnon sensitive informationreadfroma differentfileissenttoaserver.inaddition thegingermaster malwarefamilyhassevenvariations i.e.
differentimplementations duringtheperiodof2011 .these variations can either skip phases and by directly sending the preprocessed phone number to the malicious server or replace the temporary file entity in phases and to be a temporary database.
thus theexistingapproachescanalsoproducefalsenegativesby making their malware signature very specific to phases .
toaddresstheselimitationsoftheexistingapproaches inthis paper wepresentanovelapproach enmobile.theenmobileapproachismotivatedbythefinding thatmorethan90 of currentmobilemalwarehaveacommand and control c c archi tecture wherethemalwarereceiveandrespondtocommandsfrom anexternalactor e.g.
aremoteserver.thus enmobileisbuiltto directly characterize the underlying c c structure of the malware.
in particular enmobile improves the existing malware behavior characterization in three main aspects.
entity basedcharacterization.
ratherthanusingimplementationspecific structures e.g.
api methods objects or easily mutable featuresinanapp enmobileexpressestheapp sbehaviorsinterms ofinteractionsamong entities.entitiesareahostofactorsonthe mobileplatformincludingmobilesystemcomponents e.g.
thetelephonymanager smsmanager contacts provider localon device resources e.g.
files databases othermobileappsandlibraries humanusers andnetworklocations etc.enmobilerecognizesentities throughtheiridentities.forexample fileswithdifferentnamesare different entities.
furthermore introducing theconceptofentity allowssecurity analyststoexpressanentityinteractioninan end to end fashion makingitmuchmoreindependentofspecificrealizationsofthat interaction e.g.
specificsofphases2and3in gingermaster and hencemorerobust.forexample forthe gingermaster malwarefamily securityanalystscansimplyspecifytheend to endinformationflowfromthetelephonymanager entity a tothemaliciousserver entityc without enumerating all possible intermediate point entities e.g.
files databases .
flow provenance predicates.
going beyond using informationleakingdataflowswithintheapp enmobileenrichesinteractions among entities with provenance information.
provenance in our contextrefersto whocontrolstheflow and why i.e.
thespecific intended purpose of the flow .
for example the existing approaches may produce an information flow file squiggleright sendtextmessage .suchflowcanmatchboththebehaviorofsending contents of a file out through sms a benign action of sending predefined messages and the behavior of specifying which phone numbersthatthesmsshouldbesentto amaliciousactionofsending premium messages .
to distinguish such scenarios we proposeasetofdataflowpredicates section4.
.
toreflecttheintended purposeofaninformationflow e.g.
passingconfigurationparametersvs.purelytransmittinginformationtoanotherentity andaset of controlflow predicates section .
.
tospecify theownership of information flows i.e.
the entity that initiates or controls the information flow.
identification of entities and entity