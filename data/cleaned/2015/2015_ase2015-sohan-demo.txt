spyrest in action an automated restful api documentation tool s m sohan craig anslow and frank maurer department of computer science university of calgary calgary alberta t2n 1n4 email smsohan craig.anslow frank.maurer ucalgary.ca abstract restful apis are often manually documented.
as a result the process of maintaining the documentation of restful apis is both expensive and error prone.
in this demonstration paper we present spyrest as an automated software as a service tool that can be used to document restful apis.
spyrest leverages an http proxy server to intercept real api calls to automatically collect and generate restful api documentation by processing http traffic involved in api calls.
spyrest provides an automated yet customizable example based documentation solution for restful apis.
restful api developers can use spyrest to automatically generate and maintain updated api documentation.
keywords restful api w eb api documentation automation example based documentation i. i ntroduction fielding introduced restful apis as a versatile mechanism for connecting internet based applications .
for example a hotel web site may use the google maps api to provide driving directions to the hotel.
restful api developers need to provide and maintain api documentations when releasing the apis so that the apis can be used.
maintaining api documentation manually is less efficient and often less reliable than automated documentation .
automated solutions exist for documentation of local apis within the context of classes and methods.
for example javadoc can automatically generate the documentation for java apis.
for restful apis instead of classes and objects the context of apis are defined by api endpoints resources actions and example api calls in terms of the http headers request and response payload formats .
the existing tools for documenting local apis do not natively support the different context for restful apis and cannot be readily used to document restful apis.
in this paper we present spyrest which provides the necessary tool support to address the unique needs for restful api documentation.
to this regard in the next section we have discussed the design goals followed by a http proxy server based prototype implementation to demonstrate an automated restful api documentation tool.
we then present two use cases to show how api developers can use spyrest to automatically generate and maintain restful api documentation.
in the discussion we compare spyrest against other tools.
we provide an analysis of how the requirements for spyrest are derived in the related work section.ii.
s pyrest a. design spyrest is a web based software as a service tool1 .
the design goals of spyrest is to provide an automated technology agnostic and example driven solution for documenting restful apis so that spyrest can be used a reusable tool to document multiple restful apis .
to autogenerate documentation for restful apis spyrest relies on http traffic information captured while example api calls are made using a http proxy.
the high level process can be described as a three step process api developers make example api calls using a http proxy server the http proxy server captures the http headers request and response data the collected data is synthesized and presented on a web application.
the proxy server used in spyrest is a specialized server for restful api documentation.
a typical http proxy server can intercept and record the http traffic for example api calls but further processing is required to generate a usable restful api documentation out of the raw http data.
for example api reference documentations need to be version aware so that the documentation can clearly refer to the relevant api versions.
to provide human readable descriptions to the example api calls relevant information needs to be captured in addition to the raw http traffic.
post processing is required to generate the structure of request and response payloads by parsing and consolidating raw http data from multiple example api calls since the optional fields may not be obvious when looked at individual example calls.
to generate usable documentation spyrest automatically parses the captured http request and response data and presents summary tables showing the structure for http query parameters headers request and response data.
for each field spyrest displays the name of the field example values and automatically inferred data type information such as integer date time boolean and string.
to reduce verbosity from large api responses spyrest automatically strips large responses to only show representative samples from repeated values in arrays.
spyrest does not capture and strip off any authorization headers used in the example api calls to prevent confidential information from being part of the documentation.
by using an http proxy server spyrest enables the documentation of different restful apis independent of the 30th ieee acm international conference on automated software engineering .
ieee fig.
spyrest design implementation technology behind the apis.
spyrest can be used both as a software as a service tool or as a self hosted tool when isolation is desired.
spyrest is released as an open source product and for self hosted solutions it can be customized to fit unique requirements.
the web interface of spyrest provides a hierarchical navigation for restful api documentation as follows each api host has one or more api versions each api version has one or more resources each api resource has one or more api actions each api action may have a structure of http query parameters headers request and response payloads as well as many api examples each api example may have http query parameters headers request and response payloads.
the web interface also provides a wiki like editor to allow api developers to override auto generated api documentation.
on each page the web interface includes collaboration features so that api developers can discuss questions and collect feedback about specific api documentation pages.
for each api example spyrest generates a curl command that can be run to execute the api examples without writing any code.
b. implementation spyrest is composed of three main components as shown in fig.
.
the spy component is the customized http proxy server.
this component is written using nodejs.
the spy has internal logic to decode http request url and headers and auto detect api versions for the commonly used version identifier patterns.
table i shows examples of auto detected versions from accept http header and urls.
table i examples of auto detected versions type example v alue detected version accept header application vnd.ex.ca.v3 json v3 accept header application vnd.ex.ca.v3.
json v3.
url v2 x v2 url v2.
x v2.
url v2.
pre users v2.
pre the spy also parses the url to auto detect the api resources api actions and query parameters for the example api calls.
for example given an example api call made to get the spy automatically detects the api resource as repositories the api action asget repositories and a query parameter since with an example value of .
even though the auto detected api version resource and actions cover the commonly observed patterns api developers can override the auto detections of any of these fields by using custom spy specific http headers when making the example api calls.
the http headersx spy rest version x spy rest resource andx spy rest action can be used to override autodetection of these respective fields.
additionally api developers can use x spy rest desc header to attach human readable descriptions for each api example so that the web interface can tag the examples against meaningful descriptions.
the web app component is implemented using ruby on rails.
to allow restful api developers to edit auto generated documentation the web app uses the markdown syntax.
to facilitate collaboration across all the api documentation pages the web app uses disqus a popular third party collaboration service for commenting.
the spy writes the captured and synthesized api example data into a mongodb database .
the web app reads and saves custom edits on the same database.
all three spyrest components are released as docker containers.
docker is a lightweight virtualization solution that can either be hosted in house or using many of the popular cloud hosting providers.
the public instance of spyrest has been tested with the three components in three separate docker containers running on a single linux server with 512mb memory core processor and 20gb disk space.
iii.
u secases in this section we describe two different use cases from the perspective of initially generating a restful api documentation for the first time and maintaining the documentation as the api evolves over time.
a. initial api documentation when releasing a restful api api designers need to publish the api documentation so that other developers can use the apis.
for demonstration consider generating documentation for the get notifications list your notifications api that is exposed by github2.
using this api a developer can paginate through the list of all public repositories within github.
this api action takes an optional parameter since that can be used to specify a time filter.
to manually generate documentation for the get notifications api a developer needs to follow these steps s1 make example authenticated api calls to get notifications s2 record the http headers with request and response data s3 remove duplicate information s4 remove authentication information s5 format and stylize the reduced information s6 add custom content s7 organize multiple formatted documents together on a web site with list your notifications a api documentation summary section b api documentation examples section fig.
spyrest screen shots showing auto generated api documentation navigation and s8 publish the documentation website.
steps s1 s7 need to be repeated for each of the api endpoints.
since these steps are manually performed there is also a room for human errors in the aforementioned steps.
spyrest aims to minimize the potential for human errors by automating steps s2 s5 and s7 s8.
to use spyrest for auto generating documentation of an api a developer only needs to make the example api calls via the spy proxy server with custom http headers for human readable descriptions for the api example.
custom edits to the auto generated documentation may be made by using the markdown editor.
fig shows a partial screen shot of spyrest generated documentation for this api given four example api calls.
spyrest fully automates the steps s2 s5 and s7 s8 as follows s2 the spy proxy server records the http traffic s3 the spy automatically strips off repeated items from the arrays in the response body s4 the spy does not save any authorization header s5 the web app renders the documentation for all apis following a consistent look and feel s7 the web app providesbreadcrumbs for hierarchical navigation of the api objects and s8 the recorded data is automatically published by the web app in real time.
the api developers only need to focus on finding good example api calls for s1 and describing the complex rules about apis that are not otherwise derivable from looking at the request and response data alone for s7.
in addition to automating the restful api documentation process spyrest also displays a curl command for each recorded api example so that developers can try the api examples without having to write any code.
using in page collaboration developers can discuss api related questions and find past conversation all in one place.
in this specific example we see the official documentation of get notifications provided by github was outdated and missing several fields e.g.
subscription url repository.releases url repository.labels url repository.notifications url and more that are automatically documented by spyrest.
api developers can also customize the auto generated summary information using a wiki like editor on spyrest.
this allows api developers to explain behaviors that cannot be derived from analyzing the individual example api calls.
for example 815listing example api call using spyrest 1class github include ht tparty base uri https api .
github .c o m headers accept application vnd.
github .v3 json user agent curl .
.
content type application json authorization t o k e n github api token host port spyrest .c o m http proxy host port 15end describe no tifications do it list all notifications for the current user where they are participating since a time do response github.
get notifications?all true participating true since 1t z assert equal response .
code end 25end users can edit the table of query parameters to explain any parameter that is not used in the example api calls or explain validation rules such as required interdependent fields about the query parameters.
b. maintaining api documentation for evolving apis maintenance of restful api documentation is another use case of interest since the documentation for restful apis need to evolve with the apis to reflect the updated information.
the steps mentioned previously need to be repeated every time any of the api objects changes when a manual process is followed.
since apis continue to evolve throughout their lifetime manually maintaining their documentation incurs further costs or documentation can quickly become outdated.
spyrest automatically updates the recorded information for each example api call so rerunning the api examples automatically updates the auto generated documentation.
to uniquely identify each example api call the spy computes a digital signature of each example api call based on its api version resource url and custom description.
to replay the example api calls api developers can use automated scripts so that once an api example is scripted it can be run repeatedly.
moreover the automated scripts can be written as functional tests where the generation of api documentation becomes a side benefit of running the tests.
running the automated scripts to exercise the api examples frequently can prevent out of date api documentation as shown on the previous use case.
listing shows an example script written using the ruby based test framework minitest.
in this example script on line the class github is setup so that the spy proxy server is used to make example api calls.
httparty used on line 3is a third party library for making restful api calls.
then the required headers are setup for using github api on line .
finally we setup the proxy connection to spyrest server.
then on lines we define an example api call as an automated test script to generate documentation for the get notifications api action with three query parameters all participating andsince .
the results of the api call can be used to test against expected results.
using this script spyrest will generate the documentation for this api and auto update the documentation by rerunning the script anytime the api changes while still providing test coverage.
if custom edits are made to the summary section of the spyrest generated documentation then a re run of the same api example will only update the example section of the documentation with new data leaving the summary section unchanged.
thus the custom edited content sustains over multiple runs of the api examples.
iv .
d iscussion with spyrest we have aimed to provide a solution to restful api documentation.
a manual approach is both expensive and susceptible to human errors.
spyrest offers several benefits over existing api documentation tools.
we performed a preliminary evaluation of spyrest by generating documentation of restful api actions from different apis providers github.com kissmetrics.com liquidplanner.com using lines of test code3.
comparing spyrest generated documents against the official documentation manually generated we found that the official documentation for of the api actions had outdated response information that did not match with the actual api responses as captured by spyrest.
this is an expected advantage of automation since updated documentation can be produced by replaying existing scripts instead of requiring any manual efforts.
using automated tests to generate documentation serves a dual purpose for maintaining a test suite since the documentation of the restful api becomes an artifact from the execution of tests.
this is a unique advantage of spyrest over other api documentation tools that translate manually edited api descriptions into api documents instead of executing actual api calls.
most general purpose api documentation tools such as javadoc extract documentation based on formatted comments from the source code.
since comments are not executable code manual effort is required to keep the comments updated as the underlying api changes.
restful api documentation typically includes additional information about http headers request and response payloads as well as example api calls that are not natively supported by general purpose api documentation tools.
also api documentation tools for library apis are often programming language specific.
spyrest overcomes these limitations of code comments based api documentation tools by leveraging a http proxy server where executable api examples are converted into api documentation that can be used to document restful apis independent of independent of what programming languages are used to implement the restful apis.. examples 816spyrest offers unique features compared to other restful api documentation services.
swagger4and blueprint5are two software as a service tools for restful api documentation.
the key difference between spyrest and these tools is in the underlying approach used.
these tools require the api developers to follow custom vendor specific api specification formats to describe the api objects.
once the apis are described the tools can auto generate the documentations for the apis.
there is no automated tool support to generate the required api description in the vendor specific formats.
thus manual effort is required to produce the required api specifications and maintain it over time.
spyrest does not require any intermediate api specification as data is sourced for the documentation based on live api calls.
swagger and blueprint do not support a self hosted service to document restful apis whereas spyrest allows a self hosted service to document restful apis that cannot be externally shared for confidentiality issues.
the technology choice behind for our implementation of spyrest components is based on our past experience of using these tools but the concepts behind spyrest is not dependent on the aforementioned technology choice.
as a proof of concept spyrest only analyzes json based api request and response payloads.
spyrest is a proof of concept implementation for a novel restful api documentation technique.
we identify the following limitations.
spyrest has yet to be evaluated.
we plan to evaluate spyrest with a large number of restful apis as well as conduct a user evaluation involving api developers to understand the strengths and weaknesses of our tool.
the current implementation of spyrest only works on json based restful apis.
spyrest needs to be enhanced to support other data types such as xml and csv .
spyrest like other http proxy servers performs an intentional man in the middle attack to intercept http traffic for example api calls over ssl tls.
we consider the security impact of this approach to be low since the data is commonly meant to be included in documentation for public use.
otherwise api developers can use the self hosted mode and provide spyrest with the required ssl keys.
web apis often include a set of commonly used error responses across a variety of api endpoints.
additional work is required on spyrest to automatically provide a summary of error responses based on example api calls.
spyrest also needs to be extended to support auto linking between different api endpoints so that api developers can navigate between related api documentations.
v. r ela ted work several papers have studied api documentation to understand and recommend requirements for effective api documentation tools.
robillard recommended the following requirements for api documentation include good examples be complete support many complex usage scenarios be conveniently organized and include relevant design elements .
kuhn et al.
discussed the importance of examples in api documentation as a key recommendation based on a survey of software developers using apis .
they identified trustworthiness confidentiality and limiting information overload as key recommendations for api documentation.
hoffman et al.
recommended providing executable test cases with api documentation .
nasehi et al.
recommended the use of wiki like editing features for online api documentation to foster collaboration .
parnin et al.
and chen et al.
also recommended incorporating collaborative features with api documentations .
stepalina identified several benefits of using software as a service model for api documentations as follows cost effective yet powerful platform agnostic and high accessibility improved document quality content reuse automated tools and organization of robust and scalable documentation process .
several papers have discussed the topic of restful api documentation.
espinha et al.
found most restful api documentations to be less reliable because they are manually generated .
danielsen et al.
proposed a vocabulary called web interface language wifl for documenting restful apis so that different apis can be described using a standard terminology .
restdesc rddl and hrests have been proposed as custom specifications to describe restful apis .
for restful api documentation myers et al.
recommended providing a consistent look and feel and an overall map comprising of both text and diagrams providing a browsing experience with breadcrumb trail following a hierarchy an effective search interface providing example code and a way to exercise the examples without writing code .
our work on spyrest is a result of following the recommendations as found on the aforementioned related work as well as critically analyzing existing api documentation tools such as javadoc swagger and blueprint to identify the unmet requirements.
based on our analysis we incorporated the following recommendations as requirements for spyrest automated restful api documentation executable examples consistent navigation and look and feel software as a service model wiki like editing automatic stripping of confidential data reducing information overload and in place collaboration.
vi.
c onclusion in this paper we have presented spyrest as a prototype tool to demonstrate an automated solution to restful api documentation.
our main contribution is a novel tool that leverages a http proxy server to intercept and automatically extract api documentation from example api calls.
spyrest provides an integrated tool for restful api documentation by providing features for automated generation customization maintenance collaboration and executable examples under a single cloud based software as a service platform.
by automating the repeated parts of the restful api documentation process spyrest provides a more effective alternative to the manual process.
api developers can use spyrest to save time and costs for generating and maintaining restful api documentation.
in the future we plan to conduct a quantitative evaluation by using spyrest to auto generate documentation for a large set of restful apis.
we will also conduct a qualitative user study involving api developers to collect feedback about the strengths and weaknesses of spyrest.
817references r. t. fielding architectural styles and the design of network based software architectures ph.d. dissertation university of california irvine .
t. espinha a. zaidman and h. g. gross web api growing pains stories from client developers and their code in proc.
of ieee conference on software maintenance reengineering and reverse engineering csmr wcre .
ieee pp.
.
p .
danielsen and a. jeffrey v alidation and interactivity of web api documentation in proc.
of international conference on web services icws .
ieee pp.
.
s. sohan c. anslow and m. frank spyrest automated restful api documentation using http proxy server in proc.
of ieee acm international conference on automated software engineering .
m. robillard what makes apis hard to learn?
the answers of developers software ieee vol.
pp no.
pp.
.
m. robillard and r. deline a field study of api learning obstacles empirical software engineering vol.
no.
pp.
.
a. kuhn and r. deline on designing better tools for learning apis in search driven development users infrastructure tools and evaluation suite icse workshop on pp.
.
d. hoffman and p .
strooper api documentation with executable examples journal of systems and software vol.
no.
pp.
.
s. m. nasehi j. sillito f. maurer and c. burns what makes a good code example?
a study of programming q a in stackoverflow inieee proc.
of international conference on software maintenance icsm pp.
.
c. parnin and c. treude measuring api documentation on the web in proc.
of the international workshop on web .
for software engineering ser.
web2se .
acm pp.
.
c. chen and k. zhang who asked what integrating crowdsourced faqs into api documentation in proc.
of the international conference on software engineering companion ser.
icse companion .
acm pp.
.
e. stepalina saas support in software documentation systems in proc.
of central and eastern european software engineering conference cee secr pp.
.
r. v erborgh t. steiner d. v an deursen s. coppens j. g. v all es and r. v an de walle functional descriptions as the bridge between hypermedia apis and the semantic web in proc.
of the third international workshop on restful design ser.
ws rest .
acm pp.
.
j. mangler p .
beran and e. schikuta on the origin of services using riddl for description evolution and composition of restful services in proc.
of ieee acm international conference on cluster cloud and grid computing ccgrid pp.
.
j. kopecky k. gomadam and t. vitvar hrests an html microformat for describing restful web services in proc.
of international conference on web intelligence and intelligent agent technology wiiat vol.
pp.
.
b. a. myers s. y .
jeong y .
xie j. beaton j. stylos r. ehret j. karstens a. efeoglu and d. k. busse studying the documentation of an api for enterprise service oriented architecture j. organ.
end user comput.
vol.
no.
pp.
.