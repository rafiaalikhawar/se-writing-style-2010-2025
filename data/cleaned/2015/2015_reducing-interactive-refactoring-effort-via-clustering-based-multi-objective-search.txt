reducing interactive refactoring effort via clustering based multi objective search vahid alizadeh cis department university of michigan dearborn michigan usa alizadeh umich.edumarouane kessentini cis department university of michigan dearborn michigan usa marouane umich.edu abstract refactoringisnowadayswidelyadoptedintheindustrybecause bad design decisions can be very costly and extremely risky.
onthe one hand automated refactoring does not always lead to thedesired design.
on the other hand manual refactoring is errorprone time consuming and not practical for radical changes.
thus recentresearchtrendsinthefieldfocusedonintegratingdevelopers feedback into automated refactoring recommendations becausedevelopers understand the problem domain intuitively and may haveacleartargetdesigninmind.however thisinteractiveprocess can be repetitive expensive and tedious since developers must evaluaterecommendedrefactorings andadaptthemtothetargeted design especially in large systems where the number of possible strategies can grow exponentially.
in this paper we propose an interactive approach combining the use of multi objective and unsupervised learning to reduce the developer s interaction effort when refactoring systems.
we generate first usingmulti objectivesearchdifferentpossiblerefactoring strategiesbyfindingatrade offbetweenseveralconflictingqualityattributes.then anunsupervisedlearningalgorithmclusters the different trade off solutions called the pareto front to guide the developers in selecting their region of interests and reduce the numberofrefactoringoptionstoexplore.thefeedbackfromthe developer both at the cluster and solution levels are used to automatically generateconstraints toreduce thesearch spacein the nextiterationsandfocusontheregionofdeveloperpreferences.weselected14activedeveloperstomanuallyevaluatetheeffectiveness our tool on open source projects and one industrial system.
the results show that the participants found their desired refactorings faster and more accurate than the current state of the art.
ccs concepts software and its engineering search based software engineering keywords search based software engineering refactoring multi objective search clustering permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september montpellier france association for computing machinery.
acm isbn ... .
reference format vahid alizadeh and marouane kessentini.
.
reducing interactive refactoring effort via clustering based multi objective search.
in proceedings of the 33rd acm ieee international conference on automated software engineering ase september3 montpellier france.
acm new york ny usa 11pages.
introduction as projects evolve developers frequently postpone necessary systemrestructuring knownasrefactoring intherushtodelivera newreleaseuntilacrisishappens.whenthatoccursitoftenresults insubstantiallydegradedsystemperformance perhapsaninability to support new features or even in terminally broken system ar chitecture.thus refactoringreceivedmuchattention duringthe lasttwodecadestoproposesolutionsthatcanmanagethegrowing complexityofsoftwaresystemsnowadays.mostexistingstudies focusoneithermanualorfullyautomatedcode levelrefactoring.
the manual support integrated into modern ides such as eclipse netbeans and visual studio consists of helping developers to apply refactorings based on automatedroutinesthatcancheckalistofpre andpost conditions but they have to specify manually which types of refactoring to beapplied suchasextractclassormovemethod andwhere.the fullyautomatedtechniquestrytoidentifyrefactoringopportunities and which refactorings to apply using static and dynamic analysis and the history of changes.
however design restructuring is a human activity that cannot be fully automated because developers understand the problem domain intuitively and they have targeted designgoalsinmind.thus severalempiricalstudiesshowthatfullyautomated refactoring does not always lead to the desired architecture .
furthermore manual refactoring is error prone time consuming and not practical for radical changes.
for instance batory et al.
presented several case studies where refactoring involved more than750 refactoring steps onone project and took more than weeks to execute.
recently few approaches have been proposed to interactively evaluaterefactoringrecommendationsusingsearch basedsoftware engineering .
the developers can provide a feedback abouttherefactoredcodeandintroducemanualchangestosome of the recommendations.
however this interactive process can be repetitive expensive andtedioussincedevelopersmustevaluate recommended refactorings and adapt them to the targeted design especiallyinlargesystemswherethenumberofpossiblestrategies can grow exponentially.
thus we seek in this work to answer the fundamental scienti c question what is the minimalguidance that leads automated search to useful and realistic refactoring recommendations?
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france vahid alizadeh and marouane kessentini inthispaper weproposeaninteractiveapproachcombiningthe use of multi objective search based on nsga ii and unsupervised learning to reduce the developer s interaction effort when refactoringsystems.wegenerate first usingmulti objectivesearch different possible refactoring strategies by finding a trade off between several conflicting quality attributes.
then an unsupervised learning algorithm clusters the different trade off solutions called theparetofront toguidethedevelopersinselectingtheirregionof interestsandreducethenumberofrefactoringoptionstoexplore.
thefeedbackfromthedeveloper bothattheclusterandsolution levels are used to automatically generate constraints to reduce thesearchspaceinthenextiterationsandfocusontheregionof developer preferences.
for instance the developer can select the mostrelevantclusterofsolutions calledregionofinterest based onhispreferencesandthemulti objectivesearchwillreducethe space of possible solutions in the next iterations by generating constraintsfromtheinteractiondatasuchaseliminatingpartofthe code e.gclassesormethods thatarenotrelevantforrefactoring to the programmer.
we selected active developers to manually evaluate the effectivenessourtoolon5opensourceprojectsandoneindustrial system.
the results show that the participants found their desired refactorings faster and more accurate than the current state of the art.
problem statement toinvestigatethechallengesassociatedwithcurrentrefactoring tools a survey was conducted as part of an nsf i corps project with127professionaldevelopersat38mediumandlargecompanies including ebay amazon google ibm and others.
of these interviews were conducted face to face.
as an outcome of these interviews the following challenges were identified challenge the refactorings effort required by existing approaches and tools.
of the interviewed developers confirmedthattheywerereluctanttouseexistingautomatedrefac toringtoolsbecausethosedetect ingeneral hundredsofcodelevel quality issues such as anti patterns but without specifying from wheretostartorhowtheyaredependentoneachothers norare thereanyclearbenefitssuchasanimpactonthesystem squality.
duringtheinterviews ofdevelopersconfirmedthattheywantbetterrefactoringtoolstogivethembetterunderstandingofdesign preferences rather than asking developers to manually inspect a large list of recommendations covering the whole system.
a developer said we need better solutions of refactoring tasks that can reducethecurrenttime consumingmanualworkofevaluatinga large number of refactorings.
automated tools provide refactoring solutions that are hard and costly to repair because they did not consider our design needs and hard to assess their impact.
this argument is consistent with empirical studies performed by kim et al.
.
challenge lack of visualization support to estimate the impact of recommended refactorings.
out of the participantshighlightedintheinterviewsthatitishardtounderstand the impact of suggested refactorings on the system and they have to look manually at the code before and after refactoring.
determiningwhichanti patternshouldberefactoredandhowisneverapuretechnicalprobleminpractice.instead high levelrefactoring decisions have to take into account trade offs between code quality availableresourcesandexpectedeffort.furthermore 53participantsmentionedthatseveralrefactoring paths arediscussed between architects to determine the best solution to restructure thecurrentarchitectureorcode.however mostofexistingrefactoring tools and approaches just recommend only one sequence of refactorings to apply.
challenge3 itisdifficultfordeveloperstoexpresstheir preferencesupfront.
basedonourextensiveexperienceworking onlicensingrefactoringresearchprototypestoindustry developers always have a concern on expressing their preferences upfront as an input for a tool to guide refactoring suggestions.
they prefer to get insights from some generated refactoring solutions then decide which quality attributes they want to improve.
however severalofexistingrefactoringtoolsfailtoconsiderthedeveloper perspective asthedeveloperhasnoopportunitytoprovidefeedbackontherefactoringsolutionasitisbeingcreated.furthermore asdevelopmentmusthaltwhiletherefactoringprocessexecutes fully automated refactoring methodsare not useful forfloss refactoring where the goal is to maintain good design quality while modifying existing functionality.
the developers have to accept the entire refactoring solution even though they prefer in general step wise approaches where the process is interactive and they have control of the refactorings being applied.
challenge4 lackofrefactoringtoolsthatcanlearnfrom developers interaction.
high levelrefactoringsareusuallysystematicandrepetitiveindifferentcontexts involvingsimilarchanges to numerous locations .
if these repetitive high level changes can be learned abstracted and automated a large amount of maintenance effort could be saved.
clustering based interactive multi objective software refactoring the general structure of our approach is sketched in fig.
.i n the following we decribe the different main components of our approach.
.
phase multi objective refactoring discovering a refactoring solution can be a challenging task since a large searchspace needs to beexplored.
this large searchspace istheresultofthenumberofrefactoringoperationsandtheimportance of their order and combination.
to explore this search space we propose an adaptation of the non dominated sorting genetic algorithm nsga ii tointeractivelyfindatrade offbetween multiple quality attributes.
a multi objective optimization problem can be formulated in the following form minimize f x f1 x f2 x ... fm x subject to x s s x rm h x x wheresis the set of inequality and equality constraints and the functions fiareobjective orfitnessfunctions.
in multi objective authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
reducing interactive refactoring effort via clustering based multi objective search ase september montpellier france figure overview of our proposed ic nsga ii approach.
optimization the quality of a solution is recognized by dominance.
thesetoffeasiblesolutionsthatarenotdominatedbyanyother solution is called pareto optimal ornon dominated solution set.
nsga iiisamulti objectiveevolutionaryalgorithmoperating onapopulationofcandidatesolutionswhichareevolvedtoward the pareto optimal solution set.
nsga ii uses an explicit diversitypreserving strategy together with an elite preservation strategy .
as described in algorithm the first iteration of the process begins with a complete execution of adapted nsga ii to our refactoringrecommendationproblembasedonthefitnessfunctionsthat willbediscussedlater.atthebeginning arandompopulationof encoded refactoring solutions p0 is generated as the initial parent population.
then the children population q0 is created from the initial population using crossover and mutation.
parent and childrenpopulationsarecombinedtogethertoform r0.finally asubset ofsolutionsisselectedfrom r0basedonthecrowding distanceand dominationrules.thisselectionisbasedonelitismwhichmeans keeping the best solutions from the parent and child population.
elitism does not allow an alreadydiscovered non dominated solution to be removed.
this process is continued until the stopping criteria is satisfied.
the results of the first execution of search algorithm are a set of non dominatedsolutionsthatwillbeclusteredandthenupdatedby the users.
after this interactions phase the multi objective search algorithmwillcontinuetorunusingthenewconstraintsgenerated at the cluster and solution levels.
.
.
refactoring solution representation.
arefactoringsolution isrepresentedasavectorconsistsofanorderedsequenceofmultiple refactoring operations.
each refactoring operation includes a refactoring action and its specific controlling parameters.
the refactoringtypesconsideredinourexperimentsare movemethod move field extract class encapsulate field pull up field pull up method pushdownfield pushdownmethod extractsubclass extract superclass.
refactoring operations are created or modified randomlyduringthepopulationinitializationormutation.also thesizeofasolutionvectorwhichisthenumberofincludedrefactoringoperation is randomly selected between lower and upper bound values.therefore itisimportant toinvestigatethe feasibilityofa solutionanditsoperationsusingrelatedpre andpost conditions .theseconditionsensurethattheprogramwillnotbreakwhile the behavior is preserved by the refactoring.
.
.
fitness functions.
thefitnessorobjectivefunctionevaluates a candidate solution and calculates its goodness degree to the considered problem.
in order to measure the influence of a refactoring solution on the software project we utilized quality model forobject oriented design qmood .
this model is developed basedoninternationalstandard forsoftwareproductqualitymeasurement.
qmood is a comprehensive way to assess the software qualityandincludesfourlevels.weemployedthefirsttwolevels known as design quality attributes and object oriented design properties tocalculateourfitnessfunctions reusability flexibility understandability functionality extendibility effectiveness complexity cohesion coupling .therelativechangeofthequality metric afterapplying therefactoring solutionis consideredas the fitness function and can be expressed as fitnessfunction i qmaf ter i qmbef ore i qmbef ore i whereqmbef ore iandqmaf ter iarethevalueofthequalitymetricibefore and after applying a refactoring solution respectively.
.
phase clustering the pareto front of refactoring solutions the goal of this phase is to reduce the effort to investigate the solutions in pareto optimal front.
we try to group the solutions basedontheirfitnessfunctionvalueswithoutfilteringorremoving any of them.
in this way the solutions can be categorized based thesimilarityamongthemintheobjectivesspace.then arepresentativesolutionisidentifiedfromeachpartitiontorecommend tothedecisionmaker centerofthecluster .forthispurposewe used clustering analysis technique.
clustering is one of the most authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france vahid alizadeh and marouane kessentini algorithm interactive clustering based nsga ii ic nsga ii input population size n source code output recommended pareto optimal solutions 1userpreferences initiate preference parameters 2while the user is satisfied do phase1 beginmulti objective refactoring p1 initializepopulation n userpreferences user preferred random population evaluateobjectives p1 userpreferences fastnondominatedsort p1 q1 selectcrossovermutate p1 userpreferences while stoppingcondition do evaluateobjectives q1 userpreferences user preferred evaluation rt p1 q1 fronts fastnondominatedsort rt pt i while pt front i ndo crowdingdistanceassign front i pt pt front i i i sortbyrankanddistance front i pt pt front i qt selectcrossovermutate pt userpreferences customized ga operator t t recommendedsolutions qt phase2 beginpareto front clustering gmmclustering recommendedsolutions described in algorithm clusterscenter phase3 begininteraction and user preference getuserfeedback clusters centers described in algorithm userpreferences extractpreferences 29returnrecommendedsolutions importantandpopularunsupervisedlearningproblemsinmachine learning.
it helps to find a structure in a set of unlabelled data in a way that the data in each cluster are similar together while they are dissimilar to the data in other clusters.
one of the challenges in cluster analysis is to define the optimal numberofclusters.therefore weneedclustervalidityindexasa measureofclusteringperformance.differentpartitionsiscomputed and the ones that fits the data better are selected.
the procedure of phase is illustrated in algorithm .
.
.
calinski harabasz ch index.
isaninternalclusteringvalidation measure based on two criteria compactness and separation .
ch evaluates the clustering results based on the average sum of squares between and within clusters and it defines as follows ch n k k k k ck dist ck s k k 1 si ckdist si ck wheredist a b istheeuclideandistance ckandsarethecluster and global centroids respectively.
the first step in pareto front clustering is to execute the clustering process with different number of components and to compute ch scoreforeach.thebestnumberofclusters k isdefinedastheone that achieves the highest ch score.
.
.
gaussian mixture model gmm .
is a probabilistic modelbased clustering algorithm with which a mixture of kgaussian distributions is fitted on the data.
gmm is soft clustering approach in which each data point is assigned a degree that it belongs to each of the clusters.
the parameters that need to fit are mean k co variance k and mixing coefficient k .
gmmclusteringbeginsbyrandominitiationofparametersfork components.
then expectation maximization em algorithm is employed forparameter estimation.
em is aniterative process to train the parameters and has two steps.
in the expectation step an authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
reducing interactive refactoring effort via clustering based multi objective search ase september montpellier france algorithm pareto front clustering input pareto front solutions s output labeled solutions ls clusters representative solution cr 1begincalculate best number of clusters k 2fori 2to10do ls gmmclustering i s score i calinskiharabaszindex ls 5k maxscoreidx 6begin gmmclustering k s 7 k k k initialize k gaussian expectation maximization 8while convergedo snk expectation k k k maximization evaluatelikelihood 12foreachsn sdo assigning cluster labels ln maxresponsibilityidx sn find clusters representative 14foreachclusterckdo crk maxdensity snk ck 16returnls cr assignment score to each gaussian distribution called responsibility or membership weight is determined for each solution point as follow znk kn sn k k summationtext.1k i 1 in sn i i the responsibility coefficient will be used later for preference extractionstep.inthemaximizationstep theparametersofeach gaussian are updated using the computed responsibility coefficients.
.
phase developers interaction and preferences extraction our tool presents the results of clustering based multi objective refactoring in a user friendly way via interactive colored graphical charts and tables as shown in figure .
the developer has the ability to explore the recommended solutions and clusters efficiently and discover the shared underlying characteristicsofthesolutionsinaclusterataglance.theusermay only investigate the cluster s center solution or search further and examinethesolutionsinsideaclusterofinterest.everyrefactoring operation can be evaluated by the programmer.
as described in algorithm wetranslateeachevaluationfeedbacktoacontinuous score in the range of .
the user can interact with the tool at the solution level by accepting rejecting modifying specific refactoring or the cluster figure interactive solution charts in our tool.
algorithm interaction and user preferences input labeled solutions ls output preferred cluster pc preference parameters cwp classes weighted probability rwp refactorings weighted probability rs reference solution beginuser interaction and feedback while interaction is done do feedback i userevaluation refi vi score feedback i solutions and clusters score score si average vi si score ck average score si ck pc cluster with max score beginuser preference extraction representative solution as reference rs crpc foreach pcdo rwp p averageweightedfreq refp cwp q averageweightedfreq clq returnpc preference parameters level by specifying a specific cluster as the region of interest.
aftertheinteractionisdoneandtheuserdecidestocontinuetothe next round the score of each solution and cluster are computed.
solution score score si is defined as the average of all refactoring operations score exists in the solution vector.
similarly cluster score score ck is calculated as the average of all solutions score assignedtothecluster.then theclusterachievedthehighestscore authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france vahid alizadeh and marouane kessentini amongallclustersisconsideredastheuserpreferredpartitionin pareto frontspacefromwhichthepreferenceparameterswillbe extracted.
the next step of phase of our proposed approach is to extract user preference parameters from the interaction step.
we consider the representative solution of the preferred cluster as the reference point.then wecomputetheweightedprobabilityofrefactoring operations rwp and target classes of the source code cwp .
notethatonlythenameofrefactoringactionwithoutitsassociated controlling parameters is matched.
assuming the selected cluster s index isj these parameters can be computed as follow rwp p summationtext.
si cj ij rp si summationtext.
rm ref summationtext.
si cj ij rm si cwp q summationtext.
si cj ij clq si summationtext.
clm cls summationtext.
si cj ij clm si wheresiis the solution vector ijis the membership coefficient ofsolutionitotheclusterj risrefactoringaction refistheset ofall refactoringoperations and clsisthe setofall classesinthe source code.
.
applying preference parameters if the user decides to continue the search process then the preferenceparameterswillbeappliedduringtheexecutionofdifferent components of multi objective optimization as described in the following preference basedinitialpopulation thesolutionsfrompreferred clusters will make up the initial population of next iteration as a means of customized search starting point.
in thisway weinitiatethesearchfromtheregionofinterest ratherthanrandomly.newsolutionsneedtobegenerated tofillandachievethepre definedpopulationsize.insteadof randomcreationoftherefactoringoperations refactoring actionandtargetclass basedonaunifyprobabilitydistribution we utilize rwpandcwpas a probability distribution.
preference based mutation for this operator similarly if a solution is selected to mutate we give a higher chance to refactoring operations of interest to replace the chosen one based on the probability distribution rwp.
preference based selection the selection operator tends to filterthepopulationandassignhigherchancetothemore valuableones based ontheir fitnessvalues.
inorder toconsidertheuserpreferencesinthisprocess weadjustedthis operator to include closeness to the reference solution as an added measure of being a valuable individual of the population.thatmeans thechanceofselectionis relatedtoboth fitness values and distance to the region of interest as chance si dist si crj fitness si wheredist indicates euclidean distance and crjis the representative solution of cluster j. the above mentioned customized operators aid to keep the stochasticnatureoftheoptimizationprocessandatthesametimetaketable statistics of the studied systems.
system release classes kloc argouml v0.
jhotdraw v7.
.
ganttproject v1.
.
49utest v7.
74apache ant v1.
.
112azureus v2.
.
.
the user preferred refactoring and target code locations classes into account.
evaluation in this section we first present our research questions and validation methodology followed by experimental setup.
then wedescribe and discuss the obtained results.
the data of our exper iments including a tool demo and the complete statistical results can be found in the following link .
.
research questions wedefinedthreemainresearchquestionstomeasurethecorrectness relevance and benefits of our interactive clustering based multi objective refactoring tool comparing to existing approaches thatarebasedoninteractivemutli objectivesearch fullyautomated multi objective search ouni et al.
and fully automated deterministic tool not based on heuristic search jdeodorant .
the research questions are as follows rq1 refactorings relevance.
to what extent can our approach make meaningful recommendations compared to existing refactoring techniques?
rq2 interactive clustering relevance.
to what extent can our clustering based approach efficiently reduce the interaction effort?
rq3 impact.
how do programmers evaluate the usefulness of our tool questionnaire ?
.
experimental setup toaddressthedifferentresearchquestions weusedthesixsystems intable1.weselectedthesesixsystemsbecauseoftheirsize have been actively developed over the past years and extensively analyzedbythe competitivetoolsconsideredin thiswork.utest1 is a project of our industrial partner used for identifying reportingand fixing bugs.
we selected that system for our experiments since threeprogrammersofthatsystemagreedtoparticipateintheexperimentsandtheyareveryknowledgeableaboutrefactoringsincetheyarepartofthemaintenanceteam.table 1providesinformation aboutthesizeofthesubjectsystems intermsofnumberofclasses and kloc .
toanswerrq1 weaskedagroupof14activeprogrammersto identifyandmanuallyevaluatetherelevanceofthebestrefactorings sequence that they found using four tools.
these tools are ouric nsga iiapproach anexistinginteractivemulti objective refactoring tool without the clustering feature and two fullyautomatedrefactoringtoolsbythemeansofouni andjdeodorant .
ouni proposed a multi objective refactoring formulationbasedonnsga iithatgeneratesasolutiontomaximizethedesign coherence and refactorings reuse from previous releases.
1company anonymized for double blind.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
reducing interactive refactoring effort via clustering based multi objective search ase september montpellier france table selected programmers.
system subjects avg.
prog.
exp.
avg.
refactoring exp.
argouml high jhotdraw .
very high azureus medium ganttproject .
high utest .
very high apache ant very high jdeodorant is an eclipse plugin to detect bad smells and apply refactorings.asjdeodorantsupportsalowernumberofrefactoring typeswithrespecttotheonesconsideredbyourtool werestrictour comparisonwithittotheserefactorings.mkaouer proposed a tool for interactive multi objective refactoring but the interac tions were limited to the refactorings accept reject and there is no clustering of the pareto front or learning mechanisms from the interaction data.
we used these three competitive tools to eval uate the benefits of the clustering feature in helping developers identifying relevant refactorings.
we preferred not to use the antipatterns and internal quality indicatorsasproxiesforestimatingtherefactoringsrelevancesince wethedevelopersmanualevaluationalreadyincludesthereview oftheimpactofsuggestedchangesonthequality.furthermore notall the refactorings that improve any quality attributes are relevant to the developers which is one of the main motivations of this work.theonlyrigorouswaytoevaluateourtherelevanceofour tool is the manual evaluation of the results by active developers.
participantswerefirstaskedtofilloutapre studyquestionnaire containingfivequestions.thequestionnairehelpedtocollectbackground information such as their role within the company their programming experience and their familiarity with software refactoring.
in addition all the participants attended one lecture of two hoursonsoftwarerefactoringbytheorganizersoftheexperiments.
thedetailsoftheselectedparticipantscanbefoundintable 2includingtheirprogrammingexperience familiaritywithrefactoring etc.eachparticipantwasaskedtoassessthemeaningfulnessofthe refactorings recommended after using two out of the four tools on two different systems to avoid the training threat.
the participants did not only evaluate the suggested refactorings but were asked to configure run and interact with the tools on the different systems.
the only exceptions are related to the participants from the industrial partner where only two out of the three agreed to evaluatean additional system to utest while the third only reviewed the refactoring recommendations on the industrial software.
thus the totalnumberofevaluationsofthedifferenttoolsis27.weassigned thetaskstotheparticipantsaccordingtothestudiedsystems the techniques to be tested and developers experience.
each of the fourtoolshasbeenevaluatedatleastonetimeoneveryofthesix systems.
to answer rq2 we measured the time t that developers spent toidentifythebestrefactoringstrategiesbasedontheirpreferencesandthenumberofrefactorings nr .furthermore wequalitatively evaluatedtheimpactoftheinteractionswiththeusersonthepareto fronttobetterconvergetowardsa regionofinterests reflecting their preferences.
for this research question we decided to limitthe comparison to only the interactive multi objective work of mkaoueretal.
sinceitistheonlyonethatoffersinteraction with the users and it will help us understand the real impact of the clustering feature not supported by on the refactoring recommendations and interaction effort.toanswerrq3 weaskedtheparticipantstouseourtoolduring aperiodoftwohoursonthedifferentsystemsandthenwecollected theiropinionsbasedonapost studyquestionnaire.tobetterunderstandsubjects opinionswithregardtousefulnessandusablility of our approach in a real setting the post study questionnaire was given to each participant after completing the refactoring tasks usingourinteractiveapproachandallthetechniquesconsidered inourexperiments.thequestionnairescollectedtheopinionsof the participants about their experience in using our tool compared to existing manual interactive and fully automated refactoring techniques.
.
statistical tests and parameters setting we used one way anova statistical test with a confidence level to find out whether our sample results of different approaches are different significantly.
since one way anova is an omnibus test a statistically significant result determines whether threeormoregroupmeansdifferinsomeundisclosedwayinthe population.one wayanovaisconductedfortheresultsobtained from each software project to investigate and compare each performancemetric dependentvariable betweenvariousstudiedalgorithms independentvariable .wetestthenullhypothesis h0 that population means of each metric are equal for all methods against the alternative h1 that they are not all equal and at least one method population mean is different.
one way anova does not report the size of the difference.
therefore wecalculatedthevargha delaneyameasure which isameasureoftheeffectsize strengthofassociation anditestimatesthedegreeofassociationbetweentheindependentfactorand dependent variable forthe sample.
eta squared is the proportion ofthetotalvariancethatisattributedtoafactor the refactoring methods in this study .
adetaileddescriptionofthestatisticaltestsresultscanbefound in this link .
parameter setting influences significantly the performance of a search algorithm on a particular problem .
for this reason for each algorithm and for each system we perform a set of experiments using several population sizes 250and .
the stopping criterion was set to evaluations forall search algorithms in order to ensure fairness of comparison without counting the number of interactions since it is part of the users decision to reach the best solution based on his preferences .
the other parameters values were fixed by trial and error and are asfollows crossoverprobability .
mutationprobability .
where theprobability of genemodification is .
.
inorder to have significant results for each couple algorithm system we use the trial and error method in order to obtain a good parameter configuration.
.
results resultsforrq1 refactoringsrelevance.
wereporttheresults ofourempiricalqualitativeevaluation mc infigure 3basedon themanualcheckingofthebestsolutionsidentifiedbyeachtool.
as reported in this figure the majority of the refactoring solutionsrecommendedbyourinteractiveclustering basedapproach authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france vahid alizadeh and marouane kessentini figure3 themedianmanualevaluationscores mc onthe six systems with confidence level based on a one way anova statistical test were correct and validated by the participants on the different systems.
on average for all of our ten studied projects of theproposed refactoring operations are considered as semantically feasible improve the quality and are found to be useful by the software developers of our experiments.
the remaining approaches have an average of and respectively for mkoaueret al.
interactive multi objective approach ouni et al.
fully automatedmulti objectiveapproach andjdeodorant deterministic non search based approach .the highest mc score is for thegantt project and the lowest score is for jhotdraw.
thus it isclearthattheresultsare independent ofthesizeofthesystems andthenumberofrecommendedrefactoringsasdetailedinrq2 aswell.bothoftheinteractivetoolsoutperformedfully automated ones which shows the importance of integrating the human in the loopwhenrefactoringasystem.furthermore itisclearthatadding the clustering feature to enable the developers to select a region of interests based on which quality objectives they want to prioritize and what refactoring solutions they partially liked.
a qualitative analysis of the results show that several interactions with the developers helped to reduce the search space by avoidingtherefactoringsthatwererejectedbythemandtheirlocation.
we found that the best final refactoring solutions identified bythedevelopersafterseveralinteractionswithourtoolcannotbe recommended by the remaining approaches.
in fact all these solutionsareobtainedeitherafter1 eliminatingrefactoringsapplied to specific code locations not relevant to the programmers context somethingthatcannotbelearnedwiththeinteractioncomponent or2 emphasizingspecificclusterthatprioritizessomeobjectives andpenalizes others.for instance the developersfrom theindustrialpartnerfoundseveraloftherefactoringsthatarerecommended by ouni et al.
and jdeodorant as non relevant while they could be correct becauseitmayrefactorastablecodeorclassesthatarenot of their interest to be refactored.
all the results based on the mc metric on the different systems werestatisticallysignificantwith95 ofconfidencelevel.regarding theeffectsize wefoundthatourapproachisbetterthanalltheother algorithms with an a effect size higher than .
for argouml ganttproject utestandapacheant andanaeffectsizehigher than .
for jhotdraw and azureus.table median time in minutes and number of refactorings proposed by both interactive approaches on the differ ent six systems techniques systems ic nsga ii t nr mkaouer et al.
t nr argouml jhotdraw azureus ganttproject utest apache ant results for rq2 interactive clustering relevance.
table3 summarizesthetime inminutes andthenumberofrefactorings in the most relevant solution found using our tool ic nsga ii and the interactive approach of mkaouer et al.
.
all the participants spent less time to find the most relevant refactorings on the different systems comparing to mkaouer et al.
.
for instance the average time is reduced by over for the case of apache ant from minutes to just minutes.
the time includes the execution of ic nsga ii and the different phases of interactionuntil that the developer is satisfied with a specific solution.
it isclear as well that the time reduction is not correlated with the numberofrecommendedrefactorings.forinstance thedeviation betweenic nsga iiandmkaoueretal.forapacheantintermsof number of recommended refactorings is limited to vs but the time reduction is almost minutes.
however it is clear that ourapproachreducedaswellthenumberofrecommendedrefactoringscomparingtomkaoueretal.whileincreasingthemanual correctnessasdescribedinrq1.thehighestnumberofrefactorings wasobservedontheindustrialsystemwith52refactoringsusing ic nsga ii and refactorings using mkaouer et al.
this couldbe explained by the fact that the original developers can betterunderstand the possible relevance of the recommended refactorings comparing the remainingparticipants evaluation on the open source systems.
figure4showsa qualitative example extracted fromour experiments using ic nsga ii on the gantt project with a populationsize of based on three phases of interactions.
after the generationoftheparetofront theclusteringfeatureidentifiedthree main different clusters for the two objectives selected by the developer extendibility and effectiveness .
during the first phase the developerselectedtheclusterwithid0asthepreferredoneafter exploring several refactoring solutions in that cluster includingthe center of the cluster.
thus the next iterations of ic nsga iiprioritized that region of interest so more refactoring options were generated around the previously selected cluster.
then since theuserselectedagainaclustermaximizingthesetwoobjectives clusterwithid1 morerefactoringoptionsinthenextiterations until that a good refactoring sequence is selected.
results for rq3 impact.
we summarize in the following the feedback of the developers based on the post study questionnaire.
12outthe14participantsmentionthatourinteractiveclusteringbased refactoring tool is faster and much easier to use than the authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
reducing interactive refactoring effort via clustering based multi objective search ase september montpellier france figure4 illustrationoftherefactoringsolutionsconvergencetoaregionofinterestaftertworoundsofinteractionsextracted from the experiments on the gantt project.
interactive multi objective tool of mkaouer et al.
to identify quickly relevant refactorings based on their interests.
for instance the comment of one participant is the following i believe the addition of the clustering algorithm really helped identify a solution quicker.itwasdifficulttodecidebetweensimilarrefactoringsolutionsusingthenon clusteringversionofthetool.theclustercentershelped focus the attention to just a few solutions which were easy to choose between.
asimilarobservationisvalidwhencomparingourtool to the fully automated multi objective refactorings tool of ouni et al.
where out of the participants highlighted the difficulty to select one relevant refactoring solution from a large set of nondominated solutions and without offering any flexibility to update them.oneexampleofreceivedcommentsis themainadvantageof this tool is instead of looking so many refactoring solutions manually this tool helps us to find the best solution based on objective selectingthe center of the different clusters which provide the good refactoring recommendations.
all the developers mentioned the high usability of the tool and the different options that are offered comparing to deterministic tools like jdeodorant.
in addition they did not appreciate a lot the long list of refactoring suggested by ouni et al.
and jdeodorantsince they want to take control of modifying and rejecting some refactorings.
in addition the validation of this long list of refactoringsistime consuming.thus theyappreciatethatourtoolsuggests refactoringonebyoneandupdatethelistbasedonthefeedback ofdevelopers.13participantscommentedontheminimumeffort required to understand the impact of the proposed refactorings on the quality and to identify a relevant solution using the clusters comparingallthethreeremainingtools refactoringwithclustering reduces the time of the analysis of the objectives.
it keeps the similar type of classes or patterns in the same cluster and dissimilar patternsinanothercluster.
alltheparticipantsfoundaswellourtoolhelpful forbothflossrefactoring tomaintainagoodqualitydesignandalso forroot canal refactoring to fix some quality issues such as code smells.
threats to validity conclusion validity .
the parameter tuning of the different optimization algorithms used in our experiments creates anotherinternal threat that we need to evaluate in our future work.
the parameters values used in our experiments are found by trial anderror .however itwouldbeaninterestingperspectivetodesign an adaptive parameter tuning strategy for our approach so that parametersareupdatedduringtheexecutioninordertoprovide the best possible performance.
internal validity.
the variation of correctness and speed between the different groups when using our approach and other toolssuchasjdeodorant.infact ourapproachmaynotbetheonly reason for the superior performance because the participants have different programming skills and familiarity with refactoring tools.
to counteract this we assigned the developers to different groups according to their programming experience so as to reduce thegapbetweenthedifferentgroupsandwealsoadaptedacounterbalanceddesign.regardingtheselectedparticipants wehavetaken precautionsto ensurethatour participantsrepresenta diverseset ofsoftwaredeveloperswithexperienceinrefactoring andalsothat the groups formed had in some sense a similar average skill set in the refactoring area.
construct validity.
the different developers involved in our experiments may have divergent opinions about the recommended refactorings in terms of relevance which may impact our results.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france vahid alizadeh and marouane kessentini external validity.
the first threat is the limited number of participants and evaluated systems which externally threatens the generalizability of our results.
in addition our study was limited totheuseofspecificrefactoringtypes.futurereplicationsofthis study are necessary to confirm our findings.
related work hall et al.
treated software modularization as a constraint satisfaction problem.
the idea of this work is to provide a baseline distribution of software elements using good design principles e.g.
minimal coupling and maximal cohesion that will be refined by asetofcorrectionsintroducedinteractivelybythedesigner.the approach calledsumo supervisedre modularization consists of incrementally feeding domain knowledge into the remodularization process.
the process is performed by the designer in terms of constraints that can be introduced to refine the current modularizations.initially thesystembeginswithgeneratingamodule dependencygraphfromaninputsystem.thisdependencyisbased onthecorrelationbetweensoftwareelements couplingbetween methods shared attributes etc.
.
possible modularizations are then generatedfromthegraphusingmultiplesimulatedauthoritative decompositions.then usingaclusteringtechniquecalledbunch an initial set of clusters is generated that serves as an input to sumo.
the sumo algorithm provides a hypothesized modularizationtotheuser whowillagreewithsomerelations anddisagree with others.
the user s corrections are then integrated into the modularization process to generate a better modularization.
dig proposes an interactive refactoring technique to improve the parallelism of software systems.
however the proposed approach did notconsider learning from thedevelopers feedback and focused on making programs more parallel.
bavota et al.
presented the adoption of single objective interactive genetic algorithms in software re modularization process.
the main idea is to incorporate the user in the evaluation of the generated remodularizations.interactivegeneticalgorithms igas extendtheclassic genetic algorithms gas by partially or entirely involving the user in the determination of the solution s fitness function.
the basic idea of the interactive ga iga is to periodically add a constraint to the ga such that some specific components shall be put inagivenclusteramongthosecreatedsofar.afteranalyzingthe current modularization solutions the user provides feedback in terms of constraints dictating for example that a specific element needs to be in the same cluster as another one.
although user feedbackisimportantinguaranteeingconvergence itisessentialnot tooverloadtheuserbyaskingforadecisionaboutallthecurrent relationships between elements especially for a large system.
arecentstudy extendedapreviouswork toproposean interactivesearchbasedapproachforrefactoringrecommendations.
the developers have to specify a desired design at the architecture level then the proposedapproach try to find therelevant refactorings that can generate a similar design to the expected one.
in our work we do not consider the use of a desired design thus developersarenotrequiredtomanuallymodifythecurrentarchitectureof thesystemtogetrefactoringrecommendations.furthermore developers maybe interested to change the architecture mainly whenthey want to introduce an extensive number of refactorings that radically change the architecture to support new features.
noneoftheaboveinteractivestudiesconsideredreducingthe interaction effort with developers which is an important step to improve the applicability of refactoring tools as highlighted in the survey with developers.
conclusions and future work weproposed inthispaper aninteractiveclustering basedrecommendationtoolforsoftwarerefactoringthatreducestheeffortof improving the quality of software systems.
the exploration of the non dominated refactoring solutions is implicitly performed based ontheinteractionwiththedevelopers.thefeedbackreceivedfrom the developers and the clustering of non dominated refactoring solutionsareusedtoreducethesearchspaceandconvergetobetter solutions.toevaluatetheeffectivenessofourtool weconductedanevaluationwith14softwaredeveloperswhoevaluatedthetooland compareditwiththestate of the artrefactoringtechniques.our evaluationresultsprovidestrongevidencethatourtoolimproves the applicability of software refactoring and proposes a novel way for software developers to refactor their systems interactively with reasonable effort.
futureworkinvolvesvalidatingourtechniquewithadditional refactoring types programming languages and programmers in ordertoconcludeaboutthegeneralapplicabilityofourmethodology.furthermore weonlyfocused inthispaper ontherecommendation of refactorings.
we plan to extend the interactive clustering based approach to others related software maintenance problems such asregressiontestingandbugslocalization.wewillalsoworkon making the refactoring recommendations more personalized based on the profile of programmers by learning their preferences.