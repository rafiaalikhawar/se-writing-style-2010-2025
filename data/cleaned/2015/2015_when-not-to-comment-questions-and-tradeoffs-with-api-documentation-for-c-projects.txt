when not to comment questionsand tradeoffs with api documentation for c projects andrew head uc berkeley andrewhead berkeley.educaitlin sadowski google inc. supertri google.comemersonmurphy hill nc state university emerson csc.ncsu.eduandrea knight google inc. aknight google.com abstract without usable and accurate documentation of how to use an api developerscanfindthemselvesdeterredfromreusingrelevantcode.
inc oneplacedeveloperscanfinddocumentationisinaheader file.wheninformationismissing theymaylookatthecorresponding implementation code.
to understand what s missing from c apidocumentationandthefactorsinfluencingwhetheritwillbe fixed we conducted a mixed methods study involving two experiencesamplingsurveyswithhundredsofdevelopersatthemoment theyvisitedimplementationcode interviewswith18ofthosedevelopers and interviews with api maintainers.
in many cases updating documentation may provide only limited value for developers while requiring effort maintainers don t want to invest.
we identify a set of questions maintainers and tool developers should considerwhen improving api level documentation.
acm reference format andrewhead caitlinsadowski emersonmurphy hill andandreaknight.
.
when not to comment.
in proceedings of icse 40th international conference on software engineering gothenburg sweden may june icse pages.
introduction seeking information is a substantial part of day to day programming work.
both professional and hobbyist developers frequently search for code examples.
for routine coding debugging andmaintenancetasks developersspendalargeportionof thetimenavigatingandsearchingexistingcode .developers report that understanding existing code is one of the most timeconsuming parts of software development and that understanding the rationale behind code is a serious challenge .
developerssometimesfindthatmissingorinsufficientdocumentation can block them from using an api .
at google of surveyed developers reported that they encountered missing poordocumentationforanapi theirprojectdepended on in the last months.
in the words of one of the interviewees in our study missing information is a standard fact of life.
while the literature demonstrates documentation is often incorrect ormissing it remains unclear what information is missing what it authorsdidthisresearchwhileaninternandvisitingscientistatgoogle repectively.
icse may june gothenburg sweden copyright held by the owner author s .
acm isbn .
take for maintainers to add or update this information and whetherimp roveddocumentationwouldhelpdevelopersintypical situations where documentation is insufficient.
in this paper we report the results of a mixed methods study of what developers are looking for when they leave an api specification to look at implementation code and maintainers perspectives aboutupdatingdocumentationtoanswerthesedevelopers questions.
to make this study feasible we focus on c apis where developerscouldeasilysearchboththeapispecificationandimplementation code a typical context for professional and open source development.
we instrumented google s internal code search tool with an in situ survey to find out what questions developers were askingwhentheynavigatedfroma .h header filecontainingapi declarations toacorresponding .cc implementation filecontaining api definitions.
we interviewed developers who made these transitions.withstoriesandquestionsfromthesedevelopers we interviewedmaintainersfortheseandotherapistoseewhether they thought the questions represented missing documentation and whether they would update the documentation.
concretely thefindingsfromthisstudywereasfollows.first a minority between around of visits to implementation files were to learn about api usage.
some visits were for questions that possibly should have been answered in the documentation inputvalues returnvalues .othervisitswereforquestionsthat aren toftenansweredinlow leveldocumentation hiddencontracts implementationdetails sideeffects .
second respondentsfrequentlyreportedthatitwouldhavebeen most convenient to find answers to these questions in header files insteadofimplementationcodeordocumentsonourmarkdown server.
this was the case even for some questions typically left out of api level documentation.
however developers we interviewed sometimespreferredtofindanswersinimplementationcode which could be more accurate and quick enough to read.
finally maintainers were reluctant to answer searchers questions for several reasons falling into themes of it not being the right timeto document and keeping explanations minimal.
themaincontributionsofthispaperare asetofquestionsthat developersareseekingtoansweraboutc apiswhenviewing implementation files and trade offs for maintainers to consider when updating documentation to answer searchers questions.
at google developersand technical writersinvest effort inchoosing and organizing content to document apis and tools and they need to decide how to prioritize that effort.
software engineering researchersaredevelopingtoolstomineapiinformationandserveit in helpful places e.g.
.
we believe our study helps inform what information should be surfaced and the software development context that would determine the acceptance and value of tools and strategies to improve api documentation.
.
ui oufsobujpobm pogfsfodf po 4pguxbsf ohjoff sjoh this work is licensed under a creative commons attribution noncommercial noderivs international .
license.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june3 gothenburg sweden andrew head caitlin sadowski emerson murphy hill and andrea knight related work .
how developers reference documentation theliteraturesuggeststhatdevelopersfaceanumberofchallenges whenlookingforinformationinapidocumentation.frominterviews with developers lethbridge et al.
reported that documentationcanbeout of date poorlywritten andsomesystemsmay have too much of it .
in a survey of professional developers robillard found that inadequate learning resources were a com mon obstacle for learning about apis .
robillard and deline interviewed and surveyed developers about learning obstacles recommendingthatcommonobstaclescouldbeavoidediftheintent ofanapiisdocumented codeexamplescovernon trivialusecases andbestpractices anddocumentationhelpsdevelopersfindapi elementsfortheirtasks understandrelevantpartsofapis internal behavior and avoids fragmentation .
in another survey uddin and robillard found that developers were more likely to report incompleteness ambiguity and incorrectness of documentation as blockers or severe issues than other documentation issues .
priorstudiesindicatethattheperceivedandactualutilityofcommentsvariesbased on where they appear and who is reading them.
roehm et al.
observed that most professional developers in theirstudy reported getting their main information from source code andinlinecommentsratherthandocumentation asdocumentation could be sparse or inaccurate .
salviulo et al.
found that young professionaldevelopers comparedtostudentprogrammers were less likely to consult comments during in lab code comprehension tasks .
borstler et al.
showed that although source code with good comments was reported as more readable these comments didn t appear to impact actual comprehension .
inrelationtothesepastfindingsaboutdocumentation thisstudy providesaperspectiveonwhatinformationmaybemissingfrom low levelapidocumentation andanunderstandingofcostsand benefits of improving missing documentation in header files.
.
information foraging in code software engineering is an information intensive task requiringdevelopers to gather information from peers code design documentation andmore .recently informationforagingtheory hasbeenusedtodescribehowsoftwaredeveloperssearchforinformation andtradeoffsindesigningsoftwareengineeringtools see foraprimer .ininformationforaging adevelopersearches to satisfy a goal e.g.
a piece of code with desired functionality .
theylocateinformation patchestoinspectforfeaturessatisfying theirgoal called prey.developersmakechoicestomaximizethe valueofinformationtheyfind andminimizethecostofnavigation.
tochoosewheretolook developersestimatetheexpectedvalueof information withina patch andthe costof finding it.when there is a mismatch between the expected and actual costs and values a developer could benefit from a better strategy or tools.
for sometasks foraging consistently delivers less value than expected in one study as many as of navigation choices yielded less value than expected and cost more than expected .
thesoftwareengineeringresearchcommunityhaselicitedmany informationgoalsasconcretequestionsdevelopersaskastheywrite and maintain code.
sillito et al.
describe such questions arising duringsoftwarechangetasks whichbelongedtofourcategories finding initial focus points building on these points building amodel connecting found information and integrating an understandingacrosssuchmodels .sadowskietal.observeddevelopers queries to a code search tool grouping them into questions ofhow to do something what code does why it is behaving the way it is finding where something is who did something and when theydidit .duala ekokoandrobillarddescribe20questions developers askabout apis basedon talk aloud dataof developers performing in lab coding tasks .
developers adapt their foraging strategies to their goals.
in one study developersinspectedcodemorewhencollectingdetailsabout types and searchedcode moretofindinitiallocationsrelevantto theirdebuggingtask .fromaforagingperspective ourstudy seekstocharacterizeaspecificforagingstrategy lookingforapi usageinformationinimplementationcode.wereportasetofinformationgoalsdevelopershavewhentheylookatimplementation codeforanapi anddescribefactorsinfluencingthecostandvalue of finding answers to api usage information in code vs. documentation in a real world software development setting.
.
choosing what to document when considering how maintainers decide what to document we buildonpriorstudiesofwritingbothunofficialandofficialdocumentation.parninetal.interviewedprogrammingbloggers finding thattheyfacechallengeskeepingupwithcommunitycontributions andpreparingexamples .dagenaisandrobillardspokewith contributors to open source projects finding that maintainers motivationtowriteandmaintaindocumentationcouldbelow though maintainers may update documentation in response to community contributions .
our study can be seen as providing context about the choices maintainers make when writing and considering making updates to low level documentation.
maalejandrobillarddescribedtwelvetypesofknowledgeinreference documentation including purpose and usage examples .
padioleau et al.
observed what code comments describe by classifyinghundredsofcomments .
wentbeyondexplainingthecode to describe types relationships between code entities aspects of code evolution synchronization and more .
in relation to this work our study provides some examples of questions that were not answered in api level comments.
recent research has proposed tools for automatically improving documentation.
such tools synthesize code examples generate method and parameter descriptions mine api usage patterns e.g.
collect insightful sentences describingapis andidentifyimprovabledocumentation .
researchers have extended development environments to revealimportant usage information and integrate online documentation and web search history .
this study provides an understanding of developer questions and perspectives on documentationthatwehopecanhelpmotivatethedesignofsuchtools.
methods .
overview of mixed methods weusedamixed methodsapproachtounderstandwhatdevelopers are looking for in implementation code and whether more informationshouldbeaddedtodocumentation.throughcodesearch authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june3 gothenburg sweden andrew head caitlin sadowski emerson murphy hill and andrea knight include display.h int main void displaynumber display number to the console.
returns if successful.
no runtime guarantees.
int displaynumber int number client s codeheader in display.h implementation in display.cc int displaynumber int number if number throw invalid arguments!
some complex logic ... printf d n number return the client can reference the header for api declarations and usage info.... though the behavior of the api will be encoded in the implementation.
figure2 writingdocsin .handimplementationin .ccfiles.
for c apis the member declarations and actual implementation are often split between two distinct files as shown in this toy example.
clients may have to reference both to understand both an api s intended usage andits actual behavior.
.
searcher interviews we conducted interviews with developers whom we refer to as searchers s1...s18 tolearnwhatdeveloperslookforwhen they leave header files to visit implementation files.
we invited subscribersofaninternalc developersmailinglisttoagreeto participate in a minute interview if warranted based on log analysis.
developers opted in.
twice a day we ran a script to identify developers in our opt in list who had made a transition from a .hfile to the corresponding .ccfile.toincreasethelikelihoodofrevealingmissingapiusability information weonlyconsideredtransitionsfromfilesthathadvisits from or more distinct developers in the last six months.1we then reached out to the developer to arrange an interview.
mostinterviews took place on the same day as the searcher had made the transitionfrom the .hfile to the .ccfile.
we held a semi structured interviews with each developer api searcher questions in the online appendix .
one author conductedallinterviews.first weremindedthedeveloperwhat .hfile they left to visit implementation code and asked them to describe what they were looking for in the .hfile and why they visited the.ccfile.
developers then described their process of looking for information in the implementation code including files they visited methods they inspected and the answer they found.
ifthedeveloperwaslookingforinformationina .ccfileforhow to use an api we asked them where it would be most convenient to find this information.
with any time remaining we asked the developeraboutoneoftwotopics.thefirsttopicwastorecallrecentexperiencesofinformationmissingfrom .hfiles orofreadingwellmaintained .hfiles.
the second topic was having them describe theirteam sprocessfordecidinghowtodocumenttheircode so wecouldgathercontextabouthowapidocumentationwaswritten and maintained at google.
1with one exception for one interview s12 the header had no views in the past.
2oneinterviewwasheld2daysafterthesearcherhadmadethetransitionfromheader to implementation and four were held day after the transition.survey n questions api usage survey1 q1 whatbestdescribestheinformation you are looking for?
q2 whatwouldbethemostconvenient location for this information?
q3 what question are you trying to answer about this api?
e.g.
how this apibehaveswhenpassingindatesthat are in the past q4 what .cc files are you looking at?
implemented behavior survey778q1 from api usage survey and why are you looking into how a behaviorwas implemented?
youselected noneoftheabove .please describewhatyouaretryingtofindout by looking at the implementation.
table experience sampling surveys to collect developers questionsfor implementationcode.
we ran two main surveys to ask developers to describe the questions they had about code as they left header files to inspect implementation files.
theinterviewer didlive transcriptionwhile interviewingeach participant.
to validate these transcripts we recorded audio for all butthree participants.3for each of the interviews where audio was recorded the notes were replaced with a transcript of the full session audio.
we observed that the difference between the live transcriptionand the audio was minimal.
threatstovalidity developerswhooptedintothesearcherinterviewsmaynotberepresentativeof alldevelopers atgoogleor other institutions.
many interviewees had strong opinions which representedadiversityofviewpoints there sachancethatsome perspectives on the experience of finding answers in code vs. documentationwerenotrepresentedinthissample.furthermore the interviewswereaimedatfindinganti patternsindocumentation therearemanybenefitsofgettinginformationfromdocumentation that are not reported in our results.
.
code search experience sampling we instrumented the web based code search tool so that an experience sampling survey would pop up whenever a developer navigatedfroma .hfiletoa .ccfileinthesamedirectorywiththe same name.
either one of our surveys appeared in the lower right cornerofthecodesearchapp figure1 andcouldbeclosedifa developer did not want to answer the questions.
theaimofoursurveyswastounderstandwhatquestionsdevelopersaskwhentheyvisitimplementationcodetolearnaboutapis at the moment they left a header file.
we launched two variants of the same survey each designed to collect information about a different type of api question the api usage andimplemented behavior surveys.eachsurveyhadhundredsofrespondents.the design of the two surveys is summarized in table .
3due to technical issues audio for s1 s2 and s9 is missing.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
when not to comment icse may june3 gothenburg sweden theapiusagesurvey wasdesignedtoelicitthetypesofquestions developers asked when visiting implementation code.
we asked developers to choose one of seven reasons that best matched why they opened the implementation code.
these reasons were chosen based on prior work and the searcher interviews whatbest describes the information you are looking for?
how to use this api common cases how to use this api special cases who has been working on this code where i can make a change to the code performance non functional api details how a behavior was implemented noneof the above if a respondent selected one of the first two answers indicating that they were interested in learning about how to use the api we asked themwhere itwould havebeen mostconvenient tofind an answer to their question.
participants could choose from one of three options a .hfile a .ccfile and the project s g3doc.
we also asked what question developers were trying to answer in this case.
what would be the most convenient location for this information?
what question are you trying to answer about this api?
e.g.
how this api behaves when passing in dates that are in the past what .ccfile are you looking at?
the survey also asked respondents to enter the path of the .cc file since the survey tool could not collect this information.
wepilotedthesequestionswith246responses.inthepilot we asked q2 regardless of which options were selected for q1.
in addition thepilotrunoftheapisurveyincludedthequestion where would you expect to find this type of information?
with the same options.
however we dropped this question since the responses were essentially the same as answers to q2.
when piloting we useddifferentwordingforq3 whatinformationareyoutryingtogatherbyviewingthis .cc file?
butreceivedtoomanyresponses reporting implementation details .
theapiusagesurvey wasdeployedoveraperiodof3workdays.
afteradevelopercompletedthesurveyonce itwouldnotbeshown tothemagainuntilatleast5hourshadpassed.thesurveyreceived atotalof1 147responses outofwhatweexpectwasabout8 total prompts .
respondents were looking for information about apiusage.54ofthese60completedallfourquestionsinthesurvey all were looking at different source code files.
theimplemented behavior survey was designed to answer questions raised internally about what exactly respondents meant by how a behavior was implemented a response that a majority of respondents selected in the api usage survey.
using the first questionfromtheapiusagesurvey wescreenedrespondentsto just those asking a question about implemented behavior.
then we asked two additional questions whyareyoulookingintohowabehaviorwasimplemented?
understandingunexpected code behavior finding code or logic to reuse planning a code refactoring checkingspecific values e.g.
path name checkingstyle or best practices none of the above if none of the above selected .
you selected none of the above .
please describe what you are trying to find out by looking at the implementation theimplementedbehaviorsurvey wasdeployedoveraperiodof workdays.
after a developer completed the survey once it wouldnot be shown to them again until at least hours had passed.
the surveyreceived625responses.325respondentswerelookingfor how a behavior was implemented.
threatstovalidity intheapiusagesurvey somerespondents maynothavebeenlookingfor informationabouttheapidefined in the .hfile but rather to understand how to use an api called fromtheimplementationcode.thispossibilityismorelikelyfor sometypes of api questions than others for example questions about input types were likely about the api in the .h file.
as we discuss in the results question order could have also biased the responses so that we underestimate the percentage of questions that are about api usage patterns in the api usage survey.
.
maintainer interviews we interviewed the maintainers for a handful of internal apis m1...m8 tounderstandthemaintainers processandrationalefor writingand updating api documentation.
m1 m5 were maintainers of header files participants in the searcher interviews reported as missing api usage information.
it wasn t always straightforward to find an active and relevant maintainer for a file.
in two cases the person we initially contacted was arecentcontributortothefile butmadeonlyahandfulofcontributions and the document s original authors or main contributors hadleft thecompany or were out of the office.
m6 and m7 contributed to files containing api functions that code search users click extremely frequently.
we interpreted a large number of clicks on a function as an indication that some information about the method was missing.
before contacting the maintainers weinspectedtheheadersandverifiedthatsomeimportant information was likely missing from the comments.
m8 was a maintainer of a widely used internal api updating the documentation as part of an open sourcing effort.
one interviewer conducted all eight interviews see questions api maintainer .
for m1 m5 we described questions that searchershadabouttheapi askedwhetherthequestionwasansweredintheheader andifitwasnot whetheritshouldbe and wheretheanswershouldappear.wealsoaskediftheyweresurprisedthatadeveloperwasusingtheirapiinthisway.allmaintainers m1 m8 wereaskedtodescribetheirprocessofdeciding whatgoes intotheproject sdocumentation.
theinterviewertook notesduringeachinterviewandtranscribedtheaudiorecording from each one.
interviews typically lasted minutes.
threatstovalidity aswiththesearcherinterviews maintainers who opted to answer questions about their process could have systematically stronger or different opinions about what belongs in documentation than those who did not opt in these results should be seen as representing an important but perhaps not comprehensive set of maintainer perspectives.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
when notto comment icse may27 june gothenburg sweden api usage question sampleresponses .h .cc g3doc n input values how a given argument behaves when it s empty what does the arguments mean exactly i m trying to figure out how the flags are used how what method to use to convert the current timestamp into a string return values what does the return value mean and how can this method fail recommended use sampleuse cases of this api how to properly update deprecated functions to use this api hidden contracts ifi need to do a special tear down in order not to leak memory implementationdetails how this api passes data to tensorflow session run calls in c side effects what logs it writes or status messages it returns when it finishes reading the file extensionpoints whetheri should need to override this method in my subclass verify inconsistency why the service in the proto says one thing but the code does something else and if i can file a fix to correct that total table nine api usage questions developers asked when looking up implementation code and where they wanted to find theanswers.
foreachquestion wereporthowmanyrespondenthadthatquestion n andhowmanythoughtitwouldbemostconvenient to find an answer in a header file .h implementation code .cc or the projects g3doc g3doc .
respondents often reported it would be most convenient to find answers in .hfiles even for implementation specific questions like those about hidden contracts and side effects.
run calls in c and side effects what logs it writes or status messagesitreturnswhenitfinishesreadingthefiles .respondentsstill sometimes thought it would be most convenient to find answers to such questions in headers.
.
.
questions about how a behavior is implemented.
in the implemented behavior survey when respondents were looking for information about how a behavior was implemented the majority of respondents were finding code or logic to reuse .
or understandingunexpectedcodebehavior .
.whileitisexpected thatdevelopersneedtoconsultimplementationcodewhenlooking for code to reuse perhaps some unexpected code behaviors should have been documented in these headers.
.
seeking answers in code vs. documentation survey respondents frequently reported it would be most convenienttofindanswersquestionsaboutapiusageinheaders.however developers we interviewed in the searcher interviews indicated they sometimes preferred to find answers in implementation code which could be more accurate and quick enough to read.
.
.
convenientlocationstofindanswers.
intheapiusage survey .
of the respondents looking for api usage information believed that the information they were looking for would have been most convenient to find in a .h file.
this included .
ofrespondentslookingforinformationaboutcommonusage and .
looking for information about special case usage.
of the six interviewees in the searcher interviews looking for api usage information fourreportedthatitwouldhavebeenconvenienttofind that information in a header file.
survey respondents were morelikelytowanttofindanswersin .hfilesforapi relatedquestionsthanotherquestions whenpilotingtheapiusagesurveywe asked all respondents not just respondents looking for api usage information wheretheywantedtofindtheanswertotheirquestion.
only .
of the pilot respondents that weren t looking for api usage information thought the header file would be the most convenient place to find the answer to their question.
however header files weren t always reported as the most convenientplacetofindanswersaboutapis.foreachtypeofquestion at least one developer always thought it would be most convenienttofindananswerinimplementationcodeorg3doc.theproportion of respondents who preferred each location varied somewhat by question seetherightmostcolumnsoftable2 .forexample inline with our expectations that questions about discovering functionalityandrecommendedusagebelonginhigh leveldocumentation g3doc was a preferred medium for some of these questions.
.
.
rationale for seeking answers in code vs. documentation.
thepotentialbenefitsdeveloperscouldhavereapedfromimproved commentsvariedbasedonthecodethatthedeveloperwaslooking at and the question they had.
we distilled a set of themes from the searcherinterviewsdescribingwhysomedevelopersexpectedor preferredtofindinformationaboutapisinimplementationcode as compared with comments in a header file figure .
correctness and completeness.
because it is what the computer will execute s4 developers could count on source code as an accurate representation of that code s behavior.
some interviewees distrusted code comments in general.
in the words of s2 to a first orderapproximation ihavestoppedreadingcomments because authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may27 june gothenburg sweden andrew head caitlin sadowski emerson murphy hill and andrea knight pros for referencing code sometimes quick to read always accurate all accessible from code search o ers implementation choices hidden by public api answers can be in a di erent le than where you expect it sometimes complicated to comprehend generated code will be very di cult to understandcons for referencing code pros for referencing docs typically of good enough quality for popular internal apis handy for understanding recommended usagecons for referencing docs can be inaccurate untrustworthy or missing fragmented i.e.
across .h les g3doc external sites figure4 whylookatimplementationcodevs.headercomments?developersinthesearcherinterviewsdescribedwhenthey would look for answers to api usage questions in api documentation or implementation code.
thecommentsarejustlies.myeyeshavejustlearnedtoskipthem.
it was clearwhy some developers experiencescould lead them to distrustdocumentation oneoftherespondentstotheapiusage survey reported that they were visiting the implementation to clarify an inconsistency between documentation and behavior.
however incorrect or incomplete documentation wasn t universal.severalintervieweesmade adistinctionbetweenwidely used internalapis andprojectswrittenbyteammatesandcollaborators so there s those sorts of and those tend to be verywelldocumented.andthenthere stheteam specificinternal code which is all very horribly documented.
and it s relatively rare for me to find something where i don t personally know the person who wrote it but it s also missing documentation s16 distrustofdocumentationcouldleadtounnecessarysearches s6 visited the implementation to check for unexpected behavior when it was actually documented properly but i didn t believe it.
intendedvs.actualfunctionality.
sourcecodecanrevealundocumentedbehaviorthatcanbeusefulforprototyping.s10studied howcode actuallyworks whiledevelopinginitial messycode .
oncetheyfiguredout howtomakeitwork thentheytried to make it clean before i send it off for review by adjusting the code to respect how the api was documented to work.
cost of finding information.
sometimes a developer could get ananswertoaquestionaboutanapiprettyquicklybyjustreading code.
for s1 and s14 this only involved looking through a fewdozenlinesofcodeoverafewmethods.toolingalsoplaysa role in reducing the cost of code navigation with the code search tool much of the code is indexed in one place with clickable crossreferences between types and functions.
because of this it may be morestraightforwardtonavigatecodethanlookingfordocumentation which could be fragmented across multiple web locations and breakone s flowofthought s4 .however sometimesitwasinfeasibletogleanananswertoanapiusagequestionfromthecode.
s9 and s11 searched through multiple functions in multiple files.
s9eventuallygaveupbecausethecodebecametoocomplicated.in thesecases awell writtencommentintherightplacecouldhavetheme examples minimal explanations no need to explain readable signatures readersmayhavesufficientprior knowledge adding details could clutter the docs nottheright time never maintained won t be maintained concentrating on evolving or fixing the code good enough documentation already exists for similarexternal projects preservation should preserve existing comment style writing comments that are unlikely to rot table why not update documentation?
themes and samples of these themes of why and how maintainers might choose to update the documentation for their apis.
saved time.
there are also some types of code like generated code whichwill alwaysbe difficult to read s5 .
.
factors impacting whether maintainers will update comments whenpresentedwithquestionssearchersaskedabouttheirapis most maintainers weren t surprised that searchers were asking such questions.
however maintainers were sometimes reluctant to updateapi commentsto answerthese questions.reluctance to createandupdatedocumentationhasbeenobservedintheliterature .theseinterviewsprovidecontextbehindwhyproposing andincorporatingupdatestoapi levelcommentscouldbedifficult.
we developed three themes from analyzing maintainer interview transcripts and also report on the factors influencing past choicesto change and add to documentation.
.
.
keeping explanations minimal.
this fundamental tension wasdescribedbym1whotoldus whenaskediftheyshouldadd a comment to answer s9 s question how often do you want to go into details which can be easily too much?
m8 was just as interestedinfindingoutiftheirapihad toomuchdocumentation as whether the comments had the right content.
maintainersassumedthatsometimes apiclientscaninferusage protocolfromanapi sdeclaration.m8describedhowthesemantics of a function could be inferred for an api for formatting time sojustfromlookingatthat rightthere ibelievemost callers would infer that it takes three arguments a time and a time zone and it takes some format that tells it how to format thetime and it returns the value as a string.
m however it is clear is that in practice not all methods in the googlecodebaseareself explanatory.m8alsodescribedapopularapimethod writtenasacomplextemplateinc toreplace dozens of other methods with related functionality but distinct signatures.
m8 stressed the importance of comments for this method suggesting thatit couldtake someonehalf anhour tounderstand the code without documentation.
for one maintainer explicit functionality marked the boundary between what deserved to be described in comments and what authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
when notto comment icse may27 june gothenburg sweden didn t. m2 quoted knuth s programming aphorism premature optimizationistherootofallevil todescribehowadeveloper s main concern when using an api will be with writing code that does the right thing rather than non functional aspects like performancecharacteristics.forsuchnon functionalaspects clients shouldalreadyhavetherequisitebackgroundknowledgetosuccessfullyselectandusetheapi.m2expectedclientsofaconcurrency api to understand in what contexts they should use threads vs. futures.
m5 did not believe it was relevant to describe the runtime of standard algorithms or data structures like maps.
takentoanextreme thecontentsofcommentscouldindicate who shouldbe usingthe api.m2 worried thatif high level guidance like performance characteristics of threads and futures was available somedevelopersmightmisinterpretthisinformation and be compelled to use it incorrectly or not at all it sstillgoingtohavepeoplethatarenotexpertstryingtofollow and if you say something is slow you ll get people writing alternativesfirstofall ornotusingit or arbitrarilysaying oh no you shouldn t use that just because they if they re not an expert alltheyknowiswhatthey vereadinthatbriefcomment.
m .
.
it s notthe righttime todocument.
in acode basewith millions of lines of code developers may find apis that were never beintendedtobewidely used andcontinuetouseusethemlong aftertheauthorsofthatapihavemovedontootherprojects.logistically thismadeitdifficultforustogetincontactwithmaintainers of apis mentioned in the searcher interviews.
contributions from core contributors could be years old and some contributors had even moved on to other companies.
m3toldustheyweren tsurprisedthatsearcherslikes14were findingandusinganapitheyhadoncecontributedto.however the api wasn t for use by other teams and the team had moved on to other projects.
m3 had no intention and believed no one else had any intention to further update the code or comments it s unlikely this will ever get changed again.
they re going to deletetheunderlyingdataandthen hopefullysomeonewillclean up this utility i guess ostensibly it s my team that s responsible for it but...if you didn t schedule this meeting i would have forgottenthis fileexisted.
m evenforanapiwithalotofdevelopmentattentionandanactive clientele maintainers could have good reason not to add or update comments.
when informed of a searcher s question m4 and m5 toldusthatitwasn ttherighttimetodocument.theirprojectwas a re implementation of a standard c library with quite a few earlyadopters.
m4tolduscurrentdevelopmenteffortwasgoingto gointoimprovingcompilererrormessagesandfixingperformance bugs.
another complication was that as a re implementation of an externally available library documentation already existed however thisdocumentationwasnotaccessiblewithincodesearch.
for m5 writing documentation in the header files would not only be redundant it could cause maintenance issues later on ...recapitulating the entire documentation for here is just not a good choice.
it duplicates a lot of things it lets them fall out of date weirdly... also is better cross linked than the documentation in the header.
m .
.
preferenceandpreservation.
mostsearchersandmaintainersweinterviewedhadopinionsaboutwhat didbelongindocumentation atboththelevelofheadersandin linecomments.
maintainers andsearchersmentionedtheimportanceofdescribinghowafile relatestootherfilesintheproject s17 thestateoftheworldwhen amethodiscalled s8 executableexamples m5 m8 implementation comments for future maintainers of an api m5 explicit linkstoexternaldocumentation m5 semanticsofafunction m8 mainconceptsthatsomeoneshouldunderstandandknowtouse the api m8 what the code is and why at a statement level m6 and even a proof of correctness m6 .
it is unsurprising that not all of this information was available for all of the apis we saw duringthis study.
choices to include or update documentation could also be based on preserving existing style and writing comments that can stand thetestoftime.m6preservedthestyleandplacementofexisting comments when makinga one off contribution to a common c utility method.
m6 also noted the brittleness of concrete performance descriptions describingone such inline comment ... ithadthesenumbers likespecificnumbers speedup 25x speedup things like that which are like naturally out of date you know?
they were for a machine in or something like that like a particular machine.
they re surely not correct today you know what i mean?
m to resist rot m6 replaced this description with a proof that would hold even as computing infrastructure changed.
.
.
factors influencing changes to api documentation.
m2 aptly described the somewhat solitary nature by which comments were often written and updated when they told us ... it was mostly just me a little bit of feedback from code reviewers when i was you know initially checking this in on what needed to be documented and what didn t. m while changes to documentation could be on the whole infrequent maintainersmentionedseveralcasesinwhichtheymight updatedocumentation.themostobviouspathwasthroughroutine development workflows by getting feedback from code reviewers m8 s14 or cleaning up comments while refactoring or updating existingcode m6 m8 s19 .beyondtypicaldevelopmentprocess some maintainers also told us they had considered though did not alwaysaccept suggestionsraisedthroughcompanyemailandchat m1 m7 and questions raised on mailing lists m4 as potential indicationsof usage that should be better explained.
discussion in thisstudy we foundthat a minority ofvisits to c implementation code were for questions about api usage some of which areconventionallycoveredindocumentationandothersthatare not.surveyrespondentsreporteditwouldbemostconvenientto find answers to many of these questions in header files though interviewees indicatedcode couldbeaccurate andquickenough to readinmanycases.maintainershadreasontobereticenttoupdate documentation in response to some of these questions.
what do these results as a whole imply for maintainers and researchers?
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may june3 gothenburg sweden andrew head caitlin sadowski emerson murphy hill and andrea knight .
implications .
.
contributing to a conceptual framework of documentation.dagenais and robillard describe documentation process as comprising initial effort incremental changes and bursts with decisionpointsthroughout .foroursampleofapis incremental changes and bursts were not frequent events.
among others factors maintainers attitudestowardupdatingdocumentationwere impactedbyfactors includingwhethertheapiothers wereusing wassomethingtheyshouldbeusing keepingexplanationsminimal fortheintendedaudience andtheavailabilityofdocumentationfor comparable apis.
our conversations with searchers also suggested additionalfactors thatshould be considered should you document for the unexpected client?
what happens whentheinternalutilityyouforgotaboutgetsinvokedbydevelopers across the ocean as an api?
this was the case for one of the maintainers we interviewed.
at a company with globally visible sourcecode it spossibleanyfilecouldbecomeatemplateorapi foranotherdeveloper scode.whoshouldbewatchingthatcode and documentation when the team working on it moves on?
whenisn tcodeenoughtobeself documenting?
sometimes developers had no problem reading code and in fact preferred it for finding more accurate information.
however there are some caseswhereself documentationisn tfeasible likecodewithoverly complex method signatures and generated code.
other details like recommended usage just can t be conveyed by source code.
which implementation details belong in docs?
while documentationstandardslikejavadocsuggestthatthebehavior i.e.input and output of apis functions should be documented our study showedthatdevelopershadquestionsaboutimplementationthat didn t get answered in the headers including some questions that would be most conveniently answered in headers.
however this type of information appears infrequently in reference documentation .
it s clear that it s not the best choice to break the abstractionofanapitodiscussinternalsthatareobviousfromthe code which ones should be documented?
.
.
implicationsformaintainers.
oneactionableresultofthis studyisconfirmingtheexistenceofunansweredapiquestionsin authentic programming settings beyond input output specification e.g.
sideeffects .however thisstudyquestionssomeassumptions aboutwhatbelongsindocumentation.theresultssuggestmaintainers can answer questions with discoverable understandable code instead of comments.
if code is self explanatory it may be sufficienttoanswersearchers questions especiallyifthesearchers areexperiencedinnavigatingcodeforanswers.however codeis no substitute for high level information or when it is very complicated to read.
furthermore many surveyed developers felt some salientimplementationdetailsshouldbesurfacedinheaders.updatestodocumentationshouldheedadiversityofuserquestions and code vs documentation expectations we observed.
.
.
implications for tool builders.
this study presents a diversity of questions whose answers could be surfaced beyond just function signatures and even including implementation choices.
tools for editing and navigating implementation code may benefit from helping developers find answers to these uestions quickly.this study also shows the messiness of proposing updates to documentation.
the ideal time to propose changes to documentation is duringcodeauthoringandreview possiblythroughasurrogatelike a code reviewer.
documentation can get updated only infrequently after it is initially written as future updates may raise questions of whether the informationadds clutter or redundancy.
.
results in context whilethisstudywasconductedatasoftwareengineeringcompany withbillionsoflinesofcodeanddedicatedcodesearchtools we expect our observations apply elsewhere whenever implementationcodeissearchable.
atgoogle therearededicated toolsto supportlooking upimplementation code.for apiswhere source code is less accessible developers probably won t ask the samequestionsofimplementationcode orhavethesamepreferences of where they find answers.
many professional and open sourceprojectsrelyonbothamixoflocalapisforwhichsource code is readily available and external apis for which it isn t. developers search the source code.
perhaps because of mature searchtools googledevelopersfrequentlysearchcodewhenasking questions about code .
developers willingness to reference codelikelyvariesbycompanyorproject.however wenotethat professionaldevelopers willingnesstoreadcodeovercomments hasbeen observed in several other research settings .
implementation code and documentation are separated.
for other languages code and documentation may not be in separate files e.g.
javadoc .whileonecouldn treplicateourmethodologyfor such languages we expect there would be overlap in the questions developersask.specificinstancesofquestionsandfrequencymight changefor otherlanguages forexample a pythondeveloper may ask questions about side effects though likely not the question about memory leaks one survey respondent reported.
some apisare unstable.
thisstudyconsidersapis from widelyusedutilitiestoteam specificlibrariesusedbyahandfulofdevelopers.
developers likely rely more on documentation for stable apis where more effort has been put into documentation.
conclusion in this mixed methods study we collected a cross section of developer questions about api usage and api maintainers attitudes about updating documentation in response to these questions.
reflectingontheresultingsetofquestionsaboutapis andcontextual factors that influenced maintainer attitudes on updating documentation ourobservationsprovideanewsetofquestionsmaintainers and tool developers should consider in the pursuit of improving low level documentation for apis.