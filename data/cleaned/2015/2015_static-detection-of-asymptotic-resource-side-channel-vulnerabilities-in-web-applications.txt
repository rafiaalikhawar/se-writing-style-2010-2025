static detection of asymptotic resource side channel vulnerabilities in web applications jia chen oswaldo olivo isil dillig calvin lin the university of texas at austin united states jchen cs.utexas.edu oswaldo.l.olivo gmail.com isil lin cs.utexas.edu abstract web applications can leak confidential user information due to the presence of unintended side channel vulnerabilities in code.
one particularly subtle class of side channel vulner abilities arises due to resource usage imbalances along different execution paths of a program.
such side channel vulnerabilities are especially severe if the resource usage imbalance is asymptotic.
this paper formalizes the notion of asymptotic resource sidechannels and presents a lightweight static analysis algorithm for automatically detecting them.
based on these ideas we have developed a tool called s canner that detects resource related side channel vulnerabilities in php applications.
scanner has found zero day security vulnerabilities in different webapplications and reports only false positives.
the vulnerabilitiesuncovered by s canner can be exploited using cross site search attacks to extract various kinds of confidential information suchas a user s medications or purchase history.
i. i ntroduction web applications have become enormously popular due to the ubiquity of the internet and the existence of rich development frameworks.
hence in today s internet rich world most people perform their daily activities including bankingand e commerce using web applications.
unfortunately thisgrowing popularity of privacy sensitive applications has also led to a surge of illegal activities by hackers trying to steal confidential data.
to secure private data web applications currently rely on a combination of network level security mechanisms such asencryption and firewalls as well as application level protection techniques e.g.
credential checks and session handling .
while these mechanisms provide some degree of privacyassurance they do not prevent the application from leakingconfidential data through unintended communication channels known as side channels.
many side channel leaks in web applications are related to resource usage e.g.
time or space .
as an example considera health related web application whose response time variessignificantly depending on whether the user is taking a certainmedication.
in this case the server response time can revealconfidential information about the ailments of specific users.for instance recent work has shown that timing andresponse size side channel vulnerabilities can be exploitedusing cross site search attacks in which the attacker submits a cross site query with the user s credentials and observes thetime it takes for the browser to respond to the query.
the large bulk of existing side channel attacks usually against codes that carry out cryptographical computation exploit minor imbalances in resource usage .
such attacks rely on the assumption that the attacker is able to precisely measure the time it takes to execute simple nativeoperations like integer comparison on the target machine.however despite recent advances in statistical measurementtechniques minor differences in resource usage are dif ficult to observe in web oriented settings.
on the other hand if the attacker is given the ability to amplify the imbalance in resource usage then the vulnerability becomes much easier toexploit.
for example consider an application whose responsesize is constant if the answer to a security sensitive queryis negative but linear in the size of the input otherwise.
inthis case an attacker can observe a substantial difference inresponse size by supplying a sufficiently large input to theapplication.
we refer to such vulnerabilities that exhibit anasymptotic difference in resource usage as asymptotic resource side channel vulnerabilities.
in this paper we introduce and formalize asymptotic resource side channels a class of vulnerabilities that can be ex ploited in settings where the attacker cannot precisely measureresource usage e.g.
web applications .
to help developerssafeguard their applications against such vulnerabilities wealso present a novel static analysis for automatically detectingasymptotic side channels.
our analysis employs a lightweight program abstraction that combines taint information with a coarse summary of resource usage.
in particular our analysisdifferentiates between variables that are untainted secret tainted and user tainted and summarizes the resource usageof each code fragment as zero constant or unbounded.
thekey idea underlying our analysis is to identify branch conditions that are secret tainted and where the resource usage is unbounded along one branch but not the other.
as we showexperimentally our proposed program abstraction is effectiveat detecting asymptotic side channel vulnerabilities with a lowfalse positive rate and can uncover exploitable vulnerabilitiesin real world web applications.
we have implemented our proposed static analysis in a tool called s canner1for analyzing php applications.
while the techniques we describe in this paper can be used to detectany resource related asymptotic side channel vulnerability ourimplementation focuses on two kinds of resources namely time and response size .
in addition to pinpointing vulnerable components s canner further aids security analysts by iden1scanner stands for side channel analyzer .
c circlecopyrt2017 ieeease urbana champaign il usa t echnical research229 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
tifying confidential database fields that may be leaked due to the detected vulnerability.
furthermore s canner helps users assess the severity of the uncovered vulnerability by semi automatically generating a javascript exploit that performs across site search attack.
we evaluate s canner on open source php applications and show that it uncovers side channel vulnerabilities and reports only false positives.
furthermore we are able to exploit these vulnerabilities using cross site search attacks andshow that the attacker can extract various kinds of confidentialdata such as a user s purchase history medical records and bids placed by the user.
we have reported the vulnerabilitiesto the developers and many of them have been fixed by thedevelopers at the time of this submission.
ii.
f ormalization of asymptotic resource side channels in this section we formally define the class of side channel vulnerabilities studied in this paper and justify our decision tofocus on this subclass.
definition resource side channel vulnerabilities let h ldenote high and low inputs of a program respectively and letr p i denote the resource usage of program pon inputi.
we say that program phas a resource side channel vulnerability if h1 h2 l. r p h1 l negationslash rp h2 l the above definition above is effectively an instantiation of the well known non interference policy with respect to resource usage2as in traditional non interference terminology high variables represent secret values while low variables denote values that are not security sensitive.
hence accordingto the above definition a resource side channel vulnerabilityarises if it is possible to observe different resource usageswhen program pis run on the same low input but different high inputs.
hence an adversary can glean information aboutthe secret simply by observing the program s resource usage.
since definition does not specify the kind of resource it is quite general and can be instantiated in a variety of ways to yield different classes of side channel vulnerabilitiespreviously discussed in the literature.
for instance if theresource of interest is cpu cycles then this vulnerabilitycorresponds to a timing side channel.
on the other hand if we instantiate r pwith power consumption then the vulnerability could be exploited to cause a power monitoring attack.
however since non interference is a very strong condition that is violated by almost any program we believe that such an approach is not practical.
for instance consider a program thathas a very minor resource imbalance e.g.
a few cpu cycles across two different execution paths.
while such a program hasa resource side channel vulnerability according to definition 2while the term non interference was originally coined by goguen and meseguer our definition follows the one adopted by the language based security community .it is very unlikely to be exploitable because an attacker cannot reliably observe this minor imbalance in resource usage.
motivated by the observation that standard non interference is too strong of a policy to reason about exploitable resource side channels we instead focus our attention on asymptotic resource side channels which can be reliably exploited by attackers definition asymptotic resource side channel vulnerabilities lethdenote the high inputs of a program and let rp i denote the resource usage of program pon inputi.w e say that program phas an asymptotic resource side channel vulnerability if h1 h2.r p h1 negationslash rp h2 in this definition observe that the low inputs are unconstrained so rp h1 andrp h2 are both functions of low inputsl.
thus this definition states that it is possible to find a pair of secrets h1andh2for which the resource usage of p will be asymptotically different with respect to the low inputs.since the attacker can control the program s low inputs hecan easily tell whether the secret is h 1orh2by running the program on arbitrarily large values of the low input.
observe that every asymptotic resource side channel vulnerability also satisfies definition but not vice versa.
weillustrate the differences between definitions and usingthe following two examples.
example consider the following code snippet foo int n if secret for inti i n i consume else consume letconsume x be a statement that consumes xunits of resource.
if the value of secret istrue then the resource usage of foo isn.
on the other hand if secret isfalse then the resource usage is .
since n negationslash this program contains an asymptotic side channel vulnerability according to definition .
example consider the following code snippet bar int n if secret consume else consume here function bar contains a vulnerability according to definition because the resource usage of the program differsdepending on whether secret is true or false.
however this function does not exhibit an asymptotic vulnerability because r p h1 andrp h2 only differ by a constant.
this second example illustrates why we choose to focus on the subclass of vulnerabilities given by definition asopposed to definition because the difference in resource 3in fact even if we restrict ourselves to resource heavy operations such as database queries definition still seems to be too strong in practice.
to justify this claim we implemented an analysis that reports all instances of definition for resource heavy operations specifically database queries .even under this restrictive scenario the analysis reported warnings for the php applications used in our evaluation.
our timing measurements for a subset of these reports reveal that the overwhelming majority of the warnings are not exploitable under realistic database states because there is significant overlap between timing measurements for positive and negative queries .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
usage is very small in example it is in practice quite hard to exploit this imbalance due to various kinds of noisein the program s execution environment e.g.
network traffic .hence our approach deliberately targets vulnerabilities thatcan be amplified by the attacker through carefully craftedinputs.
in fact previous work has argued that one of thetools for exploiting side channel vulnerabilities is to amplify the side channel by inflating communication or computation .
this trick only works if the program contains an asymptotic imbalance in resource usage rather than a constant difference.
unfortunately in practice it is still difficult to statically reason about worst case resource usage and existing techniquesfor reasoning about complexity typically do not scale to largeprograms .
hence to analyze realistic webapplications with a low false positive rate we further restrictour attention to the following subclass of asymptotic side channel vulnerabilities that can be detected using lightweightstatic analysis definition constant superconstant resource sidechannel vulnerabilities leth ldenote the high and low inputs of a program and let r p i represent the resource usage of program pon input i. program phas a constantsuperconstant resource side channel vulnerability if h1 h2.r p h1 o rp h2 negationslash o in other words we are interested in detecting a subclass of asymptotic side channel vulnerabilities where the resourceusage is constant for some values of the secret but a function oflfor other values of the secret.
note that in this definition r p h2 negationslash o implies that the resource usage is a nonconstant function of lwhen the high inputs are fixed to h2.
our detection algorithm targets this specific subclass of vulnerabilities because it is possible to find instances ofdefinition in a practical way without requiring heavy weightresource usage analysis.
iii.
s tatic detection of asymptotic resource side channel vulnerabilities we now turn our attention to the static analysis algorithm for detecting asymptotic i.e.
constant superconstant vulnera bilities.
we first explain the key ideas underlying our algorithmand then provide a more formal description of the analysis.
a. key ideas the key idea underlying our static analysis is to look for two different paths 2in the program such that 1 2satisfy the following conditions paths 1 2differ on the value of the secret resource usage of 1is a function of low input l resource usage of 2isnotdependent on l to see how these conditions relate to definition observe that condition partitions the high inputs into two disjoint classesh1 h2such that h1 h1satisfies the predicates on path 1 whileh2 h2satisfies the predicates in path 2. furthermore condition states that h2 h2.r p h2 negationslash o while condition ensures h1 h1.rp h1 o .expression e c v e1 e ... condition c e1 e2 c c1 c2 c1 c2 statement s consume e source v label v e s1 s2 c?s1 s2 while c do s fig.
.
language used for describing our analysis our static analysis combines two kinds of taint information namely secret taint and input taint with a coarse summary of resource usage for each program fragment.
input taintinformation is used to summarize the resource usage of eachcode snippet as zero constant or potentially infinite wherethe last value indicates that resource usage is controlled bythe attacker.
in contrast secret taint information is used todetermine if two program paths differ with respect to someconfidential data.
combining these two crucial pieces of infor mation our analysis reports an error if it encounters a secret tainted condition such that the resource usage is potentiallyinfinite along one branch but not in the other.
example consider again the code from example which contains an if statement whose branch condition is secret tainted.
the resource usage in the else branch is constantand does not depend on user input.
on the other hand theresource usage in the then branch can be made arbitrarilylarge because the loop bound nisinput tainted.
since the resource usage inside the loop body is non zero and the loopbound is input tainted we summarize the resource usage ofthe then branch as potentially infinite.
the analysis reportsa potential vulnerability for this example because there is asecret tainted branch condition where the resource usage ispotentially infinite along one branch but not the other.
b. f ormal description of static analysis we formally describe our algorithm on the simplified imperative programming language shown in figure .
in addition to the standard assignment v e sequencing s s2 conditional c ?s1 s2 and looping constructs this language also contains the following statements that model resource consumption and taint introduction resource consumption the statement consume e models the consumption of eunits of resource where eis an integer expression.
for example if the resource of interest is memory then each memory allocation can be modeledusing a consume statement in our language.
taint introduction the statement source v label models the tainting of variable vwith label label.
where label is eitherh for high or l for low .
for instance source v h indicates that variable vis assigned to a secret value.
in practice taint sources with label hmodel database queries that retrieve security sensitive data e.g.
password .
on theother hand taint sources with label lrepresent operations that accept some input from the user.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
turnstileleftc turnstileleftv v turnstilelefte1 1 turnstilelefte2 2 turnstilelefte1 e2 1 unionsq 2 fig.
.
rules for determining taint values of expressions e as mentioned earlier in section iii a our static analysis combines two different program abstractions to effectively detect asymptotic resource side channel vulnerabilities taint abstraction each variable has a taint value drawn from the domain t l h latticetop where denotes lack of taint l hrepresent input and secret taint respectively and latticetoprepresents both input and secret taint.
we impose the partial order subsetsqequalh l subsetsqequal latticetop .
resource abstraction we summarize the resource usage of each program fragment as a value drawn from the set r where0indicates no resource usage indicates constant but not necessarily unit resource usage and indicates that the resource usage cannot be statically bounded i.e.
because it is controlled by the user .
we definea operation on elements of set r as follows x r.x x r.x negationslash x x r.x x we also define a total order followson setras follows1 follows0.
finally given 2 r we write 1 greatermuch 2if 1 and 1 follows 2. using these program abstractions we can describe our analysis using rules of the form turnstilelefts prime where taint environments primemap program variables to a taint value l h latticetop summarizes resource usage of statement s is a boolean value indicating whether or not a vulnerability is present in s hence the meaning of the judgment turnstilelefts prime is if we execute statement sin an environment that satisfies then the resource usage of sis given by and the taint environment after sis prime.
furthermore if is true then smay contain an asymptotic resource side channel vulnerability .
we describe our static analysis using the inference rules shown in figures and .
first the helper rules fromfigure and figure allow us to determine the taint value for each expression eand predicate cunder taint environment .
according to the rules in figure constants are not tainted and the taint value for each variable vis given by .f o r composite expressions of the form e e2 the taint value is given by the join of the values of e1ande2.
for instance ife1has taint hande2has taint then the taint value ife1 e2ish unionsq h. the rules for determining taint value of predicates are similar to those for expressions and are shown in figure .
turnstilelefte1 1 turnstilelefte2 2 turnstilelefte1 e2 1 unionsq 2 turnstileleftc turnstileleft c turnstileleftc1 1 turnstileleftc2 2op turnstileleftc1opc2 1 unionsq 2 fig.
.
rules for determining taint values of predicates c let us now consider the main analysis rules presented in figure .
here rule describes the analysis of a taint source of the form source v label .
in this case the new taint environment primeis obtained from by updating the taint value ofvtolabel.
rule describes the analysis of consume e statements that model resource usage.
recall that resource usage isdefined to be if expression ecan be made arbitrarily large by an attacker.
hence we first use the helper judgments from figure to determine the taint value ofe.i f l then the resource usage of this statement is but constant otherwise.
rule describes taint propagation for assignments of the formv e. as before we use the helper rules from figure to determine the taint value ofeand update the taint environment by assigning vto .
rule shows how we analyze sequence statements s s2.
observe that the resource usage of this statement is obtained by adding the resource usage 1ofs1and 2ofs2using the operation defined earlier.
furthermore s1 s2contains a vulnerability if either s1ors2has a vulnerability hence we take the disjunction of 1and 2. rule for conditionals is a bit more involved.
recall that c?s1 s2exhibits a side channel vulnerability if cdepends on the secret and s1ands2have different resource usages.
hence to determine if there is a vulnerability we first check the taint value ofcusing figure .
clearly if negationslash supersetsqequalh the statement does not introduce a vulnerability hence false under this scenario.
on the other hand if cis secret dependent i.e.
supersetsqequalh then an asymptotic side channel vulnerability arises if the resource usage iis in one branch but constant or zero in the other branch.
hence istrue if 1 greatermuch 2or 2 greatermuch 1 but it is false otherwise.
continuing with rule let us consider the taint values after analyzing c?s1 s2under .
if the taint environment aftersiis given by i then the value of each variable v afterc?s1 s2is given by 1 v unionsq 2 v .
hence the join operation 1 unionsq 2on taint environments takes the pairwise join for each variable.
finally let us consider the resource usage of the statement c?s1 s2 where the resource usage of each siis given by i. sinces1ands2cannot execute at the same time the resource usage of c?s1 s2ismax 2 which is in fact the same as 1 2. the final rule in figure describes the analysis of loops.
first the assumption turnstilelefts at the second line of rule authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
prime turnstileleftsource v label prime false turnstilelefte braceleftbigg if supersetsqequall otherwise turnstileleftconsume e false turnstilelefte turnstileleftv e false turnstilelefts1 1 1 1 1 turnstilelefts2 2 2 2 turnstilelefts1 s2 2 1 2 1 2 turnstileleftc turnstilelefts1 1 1 1 turnstilelefts2 2 2 2 braceleftbigg i greatermuch j i f supersetsqequalh false otherwise turnstileleft c?s1 s2 unionsq 2 1 2 1 2 turnstileleftc turnstilelefts prime if follows0 supersetsqequall if negationslash supersetsqequall otherwise turnstileleftwhile c do s prime supersetsqequalh prime fig.
.
rules describing our static analysis states that taint environment is a fixed point hence the taint environment after the loop is also .
now let us consider the resource usage of the loop while c dos.
clearly if the resource usage of the body sis resp.
then the resource usage of the loop is also resp.
.
however if the resource usage of sis constant i.e.
then the resource usage of the loop depends on the taint value of predicate c.i n particular if supersetsqequall then the number of loop executions can be controlled by the attacker causing the resource usage to be statically unbounded.
hence if resource usage primeof the loop is if supersetsqequall but prime otherwise.
the last issue to consider in the loop rule is whether there is a vulnerability.
first observe that the loop may have avulnerability if the loop continuation condition cis secretdependent.
in particular if cdepends on a secret the attacker might be able to learn the secret by observing the number oftimes the loop executes which in turn can be inferred fromthe program s resource usage.
to understand whether the loopintroduces a vulnerability observe that while c doscan be rewritten as c?
s while c dos skip.
clearly the resource usage of the else branch is and since prime followsequal the resource usage of the then branch is precisely prime prime.
thus the loop has a vulnerability if supersetsqequalh and prime .
iv .
d esign and implementation of scanner a.scanner basics scanner analyzes php applications and detects two specific kinds of vulnerabilities involving time and responsesize.
specifically timing side channel vulnerabilities allow detection modulediagnosticmodule exploitgeneratorleaked database attributes javascript exploitscanner fig.
.
workflow of the s canner tool the attacker to infer confidential data by observing server response times.
in contrast response size side channels enable the attacker to glean secret information by observing the size of the response.
the workflow of the s canner tool is shown in figure .
internally the s canner tool consists of three different modules that perform complementary tasks the detection module performs static analysis to flag potential asymptotic timing and response size side channelvulnerabilities.
in essence this module implements an in stantiation of the algorithm described from section iii fortwo specific resource types.
the error diagnostic module performs additional static analysis to report descriptive warnings.
in particular this module identifies confidential database fields that may be leaked by the application due to the uncovered vulnerabilities.
the exploit generation module performs backwards symbolic execution to semi automatically generate a javascriptprogram that can be used to exploit the uncovered vulnera bility using a cross site search attack.
s canner is itself written in php and consists of lines of code.
our implementation uses the z3 smt solver to solve the constraints collected during its symbolic executionphase for semi automated exploit generation.
b. detection module s canner s detection module extends the static analysis described in section iii in two important ways first since php programs are not annotated with source and consume statements we must reason about taint introduction and re moval as well as resource consumption at the level of phpstatements.
second our implementation is interprocedural andmust deal with object oriented features of the php language.
annotations.
to use s canner web developers need to annotate database fields that are considered to be confidential.
in particular rather than directly annotating the source code scanner users need to provide a separate file containing the security sensitive attributes of each database table.
t aint sources.
our implementation considers two kinds of taint sources namely user inputs and database operations.
user inputs are taint sources with label land correspond to reads from pre defined php arrays such as get post and session.
in contrast taint sources with label hcorrespond to database queries that retrieve private data from a database.
given a list of confidential database attributes s canner automatically infers whether or not a given select statement is a taint source.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
sanitization.
recall that asymptotic resource side channel attacks take advantage of the fact that the attacker can arbitrarily inflate resource usage by providing sufficiently large inputs.hence if the application sanitizes user input by bounding its size to a small value then the attacker can no longer inflate resource usage.
in our implementation we consider checksthat impose an upper bound on string length to be sanitizers.
similarly string operations e.g.
substr that limit the size of the resulting string are also considered to be sanitizers.
resource consumption.
in our implementation consume statements from our formalization are instantiated in different ways depending on the type of side channel vulnerability.
for timingvulnerabilities we consider every instruction to consume oneunit of resource hence resource usage only becomes if a loop bound is tainted by user input.
for response size vulnera bilities resource consumption corresponds to print statements.for instance the resource usage of a statement echo foo is iffoo is tainted by user input but has unit cost otherwise.
interprocedural analysis.
even though we omit function calls from the formalization our implementation is interproceduraland detects vulnerabilities that arise due to interactions between different functions.
specifically our analysis computes function summaries of the form prime where is the input taint environment primeis the output taint environment and represents resource usage of the procedure.
the input and output taint environments used in the summary for fonly mention memory locations that are accessible in f hence these summaries are re usable.
that is if we analyze functionfunder the same input environment we can reuse its summary rather than re analyzing the implementation of f. c. error diagnostic module the static analysis described so far only allows s canner to detect the existence of a possible side channel vulnerability.
to help the user understand the severity and implications ofthe uncovered vulnerability s canner performs an additional static analysis.
specifically s canner serror diagnostic moduleoutputs the set of confidential database attributes that may be leaked by the application.
for instance if s canner s output includes employees.age this means that the attacker can infer something about the age an employee stored in theemployees database table.
to provide such diagnostic information s canner performs a backwards static analysis that utilizes the information pro duced by the vulnerability detection module.
specifically theinput to the error diagnostic module is the predicate of a conditional branch along which there is a resource usage imbalance.
given such a predicate c s canner then collects all secret tainted variables used in cand performs backwards symbolic execution to trace each variable vto the database query that caused vto become tainted.
confidential database attributes that are mentioned in the where clause of the query are then reported as being potentially leaked.
d. exploit generation module to further help programmers understand and assess the detected vulnerability s canner also generates a javascriptprogram that can be used to launch a cross site search attack to exploit the vulnerability.
we first provide some relevantbackground on cross site search attacks and we then explainhow s canner semi automatically generates attack scripts.
adversary model and xs search attacks.
recent work has shown that cross site search attacks can effectively exploit side channel vulnerabilities in web applications .
xs search attacks require a very weak adversary model in whichthe attacker runs a malicious website but does not have man in the middle or eavesdropping capabilities.
in this scenario the attacker first tricks an unsuspecting user into executing a malicious script for instance by visiting the attacker s website or clicking on a link in a phishing emailmessage.
now the malicious script automatically submitsa cross site request with the user s legitimate credentials.since web browsers allow a script to implement handlers for events triggered by cross site requests the malicious script canperform resource usage e.g.
timing measurements between events and send this information back to the attacker.
4hence if the underlying website contains a side channel vulnerability then the attacker can glean confidential information about thevictim by inflating certain parameters used in a database query.
backwards symbolic execution.
the goal of s canner s exploit generation module is to semi automatically synthesize javascript programs that trigger the vulnerable component of the web application.
in particular because the vulnerablecomponent may only be triggered under certain values ofthe url parameters our goal is to generate low inputs thatexercise the vulnerable functionality.
towards this goal s canner starts from the vulnerable component cand performs backwards symbolic execution to collect all path constraints that are necessary for the executionto reachc.
the output of the symbolic execution engine is an smt formula such that a satisfying assignment to yields concrete values of the url parameters that are sufficient to trigger the vulnerable functionality.
we emphasize that s canner s support for generating exploits is only semi automatic while our analysis infers the exact url parameters needed to trigger the vulnerable functionality the high inputs are merely placeholders that mustbe inflated by the user to amplify resource usage.
v. e v aluation we evaluate s canner by analyzing widely used opensource php applications.
these applications include word press and joomla content management systems openclinic a medical records system gallery a web based photo al bum organizer opencart zeuscart and oscommerce e commerce webid an online auction software and hotcrpand openconf conference management systems .
some ofthese applications contain information that is clearly security sensitive such as medical records account balances and 4observe that response size side channels can also be exploited using timing measurements since response parsing times are dependent on the response size.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table i summary of our experimental results .
application lines files functions number timing response size false lines of analysis of code of callsites vulnerabilities vulnerabilities positives annotations time min sec openconf openclinic webid hotcrp joomla gallery oscommerce opencart zeuscart wordpress total table ii information inferred by the attacker application id information leaked openclinic does x have a medical record?
openclinic has x been prescribed medication y?
webid does x have product y on their watchlist?
webid isx bidding on product y?
opencart has x bought downloadable product y?
zeuscart has x bought downloadable product y?
zeuscart does x have an order with amount y?
zeuscart has x bought anything between dates x and y?
zeuscart does x s order y have processing status z ?
zeuscart isy the account status for user x?
hotcrp isx an author of a submitted paper?
hotcrp isx the title of a submitted paper?
hotcrp isz the abstract of a submitted paper?
wordpress has x sent a private comment to the admin?
wordpress isx the e mail of a commentator in a post?
wordpress isx the private comment sent to the admin?
joomla has x authored a private article?
joomla isx the title of a private article?
purchase histories.
some of the applications we analyzed also provide well documented privacy guarantees for informationthat may be considered security sensitive.
for example wordpress explicitly states that email addresses of users will not be disclosed.
we run our experiments on a server laptop with ubuntu .
a dual core ghz processor gb of ram and theapache .
.
web server connected to a campus wireless network.
the client is a desktop machine running ubuntu14.
with a dual core ghz processor gb of ram and the firefox browser version .
.
a. overview of results table i gives statistics about the analyzed programs and summarizes the results of our evaluation.
as shown in table i the analyzed programs are quite large and containbetween 24k and 298k lines of code.
s canner s running time on these applications is quite reasonable with the largest application taking minutes to analyze.
most importantly scanner reports a total of vulnerabilities of which are indeed exploitable.
among the vulnerabilities uncoveredtable iii summary of timing results for positive and negative queries .
times are in milliseconds .
id positive query negative query avg time std dev avg time std dev .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
by s canner are timing side channel vulnerabilities and the rest are response size side channels.
table ii summarizes the information that the attacker can learn by exploiting the underlying vulnerabilities uncovered by s canner .
the leaked information is in the form of yes no queries.
however we emphasize that the underlying vulnerabilities actually allow an attacker to infer lage parts ofa database table by using these binary conditions as an oracle.for example the vulnerability in openclinic can be exploited to infer all medications prescribed to a user.
similarly an attacker can the use the vulnerability in opencart to learnall e books purchased by a user or the vulnerability in webidto infer all bids of a user.
hence these programs violate multi run security .
b. exploiting vulnerabilities by measuring response times we now describe how the vulnerabilities uncovered by s canner can be exploited to infer the information listed in table ii.
since we do not assume that the attacker has man in235 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
the middle capabilities we use cross site search attacks5to exploit these vulnerabilities although it may also be possible to exploit these vulnerabilities using other means .
note thataccording to our adversary model the attacker is not ableto directly measure the exact size of the server s response.instead he could perform time measurement through thevictim s browser to indirectly infer the response size sincelonger responses generally takes more time to load.
as a result both time and response size side channel of a web applicationcan be exploited by measuring server response times on theclient side.
table iii shows server response times when the answer to the queries listed in table ii is positive and negative respectively.
since each of the vulnerabilities is caused by anasymptotic imbalance in resource usage wecan amplify the difference between positive and negative queries by supplying artifically inflated search queries e.g.
a query containing avery large search string .
the average and standard deviationmetrics in this table correspond to the collection of 100samples with url request sizes of at most 90k characters.
as we can see from the data in table iii the response times vary significantly for positive and negative queries.
forinstance opencart has an average response time of ms ifuserxhas bought product ybut ms otherwise.
similarly webid has a response time of ms vs. ms depending on whether user xis bidding on product y. since response times vary significantly for all the queries from table ii it ispossible for an attacker to exploit the vulnerabilities uncoveredby s canner .
in the next two subsections we describe in detail two representative vulnerabilities uncovered by s canner .
c. response size side channel in openclinic our first example is a response size side channel vulnerability found in openclinic which is an open source medicalrecords system.
this vulnerability reveals information aboutwhether a patient has a medical record in the system.
description of vulnerability.
the openclinic application contains a medical record search page which allows authorized users to search for medical records matching a given querystring.
the important point is that logical connectives areallowed to be included in the query string and if the con nective is set to or then the database query will returnall rows for which the patient name matches any of the keywords in the search string.
if the table does not con tain patients matching the query then the application printsno results found for x where xis the search string provided by the user.
on the other hand if there is a recordmatching the query then the application displays the patient s record whose length is independent of the search string.therefore one can learn whether the patient has a medicalrecord or not by simply observing whether the response size is linear or constant with respect to the input string.
5please see section iv d for background on cross site search attacks.note that the attacker cannot directly see the patient s record since a he does not have access to the user s credentials and b the same original policy sop prevents scripts containedin the attacker s website from directly accessing data inopenclinic.
however since the attacker can perform timemeasurements in the victim s browser he can observe thedifferences in time to infer the differences in response size.
sample exploit.
the attacker could inflate the query string by appending a long suffix e.g.
aaaaaaaa... after the patient of interest using the or connective.
if the patient name isin the database the query will succeed and a short responsewill be returned.
otherwise since the query string has beenintentionally inflated by the attacker and also reflected by theserver the attacker can tell that a negative answer to the querywill be associated with a much longer response length.
possible fix.
it is easy to fix the vulnerability in this code by not including the search string in the response message.
for instance the code would no longer be vulnerable if the serveralways responded no results found for user if the queriedpatient were not found.
alternatively the code could sanitizethe search keyword by ensuring that it does not contain more than a certain number of characters.
d. timing side channel in zeuscart our second example is a timing side channel vulnerability that s canner found in the zeuscart e commerce system.
description of vulnerability.
at a high level zeuscart allows a user with the right credentials to search order histories which may include information like customer name order id and the corresponding order status.
if there is no matchingpurchase the user quickly gets an empty results table in constant time.
otherwise the application performs additionalsanitization over the input whose running time is linear in the size of the query string.
since there is a significant differencein response times depending on whether a user has a specificorder status an attacker who does not have login credentials can infer the existence of specific purchases by specific users by performing timing measurements in the victim s browser.
sample exploit.
since the query string is controlled by the user the attacker can inflate one of the query parameters to amplify the running time.
for instance the attacker mayappend many white spaces to the user name parameter andin cases where there is a matching purchase the attackercan observe a significant increase in running time of theapplication.
specifically as shown in table iii positive queriestake 3740ms on average while negative queries take 799ms.
possible fix.
one possible fix for this vulnerability is to sanitize the query string by ensuring that it does not exceed a certain number of characters.
this modification would ensure that theresponse time is bounded by a constant.
e. threats to v alidity timing measurement.
in our evaluation we use a specific machine and network environment when conducting timing measurements for positive and negative queries.
of course authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
these measurements could be substantially different if the exploits were executed on other platforms.
however becausethe resource usage imbalances detected by s canner are always asymptotic it is possible for the attacker to further inflate the resource imbalance by providing even larger inputs.
application selection.
another threat to validity is that we evaluate our technique on php applications hence our benchmarks may not be representative of many other real world php applications.
nevertheless we believe these ap plications constitute a good test bed for our approach many of the projects we picked e.g.
wordpress joomla are wellknown popular web applications with thousands of stars ongithub and their security has been widely audited by the open source community.
vi.
p ossible defenses against asymptotic resource sidechannel vulnerabilities the most straightforward way to eliminate the class of vulnerabilities discussed in the paper is to ensure that theattacker cannot inflate the resource usage imbalance between two execution paths that differ in the value of the secret.
one simple way to achieve this goal is to sanitize user input bychecking that its size cannot exceed some small reasonablebound.
another perhaps more robust fix is to eliminate theasymptotic dependence on user input whenever possible.
forinstance in the case of vulnerabilities that concern responsesize a good rule of thumb is to make sure that the responsedoes not contain the entire user input.
if the vulnerability occurs in a component that requires user or adminisrator credentials another way to mitigate the vulner ability is to disallow cross site read requests or employ anticsrf mechanisms.
however it is unrealistic to completely disallow cross site read requests in many cases and anti csrfdefenses are typically only deployed against state changingrequests.
furthermore even in the presence of anti csrfdefenses a response size side channel still allows an attackerwith traffic monitoring capabilities to launch de anonimization attacks and perform some sensitive data inference .
vii.
l imitations of our approach scanner comes with a number of limitations that may result in both false positives as well as false negatives.
first the taint analyses described in section iii and implemented in s canner only propagate explicit flows i.e.
taint is only propagated due to assignments .
hence our analysis can misssome resource side channel vulnerabilities that arise due to implicit flows.
for instance consider the following function void foo int input i n tc i f secret c if c consume input else consume this code has an asymptotic side channel vulnerability since the resource usage is constant in one branch but user controlledin the other one.
however s canner will not report this vulnerability because there is no explicit flow from secret toc.
this limitation can be circumvented by tracking implicit flows albeit at the risk of introducing more false positives.second many of the vulnerabilities uncovered by s canner are exploited using xs search attacks recall section iv d .
however if the application employs anti csrf mechanismsand the vulnerable component requires log in credentials thenthe reported vulnerabilities may not be exploitable using xssearch attacks.
in fact the false positives reported in table iare both caused by s canner s inability to reason about anticsrf measures.
third our analysis only detects a subclass of resource sidechannel vulnerabilities where the resource usage is constant in one execution path but dependent on the user input in anotherexecution path recall definition .
however it is nonethelesspossible to exploit a constant but very large imbalance inresource usage.
the techniques presented in this paper do notaddress such vulnerabilities.
viii.
r elated work static analysis for web security.
there has been much previous work on static analysis for web security.
most of thesetechniques focus on automated detection of xss and sqlinjection vulnerabilities .dahse and holz also consider second order xss and sqli vulnerabilities and propose a static analysis for automatically finding them .
in constrast to these approaches our workfocuses on identifying privacy vulnerabilities caused by anobservable resource usage imbalance in the program.
side channels in web applications.
while side channel leaks have been known for decades the first thorough study of sidechannel leaks in web applications is presented by chen etal .
subsequent works include chapman and evans black box testing which is a pure dynamic analysis and side buster which uses a hybrid of static and dynamic analysis.our approach differs from them in several ways first whilethose tools detects privacy leaks caused by an imbalance in thenumber of requests exchanged between a client and the server it does not reason about side channel leaks originating fromindividual requests.
second the vulnerabilities discovered bythe aforementioned tools can only be exploited by an attackerwho is able to sniff network traffic which requires the attackerto be in the same network path as the victim.
in contrast ourapproach detects vulnerabilities that can be exploited remotelythrough cross site search attacks.
w eb timing attacks.
felten and schneider present one of the first case studies on web timing attacks .
in later work brumley and boneh show how to extract private keys fromweb servers running openssl using timing attacks .
bortzand boneh describe web timing attacks in which they obtainvalid usernames and items in users shopping carts .
in more recent work gelernter and herzberg introduce cross site search attacks as a mechanism for exploiting sidechannel vulnerabilities .
van goethem et al.
show how toexploit multimedia tags in html5 to estimate response sizesduring web timing attacks .
recently van goethem et al.have shown how a weakness in the quota management api injavascript can be used to infer response sizes at the byte level authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
of granularity allowing an attacker to de anonimize twitter users and obtain medical information from webmd .
inthis work we use known attack techniques specifically to assess the severity of the vulnerabilities uncoveredby our approach.
however we emphasize that our workaims to detect application specific vulnerabilities rather thandescribing a new class of web timing attacks.
analysis for side channel vulnerabilities.
there has been significant research effort on verifying non interference including techniques based on self composition product programs and cartesian hoare logic .
in contrast to these techniques our approach focuses on asymptotic resourceside channel vulnerabilities and detects them using lightweightstatic analysis rather than heavy weight verification techniquesthat require the inference of precise loop invariants.
pasareanu et al.
have recently proposed a symbolic execution technique for generating inputs that maximize differ ences in timing and memory usage between multiple programruns .
their technique does not differentiate betweenconstant and asymptotic differences and their evaluation isperformed on small programs e.g.
modular exponentiation rather than large scale web applications.
another related approach is cacheaudit which analyzes x86 binaries with a given cache configuration.
cacheau dit computes an overapproximation of the number of bitsleaked by the application on a simplified machine model.
theirprimary focus is hardware level cache adversaries whosecapabilities do not align with those of application level webadversaries.
for instance it is easier for web adversaries toexploit multi run vulnerabilities while it is harder for themto measure nanosecond level timing differences.
language based information flow.
there is a large body of work on language based solutions for finding violations of the non interference principle and quantifying informationleak .
however these techniques do notdetect privacy vulnerabilities due to convert channels such astiming or response size.
zhang et al.
propose a language based approach for tracking side channel leakage.
their approach requires the program to be written in their proposed language whereas our goal is to analyze existing web applications.
barthe et al.
propose a type based solution to verify the absense of side channels but their technique is tailored towards cryptographicimplementations and simply rejects programs that do not execute in constant time.
t aint analysis.
a common approach for tracking information flow in existing applications is to use taint analysis.
hence there is a large body of work on taint analysis forlanguages like java e.g.
flowdroid and c e.g.
flow tracker .
while our work leverages taint information our main contribution is an algorithm for statically identifying asymptotic resource side channels.
our implementation doesnot leverage mature taint analysis tools like flowdroid as wetarget web applications written in php.multi run security.
the amount of information that is leaked due to a side channel vulnerability is often related to the adversary s ability to aggregate secret information across mul tiple executions.
k opf and basin develop an informationtheoretical model that quantifies information leakage involvingmultiple adaptive interactions between the victim and theadversary.
birgisson and sabelfeld propose an alternativemodel based on knowledge sets and show how to enforce bit multirun security.
pasareanu et al.
use symbolicexecution and model counting to compute single run informa tion leakage bounds and reason about kruns o by applying their single run technique to the k composition of the original program.
while our analysis does not quantify leakage thevulnerabilities uncovered by s canner in our evaluation can be exploited to infer significant chunks of a database seesection v a .
we leave it to future work to develop analysesthat can quantify information leakage through asymptotic side channels across multiple program runs.
static analysis for resource usage.
there is a significant body of work on static analysis for determing worst case resource usage of programs .
however many of these analyses are quite heavyweight anddo not address privacy implications of resource usage.
sincethe focus of our paper is detecting asymptotic resource sidechannels we can effectively detect security vulnerabilities using a lightweight program abstraction that combines taintinformation with a coarse summary of resource usage.
ix.
c onclusions in this paper we introduced asymptotic resource side channels and described a static analysis for detecting them.
our method uses an effective but lightweight program abstraction that combines taint information with a summary of resource usage.
we have used our tool s canner to analyze opensource php applications and found exploitable securityvulnerabilities.
we believe that s canner can help web application developers by automatically uncovering easy to exploit vulnerabilities in their applications.
acknowledgement.
this material is based on research sponsored by darpa award fa8750 as well as nsf award ccf .
the u.s. government is authorized toreproduce and distribute reprints for governmental purposesnotwithstanding any copyright notation thereon.
the viewsand conclusions contained herein are those of the authorsand should not be interpreted as necessarily representing theofficial policies or endorsements either expressed or implied of the u.s. government.
r eferences e. albert p. arenas s. genaim g. puebla and d. zanardini cost analysis of java bytecode in european symposium on programming .
springer pp.
.
s. arzt s. rasthofer c. fritz e. bodden a. bartel j. klein y .
l. traon d. octeau and p. d. mcdaniel flowdroid precise context flow field object sensitive and lifecycle aware taint analysis for androidapps in proceedings of the 35th acm sigplan conference on programming language design and implementation.
acm pp.
.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
m. backes b. k opf and a. rybalchenko automatic discovery and quantification of information leaks in symposium on security and privacy.
ieee computer society pp.
.
d. balzarotti m. cova v .
felmetsger n. jovanovic e. kirda c. kruegel and g. vigna saner composing static and dynamic analysis to validate sanitization in web applications in symposium on security and privacy.
ieee pp.
.
l. bang a. aydin q. s. phan c. s. p as areanu and t. bultan string analysis for side channels with segmented oracles in proceedings of the 24th acm sigsoft international symposium on f oundationsof software engineering ser.
fse .
acm pp.
.
g. barthe g. betarte j. campo c. luna and d. pichardie systemlevel non interference for constant time cryptography in proceedings of the acm sigsac conference on computer and communicationssecurity ser.
ccs .
acm pp.
.
g. barthe j. m. crespo and c. kunz relational verification using product programs in fm f ormal methods.
springer pp.
.
g. barthe p. r. d argenio and t. rezk secure information flow by self composition in computer security f oundations workshop .
proceedings.
17th ieee.
ieee pp.
.
a. birgisson and a. sabelfeld multi run security in european symposium on research in computer security.
springer pp.
.
a. bortz and d. boneh exposing private information by timing web applications in world wide web.
acm pp.
.
d. brumley and d. boneh remote timing attacks are practical in usenix security symposium.
usenix association .
q. carbonneaux j. hoffmann and z. shao compositional certified resource bounds in proceedings of the 36th acm sigplan conference on programming language design and implementation.
acm pp.
.
e. c i c ek g. barthe m. gaboardi d. garg and j. hoffmann relational cost analysis in proceedings of the 44th acm sigplan symposium on principles of programming languages ser.
popl .
acm pp.
.
p. chapman and d. evans automated black box detection of sidechannel vulnerabilities in web applications in proceedings of the 18th acm conference on computer and communications security ser.
ccs .
acm pp.
.
s. chen r. wang x. wang and k. zhang side channel leaks in web applications a reality today a challenge tomorrow in symposium on security and privacy.
ieee computer society pp.
.
d. clark s. hunt and p. malacaria a static analysis for quantifying information flow in a simple imperative language j. comput.
secur .
vol.
no.
pp.
.
j. dahse and t. holz static detection of second order vulnerabilities in web applications in usenix security symposium.
usenix association pp.
.
l. de moura and n. bj rner z3 an efficient smt solver in tools and algorithms for the construction and analysis of systems.
springer pp.
.
g. doychev d. feld b. kopf l. mauborgne and j. reineke cacheaudit a tool for the static analysis of cache side channels in presented as part of the 22nd usenix security symposium usenix security .
usenix pp.
.
e. w. felten and m. a. schneider timing attacks on web privacy in computer and communications security.
acm pp.
.
n. gelernter and a. herzberg cross site search attacks in proceedings of the 22nd acm sigsac conference on computer and communications security.
acm pp.
.
d. genkin i. pipman and e. tromer get your hands off my laptop physical side channel key extraction attacks on pcs in proceedings of the 16th cryptographic hardware and embedded systems interna tional workshop pp.
.
j. goguen and m. jose security policies and security models in symposium on security and privacy.
ieee computer society press pp.
.
s. gulwani speed symbolic complexity bound analysis in computer aided v erification.
springer pp.
.
s. gulwani k. k. mehra and t. chilimbi speed precise and efficient static estimation of program computational complexity in acm sigplan notices vol.
no.
.
acm pp.
.
j. hoffmann k. aehlig and m. hofmann multivariate amortized resource analysis in acm sigplan notices vol.
no.
.
acm pp.
.
j. hoffmann a. das and s. c. weng towards automatic resource bound analysis for ocaml in proceedings of the 44th acm sigplan symposium on principles of programming languages ser.
popl .
acm pp.
.
n. jovanovic c. kruegel and e. kirda pixy a static analysis tool for detecting web application vulnerabilities in ieee symposium on security and privacy s p .
ieee pp.
pp.
p. c. kocher timing attacks on implementations of diffie hellman rsa dss and other systems in advances in cryptology.
springer verlag pp.
.
b. k opf and d. basin an information theoretic model for adaptive side channel attacks in proceedings of the 14th acm conference on computer and communications security ser.
ccs .
new york ny usa acm pp.
.
v .
b. livshits and m. s. lam finding security vulnerabilities in java applications with static analysis in usenix security symposium .
p. malacaria assessing security threats of looping constructs in principles of programming languages.
acm pp.
.
m. c. martin v .
b. livshits and m. s. lam finding application errors and security flaws using pql a program query language in oopsla.
acm pp.
.
t. d. morgan and j. w. morgan web timing attacks made practical black hat .
a. c. myers l. zheng s. zdancewic s. chong and n. nystrom jif java information flow software release.
located at cs.
cornell.
edu jif vol.
.
j. navas m. m endez lojo and m. v .
hermenegildo user definable resource usage bounds analysis for java bytecode electronic notes in theoretical computer science vol.
no.
pp.
.
c. pasareanu q. s. phan and p. malacaria multi run side channel analysis using symbolic execution and max smt in computer security f oundations symposium.
ieee .
b. rodrigues f. m. quint ao pereira and d. f. aranha sparse representation of implicit flows with applications to side channel detection in proceedings of the 25th international conference on compiler construction ser.
cc .
acm pp.
.
a. sabelfeld and a. c. myers language based information flow security ieee journal on selected areas in communications vol.
no.
pp.
.
m. sousa and i. dillig cartesian hoare logic for verifying k safety properties in proceedings of the 37th acm sigplan conference on programming language design and implementation ser.
pldi .acm pp.
.
t. terauchi and a. aiken secure information flow as a safety problem ininternational conference on static analysis.
springer verlag pp.
.
t. van goethem w. joosen and n. nikiforakis the clock is still ticking timing attacks in the modern web in computer and communications security.
acm pp.
.
t. van goethem m. vanhoef f. piessens and w. joosen request and conquer exposing cross origin resource size in usenix security symposium.
usenix association pp.
.
g. wasserman and z. su static detection of cross site scripting vulnerabilities in proceedings of the 30th international conference on software engineering .
g. wassermann and z. su sound and precise analysis of web applications for injection vulnerabilities in pldi.
acm pp.
.
y .
xie and a. aiken static detection of security vulnerabilities in scripting languages in usenix security .
d. zhang a. askarov and a. c. myers language based control and mitigation of timing channels in proceedings of the 33rd acm sigplan conference on programming language design and implementation ser.
pldi .
acm pp.
.
k. zhang z. li r. wang x. wang and s. chen sidebuster automated detection and quantification of side channel leaks in webapplication development in computer and communications security.
acm pp.
.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.