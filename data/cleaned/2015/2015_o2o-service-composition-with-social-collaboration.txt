o2o service composition with social collaboration wenyi qian y xin peng y jun sunz yijun yux bashar nuseibehx and wenyun zhao y school of computer science fudan university shanghai china yshanghai key laboratory of data science fudan university china zsingapore university of technology and design singapore xschool of computing and communications the open university uk lero the irish software research centre university of limerick limerick ireland abstract in online to offline o2o commerce customer services may need to be composed from online and offline services.
such composition is challenging as it requires effective selection of appropriate services that in turn support optimal combination of both online and offline services.
in this paper we address this challenge by proposing an approach to o2o service composition which combines offline route planning and social collaboration to optimize service selection.
we frame general o2o service composition problems using timed automata and propose an optimization procedure that incorporates a markov chain monte carlo mcmc algorithm to stochastically select a concrete composite service and a model checking approach to searching for an optimal collaboration plan with the lowest cost given certain time constraint.
our procedure has been evaluated using the simulation of a rich scenario on effectiveness and scalability.
i. i ntroduction with the growing number of alternative web services that provide equivalent functionality but differ in quality of service qos complex applications are increasingly constructed by service composition automating business processes by composing exisiting component services .
existing research on service composition focuses on selecting an optimal set of component services from given user s requirements and preferences by local selection global optimization or combining both .
this line of research considers online services only that is computational services invoked remotely via the internet.
however online services are increasingly related to offline facilities or social services involving human agents.
for example after reserving an archived document using an online service provided by a library a user needs to physically collect the document.
bringing online consumers into real world stores online to offline o2o commerce has become a fast growing area in ecommerce with an estimated trillion dollar market .
with the support of qr quick response codes one can quickly access an online service such as ordering a product associated with a physical world object by scanning its qr code using mobile phone or consume a service in the physical world such as having a dinner with the qr code received on mobile phone as an electronic voucher.
offline services take place in the physical space.
they are bounded to certain physical locations and their executions may require the availability of certain physical objects.
forexample a library provides a fetching reserved document service at its service stations a shop that provides a scanning document service requires that a document is taken to the shop for scanning.
therefore the composition of online and offline services needs to consider not only the quality attributes and parameter passing in the virtual space but also the route planning and the passing of physical objects in the physical space.
for example it may be beneficial to choose adocument reservation service that is more expensive but has a closer service station of the same library for fetching the reserved document.
on the other hand the development of the emerging sharing economy also known as collaborative consumption allows peer to peer sharing of accesses to goods and services through community based online coordinations.
for example amazon has developed an app called on my way which would allow people to deliver packages en route to their destinations to cut cost while improving customer experience .
through social collaboration a user may recruit a group of people to participate in the execution of offline services e.g.
to fetch a reserved document from a library service station and take it to a shop for scanning on the way to their own destinations.
such opportunistic collaboration is often cheaper than executing all the offline services by the user in person or by employing a normal delivery service.
a challenge to achieve the benefit of the proposed o2o service composition with social collaboration is to formally model both online and offline services and their interplay with the locations shared between mobile agents and their individual interests and concerns.
in this paper we propose an approach to o2o service composition which incorporates offline route planning and social collaboration into the considerations of service selection.
we start with modeling o2o service composition using timed automata which incorporates the concepts of abstract concrete composite service online offline services as well as agents the user and candidate collaborators and physical objects.
these models define the o2o service composition precisely as an optimization problem.
however the complexity in the optimization is very high that is given an abstract o2o composite service not only may there be many corresponding concrete composite services but also for each concrete composite service there may be many different ways in which agents can collaborate to reduce cost.
therefore we propose practical algorithms to approximate .
c ieeease urbana champaign il usa technical research451 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
the optimal solution.
in particular we propose a two level procedure given an abstract composite service we use a variant of the markov chain monte carlo mcmc algorithm to select an instance for each online or offline abstract service so as to identify candidate concrete composite services for each candidate concrete composite service we apply a model checker to identify a collaboration plan with the lowest cost including both cost of service consumption and human labor that satisfies the given time constraint.
we evaluate the proposed approach with a simulated scenario and our results support its effectiveness and scalability.
as far as we know this is the first work on defining the problem of o2o service composition with social collaboration.
the paper s novel contribution is therefore a formal model of the problem as well as an approach for solving it.
ii.
m otivating example suppose that a user bob would like to borrow an archived document from a library get a scanned copy and print a bound copy of the document.
the whole process can be represented by the composite service reproduce borrowed document as shown in figure in which white and gray rectangles represent online and offline services respectively.
the process includes two online services i.e.
document reservation and remote printing and four offline services i.e.
fetching reserved document scanning document fetching bound copy returning document .
to reproduce a borrowed document a user such as bob needs to first reserve the document using an online document reservation service provided by a library and will receive a qr code if the document is successfully reserved.
then the user needs to go to a selected library service station a library can have multiple stations and use the fetching reserved document service to get the reserved document by scanning the qr code.
next he needs to take the document to a scanning service provider and use the scanning document service to get a scanned copy.
after that he needs to upload the scanned copy and order a bound copy of the document using the online remote printing service provided by a printing service provider and will receive a qr code if the bound copy is successfully ordered and paid for.
he can choose an offline service station of the printing service provider to use thefetching bound copy service to get the bound copy by scanning the qr code.
on the other hand he needs to return the document to a service station of the library using thereturning document service.
fig.
.
process of reproduce borrowed document suppose that two libraries provide the document reservation service each library has two offline service stations located at different places which provide the fetching reserved document andreturning document services.
alsoconsider three shops provide scanning document service two companies provide remote printing service and each of the companies has two offline service stations providing the fetching bound copy service.
the qos values i.e.
time and cost in this case of each online or offline service instance are shown in figure .
bob s initial location and the locations of offline service instances are also shown.
the service instances in a bracket mean the preconditions of the service instance before the bracket.
the lines between the locations represent segments on possible routes and we assume that the distance represented by each line is the same for simplicity.
to reproduce a borrowed document bob needs to instantiate thereproduce borrowed document service by selecting an instance for each involved online or offline component service.
according to service composition approaches this problem can be considered as an optimization problem in which the overall utility value has to be maximized while satisfying all global constraints.
for the reproduce borrowed document service bob wants to minimize the overall cost while satisfying the time constraint i.e.
within time units .
given the qos values shown in figure the best service composition is fdr fd sd rd rp fc 4g if we treat offline services the same as online services.
suppose bob starts from his initial location l0and finally returns to it.
according to this composition the best route for bob to complete all the steps in person is l0!l1!l3!l5!
l9!l11!l9!l5!l3!l1!l0.
obviously there could be much better solutions when the distances between the locations of different offline services are considered.
for example if bob chooses the service compositionfdr fd sd rd rp fc 1g he can take a shorter route l0!l2!l1!l4!l5!l2!l0.
this composition costs a little more on direct service consumption but requires much less time and cost on the way.
therefore o2o service composition needs to consider the locations of offline services and incorporate route planning on top of service selection.
the service composition for bob can be further optimized by considering social collaboration.
suppose another person tom is currently at the location l3and plans to walk to l10 vial6andl7.
he can wait at l3for the document to be reserved by bob using dr 1and then fetch the document using fd .
then he can take the document to l6for scanning using sd .
bob can get the scanned copy by email and order a remote printing using rp .
next tom can go to l7to fetch the bound copy using fc .
suppose another person jerry will be at l7after tom gets the bound copy and plan to walk to l2vial8andl5.
jerry can get the document and bound copy from tom at l7and return the document at l8usingrd .
when jerry arrives atl2 he can walk forward to l0to send the bound copy to bob and then return to l2 or bob can walk to l2to get the bound copy and return to l0.
in either case the cost on the way can be reduced greatly as the additional distance that bob tom and jerry need to walk are only a round trip betweenl0andl2.
furthermore tom and jerry could be authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
fig.
.
qos values and locations of service instances fig.
.
fsm for abstract composite service potentially walking concurrently to save overall time cost .
we call such opportunistic delegation of services to potential collaborators as social collaboration which can be challenging to incorporate into o2o service composition by considering the initial routes of social collaborators and computing an opportunistically beneficial plan for them to carry out the delegated tasks.
iii.
s ervice model formalization o2o service composition with social collaboration is complicated as it goes beyond traditional service composition.
in particular social collaboration requires the participation of multiple agents which can be viewed as concurrent processes for carrying physical objects around.
in the following we present a general definition of the problem which serves as the basis for developing approaches for solving the problem.
o2o services anabstract service e.g.
document reservation in the motivating example specifies the functionality of the service without referring to any concrete service instance.
anabstract composite service e.g.
reproduce borrowed document specifies the compositional workflows using a set of abstract services for fulfilling the service requests.
without loss of generality hereafter we assume that an abstract composite service asis defined as a network of finite state machines fsm i.e.
the parallel composition of multiple finite state machines where transitions are labeled with abstract services.
for instance the abstract composite service shown in figure can be easily translated to the network of fsm shown in figure where sddone is an auxiliary boolean variable used to control the execution order and is the precondition of the end of the service which means the user gets the bound copy.
initially it is false and it is set to be true along the transition labeled withsd.
the first transition labeled with rpandrd is then enabled afterwards.
an abstract service sican be realized by a functionally equivalent concrete service.
often multiple concrete services are available to realize si.
given an abstract composite service composed of multiple abstract services s1 sn we can obtain a concrete composite service by instantiating each fig.
.
fsm for concrete composite service abstract service siwith a concrete one.
it is then implied that a concrete composite service can also be expressed in the form of a network of fsm where transition labels are concrete services.
for instance figure shows the network of fsm representing an instantiation of the abstract composite service shown in figure .
unlike traditional web service composition where all activities happen in the virtual space the o2o paradigm connects services taking place in not only the virtual but also the physical space.
for instance invoking an online remote printing service would result in certain physical object i.e.
the printout being located at certain physical location.
furthermore this online service may be connected to an instance offetching bound copy service taking place offline at the location where the printout is.
intuitively online services do not require the users to be at specific locations and their executions do not depend on the availability of certain physical objects.
for example the document reservation service takes as input only the information of a document and it can be invoked anywhere.
in contrast offline services may take place only at certain physical locations and may rely on the existence of certain physical objects at certain physical locations.
in the following we formalize the interplay between online and offline services.
to capture the services effect on physical objects without loss of generality we assume a set of physical objectsoand a set of physical locations l. furthermore for each object o2o we define a variable loto denote its location.
the initial value of lois the initial location ofo.
formally we define a concrete service as a tuple guard name action whereguard is the pre condition on the invocation of the service name is the name of the service and action is a program e.g.
assignments capturing the effect of the service.
here guard may be constituted by the propositions on the value of lofor certain object o andaction may update the value of lo.
for instance the offline fetching bound copy service may have a precondition which requires that the document is at certain station i.e.
lthedoc thestation whereas the online document reservation service may set the location of the reserved document to be at certain station.
note that guard andaction may have additional propositions.
for instance the fetching bound copy service may require a proof of reservation e.g.
a qr code in its precondition.
formally a service guard name action is online if guard is independent of physical locations i.e.
any variable loor location of any agent as introduced later and is offline otherwise.
both online and offline services however may update some locations lo i.e.
resulting in certain objects appearing at or moving to certain locations.
given a concrete composite service in the form of a network of fsm authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
fig.
.
timed automaton for concrete composite service replacing each concrete service i.e.
transition label with the corresponding triple guard name action turns the network of fsm into a network of timed automata.
in order to model concrete services which take certain amount of time to finish we can introduce an auxiliary clock cto capture the time constraint.
for instance if the concrete service of name takesdtime units to finish we model it as follows.
first we reset calong the transition labeled with the triple guard name action .
assume that the transition leads to a states.
we then constrain all transitions leaving ssuch that they must satisfy c d. intuitively this modeling can be interpreted as when the transition occurs the concrete service is invoked and it finishes only when the system leaves the states .
we remark that by timed automata we do not mean timed automata proposed in but the ones extended with variables as supported in uppaal .
we denote this network of timed automata representing a concrete composite service ascs.
for instance figure shows the corresponding csfor the concrete composite service shown in figure .
agents an abstract composite service focuses on high level service requests and is not concerned with how each abstract service is realized.
that is an abstract composite service specifies how services are connected through time.
in contrast concrete composite services instantiating an abstract composite service are constrained by their preconditions.
in particular a concrete composite service must deal with how the concrete services are connected through the physical space e.g.
in order to invoke the next concrete service we may need the user to physically relocate certain objects so that its precondition is satisfied.
this problem is solved by employing a set of agents a e.g.
people participating in the social collaboration .
in the following we use ato denote the set of agents.
we writelawherea2adenotes the location of agent a. intuitively each agent is a separate process who can move from location to location with or without certain physical objects in certain amount of time.
formally an agent is specified in the form of a timed automaton ai si initi ci i ti where siis the smallest set containing all locations in las well as a statem2n for every two ordered locations hm ni denoting the state of transiting from location mton initi2lis the initial location of the agent ci fcigcontains one and only clockciwhich is used to specify the time cost of the agent moving from one location to another i f gis an alphabet containing only an invisible event as the name of the events are irrelevant and tiis the smallest labeled transition relation satisfying the following conditions.
for each object o2oand each state minsi l there is a transition m g fcig act m2n frommto statem2n wheregislo mandactis the program lo intrans.
fig.
.
timed automaton for agent note thatintrans is a special constant denoting that the object is not at any location in lbut rather in a transition between the locations.
for each object o2oand staten there is a transition m2n g fcig act n fromm2n tonwheregisci d lo intrans andactis the program lo n. note thatdis a constant denoting the time required for this agent to travel from mton.
by definition when an agent moves from a location to another it may carry an object along if the object is at the starting location.
it is in this way the agents help realizing a concrete composite service i.e.
by connecting concrete services in the physical space.
note that we assume that an agent can each time only bring one object.
this assumption can certainly be lifted.
for instance an agent in our motivating example is specified by the timed automaton shown in figure .
a set of agents is defined as the parallel composition of the agents since they can simultaneously move between locations to help accomplish a concrete service composition more efficiently written as a a1ka 2k kajajwhere jajis the number of agents in the system.
for the interest of space we skip the definition of parallel composition of timed automata and refer the readers to for details.
a. deadline and cost an o2o service composition with social collaboration is then defined as the parallel composition of csanda written ascska .
adopting standard definitions in a timed run ofcska is a finite sequence of alternating states and events.
hs0 x0 s1 x1 xn sni wheresiis a system state which captures the state of the composite service as well as where the agents and objects are xiis either a concrete service i.e.
the invocation of the service or a real number in rdenoting the elapsing of certain xinumber of time units.
the total execution time of the run is the accumulated sum of all xi2r.
the run is rooted if it starts with the initial state of cska .
furthermore the run is accepting if it is accepting by the composite service fsm network i.e.
it completes the composite service.
a composite service often has a deadline i.e.
the composite service must be completed before certain time.
given a rooted accepting run ofcska we can check whether it satisfies authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
the deadline by checking whether its execution time is within the deadline.
we call a rooted accepting run of cs k a which satisfies the deadline as an execution of the composite service.
furthermore we define a cost function cost which given a concrete service cs cost cs is the cost of invoking that service and given an agent oand two ordered locations hm ni cost o m n is the cost of otraveling from mton.
furthermore in the context of social collaboration if each agent is assumed to be traveling from its initial location to a destination we can measure the additional cost for each agent in terms of how much extra cost it must bare i.e.
its cost of participating the service execution and then traveling to the destination minus its cost of traveling from the initial location to the destination directly.
as a result given an execution ofcska we can calculate its cost by aggregating the cost of all the steps as we extract information on what concrete services have been invoked and the additional cost of all the agents participating the execution.
hereafter we denote the cost of an execution ascost .
problem definition the problem is then defined as follows.
given an abstract o2o composite service ascomposed of abstract services as1 as and each abstract service can be instantiated with a set of concrete services identify the most cost effective execution of the composite service.
in the following we briefly analyze the complexity of the problem.
letjasijdenote the number of concrete services available to instantiate abstract service asi.
in general there are a total of ijsijpossible concrete composite services instantiating an as.
furthermore given a concrete composite service the number of executions are in general exponential in the number of agents.
in fact identifying the most costeffective execution of a given concrete composite service requires solving a complicated planning problem which not only has a constraint on the execution time i.e.
the deadline but also involves concurrency since all agents are running in parallel .
furthermore we need to not only find a feasible schedule but rather to find the most cost effective one.
the complexity of our problem is thus very high.
in practice this problem is often solved based on simple ad hoc ways e.g.
not considering social collaboration or assuming that agents work sequentially.
in the following we develop a method which solves this problem in a way such that often a sub optimal solution can be identified in a reasonable amount of time.
iv.
a pproach given a finite set of concrete services agents and physical objects according to our definition there is always an optimal solution.
the complexity in identifying the optimal solution is however extremely high.
in this section we set out to develop a practical approach for solving the problem.
our approach tackles the complexity at two levels.
given a concrete composite service which is in the form of a network of timed automata we apply a model checker called uppaal cora to automatically identify an execution of the composite service with the minimum cost.
uppaalcora is an extension of the well known uppaal modelchecker for cost optimal reachability analysis which serves our purpose well.
furthermore we apply a number of wellfounded heuristics to help reduce the state space explored by uppaal cora significantly.
at the level of service selection we have the combinatorial complexity as there are often multiple concrete services available for each abstract service.
we thus apply a general optimization technique i.e.
a version of the mcmc markov chain monte carlo algorithm so that we can iteratively improve our service selection.
we remark that service selection optimization has been well researched .
however existing approaches do not apply here since our problem additionally requires us to solve the optimal reachability problem given a concrete composite service.
in the following we introduce the two levels of optimization in detail.
a. mcmc for service selection the first problem we would like to solve is the problem of combinatorial explosion in the number of concrete composite services.
our remedy is to adopt a version of the mcmc as shown in algorithm in the hope to find a sub optimal service selection efficiently.
the inputs of the algorithm include the abstract composite serviceas composed of abstract services as1 as a set of concrete services csifor eachasi a finite set of agentsa each of which is in the form of a timed automaton as discussed in section as well as an optimal threshold on the cost.
algorithm starts with randomly selecting one concrete service csi2csifor each abstract service in as so as to obtain a concrete composite service cs.
next a timed automata model is built based on the discussion in section which is then optimized with a set of heuristics for reducing the state space explained later in this section and submitted to uppaal cora in order to identify an optimal execution .
at line we compare the cost of the execution with the given threshold to check whether it is considered acceptable.
if it is acceptable we terminate and report that an acceptable concrete composite service together with an execution which has a cost lower than the threshold has been identified.
otherwise we proceed to line to search for better concrete composite services.
we remark that in the case that the threshold is not provided we iterate through the loop from line to line until it times out and we report the best execution that has been identified so far.
during the loop we first check whether we have exhausted all combinations of concrete services.
if the answer is yes we report that no acceptable execution has been identified at line .
otherwise we identify a new concrete composite service by changing a part of the selection in the best concrete composite service cs identified so far at line .
we then identify the optimal execution based on the new concrete composite service at line .
at line we compare the new execution 0with the current best one .
if the new one has a smaller cost we take 0as the new current best execution at line and similar we take cs0as new best concrete composite service.
the condition at line states that even if the new authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
execution is not better than there is still certain probability that we might use the new concrete composite service to identify better ones in the future.
that is we generate a random number between and and depending whether the random number is large than a predefined acceptance rate we decide whether to search better concrete composite service based on csorcs0.
this strategy is related to avoid local minimum and typically the acceptance rate is kept below .
.
we remark that the above algorithm is designed based on which has been shown to be effective if the search space is extremely large.
furthermore it often converges well before the limit is reached .
in our setting this is important as it implies that we do not have to apply uppaal cora many times in order to identify a good execution of composite service.
we acknowledge that the performance of algorithm is in nature random and thus we show empirical study results in section to show its effectiveness.
algorithm service selection function mcmc as sfcsig a threshold letcs be a concrete composite service obtained through randomly select a concrete service csi2csi let be an optimal execution obtained with uppaal cora based on cs whilecost threshold do ifthere are still unexplored concrete composite service then randomly change some selection in cs to get a new concrete composite servicecs0 apply uppaal cora on cs0to obtain an optimal execution ifcost cost then cs cs0 else ifrandom acceptrate then cs cs0 end if else returnnull end if end while return end function b. optimal execution identification in the following we explain how an optimal execution is identified given a concrete composite service.
given the concrete composite service and the models of the agents we can systematically build a network of timed automata and apply uppaal cora to identify the optimal execution.
the good news is that with such a model we are able to systematically explore all possible social collaboration.
for instance it is possible that multiple agents collaboratively deliver an object from one location to another through certain path while each agent is only employed for a segment of the path i.e.
the same object could switch multiple hands before reaching its destination.
the bad news is as a result the search space is extremely large and thus scalability becomes an issue.
therefore we propose a number of heuristics for reducing the search space.
in the following we first discuss the heuristics and then present how uppaal cora is used.
heuristic less changing hands in the model presented in section several agents may join in the transportation of one object.
this results in a huge number of runs to be explored by uppaal cora.
in practice if one object atcertain location is to be delivered to another location in order to carry out an offline service it is often the case that only one agent is employed to transport the object so that the object does not change hand half way to its next destination.
this is reasonable in practice because changing hands half way would often cause unnecessary complication e.g.
the agent receiving the object next would have to wait at the location for the agent giving away the object.
we adopt the same strategy in this work so as to reduce the search space.
in particular we analyze the given concrete composite service to identify thedelivering jobs.
there is a delivering job if there exists a concrete service guard name action such thataction sets an object oto be at certain location and there is a later concrete service guard0 name0 action0 such that the guard conditionguard0or a precondition of the end of the service requiresoto be at a different location and object ois irrelevant to all the concrete services in between.
the identification of the delivering jobs is done automatically using a path traversing algorithm based on the concrete service model.
for instance given the composite service presented in section ii we identify the following delivering jobs.
first a delivering job is needed to fetching the document in a specific library station and transport it to a specific shop for document scanning.
second a delivering job is needed to fetch the document at where it is scanned and return it to a specific library station.
third a delivering job is needed to fetch the bound copy at a specific service station of service remote printing and transport it to where the user is.
once the delivering jobs are identified based on the assumption that each delivering job is to be carried out only by one agent we know the maximum number of agents required to complete the composite service.
given a set of nagents andkdelivering jobs the question thus becomes how to selectkor less agents out of nagents so that one agent is assigned one or more delivering jobs.
the total number of such choices is k n .
next for each such choice we can use uppaal cora to identify the optimal execution.
we simply take the best execution identified with these choices as the result.
we remark that while making k n calls of uppaal cora sounds expensive in general kcould be small and furthermore all these calls of uppaal cora can be easily parallelized i.e.
using multiple computers to run uppaal cora with different choices concurrently and therefore the overall execution time is only determined by the worse choice i.e.
the choice which uppaal cora spends the most time in order to identify the optimal execution.
for example in the composite service presented in section ii there are delivering jobs which means agents are needed.
if there are agents who are willing to collaborate we choose of them and there are different combinations.
this heuristic helps to reduce the search space significantly since firstly we reduce the number of timed automata in the network i.e.
exactly n kautomata less and secondly it allows to revise the agent models to reduce the number of states in each agent model as we discuss below.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
heuristic hardworking agents the model of agents introduced in section iii is intuitive and generic.
it however contains many states which translates to high complexity when we use uppaal cora for identifying the optimal execution.
for example considering the example service composition represented in section ii there are twelve locations i.e.
l0tol11 in total and two objects need to be transported i.e.
document and bound copy .
as a result the timed automaton model of each agent in the worst case if the agent can travel to any location contains states.
to explore the social collaboration among several agents the overall network of timed automata would contain several timed automata with states in addition to the timed automata modeling the service composition which results in a huge search space.
a closer look reveals the agent model contains many lazy behaviors which are unlikely to result in the optimal execution.
for instance an agent could simply wait at certain location for a long time or he she could move in any direction even if moving towards where the objects are would clearly yield better results.
our second heuristic is thus to refine the agents so as to remove these lazy behaviors based on the assumption that often having hard working agents who actively seeks out object delivering tasks would produce better execution.
combined with the first heuristic this allows us to re model the agents such that all intermediate states for transporting an object from one location to its next destination can be removed since the object does not change hand half way .
an example agent model is shown in figure which is to be understood only with a model of an object in the system shown in figure .
we start with explaining the model modeling an object first.
recall that with the first heuristic the question is now on how to assign delivering tasks to the agent.
it is possible that the same object may be a part of multiple delivering jobs.
theoretically however we can simply treat the same object in different delivering jobs as different objects.
this is assumption we make in figure for the sake of readability.
in the object model we have the following parameters variable clwhich represents the current location of the object srcwhich represents the source location of the object and deswhich represents the destination location of the object.
because the same object could be assigned to any of the agents in the object model we first havekbranches where kis the number of delivering jobs which models the choice assigning the object to one of the agents.
this is done through a pairwise synchronous message which is a feature available in uppaal cora.
intuitively through a synchronous handshake between the object and one of the agents the agent is now assigned to deliver this object.
afterwards we have the state being generated and transition such that the object is set to be at its source location.
state being handled models is the state where the object is in the process of being transported from its source to its destination.
next we have a synchronous message between the agent and the object again once the object reaches its destination.
next we explain the detail of the revised agent model.
in this model we use the states to represent the status of the fig.
.
revised timed automaton for agent fig.
.
timed automaton for object agent e.g.
idling when there is no delivering task heading to the location of the delivering task etc.
and use a number of variables to encode other relevant information.
in particular variableclrepresents the current location of the agent variable srcrepresents the initial location of the agent and variable des represents the destination location of the agent.
furthermore functiontime s d is a function which computes the time required for the agent to travel from location sto location d. note that given an agent we can pre compute function time s d for all pairs of locations.
initially the agent s location is set to his initial location i.e.
actioncl src .
afterwards the agent enters idlestate where he she awaits for a delivering job.
after the synchronous message with an object the agent received the delivering job and without any delay he she proceeds to the location of the object.
this is modeled as the state heading4job.
after time src o src time units where o src denotes the location of the object the agent reaches the location of the object.
the agent is then at waiting state where he might wait for a while until the object is there i.e.
the concrete service which results an object being at the location may take time to execute .
after the object is ready at the location captured by the condition o.cl o.src i.e.
the object s current location is its source location the agent enters state working which means that he is now working on delivering the object.
after exactly time o src o des time units the agent sends a synchronous message to the object so as to signal that the object is now delivered to its destination.
afterwards the agent goes back the idlestate so that it may be assigned to another delivering job.
if the agent has its own destination after all the object delivering it enters the state going2des and takes the respective amount of time to reach its destination and terminates.
this heuristic helps to reduce the number of states in each agent model significantly.
in fact the number of states in the agent model and the object model remain constant.
the complexity in identifying the optimal execution is thus largely depending the number of combinations on assigning the objects to different agents.
as we have discussed above this complexity could be easily tamed by using multiple computers to compute the optimal cost of each choice.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
v. e valuation to evaluate the proposed approach we conduct an experimental study to answer the following two research questions.
rq1 can o2o service composition considering route planning and social collaboration provide better composite services than otherwise i.e.
simply treating offline services as online services or having o2o service composition without social collaboration?
effectiveness rq2 how scalable is the proposed approach for solving the problem of o2o service composition with social collaboration in the presence of an increasing number of agents and candidate services?
scalability we have shared the experimental materials online1 including the uppaal models input data and the implementation of our approach and baseline approaches.
a. experimental setup in order to answer rq1 we evaluate our approach by solving the composite service reproduce borrowed document shown in section ii and compare its performance with two baseline methods.
one is an conventional approach.
in this approach offline services are treated the same way as online services and thus the optimal service composition is identified through existing service selection approaches .
it means that we select each concrete service based on its qos values without considering route planning or social collaboration.
as a result given a time constraint the same set of concrete services will be always selected for the best concrete composite service.
we assume that the user would follow the best route to execute all the selected offline services by himself herself.
the other is an offline aware approach.
in this approach we identify the optimal service execution through concrete service selection as well as considering the route planning for offline services.
however there is no social collaboration and the user himself herself would execute all the offline services.
the difference between the two approaches is on whether the cost of executing offline services is considered during concrete service selection.
in order to answer rq2 we evaluate the computation time of our proposed approach with different numbers of agents and candidate concrete services.
the evaluation is also based on the composite service reproduce borrowed document shown in section ii.
as the shortest route and traveling time between two locations can be directly obtained we do not consider the influence of the size of the map on the computation time.
we use the following settings for both rq1 and rq2.
the time each agent needs to travel between two locations is shown in table i. for example traveling from l0tol1orl1tol0 needs time units.
the cost of agent is set as .
per time unit.
for example the cost of one agent transporting one object from l0tol1is200 .
the cost threshold in algorithm is set as the optimal cost identified using the offline aware approach with the same i timerequired to travel between locations loc.
l0l1l2l3l4l5l6l7l8l9l10l11 l0 l1 l2 l3 l4 l5 l6 l7 l8 l9 l10 l11 initial user location.
for example if the user is at lxand the optimal cost identified using the offline aware approach isy yis set as the cost threshold for our approach for the cases where the user is initially at lx.
this way we can evaluate whether our approach can identify better executions in a reasonable amount of time.
we remark that setting the threshold to be a constant value independent of the initial user location is not ideal because the cost could vary significantly with different initial user location.
the accept rate used at line of algorithm is fixed as .
heuristically.
all the experiments are conducted on the same machine with a dual core .9ghz cpu and gb ram.
the version of uppaal cora used in the experiments is .
b. effectiveness rq1 we evaluate the performance of the three approaches under different time constraints.
for each time constraint we conduct twelve experiments for each of the three approaches.
in each experiment the user is at a different initial location in the map of figure i.e.
l0tol11 .
we apply the three approaches to identify an optimal solution i.e.
a concrete composite service and an execution plan of it which has the minimum cost.
note that the cost includes the cost for both concrete services and the cost of agents traveling between different locations.
in order to evaluate our proposed approach in the presence of multiple agents we generate five different groups of agents.
each group contains five agents including the user himself herself with random initial and destination locations.
we apply these five agent groups in all the twelve experiments and compute the cost of the composite service with each agent group.
note that in each experiment the two baseline approaches produce the same results for all the agent groups as they do not consider social collaboration.
the time out of algorithm is set to be seconds.
figure shows the optimal cost identified by the abovementioned three approaches under different time constraints time units .
the x axis denotes the different initial locations of the user and the five groups of agents and the y axis denotes the identified optimal cost.
if a point is missing it means that the corresponding approach can not find a solution with the given initial location and agent group.
from the results it can be seen that when the time constraint is tight time units our approach can find a solution in cases while the offline aware approach can only find a solution in cases and the conventional approach can find a solution in none of the cases when the authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
a time constraint time units b time constraint time units c time constraint time units fig.
.
performance of the three approaches under different time constraints time constraint is less tight time units both our approach and the offline aware approach can find a solution in all the cases while the conventional approach fails to find a solution in any of the cases when the time constraint is loose time units both our approach and the offline aware approach can find a solution in all the cases and the conventional approach can find a solution in .
cases.
on average our approach improves the solution of the conventional approach by .
with a median of .
and improves the offlineaware approach by .
with a median of .
when both approaches can find a solution.
although the solution found by our approach is almost always the best among all the three approaches we can also observe that in several cases the solution found by the offlineaware approach is even better than the solution found by our approach including a case of l1in figure a a case of l9 in figure b and a case of l9in figure c .
there are two reasons for this.
first the mcmc algorithm we use in our approach works by random walking through the search space and thus it does not guarantee that every time the solution is better with collaborative agents.
second our approach needs more time than the offline aware approach.
as a result a solution with a cost more than the threshold may be returned when timeout occurs despite that there could be other better solutions with less cost.
the solutions found by our approach involve one to three agents.
the average numbers of agents involved in the solutions are .
.
.
when the time constraints are time units.
the result suggests that when the time constraint is tight social collaboration becomes important and our approach is able to find such collaborative solutions.
the above results are expected as the conventional approach completely ignores the route planning which is essential for o2o service composition and thus always has the highest cost or fails to find a solution.
our approach takes into consideration the route planning for offline services and takes advantage of social collaboration to further reduce the cost and thus nearly always has the best cost.
the above analysis answers rq1 positively that our approach nearly always results in better o2o service composition solution than the other two alternative approaches.
c. scalability rq2 for a given number of agents and a given number of concrete services of each abstract service we run our approach fig.
.
computation time of the proposed approach with different settings by considering different initial user locations from l0tol11 each with five different groups of agents with random initial and destination locations.
we take the average computation time of the settings as the result.
in all the experiments the time constraint is set as time units.
the time out of algorithm is set to be seconds.
figure shows the change of the time used to identify the optimal solution using our approach.
the x axis denotes the number of candidate concrete services of each abstract service and the y axis denotes the time by seconds .
each curve in figure represents a different number of agents from one to five .
it can be observed that with the increase of the number of agents and candidate services our approach takes more time to find an optimal solution.
with one to three agents it takes .1s to .7s to generate a solution when the number of candidates for each service increases from one to seven.
with four agents it takes .9s to .1s.
with five agents it takes .5s to .8s.
while indeed state space explosion would eventually happen thanks to our heuristics presented in the previous section the time increases steadily rather than exponentially.
in practice we believe that having a social collaboration with five agents is reasonably sufficient for most o2o service composition.
because often the more agents the more likely the social collaboration becomes chaotic and unreliable.
for example certain agents i.e.
human beings may fail to execute an offline service as planned when some accidents happen and more agents involved in the collaboration are more likely resulting in failing the service process.
in our experiments the proposed approach could give a solution with five agents in no more than one minute on average when each abstract service has up to five candidates.
this is acceptable considering a composite service involving offline services usually takes dozens of minutes to several hours.
moreover if we parallelize authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
the mcmc algorithm the time for generating one solution can be further shortened.
the above analysis answers rq2 positively that our approach performs well with an increasing number of agents.
the time for generating one solution grows if the number of agents increases.
nonetheless considering that five agents may be sufficient for most o2o service composition scenarios the time for generating one solution is sufficiently fast.
vi.
d iscussion the composition of online to offline services in practice can be complicated by the uncertain nature of offline services.
currently we assume that the availability and execution time of an offline service are known in composition planning but they may be uncertain and continuously changing.
for example the time required to get an offline service may depend on how many customers are waiting for it.
so is the traveling time of agents.
currently we assume that the time required for an agent to travel between two locations can be predicted before hand.
in practice it heavily depends on the traffic on the way and the bus train schedule if public transportation is chosen.
on the other hand the social collaboration involved in the composition of o2o services can be complicated by social issues in practice.
people participating in the collaboration need to share their routes with the platform but not necessarily with others.
they can remain anonymous when participating others tasks except that they need to deliver objects with others face to face.
to encourage people to participate in social collaboration it is required that some kind of incentive mechanism is established.
for example people can get bonus points for their efforts which can be used in the future to recruit others for help.
based on the above analysis we foresee that large scale application of o2o service composition can be achieved by integrating it with and supplying it on a location based live service platform with mobile social networking.
with the platform offline services can be registered with their locations on the map and users can use its map service to navigate to destinations.
based on the locations of offline services and the destinations of users the platform can plan collaboration solutions and invite users to participate.
on the other hand a user can use the social networking service to limit the scope of collaboration for privacy.
furthermore the platform can connect and analyze big data from a wide range of sources e.g.
vehicles traffic surveillance cameras to construct customer oriented composite services as suggested in .
among the sources there can be crowd sensing data from the users.
for example they can report whether an offline service is available and how many customers are waiting for it.
with this kind of big data the platform can not only predict the execution time of offline services and traveling time on the way but also dynamically adapt the composition and execution plan according to real time information.
vii.
r elated work traditional service composition research focuses on the combinational selection of component services by local se lection global optimization or a combination .
some research synthesizes local qos constraints e.g.
response time of component services that guarantee the global qos requirements.
o2o service composition is more than selecting an optimal set of component services.
for each concrete composite service o2o service composition needs to further identify a cost effective execution by finding an optimal collaboration among involved agents.
researchers have seen the necessity of integrating virtual such as cloud services and physical such as public transportation services from various domains to produce composite service solutions to meet customer requirements .
the current research is mainly focused on physical services in a local environment .
this kind of device and sensor services can be regarded as offline services since they can only be accessed in certain locations but the service composition considers local services instead of geographically distributed offline services.
o2o service composition is also different from the so called location based services lbs which provide personalized and context aware services according to the geographic location of a user or other entity .
location based services are usually online services that can be accessed anywhere but may provide different information e.g.
advertisement of a nearby restaurant depending on users locations.
related to this work in self adaptive software systems bennaceur et al.
propose a vision to support collaborative security by mediating emerging components in an environment.
this work adds to the vision that social collaboration could happen among people when their constraints can be formally modeled and reasoned about.
recently there has been increasing interest in leveraging large scale collaboration for problem solving by crowdsourcing .
in the area of crowd sensing mobile users in a large scale are involved to contribute sensing data e.g.
position air pollution using their mobile phones.
the collaboration in this kind of crowdsourcing is targeted at data collection and information acquisition and does not involve location based execution planning.
viii.
c onclusion o2o commerce is driving the need of constructing customer oriented composite services by seamlessly composing online and offline services.
in this paper we have proposed an approach to o2o service selection and composition which incorporates offline route planning and collaboration among the social agents.
the approach has been evaluated using a simulated scenario and the results have confirmed its effectiveness and scalability.
as future work we foresee the integration of o2o service composition with a locationbased real life service platform to enable customer oriented composite service planning and adaptation.