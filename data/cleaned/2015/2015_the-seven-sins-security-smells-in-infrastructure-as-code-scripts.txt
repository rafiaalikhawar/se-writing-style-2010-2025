the seven sins security smells in infrastructure as code scripts akond rahman chris parnin and laurie williams north carolina state university raleigh north carolina email akond.rahman.buet gmail.com cjparnin ncsu.edu lawilli3 ncsu.edu abstract practitioners use infrastructure as code iac scripts to provision servers and development environments.
while developing iac scripts practitioners may inadvertently introducesecurity smells.
security smells are recurring coding patterns thatare indicative of security weakness and can potentially lead tosecurity breaches.
the goal of this paper is to help practitioners avoid insecure coding practices while developing infrastructure ascode iac scripts through an empirical study of security smells iniac scripts.
we apply qualitative analysis on iac scripts to identify seven security smells.
next we implement and validate a staticanalysis tool called security linter for infrastructure as code scripts slic to identify the occurrence of each smell in iac scripts collected from open source repositories.
weidentify occurrences of security smells that include 326occurrences of hard coded passwords.
we submitted bug reportsfor randomly selected security smell occurrences.
we obtain212 responses to these bug reports of which occurrenceswere accepted by the development teams to be fixed.
we observesecurity smells can have a long lifetime e.g.
a hard coded secretcan persist for as long as months with a median lifetime of20 months.
index t erms devops devsecops empirical study infrastructure as code puppet security smell static analysis i. i ntroduction infrastructure as code iac scripts help practitioners to provision and configure their development environment and servers at scale .
iac scripts are also known as configurationscripts or configuration as code scripts .
commer cial iac tool vendors such as chef 1and puppet provide programming syntax and libraries so that programmers canspecify configuration and dependency information as scripts.
fortune companies such as intercontinental exchange ice use iac scripts to maintain their development environments.
for example ice which runs millions of financialtransactions daily maintains of its servers using iac scripts .
the use of iac scripts has helped ice decreasethe time needed to provision development environments from1 days to minutes .
however iac scripts can be susceptible to security weakness.
let us consider figure as an example.
in figure we present a puppet code snippet extracted from the aeolus configure open source software oss repository .
in this ataglance.pdf snippet we observe a hard coded password using the password attribute.
a hard coded string v23zj59an is as signed as password for user aeolus .
hard coded passwords insoftware artifacts is considered as a software security weakness cwe use of hard coded credentials by commonweakness enumerator cwe .
according to cwe if hard coded passwords are used it is almost certain thatmalicious users will gain access to the account in question .
iac scripts similar to figure which contain hard coded credentials or other security smells can be susceptible to security breaches.
security smells are recurring coding patternsthat are indicative of security weakness.
a security smell doesnot always lead to a security breach but deserves attentionand inspection.
existence and persistence of these smells iniac scripts leave the possibility of another programmer usingthese smelly scripts potentially propagating use of insecurecoding practices.
we hypothesize through systematic empiricalanalysis we can identify security smells and the prevalenceof the identified security smells.
the goal of this paper is to help practitioners avoid insecure coding practices while developing infrastructure as code iac scripts through an empirical study of security smells in iacscripts.
we answer the following research questions rq1 what security smells occur in infrastructure as codescripts?
section iii rq2 how frequently do security smells occur in infras tructure as code scripts?
section vi rq3 what is the lifetime of the identified security smelloccurrences for infrastructure as code scripts?
section vi rq4 how do practitioners perceive the identified securitysmell occurrences?
section vi we answer our research questions by analyzing iac scripts collected from oss repositories.
we apply qualitative anal ysis on scripts to determine security smells.
next we construct a static analysis tool called security linter for infrastructure as code scripts slic to automatically identify the occurrence of these security smells in iac scriptscollected by mining oss repositories from four sources mozilla openstack7 wikimedia commons8 and github9.
ieee acm 41st international conference on software engineering icse .
ieee authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
postgres user aeolus password v23zj59an roles createdb require service hard coded password fig.
an example iac script with hard coded password.
we calculate smell density and lifetime of each identified smell occurrence in the collected iac scripts.
we submit bug reports for randomly selected smell occurrences to assess the relevance of the identified security smells.
contributions we list our contributions as following a derived list of seven security smells with definitions an evaluation of how frequently security smells occur in iac scripts along with their lifetime an empirically validated tool slic that automatically detects occurrences of security smells and an evaluation of how practitioners perceive the identified security smells.
we organize the rest of the paper as follows we provide background information with related work discussion in section ii.
we describe the methodology and the definitions of seven security smells in section iii.
we describe the methodology to construct and evaluate slic in section iv.
in section v we describe the methodology for our empirical study.
we report our findings in section vi followed by a discussion in section vii.
we describe limitations in section viii and conclude our paper in section ix.
ii.
b ackground and related work we provide background information with related work discussion in this section.
a. background iac is the practice of automatically defining and managing network and system configurations and infrastructure through source code .
companies widely use commercial tools such as puppet to implement the practice of iac .
for example using iac scripts application deployment time for borsa istanbul turkey s stock exchange reduced from days to an hour .
with iac scripts ambit energy increased their deployment frequency by a factor of .
typical entities of puppet include manifests .
manifests are written as scripts that use a .pp extension.
in a single manifest script configuration values can be specified using variables and attributes.
puppet provides the utility class that can be used as a placeholder for the specified variables and attributes.
for better understanding we provide a sample puppet script with annotations in figure .
for attributes configuration values are specified using the sign whereas for variables configuration values are provided using the sign.
a single manifest script can contain one or multiple attributes and or variables.
in puppet variables store values and have no relationship with resources.
attributes describe the desired state of a resource.
similar to general purpose programming languages code constructs such as this is an example puppet script class example token xxxyyyzzz os name windows case os name solaris auth protocol http centos auth protocol getauth default auth protocol https comment attribute token variable os name case conditionalcalling function getauth fig.
annotation of an example puppet script.
functions methods comments and conditional statements are also available for puppet scripts.
b. related work for iac scripts we observe lack of studies that investigate coding practices with security consequences.
for example sharma et al.
schwarz and bent et al.
in separate studies investigated code maintainability aspects of chef and puppet scripts.
rahman and williams characterized defective iac scripts using text mining and created prediction models using text feature metrics.
rahman et al.
surveyed practitioners to investigate which factors influence usage of iac tools.
rahman et al.
conducted a systematic mapping study with iac related publications and observed lack in security related research in the domain of iac.
from the above mentioned discussion we observe lack of research that studied security smells in iac.
we address this gap in our paper.
iii.
s ecurity smells we describe the methodology to derive security smells in iac scripts followed by the definitions and examples for the identified security smells.
a code smell is a recurrent coding pattern that is indicative of potential maintenance problems .
a code smell may not always have bad consequences but still deserves attention as a code smell may be an indicator of a problem .
our paper focuses on identifying security smells.
security smells are recurring coding patterns that are indicative of security weakness and requires further inspection.
security smells are different from vulnerabilities because a vulnerability is a weakness in software which upon exploitation results in a negative impact .
unlike vulnerabilities security weaknesses don t describe how exploits can be enacted.
a. rq1 what security smells occur in infrastructure as code scripts?
data collection we collect puppet scripts that we use to determine the security smells.
we collect these scripts from the master branches of repositories downloaded on july .
we collect these repositories from the three organizations mozilla openstack and wikimedia commons.
we use puppet scripts to construct our dataset because puppet authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
code snippet raw text initial category security smell class osnailyfacter mysql access ensure present db user root vcenter user user vcenter password password vcenter host ip .
.
.
db user root vcenter user user vcenter password password hard coded user name hard coded passwordhard coded secret fig.
an example of how we use qualitative analysis to determine security smells in iac scripts.
is considered as one of the most popular tools for configuration management and has been used by companies since .
qualitative analysis we first apply a qualitative analysis technique called descriptive coding on puppet scripts to identify security smells.
next we map each identified smell to a possible security weakness defined by cwe .
we select qualitative analysis because we can i get a summarized overview of recurring coding patterns that are indicative of security weakness and ii obtain context on how the identified security smells can be automatically identified.
we determine security smells by first identifying code snippets that may have security weaknesses based on the first authors security expertise.
next we search the cwe database to validate the identified security smell.
we select the cwe to map each smell to a security weakness because cwe is a list of common software security weaknesses developed by the security community .
figure provides an example of our qualitative analysis process.
we first analyze the code content for each iac script and extract code snippets that correspond to a security weakness as shown in figure .
from the code snippet provided in the top left corner we extract the raw text db user root .
next we generate the initial category hard coded user name from the raw text db user root and vcenter user user .
finally we determine the smell hard coded secret by combining initial categories.
we combine these two initial categories as both correspond to a common pattern of specifying user names and passwords as hard coded secrets.
upon derivation we observe hard coded secret to be related to cwe use of hard coded credentials and cwe use of hard coded password .
our qualitative analysis process to identify seven security smells took hours.
the first author conducted the qualitative analysis.
verification of cwe mapping by independent raters the first author derived the seven smells and the derivation process is subject to the rater s judgment.
we mitigate this limitation by recruiting two independent raters who are not authors of the paper.
these two raters with background in software security independently evaluated if the identified smells are related to the associated cwes.
we provided the raters the smell names one example of each smell and the addresses bug class example power username admin prime power password admin prime bind host .
.
.
quantum auth url case osfamily centos user name admin user password power password redhat user name admin user password debian user name admin user password ht md5 power password default user name admin user password power password suspicious comment admin by default hard coded secret user name hard coded secret password invalid ip address bindinguse of http without tls hard coded secret user name hard coded secret user name empty password hard coded secret user name use of weak crypto.
algo.
hard coded secret user name fig.
an annotated script with all seven security smells.
the name of each security smell is highlighted on the right.
related cwes for each smell.
the two raters independently determined if each of the smells is related to the provided cwes.
both raters mapped each of the seven security smells to the same cwes.
we observe a cohen s kappa score of .
between raters.
b. answer to rq1 what security smells occur in infrastructure as code scripts?
using our methodology we identify seven security smells each of which we describe in this section.
the names of the smells are presented alphabetically.
examples of each security smell are presented in figure .
admin by default this smell is the recurring pattern of specifying default users as administrative users.
the smell can violate the principle of least privilege property which recommends practitioners to design and implement a system in a manner so that by default the least amount authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
of access necessary is provided to any entity.
in figure two of the default parameters are power username and power password .
if no values are passed to this script then the default user will be admin and can have full access.
the smell is related with cwe execution with unnecessary privileges .
empty password this smell is the recurring pattern of using a string of length zero for a password.
an empty password is indicative of a weak password.
an empty password does not always lead to a security breach but makes it easier to guess the password.
the smell is similar to the weakness cwe258 empty password in configuration file .
an empty password is different from using no passwords.
in ssh keybased authentication instead of passwords public and private keys can be used .
our definition of empty password does not include usage of no passwords and focuses on attributes variables that are related to passwords and assigned an empty string.
empty passwords are not included in hardcoded secrets because for a hard coded secret a configuration value must be a string of length one or more.
hard coded secret this smell is the recurring pattern of revealing sensitive information such as user name and passwords as configurations in iac scripts.
iac scripts provide the opportunity to specify configurations for the entire system such as configuring user name and password setting up ssh keys for users specifying authentications files creating keypair files for amazon web services .
however in the process programmers can hard code these pieces of information into scripts.
in figure we provide six examples of hard coded secrets.
we consider three types of hard coded secrets hardcoded passwords hard coded user names and hard coded private cryptography keys.
relevant weaknesses to the smell are cwe use of hard coded credentials and cwe259 use of hard coded password .
for source code practitioners acknowledge the existence of hard coded secrets and advocate for tools such as credscan10to scan source code.
we acknowledge that practitioners may intentionally leave hard coded secrets such as user names and ssh keys in scripts which may not be enough to cause a security breach.
hence this practice is security smell but not a vulnerability.
invalid ip address binding this smell is the recurring pattern of assigning the address .
.
.
for a database server or a cloud service instance.
binding to the address .
.
.
may cause security concerns as this address can allow connections from every possible network .
such binding can cause security problems as the server service or instance will be exposed to all ip addresses for connection.
for example practitioners have reported how binding to .
.
.
facilitated security problems for mysql11 database server memcached12 cloud based cache service and kibana13 cloud10 visualization service .
we acknowledge that an organization can opt to bind a database server or cloud instance to .
.
.
but this case may not be desirable overall.
this smell is related to improper access control as stated in the weakness cwe improper access control .
suspicious comment this smell is the recurring pattern of putting information in comments about the presence of defects missing functionality or weakness of the system.
the smell is related to cwe suspicious comment .
examples of such comments include putting keywords such as todo fixme and hack in comments along with putting bug information in comments.
keywords such as todo and fixme in comments are used to specify an edge case or a problem .
however these keywords make a comment suspicious i.e.
indicating missing functionality about the system.
use of http without tls this smell is the recurring pattern of using http without the transport layer security tls .
such use makes the communication between two entities less secure as without tls use of http is susceptible to man in the middle attacks .
for example as shown in figure the authentication protocol is set to http for the branch that satisfies the condition redhat .
such usage of http can be problematic as the admin user will be connecting over a http based protocol.
an attacker can eavesdrop on the communication channel and may guess the password of user admin user .
this security smell is related to cwe319 cleartext transmission of sensitive information .
the motivation for using https is to protect the privacy and integrity of the exchanged data.
information sent over http may be encrypted and in such case use of http without tls may not lead to a security attack.
use of weak cryptography algorithms this smell is the recurring pattern of using weak cryptography algorithms such as md4 and sha for encryption purposes.
md5 suffers from security problems as demonstrated by the flame malware in .
md5 is susceptible to collision attacks and modular differential attacks .
in figure we observe a password is being set using the ht md5 method provided by the htpasswd puppet module14.
similar to md5 sha1 is also susceptible to collision attacks15.
this smell is related to cwe use of a broken or risky cryptographic algorithm and cwe inadequate encryption strength .
when weak algorithms such as md5 are used for for hashing that may not lead to a breach but using md5 for password setup may.
our identified smells overlap with findings reported in prior research.
for example ghafari et al.
identified hard coded secrets and use of weak cryptography algorithms as security smells for android applications.
egele et al.
and kruger et al.
in separate studies analyzed use of weak or wrong cryptography algorithms.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table i an example of using code snippets to determine rule for hard coded secret code snippets output of parser keystone dbpassword keystone pass v ariable keystone dbpassword keystone pass glance user password glance pass v ariable glance user password glance pass rabbit password rabbit pw v ariable rabbit password rabbit pw user jenkins attribute user jenkins ssl key file etc ssl private ssl cert gerrit review.key v ariable ssl key file etc ssl private ssl cert gerrit review.key table ii rules to detect security smells smell name rule admin by default isp arameter x isadmin x.name isuser x.name empty password isattribute x isv ariable x length x.value isp assword x.name hard coded secret isattribute x isv ariable x isuser x.name isp assword x.name isp vtkey x.name length x.value invalid ip address binding isv ariable x isattribute x isinvalidbind x.value suspicious comment iscomment x hasw rongw ord x hasbuginfo x use of http without tls isattribute x isv ariable x isht t p x.value use of weak crypto.
algo.
isf unction x usesw eakalgo x.name this is an example puppet script token xxxyyyzzz os name windows 4auth protocol http vcenter password password aline output of parser comment this is an example puppet script v ariable token xxxyyyzzz v ariable os name windows attribute auth protocol http v ariable vcenter password password b fig.
output of the parser component in slic.
figure 5a presents an example iac script fed to parser.
figure 5b presents the output of parser for the example iac script.
table iii string patterns used for functions in rules function string pattern hasbuginfo bug show bug .cgi?id hasw rongw ord bug hack fixme later later2 todo isadmin admin isht t p http isinvalidbind .
.
.
isp assword pwd pass password isp vtkey isuser user usesw eakalgo md5 sha1 iv .
s ecurity linter for infrastructure as code scripts slic we first describe how we construct slic then we describe how we evaluate slic s smell detection accuracy.
a. description of slic slic is a static analysis tool for detecting security smells in iac scripts.
slic has two components parser the parser parses an iac script and returns a set of tokens.
tokens are non whitespace character sequences extracted from iac scripts such as keywords and variables.
except for comments each token is marked with its name token type and any associated configuration value.
only token type and configuration value are marked for comments.
for example figure 5a provides a sample script that is fed into slic.
the output of parser is is expressed as a vector as shown in figure 5b.
for example the comment in line isexpressed as the vector comment this is an example puppet script .
parser provides a vector representation of all code snippets in a script.
rule engine we take motivation from prior work and use a rule based approach to detect security smells.
we use rules because i unlike keyword based searching rules are less susceptible to false positives and ii rules can be applicable for iac tools irrespective of their syntax.
the rule engine consists of a set of rules that correspond to the set of security smells identified in section iii a. the rule engine uses the set of tokens extracted by parser and checks if any rules are satisfied.
we can abstract patterns from the smell related code snippets and constitute a rule from the generated patterns.
we use table i to demonstrate our approach.
the code snippet column presents a list of code snippets related to hard coded secret .
the parser output column represents vectors for each code snippet.
we observe that the vector of format v ariable name configuration v alue and attribute name configuration v alue respectively occurs four times and once for our example set of code snippets.
we use the vectors from the output of parser to determine that variable and attribute are related to hard coded secret .
the vectors can be abstracted to construct the following rule isattribute x isv ariable x isuser x.name isp assword x.name isp vtkey x.name length x.value .
this rule states that for an iac script if token xis a variable or an attribute and a string is passed as configuration value for a variable or an attribute which is related to user name password private key then the script contains the security smell hard coded secret .
we apply the process of abstracting patterns from smell related code snippets to determine the rules for the seven security smells.
a programmer can use slic to identify security smells for one or multiple puppet scripts.
the programmer specifies a directory where script s reside.
upon completion of analysis authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
slic generates a comma separated value csv file where the count of security smell for each script is reported along with the line number of the script where the smell occurred.
we implement slic using api methods provided by puppetlint16.
rules to detect security smells we present the rules needed for the rule engine of slic in table ii.
the string patterns need to support the rules in table ii are listed in table iii.
the rule column lists rules for each smell that is executed by rule engine to detect smell occurrences.
to detect whether or not a token type is a variable isv ariable x an attribute isattribute x a function isf unction x or a comment iscomment x we use the token vectors generated by parser.
each rule includes functions whose execution is dependent on matching of string patterns.
we apply a string pattern based matching strategy similar to prior work where we check if the value satisfies the necessary condition.
table iii lists the functions and corresponding string patterns.
for example function hasbuginfo will return true if the string pattern show bug .cgi?id or bug is satisfied.
b. evaluation of slic any static analysis tool is subject to evaluation.
we use raters to construct the oracle dataset to mitigate author bias in slics evaluation similar to chen et al.
.
oracle dataset we construct the oracle dataset by applying closed coding where a rater identifies a pre determined pattern.
in the oracle dataset scripts are manually checked for security smells by at least two raters.
the raters apply their knowledge related to iac scripts and security and determine if a certain smell appears for a script.
to avoid bias we did not include any raters as part of deriving smells or constructing slic.
we made the smell identification task available to the raters using a website.
in each task a rater determines which of the security smells identified in section iii a occur in a script.
we used graduate students as raters to construct the oracle dataset.
we recruited these raters from a graduate level course conducted in the university.
we obtained institutional review board irb approval for the student participation.
of the students in the class students agreed to participate.
we assigned scripts to the students to ensure each script is reviewed by at least two students where each student does not have to rate more than scripts.
we used balanced block design to assign scripts from our collection of scripts.
we observe agreements on the rating for of scripts .
with a cohen s kappa of .
.
according to landis and koch s interpretation the reported agreement is fair .
in the case of disagreements between raters for scripts the first author resolved the disagreements.
upon completion of the oracle dataset we evaluate the accuracy of slic using precision and recall for the oracle dataset.
precision refers to the fraction of correctly identified among the total identified security smells as determined by slic.
recall refers to the fraction of correctly identified smells that have been retrieved by slic over the total amount of security smells.
performance of slic for oracle dataset we report the detection accuracy of slic with respect to precision and recall in table iv.
as shown in the no smell row we identify scripts with no security smells.
the rest of the scripts contained at least one occurrence of the seven smells.
the count of occurrences for each security smell along with slic s precision and recall for the oracle dataset are provided in table iv.
for example in the oracle dataset we identify one occurrence of admin by default smell.
the precision and recall of slic for one occurrence of admin by default is respectively .
and .
.
slic generates zero false positives and one false negative for hard coded secret .
for the oracle dataset average precision and recall of slic is .
.
table iv slic s accuracy for the oracle dataset smell name occurr.
precision recall admin by default .
.
empty password .
.
hard coded secret .
.
invalid ip address binding .
.
suspicious comment .
.
use of http without tls .
.
use of weak crypto.
algo.
.
.
no smell .
.
average .
.
dataset and tool availability the source code of slic and all constructed datasets are available online .
v. e mpirical study a. research questions we investigate the following research questions rq2 how frequently do security smells occur in infrastructure as code scripts?
rq3 what is the lifetime of the identified security smell occurrences for infrastructure as code scripts?
rq4 how do practitioners perceive the identified security smell occurrences?
b. datasets we conduct our empirical study with four datasets of puppet scripts.
three datasets are constructed using repositories collected from three organizations mozilla openstack and wikimedia.
the fourth dataset is constructed from repositories hosted on github.
to assess the prevalence of the identified smells and increase generalizability of our findings we include repositories from github as companies tend to host their popular oss projects on github .
as advocated by prior research oss repositories need to be curated.
we apply the following criteria to curate the collected repositories criteria at least of the files belonging to the repository must be iac scripts.
jiang and adams reported for oss repositories which are used in production iac authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table v oss repositories satisfying criteria sect.
v b gh moz ost wik initial repo count criteria iac scripts criteria not a clone criteria commits month criteria contributors final repo count scripts co exist with other types of files such as makefiles.
they observed a median of of the files to be iac scripts.
by using a cutoff of we assume to collect repositories that contain sufficient amount of iac scripts for analysis.
criteria the repository is not a clone.
criteria the repository must have at least two commits per month.
munaiah et al.
used the threshold of at least two commits per month to determine which repositories have enough software development activity.
we use this threshold to filter repositories with little activity.
criteria the repository has at least contributors.
our assumption is that the criteria of at least contributors may help us to filter out irrelevant repositories.
previously researchers have used the cutoff of at least nine contributors .
as shown in table v we answer rq2 using scripts collected from and repositories respectively from github mozilla openstack and wikimedia.
we clone the master branches of the repositories.
summary attributes of the collected repositories are available in table vi.
table vi summary attributes of the datasets attribute gh moz ost wik repository type git mercurial git git repository count total file count total puppet scripts tot.
loc puppet scripts c. analysis sanity check for slic s accuracy with respect to accuracy slic may have high accuracy on the oracle dataset but not on the complete dataset.
to mitigate this limitation and assess slic s accuracy performance on the complete dataset we perform a sanity check for a randomly selected set of scripts collected from four datasets.
we manually inspect each of the scripts for security smells.
next we run slic on the collected scripts.
finally we report the precision and recall of slic for the selected scripts.
the first author performed manual inspection.
from manual inspection we observe occurrences of smells occurrences of hard coded secrets occurrences of suspicious comments and occurrences of invalid ip address binding.
precision of slic for hard coded secrets suspicious comments and invalid ip address binding is respectively .
.
and .
.
the recall of slic for hard coded secrets suspicious comments and invalid ip address binding is respectively1.
.
and .
.
slic generated eight and three false positives respectively for hard coded secret and suspicious comment .
slic generated one false negative for hard coded secret .
the recall is .
which indicates slic s ability to detect most existing smells but may overestimate the frequency of smell occurrences.
an example false positive hard coded secret is pvtkeyring var lib ceph mds cluster id keyring .
here variable pvtkeyring is assigned a path which includes two variables cluster and id whose values are unknown.
an example false negative hard coded secret is passwd root pass .
the puppet lint api can misclassify a variable or an attribute which led to false positives and false negatives.
rq2 how frequently do security smells occur in infrastructure as code scripts?
rq2 focuses on characterizing how frequently security smells are present.
first we apply slic to determine the security smell occurrences for each script.
second we calculate two metrics described below smell density similar to prior research that have used defect density and vulnerability density we use smell density to measure the frequency of a security smell x for every lines of code loc .
we measure smell density using equation .
smell density x total occurrences of x total line count for all scripts proportion of scripts script similar to prior work in defect analysis we use the metric proportion of scripts to quantify how many scripts have at least one security smell.
this metric refers to the percentage of scripts that contain at least one occurrence of smell x. the two metrics characterize the frequency of security smells differently.
the smell density metric is more granular and focuses on the content of a script as measured by how many smells occur for every loc.
the proportion of scripts metric is less granular and focuses on the existence of at least one of the seven security smells for all scripts.
rq3 what is the lifetime of the identified security smell occurrences for infrastructure as code scripts?
in rq3 we focus on identifying the lifetime i.e.
amount of time a security smell persists for the same script.
a security smell that persists for a long time can facilitate attackers.
we answer rq3 by executing the following steps step for each smell occurrence sexistent in script xfor month mi we determine sto persist for month mi 1if soccurs for script x and soccurs with the same configuration value and soccurs for the same type of token in the script such as attribute comment function or variable.
we further demonstrate our approach using an example as shown in table vii.
in table vii we provide code snippets that relate to two instances of invalid ip address binding .
in this example as shown in the first row we notice two occurrences of invalid ip address binding for the same authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table vii example of a persistent security smell month code snippet output of parser persist?
bind address .
.
.
attribute bind address .
.
.
n a bind host .
.
.
v ariable bind host .
.
.
n a bind address .
.
.
attribute bind address .
.
.
yes admin bind host .
.
.
v ariable admin bind host .
.
.
no script.
both of the smells occurred in march .
in the second row of table vii we observe for april two code snippets for which invalid ip address binding occurred.
the first code snippet as indicated by yes represents a persistent smell because the smell occurred with the same attribute bind address .
step we repeat step for all smell occurrences for months mi where i ... n representing all months for the script the security smell occurred.
step we determine which smells have consecutive occurrences throughout the lifetime of the script.
for each smell with consecutive occurrences we calculate the difference between the time the smell first and last occurred.
for example for script x if smell soccurs for months march and april then the lifetime of smell swill be one month.
to avoid systematic overestimating of lifetime we do not mark multiple attributes or variables with the same configuration values as persisting smells.
rq4 how do practitioners perceive the identified security smell occurrences?
we gather feedback using bug reports on how practitioners perceive the identified security smells.
from the feedback we can assess if the identified security smells actually have an impact on how practitioners develop iac scripts.
we apply the following procedure first we randomly select occurrences of security smells from the four datasets.
second we post a bug report for each occurrence describing the following items smell name brief description related cwe and the script and line number where the smell occurred.
we explicitly ask if contributors of the repository agrees to fix the smell instances.
vi.
e mpirical findings we answer the three research questions as following a. rq2 how frequently do security smells occur in infrastructure as code scripts?
we observe our identified security smells to exist across all datasets.
for github mozilla openstack and wikimedia respectively .
.
.
and .
of all scripts include at least one occurrence of our identified smells.
hardcoded secret is the most prevalent security smell with respect to occurrences and smell density.
altogether we identify occurrences of hard coded secrets of which .
.
and .
are respectively hard coded keys usernames and passwords.
a complete breakdown of findings related to rq2 is presented in table viii for our four datasets github gh mozilla moz openstack ost and wikimedia wik .
occurrences the occurrences of the seven security smells are presented in the occurrences column of table viii.
the combined row presents the total smell occurrences.
for github mozilla openstack and wikimedia we respectively observe and occurrences of security smells.
smell density in the smell density per kloc column of table viii we report the smell density.
the combined row presents the smell density for each dataset when all seven security smell occurrences are considered.
for all four datasets we observe the dominant security smell is hardcoded secret .
the least dominant smell is admin by default .
security smells occur more frequently for scripts hosted in github.
for hard coded secrets smell density is .
.
times higher for scripts hosted in github than the other three datasets.
proportion of scripts script in the proportion of scripts script column of table viii we report the proportion of scripts script values for each of the four datasets.
the combined row represents the proportion of scripts in which at least one of the seven smells appear.
as shown in the combined row percentage of scripts that have at least one of seven smells is respectively .
.
.
and .
for github mozilla openstack and wikimedia.
b. rq3 what is the lifetime of the identified security smell occurrences for infrastructure as code scripts?
the persistence of some hard coded secrets is noticeable across all datasets.
a security smell can persist in a script for as long as months.
we report our findings for rq3 in table ix.
the median and maximum lifetime of each security smell is identified for the four datasets.
the row at least one smell refers to the median and maximum lifetime of at least one type of security smell.
for github mozilla openstack and wikimedia the maximum lifetime of a hard coded secret is respectively and months.
hard coded secrets can reside in iac scripts for a long period of time which can give attackers opportunity to compromise the system.
awareness and perception can be two possible explanations for lengthy lifetime of security smells.
if practitioners are not aware of the consequences of the smells then they may not fix them.
also if the practitioners do not perceive these smells to be consequential then smells may reside in scripts for a long duration.
c. rq4 how do practitioners perceive the identified security smell occurrences?
from practitioners we obtain responses for the submitted bug reports in terms of acknowledgement or changing the source code.
we observe an agreement of .
for smell occurrences.
the percentage of smells to which practitioners agreed to be fixed is presented in figure .
in authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table viii smell occurrences smell density and proportion of scripts for the four datasets occurrences smell density per kloc proportion of scripts script smell name gh moz ost wik gh moz ost wik gh moz ost wik admin by default .
.
.
.
.
.
.
.
empty password .
.
.
.
.
.
.
.
hard coded secret .
.
.
.
.
.
.
.
invalid ip address binding .
.
.
.
.
.
.
.
suspicious comment .
.
.
.
.
.
.
.
use of http without tls .
.
.
.
.
.
.
.
use of weak crypto algo.
.
.
.
.
.
.
.
.
combined .
.
.
.
.
.
.
.
table ix lifetime of security smells months smell namegh moz ost wik med max med max med max med max admin by default .
.
.
.
.
.
.
.
empty password .
.
.
.
.
.
.
.
hardcoded secret .
.
.
.
.
.
.
.
invalid ip address binding .
.
.
.
.
.
.
.
suspicious comment .
.
.
.
.
.
.
.
use of http without tls .
.
.
.
.
.
.
.
use of weak crypto.
algo.
.
.
.
.
.
.
.
.
at least one smell .
.
.
.
.
.
.
.
the y axis each smell name is followed by the occurrence count.
for example according to figure for occurrences of use of weak cryptography algorithms weak cryp we observe .
agreement.
we observe .
or more agreement for two smells use of http without tls and use of weak cryptography algorithms .
susp.comm 15dflt.admn 9empt.pass 7hard.code.secr 60inva.ip 15http.usg 93weak.cryp 13 percentagesecurity smelldisagree agree fig.
feedback for the smell occurrences.
practitioners agreed with .
of the selected smell occurrences.
in their response practitioners provided reasoning on why these smells appeared in the first place.
for one occurrence of http without tls practitioners highlighted the lack of documentation and tool support saying good catch.
thiswas probably caused by lack of documentation or absence of https endpoint at the time of writing.
should be fixed in next release.
.
upon acceptance of the smell occurrences practitioners also suggested how these smells can be mitigated.
for example for an occurrence of invalid ip address binding one practitioner stated i would accept a pull request to do a default of .
.
.
.
reasons for practitioner disagreements we observe context to have importance to practitioners.
for example a hardcoded password may not have security implications if the hard coded password resides in a repository used for training purposes.
as one practitioner stated this is not publicly used module but instead used in training only in a non production environment.
this module is designed in a manner to show basic functionality within puppet training courses.
.
for one occurrence of http without tls one practitioner disagreed stating it s using http on localhost what s the risk?
.
the above mentioned statements from disagreeing practitioners also suggest lack of awareness the users who use the training module of interest may consider use of hard coded passwords as an acceptable practice potentially propagating the practice of hard coded secrets.
both local and remote sites that use http can be insecure as considered by practitioners from google17 .
possible explanations for disagreements can also be attributed to perception of practitioners smells in code have subjective interpretation and programmers do not uniformly agree with all smell occurrences .
furthermore researchers have observed programmers bias to perceive their code snippets as secure even if the code snippets are insecure.
vii.
d iscussion we suggest strategies on how the identified security smells can be mitigated along with other implications a. mitigation strategies admin by default we advise practitioners to create user accounts that have the minimum possible security privilege and use that account as default.
recommendations from saltzer and schroeder may be helpful in this regard.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
empty password we advocate against storing empty passwords in iac scripts.
instead we suggest the use of strong passwords.
hard coded secret we suggest the following measures to mitigate hard coded secrets use tools such as vault19to store secrets scan iac scripts to search for hard coded secrets using tools such as credscan20and slic.
invalid ip address binding to mitigate this smell we advise programmers to allocate their ip addresses systematically based on which services and resources need to be provisioned.
for example incoming and outgoing connections for a database containing sensitive information can be restricted to a certain ip address and port.
suspicious comment we acknowledge that in oss development programmers may be introducing suspicious comments to facilitate collaborative development and to provide clues on why the corresponding code changes are made .
based on our findings we advocate for creating explicit guidelines on what pieces of information to store in comments and strictly follow those guidelines through code review.
for example if a programmer submits code changes where a comment contains any of the patterns mentioned for suspicious comments in table iii the submitted code changes will not be accepted.
use of http without tls we advocate companies to adopt the http with tls by leveraging resources provided by tool vendors such as mysql21and apache22.
we advocate for better documentation and tool support so that programmers do not abandon the process of setting up http with tls.
use of weak cryptography algorithms we advise programmers to use cryptography algorithms recommended by the national institute of standards and technology to mitigate this smell.
b. possible implications guidelines one possible strategy to mitigate security smells is to develop concrete guidelines on how to write iac scripts in a secure manner.
when constructing guidelines the iac community can take the findings of acar et al.
into account and include easy to understand task specific examples on how to write iac scripts in a secure manner.
future work from section vi a answers to rq2 indicate that not all iac scripts include security smells.
researchers can build upon our findings to explore which characteristics correlate with iac scripts with security smells.
if certain characteristics correlate with scripts that have smells then programmers can prioritize their inspection efforts for scripts that exhibit those characteristics.
researchers can also investigate if metric based prediction techniques proposed in prior research can be used to identify iac scripts that howto.htmlare more likely to include security smells which can benefit from more scrutiny.
researchers can investigate how semantics and dynamic analysis of scripts can help in efficient smell detection.
researchers can also investigate what remediation strategies are needed to fix security smells.
viii.
t hreats to validity in this section we discuss the limitations of our paper conclusion validity the derived security smells and their association with cwes are subject to the first author s judgment.
we account for this limitation by applying verification of cwe mapping with two raters who are not authors of the paper.
also the oracle dataset constructed by the raters is susceptible to subjectivity as the raters judgment influences appearance of a certain security smell.
internal validity we acknowledge that other security smells may exist.
we mitigate this threat by manually analyzing iac scripts for security smells.
in the future we aim to investigate if more security smells exist.
the detection accuracy of slic depends on the constructed rules that we have provided in table ii.
we acknowledge that the constructed rules are heuristic driven and susceptible to generating false positives and false negatives.
external validity our findings are subject to external validity as our findings may not be generalizable.
we observe how security smells are subject to practitioner interpretation and thus the relevance of security smells may vary from one practitioner to another.
we construct our datasets using puppet which is a declarative language.
our findings may not generalize for iac scripts that use an imperative form of language.
also our scripts are collected from the oss domain and not from proprietary sources.
ix.
c onclusion iac scripts help companies to automatically provision and configure their development environment deployment environment and servers.
security smells are recurring coding patterns in iac scripts that are indicative of security weakness and can potentially lead to security breaches.
by applying qualitative analysis on scripts we identified seven security smells admin by default empty password hard coded secret invalid ip address binding suspicious comment use of http without tls and use of weak cryptography algorithms.
we analyzed iac scripts to determine which security smells occur and used a tool called slic to automatically identify security smells that occur in iac scripts.
we evaluated slic s accuracy by constructing an oracle dataset.
we identified occurrences of security smells that included occurrences of hard coded passwords.
based on smell density we observed the most dominant and least dominant security smell to be respectively hard coded secret and admin by default .
we observed security smells to persist for example hard coded secrets can reside in an iac script for up to months.
based on our findings we recommend concrete guidelines for practitioners to write iac scripts in a secure manner.
we hope our paper will facilitate further security related research in the domain of iac scripts.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.