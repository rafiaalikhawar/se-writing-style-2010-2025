see discussions st ats and author pr ofiles f or this public ation at .researchgate.ne t public ation fot a versatile configu rable extensible fuzzing framework conf erence paper oct ober .
.
citations 16reads author s including hongxu chen nany ang t echnologic al univ ersity publica tions citations see profile yuek ang li nany ang t echnologic al univ ersity publica tions citations see profile bihuan chen fudan univ ersity publica tions citations see profile yinxing x ue univ ersity of scienc e and t echnolog y of china publica tions citations see profile all c ontent f ollo wing this p age was uplo aded b y yuek ang li on no vember .
the user has r equest ed enhanc ement of the do wnlo aded file.fot a versatile configurable extensible fuzzing framework hongxu chen nanyang technological university singaporeyuekang li nanyang technological university singaporebihuan chen fudan university china yinxing xue university of science and technology of china chinayang liu nanyang technological university singapore abstract greybox fuzzing is one of the most effective approaches for detecting software vulnerabilities.
various new techniques have been continuously emerging to enhance the effectiveness and or efficiency by incorporating novel ideas into different components of a greybox fuzzer.
however there lacks a modularized fuzzing framework that can easily plugin new techniques and hence facilitate the reuse integration and comparison of different techniques.
to address this problem we propose a fuzzing framework namely fuzzing orchestration toolkit fot .
fot is designed to be versatile configurable andextensible .
with fot and its extensions we have found new bugs from projects.
among these bugs cves have been assigned.
video link ccs concepts security and privacy software security engineering keywords greybox fuzzing software testing acm reference format hongxu chen yuekang li bihuan chen yinxing xue and yang liu.
.
fot a versatile configurable extensible fuzzing framework.
in proceedings of the 26th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse november lake buena vista fl usa.
acm new york ny usa pages.
introduction greybox fuzzing has become one of the most effective approaches to detect vulnerabilities in a program under test put .
compared with hongxu chen and yuekang li have equal contribution in this work.
bihuan chen is the corresponding author and with the school of computer science and shanghai key laboratory of data science fudan university china and the shanghai institute of intelligent electronics systems china.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse november lake buena vista fl usa association for computing machinery.
acm isbn .
.
.
.
and blackbox fuzzing greybox fuzzing strikes a balance between execution speed and effectiveness.
the past years have witnessed a number of greybox fuzzing frameworks e.g.
afl libfuzzer and honggfuzz followed by various fuzzing extensions to enhance their effectiveness and or efficiency.
however there lacks a fuzzing framework to easily reuse integrate and compare different fuzzing techniques and experiment with new ideas.
take afl as an example it is implemented all in one file with around 8k loc which contains more than global variables.
hence the implementation of a single feature often involves modifications in multiple places.
in short afl is compact but also highly coupled because afl is designed to require essentially no configuration .
in fact most of the existing fuzzers are designed for easy deployment and usage but not easy extension.
therefore it is desirable to have a fuzzing framework that allows easy configuration andextension for new features.
to this end we propose our fuzzing framework namely fuzzing orchestration toolkit fot .
fot is designed to hold three properties.
versatility.
fot provides a fuzzing ecosystem including a set of static and dynamic analyses used to aid the fuzzing process.
configurability.
fot provides a set of configurable options.
users can easily tweak the parameters of the fuzzer to improve the fuzzing effectiveness with their experience.
extensibility.
fot is designed to be of high coherence and low coupling.
specially the implementation mainly consists of two parts the library containing general fuzzing utilities and miscellaneous tools on top of it.
therefore apart from the default fuzzer provided by fot developers can write their own fuzzers with modest effort based on the library.
architecture design in this section we describe the design of fot framework.
interested readers can refer to fot s project site for more details google.com view fot the fuzzer.
figure depicts the overview of fot.
it consists of three parts namely the preprocessor the fuzzer and the complementary toolchain .
components of the framework are represented with blue rectangles.
all these components are configurable andextensible .
.
preprocessor this part contains various tools for collecting static information and instrumentation with the put.
867esec fse november lake buena vista fl usa hongxu chen yuekang li bihuan chen yinxing xue and yang liu program binarysource codestatic analyzerprogram informationbinary rewritercompilerexternal seedsinstrumented programinitial seedsoverall managerseed queueseed scorerprioritized seedpower schedulemutation managermutated inputexecutorfeedback collectornew seed runtime infocrash inputmonitorcrash analyzerother tools preprocessorsfuzzertoolchainwait forsave assave asadjust figure overview of the fot fuzzing framework .
.
static analyzer.
this includes various tools to extract semantic understandings from the put.
for example we have tools to generate the control flow graph call graph or statically collected vulnerability information and convert them into suitable representations that can later be instrumented into the put and utilized during the fuzzing process.
this part is configurable to generate different levels of static information.
it is extensible as developers are allowed to add new types of static analysis as long as the generated result follows the specified format.
.
.
instrumentor.
thebinary rewriter and the compiler instrument additional static information generated by the static analyzerinto the put so that the fuzzer can collect feedback from the latter during execution.
fot supports dyninst based instrumentation when only binary is provided and llvm based instrumentation when the source code is available.
this part is configurable as the users can choose to either instrument at source code level or at binary level.
it is extensible since developers can use other tools such as intel pin for instrumentation as long as the instrumented code can embed the static information and follow the regulations to provide feedback for the fuzzer.
.
fuzzer this part explains fot s the main fuzzing process.
it is essentially a loop that continuously selects seeds from the queue applies mutations to the selected seeds executes the put against mutated inputs and collects feedback for the next iteration.
.
.
overall manager.
as fot is designed to support multithreaded parallel fuzzing it contains an overall manager for fuzzing managing the workload of each worker thread.
particularly it can listen to a special directory to actively import seed inputs from external sources such as symbolic executors like klee or mutation generators like radamsa .
this part is configurable as the users can choose different strategies for the overall management.
it isextensible as it can interoperate with other seed generation tools.
.
.
seed scorer.
the seed scorer is in charge of selecting a seed from the queue for mutation seed prioritization and determining how many new inputs should be generated based on the selected seed power scheduling .
this part is configurable as the users can select from several built in scoring strategies to evaluate seeds.
it isextensible as the users can implement their own strategies with the interfaces provided in fot.
.
.
mutation manager.
the mutation manager is in charge of incorporating different mutators.
it can mutate the seeds in a pure random manner or according to predefined specifications.
this part isconfigurable as fot provides various mutators for the users to choose from.
it is extensible as the developers can implement their own mutators with the provided library.
.
.
executor.
the executor drives the execution of the put.
this part is configurable as the default executor in fot allows users to choose whether or not to use forkserver during fuzzing.
it isextensible as the developers can extend the executor for different scenarios.
for example they may add a secondary executor to execute another put to perform differential testing.
.
.
feedback collector.
the feedback collector collects the feedback emitted by the put.
the exact feedback often corresponds to the instrumented information.
this part is configurable as the users are allowed to select from the default feedback options provided by fot.
for now the feedback can be at basic block level like afl or function level.
it is extensible as the users can specify their customized types of feedback for collection.
.
complementary toolchain fot additionally contains various tools helping to make the framework versatile .
for instance we implemented a web based frontend user interface to monitor the fuzzing results.
it provides fruitful 868fot a versatile configurable extensible fuzzing framework esec fse november lake buena vista fl usa mjs intel xedfot afl aflfast figure average number of unique crashes found in hours on mjsandintel xed .
information to make the fuzzing process more transparent.
we also implemented a crash analyzer to analyze the detected crashes and generate reports automatically.
this reduces the manual efforts of crash triaging.
last but not the least several other tools have been developed with different purposes to complement the fuzzer.
implementation and extensions we have implemented the fot framework and developed two extensions to fot.
.
implementation the fot project started from june and has been actively developed by two researchers.
it is implemented with lines of rust for core fuzzing modules together with lines of c c for the preprocessor lines of java for structure aware mutation and lines of python for complementary toolchain.
.
static vulnerability analysis integration greybox fuzzers are typically aware of quantitative changes of code coverage and use such feedback for keeping the interesting seeds.
however the performance of collecting code coverage feedback quantitatively is often not ideal and greybox fuzzers also need to evaluate the code coverage qualitatively .
one of the approaches to bring qualitative awareness about the covered code is to combine fuzzing with static vulnerability analysis as mentioned in .
.
.
existing fuzzing works seldom use static analysis information to facilitate seed prioritization and power scheduling since existing fuzzing frameworks have little support for them.
in contrast integration with vulnerability static analysis is trivial in fot we used static analyzer to calculate vulnerability metrics e.g.
calls to unsafe functions and cyclomatic complexity and customized seed scorer to take them into account during fuzzing.
this extension added about lines of c and lines of rust code.
the workflow is as follows.
first the static analyzer calculates vulnerability score for each function.
then we instrument the put to provide function level coverage information.
after detecting a seed that brings new coverage the feedback collector will collect its function level coverage and map it with the static analysis result to get the function level vulnerability scores.
the seed scorer will then accumulate the function level scores to form the execution trace level vulnerability scores for the exercised seeds.
finally the power schedule determined by the seed scorer prioritizes and allocates more powers to the seeds with higher vulnerability scores.table crash reproduction in fot aflgo and afl against binutils taken from .
cve id tool runs tte s factor 4487fot aflgo .
afl .
4492fot aflgo .
afl .
6131fot aflgo .
afl .
figure shows the average number of unique crashes detected on mjs and intel xed of different fuzzers over runs.
we can see that with the help of static vulnerability analysis fot can detect more unique crashes in a limited time budget.
.
directed greybox fuzzing dgf guiding the greybox fuzzer towards certain predefined locations in the put can fit multiple scenarios such as patching testing crash reproduction and static analysis report verification .
dgf requires the fuzzer to evaluate seeds according to their distances towards target locations.
aflgo is a dgf based on afl.
it applies a simulated annealing based power schedule for the seeds according to their distances from target locations.
however building an effective directed fuzzer requires not only adjustments of power schedules but also seed prioritization andmutation strategies .
dgf in fot is done by generating the static distances to the target locations with the help of static analyzer and customized program instrumentation feedback collector seed scorer as well as themutation manager .
the implementation added about lines of c and lines of rust code.
the workflow is as follows.
the preprocessor calculates the distances to target locations for each basic block and function and then instruments the basic block level distance information during compilation.
during fuzzing the fuzzer collects the distance information along the executed traces for the seeds.
the seed scoring module will prioritize the seeds closer to the targets and assign more powers to them.
moreover the mutation manager will favor fine grained mutations once the target function is reached.
table compares the results of fot with afl and aflgo on the c filt tool in gnu binutils each experiment was conducted times with hours as the budget .
tte is the average time toexposure in seconds to trigger a vulnerability.
we can see that fot is able to decrease the exposure time greatly.
.
new vulnerabilities till now fot has been used to fuzz more than projects.
table lists some of the day vulnerabilities we found with fot.
among them cves have been assigned to oniguruma a widely used regular expression library used by php ruby etc and cves have been assigned to espruino a javascript engine for iot devices .
gnu diffutils gnu bc and apcalc have been used for many years.
other projects such as radare2 an open source reverse engineering framework and libsass the sass library have been fuzzed for multiple times by others.
869esec fse november lake buena vista fl usa hongxu chen yuekang li bihuan chen yinxing xue and yang liu table selected trophies and the projects project name0 day bugstime since releasegithub starskloc mjs 1y7m .
liblnk 8y9m .
gnu bc 26y8m .
radare2 9y4m .
espruino 4y9m .
libsass 6y5m .
libpff 3y8m .
oniguruma 5y8m .
apcalc 19y .
flif 2y9m .
diffutils 29y7m .
related work in this section we first compare fot with other fuzzing frameworks and then discuss its relationship to current fuzzing extensions.
.
comparisons to other fuzzing frameworks table compares fot with existing fuzzing frameworks with respect to major features.
as we can see the existing fuzzing frameworks afl libfuzzer and honggfuzz lack features in different aspects while fot integrates all of them.
fot stands out in that it provides various configurations for advanced users it is also highly modularized to be easily extended with other fuzzing techniques.
further more fot also partially supports structure aware mutations by specifying semantic grammars and interoperability with other seed generation tools such as symbolic executors by monitoring and scheduling newly incoming seed input directory .
.
relationship to current fuzzing extensions most current fuzzing techniques can be easily integrated into fot thanks to its highly modularized design.
in fact these techniques can be applied with some extensions to the different components in figure and can be used together with the configuration interface.
aflfast can be implemented by applying a markov chain model based seed power scheduling in the fuzzer.
aflgo can be implemented by a combination of static analyzer instrumentation andpower scheduling .
collafl can be implemented by using a collision resistant algorithm to increase the uniqueness of the path trace labeling during instrumentation .
skyfire radamsa csmith can be used in the preprocessor to generate seeds for the external seeds and a structureaware mutator assigned by mutation manager .
symbolic executors such as klee can be integrated in the driller s style with the help of overall manager .
conclusions we have proposed fot a versatile configurable and extensible fuzzing framework to facilitate the reuse integration comparison and development of different fuzzing techniques.
we briefly explained the workflow of fot and showed its applications in thetable comparisons between different fuzzers not supported g partially supported fully supported featuresframeworkafl libfuzzer honggfuzz fot binary fuzzing support multi threading mode in memory fuzzing advanced configuration g modularized functionality g structure aware mutation g interoperability g toolchain support precise crash analysis runtime visualization g aspects of static vulnerability analysis enhanced fuzzing and directed grey box fuzzing.
the experimental results have indicated that fot can be quite effective for different fuzzing scenarios.
acknowledgment this work is supported by the national research foundation prime ministers office singapore under its national cybersecurity r d program award no.
nrf2016ncr ncr002 and administered by the national cybersecurity r d directorate the research of dr xue is also supported by chinese academy of sciences cas pioneer hundred talents program of china.