proof based coverage metrics for formal verification elaheh ghassabani andrew gaceky michael w. whalen mats p. e. heimdahl lucas wagnery department of computer science engineering university of minnesota mn usa yrockwell collins advanced technology center ia usa email ghass013 mwwhalen heimdahl umn.edu yandrew.gacek lucas.wagner rockwellcollins.com abstract when using formal verification on critical software an important question involves whether we have we specified enough properties for a given implementation model.
to address this question coverage metrics for property based formal verification have been proposed.
existing metrics are usually based on mutation where the implementation model is repeatedly modified and re analyzed to determine whether mutant models are killed by the property set.
these metrics tend to be very expensive to compute as they involve many additional verification problems.
this paper proposes an alternate family of metrics that can be computed using the recently introduced idea of inductive validity cores ivcs .
ivcs determine a minimal set of model elements necessary to establish a proof.
one of the proposed metrics is both rigorous and substantially cheaper to compute than mutation based metrics.
in addition unlike the mutationbased techniques the design elements marked as necessary by the metric are guaranteed to preserve provability.
we demonstrate the metrics on a large corpus of examples.
index terms coverage requirements completeness formal verification inductive proofs inductive validity cores i. i ntroduction in safety critical systems development an important question involves whether the requirements and testing process are adequate for the implementation.
for example in do178b c tests are derived from requirements and the adequacy of the tests is measured by examining coverage of the implementation.
as the criticality of the software increases more rigorous adequacy measures statement decision mc dc are required with the justification that code must be more rigorously executed by tests to demonstrate its compliance.
if complete coverage is not achieved analysis is performed to determine whether additional tests or additional requirements are necessary to achieve coverage.
for critical systems it has been argued that formal methods should be applied to gain higher assurance than is possible with testing .
unfortunately proof based approaches tend not to answer the question as to whether implementations have functionality that is not covered by requirements.
unlike testing for proof the whole system is executed but many parts of the system may be irrelevant to the property that is proved.
this work was carried out within the hacms and sosite phase ii grants darpa fa8750 and fa8650 c .relatively recently techniques have been devised for analyzing adequacy of requirements against formal implementation models specified as transition systems or kripke structures .
the mechanism used is based on mutation and proof is it possible to prove that the requirements still hold of the system after mutating the model in some way?
if so then the requirements are incomplete with respect to the mutated part of the model.
unfortunately previous approaches to computing coverage metrics can underapproximate which portions of a program are necessary to prove the requirements.
in addition the mutation based analyses tend to be computationally very expensive because there are many possible mutant models to verify.
for example for model checkers state of the art techniques have runtimes of in the best case several times more than is required for proof .
we wish to have a graduated set of metrics suitable for use in certification for checking the adequacy of requirements against an implementation model that can be applied early and throughout a development cycle on different implementation artifacts are proof preserving the portion of the implementation that is identified as covered demonstrates the fulfillment of the requirement but does not contain irrelevant information and are efficient to compute.
towards this end we propose measures of requirements adequacy based on minimal proofs of requirements.
we measure the adequacy of a set of requirements by examining an approximately minimal set of model elements necessary to construct a proof of all the requirements.
our approach is applicable to reactive software that does a bounded amount of computation in response to an input for an unbounded sequence of inputs.
this set contains most embedded and especially safety critical software and can be described as transition systems equivalently infinite state circuits that compute next states given an input and current state .
it is implemented using inductive validity cores ivcs for transition systems and integrated into a branch of the jkind model checker .
in our benchmarks we demonstrate that one of the proof based metrics is considerably more computationally tractable than previous approaches based on mutation averaging overhead over model checking alone rather than the overhead required for the state of the art of the mutation based metrics.
thus the contributions of this .
c ieeease urbana champaign il usa technical research new ideas194 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
node asw alt1 alt2 int inhibit bool returns bool var a1 below a2 below a1 above a2 above below above hyst d1 d2 bool let a1 below alt1 threshold a2 below alt2 threshold a1 above alt1 t hyst a2 above alt2 t hyst below a1 below or a2 below above hyst a1 above and a2 above if below and not inhibit then true else d1 d1 if inhibit or above hyst then false else d2 d2 false pre tel fig.
.
altitude switch model work are a family of coverage metrics for formal verification based on minimal inductive validity cores mivcs .
most of the proposed metrics are proof preserving a discussion of the relationship between proof based metrics and mutation based metrics including a proof of equivalence between non deterministic mutation coverage and one of the proof based metrics must cov .
an implementation that efficiently computes property coverage over symbolic transition systems an initial experiment that compares our technique against a state of the art mutation based notion of completeness.
ii.
r unning example we use a very simple system from the avionics domain to illustrate our approach.
an altitude switch asw is a hypothetical device that turns power on to another subsystem the device of interest when the aircraft descends below a threshold altitude and turns the power off again after we ascend over the threshold plus some hysteresis factor.
an implementation of an asw containing two altimeters written in the lustre language simplified and adapted from is shown in figure .
if the system is not inhibited by the user and either altimeter is below the constant threshold then it turns on the else if the system is inhibited or both altimeters are above the threshold plus the hysteresis factor threshold hyst t hyst then the turned off and if neither condition holds then in the initial computation it is false and thereafter retains its previous value.
the notation false pre in equation describes an initialized register in lustre in the initial state the expression isfalse and thereafter it is the previous value of in the remainder of the paper we will use this model to illustrate aspects of requirements completeness.
iii.
p reliminaries this section presents formalizations of transition systems inductive validity cores and background information onmutation based coverage metrics.
although we focus the formalism below on safety properties the approach is able to handle liveness properties through reduction to safety properties as is performed by e.g.
k liveness .
a. models requirements and provability given a state space u a transition system i t consists of an initial state predicate i u!bool and a transition step predicate t u u!bool.
we define the notion of reachability for i t as the smallest predicate r u!bool which satisfies the following formulas 8u i u r u 8u u0 r u t u u0 r u0 a safety property p u!bool is a state predicate that holds on a transition system i t if it holds on all reachable states i.e.
8u r u p u written as r pfor short.
when this is the case we write i t p. we assume the transition relation has the structure of a top level conjunction.
this assumption gives us a structure that we can easily manipulate.
givent u u0 t1 u u0 tn u u0 we will write t t1 tnfor short.
by further abuse of notation tis identified with the set of its top level conjuncts.
thus x2tmeans thatxis a top level conjunct of t ands t means all top level conjuncts of sare top level conjuncts of t. when a top level conjunct xis removed from t it is written astnfxg.
such a transition system can easily encode our example model in section ii.
we assume each equation defines a conjunct within the transition system which we will denote by the variable assigned so t fa1 below a2 below a1 above a2 above below above hyst d1 d2 g. definition .
inductive validity core ivc s tfor i t pis an inductive validity core denoted by ivc p s iff i s p. in examining provability we are interested in minimal sets that satisfy a property p tracing a property to the entire model is not particularly enlightening.
fortunately ivcs have the following monotonicity property given i t p 8s1 s2 t.ivc p s ivc p s .
we next introduce the notion of minimal inductive validity cores.
definition .
minimal inductive validity core mivc s tis a minimal inductive validity core denoted by mivc p s iff ivc p s 8ti2s i snft ig 0p.
note that given i t p palways has at least one mivc which implies mivc s are not necessarily unique.
for example takei a b t a0 b0 andp a b. then bothfa0g andfb0garemivc s for i t p. to capture this fact the all mivcs aivc relation has been introduced .
aivc p fsjs t mivc p s g establishing the aivc for a single property one gets a clear picture of the all the model elements constrained by the property.
the set of aivc s for all properties demonstrates a complete mapping from the requirements to the design elements which is called complete traceability .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
b. coverage and mutations in general specification completeness can be defined with regard to the notion of coverage.
in fact the way that coverage is formalized plays a key part in the strength effectiveness of a method for the assessment of completeness.
the goal of a coverage metric is usually to assign a numeric score that describes how well properties cover the design.
the majority of the work on coverage metrics has focused on mutations which are atomic changes to the design where the set of possible mutations depends on the notation that is used.
a mutant is killed if one of the properties that is satisfied by the original design is violated by the mutated design .
there are many different kinds of mutations that have been proposed primarily focused on checking sequential bit level hardware designs.
similarly for software it is possible to apply any of the standard source code mutation operators used for software testing towards requirements coverage analysis.
we assume each element ti2thas a set of possible mutations associated with it.
depending on the modeling formalism used this may be the value of a gate or signal or an expression within a statement in a program.
we will further assume the existence of a mutation function fmthat given a model element will return a finite set of mutations for that element.
we can then define the set of mutant models mas follows m f tnft ig fmgjti2t m2fm ti g and then define the mutation score for property pin the standard way definition .
generalized mutation coverage.
mutant cov jfmjm2m i m 0pgj jmj note that without loss of generality we consider a single propertyp which can be viewed as the conjunction of all the properties of the model.
in our example in figure applying the software mutations from would involve manipulating the constants used in the definitions of a1 below a2 below a1 above a2 above swapping orandand in the definition of below above hyst or negating the conditions in the if then else statements.
even for this small model there are many possible mutations .
the number of single mutation programs is roughly the product of the leaf elements of the program abstract syntax tree ast and the size of the chosen set of mutations which can lead to an impractical number of verification problems.
mutations for hardware are discussed in .
the state of the art of mutation based coverage can be found in where a design is considered as a net list with nodes of types fand inverter register inputg.
each mutant design changes the type of a single node to input.
when property satisfied by the original net list fails on the mutant design it is said that a mutant is discovered for .
then the coverage metric for is defined as the fraction of the discoveredmutants based on which the coverage of a set of properties is measured as the fraction of mutants discovered by at least one property.
to decrease the cost of computation coverage analysis is performed at several stages first all the nodes that do not appear in the resolution proof of a given property are marked as not covered and the rest of the nodes are marked asunknown.
then for the unknown nodes the basic mutation check is performed if a corresponding mutant design violates the property it will be considered as covered.
iv.
p roof based metrics we propose a new approach for measuring property completeness based on proof rather than mutation.
we first define notation then describe different possible metrics given a set of minimal proofs.
definition .
ivc coverage ivc c ov givens2aivc p tiis covered by pviasiffti2s.
we call definition a proof preserving metric because with a set of the model elements marked as covered by ivc c ov pis provable.
other notions as will be discussed in section iv a may yield subsets of the model that are insufficient to reconstruct the proof of the property.
the coverage score for ivc c ovcan be calculated with jsj jtj becausepmay have multiple mivc s ivc c ovmetric can lead to various scores that belong to the following set fjsj jtjjs2aivc p g note that if an mivc contains all model elements i.e.
the model is completely covered then there is only one possible mivc so in this case there is no diversity of scores.
given allproofs of a particular property it is possible to define additional complementary coverage notions.
to do so we use the following categorization of the model elements based on mivc andaivc relations for p must p taivc p may p saivc p nmust p irr p tn saivc p this categorization helps to identify the role and relevance of each design element in satisfying a property.
function must specifies the parts of the model absolutely necessary for the property satisfaction.
any change to these parts will affect provability of the property.
on the other hand any single element inmay p may be modified without affecting satisfaction of p though modifying multiple elements may require re proof .
theirr denotes model elements that are irrelevant to the validity ofp .
using the notions of may andmust we can introduce additional coverage metrics.
definition .
may cov ti2tis covered by piffti2 may cov p where may cov p ftij9s2aivc p ti2sg.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
definition .
must cov ti2tis covered by piffti2 must cov p where must cov p ftij8s2aivc p ti2sg.
the may covnotion aims to deal with the fact that a propertypmay have several distinct mivc s. in such cases ivc c ovonly looks at an arbitrary mivc that may contain a subset of may p which means depending on which mivc it considers every time it may report a different part of may p as uncovered.
however may covresolves this issue reporting the entire set of may p as covered which also leads to higher coverage scores.
must covtakes the opposite view considering a model element as covered only if it affects all the proofs of p. it is still possible to build more relaxed coverage metrics in which coverage is captured by looking at individual properties rather than their conjunction.
we can for example describe a metric in which any element used by an mivc for any property is considered covered.
the next definition model cov formalizes this notion.
definition .
model cov given a set of properties overt ti2tis covered iffti2model cov t where model cov t ftij9p2 s2aivc p t i2sg.
a. discussion based on the categorization of elements we will state some relationships about mivc s so to compare different proof based metrics proposed earlier.
lemma .
ifmay p ?
thenpis not provable by must p .
now we focus on the relationship between non deterministic mutation based coverage and proof based metrics.
in chockler et.
al.
each mutant design changes the type of a single node to input.
given a suitable encoding of the netlist assigning a fresh input is an isomorphic operation to simply removing a tifromt.
the mapping is as follows the netlist becomes a conjunction of equations where each vertex becomes a variable vi2u and where each non input vertex becomes an assignment equation ti2t.
for example given anand vertexviwith three input edges from other vertexes fva vb vcg we would define an equation ti2tof the form vi va vb vc .
given this encoding we can reframe the non deterministic coverage proposed in as follows definition .
nondeterministic coverage alternate specification nondet cov .ti2tis covered by property piffti2nondet cov p where nondet cov p ftij i t p i tnft ig 0pg.
given this definition it becomes straightforward to define some additional properties.
lemma .
ti2nondet cov p ti2must cov p .in light of lemma the nondet cov coverage score of specification pcan be also calculated by jmust p j jtj immediate from lemmas and nondet cov is not proof preserving while ivc c ovis proof preserving by definition.
note that one can define many more proof based coverage metrics based on the mivc aivc idea.
metrics that make use of theaivc relation are computationally more expensive to compute than ivc c ovalthough they might be easier to satisfy i.e.
result in higher coverage scores .
in general when coverage scores of a given property are obtained from the proposed metrics the following relationship holds nondet cov ivc c ov may cov model cov ivc c ovand nondet cov are equivalent when all elements within the model are covered if all model elements are must elements then there can only be one mivc and this mivc uses all of the model elements.
in the implementation and experiments we will focus on the ivc c ovand nondet cov metrics.
both metrics are fairly rigorous and can be computed reasonably efficiently.
the equivalence of must covand nondet cov allows us to compare our algorithms against state of the art mutation based coverage.
v. i llustration we illustrate the idea of completeness metrics and the score from different metrics on our altitude switch asw example from section ii.
the asw is responsible for turning on and off a device of interest so we formulate two requirements that describe when the asw should be onand when it should be off.
the first attempt at formalization property set is as follows on p a1 below and a2 below and not inhibit true off p a1 above and a2 above and inhibit false all p on p and off p for each of the ivc c ov may cov and must covmetrics all p only requires fbelow d1 this small set of elements is due to a classic specification problem using computed variables as the antecedents of implications.
we therefore modify our properties to use inputs and constants as antecedents and derive on p alt1 threshold and alt2 threshold and not inhibit true off p alt1 t hyst and alt2 t hyst and inhibit false in this version distinctions emerge between the metrics.
all p has two mivc s ffa1 below below d1g fa2 below below d1gg because of the on p property in the implementation the turned on when either of the altimeters is below the threshold while our property states that they both must be below.
the must elements remain the same fbelow d1g because authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
neither a1 below ora2 below is required for all proofs and the may elements contain both a1 below anda2 below.
the above hyst a1 above a2 above and d2equations are still missing meaning that the above thresholds are irrelevant to our properties.
we realize we are missing a hysteresis case and end up with the following set of properties on p alt1 threshold and alt2 threshold and not inhibit true off p alt1 t hyst and alt2 t hyst or inhibit false hyst p not inhibit and alt1 threshold and alt2 threshold and alt1 t hyst or alt2 t hyst false pre all p on p and off p and hyst p the hysteresis property states that if the antecedent conditions hold then in the initial state the variable is assigned false and in subsequent steps it retains the same value as it previously had.
this property set which includes all variables for all measures can reasonably be seen as describing the interesting behavior of the model.
vi.
i mplementation and initial results for implementation we have made use of the technique proposed by ghassabani et al.
using the algorithm ivc uc that computes an approximately minimal ivc in an efficient way.1to compute the must set of a given property as efficiently as possible we use the algorithm from adapted to use the more scalable pdr algorithm rather than interpolation for model checking.
we call this algorithm must cov.
these algorithms have been implemented in the jkind model checker .
jkind proves safety properties using multiple cooperative engines in parallel including k induction property directed reachability pdr and templatebased lemma generation .
to examine the efficiency and effectiveness of our approach we ran the must covand the ivc c ovmetric against a benchmark suite consisting of lustre models from and industrial models derived from and other sources .
most of the benchmark models from are small 10kb or less with equations and the industrial models each are 80kb with over equations.2the overhead of the ivc ucalgorithm is on average over the baseline proof as opposed to the runtime overhead for the must cov computation.
in many cases the ivc c ovmetric is efficient enough to run as part of the verification process.
to examine effectiveness we examined the portion of the model required by each of the coverage metrics.
any proposed metric should be justified and yield meaningful information about the adequacy of the property set.
as a baseline we use backwards static slicing which is used in the hardware verification community for measuring adequacy.
our claim is that slicing is too loose a metric to be useful.
this claim was justified in our benchmarks where coverage reported by static slicing is on average .5x higher than the ivc c ovmetric.
1for complete information see ghassabani et.
al .
2tools and complete presentation of results are accessible from .our metrics have a justification from proof for each of the metrics any model element returned must be necessary tosome proof.
however there are differences between the reported coverage of the metrics.
on average the ivc c ov metric yields .15x higher coverage than the must covmetric.
this might lead one to prefer the must covmetric but it is more expensive to compute and the resulting set of elements does not always lead to a proof.
additional study is necessary to determine the best circumstances for use of each metric.
vii.
r elated work coverage in verification was introduced in .
hoskote et al.
suggested a state based metric in model checking based on fsm mutations which are small atomic changes to the design.
later in chockler et al.
provided corresponding notions of metrics used in simulation based verification for formal verification.
however the proposed algorithm in is both computationally expensive approximately linear in the number of mutations .
most of the mutation based metrics including are focused on finite state systems and hardware systems.
a more recent work in performs coverage analysis through interpolation .
this work is also based on design dependent mutations as explained in iii b. the proposed algorithm is similar to the ivc must algorithm as discussed in iv a except that our implementation uses pdr andk induction rather than interpolation.
a similar notion to ours was outlined in a patent which sketches a family of proof core based metrics for hardware verification.
while the approach described by the patent is general no formal description of the models metrics algorithms or experimental results are provided.
viii.
c onclusions f uture work in this paper we have examined the use of proof based coverage notions for formal verification.
these provide an alternate way of measuring property completeness which in some cases are much more efficient than existing work in the literature while still providing accurate information about the covered parts of a given design.
most of our proposed metrics preserve provability which means that the set of elements considered covered by our algorithm is sufficient to establish the validity proof for every requirement in the set of specifications.
the notion of proof preservation is appealing because it allows a concrete demonstration to the user of the irrelevance of portions of the implementation.
the utility of the proposed metrics are being evaluated by rockwell collins on a pilot project.
the proposed metrics appear to be useful for both traceability and adequacy checking .
since some of the proposed metrics need to compute all ivcs we have investigated efficient algorithms for computing all ivcs .
in cases where there are multiple minimal satisfying sets the all ivcs give insight on multiple ways by which the model meets a requirement.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.