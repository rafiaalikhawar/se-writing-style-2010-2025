verifying the long run behavior of probabilistic system models in the presence of uncertainty yamilet r. serrano llerena national university of singapore singapore universidad de ingenieria y tecnologia lima peru yserrano utec.edu.pemarcel b hme monash university melbourne australia marcel.boehme acm.orgmarc br nink zurich switzerland marc u.nus.edu guoxin su university of wollongong wollongong australia guoxin uow.edu.audavid s. rosenblum national university of singapore singapore david comp.nus.edu.sg abstract verifying that a stochastic system is in a certain state when it has reached equilibrium has important applications.
for instance the probabilistic veri f ication of the long run behavior of a safety critical system enables assessors to check whether it accepts a human abort command at any time with a probability that is sufficiently high.
the stochastic system is represented as probabilistic model a longrun property is asserted and a probabilistic veri f ier checks the model against the property.
however existing probabilistic veri f iers do not account for the imprecision of the probabilistic parameters in the model.
due to uncertainty the probability of any state transition may be subject to small perturbations which can have direct consequences for the veracity of the veri f ication result.
in reality the safety critical system may accept the abort command with an insufficient probability.
in this paper we introduce the f irst probabilistic veri f ication technique that accounts for uncertainty on the veri f ication of longrun properties of a stochastic system.
we present a mathematical framework for the asymptotic analysis of the stationary distribution of a discrete time markov chain making noassumptions about the distribution of the perturbations.
concretely our novel technique computes upper and lower bounds on the long run probability given a certain degree of uncertainty about the stochastic system.
ccs concepts mathematics of computing !markov networks software and its engineering !model checking software veri f ication marc br nink is now at google.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for pro f it or commercial advantage and that copies bear this notice and the full citation on the f irst page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior speci f ic permission and or a fee.
request permissions from permissions acm.org.
esec fse lake buena vista fl usa acm.
.
.
.
.
.
.3236078keywords uncertainty probabilistic model checking long run properties perturbation analysis discrete time markov chains acm reference format yamilet r. serrano llerena marcel b hme marc br nink guoxin su and david s. rosenblum.
.
verifying the long run behavior of probabilistic system models in the presence of uncertainty.
in proceedings of proceedings of the 26th acm joint european software engineering conference and symposium on the foundations of software engineering lake buena vista fl usa november esec fse pages.
.
.
introduction probabilistic veri f ication is a powerful and mature technology which aims to verify systems that exhibit stochastic rather than deterministic behavior.
the stochastic system is represented by a stochastic model such as a discrete time markov chain dtmc .
a probabilistic model checker veri f ies this model against a given system property such as the minimum or maximum long run probability or reachability of a certain state.
for instance the lifecycle of software developed in a large company can be modeled as a dtmc where a state represents the current development stage of a software and the transition probabilities can be determined empirically from the lifecycle of software developed in the past.
a probabilistic model checker such as prism can then check whether the long run probability that a software is in the errorfree deployment stage exceeds some threshold.
however probabilistic veri f ication does not account for the imprecision of the probabilistic parameters in the model of the stochastic system.
often the speci f ied transition probabilities are accurate only to some degree.
for instance the transition probabilities in the dtmc model of the company s development lifecycle are computed as the sample mean over past instances.
however a sample mean is subject to variance and approximates the population mean only with some accuracy.
the company may hire new developers develop different software or improve the development process.
all of these contribute to our uncertainty about the speci f ic probability to transition from one development stage to another.
q uantifying the impact of uncertainty on the long run probability y. serrano m. b hme m. br nink g. su and d.s.
rosenblum previous work has successfully applied perturbation theory to many aspects of probabilistic model checking including different stochastic formalisms different kinds of properties to be veri f ied and different measures of perturbation distance as well as applications of the ideas to self adaptive software qos monitoring and cloud computing .
this paper presents results on dealing with uncertainty when verifying long run properties of dtmcs where we seek to determine the probability that a system whose stochastic behavior is subject to perturbation will be in a particular state of interest once the system has reached a steady state or equilibrium.
we propose to model a stochastic system that is subject to uncertainty as a parameterized dtmc where the speci f ic probability in each transition is subject to random perturbations.
we introduce a probabilistic veri f ication technique that provides an upper and lower bound on the long run probability for each state in the parameterized dtmc.
the bounds characterize the worst case consequences of uncertainty on the long run probability that the system is in a certain state at any time after it has reached equilibrium.
the veri f ication of long run probabilities is a very useful and versatile application of probabilistic model checking and can be applied to problems in software engineering as well as other domains.
as previously mentioned it allows us to check whether the probability that a safety critical system accepts an external abort command at an arbitrary point in time is sufficiently high.
as another example the presented technique can also be used to check which functions are most critical for a system because they are executed most often or which web pages on a server are important because they are visited with higher likelihood.
we introduce the pertinent concepts and evaluate our novel probabilistic veri f ication technique using three case studies.
in the f irst case study we discuss the probabilistic veri f ication of a long run property in the development lifecycle of a large mobile app development company.
in the second case study we investigate the impact of estimating the transition probabilities in the dtmc from empirical data i.e.
using maximum likelihood estimation .
of course a sample is subject to some variance resulting in small perturbations for the transition probabilities.
the dtmc models web pages on a server and the veri f ication task is to check the importance of those web pages given a sample of click stream data.
in the third case study we investigate the impact of changes to the program or its workload on determining the functions that are most critical for the program.
the dtmc models the sequence of function calls in the program and the veri f ication task is to check the probability that a function is exercised at any time after equilibrium given that the program or workload may slightly change.
the main contributions of this work are as follows we introduce the f irst probabilistic veri f ication technique that accounts for uncertainty in the veri f ication of long run properties of a stochastic system.
our technique uses perturbation analysis to provide upper and lower bounds on the system s long run properties which represent the worst case consequences of uncertainty.
we present a mathematical framework for the asymptotic analysis of the stationary distribution of a reducible or irreducible dtmc when the transition probabilities are subject to a randomperturbation.
we make noassumptions about the distribution of the perturbations re f lecting the reality that the degree of uncertainty for speci f ic state transitions is often unknown.
we present a prototype implementation of our work in python.
we evaluate our technique on three case studies.
our experiments indicate that our technique is able to provide an accurate estimation of the worst case consequences of uncertainty on veri f ication of long run properties in dtmcs.
the remainder of the paper is organized as follows.
section introduces a running example about lifecycles of software development.
an introduction to basic concepts of probabilistic model checking of dtmcs is presented in section .
section explains our technical approach to analyze the worst case consequences of the uncertainty on probabilistic veri f ication of long run properties in dtmcs.
section presents our experimental evaluation and results.
section discusses related work.
finally section summarizes our contributions and discusses future work.
motivation .
motivating example a markov model for the software development lifecycle of mobile apps throughout the paper we exemplify the pertinent concepts and approaches based on the software development lifecycle of a large mobile app development company.
for this company each mobile app goes through the following stages early stage s0 .
the app is created and actively developed.
once the app is feature complete it goes to incubation s1 .
however at this stage an app s development can also be abandoned s3 e.g.
for budget reasons.
incubation s1 .
the app implements all the intended functionality but requires some improvements and f ixes.
if it turns out that more features or substantial improvements are required the app goes back to the early stage s0 .
if the project is discontinued the app is retired s4 .
however if the app reaches a certain maturity is goes to deployment s2 .
once it is deployed it cannot go back to incubation s1 .
deployment s2 .
the updated app is uploaded to the app store and customers start to download and use the app.
deployment is part of the main development lifecycle.
if a user reports a bug the app is marked as buggy s6 .
abandoned s3 .
the app development is discontinued at the early stage.
once the development of an app is marked as abandoned it remains abandoned.
retired s4 .
the app development is discontinued at the incubation stage.
once an app is retired it remains retired.
repair s5 .
a developer creates a patch for the buggy app and submits it for peer review.
if the patch is accepted the app goes back to deployment s2 i.e.
the f ixed version is uploaded to the app store.
if the patch is rejected the app is again marked as buggy s6 .
buggy s6 .
the app contains a bug that was reported and needs to be f ixed.
the app is send for repair s5 .
q uantifying the impact of uncertainty on the long run probability esec fse november lake buena vista fl usa s0 start s1 s2 s3 s4 s5s60 x10 x2 x31 x4 x5 0early stageincubation deployment abandoned retired repairbuggy figure motivating example.
dtmc model of the development lifecycle of a mobile app.
to understand and improve the development lifecycle of their mobile apps the company records the various stages that each app undergoes.
for instance it can empirically determine the proportion of apps in the early stage s0 that reach incubation s1 or that areabandoned s3 .
thus the development lifecycle can be modeled as a discrete time markov chain with each development phase as astate each progression from phase to phase as transition and the proportion of apps progressing from one phase to another as transition probabilities .
the dtmc model for the company s development lifecycle is shown in figure .
for now we ignore the dashed rectangles and we consider the values of xiin the transition probabilities to be f ixed at x1 x5 .
.
problem statement in this work we investigate the worst case consequences of uncertainty on the veri f ication of long run properties in a discrete time markov chain.
in the development lifecycle of an app the company would like to understand the probability that an app in the longrun will be in deployment s2 i.e.
graduated from incubation and not buggy.
in the second column of table we can see that this probability s2 .
it is about times more likely that an app is abandoned or retired before it reaches the deployment phase s3 s4 .
however there are several sources of uncertainty in the modeling.
for instance the recorded lifecycles are only samples that are taken from a larger population future development lifecycles may not be well represented by the recorded ones.
the company may have changed the development process since beginning of the recordings current lifecycles may not be well represented by earlier ones.
hence the empirically determined transition probabilities are accurate only to some degree.
what does that mean for computing the probability s2that an app in the long run will be in the deployment stage s2 ?
we model the uncertainty in the transition probabilities as small perturbations in a parameterized markov chain where the symbolic perturbation vector xis added to the transition probabilities.
figure depicts the markov chain for our motivating example parameterized with the perturbation vector x hx1 x2 x3 x4 x5i.
we do notassume any knowledge about the distribution of values for x. this re f lects the reality that we cannot know the degree of uncertainty for speci f ic state transitions.
however we assume that the total perturbation distance xi2 xjxijfor alltable worst case consequences of uncertainty in the development lifecycle of mobile apps where .
stages si silinear bounds si si si si s0 .
.
s1 .
.
s2 .
.
s3 .
.
s4 .
.
s5 .
.
s6 .
.
parameterized state transitions can be provided as an upper bound on the total uncertainty in the stochastic process .
due to uncertainty the veri f ication of long run properties in a markov chain is correct only within certain accuracy bounds and sensitive to uncertainty in certain states more than in others.
our approach quanti f ies the accuracy of the computed probability that an app in the long run will be in the deployment stage s2 in the form of asymptotic bounds called linear perturbation bounds .
our approach also quanti f ies the sensitivity of the computed probability to uncertainty in each transition in the form of condition numbers .
for our motivating example the company is interested in the worst case consequences of uncertainty in the modeling of the development lifecycle if the total uncertainty was at least i.e jx1j jx2j jx3j jx4j jx5j .
for this purpose in the third column of table we compute a condition number sithat captures the effect of perturbation vector xin the computation of sisuch that i .
as can be seen from table the greatest condition number in the model of the development lifecycle of a mobile app corresponds to the probability that an app in the long run will beretired s4 .
in other words the long run probability of being ins4is the most sensitive to the perturbation vector x. based on the condition number siand the last column of table provides an estimate of the worst case consequences of uncertainty in the modeling of the development lifecycle calculated as si and named as linear perturbation bounds .
for instance the linear perturbation bounds that estimate the worst case consequences of uncertainty on veri f ication that an app in the long run will be in deployment stage s2 are calculated as s2 s2 .
we note that the perturbation distance is not needed to quantify sensitivity to perturbation si.
instead is used only to compute the linear perturbation bounds which approximate the worst case effect of perturbation .
our method also allows to specify multiple perturbation distances each of which is associated with the transition probabilities from the same state such that the resulting bounds are tighter.
however the ability to specify a single perturbation distance makes our method the only one available to provide asymptotic bounds whenever specifying the individual probability perturbations is impossible or impractical e.g.
in the presence of unpredictable environmental factors such as failures disasters and workload .
q uantifying the impact of uncertainty on the long run probability y. serrano m. b hme m. br nink g. su and d.s.
rosenblum background .
discrete time markov chains a discrete time markov chain dtmc represents the stochastic behavior of a probabilistic system.
speci f ically a dtmc is a transition system with probability distributions for the successors of each state.
formally a dtmc is de f ined as follows d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
discrete time markov chain dtmc .
a dtmc is a tupled 1s p sinit ap lowhere sis a f inite set of states p s s!
4is a probabilistic transition function such that 8s2s t2sp1s to sinit sis a set of initial states apis a f inite set of atomic propositions and l s!2apa labeling function.
in addition we de f ine init s!
4as the initial state distribution such that s2s init1so 1and8t sinit init1to .
for instance in figure we have s fsij0 i 6g sinit fs0g ap fearly stage incubation deployment abandoned retired repair buggyg and for instance l1s0o early stage andp1s0 s1o .
furthermore init1s0o 1and init1sio 0fori .
d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
sub dtmc.
letd 1s p sinit ap lobe a dtmc.
a sub dtmc ofdis a tuple1s0 p0osuch that s0 s and p0 s0!
4where for all s s02s0 p01s s0o p1s s0oand s02s0p01s s0o .
the digraph ofd denoted as g1s eo is induced as there is one node for each state s2sand a direct edge1s to2eif only if p1s to .
an in f inite path in a dtmc dis a sequence of the form s0s1s2 where si2sandp1si si 1o 0for all i .
a f inite path is a pre f ix of an in f inite path ending in a particular state where s0s1 snsuch that n j j. in this context we say a state snisreachable from s0if there is a f inite path .
a set of states s0 sinduces a strongly connected subgraph scs of a dtmcdif only if for all s t2s0there is a path from s totvisiting only states from s0.
a strongly connected component scc ofdis a maximal w.r.t.
scs of s. a bottom strongly connected component bscc of dis an scc s0from which no state outside s0is reachable.
we denote bscc d as the set of all bsccs of the underlying digraph of d. a dtmcdis said irreducible if all its states belong to a single bscc.
irreducibility of a dtmc is important for convergence to equilibrium as n!
because the convergence should be independent of any start state.
in case a dtmc is not irreducible we say that is reducible .
for instance the dtmc in our motivating example is reducible as the states belong to three bsccs shown as dashed boxes in figure .
given a dtmcd the period of state sis de f ined as d1so gcdfn2n pn1s so 0g.
state sisaperiodic ifd1so 1and periodic ifd1so .
in this context a dtmc dis said to be aperiodic if all its states are aperiodic.
correspondingly if all states ofdare periodic thendisperiodic .
.
parametric discrete time markov chains inspired by previous studies we use a parametric model to integrate the uncertainty which is expressed as small perturbations to transition probabilities in the dtmc.
d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
parametric discrete time markov chain pdtmc .
letd 1s p sinit ap lobe a dtmc and x hx1 xmibe aperturbation vector.
a pdtmc is a tuple d x1 1s p x1 sinit ap lo where p x1 4is a parametric transition function based on p and s sinit apandlare de f ined as de f inition .
figure depicts a parameterized dtmc where x hx1 x2 x3 x4 x5i.
.
long run properties in dtmcs in probabilistic model checking of dtmcs long run also named as steady state properties are used to analyze the reliability of probabilistic systems and to obtain performance parameters such as throughput delay loss probability etc.
formally given a dtmc d the long run properties study the limit behavior of the probability vector d1to ds1to1 4s2swhen time tends to in f inity limt!1 d1to .
this limit when exists is called steady state probability vector and it is written as d ds1 4s2s.
intuitively we can interpret dsas the long run mean fraction of time the dtmc dis in state s. in this paper we are interested in the computation of the longrun probability of being in a particular state shaving started in initial states of a given dtmc d. we denote this probability as ds.
for convenience we simply mention sinstead of dswhen dis clear in the context.
to compute long run probabilities in dtmcs previous studies have demonstrated that the steady state probability vector exists if the dtmc is irreducible and aperiodic.
unfortunately it is not that case in all probabilistic models.
thus to avoid with periodic considerations we use the long run average probability for computing the steady state probability vector dof a dtmc d. consequently the procedure for computing the long run probability dsis based on the following conditions .
.
dtmcdis irreducible.
letd 1s p sinit ap lobe an irreducible dtmc and given a particular state s2s we compute the long run probability dsas follows d s s02sn limn!
nn k 1pk1s0 soo where pk1s0 sodenotes the probability of dtmc dbeing in state safter exactly ktransitions when starting in state s0.
.
.
dtmcdis reducible.
letd 1s p sinit ap lobe a reducible dtmc and given a particular state s2s.
to compute the long run probability ds we f irst identify the set of all bsccs of the underlying digraph of d denoted as bscc1do.
then we evaluate whether state sbelongs to any bscc k2bscc1do.
in the affirmative case the probability dsis the combination of i the probability of reaching the bscc khaving started in the initial states of the model denoted as prd1 ko and ii the long run probability of state sin a sub dtmcd1ko 1k pkoofd induced by bscc k where pk 1p1s toos t2k.
in short ds prd1 ko d1ko s since every bscc is irreducible we follow equation for computing the probability d1ko s .
otherwise ds .
perturbation approach in this section we present our technical approach for estimating the worst case consequences of uncertainty on the computation of long run probabilities in dtmcs based on perturbation analysis.
q uantifying the impact of uncertainty on the long run probability esec fse november lake buena vista fl usa we f irst use a parameterized dtmc to model the presence of uncertainty which is expressed as small perturbations to transition probabilities.
then we de f ine a variation function that presents a mathematical characterization of the perturbation in the veri f ication of long run properties.
this function captures the difference between the veri f ication of a long run property against a perturbed dtmc and its associated unperturbed dtmc.
lastly we look for the linear fragment of the variation function that provides a useful approximate solution of this function.
based on this linear fragment and using the concept of condition numbers we compute linear perturbation bounds that reveal the worst case consequences of perturbations on the veri f ication of long run properties in dtmcs.
.
dealing with uncertainty letd 1s p sinit ap lobe the unperturbed dtmc.
we f irst identify the probabilistic transitions that are vulnerable to perturbations.
then we capture the presence of these perturbations by using a perturbation vector x hx1 xmiwhere mis the total number of perturbation variables in x. based on the unperturbed transition function p we incorporate the perturbation vector xinto the parametric probabilistic transition p x1 which is de f ined as follows d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
parametric probabilistic transition function.
given a perturbation vector x hx1 xmiand a non parametric probabilistic transition p p x1 4is the parametric probabilistic transition function such that s t2sp x1 41s to 1and each entry p x1 41s toof p x1 4is de f ined as follows p x1 41s to p1s to ifp1s to 0orp1s to p1s to xiif9xi2 xsuch that v.altuln1s t xio p1s to otherwise where v.altuln1s t xiois true if the transition from state sto state tis vulnerable to perturbation and xi2 xrepresents the perturbation for the transition from stot.
p r.sc o.sc p.sc o.sc s.sc i.sc t.sc i.sc o.sc n.sc .
given a vector x hx1 xmi letibe a partition onf1 mg. a sub vector y.alt hxj xkiis an independent perturbed sub vector in the partition isuch that j k m. for all y.alt2i t2sp x1 41s to t2sp1s to xi2 y.altxifor some s2s.
proposition states that each element of xfalls into an independent perturbed sub vector y.altand all variables of a sub vector y.altare used.
on the other hand it is always assumed that the vector x hx1 xmiis within the setu.. f x2rmj8 y.alt2 i xi2 y.altxi p x1 pg.
we refer the parametric dtmc d x1 de f inition as the perturbed version of dtmcd.
to illustrate the de f initions above consider again the dtmc model of the development lifecycle of a mobile app presented in figure .
in the following we denote this dtmc as dlc.
as we introduced in section there are several sources of uncertainty in the modeling ofdlc which are expressed as small perturbation in the probabilistic transitions of the model.
as figure shows the uncertainty in the model is depicted by the perturbation vector x hx1 x2 x3 x4 x5i.
note that we only incorporated variables into transitions between and .
the presence of xindlchas as a consequence the de f inition of pmc dlc x1 4where the only difference between both models is the parametric function p x1 .based on proposition each perturbation variable xi2 xfalls into two independent perturbed sub vectors y.alt1 hx1 x2 x3iand y.alt2 hx4 x5i.
as a result we have i f y.alt1 y.alt2g.
note that each sub vector is associated to the outgoing transitions of a perturbed state.
for example sub vectors y.alt1and y.alt2are associated to states s1 ands2 respectively.
.
variation function for long run properties in dtmcs this section presents a mathematical characterization of the perturbation on veri f ication of long run properties in dtmcs.
recall that a variation function captures the difference between the computation of a long run probability in a perturbed and unperturbed model.
following the computation of long run probabilities described in section .
we present two variation functions i for irreducible dtmcs and ii for reducible dtmcs.
d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
variation function irreducible case.
let d 1s p sinit ap loandd x1 1s p x1 sinit ap lobe an irreducible dtmc and its parametric irreducible variant respectively.
a variation function ofd x1 4against the long run probability of a particular state s2sis 1s uo!
4de f ined as follows 1s xo d x1 s d s before presenting the variation function for reducible dtmcs let us recall that given an unperturbed reducible dtmc d the computation of ds 0if and only if s2k k2bscc1do.
the value of dsdepends on two components the reachability probability from initial states to bscc k denoted as prd1 ko.
the long run probability of state sin sub dtmcd1ko denoted as d1ko s if and only if s2bscc k. under those circumstances we de f ine the variation function for reducible dtmcs as follows d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
variation function reducible case.
let d 1s p sinit ap loandd x1 1s p x1 sinit ap lobe a reducible dtmc and its parametric reducible variant respectively.
let k s be a bscc.
a variation function of reducible d x1 4with respect to the long run probability of a particular state s2kis 1s uo!
de f ined as follows 1s xo prd x1 ko d1ko x1 s prd1 ko d1ko s whered1ko x1 4andd1korepresent the perturbed and unperturbed sub dtmc ofd x1 4andd respectively.
.
linear perturbation bounds the key idea behind perturbation theory is to reduce a hard problem into an in f inite sequence of relatively simple ones.
we compute the linear perturbation bounds that capture the veri f ication effect of uncertainty in the form of condition numbers.
these bounds provide a useful approximate solution to the variation function.
we de f ine the linear perturbation bounds i for irreducible dtmcs and ii for reducible dtmcs.
for each case we f irst de f ine the linear fragment of its corresponding variation function.
then we de f ine the condition number based on the linear fragment.
last we compute the linear perturbation bounds based on the condition number and the total perturbation distance 0of the model.
q uantifying the impact of uncertainty on the long run probability y. serrano m. b hme m. br nink g. su and d.s.
rosenblum .
.
irreducible case.
let 1s xobe the variation function for irreducible dtmcs with respect to the long run probability of a particular state s de f inition .
the linear fragment of the variation function 1s xois de f ined as follows t h.sc e.sc o.sc r.sc e.sc m.sc .
.
linear fragment of 1s xo irreducible case.
let 1s xobe the variation function for irreducible dtmcs.
for any x2u the linear fragment 1of is formulated as follows 11s xo s02sn limn!
nn k 1 i j k 11pjp?pio1s0 soo where p?
p x1 p. p r.sc o.sc o.sc f.sc.
let us start by analyzing the variation function 1s xo d x1 s ds equation .
using the solution of the unperturbed dsas an approximation to the solution of the perturbed d x1 s we can express the variation function 1s xoas follows 1s xo s02slimn!
n p1s0 so where p n k 1p x1 4k n k 1pk letp?
p x1 pand xi2 xjxijbe the total perturbation distance.
by expanding the term pof equation we have n k 1p x1 4k n k 1pk n k 11p?
pok n k 1pk as we look for the linear fragment of 1s xo we ignore any term of more one copy of p?in equation .
as a result we have n k 1p x1 4k n k 1pk n k 1 i j k 11pjp?pio o1 2o where xi o1 o. based on previous equation we conclude linear fragment 1as equation .
based on the linear fragment 1 we de f ine the condition number and linear perturbation bounds for irreducible dtmcs as follows d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
condition number irreducible case.
let htdenote the transpose of vector h. let x2u be a perturbation vector.
we can write 11s xoin the form 11s xo x htfor some constant vector h. thus we can de f ine the condition number irrsfor an irreducible dtmc as follows irr s 2max xi xj2 y.alt y.alt2i1 hi hjo d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
linear perturbation bound irreducible case.
let xi2 xjxijbe the total perturbation distance.
let dsand irrs be the unperturbed long run probability and the condition number of a particular state sin an irreducible dtmc d respectively.
a pair of upper and lower linear perturbation bounds for the variation function 1s xoare de f ined as follows f irr d s irr s andf irr d s irr s as an illustration consider again pdtmc dlc x1 4shown in figure .
as the f igure shows the dashed rectangles represent the set of bsccs of the model k1 fs2 s5 s6g k2 fs3gandk3 fs4g.
suppose we are interested to estimate the worst case effect of perturbed sub vector y.alt2 hx4 x5ion the veri f ication of the probability that an app in the long run will be in deployment1s2o.
since s22k1 we only focus on bscc k1that induces a sub pdtmcd y.alt21 41k1o 1k1 p y.alt21 4k1owhere p y.alt21 4k1 1p x1 41s toos t2k1and y.alt2 x. it is important to notice that the sub pdtmc d y.alt21 41k1ois irreducible.
under those circumstances we follow the computation of linear perturbation bounds for irreducible dtmcs.
first we de f ine the variation function 1s2 y.alt2o d y.alt21 41k1o s2 d1k1o s2 de f inition .
then by theorem .
we calculate 11s2 y.alt2o 166x4 166x5 as the linear fragment of .
next we compute irrs2 166o de f inition .
since the company is interested in the worst case effect of uncertainty in the modeling of the development lifecycle if the total uncertainty was at least we compute the upper bound f irr 5o10 001o and the lower bound f irr 5o10 001o .
note that we consider jx4j jx5j .
.
.
reducible case.
following the same strategy as for the irreducible case we start by de f ining the linear fragment of the variation function 1s xofor reducible dtmcs as follows t h.sc e.sc o.sc r.sc e.sc m.sc .
.
linear fragment of 1s xo reducible case.
let s2bscc k. let 1s xobe the variation function for reducible dtmcs with respect to long run property of a particular state s. for any x2u the linear fragment of 1s xois de f ined as follows 11s xo prd1 ko 11s xo 11 xo d1ko s where prd1 kois the reachability probability from initial states to k 11s xois the linear fragment of variation function for irreducible dtmcs w.r.t.
long run probability of s presented in theorem .
11 xo inita?1a0 x1 4a?b b0 x1 4ois the linear fragment of a variation function i1 xofor reachability properties in dtmcs and d1ko s is the long run probability of state sin sub dtmcd1ko induced by k. p r.sc o.sc o.sc f.sc.
let us analyze the variation function 1s xopresented in equation .
the f irst term of prd x1 kowas studied by su et al.
.
the authors presented the following expansion prd x1 ko prd1 ko i1 xo where i1 xo a?a0 x1 a?a0 x1 z i copies of a?a0 x1 41a?a0 x1 4a?b a?b0 x1 4ofor each i such that a?
1i ao b 1p1s0 koos021snko b x1 1p x1 41s0 koos021snko b0 x1 b x1 b a 1p1s0 toos0 t2snk a x1 1p x1 41s0 toos0 t2snkanda0 x1 a x1 a. by substituting the above expansion into equation we can rewrite the variation function 1s xoas follows 1s xo prd1 ko d1ko x1 s d1ko s1 i1 xo d1ko x1 s it is important to note that the term d1ko x1 s d1ko s in equation is the de f inition of variation function for irreducible dtmcs denoted as 1s xo de f inition .
thus by substituting 1s xointo equation we have 1s xo prd1 ko 1s xo i1 xo d1ko x1 s where the term d1ko x1 s s02sn limn!
n n k 1pk x1 4k1s0 soo q uantifying the impact of uncertainty on the long run probability esec fse november lake buena vista fl usa letp?
k pk x1 pkand xi2 xjxijbe the total perturbation distance.
expanding the term n k 1pk x1 4k we have n k 1pk x1 4k n k 11p?
k pkok n k 1pk k n k 1 i j i j k 11pjp?
kpio o1 2o where xi o1 o. it is important for calculating the linear fragment of 11s xoto ignore any term of more one copy of p?
kin equation .
combining the above equations and equation we conclude as linear fragment of 1s xoas equation .
based on linear fragment 11s xo we de f ine the condition number and the linear perturbation bound for reducible dtmcs as follows d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
condition number reducible case.
let htdenote the transpose of vector h. let x2u be a perturbation vector.
we write 11s xoin the form 11s xo x htfor some constant vector h. thus we de f ine the condition number redsfor a reducible dtmc as follows red s 2max xi xj2 y.alt y.alt2i1 hi hjo d e.sc f.sc i.sc n.sc i.sc t.sc i.sc o.sc n.sc .
linear perturbation bound reducible case.
let xi2 xjxijbe the total perturbation distance.
let dsand reds be the unperturbed long run probability and the condition number of a particular state sin a reducible dtmc d respectively.
a pair of upper and lower linear perturbation bounds for the variation function 1s xoare de f ined as follows f red d s red s andf red d s red s to exemplify the computation of linear perturbation bounds in reducible dtmcs consider again the reducible pdtmcdlc x1 with perturbation vector x hx1 x2 x3 x4 x5iin figure .
suppose again we are interested to estimate the worst case effect of x on veri f ication of the long run probability that an app will be in deployment s2 in the pdtmcdlc x1 .
recall the set of bsccs are k1 fs2 s5 s6g k2 fs3gandk3 fs4g.
by de f inition and given that s22bscc k1 we f irst de f ine 1s2 xo prdlc x1 k1o 1s2 xo i1 xo d1k1o x1 s2as the variation function where d1k1o x1 s2denotes the long run probability that an app will be in deployment s2 in the sub pdtmc d1k1o x1 induced by bscc k1.
following theorem .
the linear fragment of 1s2 xois de f ined as 11s2 xo prdlc1 k1o 11s2 xo 11 xo d1k1o s2where prdlc1 k1o 11s2 xo 166x4 166x5 irreducible case 11 xo 111x1 666x2and d1k1o s2 .
thus we have 11s2 xo 0221x1 133x2 0648x4 0092x5.
consequently based on de f inition the condition number reds2 shown in table .
and since we are interested in the worst case effect of xwhen the total perturbation distance we compute the upper bound f red 067o10 001o and the lower bound f red 067o10 001o .
t h.sc e.sc o.sc r.sc e.sc m.sc .
.
the time complexity for computing the linear perturbation bounds is o1jdj3o.p r.sc o.sc o.sc f.sc.
letdbe a dtmc andjdjbe the sum of the numbers of vertices and edges in the digraph of d. the computation of linear perturbation bounds for irreducible and reducible dtmcs are based on the calculation of linear fragments 1 theorem .
and 1 theorem .
respectively.
note that 1is de f ined in terms on 1. by analyzing theorem .
we observe that each term of the sum can be computed in time o1jdj3o.
and the computation of 1 and 1is dominated by this complexity bound.
experimental evaluation in this section we evaluate the applicability of our approach in two case studies.
our purpose is to demonstrate that the computed asymptotic bounds provide an accurate estimation of the worst case consequences of uncertainty on veri f ication of long run behavior in systems modeled as dtmcs.
for this purpose we have developed a prototype implementation in python.
for each case study we f irst build the system model as a dtmcd.
second based on the designer expertise we identify transitions vulnerable to perturbations.
a perturbation variable is attached to each probabilistic transition.
as a result we obtain the perturbation vector x. third we formulate the long run probability of being in a particular state sto be analyzed denoted as s. these aforementioned components are the input of our prototype.
by following our perturbation approach described in section our prototype computes a condition number sthat captures the effect of uncertainty in the veri f ication of s. lastly our prototype calculates linear perturbation bounds based on the computed condition number and a given perturbation distance .
the prototype can be found in master paper fse18.zip.
for our experiments we used a machine with .
ghz intel core duo processors and 8gb ram.
.
clickstream data model .
as a f irst case study we model the stochastic process of users clicking through the web pages on a server as an irreducible dtmc .
speci f ically we use public clickstream data collected for a popular news site msnbc.com .
the data spans the entire day of september and it contains logs.
each log represents a clickstream.
a clickstream is a sequence of web page categories visited by a given user.
the categories are listed in table .
the dtmc dcl 1s p sinit ap loconsists of states s fs1 s17gwhich represent the categories of the news site.
the set of initial states sinitis composed by the front page s1 .
the transitions indclrepresent the sequences of clicks from one category page to another.
p1si sjois calculated by counting all instances of state sithat precede state sjacross all clickstreams.
the model contains 17states and 289transitions.
we investigate the impact of estimating the dtmc s transition probabilities from empirical data using maximum likelihood estimation.
the clickstream sample is subject to some variance resulting in small perturbations to the estimated transition probabilities.
we are interested in the probability that a user is visiting a certain webpage in the long run.
thus we calculate the long run probabilities dcl siof all states siwith i .
in the following we simply refer to dcl sias si.
q uantifying the impact of uncertainty on the long run probability y. serrano m. b hme m. br nink g. su and d.s.
rosenblum table experimental results for clickstream data categories si sitime categories si sitime siname1 0o min siname1 0o min s1front page .
.
.
s3tech .
.
.
s14bbs .
.
.
s13summary .
.
.
s2news .
.
.
s10living .
.
.
s8weather .
.
.
s9health .
.
.
s4local .
.
.
s11business .
.
.
s7misc .
.
.
s15travel .
.
.
s6on air .
.
.
s16msn news .
.
.
s12sports .
.
.
s17msn sports .
.
.
s5opinion .
.
.
s17s15s16 s11s9s10s13 s3s5 s12s6s7s4s8 s2s14 s1 unperturbed long run probability sicondition number si figure relationship between the long run probability and condition number of a web page uncertainty .
the dtmcdclthat we created from the observed clickstream data is subject to sampling error on each state transition the sampling error will compound and threaten the validity of any veri f ication results.
the clickstream data was collected on a single day.
thus the data is merely a sample of the population of visitors to msnbc.com .
sample statistics represent population statistics only to some degree of accuracy.
to account for the sampling error we perturbed each probabilistic transition in the markov model dcl.
in total we added perturbation variables x hx1 x289i one for each transition.
after perturbing the model we are interested in analyzing which state is affected most by the perturbation i.e.
which state is most susceptible to compounding sampling errors.
for this reason for each state si we compute its corresponding condition number si by using our approach.
we present experimental results for this case study in table .
the f irst two columns depict the set of web page categories which are ordered from the most visited to least visited.
the next column shows the probability sithat a visitor in the long run visits page si given the ideal scenario .
the last column depicts the corresponding condition number si.
as can be seen from table in an unperturbed model the mostvisited page is the front page .
followed by bbs .
and news .
.
on the contrary the least visited pages are msn news .
and msn sport .
.
in figure we compare the long run probabilities in the unperturbed model x axis with the condition numbers for each state si.
the condition numbers indicate the effect of perturbing vector xduring the computation of si i.e.
the impact of the unknown sampling error on the calculated long run probabilities.table accuracy of the linear perturbation bounds categories si si si si si siname s1 front page .
.
.
.
.
.
.
.
s16msn news .
.
.
.
.
.
.
.
s8weather .
.
.
.
.
.
.
.
s5opinion .
.
.
.
.
.
.
.
observations .
figure allows us to make several insightful observations.
first it reveals that the msn news page denoted as s16 even though it is one of the least visited pages with s16 is very sensitive with respect to perturbations of the transitions probabilities.
we can draw this conclusion from the large condition number s16 .
this f inding indicates that small changes in the transition probabilities may have a severe impact on the number of visits to the msn news page.
second the sensitivity of the front page which is the most visited page has a condition number s1 that is close to the median of .
thus the frontpage is not particularly susceptible to perturbation of transition probabilities.
finally inspecting figure we cannot f ind a clear correlation between the long run probability and the condition number.
this implies that the most and least visited web pages are only weakly sensitive to the effect of uncertainty.
soundness .
to evaluate whether our perturbation techniques provides a sound estimate of the worst case consequences of uncertainty in the computation of long run probabilities we introduce table .
as the table shows we have restricted our evaluation to the most visited page in the unperturbed scenario and three of the mostsensitivity pages.
table depicts that for each page we perturbed a non parametric dtmc with distances .
then we calculate the long run probability against a non parametric dtmc with distance .
and we compare the perturbed and unperturbed long run probability denoted as si against our estimate si of the worst case effect of uncertainty in the computation of si.
under the assumption that specifying individual probability perturbations is impossible or impractical for this experiment the allocation of to transition probabilities represents one of the possible allocations not the worst case distribution.
our experimental results show that for each table the estimate si provide a safe prediction of the impact of perturbations.
for example the difference between the probabilities for the perturbed and unperturbed models for the front page is which lies within our estimation of .
in summary using perturbation analysis we succeed in detecting a web page category msn news that is very sensitive to small changes to the transition probabilities.
even minor changes to the transition probabilities might signi f icantly impact the frequency of visits to the msn news pages.
perturbation analysis of dtmc re f lects uncertainties in the model.
these uncertainties include but are not limited to uncertainties due to sampling error and changing user behavior.
the insights generated by our perturbation analysis will be very helpful for capacity planning and related activities.
q uantifying the impact of uncertainty on the long run probability esec fse november lake buena vista fl usa .
call invocation sequences in this section we continue by investigating how the software engineering community can bene f it from our approach in particular how the technique can help during software maintenance.
model .
to this end we model the invocation sequence graph forwc a program in the coreutils .
tool set.
wcparses the standard input or alternatively a set of f iles and counts various attributes of the read data.
by default it counts number of lines words and bytes.
we focus on wcfor a multitude of reasons.
first coreutils is widely distributed and used daily across a diverse user population.
second wchas a long development history dating back to at least making it a very mature software artifact.
third since coreutils is very mature we expect a mature test suite which we utilize to collect transition probabilities to model a dtmc and exemplify the strength of the proposed perturbation technique.
finally we picked the wcprogram from the coreutils tool set due to prior exposure to its source code.
thus we were able to manually verify our results using existing prior knowledge.
similar to the previous case study we model wcas an irreducible dtmcdwc.
the set of states scontains all unique functions called during runtime of wc.
each called function fiis represented as a state si2s.
additionally scontains two pseudo states start and end that represent program start and program termination respectively.
the set of initial states sinitconsists of the start state.
the transitions indwcrepresent the sequences of calls observed during runtime.
we do not model function returns.
in particular p1si sjois calculated by counting the fraction of calls to the function firepresented by sithat is directly followed by a call to the function fjrepresented by state sj.
a transition fitofjindicates that function fjmight be called either by fidirectly or by any caller offi.
thus we model function call sequences not call graphs.
to gather runtime data we instrument wcwith llvm xray .
.
.
in particular we use llvm xray s capability to collect all function enter and exit events that occurs during runtime.
next we execute the test suite of coreutils against the instrumented wc binary.
we obtain 42trace f iles that contain 072logged function calls.
we use these 072function calls to create dwcas described above.
the resulting model contains 46states representing functions plus pseudo states and 72transitions.
uncertainty .
a common challenge in the context of software maintenance is to judge about the impact of a prospective change.
our technique can be used to analyze the sensitivity of a function with respect to call frequency if transition probabilities are perturbed.
this can be helpful in the context of software maintenance to for example let us assume a change is pending.
in order to judge about the risk involved in applying the change to the software especially with regard to performance we would like to know how often the changed function fiis expected to be executed.
that is we are interested in computing the long run probability si.
if the function fihas a high probability of being executed then any change to this function might have a severe impact on availability and performance of the software artifact.
in contrast if the execution probability is low then the risk involved is lower.
we use the previously described model capturing call invocation sequences to analyze the execution frequencies for wc.
to account for uncertainties we perturb all 40probabilistic transition thattable experimental results of wcwhere si function dwc si1 0o si time min s2 umaxtostr .
.
.
s11 to uchar .
.
.
s3 argv iter .
.
.
s8 wc f ile .
.
.
s7 wc .
.
.
s6 fdadvise .
.
.
s4 safe read .
.
.
s5 write counts .
.
.
is0 p1si sjo of the model where x hx1 x40i.
the experimental results are shown in table .
the rightmost column in table contains the condition number si.
due to space constraints we present only a limited sub set of functions of wc.
we show all functions for which the condition number si .
the functions are ordered by decreasing condition number.
we also show the long run probability siunder no perturbation .
observations .
the f irst entry in table describes umaxtostr .
of all the functions observed during runtime umaxtostr is most sensitive to perturbations s2 .
it is also the most often executed function with a long run execution probability of .
.
thus any changes to umaxtostr should be associated with a higher risk.
the next entry describes to uchar .
looking at the execution probability of to uchar .
we would predict that changes to this function are likely unproblematic as it is executed very seldom.
however the condition number for to uchar is relatively high s11 .
this indicates that small changes to the transition probabilities can have a severe impact on the execution frequency of to uchar .
we investigate the call sites of to uchar .
all recorded calls to to uchar originate from wc.c line and .
these lines are executed only if wcwas instructed to count characters or words or extract the maximum line length.
thus how often to uchar is executed depends strongly on the requested operation.
even though to uchar is executed only seldom in our test environment any changes to it should be marked as risky since the selection of runtime options might severely increase its invocation rate.
the high condition number for to uchar correctly identi f ies this sensitivity.
figure shows the relationship between unperturbed longrun probability log scale and condition number for wc.
similar to figure in the previous clickstream data scenario we cannot f ind a clear correlation between the long run probability and the condition number.
soundness .
to evaluate the soundness of our perturbation estimate generated by our technique we conducted additional experiments shown in table .
we f irst built a non parametric model with small perturbation distances .
second we compute the long run probability for a sub set of functions of wcin the perturbed model denoted as si.
in particular we perturbed all probabilistic transitions in the strongly connected subgraph that performs the actual work of counting the requested properties from the input f iles.
that is we perturb all outgoing transitions from umaxtrostr wc safe read to uchar argv iter arg iter n args and call freefun .
then we compare the perturbed and unperturbed long run probabilities computed as q uantifying the impact of uncertainty on the long run probability y. serrano m. b hme m. br nink g. su and d.s.
rosenblum table additional experimental results for wc functions si si 3 3 si name si1 o si1 o si 1 o si1 o si1 o si 1 o si1 o si1 o si 1 o s2 umaxtostr .
.
.
.
.
.
.
.
s11 to uchar .
.
.
.
.
.
.
.
s3 argv iter .
.
.
.
.
.
.
.
s8 wc f ile .
.
.
.
.
.
.
.
1010203040umaxtostr to uchar unperturbed long run probability sicondition number si figure relation between functions and cns for wc si si si.
lastly we calculate the estimate si which provides the worst case effect of uncertainty in si.
for each function the estimate si in table represents a safe prediction of the worst case consequences caused by the perturbation.
for example given that the difference between the actual long run probabilities of function to uchar for the perturbed and unperturbed models is 002with lies within the estimation of .
the accuracy of this prediction is replicated where .
we obtained similar results for all functions presented in table .
finally note that to uchar is affected substantially by the perturbations from a relative perspective.
in contrast the long run probabilities of the other functions are quite stable across the different perturbation distances.
related work there is a rich body of literature that investigates f inite irreducible markov chains under perturbation.
many of those works focus on the effect of the perturbed transition matrix of a markov chain on its steady state distribution.
similar analysis has also been applied to queueing models .
one common technique is the derivation of norm based bounds for irreducible markov chains.
speci f ically they computed a condition number for measuring the sensitivity of the markov chain.
let e 1ej io2rn ndenote the perturbation.
letpandp0 p ebe probability transition matrices of irreducible markov chains with respective stationary probability vectors and 0satisfying p 0p0 0 and i i i 0 i. then k 0k kekfor suitable vector and matrix norms.
in those approach the condition number has been calculated by using the fundamental matrix of a markov chain as introduced by kemeny et al.
and schweitzer the group inverse of a i pas presented in the ergodicity coefficients and the mean f irst passage times .
all these approaches for computing the condition number were collected and compared by cho and meyer .
based on their review the smallest condition number is computed by using relevant information of the group inverse of a. this approach was proposed by haviv et al.
and kirkland et al.
.
however cho and meyer also revealed that the computation of the fundamental matrix and the group inverse are usually expensive.
for this reason the condition number in terms of the mean f irst passage is more feasible to be computed.
likewise it provides an equivalent condition number to haviv s de f inition based on the underlying structure of the markov chain.
together these studies provide valuable insights into the investigation of the sensitivity of the stationary distribution of markov chains under perturbation.
however these previous studies compute the condition number based on the perturbation e which is a matrix of prior de f ined values.
even though we are interested in analyzing the effect of the perturbation in the long run behavior of dtmcs our proposal is different from these previous studies in two points.
first we ignore the de f ined values that the perturbation might take.
thus we propose to capture the perturbation as symbolic variables.
and to provide an estimation of the worstcase consequences of the uncertain phenomena.
second previous studies have not been applied in probabilistic model checking.
to the best of our knowledge no previous publication in the literature has addressed this problem using perturbation analysis.
conclusion the main goal of this paper is to estimate the worst case consequences of uncertainty on veri f ication of long run properties in dtmcs.
our main contribution is a mathematical framework for asymptotic analysis in the presence of small perturbations to model probabilities on veri f ication of long run properties against dtmcs.
to evaluate our perturbation approach we implemented a prototype in python.
we ran our experiments on clickstream data and call invocation sequences.
these case studies have been modeled as a dtmc and affected by small perturbations for our evaluation purposes.
for each case study we evaluated several long run properties under the presence of perturbations.
our experimental results reveal the importance of our approach at estimating the effect to these perturbations and they provide crucial information for identifying the sensitivity of the long run properties under uncertainty.
this work is the f irst study on dealing the uncertain phenomena in the veri f ication of long run properties in dtmcs by using perturbation analysis.
there are several directions for further study including backward analysis that provides the maximum permitted perturbations based on a range of veri f ication results.
q uantifying the impact of uncertainty on the long run probability esec fse november lake buena vista fl usa