learn fuzz machine learning for input fuzzing patrice godefroid microsoft research usa pg microsoft.comhila peleg technion israel hilap cs.technion.ac.ilrishabh singh microsoft research usa risin microsoft.com abstract fuzzing consists of repeatedly testing an application with modified or fuzzed inputs with the goal of finding security vulnerabilities in input parsing code.
in this paper we show how to automate the generation of an input grammar suitable for input fuzzing using sample inputs and neural network based statistical machine learning techniques.
we present a detailed case study with a complex input format namely pdf and a large complex security critical parser for this format namely the pdf parser embedded in microsoft s new edge browser.
we discuss and measure the tension between conflicting learning and fuzzing goals learning wants to capture the structure of wellformed inputs while fuzzing wants to break that structure in order to cover unexpected code paths and find bugs.
we also present a new algorithm for this learn fuzz challenge which uses a learnt input probability distribution to intelligently guide where to fuzz inputs.
index terms fuzzing deep learning grammar based fuzzing grammar learning i. i ntroduction fuzzing is the process of finding security vulnerabilities in input parsing code by repeatedly testing the parser with modified or fuzzed inputs.
there are three main types of fuzzing techniques in use today blackbox random fuzzing whitebox constraint based fuzzing and grammarbased fuzzing which can be viewed as a variant of model based testing .
blackbox and whitebox fuzzing are fully automatic and have historically proved to be very effective at finding security vulnerabilities in binary format file parsers.
in contrast grammar based fuzzing is not fully automatic it requires an input grammar specifying the input format of the application under test.
this grammar is typically written by hand and this process is laborious time consuming and error prone.
nevertheless grammar based fuzzing is the most effective fuzzing technique known today for fuzzing applications with complex structured input formats like webbrowsers which must take as untrusted inputs web pages including complex html documents and javascript code.
in this paper we consider the problem of automatically generating input grammars for grammar based fuzzing by using machine learning techniques and sample inputs.
previous attempts have used variants of traditional automata and context free grammar learning algorithms see section vii .
in contrast with prior work this paper presents the first attempt at using neural network based statistical learning techniques for this problem.
specifically we use recurrent neural networksfor learning a statistical input model that is also generative it can be used to generate new inputs based on the probability distribution of the learnt model see section iii for an introduction to these learning techniques .
we use unsupervised learning and our approach is fully automatic and does not require any format specific customization.
we present an in depth case study for a very complex input format pdf.
this format is so complex see section ii that it is described in a pages pdf document .
we consider a large complex and security critical parser for this format the pdf parser embedded in microsoft s new edge browser.
through a series of detailed experiments see section iv we discuss the learn fuzz challenge how to learn and then generate diverse well formed inputs in order to maximize parser code coverage while still injecting enough ill formed input parts in order to exercise unexpected code paths and error handling code.
we also present a novel learn fuzz algorithm in section iii which uses a learnt input probability distribution to intelligently guide where to fuzz statistically well formed inputs.
we show that this new algorithm can outperform the other learning based and random fuzzing algorithms considered in this work.
this paper makes the following technical contributions we present the first attempt at using neural network based learning techniques for generating automatically an input grammar suitable for fuzzing purposes.
we point out and measure for the first time the fundamental tension between conflicting learning and fuzzing goals.
a practical consequence of this key observation is that better learning does notimply better fuzzing.
we present the first combined learn fuzz algorithm which leverages a learnt input probability distribution in order to intelligently guide where to fuzz well formed inputs.
the paper is organized as follows.
section ii presents an overview of the pdf format and the specific scope of this work.
section iii gives a brief introduction to neural networkbased learning and discusses how to use and adapt such techniques for the learn fuzz problem.
section iv presents results of several learning and fuzzing experiments with the edge pdf parser.
related work is discussed in section vii.
we conclude and discuss directions for future work in section viii.
.
c ieeease urbana champaign il usa technical research50 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ii.
t hestructure of pdf d ocuments the full specification of the pdf format is over 300pages long .
most of this specification roughly deals with the description of data objects and their relationships between parts of a pdf document.
pdf files are encoded in a textual format which may contain binary information streams e.g.
images encrypted data .
a pdf document is a sequence of at least one pdf body.
a pdf body is composed of three sections objects cross reference table and trailer.
objects.
the data and metadata in a pdf document is organized in basic units called objects.
objects are all similarly formatted as seen in figure a and have a joint outer structure.
the first line of the object is its identifier for indirect