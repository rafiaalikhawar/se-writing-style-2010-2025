alarge scaleempiricalstudyontheeffectsofcode obfuscationsonandroidappsandanti malwareproducts mahmoudhammad joshuagarcia andsammalek departmentofinformatics universityofcalifornia irvine irvine california usa hammadm joshug4 malek uci.edu abstract theandroidplatformhasbeenthedominantmobileplatformin recentyearsresultinginmillionsofappsandsecuritythreatsagainst thoseapps.anti malwareproductsaimtoprotectsmartphoneusers fromthesethreats especiallyfrommaliciousapps.however malwareauthorsusecodeobfuscationontheirappstoevadedetection byanti malwareproducts.toassesstheeffectsofcodeobfuscation onandroidappsandanti malwareproducts wehaveconducteda large scale empirical study that evaluates the effectiveness ofthe top anti malware products against various obfuscation toolsandstrategies.tothatend wehaveobfuscated3 000benignappsand malicious apps and generated obfuscated apps using29obfuscationstrategiesfrom7open source academic and commercialobfuscationtools.thefindingsofourstudyindicatethat code obfuscation significantly impacts android anti malware products the majority of anti malware products are severelyimpacted by even trivial obfuscations in general combinedobfuscation strategies do not successfully evade anti malwareproducts more than individual strategies the detection of anti malwareproductsdependnotonlyontheappliedobfuscation strategybutalsoontheleveragedobfuscationtool anti malwareproductsareslowtoadoptsignaturesofmaliciousapps and code obfuscationoftenresultsinchangestoanapp ssemanticbehaviors.
acm reference format mahmoud hammad joshua garcia and sam malek.
.
a large scale empiricalstudyontheeffectsofcodeobfuscationsonandroidappsand anti malwareproducts.in icse icse 40thinternationalconference onsoftwareengineering may27 june3 gothenburg sweden.
acm newyork ny usa 11pages.
introduction android is the dominant mobile platform holding of the smartphoneosmarketshare .atthesametime thenumber and sophistication of malicious android apps are increasing.
for instance mcafeelabscrawledseveralappstoresoversixmonths in2016anddetectedmorethan9millionmaliciousapps .as anotherexample kasperskydiscoveredmorethan4millionnew malwarein2016 .
manyreasonscontributetothismeteoricriseofmalwareapps including the relative ease of creating a piggybacked app permission to make digital or hard copies of all or part of this work for personal or classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthefirstpage.copyrightsforcomponentsofthisworkownedbyothersthanacm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand or afee.requestpermissionsfrompermissions acm.org.
icse may27 june3 gothenburg sweden 2018associationforcomputingmachinery.
acmisbn978 ... .
either malicious code or embedded advertisements and the prevalenceofalternativeandroidappstores i.e.
appstoresother than the official android app store google play on which maliciousappsmaybedistributedtousers.
toprotectmobiledevices usersoftenrelyonanti malwareproducts whichscanappstodetermineiftheyarebenignormalicious.
however manymalwareappshavepreviouslyevadeddetectionby theseproducts.examplesofsuchmaliciousappsincludebraintest vikinghorde falseguide anddresscode .these appshaveinfectedmillionsofusersbeforetheyweredetected.to evadedetection malwareauthorsoftenrelyon codeobfuscation.
code obfuscation transforms code into a form that is more difficultforhumans andpossiblymachines toread understand andreverseengineer.thesetransformationschangethesyntaxof codebutnottheirsemantics .thesechangescouldbesmall e.g.
insertingunusedcode orsophisticated e.g.
performingbytecodeencryption .althoughcodeobfuscationsareusedbymalware authors they are also used by benign app developers to increase thedifficultyofreverseengineeringtheirapps.
tobetterprotecttheintellectualpropertyofbenignappdevelopersandpreventcloningoftheirapps severalcompanieshavedevelopedobfuscationtools or obfuscators forshort thatimplementdifferentcodetransformations e.g.
identifierrenaming stringencryption reflection etc.
.giventheuseofobfuscationsbymalwareauthors thegoalofthisstudyistoassesstheperformanceofcommercialantimalwareproductsagainstvariousobfuscationtoolsandstrategies.
although some researchers have studied an individual obfuscation tool s effectiveness on a limited number of anti malware products nostudyhasperformedalarge scale assessmentof theeffectofindividualandcombinedobfuscation strategiesprovidedbymultipleobfuscationstoolsonanti malware products theeffectthetoolsandstrategieshaveontheaccuracy of anti malware products for benign apps and not just maliciousapps the effect of time on obfuscated app detection by those products and whethertheapplicationofobfuscationstrategies result in valid installable and runnable apps.
due to the lack ofastudyregardingtheeffectofspecificandcombinedobfuscation strategiesonanti malwareproducts itisunclearwhichstrategies evadesuchproductsthemost.noneoftheaforementionedstudies determinetheextenttowhichanti malwareproductserroneously considerobfuscated benignappsasmalicious whichisundesirable forbothanti malwareproductvendorsandbenignappdevelopers.
to determine if the transformations applied by obfuscation tools break an app s semantics our study investigates the abilityof obfuscation tools to generate valid installable and runnable apps.anobfuscatedappisnotusefultoabenignappdeveloperor maliciousauthorifitcannotbeexecutedonadeviceorifitsbenign functional behavior changes.
to ensure an app s obfuscation is acm ieee 40th international conference on software engineering authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may27 june3 gothenburg sweden mahmoudhammad joshuagarcia andsammalek successful ourstudyfurthercomparesthebehaviorofanobfuscated appwiththebehaviorofitscorrespondingoriginalapp.
overall thispapermakesthefollowingcontributions we assess the accuracy of over anti malware products on apps obfuscated using obfuscation tools and obfuscation strategieson3 000benignappsand3 000maliciousapps totaling over73 000obfuscatedapps.wefurtherconsidertheeffectofanapp sageonthataccuracy.
weevaluatetheabilityof7obfuscationtoolstogenerateandroid appsthatarevalid installable andrunnable.
based on our results we make suggestions for improving anti malwareproductsandobfuscationtools.
to conduct this study we have implemented a framework for obfuscatingandroidappsandscanningthemusinganti malware products.theframeworkisreusable canbeextendedtoinclude moreobfuscationtoolsandstrategies andisavailableonline alongwithourresultingdatasetofover73 000obfuscatedapps.
the remainder of this paper is organized as follows.
section coversbackgroundinformationaboutandroidappsandcodeobfuscation.section3discussestheresearchquestionsthatthisstudy aimstoanswer.theresearchmethodologyofthisstudyispresented in section .
the results and the findings are reported in section .section6discussestheresultsandprovidesrecommendationsto enhanceanti malwareproductsandobfuscationtools.thethreats tovalidityarepresentedinsection7.finally thepaperoverviews therelatedliterature section8 andconcludes section9 .
background thissectionprovidesabriefoverviewofandroidappsandobfuscationstrategiestohelpthereaderunderstandtherestofthepaper.
.
android apps eachandroidappispackagedanddistributedasanandroidpackage kit apk file whichisazippedfilethatismainlywritteninjava.
eachapkfilecontainsamanifestfile resources e.g.
images and theapp sbytecode.anapp scodeiscompiledinto dalvikexecutable dex format whichcanbeexecutedonacustomizedjavavirtual machine jvm .
there are two jvms that can execute the dexformat androidruntime art introducedinandroidversion5 lollipop anddalvikvirtualmachine dvm forolderversions.
classes.dex themaindexfileofanandroidapp isafileintheapk generatedby dx autilitythatconverts .classfilesintoadexfile.
classes.dex can be disassembled by baksmali into an intermediate representation ir format which in turn can beassembled by smali to generate a new variant of classes.dex.
thenewclasses.dex canberepackagedusingatoolsuchas apktool areverse engineeringtoolforandroidapkfiles togeneratea newapkvariant e.g.
anobfuscatedapp .differentirformatscan begeneratedfrom classes.dex includingsmalicodeusingapktool and.classfilesusingdare ordex2jar .moreover soot can generate various irs such as baf jimple shimple grimp or evenalow levelirsuchasjasmin.
.
obfuscation strategies to study the effectiveness of anti malware products we applied severaldifferentobfuscationstrategiesoneachandroidapp.we usetheterm obfuscationstrategy torefertoasingletransformation ormultipletransformationsappliedtoanandroidapp.weconsider threetypesofstrategies trivialstrategies non trivialstrategies and combinedstrategies.table1presentsabbreviationsofthetrivialand non trivialobfuscations whichwillbeusedthroughoutthispaper.table obfuscation strategy abbreviations trivialobfuscation non trivialobfuscation disassembly reassemblydrjunkcode insertionjunk identifier renamingidr androidmanifest man classrenaming cr controlflowcf alignment alignmember reorderingmr reflection ref repackaging repackstring encryptionenc trivial obfuscation strategies arecodetransformationsthat donotchangetheapp sbytecode.forthisstudy weexaminedthe followingtrivialstrategies repackaging repack involves unzipping the apk file and re signingitwithadifferentsigningcertificate.thissimpletransformationthwartsanti malwareproductsthatrelyontheapp s certificatetodetermineiftheappismaliciousornot.forthistransformation weunzipanapkfileusingthe zipfilepythonlibrary andresignitwithourownsigningcertificateusing jarsigner atoolforverifyingandgeneratingdigitalsignaturesforjarfiles.
disassembling and reassembling dr involves disassembling the app using a reverse engineering tool such as apktool reassemblingtheapp andthensigningit.bydisassemblingand reassemblingtheapp theitemsin classes.dex willbereordered.
anti malwareproductsthatrelyonmatching classes.dex against signaturesofknownmaliciousappswouldbebroken.
androidmanifest transformation man each android appcontains a configuration file called androidmanifest.xml file which specifies the principal components that constitute the application including their types and capabilities as well as requiredandenforcedpermissions.thistransformationchanges the manifest by adding permissions or adding components capabilities called intentfilters inandroid.
alignment align realignsalluncompresseddata suchasimagesorrawfiles inanapkfile.thistransformationchangesthe cryptographichashofanapkfile.therefore ifananti malware productidentifiesmaliciousappsbasedontheircryptographic hashes e.g.
md5 thistransformationcanthwartit.
non trivial obfuscation strategies arecodetransformations thatchangeanapp sbytecode.westudythefollowingnon trivial obfuscationstrategies junkcodeinsertion junk addscodethatdoesnotaffecttheexecutionofanapp.junkcodeinsertioncanaddnulloperations nop comments and ordebugginginformationtoa classes.dex file.
stringencryption enc encryptsthestringsin classes.dex and addsafunctionthatdecryptstheencryptedstringsatruntime.
anti malwareproductsthatrelyonthestringdatainanappto determineifitismaliciouswillbeevadedbythistransformation.
control flowmanipulation cf changesthemethods controlflow graph by adding conditions and iterative constructs.
inaddition this transformation changes the app s call graph by addingnewmethodsandfakecallstothenewlyaddedmethods.
membersreordering mr changestheorderofinstancevariables or methods in a classes.dex file which evades anti malware productsthatdependonthesequenceofmembersinaclass.
identifierrenaming idr renamestheinstancevariablesand or themethodnamesineachjavaclasswithrandomlygenerated names.thistransformationchangessignaturesgeneratedfrom identifiersandchangesthe methodtable indalvikbytecode.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
alarge scaleempiricalstudyontheeffectsofcode obfuscationsonandroidappsandanti malwareproductsicse may27 june3 gothenburg sweden class renaming cr renames the classes and or the packages inanappwithrandomlygeneratednames.thistransformation changesthe methodtable inthedalvikbytecode.
reflection ref transformationsconvertdirectmethodinvocationsintoreflectivecallsusingthejavareflectionapi whichcan evadestaticanalysesthatrelyondirectmethodcalls.
combined strategies arecombinationsoftheaforementioned obfuscationstrategies.previouswork hasmentionedthat combining obfuscation strategies result in stronger obfuscations.
our study leverages different combined strategies to understand whichcombinationsoftransformationswillresultinbetterevasion ofanti malwareproducts.themajorityofourleveragedcombined strategieshavenotbeenempiricallystudiedinpreviouswork.
research questions inthis paper our primary goalis toprovide alarge scaleempiricalstudythatevaluatestheeffectivenessofanti malwareproducts againstvariousobfuscationtoolsandstrategies.tothatend this sectionpresentsanddiscussestheresearchquestionsthisstudyattemptstoanswer.moreover thissectionshowswhowillbenefitfrom answeringeachresearchquestion.intheremainderofthissection weintroduceandmotivateeachresearchquestionthatwestudy.
rq1.howistheaccuracyofanti malwareproductsaffectedby obfuscationstrategies?
theuseofcodeobfuscationinandroidappshasbecomepopular andisleveragedbybothbenignandmaliciousappdevelopers.giventhatsmartphoneusersrelyonanti malwareproductstoprotecttheir devices itiscrucialforanti malwareproductstodistinguishmaliciousappsfrombenignoneswithhighaccuracy whilebeingresilienttoobfuscation.rq1aimstomeasuretheaccuracyofcommercialanti malwareproductsagainstabroadrangeofobfuscationstrategies.wemeasureaccuracyinthispaperusingprecisionandrecall sincethesemetricstakeintoaccountfalsepositives i.e.
benignappsmarkedasmalicious andfalsenegatives i.e.
maliciousappsmarkedasbenign .
anti malware providers will benefit from answers to rq1 in ordertoimprovetheirproducts especiallyagainsttheobfuscation strategies that thwart their products the most.
in addition theanswers to rq1 can help smartphone users choose betweenanti malware products.
benign app developers will benefit fromanswerstorq1bylearningwhichobfuscationstrategiesprevent theirappsfrombeingflaggedasmalicious.
rq2.howistheaccuracyofanti malwareproductsaffectedby obfuscationtools?
each anti malware product s effectiveness likely varies based ontheimplementationsofobfuscationstrategiesprovidedbyanobfuscationtool.tomakethatdetermination rq2measurestheaccuracy of anti malware products on obfuscation tools where accuracyisagainmeasuredintermsofprecisionandrecall.
anti malwareproductvendors benignappdevelopers andobfuscationtooldeveloperscanbenefitinseveralwaysfromtheanswers torq2.anti malwareproductvendorscanusethisinformationto determinewhichspecificimplementationsofobfuscationstrategies may cause false positives i.e.
benign apps marked as malicious intheirproducts.similarly thesevendorscanbenefitfromlearning whichobfuscationsresultinsuccessfulevasionfromdetectionby maliciousapps.answerstorq2canaidbenignappdevelopersin choosingtheobfuscationtoolsthatwillpreventtheirappsfromerroneouslybeingmarkedasmalicious.furthermore iffalsepositives orfalsenegatives i.e.
maliciousappsmarkedasbenign areduetoobfuscationtools asopposedtotheanti malwareproducts then thisinformationisusefulforcorrectingobfuscationtools.
rq3.howistheaccuracyofanti malwareproductsaffectedby theyearanappiscreated?
rq3 aims to study the accuracy of anti malware products on non transformedandtransformedappsoverdifferenttimeperiods whereeachtimeperiodforourstudyspanstwoyears.weconsider transformed apps as belonging to the same time period as theirnon transformed versions.
for example if we transform appscreated in time period we still consider the resulting obfuscatedappsascreatedin2012 forthepurposesofrq3.
thisresearchquestionallowsustounderstandtheeffectiveness ofanti malwareproductswhenappliedtodifferenttimeperiodsand todetermineifthoseproducts detectionaccuraciesareaffectedby time.anti malwarevendorscanusethisinformationtodetermine the time periods that result in poor accuracy for their products aidingthemwithimprovingresultsforappscreatedduringthose problematictimeperiods.
rq4.to what extent do obfuscation tools result in valid installable andrunnableapps?
althoughanobfuscatedappdoesnotneedtoberunnablewhen scannedbyananti malwareproduct developersofbenignappsandobfuscationtoolsrelyonthosetoolstoproducevalid installable and runnableapps.similarto weconsideranapktobe validifan obfuscationtoolsuccessfullygeneratesasignedapkpackagethat includesa classes.dex filecontainingcorrectdalvikbytecodesyntax.
an app is installable if it can be successfully deployed into the androidruntime.forourpurposes atransformedappis runnableif itsruntimebehaviorissimilartoitsnon transformedversion.rq4isparticularlyusefulforobfuscationtooldeveloperssinceanswers to that question provide information about transformations that resultinmalformedapps.
research methodology thissectiondescribestheresearchmethodologythatwepursued in terms of our study subjects selected obfuscation tools our evaluationframework andourselectedanti malwareproducts.
.
study subjects weusedadatasetofbenignappsconsistingof3 000appsfromgoogle playand3 000maliciousapps.toavoidhavingmaliciousappsinour ground truthdatasetofbenignapps weobtainedbenignappsfrom androzoo whichisacollectionofmorethan5.5millionapps collectedfromseveralsources includinggoogleplay.androzooapps have been scanned by commercial anti malware productsusingthevirustotalservice afreeonlineserviceprovidedby google that scans urls files and android apps.
approximately 000googleplayappsoutofnearly2millionappsinandrozoo are marked as benign by all anti malware products.
from these25 000apps wehaverandomlyselected3 000appsforthisstudy.
themaliciousappsbelongtoseveralmalwarerepositoriesincluding androidmalwaregenome contagio andrototal the drebindataset andvirusshare .inadditiontothesemalware repositories we used the virustotal service to include recentlydiscovered malicious apps that belong to the following malware families braintest vikinghorde andfalseguide .
.
obfuscation tools we have included the following obfuscation tools for our study whosesupportedobfuscationstrategiesaredepictedintable2 authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may27 june3 gothenburg sweden mahmoudhammad joshuagarcia andsammalek figure obfuscation study methodology table obfuscation strategies of each obfuscation tool trivial non trivial obfuscator strategy align drmanrepack cfcrencidrjunkmrrefapktool jarsigner check check allatori check check check check dasho check check check droidchameleon check check check check check check adam check check check check check proguard check allatori isacommercialjavaandandroidobfuscationtool that supports a wide range of obfuscation strategies.
many companiessuchasamazon fujitsu andmotorolarelyonallatori toprotecttheirsoftwaresystemsfrombeingreverseengineered.
theprovidersofthistool smardecinc.
provideduswithafull versionforeducationalpurposes.
proguard isawidelyusedopen sourceshrinker optimizer obfuscator and preverifier for java bytecode.
a preverifier performs certain checks on java bytecode prior to runtime.
proguardsupportsidentifierrenamingandisthedefaulttoolin manydevelopmentenvironments includingandroidstudio theofficialideforandroidapps.
adam is a research tool for obfuscating android apps.
it transformsthesmalicodeofareversed engineeredapp.
droidchameleon isastate of the artresearchtoolforobfuscatingandroidappswhichsupportsawiderangeofobfuscation strategies.
compared to adam droidchameleon supportsmorecomplextransformations.likeadam droidchameleon transformsthesmalicodeofareversed engineeredapp.
dasho isacommercialtoolforobfuscatingandroidandjava applications.dashoprovidesstaticanalysisprotectionandruntimesecuritycontrolagainsttampering unauthorizeddebugging andsomeruntimeattackpatterns.thistoolsupportscontrol flow string encryption andidentifier renamingtransformations.the providers of dasho preemptive solutions supplied us with a fullfreeversionvalidfor30days.
apktoolandjarsignerwereusedtoperformthedrandrepack obfuscationstrategies respectively.thesetwotransformationsof tenworkintandembecauseareassembledapkmustberesigned.
we also considered another tool dexguard which is an advancedandcommercialversionofproguard.wecontactedtheproviders of dexguard to obtain an educational or commercial versionoftheirtooltorunonourdataset.unfortunately theyonly allowtheirtooltorunonarestrictednumberofandroidapps and theydonotselllicensesforresearchpurposes.hence wedidnot includeitinthisstudy.
.
evaluation framework toconductourstudy wehavedevelopedtheframeworkdepictedin figure1 whichconsistsofthefollowingfourmodules irconverter ir transformer apk generator and data analyzer.
ir converter takesanandroidapkasinputandconvertsitscodetointermediaterepresentation ir formats.
irtransformer utilizesallobfuscation tools to transform the ir format using a variety of obfuscationstrategies.
apkgenerator repackageseachobfuscatedirfileand generatesanobfuscatedapkfromthatfile.
dataanalyzer scans obfuscatedappsusinganti malwareproducts storesthescanning results in a mysql database analyzes the scanning results and createsvariousstatisticalreports.
ourframeworkisreusableandextendable.ausercanaddnew obfuscation tools and support different obfuscation strategies.
therefore wemaketheframeworkavailableforresearchersand practitioners .theframeworkisapythonprogramthatconsists ofmorethan5 500linesofcode notcountingtheobfuscationtools.
ir converter.
obfuscation tools do not require source code and they work directly on the ir format.
therefore this moduleconvertsanapkfiletotwoirformats smaliusingbaksmaliand javabytecodeusing dex2jar.inourframework wegeneratethese twoirformatssinceadamanddroidchameleonworkon smali codewhileallotherobfuscationtoolsworkonjavabytecode.
ir transformer.
thismodulegeneratesseveralobfuscatedir filesoftheoriginalirfile.theframeworkisconfiguredtoleverage twentyninedifferentobfuscationstrategiesusingsevenobfuscation tools recallsection4.
.
apk generator.
foreachobfuscatedirfile thismodulegeneratesanobfuscatedandroidapp.first thismoduleleveragesthe dx toolfromtheandroidsdktoconvertanobfuscatedirtoa classes.dex file.next itgeneratesanapkfilewiththenew classes.dex using apktool.finally theapkfileissignedusing jarsignerwithourown certificate sincetheoriginalcertificateoftheappcannotbeobtained.
data analyzer.
this module uses the virustotal service to scan apps using anti malware products.
this module uploadsthe apps to virustotal which scans them using more than up to datecommercialanti malwareproducts.foreachuploaded app virustotalreturnsauniquescanningid whichdataanalyzer useslatertodownloadthescanningreportsandstoresthemina mysqldatabase.dataanalyzerqueriesandprocessesthedatabase togeneratevariousstatisticalreports.
.
anti malware products wehaveevaluatedtheaccuracyandtheresiliencyof61commercial anti malwareproductsagainstobfuscations.duetospacelimitationsandtoensurereadability wefocusontheresultsofthe21mostpopularandroidanti malwareproductsinthispaper however wemake theresultsforall61anti malwareproductsavailableonline .
table3showstheanti malwareproductsevaluatedinthisstudy andincludesthefollowinginformationforeachproduct itsnumberofdownloads itsoverallusersatisfactionscoreasrepresentedusinga star rating stars andthenumberofuserswhoreviewedtheproduct reviewers .thenumbersintable3areobtainedfromgoogleplay.
data analysis and results forconductingourexperiments wehaveleveragedahighperformancecomputingcluster hpc managedbyourorganization that hasmorethan200computenodeswithatotalofmorethan8 cores.eachcomputenodehas264gb 512gbram.weutilizedhpc authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
alarge scaleempiricalstudyontheeffectsofcode obfuscationsonandroidappsandanti malwareproductsicse may27 june3 gothenburg sweden table anti malware products k thousand.
m million product downloads stars reviews product downloads stars reviews ikarus 100k 500k .
trustlook 10m 50m .
emsisoft 100k 500k .
mcafee 10m 50m .
fortinet 100k 500k .
avira 10m 50m .
aegislab 100k 500k .
norton 10m 50m .
f secure 500k 1m .
symantec comodo 500k 1m .
esetnod3210m 50m .
gdata 1m 5m .
kaspersky 10m 50m .
sophos 1m 5m .
drweb 50m 100m .
trendmicro 1m 5m .
antiyavl100m 500m .
bitdefender 5m 10m .
avast 100m 500m .
cat quickheal5m 10m .
avg 100m 500m .
torunthousandsofjobssimultaneously.oneachapp weapplied 29differentobfuscationstrategies 4trivialtransformations 7nontrivial transformations and combined transformations.
table shows the number of obfuscated apps resulting from applying the obfuscation strategies leveraged by the obfuscation tools.
anemptycellindicatesanobfuscationstrategythatisnotsupport byaparticularobfuscationtool.intotal wehavegenerated73 obfuscatedappsfrom3 000benignappsand3 000maliciousapps.
intheremainderofthissection wepresenttheresultsofourexperiments.wemeasuredtheeffectivenessofanti malwareproducts atidentifyingmaliciousappsintermsoftheir precision whichmeasurestheextenttowhichbenignappsarelabeledasmalicious and recall whichmeasurestheextenttowhichmaliciousappsarelabeled asbenign.weusethe f score i.e.
theharmonicmeanofprecisionand recall tomeasuretheoveralldetectionrateofanti malwareproducts.
.
rq1.
obfuscation strategies westudiedtheaccuracyofanti malwareproductswithrespectto awidevarietyobfuscationstrategiesintwoscenarios.inthefirst scenario section5.
.
wecomparethedetectionratesofeachantimalwareproductontheoriginaldatasetandtheobfuscateddataset.
inthesecondscenario section5.
.
wemeasurethedetectionrate ofanti malwareproductsagainsteachobfuscationstrategy.
.
.
detection rate on original and obfuscated apps.
figure showsthedetectionrateof21anti malwareproductsontheoriginal dataset of apps depicted as black bars and the obfuscated datasetof73 362apps depictedasgraybars.figure2demonstrates that the detection rate of anti malware products on the original datasetisabove85 for16products andbetween75 and85 for 4anti malwareproducts.
trendmicro exhibitsthelowestdetection rate .theaveragedetectionrateis87 ontheoriginaldataset.
consequently priortoapplicationofobfuscationstrategiesfromobfuscationtools thesetopanti malwareproductsarequiteeffective atprotectingandroidusers albeitthereisroomforimprovement.
onceobfuscationstrategiesareapplied thedetectionratesfor those anti malware products decrease significantly as shown in figure2.forexample aegislab achievesthehighestdetectionrate on the original dataset since it mislabeled only apps inthe original dataset.
its detection rate has dropped to on theobfuscateddataset a40 decrease asitmislabeled 636apps.
other anti malware products arealso severelyimpacted by codeobfuscation.
while the average detection rate of anti malware figure detection rate of anti malware products on 000original apps and obfuscated apps.
productsontheoriginalappsis87 theaveragedetectionrateon theobfuscateddatasetis67 a20 decrease.
finding code obfuscation significantly impacts android anti malware products.
the average detection rate for the top anti malwareproductsdecreasesfrom87 to67 a20 decrease.
.
.
detection rate for each obfuscation strategy.
to better understandtheimpactofeveryobfuscationstrategyoneachantimalwareproduct table5presentsthedetectionrateofanti malware products expressedasthef score ontheoriginaldatasetandthe variousobfuscationstrategies.forexample thedetectionrateof symantec on the original dataset is .
this detection rate has droppedto64 onobfuscatedappsusingman to69 onobfuscated appsusingenc andto31 onobfuscatedappsusingenc idr.
table5demonstratesthatthemajorityofanti malwareproducts arenotaffectedbyref.weconsideratransformation seffectonaproduct sdetectionratetobenegligibleifthedetectionratehas eitherimproved decreasedbylessthan3 orremainsabove85 .
infact theaccuracyof f secure gdata bitdefender and emsisoft improvesonappsobfuscatedusingref.thisresultindicatesthatthe intensiveuseof codereflection makesanapplooksuspicioustoour studiedanti malwareproducts improvingtheirdetectionrates.unfortunately thisphenomenonmayresultinfalsepositivesforcertain anti malwareproducts.forinstance avgerroneouslymarked307 benignappsobfuscatedusingrefasmalicious whilealsocorrectly detectingnearlyallmaliciousappsobfuscatedusingref.
finding ref transformations make apps look suspicious increasingthechanceofanappbeinglabeledasmalicious.
perhapsmostsurprisingisthatcertaintrivialobfuscationstrategiesarequiteeffectiveagainstthetopanti malwareproducts.notably the anti malware products that we studied rely heavily onanalyzinganapp smanifestfile whichcontainsconfigurationinformation.consequently theseproductsareoftenevadedbyapps obfuscatedusingman whichinvolvesthetrivialadditionormodifi cationofpermissionsorintentfilters.forexample thedetectionrateofmcafeedroppedfrom94 to21 forappsobfuscatedusingman.
overall theaveragedetectionrateofanti malwareproductsfellto from87 whenappsareobfuscatedusingman a28 decrease.
finding man whichisatrivialobfuscationstrategy severely impactsmanyanti malwareproducts onaverage decreasinga product sdetectionrateby28 .
anotherinteresting possiblycounter intuitive conclusionthat wecandrawfromtable5isthatcombinedtransformationsarenot alwayssuperiortoindividualtransformations.forinstance while authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may27 june3 gothenburg sweden mahmoudhammad joshuagarcia andsammalek table number of obfuscated apps using the obfuscation strategy in the column leveraged by the obfuscator in the row.
trivial non trivial combined strategies ref obfuscator strategy align drmanrepack cfcrencidr junk mr ref cf enccf idrcf mancf mrcr manenc idrenc man junk manman ref cf cr mancf enc idrcf enc mrcf idr mrcf ref man enc ref mancf enc idr mr cf cr enc man ref cf cr enc junk mantotal apps apktool jarsigner allatori dasho droidchameleon adam proguard total apps table rq1 detection rate of anti malware products measured by their f score against each obfuscation strategy.
trivial non trivial combined strategies ref anti malware original align dr man repack cf cr enc idr junk mr ref cf enc cf idr cf man cf mr cr man enc idr enc man junk man man ref cf cr man cf enc idr cf enc mr cf idr mr cf ref man enc ref man cf enc idr mr cf cr enc man ref cf cr enc junk man aegislab ikarus cat quickheal avg mcafee eset nod32 fortinet symantec sophos avira f secure comodo gdata bitdefender emsisoft drweb trustlook kaspersky antiy avl avast trendmicro average thedetectionrateof avgagainstcfis79 itsdetectionrateagainst combinedtransformationsthatincludecfisbetween57 and97 .
finding in general combined transformations do not affect detection rates more than single transformations the averagedetectionrateofanti malwareproductsis61 forsingle non trivialobfuscations and61 forcombinedobfuscations.
figure3containsbox and whiskerplotsillustratingtheimpactof eachobfuscationstrategyonallanti malwareproducts.theseresults suggestthatsomeobfuscationstrategieshavenegligibleeffectson themajorityofanti malwareproducts.forexample repackdidnot affect19anti malwareproducts.similarly theuseofthemrtransformationsdidnotaffect14anti malwareproducts.lastly theref transformationdidnotthwartthemajorityofanti malwareproducts.figure3demonstratesthatenc idrandcf enc idrarevery effective in thwarting anti malware products.
in fact these two transformationsevadedallanti malwareproductsexcept drweb.
finding enc idrandcf enc idrarethemostsuccessful transformationsforevadinganti malwareproducts.
.
rq2.
obfuscation tools for rq2 we studied the detection rate of anti malware products onappstransformedusingvariousobfuscationtools.tothatend weanalyzetheresultsofeachanti malwareproduct sdetectionrate oneachobfuscationtool.wefurtherassesstheoveralleffectofeach obfuscationtoolacrossallstudiedanti malwareproducts.
table6depictsthedetectionrateofeachanti malwareproduct onappstransformedusingeachobfuscationtool.fromtable6 we authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
alarge scaleempiricalstudyontheeffectsofcode obfuscationsonandroidappsandanti malwareproductsicse may27 june3 gothenburg sweden figure rq1 the average detection rate of all anti malware products regarding each obfuscation strategy.
table detection rate of anti malware products f score against each obfuscation tool anti malware original adam apktool jarsigner allatori droid chameleonproguard dasho aegislab ikarus cat quickheal a v g mcafee eset nod32 fortinet symantecmobileinsight sophos avira f secure comodo gdata bitdefender emsisoft d r w e b trustlook kaspersky antiy avl avast trendmicro average observethatsomeanti malwareproductsareseverlyimpactedby allobfuscationtools.forexample thedetectionrateof trustlook dropped to less than on apps obfuscated using any of our studiedtools.furthermore trustlook markedallappsobfuscated bythefollowingtools droidchameleon proguard anddashoas benignapps.likewise trendmicro andcomodoareevadedbyall obfuscationtools exceptadam.
thebox and whiskerplotshowninfigure4depictstheeffect ofeachobfuscationtoolonallanti malwareproducts.thefigure showsthatthetopanti malwareproductsareresilientagainstapktool jarsigner adam andallatori.atthesametime dashoevades thetopanti malwareproductsmoreoftenthantheotherproducts.
wefurtherassessedthevariabilityofeachobfuscationtoolonour studiedanti malwareproducts whichindicateshowconsistentlyeach tool affects the accuracy of those products.
to that end we consideredtheinterquartilerange iqr oftheboxplotsinfigure4.
figure4 rq2 theaveragedetectionrateofallanti malwareproducts regarding each obfuscation tool.
iqristhedifferencebetweenthelowerboundandtheupperbound ofabox whichconveysthecentraltendencyoftopanti malware productsagainstanobfuscationtool.asmalliqrindicatesthatthe behaviorofananti malwareproductishighlyconsistent.
figure 4showsthatproguardhasthelargestiqr.
adamandapktool jarsigner asshowninfigure4 havearelativelyhighmedian and86 respectively withthelowestiqr i.e.
and13 respectively.thisindicatesthatanti malwareproductsareresilienttothesetools.consequently appsobfuscatedby adamandapktool jarsignerworkwellforbenignappdevelopers whowouldwanttoobfuscateappswithouthavingthembefalsely reportedasmalicious andwouldbeleastusefulformalwareauthors.
finding adamandapktool jarsignerproduceobfuscations thatreduceanti malwareproductaccuracytheleast.
figure suggests that dasho is most successful at evading anti malwareproducts whichaidsmalwareauthors.theaverage detectionrateofanti malwareproductsonobfuscatedappsusing dashois51 withamedianof58 a37 decreaseintheaverage detectionrate anda32 mediandecrease.
finding dashoreducestheaccuracyofanti malwareproducts morethanotherobfuscationtoolsinourstudy.
.
rq3.
time aware analysis asignificantfactorthatmayinteractwiththeeffectofobfuscations onanti malwareproductaccuracyistime.forrq3 weconducted a time aware analysis that studies the accuracy of anti malwareproductsonoriginalandobfuscatedappsthatbelongtothesame timeperiodforthepast10years.figure5depictstheresultsofthis authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may27 june3 gothenburg sweden mahmoudhammad joshuagarcia andsammalek analysis.wegroupedappsintotwo yeartimeperiods duetothe factthatsomeyearsonlyhaveafewapps mainly2009with29apps and2017with130apps.similarto weconsidertheyearofthe lastmodifieddateof classes.dex inanappastheyearfromwhich itoriginates.weconsideranytransformedappasbelongingtothe sameyearasitsoriginalversion inordertodeterminetheactual effectofobfuscationonproductaccuracyforeachtimeperiod.
figure rq3 time aware analysis.
fortheoriginaldataset figure5showsthatthetopanti malware productsmaintainsimilardetectionratesforanytwoconsecutive timeperiodspriortoandincluding2012 .unfortunately there aresignificantdecreasesinthedetectionratestartingfromthetime periodbetween2012 2013and2014 theaveragedetectionrate is70 for2014 fallingfrom87 in2012 .by2016 theaveragedetectionratefallsto53 ontheoriginalapps.
fortheobfuscateddataset figure5illustratesthatthedetection ratesofanti malwareproductsdecreaseinalargelylinearfashion.
theaveragedetectionratestartsat67 onobfuscatedappsfrom 2009anddecreasesto39 onobfuscatedappsfrom2016 .
theseresultssuggestthatanti malwareproductsareslowtoadopt signaturesofmaliciousapps.
theaveragedetectionrateonoriginalappsfrom2010to2013 are higher than the average detection rate on older apps.
this likely occurs because many malicious apps from are well known and highly disseminated among security analysts.
forexample androidmalwaregenomeisadatasetofmalicious androidappsthatarewidelyused aredescribedinahighlycited paper andwerereleasedinthe2010 2013timeperiod.
finding theaveragedetectionratesofanti malwareproducts tendtodecreaseovertime indicatingthatsuchproductsareslow toadoptsignaturesofmaliciousapps.
.
rq4.
valid installable and runnable apps an obfuscated app is not useful for app authors unless the app canrunonadevice.forthatreason rq4measurestheabilityof obfuscationtoolstogeneratevalid installable andrunnableapps.
.
.
valid apps.
recallfromsection3 a validobfuscatedapp corresponds to a signed apk package that includes a classes.dex filecontainingthecorrectdalvikbytecodesyntax.table7depicts theabilityofobfuscationtoolstogeneratevalidobfuscatedapps which we refer to as the obfuscation rate .
the obfuscation rate is measuredusingtheratioofthenumberofvalidappsgeneratedby anobfuscationtooltothenumberofappssuccessfullyretargetedto java bytecode.
for example proguard obfuscated benignapps out of successfully retargeted benign apps resulting inanobfuscationrateof41 forbenignapps.similarly proguardobfuscated1 021maliciousappsoutof2 005retargetedmalicious apps hence proguard sobfuscationrateonmaliciousappsis51 .
table7showsthatdashohasthelowestobfuscationrate whereas droidchameleon achieves the highest obfuscation rate .therearemanyreasonsbehindtheselowobfuscationrates includingexceptionsraisedbyobfuscationtoolswhiletransforminganappandtheirinabilitytoproduceavalidobfuscated classes.dex file.
forinstance allatoriraisedthisexception com.allatori.iiiiiiiiii only finalfieldsmayhaveaninitialvalue!
onmanyapps.wecontacted theproviderofallatoriaboutthisexception whoinformedusthat thisproblemhasbeenreportedbyotherusers butcouldnotbereproduced.consequently wehelpedthemreproduceittoimprovetheir product.theyreportedtousthatthisexceptionismainlycausedby theuseof dex2jar althoughafixfortheexceptionisstillinprogress.
table the ability of obfuscators to generate valid apks.
proguard allatori droidchameleon dasho adam benign .
.
.
.
.
malicious .
.
.
.
.
total .
.
.
.
.
.
.
installable and runnable apps.
tomeasureanobfuscation tool sabilitytogenerateinstallableapps weidentifiedalloriginal appsthathaveatleastoneapptransformedbyeachobfuscationtool.foreachoriginalapp ifthereismorethanoneapptransformedusing thesameobfuscationtool werandomlyselectoneofthem.using thatprocess werandomlyselected250originalappsalongwiththeir obfuscatedversions resultingintheselectionof1 750obfuscated apps.weranthisexperimentonamacbookprowitha2.2ghzintel corei7and16gbram andinstalledtheappsonanandroiddevice.afterweconfirmedthatall250originalappsweresuccessfully installedontheandroiddevice weinstalledtheobfuscatedapps.
inadditiontomeasuringapp installabilityafterobfuscation i.e.
theextenttowhichanobfuscatorcangenerateinstallableapps we furthermeasuredapp runnabilityafterobfuscation i.e.
theextent towhichanobfuscatorcangeneraterunnableapps.forourstudy arunnableappcanbeorder agnosticororder aware.arunnableapp isorder agnostic if its obfuscated version exhibits the same setofrunningcomponentsandexceptionsasitsoriginalversion a runnable app is order aware if its obfuscated version exhibits the same sequence of running components and exceptions as its original version.
to determine app runnability after obfuscation werecordedthesequenceof componentsthatexecuteand exceptionsthatoccurduringexecutionofanappusing monkey a program that generates pseudo random streams of user events e.g.
clicks touches orgestures andsystem levelevents.wethen checkedforequalityofthesequencesofrunningcomponentsand exceptionsofanoriginalappanditsobfuscatedversion using1 eventsforeachappasinput.wefurtherranmonkeyusingthesame random seed for each original app and its obfuscated version in ordertotestbothappversionsusingthesamesequenceofinputs.
toconductthisexperiment weusedthe250originalappsand the1 341successfullyinstalledappsfromthepreviousexperiment i.e.
the total installed apps mentioned in table .
to measure whether an obfuscated app runs successfully we have modified andinstrumentedtheandroidframework toincludeprobes formonitoringtherunningcomponents.weinstalledourmodified androidframeworkonanexus5xdevice.
table8showstheabilityofobfuscationtoolstoproduceinstallableandrunnableapps includingthefollowinginformation the authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
alarge scaleempiricalstudyontheeffectsofcode obfuscationsonandroidappsandanti malwareproductsicse may27 june3 gothenburg sweden totalnumberofobfuscatedappsthatwe examined perobfuscation tool the number of successfully installed apps the number of runnableappsthatare order agnostic andthenumberofrunnable appsthatare order aware.
table installable and runnable apps of each obfuscator.
obfuscator examined installed orderagnosticorderaware jarsigner apktool droidchameleon proguard allatori adam dasho total apps many obfuscation tools produce installable apps.
our results demonstratethatalmostallappstransformedbyapktool jarsigner droidchameleon and proguard have successfully installed.
in addition only apps obfuscated by allatori have not installedsuccessfully.moreover table8showsthatmostappsobfuscatedusing adam or dasho are not installable.
successfully installed appsobfuscatedusingadamallutilizethealigntransformation.
all obfuscated apps using the non trivial obfuscations of adam arenotinstallable.
therunnabilityofappsobfuscatedusingourstudiedobfuscation toolsvariesgreatlydependingonthetool.table8showsthatalmost allobfuscatedappsusing jarsigner andapktoolarerunnableinan order agnosticfashion.249appsobfuscatedusingdroidchameleon areinstallable only83ofthoseinstallableappsareorder agnostic andrunnable andonly31ofthoseinstallableappsareorder aware andrunnable.allappstransformedbydroidchameleonusingthe enctransformationaremissingafunctionthatdecryptsencrypted strings causing these apps to crash at runtime and raise theerror java.lang.noclassdeffounderror .
all apps that become unrunnableaftertransformationbydashoraisethesameerror i.e.
java.lang.exceptionininitializererror .
given that dasho isnotanopen sourcetool wecouldnotinvestigatethisproblemfurther.
table shows that of the installable apps generatedby proguard are runnable.
likewise of the installable apps generatedbyallatoriarerunnable.
finding the percentage of obfuscated apps that are both installableandrunnableinanorder awarefashionwithrespectto componentbehaviorsvariesfrom0 .theseresultssuggesta significantneedforimprovingobfuscationtoolssothatapplying theirtransformationsretainanapp soriginalbehavior.
discussion foranti malwareproductvendors ourstudysuggestsseveralareas forwhichanti malwareproductsingeneralcanbesignificantlyimproved.recallthatoverallonourobfuscateddataset anti malware productsexperienceda20 decreaseintheirdetectionrateofmaliciousappscomparedtotheoriginaldataset finding1 .inparticular transformationsthatmainlyinvolvedidentifier namemanipulation i.e.
man enc idr and cf enc idr substantially affected obfuscationtools findings3and5 .manifest filetransformations i.e.
man thatsimplyinvolveadditionofpermissionsthatarenot necessarilyusedorfakecomponentcapabilitiesresultedina28 decrease onaverage forthetop performinganti malwareproducts figure anti malware detection installability andrunnability with respect to obfuscators finding .
overall these results indicate that anti malware product vendors would significantly benefit from performing adeeper analysis into the code of an app potentially focusing on thesecurity sensitivecodeusedbyappsthroughstaticordynamic analysis.theimportanceofperformingdeeperanalysisisfurther highlightedby thefactthattransformationsneednotnecessarilybecombinedtoevadeanti malwareproducts finding4 and this evasionworsensfornewerapps finding8 .
forbenign appdevelopers ourstudyprovidessomeguidance astohowparticularobfuscationsmaybeused.specifically wehave foundthatreflectiontransformationstendtoincreasesignificantly thepossibilityofabenignappbeinglabeledasmalicious.therefore benign app developers may wish to avoid such transformationsto avoid this false labeling and to reduce overhead exhibited byreflection.inthegeneralcase benign appdevelopersneednotbe overlyconcernedabouttheirappsbeingfalselylabeledasmalicious when combining obfuscations finding except in the case of reflectiontransformations finding2 .
the major finding for obfuscation tool developers is that our studyindicatesthatmanyoftheirtransformationsresultininvalid non installable orunrunnableapps finding9 .althoughsomeof thatburdenliesonbenign appdeveloperstoensurethatobfuscationstheyapplydonotadverselyaffecttheirapps obfuscation tool developerswouldbenefitfromaidingbenign appdevelopersinthe taskofensuringtheirappsremainrunnableafterobfuscation.
wefurtherexaminetheimplicationsoftheinteractionbetween obfuscationstools abilitytoproduceinstallableandrunnable appsand theanti malwareproductdetectionrateonmalicious apps obfuscated using those tools.
figure visually depicts the interactionbetweenthesetwophenomena.obfuscationtoolsthatlieontheupper rightcornerofthefigurearepreferredtoolsforbenign app developers obfuscation tool providers and anti malware vendors.theseobfuscationtoolsreliablygenerateinstallableand runnableappswhilemaintainingahighdetectionrateofmalicious apps for anti malware products.
in our study no tool is above80 for both its anti malware detection rate and installabilityand runnability after obfuscation.
consequently significant improvementscanbemadetothesetoolsalongthosedimensions.
obfuscation tools that lie on the upper left corner of figure are tools that exhibit properties particularly useful for malware authors.thesetoolsreliablygenerateinstallableandrunnableapps whileevadingthedetectionofanti malwareproducts.proguard isanexampleofsuchatool.althoughfewtoolsappearclosetothe upper leftcornerofthechart malwareauthorsarelikelytoexpend authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may27 june3 gothenburg sweden mahmoudhammad joshuagarcia andsammalek theextraeffortneededtoensurethattheirobfuscationsresultin installableandrunnableapps.
threats to validity thissectionpresentsourstudy sthreatstoexternalandconstruct validity andtheactionswehavetakentomitigatethem.
externalvalidity measurestheextenttowhichtheresultsofour studycanbegeneralized.onethreattoexternalvalidityforourstudy iswhetherourstudy sfindingscanbegeneralizedtootherappsoutsideofourstudy.tomitigatethisthreat weobtainedbenignand maliciousappsfromdiversesourcesthatvaryacrossapplicationdomains intermsofappsize andoriginatefromvarioustimeperiods.
toensureourfindingsarelikelytogeneralizetootherobfuscation strategiesandtools weemployed29obfuscationstrategiesfrom7 obfuscationtools thelargestnumberofstrategiesandtoolsutilizedtodateforastudyaboutappobfuscation.wefurtherobtainedobfus cationtoolsthatareacademic open source andcommercial aiding ingeneralizabilitytothesethreedifferentsources.
another threat to external validity is our selection of antimalwareproducts.tomitigatethisthreat wehaveselectedover60 anti malware products from virustotal and focused on the mostpopularandwell rated21productsforourstudy duetospace limitations.however wemaketheresultsofourstudy alongwith thecompletelistofanti malwareproductsandapps availableonline .thefindingsfortheanti malwareproductsnotdiscussedin thispaperareconsistentwiththefindingsinthispaper.
construct validity is concerned with whether our study s measurements or measurement procedures validly quantify the constructsorconceptsweintendtoquantify.athreattoconstruct validity is the metrics and measurement procedures we used to quantifytheabilityofobfuscationtoolstoproducerunnableapps whose behavior before obfuscation is similar to behavior after obfuscation.
to measure these constructs we compared the setor sequence of running components and thrown exceptions of appsbeforeandafterobfuscation.thesemeasurementprocedures and associated metrics are sensible given that components arefunctional units of behavior making them a sensible means ofidentifying high level behavior and exceptions are the mainmeans of identifying errors in apps whose test cases and oracles areunavailable whichisthecaseformanyappsongoogleplay.
anotherthreattoconstructvalidityisthelabelingofourapps asbenignormalicious.tomitigatethisthreat ourdatasetofbenign apps are marked as benign by over anti malware products.similarly our malicious apps are obtained from repositories containingappsmanuallylabeledasmaliciousbysecurityexperts.
related work wedividepreviousworkrelatedtoourstudyintofourcategories studies about similarity of a repackaged app with its original version obfuscationstrategiesforpcanddesktopsoftware obfuscationtoolsspecificallydesignedforandroid and studies abouttheeffectsofobfuscationonanti malwareproducts.inthe remainderofthissection wediscusseachoftheseareasofrelated work and conclude the section with the key differences between ourstudyandthemostsimilarrelatedwork.
researchershavestudiedthesimilaritybetweenoriginalapps and repackaged apps.
huang et al.
used androguard an androidreverse engineeringframeworkformalwareanalysis to studytheobfuscationresilienceofrepackagingdetectionalgorithms.
faruki et al.
compared the performance of anti malwareproductsandandroguard scodesimilaritywithandrosimilar theirtoolfordetectingobfuscatedapps.wangandrountevdescribe anapproachfordeterminingwhichobfuscationtoolwasapplied toanobfuscatedapp .
a few studies have considered the application of obfuscation strategies in the context of pc and desktop software.
collberg et al.producedataxonomyoftransformationsforobfuscationwitha focusonjava .collbergetal.
alsoimplementedatoolcalled sandmark for evaluating the effectiveness of code obfuscationto protect java based software systems from piracy tampering and reverse engineering.
christodorescu and jha evaluated theresilienceofanti malwareproductsagainstcodeobfuscation appliedtovisualbasicprogramsandproposedasemantics aware malware detectionalgorithmin .
previousworkhasproducedafewobfuscationtoolsspecifically designed for android apps.
zheng et al.
proposed adam a framework for obfuscating android apps and testing them on anti malwareproducts.theyevaluatedadam seffectivenessfor evading10anti malwareproductson222transformed maliciousapps.
rastogi et al.
presented droidchameleon a tool for obfuscatingandroidapps andassessedobfuscationsonsixapps fromandroidmalwaregenome .
anothersetofstudiesfocusedontheeffectsofobfuscationson anti malwareproducts withoutproposingnewobfuscationtools.
maiorcaetal.
studiedtheeffectsofcodeobfuscatedbyasingle toolon13anti malwareproducts.pomilia studiedtheperformance of anti malware products on a dataset obfuscated using allatori.moralesetal.
studiedtheresilienceof4anti malware productsaftertransforming2virusesonwindowsmobileos.
alltheaforementionedpreviousworkthathavestudiedeither obfuscation tools or the effects of obfuscation strategies on anti malwareproductsfocusonasingleobfuscationtoolandasmall numberofanti malwareproductsandapps.noneofthesestudies have performed a large scale empirical study considering the effectsthatoccurduetotheconcurrentutilizationofanti malware products variousobfuscationtools andtheirsupportedobfuscation strategies.noneofthesestudiesassessedtheseeffectsonbenign apps theeffectsofcombiningobfuscationstrategies andtheability ofobfuscationtoolstoproducevalid installable andrunnableapps.
conclusion inthispaper wehaveevaluatedtheeffectivenessofthetop rated androidanti malwareproductsagainstcodeobfuscation.weused alargedatasetconsistingof3 000benignapps 000maliciousapps and73 362obfuscatedapps.toobfuscateandroidapps weapplied 29differentobfuscationstrategiesusing7commercial open source andacademicobfuscationtools.ourstudyincludesthefollowingkeyfindings allanti malwareproductssuccumbtocodeobfuscation mostproductsaresusceptibletotrivialtransformations suchas simplechangestotheandroidmanifestfile thedetectionratesof anti malwareproductsdependnotonlyontheobfuscationstrategy appliedbutalsoontheleveragedobfuscationtool anti malware products are slow to adopt signatures of malicious apps and codeobfuscationtoasignificantextentresultsinappsthatdonot exhibitthesamebehaviorastheiroriginalversions.basedonour overallfindings wehaveprovidedguidanceandrecommendations forimprovinganti malwareproductsandobfuscationtools.tothat end ourstudyresults includingtheframeworkthatwedeveloped toconductthisstudy areavailablepubliclyonline .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
alarge scaleempiricalstudyontheeffectsofcode obfuscationsonandroidappsandanti malwareproductsicse may27 june3 gothenburg sweden