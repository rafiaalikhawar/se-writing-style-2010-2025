differential program analysis with fuzzing and symbolic execution yannic noller humboldt universit t zu berlin germany yannic.noller hu berlin.de abstract differential program analysismeans to identify the behavioraldivergences in one or multiple programs and it can be classified into twocategories identifythebehavioraldivergences betweentwo program versions for the same input aka regression analysis and forthesameprogramwithtwodifferentinputs e.g side channel analysis .mostoftheexistentapproachesforbothsubproblemstry tosolveitwithsingletechniques whichsufferfromitsweaknesses like scalability issues or imprecision.
this research proposes to combine two very strong techniques namely fuzzingandsymbolic execution totackletheseproblemsandprovidescalablesolutions forreal worldapplications.theproposedapproacheswillbeimplementedontopofstate of the arttoolslikeaflandsymbolic pathfinder to evaluate them against existent work.
ccs concepts software and its engineering software verification and validation security and privacy systems security keywords differential program analysis fuzzing symbolic execution acm reference format yannic noller.
.
differential programanalysis with fuzzing and symbolic execution.
in proceedings of the 33rd acm ieee international conference on automated software engineering ase september montpellier france.
acm new york ny usa 4pages.https introduction differentialanalysisaimstofinddifferentbehaviorsinprograms.
this includes the identification of divergences between two program versions for the same input regression analysis but also the identification of divergent behaviors for different inputs for the same program.
whereas regression analysis is interested in verifying software patches for unintended behavioral changes the second problem can be used in security analysis to identify long runningprogrampaths worst casecomplexityanalysis wca that canbeusedbyapotentialattackertoconductadenialofservice permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
ase september montpellier france association for computing machinery.
acm isbn ... .
or to locate side channel vulnerabilities that can be used to exposesecretinformation side channelanalysis .therefore having effective and scalable techniques to perform a differential analysis of programs is crucial for testing real world software.
fuzzing has become one of the most promising testing techniques for finding bugs and security vulnerabilities in software .
even though a large amount of invalid inputs get generated fuzzing can be more effective in practice than more complex testing techniques due to its low computation overhead.
although fuzzers are known to be good at identifying shallowbugs they may fail to execute deep program paths i.e.
paths that are guarded by specific conditions.
on the other hand symbolic ex ecution techniques are particularly well suited to explore various branches including paths that require these specific conditions.however symbolicexecutionisusuallymuchmoreexpensive in terms of computational resources used during exploration.
worst casecomplexityanalysisismostlyperformedonsymbolic execution based approaches or pure fuzzing approaches and both variants suffer from its weaknesses like scalabilityissuesforsymbolicexecutionbasedapproachesandimprecision for fuzzing based approaches.
existent techniques for side channel analysis e.g.
are too inaccurate and too imprecise for real worldapplications.stateoftheartapproachesforregression analysis aim at covering the changed behavior but mightmissimportantdivergencesdueto e.g.
impreciseconstrainthandling.aspalikarevaetal.
alreadymentioned testingevolvingsoftwareisadifficultproblem whichisunlikelytobesolved by a single technique.
there are approaches on how to combine fuzzing with symbolic execution for test case generation above all driller thatcombinestheaflfuzzerwiththeangrsymbolicexecutionen gine.allthesecombinationstrytocombinethestrengthsoffuzzing and symbolic execution in order to overcome their weaknesses.
however neither of them focus on the problem of differential pro gram analysis but mainly on generating high coverage test suites.
differential program analysis needs a multi dimensional approach with more sophisticated cost functions.
especially the symbolic executionsideneedstobedesignedtonotonlysolveconstraints forunexploredpaths buttoalsochoosepromisingpathsthatlikelyleadtoameasurabledifference.therefore thisresearchproposestoexplorecombinationsofcost guidedfuzzinganddynamicsymbolic execution driven by appropriate heuristics to tackle the problemof differential program analysis namely worst case complexity analysis side channel analysis and regression analysis.
inordertoevaluatethisapproach thisworktargetstobuildtools basedonthefuzzerafl togetherwithkelinci aninterface foraflthatenablesfuzzingof javaprograms andthesymbolic authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france yannic noller executionenginesymbolicpathfinder spf .suchnewtools can be evaluated against existing work in terms of effectiveness and efficiency.
already performed experiments with such a combinationoffuzzingandsymbolicforwcashowpromisingresults in outperforming the single techniques cf.
the description of badgerinsection .
.additionally differentialfuzzing sofarwithout symbolicexecution wassuccessfullyappliedtodetectside channel vulnerabilities cf.
section .
.
efficient scalable and automated techniques for differential programanalysiscangreatlyhelpsoftwaredevelopersinseveralapplications.identifyingsecurityvulnerabilitiesgetsmoreandmoreim portantintoday subiquitouscomputingenvironment.fastandprecise testing of software patches is crucial to make changes quickly inevolvingsystems.theproposedresearchaimsatfindingthese efficient and scalable techniques that are applicable in a real worldenvironment.
furthermore the goal of this research is to automate these techniques as much as possible to increase their usability.
related work stateofthearttechniquesforworst casecomplexityanalysisfocus on either fuzzing techniques or symbolic execution based techniques.slowfuzz isafuzzerthatprioritizesinputsthatleadto increased execution times and hence it aims at finding the worstcase input in terms of program execution time.
perfuzz i s anotherrecentfuzzingapproachthatusesmultidimensionalfeedbackandmaximizestheexecutioncountsforeachreachedprogram location in order to identify distinct performance hot spots.
approacheslike wise and spf wca use concolicexecution to learn a path policy that likely leads to a worst case execution of theprogram.bothperformexhaustivesymbolicexecutionforlarge enough user defined input sizes to obtain good policies whichmay not feasible in practice.
a combination of fuzzing and symbolicexecutionwouldavoidanexhaustiveexplorationandcould be fully automatic.
typicallyaside channelanalysisacceptsprogramsassecureif the secret data can not be inferred by the side channel measure ments that an attacker can make of the systems.
this intuitive property is called non interference which can be checked with e.g.
self composition .insteadofcheckingnon interference which mightnotholdformostrealisticapplications theveryrecentapproach themis checks a notion of bounded non interference whichacceptsaprogramassecureaslongasthecostdifferences stays within the specified threshold.
with the focus on verify ing the absence of timing channels blazer departs from the composition based strategies and instead establish a novel decompositionmethodology.bothapproaches blazerandthemis are based on a static analysis which might lead to false alarms and misstogenerateconcretevaluesthatarecrucialinreproducingand fixing the found vulnerabilities.
other approaches use symbolic execution and constraint solving in addition with model counting forquantifyingside channelleakageandforsynthesisofattacks.although theyaddresstheanalysisof javaprograms they can not yet scale to large applications due to the expensive constraint manipulation.
an efficient technique based on dynamicanalysis could provide concrete inputs to reproduce bugs and overcome the imprecision which is necessary for the application on complex real world problems.
state of the art regressionanalysis techniques aimat covering the changed program statements by applying dynamic symbolic execution.directedincrementalsymbolicexecution dise leverages static analysis to guide symbolic execution to changedprogram locations only.
due to the fact that it executes only thenew version of the program dise might lead to imprecise pathconditions which can miss divergences between the old and the newversion.shadowsymbolicexecution bypalikarevaetal.
applies on a changed annotated program version which combines the old and the new program.
thus it can use the information from both versions.
they introduce a dynamic analysis technique whichneedsconcretetestinputstodrivethesymbolicexecution.
theyassumetohaveatestsuitecreatedbydevelopers fromwhich they can retrieve tests that touch the changed portion of the code.
shadow symbolic execution might miss divergences that could exposeregressionerrorsiftheconcreteinputsleadtopathconditions that eliminate certain future program paths.
several existent approaches try to combine fuzzing with symbolic execution for test case generation.
evosuite is a test case generation tool for java based on evolutionary algorithms and dynamicsymbolicexecution.sage scalableautomatedguided execution extends dynamic symbolic execution with a generational search that instead of negating only the final condition of a complete symbolic execution negates all conditions on the path.mayhem a symbolic execution engine with special focus on security vulnerabilities in binaries was combined with the murphy fuzzer and won the darpa cyber grand challenge .
driller isanotherpromisingtoolthatcombinestheaflfuzzer with the angr symbolic execution engine and that has achieved similar results to mayhem.
proposed solutions .
worst case complexity analysis figure1shows the overview of the technique badger which was presentedatthe issta .badgeruses thecombinationof the cost guided fuzzer kelinicwca and concolic execution based on spf named symexe .
by running both techniques in parallel whiletheyexchangetheirresultswitheachother itispossibleto leveragebothstrengthsandovercometheirsinglelimitations.kelinicwca prioritizes costly paths by allowing afl to not only use inputs that increase coverage but also inputs that lead to an increasedcostvalue intime memoryoruser definedcost .
symexe importsthegeneratedinputsfromthekelinicwcaandbuildsthe symbolic execution tree driven by the concrete values.
based onheuristics it picks the nmost promising nodes for further exploration and generates inputs that then can be exported to the fuzzer to further push it into deeper paths.
themostrelatedworktothisapproachisslowfuzz which is a fuzzer similar to kelinicwca.
unfortunately the approaches cannotbedirectlycomparedbecauseofdifferenttargetprogramlanguages.
therefore the evaluation for badger uses similar subjects as slowfuzz and shows how all components symbolic execution fuzzing and the combination perform in terms of the quality of authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
differential program analysis with fuzzing and symbolic execution ase september montpellier france fuzzer import inputs export inputs5 trie extension input assessmentconcolic execution worst case analysisincludes2 exploration trie guided symbolic execution bounded symbolic execution3input generation model generation input generator4symexemode.import most promising nodemode.exportinteresting input figure badger workflow representing how to combine fuzzing and symbolic execution for wca .
the obtained worst case and thespeedin finding it.
as an excerpt fromtheevaluation figure 2showstheresultsforinsertionsort n forwhichtheexperimentwasconductedfor5hoursand the cost metric was the number of jumps in the java bytecode.
.
.
.
.
time minutes costs jumps badger kelinciwca kelinci symexe figure results for insertion sort n .
.
side channel analysis side channel vulnerabilities can be detected by maximizing the differenceinobservationbetweentwoprogramexecutions forwhich onlythesecretvaluesaredifferentandthe publicvalueremainsthe same.acost guidedfuzzerthatcanhandleuser definedcosts simi lartokelinicwca canbeusedtoimplementthisideabyusing thedifferenceinobservedcostbetweentwoprogramexecutions as user defined value.
as a first step this idea was implemented in aprototypeandtheevaluation whichincludescomparisonwith blazer and themis showed thatit effectivelycanidentify side channel vulnerabilities in real world applications like apache ftpserver .
as next step this research plans to combine this fuzzing approach with a similar symbolic execution approach usedin badger.
in contrast to badger which uses fixed input sizes dif ferentialfuzzinghandlesarbitraryinputsizesuptoaspecifiedlimit because it depends on the fuzzing step and the dynamic fuzzing drivertodeterminethecurrentinputsize whichmakesitnecessary to apply a more sophisticated symbolic execution approach.
the constructedsymbolicexecutiontreehastohandlemultipleinput sizes at the same time which can be realized by using a virtual decision on the top which determines the current size of the input.
.
regression analysis for the worst case complexity analysis it seems to be logical tofollow or search next to costly paths to find even more costly paths.
unfortunately the approach which works for wca and side channel analysis does not need to work as well for regression analysis.regressionanalysistriestofinddivergencesintermsof taking different branches in two program versions for the same input.quantifyingthesedivergencesisnotasstraightforwardas quantifying cost differences like execution time.
as fuzzing cost metrics this research proposes to investigate two alternatives a using cost defined by number of executed statements similar to the previous work on worst case complexity analysis and side channel detection for which a cost difference is clearindicatorforaregression althoughitmightmissregression cases and b usingthedifferenceindecisionsequences i.e.how similar have been the decision made in both program versions.
as symbolic execution counterpart this work identified two options i applyingshadowsymbolicexecution drivenbythe concreteinputsimportedfromthefuzzerside or ii applying standard symbolicexecutionsimilartotheside channelanalysiswhere the difference is measured by applying metric b the differencein decision sequences.
variant i would be based on a recent implementationofshadowsymbolicexecutionon topof spf called shadowjpf .shadowsymbolicexecution needsconcrete values whichcouldbeobtainedfromthefuzzingside.inadditionto be driven by concrete values the symbolic execution in variant i shouldalsoapplyafullfour wayforkingtofindthemostpromising nodes for exploration and guide the fuzzing in deeper paths.
theoverallworkflowlookssimilartotheonebybadger cf.
figure although the analysis part needs to be replaced by appropriate metrics to identify regressions.
progress in research thework onworst case complexityanalysisis finishedwiththe publication of badger at the issta .
the work on sidechannelanalysiswasstarteddevelopingafuzzingapproachforthe identification of side channel vulnerabilities.
additional work is requiredtomakeusageofthefullpotentialoffuzzingandsymbolic execution in this area.
furthermore it is necessary to work on the generationofconcreteattacksbasedonaprioranalysisbasedon fuzzingandsymbolicexecution.theworkonregressionanalysis with fuzzing and symbolic execution was started by providing shadowjpf anextensionforspftoperformshadowsymbolic execution at the jpf workshop .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
ase september montpellier france yannic noller planned evaluation inordertoevaluatetheproposedapproachesthisresearchplansto quantitativelycomparetheresultingtoolswithexistingapproaches.
for the side channel analysis the evaluation will include microbenchmarks from existent work which consist of subjects fromliteratureandsmallerexamples butalsopopularreal worldap plicationsliketomcat jetty spring securityandapacheftpserver.
theevaluationwillfocusoncomparingtheidentifiedcostdifferencesaswellastheneededanalysistime.fortheregressionanalysis thepreviousworkincludestheevaluationonsmallersubjectsfor a preliminary assessment.
it is necessary to identify more java subjects applicable for regression testing.
conclusion the purpose of this research is to identify effective metrics for differential program analysis which canbe used as cost functions to drive acombination offuzzing and symbolic execution.
additionally thisresearchaimstoidentifywhichtypesofdynamicsymbolic execution should be combined with fuzzing for the specific sub problems.
the resulting tools will be made publicly available in order to support open science and to provide scalable solutions for real world applications.