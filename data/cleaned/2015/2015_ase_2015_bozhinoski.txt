flyaq enabling non expert users to specify and generate missions of autonomous multicopters darko bozhinoski1 davide di ruscio2 ivano malavolta1 patrizio pelliccione2 massimo tivoli2 1gran sasso science institute l aquila italy 2university of l aquila department of information engineering computer science and mathematics italy 3chalmers university of technology juniversity of gothenburg dep.
of comp.
science and eng.
sweden darko.bozhinoski gssi.infn.it davide.diruscio univaq.it ivano.malavolta gssi.infn.it patrizio.pelliccione gu.se massimo.tivoli univaq.it abstract multicopters are increasingly popular since they promise to simplify a myriad of everyday tasks.
currently vendors provide low level apis and basic primitives to program multicopters making mission development a task specific and error prone activity.
as a consequence current approaches are affordable only for users that have a strong technical expertise.
then software engineering techniques are needed to support the definition development and realization of missions at the right level of abstraction and involving teams of autonomous multicopters that guarantee the safety today s users expect.
in this paper we describe a tool that enables end users with no technical expertise e.g.
firefighters and rescue workers to specify missions for a team of multicopters.
the detailed flight plan that each multicopter must perform to accomplish the specified mission is automatically generated by preventing collisions between multicopters and obstacles and ensuring the preservation of no fly zones.
i. i ntroduction the near future will be pervaded by multicopters performing a variety of tasks like damage assessment after earthquakes searching for survivors after airplane accidents and disasters coastal surveillance securing large public events monitoring oil and gas pipelines observing traffic flows monitoring pollution emission and protection of water resources .
however at the state of the art and practice on site operators must deeply know all the types of used multicopters in terms of e.g.
flight dynamics and hardware capabilities in order to correctly operate with them.
on site operators have to simultaneously control a large number of multicopters during the mission execution.
moreover professional use of multicopters often is realized by allocating two operators for each multicopter where the first operator controls the movements while the second one controls the instrumentation like photo camera its gimball and other sensors.
nowadays vendors provide low level apis and basic primitives to program multicopters thus making mission development an error prone activity that can be performed by a restricted number of highly skilled professional stakeholders.
tasks are very specific and this limits the possibilities for their reuse across missions and organizations.
consequently current approaches are affordable only for users that have a strong expertise in the dynamics and technical characteristics of the used multicopters.
then software engineering approaches and methodologies are needed to support the definition thedevelopment and the realization of missions involving teams of autonomous multicopters while guaranteeing safety.
this paper describes a tool for the definition of missions of teams of multicopters and the generation of the detailed flight plan of each multicopter in the team.
specifically starting from a high level description of the mission flyaq automatically generates a detailed flight plan for a team of autonomous multicopters that will satisfy the specified mission while preventing collisions with other multicopters and obstacles and respecting no fly zones.
end users of flyaq have expertise neither in ict nor in multicopters dynamics e.g.
firefighters and rescue workers.
the webpage of the tool is available at .
ii.
o verview of the tool flyaq ensures a strong adherence with the application domain by providing an extensible domain specific language named monitoring mission language mml which permits to graphically define the missions.
extension mechanisms of the language allow domain experts to specialize mml with additional tasks that are specifically tailored to the considered domain.
for example if operators are interested on monitoring solar panel installations in a rural environment the language might be extended with tasks representing the concept of e.g.
solar panel groups thermal image acquisition solar panel damage discovery and notification.
mission context map mml qbl qbl model generation multicopters configuration mission execution engine fig.
.
overview of the flyaq tool as shown in figure mml is composed of three layers i to specify the mission by means of the modeling constructsmmlqbl model automatic generation qbl ... mission entering mission exiting mission tasks execution ... ... ... d1 d2 dn state transition state synchronization and communication message fig.
.
overview of the approach provided by the language ii to specify the context in which the swarm of multicopters has to operate such as no fly zones obstacles etc.
and iii amap representing the geographical zone where the mission will be executed.
once the mission has been specified waypoints and trajectories are automatically calculated.
they are represented in an intermediate language named qbl.
examples of qbl actions include land take off hover head to goto read from a sensor send feedback to the ground station and send receive a notification to from other multicopters.
qbl has been defined through an iterative process involving experts of the application domain considered by flyaq.
qbl models are interpreted at mission run time by a set of software controllers each of them commanding a single multicopter according to the various movements and actions contained into the qbl model.
each controller is dedicated to a specific type of multicopter so that it is able to account for the specific flight dynamics and other characteristics of the managed multicopter.
as shown in figure the qbl model automatically generated out of the mml one is organized into nparts each of them describing the detailed flight plan of a specific multicopter.
the flight plan of a multicopter can be abstracted as a finite state transition system where each transition corresponds to a qbl operation.
both cyclic and alternative behaviours can be performed.
multicopters can exchange synchronization and communication messages see dashed arrows in the figure .
flyaq assumes that at the beginning of the mission each multicopter will be positioned at its home location and that at the end of the mission it will land to a possibly different location.
then the finite state system is structured in three parts mission entering consisting of the operations required to start the mission e.g.
take off mission tasks execution consisting of the operations required to accomplish each mission specific task e.g.
searching for an object in an area taking a picture in the waypoints of an area detecting the level of carbon dioxide in a specific point mission exiting consisting of the operations required to conclude the mission e.g.
going back to home landing.
the main difficulty of the approach is that mml is extensible and hence it is not possible to define once all the translation rules needed to translate mml tasks into qbloperations.
therefore the automated generation is based on three main concepts i typology and characteristics of the zone that is affected by the mission ii strategies to be applied to calculate the concrete movements that drones have to perform and finally iii actions to be performed while visiting the identified waypoints.
these concepts pose constraints and permit to use consolidated and optimised algorithms e.g.
shortest path calculation between two points path planning etc.
that will be exploited by the generation process to e.g.
determine how a drone should visit a fly zone according to specific path planning policies.
then a flyaq tool extender can define concrete tasks for the considered domain by associating these tasks to the general concepts defined in the tool.
in this way the generation of drone specification is fully automated.
the translation from mml to qbl relies on three auxiliary functions that implement suitable operations to i distribute the geographical area of each task into a set of sub areas each of them assigned to a specific drone function divide ii let a drone approach the mission by reaching the starting point in the zone assigned to it function appr and iii cover the assigned zone according to the specified strategy and by performing the specified actions for each way point function cover .
the generation of auxiliary functions builds on state of the art and well established algorithms for solving problems like polygon partitioning path finding and graph traversals .
the modularity of the current implementation of flyaq allows a straightforward inclusion of alternative algorithms and or future advances of existing ones without affecting the generation process.
the generation from mml to qbl has been implemented by following the model driven engineering paradigm.
more precisely the outputs of the three auxiliary functions applied to the source mml model are represented as three corresponding models.
such models are taken as input by the model transformation mm2qbl which is able to generate qbl models out of mml ones see listing .
such transformation is developed by means of the atlas transformation language atl which is a hybrid language containing declarative and imperative constructs.
the fragment of the mm2qbl transformation consists of a header section line transformation rules lines and a number of helpers which are used to navigate models and to define complex calculations on them lines .
according to the header section the mm2qbl transformation takes as input four input models to generate a qbl model out of them.
helpers and rules are the constructs used to specify the transformation behaviour.
each rule defines the elements to be generated by means of target patterns e.g.
lines that specify the instances of the target metamodel to be generated i.e.
the dbs metaclass of the qbl metamodel and a set of bindings.
a binding refers to a feature of the type i.e.
an attribute or a reference and specifies an expression whose value initializes the feature.
to implement the generation of auxiliary functions corresponding helpers have been defined.
for instance the divide helper in lines is able to read the source divide model and retrieves as output the sub zones representing a spatial partition of the task space.
themm2qbl transformation has been designed so to have three main rules to manage the generation of target model frag ments related to mission entering tasks execution and exiting see lines .
additional rules are specified for generating specific elements of the target qbl models.
for instance the generation of target takeoff elements is performed by the missionentering takeoff rule which is called by the missionentering rule see line .
listing .
fragment of the mm2qbl transformation 1module mml2qbl 2create out qbl from in mml in appr appr in cover cover in divide divide ... 4helper def divide task mml!task positions sequence mml!coordinate context mml!context divide!
output 5divide!mapping.allinstances 6select m m.input.task.name task.name and thismodule .samecoordinates m.input.positions positions and thismodule .samecontext m.input.
context context first .output 11helper def appr ... sequence appr!coordinate ... 12helper def cover ... sequence cover!output ... ... 14rule dronetasks 15from s mml!dronetasks 17to d qbl!drone name s.drone.name 19do thismodule .missionentering d thismodule .missiontasks d thismodule .missionexiting d ... 26rule missionentering d qbl!drone 27using approachingpoints sequence appr!coordinate ... lastapproachingpoint appr!coordinate approachingpoints last 31to t qbl!dbs drone d transitionfunctions thismodule .missionentering takeoff t si lastapproachingpoint.altitude ... ... due to space limitations we do not provide the reader with the full implementation of the mml2qbl transformation the interested reader can download it from .
iii.
i ntended users of the tool and scenarios the intended users of flyaq are public or private entities that have to perform missions via multicopters.
we also expect that multicopters manufacturers will be interested in participating in the industrial exploitation of the idea with the aim of including in the produced multicopters the software developed by flyaq.
in fact the software layer produced by the project will allow to specify monitoring missions at a high level of abstraction that is making possible the definition for users non expert in ict and that are experts in a specific mission.
additional users of flyaq are modeldriven engineering experts that have to perform the extension of the flyaq tool to support the specification and execution of new tasks and types of specific missions according to the knowledge extracted from domain experts.
within the panorama of missions typical scenarios concern i disaster prevention and management like damageassessment after earthquakes searching for survivors after airplane accidents and disasters ii homeland security such as coastal surveillance securing large public events iii protection of critical infrastructure such as monitoring oil and gas pipelines protecting maritime transportation from piracy observing traffic flows iv communications like broadband communication telecommunication relays v environmental protection such as pollution emission protection of water resources.
figure shows a screenshot of the flyaq editor while the on site operator is specifying by means of mml a mission to monitor a large public event in a small city for security reasons tasks of the mission have been graphically manipulated so to improve the readability of the figure .
the editor consists of four main components an interactive map for drawing and editing missions a dedicated palette with all the available types of tasks according to mml and its extensions ain figure a palette for managing the available drones to be used in the mission bin figure and a panel for managing the execution order of the specified tasks cin figure .
for more details about mml interested readers can refer to .
a flyaq mission essentially results in a set of geographical areas movement strategies that drones involved in the mission should perform on selected areas such as coverage search for an object etc.
and actions to be performed while traversing the interested waypoints e.g.
taking a picture or performing a video.
the specified mission is composed of two tasks to be performed in parallel photo grid task pgt this task is performed above a square see the rectangle in figure within the circle pgt to monitor it.
the photo grid task identifies a virtual grid within the area each cell of the grid having a size of 10meters.
the drones executing the task will fly over each cell of the grid at an altitude of 25meters and then will take a picture of the area directly below them.
road task rt this task refers to a polyline corresponding to the streets to be monitored see the polyline in figure identified by the circle rt .
drones are required to fly along the polyline at an altitude of 25meters and take a picture every 200meters along the polyline.
the mission will be realized by three drones that will be positioned in a large parking lot close to the city center see the nf1 nf2 rt home pgt abc fig.
.
screenshot of the tool while editing an mml models10 takeoff p1.z s1 goto c1 s goto c2 s goto p1 v1 mission entering v11 goto q1 dophoto ... v21 v161 v171 ... noop s2 s goto c1 s goto c2 s goto p1 goto home1 land s1f land1 mission tasks execution mission exiting non fluid transition fluid transition transition label syntax op act op act goto q16 dophoto ... noop r1 noop fig.
.
qbl based specification of d1 home circle in figure two drones will take care of executing pgt whereas a single drone will execute rt independently.
flyaq allows the user to define also contextual information about the mission.
in this example the context specification contains two no fly zones and an obstacle.
the two no fly zones called nf1 and nf2 are the ones within the city center.
the obstacle is within the area involved in the pgt task and it represents the area reserved by televisions to record activities performed during the event in the main square of the city.
the obstacle is better visible in figure .
figure shows the transition system corresponding to the qbl based behaviour specification of drone d1in our scenario.
we recall that such a specification is automatically generated out of the specified mml model.
as described in section ii the behaviour of d1consists of three phases mission entering this phase concerns the mission entering see the transition from s1 0tos1in figure d1takes off from home and reaches the altitude of the mission s starting point.
mission tasks execution this phase concerns the execution of each task in which d1is involved.
d1is involved in only one task i.e.
task t1.
since t1involves both d1andd2 d1has to monitor half of it see the area delimited by p1 p2 q7 and q10 by discretizing its sub area according to the grid of points shown in figure .
the other half is monitored by d2.
this zone for d2 q4 p2 q1 p1 q3 q14 q5 q6 q15 q16 q2 q13 q12 q11 q7 q8 q9 q10 p3 p4 d1 visit plan c1 c2 p1 fig.
.
reasoning to obtain the drone behaviour specificationavoids collisions between d1andd2during the execution of t1.
according to the specified strategy and grid dimension d1 covers its discretized sub area by performing a specific visit plan see the sequence of arrows shown in the right hand side of the figure .
first d1reaches the starting point of the mission by means of a sequence of goto operations.
the mission entering path is calculated in order to avoid both collisions with other drones in the mission and traversing no fly zones.
in fact as shown in the right hand side of figure d1approaches the mission by traversing the c1andc2points hence reaching p1 which is a vertex of the area specified for the execution of task pgt.
traversing these points means that d1avoids specified no fly zones and the path specified for the execution of task rt by drone d3 hence avoiding also collisions with d3.
accordingly ford2andd3different mission entering paths are calculated.
second d1covers its sub area by means of a sequence of goto operations and dophoto actions the sequence of waypoints is q1 q16 see the mission task execution part of figure .
notice that q1coincides with p1 then the first goto i.e.
goto q1 will have no effect since the d1will be already in p1.
this is a side effect of having the code generated however this has no effect on the mission execution and this goto operation can be removed by minimizing the final drone behaviour specification.
mission exiting this phase concerns exiting the mission hence leading d1to come back to home and land see transitions from s2tos1 fin figure .
iv.
p reliminary assessment of the tool as a first step towards a realistic assessment of the feasibility of our automatic generation method we executed generated qbl models by using a software in the loop sitl simulation platform.
the main characteristic of sitl simulations is that the used software stack is exactly the same as the one used in real flights the only difference with respect to real flights is that the key low level hardware drivers e.g.
gps sensors accelerometers etc.
are simulated via a dedicated software.
the main component of our sitl simulation stack is mavproxy1 that is a developer oriented minimalist and extendable ground control station for any unmanned autonomous vehicle.
moreover we performed real tests involving the parrot ar.drone2.
multicopter2 a video of a demo might be found at .
we considered missions involving different tasks various numbers of tasks and various context descriptions.
v. r elated work a comprehensive survey of approaches for cooperative teams of ua v operating as distributed processing systems can be found in .
the work in introduces csl which is a high level feedback control language for mobile sensor networks.
the style of the language is similar to that of petri nets missions are made of tasks with tokens and transitions .
the run time architecture of the proposed approach allows engineers to update a modelled mission at run time by means vproxy a patching system for the mission specification.
differently from our approach the csl language does not support any kind of check on the feasibility and safety of the modelled mission also trajectory plan in 3d is not supported.
many algorithms have been proposed for automatic trajectory generation and control with a strong focus on either trajectory optimization feasibility or safe obstacle and trajectories intersection avoidance .
the interested reader can refer to which proposes an overview of existing motion planning algorithms specific for ua v guidance.
from a slightly different perspective the work in proposes a new paradigm called cyber physical computing cloud cpcc .
it allows any customer to assign check and distribute sensing services on virtual vehicles.
essentially this approach ports the principle of platform as a service paas to the distributed robotics domain.
according to this principle the system can perform multi customer information acquisition missions on swarms of ua v operated and maintained by a third party similarly to how traditional web based paas systems work.
differently from our approach in freespace environment is assumed and collisions are not taken into consideration.
moreover location movements related to the tasks are manually given by the customers of the paas system then tasks are assigned to physical vehicles by using a binding algorithm based on v oronoi cells.
for what concerns the activity of mission planning and definition many approaches focus on the definition of either gps based or vision based waypoints and trajectories in the real world that must be navigated by the multicopter in the field .
differently from these approaches our main objective is to provide an extensible software tool that makes the specification and generation of missions possible for people that are neither expert on ict nor in robotics.
in other words we address the problem from the software engineering perspective as our tool i focusses on the definition of the various tasks of a monitoring mission at an higher level of abstraction i.e.
tasks and tasks dependencies ii allows engineers to automatically generate detailed flight plans from a user friendly domainspecific and graphical description of a mission iii generates flight plans that avoid obstacles collisions and no fly zones iv does not demand to manually specify each single waypoint of the mission that actually may be hundreds in complex missions rather it is able to automatically compute plan and assign all the waypoints that must be visited by each multicopter of the swarm to accomplish the mission and v is independent from the used task allocation geometric and path finding algorithms thus enabling for the use of state of the art and well established algorithms depending either on the next advances of those algorithms and on the traits of the missions to be performed in the future.
vi.
p otential impact the major benefits related to the adoption of the flyaq tool by organizations that need to carry out dangerous and difficult missions are low cost the use of flyaq and its multicopters permits to reduce the costs due to the employment of personnel on the site to be monitored and to the adoption of complex communication means for synchronizing the teams.enhanced safety the employment of autonomous multicopters in dangerous missions permit to avoid to expose the staff on site to significant risks in case of particular situations due to fire earthquake flood etc.
improved timing usually monitoring activities are very time consuming the staff assigned to monitoring is subjected to gruelling shifts and often the missions are stopped during the night.
the autonomous multicopters instructed by means of the flyaq environment help to reduce such difficulties.
graphical language missions are graphically defined in the ground station.
the graphical language is integrated with the open street map well known open source product in order to visualize the geographical points that have to be monitored during the missions being specified.
having a graphical language for defining monitoring missions permit to hide the detailed flight plan which may be very hard to use and understand by non expert users.
versatility the graphical language used for defining monitoring missions is very simple and provides the concepts which are familiar to the domain experts.
thus there is no need for expensive training sessions or special maintenance activities.
tool support research and development groups who are willing to work on self multicopters and instruct them at a high level of abstraction will have access to the source code of the flyaq tool extend reuse individual components and then carry out their research without having to develop an entirely new framework from scratch.
vii.
c onclusions and future work this paper describes the flyaq tool to generate from a user friendly domain specific and graphical description of a mission the detailed flight plan that each multicopter in a team has to perform.
the generation approach avoids i collisions among multicopters and between multicopters and obstacles ii violations of no fly zones and iii unexpected behaviours that may come from the collaboration of independent multicopters.
flyaq has been conceived to allow non experienced users to easily specify missions for a team of multicopters.
as future work we are planning to enhance the current implementation of flyaq by integrating methodologies to control the mission execution at run time.
the idea is to exploit the synthesized flight plan at run time so to force the drones to exhibit only desired behaviours .
another interesting future work concerns the ability of accounting for time and resources consumption that are extremely important in this domain.
this will enable e.g the possibility of statically checking mission end to end timelines or the realization of resourceaware missions.
we will investigate also the possibility of making communication between drones more flexible so to enable also emerging behaviours this will open challenging and futuristic scenarios where intelligent swarms of drones will decide at run time operations to be performed in order to satisfy the goal of a possibly evolving mission.
finally the current benefits and limitations of the flyaq languages and their supporting tools will be assessed by means of studies involving the various stakeholders of flyaq.
this will permit also to identify potential directions for improvements.