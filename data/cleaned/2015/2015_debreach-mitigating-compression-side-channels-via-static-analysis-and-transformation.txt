debreach mitigating compression side channels via static analysis and transformation brandon paulsen1 chungha sung1 peter a.h. peterson2 and chao wang1 1university of southern california los angeles ca usa 2university of minnesota duluth duluth mn usa abstract compression is an emerging source of exploitable side channel leakage that threatens data security particularly in web applications where compression is indispensable for performance reasons.
current approaches to mitigating compression side channels have drawbacks in that they either degrade compression ratio drastically or require too much effort from developers to be widely adopted.
to bridge the gap we develop debreach a static analysis and program transformation based approach to mitigating compression side channels.
debreach consists of two steps.
first it uses taint analysis to soundly identify flows of sensitive data in the program and uses code instrumentation to annotate data before feeding them to the compressor .
second it enhances the compressor to exploit the freedom to not compress of standard compression protocols thus removing the dependency between sensitive data and the size of the compressor s output.
since debreach automatically instruments applications and does not change the compression protocols it has the advantage of being non disruptive and compatible with existing systems.
we have evaluated debreach on a set of web server applications consisting of 145k lines of php code.
our experiments show that while ensuring leakagefreedom debreach can achieve significantly higher compression performance than state of the art approaches.
i. i ntroduction compression is a technique for improving performance especially in web applications.
for example the deflate compression format in http is used by of the top one million websites because it reduces the size of web content such as html css and javascript by up to .
this not only decreases latency and increases throughput but also reduces energy consumption for battery powered devices.
deflate uses two techniques huffman coding and lz77 matching the latter of which is particularly effective for web content.
it replaces repeated strings with a reference to an earlier copy in the input.
for example if the input is bob is great bob is cool the output would be bob is great angbracketleft14 angbracketrightcool where the reference angbracketleft14 angbracketrightis interpreted asgo back bytes and then copy bytes .
web content has many repeated strings such as urls and html tags for example the string wikipedia.org wiki appears times on wikipedia s home page which will be reduced in size by .
unfortunately dictionary compression in general and lz77 in particular introduces side channels that can be exploited inpartially chosen plaintext attacks .
in such a case the attacker feeds a guessed text to the victim s application which combines the text with its own sensitive text before giving them to the compressor.
when the guessed text matches the sensitive text the compressed file will be smaller due tooriginal program php code sensitive data source apis a ... b ... datalog factsdatalog rules datalog solver datalog based static analysis code instrumentation analysisinstrumented program php code modified compressorruntime protection fig.
the overall flow of our debreach method.
lz77.
since encryption does not hide size this information can be leaked to an attacker even if the compressed file is encrypted before transmission.
consider the sensitive text ssn and the guessed texts ssn and ssn .
the former will be a complete match but the latter will not include the last character .
since lz77