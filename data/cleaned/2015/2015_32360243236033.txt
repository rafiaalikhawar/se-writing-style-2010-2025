one size does not fit all an empirical study of containerized continuous deployment workflows yang zhang national university of defense technology china yangzhang15 nudt.edu.cnbogdan vasilescu carnegie mellon university usa vasilescu cmu.edu huaimin wang national university of defense technology china hmwang nudt.edu.cnvladimir filkov decal lab university of california davis usa filkov cs.ucdavis.edu abstract continuousdeployment cd isasoftwaredevelopmentpractice aimedatautomatingdeliveryanddeploymentofasoftwareproduct following any changes to its code.
if properly implemented cd togetherwithotherautomationinthedevelopmentprocesscanbring numerous benefits including higher control and flexibility over releaseschedules lowerrisks fewerdefects andeasieron boarding of new developers.
here we focus on the r evolution in cd workflowscausedby containerization thevirtualizationtechnologythat enablespackaginganapplicationtogetherwithallitsdependencies andexecutionenvironment inalight weight self containedunit of which docker has become the de facto industry standard.
there are manyavailable choices for containerizedcd workflows some moreappropriatethanothersforagivenproject.owingtocrosslistingofgithubprojectsondockerhub inthispaperwereport onamixed methodsstudytoshedlightondevelopers experiencesandexpectationswithcontainerizedcdworkflows.startingfroma survey we explore the motivations specific workflows needs and barriers with containerized cd.
we find two prominent workflows basedontheautomatedbuildsfeatureondockerhuborcontinuous integration services with different trade offs.
we then propose hypotheses and test them in a large scale quantitative study.
ccs concepts software and its engineering software maintenance tools keywords continuous deployment containerization docker github acm reference format yang zhang bogdan vasilescu huaiminwang and vladimirfilkov.
.
onesizedoesnotfitall anempiricalstudyofcontainerizedcontinuous deploymentworkflows.in proceedingsofthe26thacmjointeuropeansoftware engineering conference and symposium on the foundations of software engineering esec fse november lake buena vista fl usa.
acm newyork ny usa 12pages.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
esec fse november lake buena vista fl usa association for computing machinery.
acm isbn ... .
introduction continuous deployment cd also referred to as continuous delivery 1is the fast paced automation heavy software engineering approachinwhichteamsworkinshortiterationstoproducesoftwarethatisdeployable productionready atanytime .cdhas promisedtodeliverarevolutionoverthetwice yearlyorsostandard for software releasing through greater control and flexibility overfeaturereleases incrementaldeploymentofvalue lowerrisks fewer defects easier on boarding of new developers less off hours work andaconsiderableuptickinconfidence .itisnotsurprisingthenthattheperforcereport foundthat65 ofsoftware developers managers and executives have used cd.
moreover the state of devops survey with participants from aroundtheworld foundcdpositivelyimpactsitperformanceand negatively impacts deployment pain.
on the other hand industry reports and academic studies have foundthatimplementingtheautomation i.e.
pipelines workflows needed to properly provide cd is challenging and takes a lot of time and tuning due to the many moving parts and the specific needs of each project or organization .
a prototypical cdworkflowinvolvesacontinuousintegration ci service like jenkins and travis which is triggered by new changes in the version control system to build test and deploy the pack aged application.
many separate and often redundant tools canbe pipelined to assemble a cd system for a project or organiza tion.
how to guides exist and turn key solutions mainly commercial arealsoavailable .previousstudieshavelooked atimplementationsofcdinindividualorganizations and one study has compared implementations in different organizations .
it is commonly reported in those studies that the benefits gained are many but that implementing cd takes time.
asmore andmore experienceis beinggainedwith differentways to implement cd it has become obvious that different solutions i.e.
workflows arepossible andthattheymayfitdifferentneeds.
stateddifferently choosingoneavailableworkflowvsanothermay make a big difference to a specific project.
thus maps of project needs onto prototype cd workflows would be considered helpful.
here we focus on studying the r evolution in cd workflows causedby containerization thevirtualizationtechnologythatenablespackaginganapplicationtogetherwithallitsdependencies andexecutionenvironmentinalight weight self containedunit.
1although technically continuous deployment encompasses continuous delivery the two terms tend to be used interchangeably in practice by developers.
we don t distinguish between the two here we define the workflows precisely below.
esec fse november lake buena vista fl usa yang zhang bogdan vasilescu huaimin wang and vladimir filkov containerization has transformed cd workflows promising additional speedups and higher level of abstraction.
containers orimages encapsulating a packaged application ready for deployment can be specified declaratively versioned together with the restoftheinfrastructurecode builtautomatically andpublished to some cloud based registry for easy access by users and other applications.amongcontainerizationtechnologies dockercontainershave become the de facto industry standard.
since inception in dockercontainershavebeendownloaded29b times2and their usage is spreading rapidly e.g.
the annual container adoption report foundthat79 ofcompanieschosedockerastheir primary container technology.
thus studying docker container usage is relevant to most of the containerization community.
in this paper we seek to aid in deciding how to appropriately choosebetweendocker enabledcdworkflows bycollatinglessons learned and offering data driven evidence from different cd implementations in open source software oss projects.
we focus on ossprojectsongithub thelargestpubliccoderepositoryhost and docker hub3 the most popular cloud based registry for docker containers whichhostsover2milliondockerimagerepositories asofmarch2018 oftheseimagesarelinkedtoagithubrepository enabling the data mining for our study.
as with any cd pipeline developers have considerable freedom todefinecustomdocker enabledworkflows choosing e.g.
whatci service to use what to include in the images and how to automate their construction and publication.
starting from these two public sourcesofdata githubanddockerhub inthispaperwereport on a mixed methods study to explore the following questions rq1 whatmotivations unmetneeds andbarriersdodevelopersface with their docker enabled cd workflows?
see rq2 whatarethedifferentialbenefitsamongspecificdocker enabled cd workflows?
see thefirstpartofourstudyisamulti stage150 developersurvey theresultsofwhich revealedsev eralcommoncdimplementations in projects publishing images to docker hub while some projects writetheirownscriptstodeployimages mostuseavailabletools which fittogether withoutextensive retoolingwith their existing solutions e.g.
standardciserviceslikejenkins travis andcircleci.
we found that two docker image deployment workflows4were most prominent adocker hub auto builds workflow denoted dhw where the registry itself builds the image automatically whenever github source files change and aci basedworkflow denotedciw wherecitoolsbuildimages during the build and test stage then publish to docker hub.
additionally thesurveyanswersalsogeneratedhypothesesrelatedtospecificcdworkflowoutcomes releasefrequency build results stability andbuildlatency suchas imagebuildlatencytends to worsen over time andciw tends to have higher image release frequency than dhw see .4and .
.
to test these hypotheses inthesecondpartofourstudyweperformeddatagathering andstatisticalmodeling.wecollecteddatafrom1 125projectson as of march .
4theseresemblethegithub pushandpull based models theciworkflow pushes the docker image while the dh workflow pulls it.docker hub measuring build latency release frequency config filesizesandchanges commitsizes testingtimes anddiscussion lengths.
the above four outcomes release frequency build results stability and build latency were regressed against an extensive set of variables fitted to the processed data and well fitting models were obtained.
in summary we found that ciw is associated with higher image release frequency than dhw.butovertime thereleasefrequencyofbothworkflows tends to drop image build latency tends to increase over time.
interestingly ciw tends to have shorter build latency than dhw imagebuildconfigurationstabilitytendstoincreaseovertime.
but ciw tends to have lower dockerfile stability than dhw ciw is associated with more image build errors than dhw there are notable differences withinciws not just between the dh and ci workflows.
our survey questions scripts and data are online at https github.com yangzhangs cd replication .
background and related work docker and docker hub .
docker i s anossprojectimplementingoperatingsystem levelvirtualization it builds on many technologies from operating systems research lxc linuxcontainers virtualizationoftheos etc.the technology is primarily intended for developers to create and publishcontainers .
with containers applications can share the same operating system and whenever possible libraries and binaries .thecontentofthecontainerisdefinedbydeclarationsin thedockerfile which specifies the docker commands and theorderoftheirexecution.dockerlaunchesitscontainersfrom dockerimage whichisaseriesofdatalayersontopofabaseimage .
when developers make changes to a container instead of directly writing the changes to the image of the container docker adds an additional layer with the changes to the image .
since productionenvironment replicascanbe easilymadeinlocal computers developers can test their changes in a matter of seconds.
also changestothecontainerscanbemaderapidlyasonlyneeded sections are updated following a change.
this makes docker very suitable for ci and cd implementations .
existingstudiesrelatedtodockercontainershavetypicallyfocused on performance aspects security vulnerabilities and basic usage .
in particular cito et al.
found that deployment pipelines are in most part structured in multiple and consecutive phases but that thus far there has been little research on docker enabled workflows in cd processes.
a recent study has pointedoutthatsoftwareengineeringtaskscanbenefitfromthe mining of container image repositories like docker hub .
dockerhubisdocker scloud basedregistry containing2 docker images as of march .
docker hub provides github integrationaswellassomefeaturedtools e.g.
automatedbuilds whichallowdeveloperstobuildtheirimagesautomaticallyfrom githubsources .thebuilddataanddockerfileinformationon docker hub is available for mining if the repositories are public.
cdanddeploymentpipelines .continuousdeployment cd is apracticeinwhichincrementalsoftwareupdatesaretested vetted anddeployedtoproductionenvironments .cdleveragesthe 296one size does not fit all an empirical study of containerized ... esec fse november lake buena vista fl usa ci processandextendsittoincludetheimmediatedeployment ofsoftware .humble etal.
reportedonanearlyoverviewof cd practices and introduced several guidelines.
vassallo et al.
investigated cd practices at ing focusing on their impact on the development process and management of technical debt.
savor et al.
reported on anempirical study conducted in two highprofile internet companies they found that the adoption of cd doesnotlimitscalabilityintermsofproductivityinanorganizationeven if the system grows in size and complexity.
in summary prior work mostly focused on defining cd and describing particular implementations in a small sample of organizations or projects.
theemergenceofcdalsoincreasestheimportanceofdeployment pipelines .
a deployment pipeline should include explicit stages e.g.
building and packaging to transfer code from a source repository to the production environment .
in each stage developers can choose different tools or services which in turn will producedifferentcdworkflows.it isbecomingincreasinglyclear thatonesizedoesnotfitall withrecentstudiesbyshahin etal.
zhaoet al.
or widder et al.
showing that the choice of ci cd tools and infrastructures is highly context dependent.
despite the importance of containerization and docker in industry tothebestofourknowledge noexistingresearchhasinvestigated the barriers and needs developers face when using containerized cd workflow or what trade offs developers must make when choosing different cd workflows.
with this paper we attempttoaddressthisliteraturegap andprovideinsightsintothe docker enabled cd workflows in the oss community.
developer survey our study starts with a qualitative exploration of developers experiences and expectations using docker containers as part of cd workflows rq1 forwhichweconductedasurvey.ourgoalswere togainunderstandingof howpeopleusecontainerizedcd focusingonwhat motivations barriers andunmetneeds developers face with their docker enabled cd workflows and to generate hypotheses to be tested in a follow up quantitative study.
.
survey methods survey design and participants.
since little is published about containerizedcd wedesignedthesurveybroadly aroundusecases and pain points and ran a pilot to refine the protocol.
questions wereinspiredmainlybyseliteratureontrade offsinci and online discussionsabout cdand dockercontainers.5specifically the survey included multiple choice and open ended questions organized in four parts motivations for cd current cd tools and workflows unmet needs and barriers and pain points.
we piloted the survey before full deployment.
to obtaindeveloper contact information we first mined all projects with dockerimageshostedondockerhub thathadsourcecoderepositories on github.6using the github api we then identified those projects ownersandtheircontacts sampled1 andsentthem email invitations with a link to the online form.
we only surveyed project owners as we felt they would be most familiar with the overall development of the project.
5from the docker forum 6following source repository links on docker store pages and analysis.
within10days wereceived168responses foraresponserateof16.
consistentwithothersoftware engineering online surveys .
respondents indicated that their experienceinosswas8.6yearsonaverage median range1 while their ci cd experience was .
years on average median range .
additionally participants replied to our emailinvitations to show their interest in this research and to provide valuable suggestionsand feedback.
sinceno question wasmandatory the number of responses per question may vary we reportactual numbers below.
for open ended questions we used open coding intwophases.duringafirstround wecarefullyread thecontentofeachanswerandmarkeditskeywordsorstatements.later duringasecondround weiterativelyaggregatedthedescriptionsandsummarizedthecategories.oneauthorwasinvolvedin coding all authors in discussion and refinements.
.
motivations for cd we start by gauging developer s motivationsfor cd in general open ended answers to evaluate how much our population shares cd insights derived in other contexts.
we uncovered a spectrumofmotivationsfor .next wecontextualizetheseuncoveredmotivationcategorieswithpriorwork and illustrate each with representative quotes.
cd helps us deploy automatically instead of it manually.
we expected that automation is a major concern for developers and the survey answers confirmed that.
e.g.
r79remarked becausetheprojectwillbebuiltautomatically noneedfor metobuildtheimageandpushittotheserver .thisisconsistent with neely et al.
who pointed out that it is important to eliminateallmanualstepsfromabuildinordertoextendciwithrelease and deployment automation.
cd gives us smoother and easier deployments.
as per fowler ci was presented as a way to avoid painful integrations.
cd goes one step further to automate a software release as it makes sure the software is production ready which provides developerswitheasierdeployments.e.g.
r71responded continuous integration to accelerate the development and continuous deployment to simplify the passes to production reducing the complexity .
cdallowsuskeepourproductionreliable.
benefield reportedthatthedeploymentinfrastructure coupledwithintensive automated testing and fast rollback mechanisms improves release reliabilityandquality.withcd thedeploymentprocessandscriptsaretestedrepeatedlybeforedeploymenttoproduction whichkeepstheproductionmorereliable.e.g.
r26remarked convenient and more reliable less error prone as a manual deployment .
cd makes releasing faster.
chen reportedthat cd allowsdeliveringnewsoftwarereleasestocustomersmorequickly.
byleveragingassistanceprovidedwithcd projectteamscanrelease once a week on average or more frequently if desired.
some ofourrespondentsconfirmedthis e.g.
r120said ship as early as possible .
cd lets us catch errors earlier to minimize failures.
by interviewing developers hilton et al.
found that the biggest perceived benefit of ci is early bug detection.
so we would expect thatcdalsohelpscatcherrorsearliertopreventthedeployment ofbrokencode.oursurveyresponsesconfirmedthis.e.g.
r51said 297esec fse november lake buena vista fl usa yang zhang bogdan vasilescu huaimin wang and vladimir filkov table developers motivation for cd.
n .
motivation total perc.
helps us deploy automatically instead of it manually .
gives us smoother and easier deployments .
allows us to keep our production reliable .
makes releasing faster .
lets us catch errors earlier to minimize failures .
can enforce a deterministic workflow .
lets us spend less time on maintenance and configuration .
enhances the testing and validity checking .
allows us to share our work and get continuous feedback .
one answer may contain multiple codes percentages need not add up to .
findtheproblemassoonaspossible.avoidbuilding break that other developer won t be affected .
cd can enforce a deterministicworkflow.
schermann et al.
foundthatdeploymentworkflows i.e.
structuringtherelease process into multiple and consecutive phases is widespread.
their study reported that of the survey respondents use the samecdworkflowfordealingwithissuesasforeveryotherchange.
and74 ofrespondentsagreedthattheywouldreleasemorefrequently than they actually do by following a specific workflow.
e.g.
r115said deterministicworkflow and r18 said becauseitcanhighlyimporttherelease phase.
change in one place will take an effort on other systems .
cd lets us spend less time on maintenance and configuration.
developersperceivethatnottreatingconfigurationlike code leads to a significant number of production issues .
developersusedtospend20 oftheirtimesettingupandfixingtheirtest environments.cdcanautomaticallysetuptheenvironments which allows developers to spend their effort and time on more valuableactivities.as r64said to optimize time focusing on developing the actual application .
cdenhancesthetestingandvaliditychecking.
mantyla etal.
analyzedtheeffectsofmovingfromtraditionaltorapid releasesonfirefox ssystemtesting.theirstudyrevealedthatcd allows less time for testing activities but enables fast and thorough investigation of software features.
not surprisingly this was a common theme among our survey respondents.
e.g.
r78noted that helps with testing less hassle .
cdallowsustoshareourworkandgetcontinuousfeedback.kruscheet al.
reported that with cd customers can evaluate the enhancements and provide feedback immediately and in a continuous way which improves communication between the companyanditscustomers.continuousfeedbackletsdevelopers spend time developing the right things rather than correcting mistakesinfunctionality .inoursurvey r167answeredthat it helps me share my work with other contributors easily and r156 pointed out that fast reliable feedback .
developersreport onmaintenanceandconfiguration.theyalsoreportthatcdhelps them guarantee quality consistency reliability and enhances their development process.
.
tools and workflows we asked developers which docker workflows they subscribe to in theircurrentcdworkflow.mostreporteitherthedockerhubauto builds dh .
or the ci based ci .
workflows figure sources dockerfilebuild images with sources run tests on images docker hub ci servers github deploy push images developerscodecd automated pipeline docker hub automated builds auto builds auto test figure overview of docker enabled cd workflows.
machine services docker dependencies override docker info docker build rm false t circleci elasticsearch.
test override docker run d p circleci elasticsearch sleep curl retry retry delay v deployment hub branch master commands docker login e docker email u docker user p docker pass docker push circleci elasticsearch figure an example of docker settings in circleci.
dhworkflow dhw usingautomatedbuilds auto builds dockerhubcanautomaticallybuildimagesfromgithubsource filesandpushthemtothecorrespondingdockerhubrepository.
whensettingupauto builds developerscreatealistofbranches and tags they want to include in the docker images.
when they pushcodetoasourcecodebranchforoneofthoselistedimagetags the push uses a webhook to trigger a new build which produces a docker image.
the built image is then pushed to docker hub.
ci workflow ciw developers automatically build images fromsourcecodeusingdockercommandsinsidetheircibuilds the built image is then pushed to docker hub.
the ci tools themselves mostly integrate dockerservices which in turn allow developers tousedockercommandstobuildanddeployimages.figure 2shows an example of a circle.yml file that specifies the standard elasticsearch docker image and deploys it to docker hub in circleci.
circleci pre installs the docker engine in the linux build images asspecifiedin circle.yml .thendeveloperscanusethe docker build and docker push commands to build and deploy images.
we also asked respondents who use ciw which specific tools they use.
the top most frequently used ci tools are travis ci .
ofrespondents jenkins .
andcircleci .
.7we also found that unexpectedly .
of respondents used two or morecitools simultaneously .thereasonsmentionedweregeneric with the most common being that each ci tool has its respective jobsortargetprojectsthatitisgoodfor.e.g.
r39said youhave to use the part of ci tools that works best for you.
... so it is really aboutwhichcombinationallowsthebestmanagement .futurework should examine the interplay between these seemingly equivalent and competing tools using qualitative methods.
inaddition .
ofrespondentsuseotherworkflows.weasked them what their cd workflow consists of and coded their answers 7in github report the top ci tools are travis ci circleci and jenkins.
298one size does not fit all an empirical study of containerized ... esec fse november lake buena vista fl usa table other workflows.
n .
other workflow total perc.
deploy by using other services or software tools .
use custom scripts .
use both the dh and ci workflows .
automatically test with ci but manually build and deploy .
into groups summarized in table deploybyusingotherservicesorsoftwaretools .forexample r17told us their cd workflow is a redhat open shift service which is running based on kubernetes use custom scripts .
for example r48said their cd workflow comprised shell scripts written by me useboththedhandciworkflows .e.g.
r74answered i have a base image that is auto built from a different repo by dockercloud and the main image which is built by circleci after a green build and pushed to docker hub automatically test with ci but manually build and deploy.
e.g.
r53told us their cd workflow is push changes pull request travisconfirmconfigit sok manualbuildsindockerhub after qa in my current company .
thereislargeuniformityindocker enabledcdworkflows with twoprevalentworkflows dockerhubauto builds pull based and continuous integration push based .
.
unmet needs weaskeddevelopersaboutunmetneedsandpainpointswiththeir current cd workflows open ended valid responses and found that .
of respondents are satisfied with their current workflow.
we coded the remaining answers as listed in table quickerbuilds peedandhigher throughput.
like r4told us in their cd workflow one dockerfile takes more than hours to build and timeouts .
the cd processing speed will affect the software release and developers work efficiency.
as more tests arewrittenandmoreartifactsareadded theimagebuildlatency islikelytoincrease.
.
ofrespondentsexperiencedincreasing processing latency in their cd workflows over time and .
would change their workflow because of the increasing latency.
easier to learn and config.
while docker hub and ci tools offeragreatdealofflexibilityinhowtheycanbeused thisflexibility still requires a large amount of configuration even for a simple workflow.like r109toldus sometimes circleciconfigandsetup ispain.
docssometimesdoesn t help .
also complexconfiguration wouldaffectthedeveloperscollaboration like r130said itmay spent some time to teach your partner use the cd pipeline .
betterbuildtestingsupport.
r27toldus intheircdworkflow build testing is quite a pain.
i had playing docker to build opencv nodejs cairowhichbreakwhilebuildingtheimage.the buildprocesscantakeupto20mins.ifit sbreak ineedtotryother configuration and rebuild again .
as we known ci tools provide goodtestintegration thusthebuildtestingneedstobeenhanced forprojectsthatusedhworkflow.like r62said probablyineeda jenkins or travis container in the chain to produce more code control using some unit testing .
better multi platform build support.
like r19suggested forapplications it smoreimportanttoprovidemulti platformbuild .table developers unmet needs.
n .
needs total perc.
quicker build s peedandhigher throughput .
easier to learn and config .
better build testing support .
better multi platform build support .
more features and tools integrated .
more flexibility and control .
better support for getting info about failures and logs .
better security and access controls .
multi platform build support is to meet the specific needs of different software development.
like r79said docker hub support onlyx86 64platformonly.ihopethatarmsupport likeraspberry pi will be added in the future.
... .
more features and tools integrated.
some respondents would like their ci cd system to integrate with more features and tools.
like r81said docker cache still not supported without big hacks on most ci suites e.g.
travis .
more flexibility and control.
like r147told us at some point we willwanttouseapipelinewithmorecontrolandflexibility .
in some cd workflows there is still lack of flexibility of builds i.e.
the dockerfile optimization.
like r94said its mainly a dockerrelated drawback i would love to be able to build dockerfiles that have multiple images as base blocks e.g.
from java8 redis .
in our workflow we alwaysend up copying dockerfilesfrom other sources and merging them in one.
.
better support for getting info about failures and logs.
when cd fails developers need to identify why their cd failed.
better logging and storing test artifacts would make it easier to examine failures.
but the current cd platforms are still lack of better support.
like r143said dockerhub doesn t give a whole lot ofdetailvs.someothersolutions codeship etc .r60toldustheir need is getting info about failures and debugging of broken build .
better security and access controls.
since cd workflows have access to the entire source code of a project security and accesscontrolsarevitallyimportant.shu etal.
reportedthat morethan80 ofdockerhubimageshaveatleastonehighseverity levelvulnerability.like r111toldus theirpainpointaboutcdis the lack of automatic security upgrades .
developers would like their cd workflows to be both speedy andsimpletosetupandmaintain.thiscancausesometension since adding configurability tends to increase complexity and simplification may reduce flexibility.
based on the previous discussion we expect that unavoidable complexityincreases over timein cdworkflowswould slowdown the developers workflows.
we hypothesize h1.image release frequency tends to decrease over time.
inaddition alackofbettertestinganddebuggingsupportwould cause developers to write more test scripts or add more complexity totheirbuildconfigurations makingtheirimagebuildprocesses burdensome.
so we hypothesize h2.image build latency tends to increase over time.
withmoreexperience of the docker image configurations i.e.
the dockerfile .
after the initialconfiguration developersmayneedfeweradditionalchanges or improvements to their dockerfiles over time.
we hypothesize h3.dockerfile stability tends to increase over time.
299esec fse november lake buena vista fl usa yang zhang bogdan vasilescu huaimin wang and vladimir filkov .
workflow evolution wealsoaskedparticipantsaboutchangestotheircdworkflows overtime openended 71answers .amongtherespondents .
report having changed their cd workflows at least once before with the common reasons barriers given being listed in table .
difficult to setup and maintain.
configuration and maintenance costs cause many developers to change their workflows.for example r119switched their workflow because the old cd pipeline is a little harder to setup.
it was necessary to write severalscripts to get everything working properly.
the new cd pipeline is easier to setup and maintain .
missingfeaturesineed.
like r37described theiroldworkflowwas tooslow andmissingfeatures the poorfeaturesupport made some developers switch to a different workflow.
weak support for automation.
some developers changed theirworkflowbecausetheiroldworkflowhadweaksupportfor automation.like r128toldus theiroldworkflowcontained many manual steps prone to errors while with the new workflow everything goes smoothly .
overlylong buildtimes.
aswefoundearlierwhenasking aboutcdneeds buildspeedaffectsthedevelopers workefficiency.
some developers changed their workflow due to slow image build speed.
for example r159told us in their old cd workflow cache wasdroppedwhenthebuildexecuted andfornogoodreason.soit took too much time to build the image .
morefrictionandfailures.
brittlebuildsmaketheworkflow unreliable which cause some developers to change their workflow.
for example r66said we noticed that the builds are not really reliable since there wasn t any testing.
so we refactored the workflow to travisciwhich isway betterfor testing but hasdisadvantages in speed of pushing and handling images on docker hub.
but with a little bit of scripting the problems went away .
experimenting with new tools.
some developers changed theirworkflowbecausetheywantedtousesomenewtools.like r43answered just tried new stuff .
steep learning curve.
complex processes and unfamiliar configurations make some developers abandon their old workflow.
like r76told theiroldworkflowwas hardtolearn configure or plain inefficient .
developers encountered increased complexity increased latency and decreased reliability in previous cd workflows.
these barriers caused them to switch to new cd workflows.
in a ciw ci tools may provide more effective testing support thaninadhw whichhelpsdevelopersfindmoredefectsbefore deploying.butaciwmayrequiremorecomplexconfigurationand maintenance than a dhw which increases the likelihood of build failures.
we hypothesize h4.ciw tends to have more failed builds than dhw.
moreover becauseciwsrequiremoreconfiguration itmaytake more time to run these operations.
we hypothesize h5.ciw tends to have longer build latency than dhw.
.
specifics of dh and ci workflows weaskedparticipantsformoredetailsontheperceivedadvantages of dhw or ciw giving them a choice of predefined answers plus the option to provide others.
we collected answers table barriers with previous cd workflows.
n .
barriers total perc.
difficult to setup and maintain .
missing features i need .
weak support for automation .
overly long build times .
more friction and failures .
experimenting with new tools .
steep learning curve .
table specific reasons for using a dh or ci workflow.
ndh n ci .
reasons dh workflow ci workflow reduce the time spent on setting up .
.
deploy more frequently .
.
increase confidence in build quality and results .
.
less cd processing latency .
.
allow higher flexibility of builds .
.
create more visibility into team s workflow .
.
convenient custom settings and modifications .
.
for dhw and for ciw.
for the dhw the most important reasongivenwasto reducethetimespentonsettingup .
followedbyto deploymorefrequently .
.respondentsalso gave other reasons e.g.
it s free and ready to work with github projects easy to share with other docker users .
as for ciw the mostimportantreasonwasto increaseconfidenceinbuildqualityandresults .
followedbyto reducethetimespenton setting up .
.
other reasons given were similar to the predefined answer we provided e.g.
automated test and quality control .
overall wefoundthatciwsmayprovidedevelopersmoreintegration tests to help them find errors easier and faster before publishing images to docker hub.
this could make ciws more reliable increasingdeveloperconfidenceinthebuildquality.but the dhw may provide developers with more automation and simpler configuration which allows them to shift the time spent onsetting up to other development activities.
also we found some other differences in developers goals when using the two workflows.morerespondents .
thoughtciwshave convenient custom settings and modifications than respondents using the dhw .
.
and more respondents .
thought ciws createmorevisibilityintotheteam sworkflow thanrespondents using the dhw .
.
the dh and ci workflows may differ in release frequency build outcomes build configuration stability and build latency.
fromtheresponses ciwsmayprovidedevelopershigherconfigurability than the dhw which should result in more efficient cd workflows.
so we hypothesize h6.ciw tends to have higher release frequency than dhw.
similarly thehigh configurability ofaciwmayprovidedevelopersmorepossibilitiestorevisetheirdockerfileconfigurations.
we hypothesize h7.ciw tends to have lower dockerfile stability than dhw.
it is very intuitive for us to expect a significant difference betweenciwanddhw.butwithinciws differentcitoolsshould have similar functions and roles in the cd workflow.
thus we hypothesize h8.within ciws there should not be significant differences between different ci tools.
300one size does not fit all an empirical study of containerized ... esec fse november lake buena vista fl usa large scale quantitative study basedonthefindingsandhypothesesfromourqualitativestudy detailedabove in weconductedaquantitativestudytoexplore differences between the two cd workflows rq2 .
.
methods projects selection.
from the container list in docker store we collected basic information for all containers listed on or before july .
our survey responses show that the two widely used cd workflows are dhw and ciw .
we selected projects that usedonlythosetwoworkflows.forprojectsusingciw welimited our study to two cloud based ci platforms travis ci and circleci since in the docker hub documentation and in our survey we found these to be among the most popular three the third jenkins runs locally and thus has no publicly available data or api.
we callprojects that use the dh workflow dh projects those that use the travisciworkflow travisprojects andthosethatusethecircleci workflow circle projects .weidentifieddhprojectsbychecking for the presence of the string is automated through the docker hub api true means the project has auto builds this yielded dh projects.
for travis and circle projects we identified them by checkingthe docker enabled deployment settings e.g.
docker push and docker build in their .travis.yml o r circle.yml configurationfiles thisyielded282travisprojects and circle projects each of them only used one type of cd workflow in their history.
data collection and filtering.
out datacollection involved mining threetypes of sources docker hub data i.e.
dockerhub builds using the docker hub api github data i.e.
commits andgitlogsofdockerfile usingthegithubapi and cidata i.e.
ci builds using the travis ci and circleci apis.
for ci builds the mainworkdonebythecitoolsisintegrationtesting soweparsed the ci build scripts8to distinguish between deployment builds theaimofthiscibuildistodeployimages andgeneraltestbuilds.
weonlyconsiderdeploymentbuildsinourstudy.then wefiltered outprojectswithlessthan10successfulbuilds asthesemightindicate experiments with the infrastructure rather than more serious cd practice.
after this filtering we obtained our final set of 855projects for the quantitative study of them dh projects circle projects and travis projects.
intotal ourdatasetcontains133 593imagebuilds.amongthem .
are docker hub builds .
are travis ci builds and .
are circleci builds.
table 6presents aggregate descriptive statistics over the projects.
regressionanalysis.
totestourhypotheses webuiltfourmixedeffectslinearregressionmodels packages lme4andlmertest in r with thesame random effect term forthe base image .
the base images specified in the dockerfile defined in the frominstruction can give a first indication of what it is that the projects use docker for .everydockerimagestartsfromabaseimage e.g.
ubuntu baseimage.soweexpectedthatthebaseimagehasanimportant effectontheimagebuildprocess especiallythebuildlatency.we capturedthebaseimageinformationbyextractingitsnamefromthe specification i.e.
atupleoftheform namespace name version .
8check if the script has docker build and docker push commands.table aggregate statistics of the projects.
group statistic mean st. dev.
min median max dh projects total builds .
.
successful builds .
.
errored builds .
.
travis projects total builds .
.
successful builds .
.
errored builds .
.
circle projects total builds .
.
successful builds .
.
errored builds .
.
the random effect allows us to avoid modeling each base image separately which would use up degrees of freedom unnecessarily but still capture base image variability in the response.
all other variables were modeled as fixed effects.
we divide the build data of each project into different stages in day windows.
the following outcomes or dependent variables were observed during those time windows nsuccessbuilds number of successful builds per time window as a proxy for release frequency.
nerrorbuilds number of errored builds per time window as a proxy for build results.
ndockerfilechanges number of dockerfile changes per time window as a proxy for configuration stability of builds.
avgbuildlatency mean latencyof successfulbuildsper timewindow as a proxy for build speed.build latency is the time duration from build start to end in minutes.
ourindependentvariablescomefromtwocovariateareas global or aggregate level and local or time window level totalcommits andtotalbuilds total number of commits and total numberofimagebuildsintheproject shistory asaproxyforproject size activity.
ageatcd project age at the time of adopting cd in days computed since the earliest recorded image build.
workflow differenttypesofcdworkflows wedistinguisheddhworkflow travis ci workflow and circleci workflow.
we used effect coding tosetthecontrastsofthisthree wayfactor i.e.
comparingeach level to the grand mean of all three levels.
timeflag label of the time window in months computed since the earliest image build.
nlinesofdockerfile number of lines of dockerfile per time window.
we removed the blank lines and comments.
nissuesofdockerfile number of quality issues of the dockerfile per time window computed by dockerfile linter .
in our models where necessarywe log transformed dependent variables to stabilize their variance and reduce heteroscedasticity .
we also removed the top of the data for highly skewed variables to control outliers and improve model robustness in line with best practices .
the variance inflation factors which measuremulticollinearityofthesetofpredictorsinourmodels were safe below .
for each model variable we report its coefficients standard error significance level and sum of squares via anova .
because each coefficient in the regression amounts to a hypothesis test we employ multiple hypothesis correction over all coefficient results tocorrectforfalsepositives usingthebenjamini hochberg step down procedure .
we consider the such corrected coefficients noteworthy if they were statistically significant at p .
.
modelfitwasevaluatedusingamarginal r2m andaconditional r2c coefficientofdeterminationforgeneralizedmixed effectsmodels .r2mdescribestheproportionofvarianceexplainedby 301esec fse november lake buena vista fl usa yang zhang bogdan vasilescu huaimin wang and vladimir filkov the fixed effects alone and r2cdescribes the proportion of variance explained by the fixed and random effects together.
.
results difference in release frequency.
first we examined the release frequencyintermsofthenumberofsuccessfulbuildsper30 day time window.
table 7shows the results of the release frequency model model .
the fixed effects part of the model explained r2m .
of the deviance.
a considerable amount of variability is explained by the random effect r2c .
i.e.
base image not explicitly modeled by our fixed effects.
among the fixed effects as expected totalcommits andtotalbuildshavesignificant positiveeffects togetherexplaining64 of the variance.
thus big or active projects may associate with higher release frequency .
we also note that timeflag has a significant negativeeffectonreleasefrequency ofthevarianceexplained .
thisindicatesthatreleasefrequencytendstodecreaseovertime holdingallothervariablesconstant whichofferssupportfor h1.
compared to the overall mean across all workflows the dh workflow has a significant negative effect on release frequency of the variance explained while the travis ci and circleci workflowshavesignificantpositiveeffects.holdingallothervariables constant dhwtendstohavelowerreleasefrequencythanciw.
this is consistent with h6.
thus releasefrequencytendstodecreaseovertime.butdhwtends to have lower release frequency than ciw.
differenceinbuildresults.
next weusedthenumberoferrored buildstocomparetheworkflows.table 8showsthesummaryof thebuildresultsregressionmodel model .thefixed effectspart ofthemodelexplained r2m .21ofthedeviance foratotal r2c .
with the random effect.
amongthemodelresults totalcommits andtotalbuilds have a significant positive effect 9but they explain different proportions of variance vs consistent with more code may bring more errorstothebuild .timeflag hasasignificantnegativeeffect of the variance explained .
thus the number of errored builds tends to become smaller over time .
compared to the overall mean of three workflows thedhworkflowhasasignificantnegativeeffect of thevarianceexplained .whilethetravisciandcircleciworkflowshavesignificantpositiveeffectsontheoutcome.thisindicatesthat compared to dhw ciw is associated with more errors in the builds holding all other variables constant this is consistent withh .
thus ciw tends to have more errored image builds than dhw.
difference in build configuration stability.
we next used the number of dockerfile changes per day time windows to compare the build configuration stability between the workflows thus higher changesindicateslowerstability.table 9showstheconfiguration stability model model summary.
the fixed effects explained r2m .
of the deviance with the random effect the model explained r2c .
of the deviance and this was our poorest fitting model.
9notethatinthismodel positive effectmeansmoreerroredbuildsand negative effect means fewer errored builds.table release frequency model.
the response is log nsuccessbuild .r2m .
r2c .
.
coeffs error sum sq.
intercept .
.
totalcommits .
.
.
ageatcd .
.
.
totalbuilds .
.
.
timeflag .
.
.
nissuesofdockerfile .
.
.72nlinesofdockerfile .
.
.
workflow dh .
.
.
workflow travis ci .
.
workflow circleci .
.
p .
p .
p .
table build results model.
the response is log nerrorbuild .r2m .
r2c .
.
coeffs error sum sq.
intercept .
.
totalcommits .
.
.
ageatcd .
.
.
totalbuilds .
.
.
timeflag .
.
.
nissuesofdockerfile .
.
.74nlinesofdockerfile .
.
.
workflow dh .
.
.
workflow travis ci .
.
workflow circleci .
.
p .
p .
p .
table configuration stability model.
the response is log ndockerfilechanges .r2m .
r2c .
.
coeffs error sum sq.
intercept .
.
totalcommits .
.
.
ageatcd .
.
.
totalbuilds .
.
.01timeflag .
.
.
nissuesofdockerfile .
.
.
nlinesofdockerfile .
.
.
workflow dh .
.
.
workflow travis ci .
.
workflow circleci .
.
p .
p .
p .
timeflag has a significant negative effect accounting for ofthevarianceexplained.holdingallothervariablesconstant it indicates that the build configuration tends to become more stable i.e.
have fewer changes over time this is consistent with h3.
comparedtotheoverallmeanofthreeworkflows thedhworkflow hasasignificantnegativeeffect ofthevarianceexplained but thetravisciworkflowhasnosignificantdifference thecircleci workflowhasasignificantpositiveeffect.thisisevidencethatciw mayhavelowerdockerfilestabilitythandhw holdingallother variables constant.
hence this is consistent with h7.
containerconfigurationstabilitytendstoincreaseovertime.but ciw tends to have lower dockerfile stability than dhw.
difference in build latency.
finally weexaminedbuildlatency.
table10shows the build latency model model result.
the fractionoftotaldevianceexplainedbythefixed effectspartofthemodel isr2m .
.
a considerable amount of variability is explained by therandomeffect r2c .
.thisisconsistentwithourdescription in .
ofthestrongeffectthebaseimagelatencymayhaveonthe total build latency.
302one size does not fit all an empirical study of containerized ... esec fse november lake buena vista fl usa table build latency model the response is log avgbuildlatency .r2m .
r2c .
.
coeffs error sum sq.
intercept .
.
totalcommits .
.
.
ageatcd .
.
.52totalbuilds .
.
.
timeflag .
.
.
nissuesofdockerfile .
.
.
nlinesofdockerfile .
.
.
workflow dh .
.
.
workflow travis ci .
.
workflow circleci .
.
p .
p .
p .
as expected more lines in a dockerfile nlinesofdockerfile are associated with longer build latency of the variance explained .timeflag hasasmall significantpositiveeffect ofthe varianceexplained meaningbuildlatencytendstoincreaseover time holdingothervariablesconstant thisisconsistentwith h2.
compared to the overall mean across all workflows the dh workflow has a strong positive effect of the variance explained andthetravisciandcircleciworkflowshavesignificantnegative effects.thismeansthatdhwtendstohavelongerbuildlatency thanciw holdingallothervariablesconstant whichiscontrary to our expectation.
so h5is rejected.
buildlatencytendstoincreaseslightlyovertime.interestingly dhw tends to have longer build latency than ciw.
differences among ci workflows.
from our models we find thatusageofciwordhwassociatewithsignificantdifferences inoutcomes consistentwithourhypotheses.butwithrespectto erroredbuildsandbuildlatency wealsofinddifferencesbetween the travis ci and circleci workflows.
this indicates that different ci tools may perform the same or similar role but be associated with different effects.
so h8is rejected.
thus dhwandciwaresignificantlydifferent.usingdifferentcitools can also associate with different outcomes.
discussion herewediscussthepracticaldifferencesandthetrade offsbetween the dh workflow dhw and ci workflows ciws followed by the practice implications.
.
practical differences werecapitulatethepracticaldifferencesbetweendhwandciw based on their support for cd automation and docker build environment aswell asdeveloper experience.these recapitulations allowed us to develop a deeper understanding of our survey and quantitative study results.
support forautomated testing.
inciw citoolssetup hooks with github to automatically run tests typically unit and integration atspecifiedtimes.bydefault thesearesetuptorunaftera pullrequestiscreatedorwhencodeispushedtogithub.dhwhas 10some developers have posted about the build latency problem of docker hub autobuilds onthe dockerforum some in our survey are ok with it.
r23said the latency and build times are totally okay due to the fact that it s free.
i would have a different opinion if i paid for the same service though .a complementary automated testing tool for deployment images auto test provided by docker hub.
before using auto test adocker compose.test.yml automated test file must be set up.
this file defines a sutservice that lists the tests to be run and it shouldbelocatedinthesamedirectorythatcontainsthedockerfile.
sincethe docker compose.test.yml isastandardcomposefile developers could also just invoke compose in the ci configuration file to run those tests which implies ciw may be more powerful.
supportfordockeranddockertools.
dhw naturally hasbettersupportfordockeranddockertoolsthanciw sincedocker hub itself is a cloud based service provided by docker.
in addition ci tools differ in the amount of docker support they provide.
docker version support provided in travis ci is more recent and more diverse than that in circleci.
travis ci develop ers can manually upgrade docker to the latest version by updating.travis.yml whereas circleci currently supports only fixed docker versions .
also we found that travis ci has some dockertoolspre installed e.g.
thedockercomposetool .in circleci developers need to install and configure this tool in their container in order to use it .
build environment.
as reported on the docker forum the currentlimitsondockerhubauto buildsare1cpuand2gbram whichinpracticemeanspotentiallatencyproblemsforlargebuilds.
ontheotherhand travisciandcirclecibothprovide2cpusandlargerramlimits 4gband8gb forthebuildenvironment .
we foundlatencyto bean issueindocker hubinour surveyand quantitative study.
developer work experience.
in our survey we found that the average oss work experience of respondents who use dhw is .8years median6 whileforrespondentswhouseciwitis8.
years median .
while ciw users seem to have one additional yearofossexperience thedifferenceisnotstatisticallysignificant wilcoxontest p .
.ontheotherhand theaverageci cdwork experienceofdhwrespondentsis3.6years median3 andofciw respondentsitis4.5years median4 .thestatisticaltestshowsthat this difference is significant wilcoxon test p .
.
so in practice thismaymeanthattheuse implementationofciwassociateswith more developer ci cd experience than dhw.
.
trade offs between cd workflows oursurveyanddata analysisrevealed thatwhenchoosingbetween ciwanddhwonemayhavetotradesomefeaturesforothersand that it is unlikely that one workflow will fit all higher configurability ciw vs. higher simplicity dhw see m7 b1 n2 n6 model and .
.
highly configurable workflow means also one that is harder to use due to its complexity.
on the other hand simplicity means higher build configuration stability but may also mean less control and lower flexibility.
higherperformance ciw vs.diverseneeds dhw seen1 b2 b3 b4 model model and .
.
specific requirements e.g.
differentdockerversions maybringaboutlowerperformance.but higher performance may not meet more diverse needs.
higherreliability ciw vs.lowermaintenance dhw see m3 m5 m8 n3 b5 model and .
.
more testing means higher reliability but also more errored builds i.e.
more maintenance.
303esec fse november lake buena vista fl usa yang zhang bogdan vasilescu huaimin wang and vladimir filkov higher scalability ciw vs. lower experience dhw see n2 n5 b7and .
.higherscalabilitymeansthatmoretoolsor servicescanbeintegratedanddonotstronglylimitthecdprocess e.g.
build speed inaproject even iftheimagegrowsinsizeand complexity.
but ciw may require more experienced developers.
.
implications forresearchers .ourstudiesprovidearichresourceofinitialideas forfurtherstudy.oursurveyshowedthat45.
oftherespondentshavechangedfromonetoanothercdworkflows .
.examining the costs and benefits that arise from switching cd workflows may point to best practices for developers needing to change their solutions.hence ourstudymotivatesfutureworktoexplorethe cd workflow evolution.
wealsofoundthatdevelopershaveachoiceofdifferentcitools .
andthatusingdifferentcitoolsassociateswithdifferentoutcomes .
.
therefore researchers should investigate the barriers and benefits developers face when using particular ci tools.
our quantitative study mostly focused on comparing cd outcomesbetweendhwandciw .howthetwocdworkflows differ in other dimensions should be further empirically evaluated.
e.g.
wehave found inour data onlyanecdotally that sometypes ofprojectsmaygravitatetowardoneortheotheroftheworkflows.
withmuchmoredataandcarefulprojectclassificationalongdifferent dimensions some patterns may become apparent.
our findingsmotivatetheneedforcollectingmoreempiricalevidencesthathelp developers who wish to reduce complexity and improve performance to choose appropriate cd tools and establish cd workflow without arbitrary decisions.
for developers .ourstudyshowsthatdevelopersfacetrade offs when choosing different cd workflows .
.
a direct implication is that developers should not only consider their own experiences and needs but also consider the different cd support in the cd workflows.e.g.
lessexperienceddevelopersmaybenefitmorefrom usingdhwinsteadofciw becausedhwhashighersimplicity and lower maintenance cost.
more experienced developers may insteadbenefitfromciw whichcanbringhigherconfigurability andperformance.hence thereisaneedforalistof bespokecd best practices for developers with different experiences and needs.
ourquantitativestudiesrevealedthatdockerfileconfiguration details e.g.
baseimage haveimportanteffectsonthecdworkflow outcomes .
.
developers should select appropriate base image and instructions.
also developers should simplify their dockerfile content and optimize the image structures i.e.
image layers and instruction orders.
therefore the issue of how to manage and help developers configure the best dockerfile needs to be addressed.
for service providers .
based on the trade offs developers face .
therearetwosuggestionsforserviceproviders oneissimplifyingtheconfigurationcomplexity tolowertheinitiationobstacles for more inexperienced developers.
the other is improving their supportforcdautomation e.g.
integratingmorepowerfuldocker tools and providing more virtual machine environments.
fortoolbuilders .ourrespondentsexpressedtheirneedsforbuild testingandfailurelogging n3andn7 .hence toolbuildersmay look into creating modern tools that enhance build testing and integrate with different workflows.
also developerscould use moresophisticated e.g.
socialcodingintegrated enabled toolsthatmanage and analyze logs of build failures.
threats to validity internal validity.
surveys can be affected by bias and inaccurate responses whichmaybeintentionalorunintentional.toameliorate thisthreat wedesigned anddelivered oursurveyby followingestablishedguidelines .mostofourquestionsareopen ended so that participants can freely fill their own answers and during our manual analysis we carefully removed unrelated answers.
in the quantitative study we controlled for the build complexity withthenumberoflinesinthedockerfile andwesetthebaseimage as a random effect.
but the dockerfile may have many different instructions inside which may cause some bias although in our manualexaminationwedidnotfindevidenceforit.wenotethat ourmodels fittothedataisaround25 ofthedeviance andlower for the build configuration stability model model .
that is not necessarilyaproblemforourpurposesasweareonlyinterestedinthe coefficients effect and not relying on the models to explain the full phenomena which would require many more variables and is beyond the scope of this work.
external validity.
we only considered docker repositories that are on github.
thus our findings cannot be assured to generalize to projects hosted on other services e.g.
bitbucket and gitlab although there is no inherent reason why they would be biased.
moreover weonlyanalyzedopensourcesoftware.cdworkflow and its influence might be different in closed source environments.
finally we conducted our study on the docker enabled cd workflow.wecannotassumethatourfindingsgeneralizetoothercd workflows that are not using docker.
conclusion we conducted the first large scale study of docker enabled cd workflows on docker hub github to shed light on the developers experiencesandexpectationswhenusingcd.ourmixedqualitativeandquantitativeapproachenabledustoteaseoutcategoriesofdevelopers opinionsoncdandthetwoworkflows aswellas test hypotheses arising from them using large data sets.
most ofour survey findings were confirmed in the data but some were not emphasizing the power of mixed methods to produce holistic findings.ourfindingsindicatethatdevelopersfacetrade offswhen choosingbetweendifferentcdworkflowswithrespecttoconfigurability simplicity requirements performance stability developer experience etc.
andwewereabletodistillsomeimplicationsfor different stakeholders.