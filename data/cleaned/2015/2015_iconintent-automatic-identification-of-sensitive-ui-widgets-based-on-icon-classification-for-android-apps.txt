iconintent automatic identification of sensitive ui widgets based on icon classification for android apps xusheng xiao1xiaoyin wang2zhihao cao1hanlin wang1peng gao3 1case western reserve university 2the university of texas at san antonio 3princeton university 1xusheng.xiao case.edu 2xiaoyin.wang utsa.edu 3pgao princeton.edu abstract many mobile applications i.e.
apps include ui widgets to use or collect users sensitive data.
thus to identify suspicious sensitive data usage such as ui permission mismatch it is crucial to understand the intentions of ui widgets .
however many ui widgets leverage icons of specific shapes object icons and icons embedded with text text icons t o express their intentions posing challenges for existing detection techniques that analyze only textual data to identify sensitive ui widgets.
in this work we propose a novel app analysis framework i con intent that synergistically combines program analysis and icon classification to identify sensitive ui widgets in android apps.
i con intent automatically associates ui widgets and icons via static analysis on app s ui layout files and code and then adapts computer vision techniques to classify the associated icons into eight categories of sensitive data.
our evaluations of i con intent on apps from google play show that i con intent can detect sensitive ui widgets in apps achieving a precision of .
.
when combined with supor the state of the art sensitive ui widget identification technique based on text analysis s upor icon intent can detect sensitive ui widgets .
improvement over s upor only and reduces suspicious permissions to be inspected by .
.
improvement over s upor only .
i. i ntroduction mobile apps are playing an increasingly important part in our daily life .
despite the capabilities to meet users needs the increasingly access to users sensitive data such as location and finance information raises privacy concerns.
prior works on smartphone privacy protection focus on analyzing mobile apps code to detect information leaks of the sensitive data managed by the framework apis such as device identifiers e.g.
imei location and contact .
but this line of works are limited because they cannot address sensitive user inputs where apps express their intentions to use or collect users sensitive data .
many apps today include ui widgets such as buttons and text boxes which expect users consensus to use their sensitive data e.g.
pressing a button or users input of sensitive data e.g.
filling financial information in a text box .
it is crucial to understand the intentions of ui widgets by analyzing apps uis for the app stores to inspect suspicious permissions i.e.
ui permission mismatches for lawyers or managers to write more precise privacy policies and for developers to better inform users about sensitive data usages.
for example given an app that a b c figure uis containing icons that indicate the uses of sensitive data in mobile apps requests a permission e.g.
microphone an inspection of the app s uis can determine that the permission is suspicious if this permission cannot be justified by the text and or icons on any ui widget.
recent works have made progress in detecting disclosure of sensitive user inputs by analyzing textual data in the uis.
however ui widgets intentions can also be expressed via images especially icons of specific shapes object icons .
for example the icons in figure indicate that the app will access users contacts figure 1a and gps data figure 1b .
understanding the intentions of icons is a challenging problem.
first there are numerous types of icons in mobile apps.
icons representing the same intention can have different styles and can be shown in different scales and angles.
due to small screens of smartphones icons are often not co located with texts that explain their intents.
as exemplified by figure 1b google map uses the icon shown in red square to center the map to the user s current location without any text around the button.
second some icons are embedded with text referred to as text icons .f o r example the third button from the top shown in figure 1c indicates that the app will access users gps data.
the diversified colors and opacities in fonts and backgrounds e.g.
ghost button make it difficult to directly apply optical character recognition ocr which works best for icons having black texts and white backgrounds.
to address this problem we propose a novel framework icon intent that synergistically combines program analy2572019 ieee acm 41st international conference on software engineering icse .
ieee authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
sis and icon classification to associate icons with ui widgets and classify the intentions of icons both object icons and text icons into eight pre defined sensitive user input categories including camera contacts email location phone photo sms and microphone .
the classified icons can be directly used to detect the mismatch of ui intentions and permissions.
we target android since they are the most popular mobile platform with the most users but the general research is applicable to other mobile platforms such as ios.
our proposed framework is based on three key insights .
first while uis contain unstructured information the association between icons and ui widgets can be inferred from the structured information in ui layout files and app s code.
this inspires us to develop static analysis techniques on ui layout files and app s code to infer such associations.
second mobile apps are expected to have an intuitive ui where most usage scenarios of an app should be evident to average users so icons indicating the same type of sensitive user input should have similar looks .
this inspires us to develop object icon classification techniques to detect similar icons based on the sensitive icons collected from interactive widgets.
third in order for users to easily recognize the objects or text in icons the colors opacity between the foreground and the backgrounds must be contrasted.
this inspires us to develop icon mutation techniques to amplify and normalize this contrast making icons easier to be recognized by the icon classification techniques.
icon intent consists of three modules icon widget association module icon mutation module and icon classification module.
the icon widget association module provides a ui layout analysis technique to identify the associations between icons and ui widgets defined in the ui layout files.
this module further provides a dataflow analysis technique that analyzes the program code to identify such associations.
the icon mutation analysis module extracts icons from an app and produces mutated icons for each of the extracted icon.
the icon classification module adapts sift a state of the art image feature engineering technique with our novel key location increasing and relative one to one matching techniques to enhance its effectiveness in classifying icons.
additionally this module adapts ocr techniques to extract text from the icons and then classifies the icons using the edit distance based similarity between the extracted text and the keywords in each category.
we evaluate the effectiveness of i con intent using a dataset of android apps that collect sensitive data.
we manually labeled icons from the apps as ground truth.
the results show that i con intent detects sensitive ui widgets achieving .
precision from apps indicating that both sensitive icons and sensitive ui widgets are common.
we also evaluate the effectiveness of i con intent in complementing s upor the state of the art sensitive ui widget detection technique based on text analysis.
the results show that s upor icon intent identifies sensi tive ui widgets which achieves .
improvement over sensitive ui widgets identified by s upor .
also we evaluate the effectiveness in reducing the inspection effort of suspicious permissions if an identified intention of a ui widget matches a requested permission then the permission is considered not suspicious.
the results show that supor icon intent reduces suspicious permissions to be inspected by .
compared with .
identified by supor achieving .
improvement.
we further evaluate the effectiveness of icon classification techniques on the icons.
the results show that i con intent effectively identifies object icons with the average f score of .
compared with .
of off the shelf sift.
i con intent identifies text icons with the average f score of .
compared with .
of off the shelf ocr.
this paper makes the following major contributions we are the first to investigate the intents of icons in mobile apps uis and study their uses in ui widgets.
we propose a novel framework i con intent that synergistically combines program analysis and icon classification to associate icons with the corresponding ui widgets and classify the intents of the icons into eight pre defined sensitive categories.
we conduct evaluations on market apps.
the results show that i con intent effectively detects sensitive ui widgets .
in precision and reduces .
of the suspicious permissions detected by s upor .
ii.
b ackground and motiv ating examples a. android ui rendering an android app usually consists of multiple activities where each activity provides the window to draw the ui .
a ui is defined by a layout which consists of ui widgets e.g.
buttons and image views and layout models e.g.
linear layout that describe how to arrange ui widgets.
the ui framework provides a declarative language based on xml for developers to define ui layouts.
example ui with a sensitive icon .
figure shows a simplified ui layout file from animated weather and its rendered ui.
this ui layout file contains three ui widgets an image view widget imageview a text box that accepts user inputs edittext and a button button .
they are aligned horizontally based on the linearlayout at line .
figure shows the code snippet of the corresponding activity for the layout file.
line indicates the activity class searchform uses the layout file identified by the resource id r.layout.search .
line first finds the imageview widget using the api findviewbyid with the resource id r.id.img which refers to the imageview widget with the attribute android id id img .
line then binds the event handler onclick to the click event of the widget via setonclicklistener .
the handler onclick simply calls startasincsearc line which in turn calls manageroflocation.findposition line that retrieves users current location.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
linearlayout android orientation horizontal imageview android id id img android src drawable loc ... edittext android id id txtcity ... button android text string search ... linearlayout a ui layout file search.xml b rendered ui figure simplified layout file for a search ui 1public class searchform extends activity 2public void oncreate bundle savedinstancestate setcontentview r.layout.search bound to layout file search.xml in fig.
imageview findviewbyid r.id.img .
setonclicklistener new onclicklistener public void onclick view v startasincsearch ... bound to onclick handler 7private void startasincsearch ... manageroflocation.findposition use gps data .. .
figure simplified ui handler for animated weather in the rendered ui figure 2b the imageview widget shows the icon loc.png specified by the resource id drawable loc which indicates to use users current locations.
note that the ui does not have descriptive texts to explain the intention of the icon i.e.
retrieving users current location .
such ui design indicates that for widely used icons the ui assumes the users knowledge in the semantics of the icon.
this motivates us to collect a set of commonly used sensitive icons and propose icon classification techniques that detect sensitive icons based on the collected icons.
example ui with a sensitive text icon .
figure 1c shows a ui from favorite.me .
this ui has four buttons that use stylish text icons.
the third icon from the top is embedded with the text view current location indicating the use of a user s gps data.
when a user clicks on the icon the app retrieves users current location.
existing works that analyze texts in the uis face challenges in identifying this sensitive ui widget since no sensitive texts can be extracted from the ui.
this motivates us to adapt ocr techniques to extract texts from text icons and perform text classification to identify sensitive ui widgets.
b. app icon v arieties to make apps ui unique and stylish in the small screen app icons have different combinations of colors and transparencies in texts backgrounds and object shapes.
as such icons in android apps are usually small diversified and partially ortotally transparent .
figure shows seven sensitive icons that pose different challenges for the icon classification technique and the ocr technique the sms icon in figure 4a and location icon in figure 4b are too small the sms icon in figure 4c and the contact icon in figure 4d have low contrast between the colors of the texts objects and the background the email icon infigure 4e shows the text in bright color and the background in dark color while ocr performs better with deep color texts in bright color backgrounds the photo icon in figure 4f is a ghost button which uses transparencies to hide the background color.
the camera icon in figure 4g is an icon with low color contrast and uses transparency and shadow to show contrast.
our preliminary study on text icons extracted from apps in google play shows that directly applying existing ocr techniques can infer semantic information from less than of the studied icons .
this further motivates us to perform image mutations on the icons such as converting the transparency differences to color differences and apply the icon classification technique on the mutated icons.
iii.
a pproach a. overview figure shows the overview of i con intent .icon intent consists of three modules icon widget association icon mutation and icon classification.
i con intent accepts an app apk file as input and outputs the identified sensitive ui widgets with the associated icons where each icon is annotated with the corresponding categories of sensitive data.
the icon widget association module performs static analysis on the ui layout files and the code to identify the associations between ui widgets and the icons.
the icon mutation module extracts the icons from the resources and performs image mutations on the extracted icons to generate a set of mutated icons.
the icon classification module accepts the mutated icons as input and classifies icons into eight categories of sensitive data.
b. icon widget association icon intent performs static analysis on both the ui layout files and the code to identify the associations between icons and ui widgets.
we next formally define android s ui layouts and our static analysis.
ui layouts and ui widgets.
we first formally define ui layouts and their ids.
definition ui layout a ui layout is a tree l w e where each node w wdenotes a ui element and each edge e a b edenotes a parent child relationship from a tob.lis uniquely identified by the layout id l.id .
figure 2a shows a ui layout loaded from search.xml and its layout id can be referenced in the code via r. layout.search .
in this layout there are four ui elements alinearlayout a n imageview a n edittext and a button .
the linearlayout is the parent of the other three ui elements.
based on these definitions we next define ui widgets.
definition ui widget in a ui layout l w e au i widget w wis a type of ui element that can interact with the user e.g.
a button .
wis uniquely identified by a pair angbracketleftl.id w.id angbracketright where w.id represents the element id of w. authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
a b c d e f g figure icon varieties in mobile apps figure overview of i con intent in figure 2a all the ui elements except the linearlayout are ui widgets.
in particular the id of the imageview widget is angbracketleftr.layout.search r.id.img angbracketright.
based on the definitions of ui layouts we next formally define the binding from the ui widgets in the layout to the variables in the code.
variable binding.
the ui layout files are loaded into activities at runtime via the layout loading api calls mainly setcontentview and inflate .
the layout id is used as the parameter to determine which layout file to load into an activity.
we next define the variable layout binding.
definition v ariable layout binding a variable vlis said to be bound to a ui layout l w e represented as vl squigglerightlif a layout binding api is invoked with vlas the receiver object and l.id as the parameter or vlis an alias to another variable v prime lthat is bound to l. once a layout is bound to an activity the ui widgets in the layout can be bound to variables via invoking the widgetbinding apis mainly findviewbyid with the ui widget id.
definition v ariable widget binding given that vl squigglerightl w e a variable vis said to be bound to a ui widget w wif a widget binding api is invoked with las the receiver object vas the return value and w.id as the parameter or vis an alias to another variable v prime that is bound to w. in figure line loads the layout file with the id r .layout.search to the activity.
line binds the imageview widget by invoking the api findviewbyid with r.id.img as the parameter to a temporary variable omitted in figure .
icon association.
following the definitions of ui layouts and widgets we define icons as follows.
definition icon an icon cis a type of resource.
it is uniquely identified by c.id which is the resource id.
icons can be associated with ui widgets via specifications in layout files directly.
in the layout files icons are often referred to using resource names in the android src attributes of ui widgets.
these resource names e.g.
drawable loc in figure 2a may be directly mapped to file names in the resource folder res drawable loc.png .
besides android src icons can be associated using other attributes.
based on our preliminary study on icons used in the top selector item android state checked true android drawable drawable btn radio to on mtrl 015 item android drawable drawable btn radio to on mtrl 000 selector figure example resource xml file for icons 1void oncreate bundle savedinstance 2view g this .findviewbyid r.id.button esc findview 3imageview h imageview g cast to imageview 4h.setimageresource r.drawable.icon2 change icon ... figure example oncreate event handler apps downloaded from google play most of the icons of interest are used in interactive ui widgets with the top frequent widgets being imageview button textview and imagebutton while the icons used in container and layout widgets such as listview and linearlayout are typically for beautifying backgrounds.
in addition icons specified in the attribute android background of ui widgets are mainly used for beautifying backgrounds and not permission related.
thus our work focuses on analyzing the icons specified in theandroid src attributes.
besides resource names for icons the android src attributes can specify drawable objects which are frequently observed in check boxes or radio buttons.
drawable objects manage several different images organizing the images in layers or showing different images based on the state of the ui widgets that use the drawable objects.
figure shows the definition of a drawable object.
this example xml file specifies two icons via the attributes android drawable in the item elements where the first icon will be shown if the ui widget s state is checked and the second icon will be shown otherwise.
based on the android src attribute we define the icon widget association via ui layout files as definition icon widget association ui layout given a layout l w e an icon cis associated with a ui widget w wif c.id is specified in the attribute w.src where w.src represents the android src attribute of w o r a drawable object dis specified in the attribute w.src andc.id dd where ddrepresents the set of resources ids contained in the drawable object d. besides specified using xml ui widgets may use different icons when certain events occur e.g.
switching activities .
based on our preliminary study on average each app uses the image loading api setimageresource .
times1.
we next define the icon widget association via api calls.
1the other image loading apis setimagebitmap andsetimagebitmap are mainly used to load images through network or external storages but not resources included in the app s apk file.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
may alias x y turnstileleftnewwid y x w.id turnstileleftnewwid yi x w .
i d i yi dom turnstileleftx findviewbyid w.id uniontext i i figure transfer functions for findviewbyid definition icon widget association api calls given that vl squigglerightl w e w wandv squigglerightw an icon cis associated to a ui widget wif an image loading api is invoked with vas the receiver object and c.id as the parameter.
as shown in figure lines and associate the imageview widget to variables gand h and line indicates that hwill use the icon identified by r.drawable.icon2 .
static analysis on ui layout files.
we develop a static analysis technique that leverages a xml parser to parse the extracted ui layout files to build the formal ui layouts and inspects all the ui widgets in each layout to identify the associations between the icons and the ui widgets.
figure 2a shows an example ui layout file where the layout model linearlayout is used to place three ui widgets.
the ui widget imageview at line is associated with an icon identified by the resource name drawable loc which refers to the icon loc.png in the res drawable folder.
by traversing the ui tree from the root linearlayout to its child node imageview our analysis can infer the association between the imageview widget with id id img and the icon with the resource name drawable loc .
the analysis technique identifies the resource names of icons and the ui widgets.
these resource names may be directly mapped to file names in the resource folder or xml files that represents drawable objects as shown in figure .
to handle drawable objects our analysis further parses the xml resource files and identifies all the resource names from the attribute android drawable in each xml element.
static analysis on app code.
to compute the iconwidget associations i con intent provides a data flow analysis technique that overapproximates the associations between variables and the widget ids and the associations between variables and the icon ids.
figures and show the transfer functions of findviewbyid and setimageresource in the form of inference rules.
the data flow value for each variable is initialized as and the join operator is defined as set union.
if the variable xmay alias the variable y we simply union the data flow facts from xtoy.
we use the environment to denote data flow facts as a mapping from each variable to widget ids.
given the statement x findviewbyid w.id where xis a variable and w.id is the id of w we may infer the fact that xis bound to the ui widget wwhose widget id is w.id i.e.
x squigglerightwand x x uniontext w.id .
if another variable yis an alias of x then yis associated with the widget id w.id as well i.e.
y y uniontext w.id .
the association between widget ids and variables can also be done via the api setid whichmay alias x y turnstileleftnewrid y x c.id turnstileleftnewrid yi x c.id yi dom turnstileleftx.setimageresource c.id uniontext i figure transfer functions for setimageresource follows the similar rules as findviewbyid s. our analysis also infers the association between image resource ids and variables that represent ui widgets.
this is done via using the similar transfer function as findviewbyid s to analyze the api method setimageresource .
we use the environment to denote data flow facts as a mapping from each variable to its resource ids.
consider the statement x .setimageresource c.id where xis a variable bound to a ui widget w i.e.
x squigglerightw and c.id is the resource id of the icon c. whenever we observe such api in the code we may infer the fact that xis associated with the icon cwhose resource id is c.id i.e.
x x uniontext c.id and wis associated with csince x squigglerightw.
similarly if ymay alias x then yis associated with c i.e.
y y uniontext c.id .
based on the analysis result i con intent can determine which ui widgets are associated with a given icon.
specifically if xt does not contain the ui widgets identified by the widget ids i.e.
xt are considered to be associated with the resource ids xt .
that is we will have the icon widget associations wt mapsto it wt xt it xt .
example analysis .
consider the example shown in figure .
for the ui widget variable g w eh a v e g r. id.button esc .
since gand hare aliases line we have h r.id.button esc .
due to the setimageresource at line we have g r.drawable.icon2 and h r .drawable.icon2 .
thus we have the icon widget association r.id.button esc mapsto r.drawable.icon2 .
c. icon mutation this module extracts icons from the input apk file and performs image mutations to produce a set of mutated icons for each of the extracted icons.
motivated by the app icon variety shown in figure i con intent leverages five commonly used image mutation techniques .
these techniques mutate the colors and transparencies of images in different ways and can be combined together to produce different mutated icons thus producing mutated images for each icon .
we next briefly describe the color model used in digital images and the mutation techniques.
image mutation.
a digital image is represented as a rectangular grid of pixels with fixed rows and columns where a pixel represents a single color dot.
a color in the rgb color model is expressed as an rgb triplet angbracketleftr g b angbracketright where r g and b are the numeric values that describe how much red green and blue are included in the color respectively.
to express the opacity degree of the color the rgba color model angbracketleftr g b a angbracketright is used which provides an extra numeric value a besides the rgb triplet used in the rgb model.
using the rgba color authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table i sensitive user input categories and keywords category keywords camera camera retake contacts contact group email email mail location location locate gps map place address microphone microphone micro karaoke interview voice audio phone phone call photo photo sms sms message model a digital image with m npixels can be represented as a matrix mwith mrows and ncolumns where each cell i.e.
a pixel in the matrix is a rgba tuple.
image mutation techniques apply various transformations to mutate the rgba tuples in mto produce a mutated image.
we next describe the five mutation techniques.
image scaling this technique enlarges or shrinks the image by changing the resolution pixels per inch of image.
a commonly used technique is to resample pixel values using nearby pixels for the scaled image.
grayscale conversion this technique converts an image to another image in which the value of each pixel just represents only the amount of light .
color inversion this technique inverts the colors of each pixel in the image.
contrast adjustment this technique adjusts the contrast of colors in the image.
opacity conversion this technique converts the transparency differences between the objects texts and the background to the color differences.
d. icon classification the icon classification module classifies two types of icons i.e.
object icons and text icons into one of the eight sensitive user input category.
we next describe the sensitive user input categories and the two techniques in detail.
sensitive user input categories table i shows eight sensitive user input categories and their keywords.
the keywords are used to search for training icons and identify text icons.
we choose these eight sensitive user input categories because the app functionality related to these categories are popular represent tangible sensitive resources that users can understand and have significant security and privacy implications .
furthermore developers often use these icons in the ui widgets that accept the user inputs.
object icon classification icon intent leverages object recognition to classify object icons based on a training icon set labeled with sensitive user input categories.
given an icon as input the technique recognizes whether the training icon deemed as the reference object appears in the input icon deemed as the scene picture and labels the input icon using the sensitive user input category that has most recognized icons or labels it as not sensitive if none are recognized.
algorithm shows this general process.algorithm object icon classification input ias the input object icon category as the set of sensitive user input categories mas the hashmap that stores the mapping from the training icons to their corresponding categories output cout as the predicted category for i 1cout null catcount map.empty catcount records how may icons are recognized in ifor each category 2foreach c category do catcount 4end 5foreach k m.keys do ifrecog k i then catcount catcount end 9end 10foreach c category do ifcout null orcatcount c a t c o u n t then cout c end 14end 15return cout the category with most recognized icons classifying icons based on objects inside it brings new challenges to object recognition techniques such as scaleinvariant feature transform sift in computer vision.
sift is a state of the art technique for object recognition from pictures.
it extracts key locations figure rotationthat are invariant with respect to image translation scaling and rotation.
they are often image snippets with enough details such as tree textures and fur patterns.
when the matching the key locations are used as input to a nearest neighbor indexing method that identifies candidate object matches.
specifically we already use image mutation to resolve icon format and quality issues such as transparent background and low contrast.
however such adaptation is not sufficient and we found that direct adoption of sift is not be effective for the following two reasons.
too few key locations.
compared with common objects such as animals and human faces in object recognition software icons typically consist of basic shapes with smooth edges such as lines ovals and circles.
thus sift cannot extract sufficient key locations from the icons and too few key locations will lead to inaccuracy in object recognition.
lower tolerance for changes.
app icons have lower tolerance of changes such as rotation and distortion.
for example a cat is still a cat no matter how the image is rotated.
however the icon in the left sub figure of figure no longer corresponds to location if it is rotated upside down which becomes a liquid drop icon the right sub figure that is often used in weather apps.
on the other hand certain extent of change tolerance authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
is still helpful.
the left sub figure of figure still represents location if rotated slightly anticlockwise.
to address these two challenges we propose corresponding techniques as follows.
increasing key locations .
to increase the number of key locations we first enlarge the icon images.
if an image for matching is smaller than we automatically enlarge it to .
second we switch to fast algorithm figure sift vs. fastan alternative technique extracting many low quality key locations instead of a few high quality key locations as in sift .
figure presents the comparison of key locations as blue circles extracted by sift as shown in column a and fast algorithms as shown in column b .
the low quality of key locations will be addressed together with low change tolerance in our relative one to one matching technique described as follows.
relative one to one matching .
standard object recognition allows multiple key locations in the sample image to be matched to one key location in the scene image which helps find smaller and blurred instances of the objects in the scene image e.g.
a cat hiding in the grass .
but this is not suitable for icon classification where change tolerance is much lower.
furthermore the usage of low quality key locations extracted by fast algorithm further increases noise in key locations.
thus we propose a novel matching technique that allows mapping a key location in the object image to only one key location in the same area in the scene image e.g.
a key location at the left top corner of object image can only be matched to one key location in the left top area of the scene image .
we use a relative distance threshold percentage of image weights and heights to determine the size of the area.
to achieve one to one mapping we use a greedy algorithm to match the key location pairs with the highest similarity until no key locations left.
text icon classification icon intent analyzes the embedded texts of the icons to determine whether the texts are similar to keywords in the sensitive user input categories table i .
based on our preliminary studies on about text icons collected from top google play apps more than of the text icons contain to words .
this indicates that most of the text icons contain only short phrases or words.
therefore keyword matching can be adapted to effectively classify the text icons.
however the extracted texts from the icons are often not accurate which may include wrong characters e.g.
lcafiion extra characters e.g.
llocation or miss some characters e.g.
emai .
thus it is unlikely for the words in the extracted texts to exactly match a sensitive keyword.to address these issues we develop an edit distance based algorithm to compute similarities between words in the extracted texts and the keywords and identify the most similar keyword based on the computed similarities if the similarity is over a pre defined threshold then we classify the icon to the corresponding sensitive user input category.
our algorithm adapts edit distance with n gram substring generation and relative length computation to compute the similarity between the extracted text from a text icon and the keywords in the sensitive user input categories.
edit distance is a widely used approach to quantify how dissimilar two strings are by computing the minimum cost of operations required to transform one string to another.
however edit distances faces two problems redundant word and multi keyword matching during the classification.
redundant word .
the extracted text usually contains redundant words that do not express intentions in using sensitive data.
for example for a text icon that contains the text enablegps extracted without spaces based on ocr the word gps indicates the intention to use users gps data which is sensitive while the word enable is redundant.
redundant words may also come from the inaccurate character recognition of ocr.
to address this problem we introduce n gram substring generation .
given a keyword k we generate a sequence of substrings from a word wwhere the length of each substring is within .
we then compare each ngram with the keyword gps and find an exact match.
keyword similarity .
since keywords have different lengths in many cases the levenshtein distance does not reflect the similarity as expected.
for example given a word locatl we compare it with two keywords locate and call .
the edit distance between locatl and locate is .
for the keyword call we generate a n gram list which is loca ocat catl and the edit distance between catl and call is also .
while they both have the same distance we know locatl is more similar to locate rather than call .
to address this issue we propose to measure the similarity by considering the keyword length k sim w k ed length k where ed is the original edit distance and length k is the length of the keyword k. iv .
e v aluation we implemented i con intent upon gator for static analysis and upon opencv and asprise ocr for icon classification.
we evaluate i con intent on android apps and manually labeled icons from the apps.
we seek to answer the following research questions rq1 is i con intent effective on identifying sensitive ui widgets?
rq2 how effective is our technique on detecting suspicious permissions without gui indication?
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
camera contacts email location microphone phone photo sms figure icons over sensitive categories rq3 how effective are our techniques on associating icons with ui widgets?
rq4 how effective is our technique on identifying sensitive object icons?
rq5 how effective is our technique on identifying sensitive text icons?
a. dataset construction training dataset our classification technique of object icons requires a training dataset with positive examples in each sensitive user input category.
we do not need negative examples in our training set since our algorithm determines an icon as sensitive if it is similar enough to any positive examples in a sensitive category.
to make icon intent more extensible our training set must be constructed within reasonable effort.
we collect positive examples from two sources.
first we use the name of each sensitive category e.g.
camera with the keyword icon to search for representative icons from google image search and downloaded the first retrieved icons for each category.
second we used the keywords from each category to search for icons in other apps top apps excluding the apps in our test dataset and fetched the first icons for each category.
then we manually labeled these icons to identify unique sensitive icons used in the apps.
combined with the icons from google image search our training dataset has icons as positive examples.
test dataset we build our test dataset from the top apps in the google play market.
since apps that have ui widgets to collect sensitive user inputs are not distributed evenly across app categories and we have to manually label all the apps in our test dataset to obtain the ground truth we choose as our test set the top apps with appearances of sensitive keywords as mentioned in section iii d1 in their ui layout files.
from the apps we manually labeled icons in which we identified sensitive object icons and sensitive text icons.
note that during labeling we checked the context information of icons to confirm whether they are related to a sensitive category.
the distribution of sensitive icons in our test dataset on different sensitive user input categories are presented in figure .
from the chart we can see that among sensitive icons identified from our test dataset icons fromtable ii detected sensitive icons si and sensitive ui widgets sw category detected sis apps detected apps object text all with sis sws with sws camera contacts email location microphone phone photo sms all all sensitive user input categories exist.
specifically camera sms and microphone are the top three categories on the number of icons being used.
the reason is that icons in these categories are popular consistent and easy to understand so they can be easily recognized by end users.
b. evaluation results identifying sensitive ui widgets rq1 to answer rq1 we consider two application scenarios in detecting sensitive ui widgets using i con intent alone and using i con intent to complement s upor .
rq .
using i con intent alone.
in table ii we present the results of i con intent on identifying sensitive ui widgets from our test dataset.
columns presents the number of detected sensitive object icons sensitive text icons all sensitive icons and the number of apps containing detected sensitive icons.
columns presents the number of associated sensitive ui widgets and the number of apps containing detected sensitive ui widgets.
the last row of the table shows the data combining all categories.
note that since one app may have icons ui widgets from different categories sum of the numbers in rows of column and is not equal to the number in row .
from the table we have the following observations.
first i con intent effectively detects most sensitive icons out of from most apps out of apps that contains sensitive icons in our test dataset.
second icon intent effectively associates the detected icons with ui widgets from apps.
such results indicate that not only sensitive icons are common but sensitive ui widgets are also common and i con intent detects many sensitive ui widgets from most apps in our test dataset.
third icons from different categories have different characteristics on the association with ui widgets.
for example while sms icons are detected only ui widgets from apps are associated with some icons.
this shows that sms icons are often not directly associated with ui widgets.
one possible reason is that sms icons such as text bubbles are often used as static labels in chatting apps.
by contrast phone icons are associated with ui widgets which shows that phone icons are generally associated to ui widgets e.g.
buttons .
rq .
combining with s upor .s upor is designed to detect only sensitive input fields that accept textual user inputs.
thus to fairly evaluate effectiveness of our authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
associated ui widgetssupor supor iconsemantics figure effectiveness of our technique on identification of sensitive ui widget when combined with s upor technique we make two improvements to make s upor applicable to other ui widgets we expand the ui widgets types to include buttons radio buttons check boxes and other commonly used ui widgets that accept user inputs we leverage dex2jar to convert dex bytecode in apk files to java bytecode so that s upor can support custom widgets.
we will use s upor to refer to this improved version of s upor in the rest of the section.
we applied s upor to the apps in our test dataset to associate text labels with ui widgets.
for each category we compare the ui widgets associated by s upor and by s upor icon intent .
to enable fair comparison we fed into supor the keywords defined in section iii d1 and collected all the ui widgets associated with sensitive keywords in sensitive text labels.
the results are presented in figure .
we can see that i con intent can effectively complement supor .supor identified sensitive ui widgets while combining s upor and i con intent can identify sensitive ui widgets achieving .
improvement.
involving icon intent can help s upor to identify .
location to microphone more sensitive ui widgets.
specifically i con intent results in the most improvement in the categories of camera and microphone where icons instead of texts are used more often among apps.
we also found that ui widgets found by s upor are almost disjoint with the ui widgets found by i con intent as only ui widgets are identified by both s upor and i con intent .
it indicates that developers rarely add textual descriptions to icons for ui widgets saving space on mobile screens.
detecting suspicious permissions rq2 to answer rq2 we studied the permissions requested by the subject apps and compared them with identified sensitive icons to detect the suspicious requested permissions that are not indicated in the user interface.
previous approaches such as supor can achieve the same goal but consider only textual labels on the app s gui.
thus we can check how many more icon permission matches i con intent finds which reduces the suspicious permissions that require further inspection.
the results are shown in table iii.
we consider the six permissions that can be directly mapped to our sensitive categories.
note that email and photo are not listed as they cannot be easily mapped to permissions.table iii suspicious permissions detected with s upor and i con intent permission all supor supor i con intent camera .
.
contacts .
.
audio .
.
location .
.
phonecall .
.
sms .
.
total .
.
also audio permission is related to microphone icons and phonecall permission is related to phone icons.
columns show all sensitive permissions requested the suspicious permissions identified by s upor and identified by s upor icon intent respectively.
from the table we have two observations.
first i con intent effectively reduces suspicious permission requests from to so much fewer suspicious permission requests need to be inspected.
second i con intent achieves different effectiveness on different categories.
in particular i con intent is most effective in camera reducing of and audio reducing of indicating that icons are dominantly used in these categories.
note that this is not a fair comparison between s upor and i con intent as we consider only the categories where icons are commonly used.
however the result does show that in these popular categories considering only text is far from sufficient and applying i con intent can significantly reduce the suspicious permissions to be inspected.
associating icons with ui widgets rq3 to answer rq3 we studied the number of ui widgets and their icons associated by i con intent .
from the icons in the test dataset i con intent associated them with ui widgets.
specifically ui analysis helped to associate ui widgets and icon association analysis helped to associate additional ui widgets.
among the associated ui widgets are associated with sensitive icons and are thus sensitive ui widgets while are associated with mistakenly classified icons so they are false positives.
note that we will evaluate our icon classification techniques in sections iv b4 and iv b5 and we only include true positives in figure .
among these ui widgets can be detected with ui analysis and icon association analysis can help to identify additional sensitive ui widgets.
object icon classification rq4 the results of object icon classification on the test dataset are presented in table iv.
columns show the precision recall and f score of our technique for each icon category.
we can observe that icon intent can achieve an average f score of .
with distance threshold as .
.
furthermore we compare the effectiveness f score of our techniques described in section iii d2 with that of default sift technique and turning off each of our techniques without increasing key locations and without change aware matching.
from the figure we can see that i con intent s f score .
outperforms those of sift .
without mutation .
without authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
table iv results for object icon classification setting p r f sift .
.
.
without mutation .
.
.
without increkey .
.
.
without rom .
.
.
icon intent .
.
.
table v results for text icon identification setting p r f without mutation .
.
.
icon intent .
.
.
key location increase without increkey .
and without relative one to one mapping without rom .
.
text icon classification rq5 the results of text icon classification are presented in table v which is of the same format as table iv.
we can see that our text icon classification results have few false positives and false negatives and the image mutation techniques can improve the recall significantly.
we set the threshold for text similarity as .
since it achieves the best results in terms of precision recall and f score.
for false positives there are two types of misclassification.
first the ocr recognized texts from some icons which do not contain any text and the extracted texts matched some sensitive keywords.
second there is one application breaking apart company english logos which confused our keyword matching algorithm.
for false negatives there are three types of misclassification.
first we missed some keywords.
if we add particular keywords it will be solved.
second when i con intent performed image mutations i con intent did not consider the rotated images.
we can implement a new image mutation to get a better result.
third ocr cannot recognize the correct text from some blurred images.
c. threats to v alidity the main internal threat comes from the mistakes we may make during icon labeling.
to reduce the threat we check the context of the icons when we cannot tell whether an icon is related to a sensitive category.
there are two main external threats to validity.
first our experiment evaluates only the apps with many sensitive ui widgets but this is reasonable because these apps are also the ones i con intent will be mainly applied to.
second since the keywords we used as queries are from eight sensitive categories our evaluation may be limited to apps collecting data in these categories.
this threat is unavoidable because the difference between sensitive data and insensitive data must be defined in some way.
i con intent can be easily extended to support other categories of sensitive data but more evaluations will be required for those categories.
v. r elated work computer vision techniques for software engineering tasks.
remaui applies computer vision techniques for reverse engineering uis of mobile apps.
sikuli uses image recognition to identify and control uicomponents for automating ui testing.
webdiff and xpert leverage computer vision techniques to detect visual differences assisting the task of detecting cross browser rendering issues.
instead of detecting standard ui elements and comparing visual appearances our approach uses computer vision techniques to find icons similar to our collected icons and extract texts from icons which are combined with program analysis techniques to understand association between icons and ui widgets.
ui analysis of mobile apps.
supor uipicker and uiref are among the first works to analyze the descriptive texts in apps ui for determining whether the corresponding user inputs contain sensitive data.
asdroid checks the compatibility of the descriptive texts and the intentions represented by the sensitive apis.
peruim extracts the permission ui mapping from an app based on both dynamic and static analysis helping users understand the requested permissions.
liu et al.
propose an automatic approach for annotating mobile ui elements with both structural semantics such as buttons or toolbars and functional semantics such as add or search.
in these works the security and privacy implications of icons remained unexplored and our approach opens up a new direction in analyzing sensitive icons in uis.
furthermore our static analysis associates ui widgets with variables in the code which cannot be inferred by just analyzing the ui.
textual analysis of mobile apps.
whyper and autocog adapt natural language processing techniques for analyzing apps descriptions and infer the mapping between sentences in app descriptions and permissions.
chabada clusters app descriptions topics and identifies outliers in each cluster with respect to their api usage.
bidtext detects sensitive data disclosures by performing bi directional data flow analysis to detect variables that are at the sink points and are correlated with sensitive text labels.
i con intent complements these techniques to better understand apps intentions.
vi.
c onclusion and future work in this work2 we present a novel framework i con intent that performs program analysis techniques to associate icons and ui widgets and adapts computer vision techniques to classify the associated icons into eight sensitive categories for android apps.
we have conducted evaluations on market apps.
the results show that i con intent effectively identifies sensitive ui widgets ui widgets in apps and reduces suspicious permissions to inspect.
i con intent can be integrated with various privacy analysis tools such as guileak to help developers trace information types mentioned in privacy policies to icons.
in future work we plan to adopt deep learning techniques to further improve the accuracy in icon recognition.
2the work is supported in part by nsf grants cns and cns1748109.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.