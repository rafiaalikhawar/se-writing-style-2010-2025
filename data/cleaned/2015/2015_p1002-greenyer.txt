evaluating a formal scenario based method for the requirements analysis in automotive software engineering joel greenyer and maximilian haase software engineering group leibniz universit t hannover welfengarten hannover germany greenyer inf.uni hannover.de maximilian.haase stud.unihannover.dej rg marhenke and rene bellmer iav gmbh gifhorn rockwellstra e gifhorn germany dr.joerg.marhenke iav.de rene.bellmer iav.de abstract automotive software systems often consist of multiple reactive components that must satisfy complex and safetycritical requirements.
in automotive projects the requirements are usually documented informally and are reviewed manually this regularly causes inconsistencies to remain hidden until the integration phase where their repair requires costly iterations.
we therefore seek methods for the early automated requirement analysis and evaluated the scenario based speci cation approach based on lscs msds it promises to support an incremental and precise speci cation of requirements and o ers automated analysis through scenario execution and formal realizability checking.
in a case study we used scenariotools to model and analyze the requirements of a software to control a high voltage coupling for electric vehicles.
our example contained requirements and assumptions that we could successfully formalize and we could successfully nd speci cation defects by automated realizability checking.
in this paper we report on lessons learned tool and method extensions we have introduced and open challenges.
categories and subject descriptors d. .
requirements speci cations d. .
software program veri cation general terms design languages veri cation keywords automotive software reactive systems requirements analysis modal sequence diagrams realizability1.
introduction the increasingly advanced functions in today s cars are mainly realized by software.
automotive software systems are complex embedded reactive systems with multiple software components sometimes distributed over several hardware nodes that must often handle concurrent sensor inputs and user requests.
often the software functions are safetycritical and moreover the software usually controls electromechanical components which requires interdisciplinary expertise during its development.
the software development in the automotive industry follows the automotive spice reference process model an automotive variant of the iso iec .
it prescribes a software requirements analysis where software requirements are analyzed for technical feasibility and testability before implementation.
in automotive projects the software requirements are typically documented informally or semiformally for example by state diagrams .
the requirements are then analyzed by manual reviews.
in this process however requirement speci cation inconsistencies regularly remain hidden and are then only discovered in later development phases where their repair requires costly iterations.
at iav we therefore seek automated techniques that support us in the requirements analysis.
in a case study in collaboration with the software engineering group in hanover we tested and evaluated the scenario based speci cation approach based on live sequence charts lscs resp.
modal sequence diagrams msds a recent variant of lscs.
lscs msds allow us to model formally how a system may must or must not react to external events.
within the eclipse based scenariotools tool suite msds can be modeled as lightweight extension of uml using the papyrus uml editor.
scenariotools supports the modeling of software requirements as well as the modeling of environment assumptions .
for analysis scenariotools implements the play out algorithm for executing the scenarios and it can perform a thorough realizability checking of the msd speci cation .
realizability checking intuitively analyzes whether there exists a software controller that can react to all possible sequences of external events in a way that the speci cation is satis ed.
it does so by viewing the interaction of the software and its environment as a two player game where the software tries to satisfy the speci cation while the environpermission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
copyright is held by the owner author s .
publication rights licensed to acm.
esec fse august september bergamo italy acm.
... .
1002flexible power interface flexpi hv batteryhv device e.g.
cooling unit figure expiconnects a cooling trailer to a hybrid truck ment tries everything to violate it.
if there exists a strategy for the system to win the game this strategy can serve as an implementation of the speci cation which is thereby proven realizable.
if the software cannot keep the environment from winning the game the speci cation is unrealizable it means that the software can be forced into a state where it will consequently violate contradicting requirements.
our case study was the software for controlling a highvoltage power interface for electric or hybrid vehicles.
electri ed vehicles are equipped with a high voltage system volts that could serve as an energy supply for high power devices.
for example as shown in fig.
customers would like to plug the cooling unit of a cooling trailer to the high voltage system of a hybrid truck.
therefore iav s high voltage components department invented the expi exible power interface .
connecting and disconnecting high voltage devices is not as harmless as it is with 24v devices disconnecting the plug under load causes an electric arc that can cause deadly injuries.
therefore a software system is required for ensuring a safe operation of the interface.
the software must for example lock the plug in its socket before the relays are closed.
the expisystem is an iav internal prototype project.
a speci cation of that project consisted of requirements.
a student involved in this project who had extensive knowledge of the electromechanical and software parts was then asked to model requirements1that made up the core functionality of the system as msds with scenariotools .
this study showed a high practical potential of the lsc msd based speci cation approach.
especially using the realizability checking feature we could successfully uncover speci cation defects.
in this paper we show a brief example and re ect on the lessons learned.
speci cally we will summarize where we see the main bene ts of the approach how automated analysis techniques helped and what obstacles we think keep this approach from being applied in practice.
structure we rst report on related work in sect.
.
we then show by a small example how requirements from the expiproject were formalized using msds in sect.
.
in sect.
we show two of the speci cation defects found.
last we re ect on the lessons learned in sect.
.
1the remaining requirements were related to dealing with faults of relays the interlock system or overheating.
we did not cover those in the limited time of the study which was conducted as part of the bachelor thesis project of the second author .
we are unfortunately not allowed to disclose all the requirements a subset of requirements can be found in the thesis document in german .
.
related work the application of formal methods in automotive software engineering has been studied previously for example mostly focusing on formal veri cation of designs against speci cations.
these modeling and veri cation techniques can also uncover speci cation defects if veri cation fails but the design looks good the aw may after all be in the speci cation.
in this paper however we instead focus on analyzing speci cations for inconsistencies before attempting to conceive a design.
we can therefore detect problems earlier in the development process.
post et al.
report a study at bosch on formalizing requirements in the automotive domain using natural language patterns that can be mapped to temporal logics.
they also propose a tool for nding unsatis able time constraints .
they however do not check the speci cation realizability in an open system setting as in our case.
l o er et al.
evaluate formal scenario based requirements speci cation in healthcare applications.
in this work however a variant of sequence diagrams is used where explicit controlow constructs determine the ow of events through the scenarios.
msds by contrast are activated progress and synchronize through common events which allows for a more exible modeling of concurrent tasks.
.
requirements formalization in the following we describe a set of requirements from the expiproject and their formalization using msds.
unplugging the expiunder load can cause fatal injuries.
the connection can be under load only if the relays are closed.
so the interface must prevent the plug from being pulled out of the socket if the relays are closed.
this is formulated by the requirement unplug forbidden shown in table .
the socket is equipped with a locking mechanism that can prevent the plug from being unplugged.
this plug locks automatically when the plug is plugged in lock plug .
if the plug is not locked the relays must not make contact make contact forbidden this is to prevent a current from owing if a user inserts a screwdriver for example.
the last requirement start button pressed says that if the start button is pressed the relays must close the contact.
table example requirements of the case study name requirement .
unplug forbidden if a relay is closed the plug must not be unplugged.
lock plug if the plug is plugged into the socket then the socket must lock the plug.
make contact forbiddenif the plug is not plugged or not locked then the relays must not make contact.
start button pressedif the start button is pressed then the relays have to make contact.
underlying the requirements is a description of the system component architecture naming the software components of the system their state variables and events they can exchange with the environment.
this is also the starting point for the formalization that is explained in the following.
we model the system structure using a composite structure diagram top right of fig.
.
the controller socket and relay are software objects the two latter being software representatives of the physical socket and relay.
the start button and environment are environment objects.
1003first we model the requirement lock plug by the msds plugin and ifpluggedthenlock see fig.
.
the msd pluginsays that if an external plugin event is detected by the socket then the controller must be informed.
messages in msds have di erent modalities.
the message setplugged true for example is hotand executed which means that the message must be sent.
for details on the msd semantics see .
messages of the form sethattribute name imessages also change the corresponding attributes of the receiving objects setplugged true therefore sets the attribute c.plugged to true.
upon plugging in the socket must be locked.
this is modeled by the msd ifpluggedthenlock .
upon a successful locking of the socket the attribute s.locked will be set to true we omit the corresponding part of the speci cation for brevity.
following a similar pattern the requirement start button pressed is modeled by the msd ifstartpressedthenclosecontact .
again we omit the part of the speci cation that sets the attribute r.contactclosed to true if the relay s contact was successfully closed.
the requirement unplug forbidden is modeled by an antiscenario ifrelayclosedunplugforbbidden says that if unplug occurs and the relay s contact is closed then this will be a forbidden violation of the speci cation.
similarly we model the requirement make contact forbidden by the msd ifnotpluggedandlockedthencloserelayforbidden if closecontact occurs but the plug is not plugged in or the socket is not locked this is a violation.
c controller r relay closecontact h eifstartpressedthenclosecontact start startbutton startpressed c ms socket c controller r relay closecontact c m not c.plugged and s.locked violationifnotpluggedandlockedthencloserelayforbiddens socket r relay unplug c m r.contactclosed violationifrelayclosedunplugforbbidden env environment ifpluggedthenlock s socket c controller setplugged true c m lock h eplugin s socket c controller plugin c m setplugged true h eenv environment cold can be violated hot must not be violated monitored may happen executed must happen c m c eh m h emessage semantics flexpi csd env environment s socket r relay c controller start startbutton figure some msds from the speci cation of the high voltage coupling system .
analyzing the specification based on a speci cation as shown above we can use the scenariotools realizability checking feature to check whether a software implementation exists that can react to all environment events in a way that the speci cation is satised i.e.
that no violations ever occur and all events required to occur do in fact eventually occur.we could automatically detect two defects present in the above speci cation defect the msd ifstartpressedthenclosecontact species that if the user presses the start button the relay should close the contact.
this is true also if the plug is not inserted or the socket is not locked.
this again leads to a violation of the msd ifnotpluggedandlockedthencloserelayforbidden .
raising this issue to the author of the requirements speci cation revealed that implicitly the requirement start button pressed was meant to have a lower priority and should only hold when none of the safety related requirements demand otherwise.
to correct the defect in the msd speci cation we added the condition c.plugged and s.locked between the two messages in the msd ifstartpressedthenclosecontact .
defect in our example the plug can be inserted into the socket and then the socket will be locked as well.
then upon pressing the start button the relays can be closed safely.
now however the speci cation allows the external event unplug to occur leading to a violation of the msd ifrelayclosedunplugforbbidden .
here we have a case of an implicit assumption made by the requirements engineer namely that the plug cannot be unplugged as long as the lock is engaged.
to capture this assumption we added an assumption msd modeled as an anti scenario that unplug while the socket is closed will lead to the violation of the assumptions e ectively meaning that such a behavior will not occur.
.
lessons learned what were the main bene ts of the scenario based speci cation and analysis approach?
we could successfully model the core requirements of the expisystem using msds.
where the requirements were speci ed atomically and following the if hprecondition ithen not hpostcondition i pattern usually a one to one mapping of the informal requirements to msds was possible.
the msd speci cation contains more detail extra msds with set messages where the informal requirements made implicit use of state variables such as remembering that the socket is locked.
some requirements that we encountered were not atomic and ambiguous.
here the student with his knowledge of the system could successfully re ne the speci cation and add the necessary precision.
this is where we see one of the main bene ts of a formal approach it forces requirements engineers to specify precisely.
the other main bene t of the approach we see in the possibility of automatic realizability checking.
it successfully supported us in detecting speci cation defects as we introduced them.
as discussed in sect.
we could successfully detect inconsistencies implicit priorities in the speci cation.
the realizability checking procedure pessimistically analyzes every possible sequence of environment events which is impossible in a manual review even of small speci cations.
furthermore we could successfully detect implicit assumptions in the speci cation as discussed in sect.
.
often there is not su cient knowledge and communication about such hidden assumptions between experts from di erent disciplines.
especially dangerous is over optimistically disregarding a possible environment behavior that can lead to a safety critical violation.
we also see the potential for using the formal speci cation for example for automatically generating tests from the speci cation but we didn t elaborate this direction yet.
1004how did automated analysis techniques help?
during speci cation we applied the realizability checking function of scenariotools after every speci cation increment.
if the speci cation is unrealizable the tool generates a labeled transition system that contains the information on how a particular sequence of environment events inevitably leads to a violation of the speci cation.
this information was very helpful for understanding and resolving the speci cation defects that we had introduced.
however the transition system can become very large in our case it contained over states.
scenariotools can generate a visual output but it becomes hard to read already when it contains states or more.
we therefore introduced an extension to scenariotools .
first we reduced the complexity of the graph by only showing the environment events.
this way the engineer can see which sequence of environment events leads to a violation but does not see the system steps.
the system steps between environment events are then extracted to further separate diagrams that the engineer can open on demand to understand the behavior including the system steps in more detail.
we also made use of the play out algorithm to execute the scenarios in a step by step fashion.
this helped especially in understanding speci cation defects and demonstrate them to others requirements engineers or customers what are the main obstacles keeping this approach from being applied in practice?
first we must often deal with timing requirements which can be specied and played out with scenariotools but currently cannot be checked for realizability.
furthermore in our experience editing msds with the eclipse papyrus uml editor was very time consuming.
for an industrial application we would favor a textual speci cation language which has bene ts in version control and easier overall editing.
also scenariotools is an academic tool that is not su ciently user friendly and self explanatory for industrial application.
for larger speci cations understanding speci cation defects will become harder.
here it must be investigated if there exist methods that support the engineer and which scale with the speci cation complexity.
we could very well imagine to use the approach in internal projects.
in projects where customer requirements may not be in a shape that can be easily formalized with msds the payo of a formal speci cation approach must still be assessed.
being able to discuss with the customer defects in their speci cation on the basis of a scenario based speci cation sounds intriguing.
however it could be that the e ort of formalizing the speci cation is higher than nding defects in classical requirements analysis by reviews or the later development even if this may require iterations .
.