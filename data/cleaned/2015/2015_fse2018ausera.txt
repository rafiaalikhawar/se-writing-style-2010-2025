are mobile banking apps secure?
what can be improved?
sen chen east china normal university china ecnuchensen gmail.comting su east china normal university china nanyang technological university singaporelingling fan east china normal university china guozhu meng chinese academy of sciences china nanyang technological university singaporeminhui xue optus macquarie university cyber security hub australiayang liu nanyang technological university singapore lihua xu east china normal university china new york university shanghai china abstract mobile banking apps as one of the most contemporary fintechs have been widely adopted by banking entities to provide instant financial services.
however our recent work discovered thousands of vulnerabilities in banking apps which indicates these apps are not as secure as we expected.
this motivates us to conduct this study for understanding the current security status of them.
first we take months to track the reporting and patching procedure of these vulnerabilities.
second we audit state of the art vulnerability detection tools on those patched vulnerabilities.
third we discuss with banking entities via in person or online meetings and conduct an online survey to gain more feedback from financial app developers.
through this study we reveal that people may have inconsistent understandings of the vulnerabilities and different criteria for rating severity state of the art tools are not effective in detecting vulnerabilities that the banking entities most concern and more efforts should be endeavored in different aspects to secure banking apps.
we believe our study can help bridge the existing gaps and further motivate different parties including banking entities researchers and policy makers to better tackle security issues altogether.
ccs concepts security and privacy software and application security keywords mobile banking apps vulnerability empirical study corresponding authors.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse november lake buena vista fl usa association for computing machinery.
acm isbn .
.
.
.
reference format sen chen ting su lingling fan guozhu meng minhui xue yang liu lihua xu.
.
are mobile banking apps secure?
what can be improved?.
in proceedings of the 26th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse november lake buena vista fl usa.
acm new york ny usa pages.
introduction there are two big opportunities in the future financial industry.
one is online banking where all the financial institutions go online the other is internet finance which is purely led by outsiders.
jack ma.
a few years ago jack ma argued the differences between fintech financial technology and techfin technological finance .
fintech is known as a new industry where cutting edge technologies are applied in financial services.
it is used to help companies manage the financial aspects of their businesses.
techfin on the other hand is the third party company that offers new technological solutions e.g.
security service .
for example as one of the most popular contemporary fintechs mobile banking applications apps have been widely adopted by banking entities to provide instant financial services e.g.
money transfer peer to peer payment .
undoubtedly securing such fintech as banking apps is important and crucial to our interests.
however as revealed by our recent large scale study these financial services e.g.
banking apps are not that secure in the real world .
specifically we built an automated security analysis tool ausera and assessed banking apps across over countries.
ausera unveiled vulnerabilities many of which could cause serious sensitive data leakage e.g.
pin code user name .
to investigate such an alarming phenomenon we take three steps to investigate the current security status of banking apps.
first we report vulnerabilities to the corresponding banking entities for confirmation and track the patching process by scanning the new app versions.
however the reporting process is not as smooth as we expected.
due to lack of online contact information or security supporting services we only receive a few valid responses.
we keep tracking the email responses from august to january months in total but only receive responses from .
banking entities.
797esec fse november lake buena vista fl usa s. chen t. su l. fan g. meng m. xue y. liu and l. xu bankingapps vul.
typesassessmentauseragap investigation banking entities reportconfirmation feedbackrq1 reporting patching efficiently?rq2 existing tools effective?rq3 gaps between different parties?
vul.
damage attacks lessons learned surveylongitudinalanalysis figure workflow of our study during the months banking entities patched .
of our reported vulnerabilities.
on average it takes days for a bank to patch one vulnerability which is obviously far from satisfactory.
we find several reasons that account for such a long patching time banking entities may not be aware of or emphasize specific vulnerabilities in practice they do not have standard severity rating criteria to prioritize vulnerability patching they usually rely on penetration testing to guarantee security which however may not be able to detect vulnerabilities of their concerns.
second we explore whether the state of the art security tools can uncover vulnerabilities that the banking entities most concern.
to this end we choose four representative tools often used by developers in practice i.e.
qihoo360 androbugs and qark and mobsf to assess those banking apps that have been patched according to our reports.
based on the analysis results we find two obvious weaknesses of these tools they output a large number of false positives due to the syntax based checking strategies they may fail to handle different malicious scenarios due to the same vulnerability e.g.
using invalid server verification .
third we set up several in person or online meetings with the banking entities from uk india china singapore and hongkong e.g.
hsbc ocbc dbs and bhim to understand the policies they follow.
we surprisingly find banking entities may have inconsistent understandings with academic researchers or even with themselves.
they emphasize more on data leakage related and invalid authentication vulnerabilities than the other types.
furthermore we conduct an online survey for app developers to familiarize with their security considerations and vulnerability understandings during development.
we find developers may choose insecure apis or implementation methods due to their preference or expertise.
based on the experience we distill several lessons and recommendations for different parties including banking entities researchers and policy makers to better secure banking apps.
in summary we make the following contributions we conduct the first study to track and investigate the vulnerability patching process of mobile banking apps and communicate with banking entities on the discovered vulnerabilities by our security risk assessment tool ausera .
we unveil several problems in industrial practice and also evaluate the abilities of the state of the art vulnerability detection tools on the patched vulnerabilities that the banking entities most concern.
we distill several lessons and recommendations from our investigation and show the gaps that banking entities researchers and policy makers that need to close.we believe our study can provide useful insights for different parties to secure mobile banking apps.
we here also emphasize that our study has received positive feedback from the banking entities in question and already driven several improvements in their policies as well as our tool ausera has done its upmost for boosting their products quality.
study design in this section we first briefly introduce the workflow of our study and summarize three research questions we aim to answer in this paper.
next we introduce the procedure of vulnerability collection.
last we give a real vulnerability case to show its damage and briefly illustrate how ausera can detect it.
.
workflow of our study as shown in figure our study contains phases i vulnerability collection .
we apply our automated security risk assessment tool ausera on mobile banking apps to collect vulnerabilities.
specifically ausera employs two strategies to detect vulnerabilities in mobile banking apps a forward data flow analysis to determine whether there exists sensitive data flowing into insecure sinks e.g.
sendtextmessage abackward control flow analysis to check whether the vulnerable api invocation patterns in communication infrastructure are truly reachable e.g.
invalid server authentication .
after assessing all banking apps we manually confirm vulnerabilities by inspecting the corresponding vulnerable code.
we adopt several reverse engineering and analysis tools e.g.
apktool jadx gui to ease our analysis.
the manual analysis takes us about one and half a month including the demonstration of how to exploit several severe vulnerabilities to get users sensitive data.
ii progress tracking .
we track the procedure of vulnerability reporting and patching via emails and in person meetings.
specifically we send the detected vulnerabilities potential damages and attacks to the banking entities and set up in person meetings if necessary.
further we conduct an online survey to collect feedback from app developers about their security consideration during development and understanding of vulnerabilities.
to achieve this we crawled the email addresses of over .5k android app developers and invite them to participate the survey.
all of them have the experience of developing apps in the fianance category on google play.
we have received responses in total until now.
iii gap investigation .
we compile the feedbacks from banking entities and industrial developers observe the problems during the vulnerability reporting and patching procedure and investigate the security gaps between different parties.
798are mobile banking apps secure?
what can be improved?
esec fse november lake buena vista fl usa get data from edittextspublic string getregistersms stringbuilderm new stringbuilder reg m.append getpin m.append getfirstname m.append getlastname m.append getaddress return m.tostring send the data via smspublic void execute sendsmsmessage getregistersms sms sending codeprivate void sendsmsmessage string message this.smsmanager.setmessage message this.smsmanager.setdestinationaddress ... smshandler.builder .activity this.activity smsmanager this.smsmanager .build .send 1234567891011121314151617181920user input data figure pseudo code of banking app that leaks credentials iv longitudinal analysis .
we summarize the lessons learned from our study.
we also provide some recommendations to banking entities academic researchers and policy makers on how to shorten the vulnerability patching time and bridge existing gaps.
.
research questions in this paper we aim to answer the following research questions by tracking the procedure of vulnerability reporting and patching.
rq1 if some vulnerabilities were found in the mobile banking apps can we efficiently reach the corresponding banking entities?
can the vulnerabilities be efficiently patched?
rq2 are the state of the art security analysis tool effective for detecting the vulnerabilities that the banking entities concern?
rq3 what are the differences of understanding vulnerabilities and rating the severity between different parties e.g.
banking entities third party security companies and researchers?
.
vulnerability collection we collected mobile banking apps from google play which cover more than developed and developing countries across continents.
we then apply ausera to identify vulnerabilities.
ausera has integrated vulnerability types in total.
these types are collected from prior research best industrial practice guidelines e.g.
google android best practice and owasp online secure reports and security weakness and vulnerability databases e.g.
cwe cve .
finally we collected vulnerabilities in total of which are related with private data leakage affecting banking apps such as preference leakage logging leakage sms leakage and sd card leakage .
additionally invalid authentication is also more likely to be exploited affecting apps but always gains little attention from app developers.
.
a real vulnerable case to better understand what a data related vulnerability is and how ausera detects it we give a real vulnerable case.
the case is taken from the app of a famous banking entity in southeast asia with 10m 50m downloads on google play.
it discloses users credentials and may cause severe financial loss.
specifically after users register by entering their names passwords and addresses the apptable tracking information of banking entities we have successfully got in touch with till now banking apps emailduration days in person meetingcountry download hsbc uk china 5m 10m ocbc singapore 5m 10m dbs singapore 5m 10m myaadhar india 50m 100m bhim india 10m 50m icici netbanking india 100m 500m icici pockets india 50m 100m packages users credentials into an smsmessage and sends them to the bank server via servicemanager on android.
it is extremely astonishing that the smsmessage with credential data is also stored into the outbox.
assume the user device runs a daemon service of a malicious app at the backend which could extract the credentials inside the outbox and thereby send out to its remote server controlled by a cybercriminal.
consequently the cybercriminal is able to use the stolen credentials to access the victim s account.
figure presents the pseudo code of this vulnerability.
the confidential data is extracted from the edittexts lines the method execute is called to send a message line containing the extracted confidential data and smsmanager sends the credentials line .
to detect this leakage ausera first tags sensitive data by applying nlp techniques and then uses control and data flow analysis to track the data flow the red arrows in figure indicate the flow of the user input data until it sends out the data.
ausera extracts the leakage path of user inputs and validates the app does send sensitive user data via sms.
security status quo .
vulnerability reporting when reporting vulnerabilities we find many banking entities do not provide contact information or security supporting service on their official websites.
as a result we have to contact them by using the emails of app developers found on google play.
this phenomenon indicates that banking entities have not pay enough attention to the security of their apps.
they do not provide an efficient channel or a bounty program to receive security feedback from third parties e.g.
users researchers .
we contacted banking entities by sending the corresponding vulnerabilities.
however we only received responses including emails in total from banking entities.
some banking entities gave us positive responses which confirmed the reported vulnerabilities.
they would like to cooperate with us to patch the reported vulnerabilities in their new versions.
however as shown in table out of banking entities gave us real replies while the other only gave auto replies saying that we proceeded to forward your request to the competent office in case the proposal will be positively evaluated you will be contacted at the addresses that you kindly provided us.
your ticket number is our support team are currently reviewing your concern.
please expect a response from us.
we explained the reported vulnerabilities in detail to the banking entities via email and sent emails on average to each of them.
but this communication method is proved to be time consuming 799esec fse november lake buena vista fl usa s. chen t. su l. fan g. meng m. xue y. liu and l. xu table tracking the status of vulnerability patching types apps patched apps vuls patched vulspatching rate new vuls actively responded silently patched total .
and ineffective.
therefore we decided to set up in person or online meetings with these banking entities.
we successfully set up the meetings with banking entities.
in each meeting the number of participants is more than and the duration is more than hours.
at least three people from our research team participated in the meeting.
we extensively discussed the reported vulnerabilities in these banking apps and exchanged our idea on how to ensure app security and other related topics.
in particular we visited some banking entities from singapore and china in person.
more results are discussed in section .
.
vulnerability patching as shown in table we find that out of banking entities have confirmed the reported vulnerabilities in two different ways.
banking entities confirm the vulnerabilities by emailing us the positive feedback.
specifically of have fixed the vulnerabilities and the rest claim they will patch the vulnerabilities soon in the next release versions but need our assistance.
however another banking entities confirm the vulnerabilities by silent patching we haven t received any responses from them but they indeed patch the corresponding vulnerabilities in their new versions.
to further confirm the patching status we recheck the latest release versions of these banking apps and find banking entities have already patched vulnerabilities in their apps according to our vulnerability reports.
there are vulnerabilities detected in the banking apps.
however the patching rate of the reported vulnerabilities is low either for banking entities with actively responded or with silently patched .
we explore the reasons behind in section .
on the other hand during the patching procedure new vulnerabilities are introduced in new versions.
it indicates banking entities do not have effective security assessment mechanism for their apps.
for example the banking app c has vulnerabilities.
in its updated version two reported vulnerabilities i.e.
only uses http protocol and logging leakage are patched by employing ssl tls over https communication.
however new vulnerabilities are introduced i.e.
the app does not verify the identity of bank server when using ssl tls .
.
auditing vulnerability detection tools according to the discussion with banking entities we find the top priority of banking entities is to patch vulnerabilities related to data leakage and invalid authentication.
among the patched cases from banking apps cases are relevant to data leakage and cases are using invalid authentication.
banking entities patched .
of these two types of vulnerabilities.
based on the observation we intend to investigate whether the state of the art security tools can effectively detect such vulnerabilities.
we apply state of the art industrial and academic tools qihoo360 androbugs qark andmobsf on the patched banking apps to investigate their abilities of detecting data leakagerelated and invalid authentication vulnerabilities.
qihoo360 andandrobugs are the representative tools in industry and academy respectively.
qark andmobsf are both open source tools and often used in practice according to our survey.
in table we show different types of data leakage related vulnerabilities e.g.
preference leakage sms leakge and screenshot and invalid authentication.
we tick the types of vulnerabilities these tools can detect.
we can see all tools can handle invalid authentication via syntax or pattern based checking methods but we find they can be negatively affected by the existence of dead code incurring false positives .
on the other hand these tools cannot detect most of data leakagerelated vulnerabilities.
only mobsf andandrobugs can detect sensitive data disclosure through logging encryption key hard code and screenshot.
mobsf achieves this by simply matching such apis aslog.e log.d andlog.v .
however it may incur a number of false positives since it is very common for developers to output some insensitive information of their apps via log.d to ease debugging.
we find mobsf reports logging related cases for the banking app gcash of which are all false positives.
meanwhile it reveals false positives related to encryption key hard coded but they only indicate which java files are relevant to encryption functions such as cipher objects.
actually they use files may contain hard coded keys.
as a declaration for their detected security cases which is not actionable for patching.
moreover we find these tools cannot detect all the vulnerabilities that they declare to be able to detect.
for example qark andqihoo360 cannot detect all the vulnerabilities of invalid authentication.
qark is often used by developers or third party security companies to guarantee app security according to our online questionnaire.
however as shown in table it cannot detect data leakage related vulnerabilities that banking entities most concern.
in addition developers also use the tools like xposed and frida to assist their security assessment for apps.
xposed a hook framework can change the original behaviors of the system and apps.
frida a dynamic instrumentation toolkit can inject scripts to explore native apps on android.
strikingly several developers rely on functional testing tool like junit to guarantee app security.
lessons learned this section summarizes the lessons learned from our study including email exchanges in person meetings and valid online questionnaires.
it helps us understand the gaps between different parties including banking entities researchers and third party security companies.
.
different understanding of vulnerabilities understanding of reported vulnerabilities between banking entities and researchers.
from the view of academic researchers we usually recommend all of the reported vulnerabilities should be patched as soon as possible.
however from the view of industrial practice banking entities think that only parts of them are vulnerable and should be patched.
we provide three cases to demonstrate this divergence as follows.
hash functions md5andsha1 have been proved insecure many years ago .
however they are still widely used in app development.
the online questionnaire unveils that developers are still using md5orsha1 for cryptographic use e.g.
randomization and integrity validation although they have been aware of the 800are mobile banking apps secure?
what can be improved?
esec fse november lake buena vista fl usa table patched vulnerability types that banking entities concern concernedpreference leakagelogging leakagesd card leakagewebview leakagesms leakageencryption key hard codedscreenshotinvalid authentication patched vuls qihoo360 androbugs qark mobsf weakness.
in addition some banking entities don t care whether the imported third party libraries use the message digest even if they are aware of it.
in case the instances i.e.
vulnerabilities are in the third party libraries we do not consider such instances as these do not fall within the scope of the assessments.
as the team from bhim andmyaadhar said in the email.
logging sensitive data is very common in industry.
some sensitive data is leaked as debugging outputs such as payee name transfer money and transfer time.
according to the results from online questionnaires we find there are still of developers logging sensitive data in their delivered apps.
some banking entities e.g.
icici netbanking andpockets assume if the minimum sdk is no application can read the logs of other applications even installed on the same device which is a secure environment.
but this is not always true especially when the devices have been rooted or under privilege escalation attacks.
the appropriate mitigation is to remove these debugging outputs before release which has been widely acknowledged in academia .
the last one is invalid authentication for banking apps.
some banking entities e.g.
hsbc china used two types of authentication before login and after login respectively.
the problematic authentication phase is before login before logging in the banking app they use an invalid authentication to set up the communication between the app and remote server.
that is they do nothing in the function of checkservertrusted on invalid certificates it is at risk for users data and behaviors.
understanding of same vulnerabilities between different banking entities.
actually as for a certain vulnerability different banking entities may hold different understandings.
here we give a real case to explain the phenomenon.
we regard screenshot as a vulnerable behavior for banking apps because malicious apps can extract users credentials and other sensitive data e.g.
transfer data via screenshots.
the developers in ocbc from singapore thought screenshot is a basic function for banking users since users may want to share information to their friends .
however the developers in bhim from india confirmed the damage of screenshots although they don t know how to patch it at first.
the results from online questionnaire show that developers think allowing screenshot in a security related app is vulnerable however the rest of developers hold the opposite opinion.
we don t think that screenshots of all app pages have damage but it is at least vulnerable to sensitive pages e.g.
pages of login registration and transfer .
to avoid this screenshot attack developers should set windowmanger.layoutparams.flag secure by calling getwindow setflags in the page that should be protected.
.
severity criteria and concerns severity criteria of reported vulnerabilities.
due to high vulnerability patching cost time and human efforts banking entitiesprefer to patch the vulnerabilities of high risks.
specifically ocbc anddbs rely on cvss to determine the severity of found vulnerabilities while the other banking entities check whether the vulnerabilities belong to sensitive data leakage.
if so such vulnerabilities are considered of high risks.
but the standard of sensitive data leakage is too coarse grained since the definition of data is unclear and the criterion cvss is not that complete and perfect.
actually there is also no standard criteria for vulnerabilities in academia.
but researchers prefer security metrics such as the severity of damage the cost of exploits and cves to decide the severity of vulnerabilities.
concerns of banking entities about vulnerabilities.
banking entities do concern about reported security issues hsbc takes the security of its customers systems and data very seriously and we are always interested in any security issues raised by users and researchers of our web sites and welcome any relevant information that you may have.
said by hsbc security team from the uk in the email.
according to the patching results received emails and in person meeting we find all banking entities concern more about sensitive data leakage and invalid authentication vulnerabilities such as smsandpreference leakage.
.
collaboration and responsibility collaboration mechanism between researchers banking entities and third party security companies.
when we first reported the vulnerabilities to banking entities their developers cannot patch them directly due to lack of enough security knowledge.
banking entities handed them over to third party companies for seeking further confirmations and supports.
it was stated that the third party companies used penetration testing e.g.
qark frida and drozer to check the banking apps before delivery.
however penetration testing cannot fully guarantee the security of apps since it relies on manual analysis.
the whole process of security check is transparent to banking entities and that is why they have to resort to third party companies for confirmation of newly discovered vulnerabilities.
actually the vulnerability patching time includes the communication time and actual fixing time which explains the long patching duration.
therefore the collaboration between researchers banking entities and third parity companies is not very efficient.
who should be responsible?
in some cases banking entities refused to take the responsibility of introducing vulnerabilities.
one real case is as follows.
one banking app stores user name and password to an xmlfile via sharedpreference an internal storage.
if a malicious app is installed on the same device users sensitive data can be stolen easily.
however some banking entities think users should be responsible for such risk since they should not download and install malicious apps on their devices for whatever reasons.
801esec fse november lake buena vista fl usa s. chen t. su l. fan g. meng m. xue y. liu and l. xu in other cases the banking entities think the third party security companies should be responsible.
for example the developers use setseed when implementing securerandom which is vulnerable due to lack of randomness.
they require third party companies or their own security team to add the corresponding detection methods when inspecting newer versions.
additionally in some cases they only recognize the severity after we report the vulnerabilities e.g.
invalid authentication before login .
under this situation it is the banking entity itself that should be responsible for the vulnerability.
.
recommendations what can be improved for banking entities?
banking entities should provide various channels to respond to vulnerabilities especially for the researchers who are focusing on the relevant research topics.
for example they can provide the contact information of security supporting service on the prominent position of their company websites.
app packing is one of the effective protection methods for banking apps such as apkprotect bangcle and ijiami .
it can significantly complement penetration testing.
even if one app has vulnerabilities app packing can increase the difficulty of exploitation.
banking entities should pay more attention to security issues rather than only functional bugs .
it is better to build a security team by themselves or work with third party security companies e.g.
alibaba juanquan and ijiami .
banking entities should carefully choose third party libraries and evaluate the risk imposed by the incorporation of these libraries.
what can be improved for academic researchers?
researchers should pay more attention on the research topics of android applications which have practical scenarios in industry.
when reporting vulnerabilities researchers are advised to provide more information such as the potential damage exploitation methods and patching methods.
it makes banking entities instantly grasp these vulnerabilities so as to take duly measures.
according to our online questionnaires we summarize the vulnerability types that should receive more attention.
the results show that of developers concern more about sensitive datarelated issues e.g.
privacy of users info leaks database which need further study and exploration.
what can be improved for policy makers?
explicitly designating the responsibility of each party can effectively improve vulnerability patching and security awareness.
gdpr general data protection regulation eu already made the first step.
the policy makers should help standardize the third party reporting channels.
concluding remarks .
impact of our study the security status quo of the banking entities that closely communicated with us has been changing in different aspects.
they have accepted our reported vulnerabilities and actively collaborated with us to improve the app security.
in addition the core developers explored and learned the techniques used in ausera from us.
they asked us for help to conduct an automated security assessment for their new versions with ausera before release.
theyfurther explored penetration testing from third party companies to shorten the patching duration such as the ocbc team.
they took charge of the outdated versions in the wild by forcing updates to reduce the impact of our reported vulnerabilities.
some secure hints are pushed to mobile users frequently by banking entities such as the banking app from dbs.
.
conclusion this paper represents the first study to track the reporting and patching process of vulnerabilities in mobile banking apps which lasts more than months.
we received numerous positive feedback from banking entities on the reported vulnerabilities.
we also audited the state of the art vulnerability detection tools for those confirmed vulnerabilities.
finally we provided many practical recommendations for different parties.
in all our study provides useful insights to bridge the security gaps and also helps banking entities and third party companies to better tackle security issues.