optimizing selection of competing services with probabilistic hierarchical refinement tian huat t an2manman chen1jun sun2y ang liu3 tienne andr 4yinxing xue3jin song dong1 2sutd singapore 1nus singapore 3ntu singapore 4universit paris france abstract recently many large enterprises e.g.
netflix amazon have decomposed their monolithic application into services and composedthem to fulfill their business functionalities.
many hosting services on the cloud with different quality of service qos e.g.
availability cost can be used to host the services.
this is an example of competing services.
qos is crucial for the satisfaction of users.
it is important to choose a set of services that maximize the overall qos and satisfy all qos requirements for the service composition.
this problem known as optimal service selection is nphard.
therefore an effective method for reducing the search spaceand guiding the search process is highly desirable.
to this end weintroduce a novel technique called probabilistic hierarchical refinement p rohr .p rohr effectively reduces the search space by removing competing services that cannot be part of the selec tion.
p rohr provides two methods probabilistic ranking and hierarchical refinement that enable smart exploration of the reduced search space.
unlike existing approaches that perform poorly whenqos requirements become stricter p rohr maintains high performance and accuracy independent of the strictness of the qos requirements.
p rohr has been evaluated on a publicly available dataset and has shown significant improvement over existing approaches.
introduction web services provide an affordable and adaptable framework that can produce a significantly lower cost of ownership for the enterprises over time.
web services make use of open standards such aswsdl and soap which enable the interaction among heterogeneous applications.
this facilitates the dynamic integra tion among applications without costly and time consuming programming.
enterprises make use of service composition to integrate multiple services for complex interactions.
the composed web serviceis called a composite service whereas the services that are used in the composed web service are called component services.f o r each of the component services there are usually many competing services that provide the same functionality but different levels ofquality of service qos e.g.
response time availability cost for selection.
we provide two examples on such competing services.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributedfor profit or commercial advantage and that copies bear this notice and the full cita tion on the first page.
copyrights for components of this work owned by others thanacm must be honored.
abstracting with credit is permitted.
to copy otherwise or re publish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
icse may austin tx usa c circlecopyrt acm.
isbn .
.
.
.
rrnlqj 6huylfh du rrnlqj 6huylfh rwho rrnlqj 6huylfh 5hso 8vhu5htxhvw iurp 8vhu7udyho 5rdg 7udyho lu figure travel agency service t as .
many big players in the market e.g.
netflix amazon and microsoft azure have adopted microservice architecture by decomposing their existing monolithic applications intosmaller and highly decoupled services also known as microservices .
these services are then composed for fulfillingtheir business requirements.
for example netflix decom posed their monolithic dvd rental application into services that work together and that stream digital entertainment to millions of netflix customers every day.
services of netflixare hosted in a cloud provided by amazon ec2 whichoffers about instance types e.g.
t2.micro c4.4xlarge for selection.
all instance types provide the same functionality while having different qos.
.
many enterprises outsource some of their business tasks to external service providers e.g.
car booking service for low ering the cost of operations.
however many external services may offer the same functionality but with a different level of qos.
figure shows an example of a simple composite service named travel agency service t as .
if the user requests to travel by road the car booking service cbs will be invoked to book a car for reaching the destination.
if the user requests to travel by air the flight booking ser vice fbs will be invoked to book the flight for reaching the nearest airport to the destination.
in either case the ho tel booking service hbs will be invoked to book the hotel.
finally the system replies to the user with the status of booking.
there may be many competing services for cbs fbs and hbs.
qos attributes such as response time availability cost etc.
provide quantitative indicators on non functional aspects of the composite service.
the service level agreement sla is often used asan agreement between the composite service providers and the service users it specifies the expected qos level of the composite ser vice.
the sla can be expressed as constraints over the qos e.g.
the response time must be smaller than one second or the availabil ity must be higher than .
.
a composite service user typically has limited knowledge on the internal structure of the compositeservice and component services that are involved.
the service user is only concerned with the end to end qos of the composite ser2016 ieee acm 38th ieee international conference on software engineering vice i.e.
the qos at the composite service level.
the user requirements of qos for the composite service can be specified as global constraints.
our objective is to select a set of concrete services that can satisfy the global constraints on the composite service while maximizing the end to end qos.
following the soa principles a composite service contains a set of abstract services which have their functionalities defined.
givenan abstract service e.g.
a hotel booking service a concrete ser vice e.g.
the hilton hotel booking service is selected from a set of competing services to realize the abstract service at runtime.
theproblem of selecting concrete services while maximizing end toend qos known as the optimal selection problem has received considerable attentions over the last decade .
the optimal selection problem becomes increasingly challenging as the number of concrete services increases.
given a composite service with abstract services executed in a sequential manner with each abstract service having 10concrete service candidates there are10 10combinations to explore.
in fact it has been shown that the problem is np hard .
to address the scalability problem approaches based on selecting representative component services have been proposed.
we denote the optimality of qos for a concrete component service withrespect to other functional equivalent services as local optimality.
existing state of the art representative services approaches provide search space reduction based on local optimality of the ser vices.
although it has been shown to provide good performancefor a large number of candidates with less restrictive global constraints it suffers from significant performance degradation whenthe global constraints become more restrictive.
the primary reason is that they do not take the global constraints into account duringservice selection.
in addition the algorithm for selecting represen tative services i.e.
k means clustering has high worst case complexity i.e.
np hard .
in this work we propose a novel approach called probabilistic hierarchical refinement p rohr to address this problem.
the key idea behind p rohr is the usage of both global constraints and local optimality to achieve search space reduction.
p rohr is divided into three stages i.e.
preprocessing stage probabilistic ranking stage and hierarchical refinement stage.
in the preprocessing stage the services that are verified impossible to be partof the optimal selection are pruned from the search space.
subsequently in the probabilistic ranking stage services are ranked according to both local optimality value and constraint satisfactionprobability.
intuitively local optimality value and constraint satisfaction probability of a service quantify the optimality of the service and the likelihood that the service can contribute to the conformance of global constraints respectively.
following that in the hierarchical refinement stage initial representative services fromthe top hierarchy of competing services are chosen.
the number of representative services is adjusted adaptively according to theconstraint satisfaction probability of representative services.
the representative services are then refined iteratively with more ser vices from lower hierarchies until a solution for optimal service selection is found.
in our approach our representative selection has much lower worst case complexity than the existing state of theart approaches .
the complexity analysis of the algorithms is provided in section .
.
our main contributions are summarized below.
.
we introduce a pruning method called constraint pruning that can effectively discard the service candidates that cannotsatisfy the global constraints.
.
we propose probabilistic ranking and hierarchical refinementmethods which enable smart exploration of search space byeffectively leveraging the information of global constraints and qos for competing services.
.
we evaluate the benefits brought by the p rohr using a publicly available dataset.
the results have shown significant improvement over existing approaches.
outline.
section introduces the qos compositional model and necessary terminologies.
section presents p rohr.
section provides the evaluation of our approach.
section discusses ourapproach.
section reviews related works.
finally section concludes and outlines future work.
qos aware compositional model in this section we define the qos compositional model used in this work.
following the soa principles service providers needto characterize their services to define both the offered functionalities and the offered quality.
an abstract service specifies thefunctionality of the service without referring to any concrete ser vice instance.
an abstract service can be defined as a service class s s ... s n which contains nfunctionally equivalent concrete services sithat can be used to realize the functionality specified by the abstract service.
we use s to denote the total number of concrete services in s. we use the notation hatwidesto denote an abstract service s primethat is a subset of s i.e.
s prime s. an abstract composite service cs aspecifies the compositional workflows using a set of abstract services cs a angbracketlefts1 ... s n angbracketright for fulfilling the service requests.
a concrete composite service cs angbracketlefts1 ... s n angbracketrightis defined as an instantiation of abstract composite service cs a angbracketlefts1 ... s n angbracketright where each abstract service siis replaced by a concrete service si si.
we use cs a to denote the total number of abstract services in cs a. for simplicity of illustration we only consider the travel by air branch of the t as example.
this results in a compositionwhere services fbs and hbs are running sequentially.
we will use the modified t as example as a running example in this work and henceforth simply refer to it as the t as example.
for the t as example there are two abstract services fbs and hbs.
suppose that the concrete services for fbs and hbs are f f2 f3 f4 and h1 h2 h3 h4 respectively.
then the abstract composite service tas ais angbracketleftfbs hbs angbracketright angbracketleft f f2 f3 f4 h1 h2 h3 h4 angbracketright and a possible concrete composite service of tas acan be tas angbracketleftf1 h2 angbracketright.
.
qos attributes in this work we deal with qos attributes that can be quantitatively measured using metrics.
in addition we assume the values of qos attributes for services to be known we discuss how the value can be obtained in section .
there are two classes of attributes positive ones e.g.
availability and negative ones e.g.
response time .
positive attributeshave positive effects on the qos and therefore they need to be maximized.
conversely negative attributes need to be minimized.for simplicity we only consider negative attributes in this work since positive attributes can be transformed into negative attributesby multiplying their values with .
given rqos attributes of a concrete component service s we use an attribute vector q s angbracketleftq1 s ... q r s angbracketrightto represent the qos attribute values of service s whereqi s is theith qos attribute value of s. similarly given a concrete composite service cs we use the attribute vector qcs angbracketleftq prime cs ... q prime r cs angbracketrightto represent it where q prime i cs is theith end to end qos attribute value of cs .
86the sla often specifies a set of constraints on the end to end qos.
such constraints define the lower bound for positive constraints e.g.
the availability must be higher than .
and theupper bound for negative constraint e.g.
the response time must be less than ms .
given a composite service cs with qos attribute vector q cs angbracketleftq prime cs ... q prime r cs angbracketright the global constraints of cs can be represented as a vector ccs angbracketleftc1 ... c r angbracketright whereci randq prime i cs ci.
without loss of generality we useci to denote the situation where q prime i cs is unconstrained.
.
qos for composite services we introduce four elementary compositional structures for com posing the component services sequential parallel loop and con ditional.
sequential composition of services s ... s n executes the services sequentially one after another.
parallel composition of services s1 ... s n executes the services concurrently.
a loop executes a service s1repeatedly up to kiterations.
conditional composition of services s1 ... s n executes exactly one of the services according to the evaluation of the guard conditions wherethe guards are mutually exclusive.
the end to end qos is aggregated from the qos on the component services based on the service compositional structures and the types of qos attributes.
table shows the aggregation functions for response time availability and cost of component serviceswith respect to the compositional structures.
the response time r r 0is the delay between sending a request and receiving a response.
for the sequential composition the response time of theservice composition is obtained by summing up the response time of the component services.
for the parallel composition it is equal to the maximum response time among the participating component services.
for the loop composition it is calculated by summing the involved component service ktimes where kis the maximum number of loop iterations.
for the conditional composition sincethe evaluation of guards is not known at design time the maximum response time of nservices is chosen as the response time of the composite service.
the availability a r is the probability of the service being available.
for the sequential composition this implies that all the services are available during the sequential execution therefore the availability of the composite compositionis the multiplication of the component services availability.
the costc r 0is the price for utilizing a service.
for the sequential and parallel composition it is calculated by summing the cost of participating component services.
for other compositions theiraggregation functions are similar.
given an abstract composite service cs a a composite service cs prime ais a subset ofcs a denoted by cs primea cs a i fcs primeaand cs ahave the same compositional structure and every service class ofcs prime ais a subset of the corresponding service class of cs a. formally cs prime a cs aifcs primeaandcs ashare the same compositional structure c with cs prime a cs a and si cs prime a sj cs a i j si sj.
given a composite service cs a areduced abstract composite service ofcs a denoted by hatwidestcs a is used to represent any composite service cs primea cs a e.g.
an example of hatwidetas ais angbracketleft f f2 h1 h2 h3 angbracketright.
.
optimality function concrete services have multi dimensional attributes and we need a methodology to facilitate their comparison in terms of their qos.
in this work we use a simple additive weighting saw technique to obtain a score for multi dimensional attributes.
saw uses two phases normalization and weighting for producing the score.
the normalization stage normalizes the values of qos attributes so that they are independent of their units and ranges toqos attribute sequential parallel loop conditional response timen summationtext i 1q si nmax i 1q si k q s1 nmax i 1q si availabilityn producttext i 1q si n producttext i 1q si q s1 kn min i 1q si costn summationtext i 1q si n summationtext i 1q si k q s1 nmax i 1q si table aggregation function allow comparison.
the weighting stage allows users to specifytheir preferences on different qos attributes.
in the normalization stage a service compares its qos attribute values with themaximum and minimum qos attributes of other service candidates within a service class.
a composite service compares its aggre gated qos attributes with the maximum and minimum aggregated qos attributes.
the maximum resp.
minimum aggregated qos attributes can be obtained by aggregating maximum resp.
minimum qos attributes from each service class.
formally we have g min k f k n i lmin i k gmax k f k ni lmax i k with lmin i k min s siqk s lmax i k m a x s s iqk s wheregmin k andgmax k are the minimum and maximum aggregated values for the kth qos attribute for the composite service f k is the qos aggregation function for attribute kwhich is given in table lmin i k andlmax i k are the minimum and maximum aggregated values for the kth qos attribute for service class i. suppose each service has rqos attributes.
the local optimality functionli s computes the local optimality value of a concrete serviceswithin service class si wheres si as follows.
li s r summationdisplay k 1v i k s wk with v i k s lmax i k qk s lmax i k l min i k iflmax i k negationslash l min i k iflmax i k l min i k wherewk r 0is the weight of qkand summationtextr k 1wk .
the global optimality function g cs computes the global optimality value of concrete composite service cs as follows.
g cs r summationdisplay k 1v prime k cs wk with v prime k cs gmax k q prime k cs gmax k g min k ifgmax k negationslash g min k ifgmax k g min k wherewk r 0is the weight of q prime kand summationtextr k 1wk .
.
problem statement we first define the notions of feasible and optimal selection.
87concrete servicesresponsetime ms availability f1 h1 .
f2 h2 .
f3 h3 .
f4 .
h4 .
a concrete services of t as pv 0lq uhvsrqvh wlph pv b service preprocessing figure t as example definition .given an abstract composite service cs a angbracketlefts1 ... s n angbracketright and global qos constraints c angbracketleftc1 ... c r angbracketrightfor cs a a feasible selection is a selection of concrete services cs such that cs contains exactly one service for each service class siincs aandcs satisfies the global qos constraints c i.e.
q prime k cs ck.
definition .an optimal selection is a feasible selection of concrete services cs that maximizes the global optimality value g cs .
given an abstract composite service cs a and a set of global constraints c we are interested in finding the optimal selection cs .
to address this problem a naive approach is to exhaustively explore all combinations of concrete services for each service class.
however given nservices in sequential composition with each of them having lcandidates the total number of combinations is ln.
in fact this problem is np hard as it can be used to model a known np hard problem i.e.
the multi dimensional multi choiceknapsack problem mmkp .
to allow runtime qos awareservice composition it is desirable to find a near optimal selection at an acceptable cost rather than finding an exact solution to the optimal selection problem at a very high cost .
one way to mitigate this problem is to select a subset of service candidates each time instead of working on all services candidates.this is efficient especially when the number of service candidates is large and hard to be handled.
the question that arises is howto identify a set of representative service candidates that not only satisfy the constraints but also contribute to high global optimal ity value.
in this work our goal is to address the optimal selection problem efficiently and effectively by progressively exploringsubsets of candidates that are likely to contribute to the optimal ornear optimal selection.
tas example.
we provide the details of non functional properties on the t as example which will be used in the following sections.
each of the abstract services of tas ahas four concrete services where fbs f1 f2 f3 f4 and hbs h1 h2 h3 h4 .
the attribute vector of t as example is in the form of qtas angbracketleftq prime tas q prime tas angbracketright where attribute q prime 1provides the value of response time and attribute q prime 2provides the value of availability.
the values of response time and availability of all concrete services aregiven in figure a .
in addition the global constraints for response time and availability of t as are ms and .
respectively.
probabilistic hierarchical refinement prohr we introduce our method probabilistic hierarchical refinement in this section.
the workflow of p rohr is illustrated in figure .
prohr is divided into three stages i.e.
preprocessing stage probabilistic ranking stage and hierarchical refinement stage.
the details of each of the stages are introduced in the following subsections.3uredelolvwlf 5dqnlqj lhudufklfdo 5hilqhphqw 3uhsurfhvvlqj rqfuhwh frpsrvlwh vhuylfh evwudfw frpsrvlwh vhuylfh1r ihdvleoh vhohfwlrq figure probabilistic hierarchical refinement p rohr .
preprocessing stage the global constraints play an important role in selecting the ser vices.
for example it has been shown that the heuristic method proposed in has its performance degraded when the global con straints become more restrictive.
in this section we show that theglobal constraints can be used as an effective means for pruning service candidates.
consider the t as example in figure b wherefbs and hbs are running sequentially and the t as global constraint for response time is ms. we know that the concreteservice that has the fastest response time for hbs is service s prime which has response time of ms. therefore a service s fbs must have a response time smaller than ms in order to fulfill the global constraint for response time.
we refer to a service thatmay fulfill the global constraints as a constraint satisfiable service.
formally given a composite service cs angbracketlefts ... s n angbracketright and global constraints ccs angbracketleftc1 ... c r angbracketright a service si siis a constraint satisfiable service if the following condition holds k f k j ... n vj ck with vj braceleftbigg qk si if j i lmin j k if j negationslash i where f k is the qos aggregation function for attribute k.f o r example given a service si si and suppose all qos aggregation functions f k are summations then the condition becomes k qk si summationdisplay j ... n ilmin j k ck we can safely prune all constraint unsatisfiable services as theycannot satisfy the global constraints.
for the t as example con crete services f 4andh4are the only concrete unsatisfiable services because some of their qos attributes do not satisfy condi tion .
in particular it is the response times of f h4and the availability of h4that do not satisfy the condition.
in addition to pruning using global constraints we also include in the service preprocessing stage the pruning of non skyline ser vices .
let us first recall the notion of dominance.
d efinition d ominance .letsbe a service class and s s primebe two services where s s prime sands negationslash s prime.
service sdominates services prime denoted by s s prime if the service sis at least as good as service s primein all qos parameters and better than services primein at least one qos parameter i.e.
k ... qs qk s qk s prime and k ... qs qk s q k s prime .
a service s sis denoted as a skyline service if there does not exist a service in service class sthat dominates s i.e.
s prime s s prime s .
in other words a service s sis a non skyline service i f there exists a service s prime sthat dominates s. it can be shown that we can safely prune non skyline services in service class cs without affecting the result of optimal selection .
for our t as example concrete service h4is the only non skyline service.
88algorithm service preprocess preprocess input abstract composite service cs a angbracketlefts1 ... s n angbracketright output preprocessed abstract composite service cs prime a angbracketlefts prime ... s prime n angbracketright 1cs prime a angbracketleft ... n angbracketright 2f o ri tondo 3s prime prime i constraintpruning si 4s prime i nonskylinepruning s prime prime i cs prime a s prime i return cs primea henceforth we denote the pruning of constraint unsatisfiable services and non skyline services as constraint pruning and nonskyline pruning respectively.
the algorithm of service preprocessing is shown in algorithm .
the abstract composite service cs prime a is initialized with empty service classes line where idenotes ith empty service class.
after that each service class of cs awill be undergone constraint pruning line and non skyline pruning line .
the service class after pruning will be assigned to cs prime a line .
finally abstract composite service cs prime awhich contains the preprocessed service classes will be returned line .
in the t as example the composite service tas prime aafter service preprocessing stage is angbracketleft f f2 f3 h1 h2 h3 angbracketright.
after the initial preprocessing we propose in the following a ranking based method that can allow us to limit the selection to a smaller set of services that have higher chance of contributing to the optimal selection.
.
probabilistic ranking stage the local optimality value of a concrete service can reflect the qual ity of a service.
nevertheless it does not provide a direct indica tion on how likely the concrete service can contribute to the con formance of the global constraints.
to address this problem we propose an estimation on the probability of the constraint satisfaction of a concrete service.
first we introduce the notion of local constraint.
the objective of local constraint is to provide an esti mation on the average constraint value that has to be fulfilled by individual service classes.
given a global constraint c i we define the local constraint cias follows where nis the number of service classes.
ci ci n ifagg is sum c1 n i ifagg is mult ci c i nifagg is mult ci ci ifagg is min max equation is recursively applied to the compositional structure according to the aggregation functions agg either summation sum multiplication mult minimum min or maximum max .
assume that ciis a global constraint for cost.
given the original t as in figure which contains three services cbs fbs and hbs we first apply equation to the sequential struc ture which contains a conditional structure and hbs.
the conditional structure and hbs are both allocated with local constraint c i since agg is sum is true .
subsequently we recursively apply equation to the conditional structure where cbs and fbs are both allocated with ci since agg is max is true and the local constraint for the conditional structure is ci .
given a composite service cs a angbracketlefts1 ... s n angbracketright and global constraints of cs aasc angbracketleftc1 ... c r angbracketright the constraint satisfaction probability of a service s si denoted by pi s is calculatedv v v qv v v qv v v q ljkhvw 5dqn rzhvw 5dqn6 u6 u6 u5rxqg v v v 5rxqg v v v v v v 5rxqg q v v v q2 v v v q2 v v v q22 figure a scenario of hierarchical refinement as follows pi s parenleftbig r summationdisplay k 1pk s wk parenrightbig wherewk r 0is the weight of pk s summationtextr i 1wk and r is the credibility factor explained later .
the calculation ofpk s is divided into two cases.
when qk s c k then pk s dmax i k qk s ck dmax i k with dmax i k m a x si si qk si ck and when qk s ck pk s .
in the following we explain the details of equation and equation .
in equation pi s is calculated by using the saw method that is introduced in section .
followed by multiplying with the credibility factor .
the credibility factor is used to adjust the value ofpi s based on how much we can trust pi s .
we set the value of credibility factor to1 n where nis the number of service classes.
the reason for this choice is that with the incre ment ofn p i s would be more dependent on the choices made by other service classes.
to estimate the probability more conser vatively we choose to lower the constraint satisfaction probability given that the number of service classes nincreases.
in equation q k s c ksignifies that qk s has violated the local constraint reminded that negative attributes are assumedhere .
the value of p k s is decided by the value of qk s .i fqk s has a smaller value it has a higher chance for satisfying the globalconstraints hence the higher value of p k s .
given a service class si dmax i k calculates the maximum difference between qk si and the local constraint ck wheresi si.dmax i k serves the purpose of normalizing the value of probability pk s such that pk s r .
for the case of qk s ck it indicates the conformance of qk s to the local constraint and we simply set pk s .
in t as the constraint satisfaction probabilities for concrete services are p1 f1 p h1 .
p1 f2 p h2 .
and p1 f3 p h3 .
.
given a composite service cs a angbracketlefts1 ... s n angbracketright the probabilistic ranking is performed by ordering the services in each ser vice class s iby the multiplication value of local optimality value and constraint satisfaction probability of each service s si i.e.
li s pi s in the descending order.
we denote the ranked service class assr i angbracketlefts1 ... s n angbracketright which is an ordered sequence of all concrete services si si.
the ranked composite service containing the ranked services as csr a angbracketleftsr ... sr n angbracketright.
for t as example given the composite service tas prime areturned by service preprocessing the ranked composite service tasr a angbracketleft angbracketleftf2 f1 f3 angbracketright angbracketlefth2 h1 h3 angbracketright angbracketright where the values of li s pi s for concrete services f1 h1 f2 h2 andf3 h3 are .
.
and .
respectively.
.
hierarchical refinement stage after obtaining the ranked composite service csr a the next stage is to perform service selection on csr a. we illustrate the dynamic ser89algorithm optimization with p rohr p rohr input abstract composite service to be solved cs a input termination threshold for constraint satisfiability epsilon1 r output a feasible selection of concrete composite services cs 1cs prime a preprocess cs a 2csr a prank cs primea hatwidestcsr a angbracketleft ... n angbracketright 4round repeat hatwidestcsra hrefine csr a hatwidestcsr a epsilon1 round cs optimalselection hatwidestcsra 8i f cs negationslash then return cs 10round round until hatwidestcsra csr a return vice selection with an example as shown in figure .
consider that csr a angbracketleftsr sr sr angbracketright where the services of each service class sr i can be found in figure .
the hierarchical refinement uses multiple rounds of selection for selecting the service representatives.
at the first round one service is chosen from each service class they form a reduced composite service hatwidestcsr a angbracketleft hatwidersr hatwidersr hatwidersr angbracketright where hatwidersr angbracketlefts11 angbracketright hatwidersr angbracketlefts21 angbracketright and hatwidersr angbracketlefts31 angbracketright.
the reduced composite service hatwidestcsrais then solved e.g.
by mip solver for optimal selection details will be given in section .
.
note that the reduced composite service hatwidestcsr acontains less services than csr a. therefore the optimal selection can be performed more efficiently.
if a solution is found then the result is returned to the user.
otherwise we proceed to next round by selecting more services from each service class.
the process is repeated until a solution is found or until all services in the service classes have been explored.
in the latter case the selection approach guarantees that it does not miss out a solution if one exists.
the next problem is how to determine the number of representatives for each service class sr iat each round of selection the number of services should be large enough for finding a solution tothe service composition while small enough to allow for efficient computation.
we propose to use constraint satisfaction probability to address the problem.
we first extend the definition of constraint satisfaction probability to a set of services.
given sas a subset of services from service class s i i.e.
s si we define constraint satisfaction probability of s denoted as pi s as the probability that at least one of the services in ssucceed in satisfying the global constraints after composition.
pi s is calculated as follows pi s productdisplay s s pi s we observe that the reason that the optimal selection cannot produce a solution is due to global constraint violation.
therefore the capacity of the set of representatives sshould be large enough so thatpi s can exceed epsilon1 which is a parameter provided by the user on the intended termination threshold.
algorithm presents the main p rohr algorithm.
initially the input abstract composite service cs apasses through two initial stages of p rohr service preprocess and service ranking using functions preprocess andprank respectively lines .
functionpreprocess has been introduced in algorithm and functionalgorithm hierarchical refinement hrefine input abstract composite service csr a angbracketleftsr ... sr n angbracketright input reduced abstract composite service hatwidestcsr a angbracketleft hatwidersr ... hatwidersrn angbracketright input termination threshold for constraint satisfiability epsilon1 r input current round round output abstract composite service hatwidestcsra prime where hatwidestcsra hatwidestcsra prime csr a hatwidestcsr a prime angbracketleft ... n angbracketright 2f o ri tondo servicecount hatwidersr i prob 5f o r j hatwidersr i to sr i do prob prob pi sr i servicecount servicecount p 2round 9i f prob epsilon11 pthen break hatwidestcsr a prime sj sr i j return hatwidestcsr a prime prank sorts the services for each service class si cs prime aby the value ofli s pi s wheres si in the descending order.
the details of prank can be found in section .
.
the reduced abstract composite service hatwidestcsr ais initialized with empty service classes line and the current round number round is initialized to value line .
after that hrefine see algorithm is called to populate each service class of the reduced composite function hatwidestcsr awith the representative services line .
following that it is passed to the optimalselection function line for optimal selection where the details will be introduced in section .
.
the result of the optimal selection is stored in cs .
if the optimal selection is successful i.e.
when cs is not empty the result is returned line otherwise we proceed to the next round of p rohr.
this continues until all concrete services are explored i.e.
when hatwidestcsr a csr a line .
if the optimal selection cannot find a result an empty result is returned line .
algorithm presents the dynamic selection algorithm.
initially the reduced abstract composite service hatwidestcsr a primeis initialized with empty service classes.
for each service class line the servicecount is initialized to the number of services in service class hatwidersr i line and the accumulated probability prob is initialized with line .
starting from index hatwidersr i we accumulate the constraint satisfaction probability of service sr i until it exceeds the threshold epsilon11 p wherep 2round lines .
note that the threshold epsilon11 pincreases with the number of rounds.
the reason is based on the assumption that if there exists an optimal selection concrete services in the optimal selection are likely to be ranked higher by the rank ing algorithm in respective service classes.
therefore at the starting round choosing a smaller amount of services that are rankedhigher from each service class will decrease the solving time for the optimal selection.
conversely the chance of getting a feasibleselection decreases when the number of rounds increases.
hence choosing a larger amount of services at later rounds will lead to a faster exploration of all concrete services especially in the case where there does not exist a feasible selection.
afterwards the respective service classes in hatwidestcs r a primeare then pop90ulated with the representative services with the amount equals to servicecount line .
finally we return the reduced composite service hatwidestcsr a prime which contains the newly inserted representatives line .
for t as the number of services that are chosen at each round depends on the termination threshold for constraint satisfiability epsilon1.
if epsilon1 .
then for the first round we get the reduced composite service hatwidetasr a angbracketleft angbracketleftf2 angbracketright angbracketlefth2 angbracketright angbracketright.optimalselection hatwidetasra will return a feasible selection tas angbracketleftf2 h2 angbracketright which is also the optimal selection for t as example.
since a feasible selection is found t as terminates at the first round of hrefine .i f epsilon1 .
for the first round we get hatwidetasr a angbracketleft angbracketleftf2 f1 f3 angbracketright angbracketlefth2 h1 h3 angbracketright angbracketright tasr a. optimalselection hatwidetasr a will return the same optimal solution as in the former case where epsilon1 .
.
however since there are more concrete services it might take longer time to solve for the latter case where epsilon1 .
.
we will investigate how different values of epsilon1 affect the service selection process in section .
.
solving for optimal selection in this section we introduce the use of mixed integer programming mip to realize the optimalselection at line of algorithm .
mixed integer programming mip is a technique for minimization or maximization of an objective function subjected to a set of con straints.
a binary decision variable x ijis used to represent the selection of service candidates sij.
if a service candidate is selected thenxijis set to and to otherwise.
by equation an mip model can be specified as a maximization of the objective functionbelow r summationdisplay k 1gmax k f k n j summationtext sj i 1qk sij xij gmax k gmin k wk subjected to the qos constraints f k nj summationtext sj i 1qk sij xij ck k r whererandnare the total number of attributes and service classes respectively.
in addition since we only choose one service per service class the following constraint must be hold.
summationtext sj i 1xij j n there are several tools or libraries that can be used to solve the mipmodel examples are gurobi solver and lpsolve solver .
weomit the technical details of mip and refer the readers to .
notethat to solve the above mip model requires the linearization of the objective function and the qos constraints the reader can refer for more details.
.
complexity analysis in this section we analyze the complexity of p rohr algorithm .
letnbe the number of service classes mbe the number of competing services for the service class with the largest number of com peting services and kbe the total number of qos attributes for each service.
representative selection.
the preprocess function algorithm makes use of two functions constraintpruning and nonskylinepruning.
the complexity of constraintpruning fornservice classes iso nm .
the complexity of nonskylinepruning fornservice classes is o nm logm fork 3ando nm logm k for k .
as a side note we intentionally let constraintpruning run before nonskylinepruning because constraintpruning has lower complexity after constraintpruning some competing services might be pruned and it will result in faster nonskylinepruning.
the complexity of the prank function is o nm logm since it only incurs sorting in each service class.
the complexity of iteratively invoking hrefine algorithm is o nm since it runs iteratively until all competing services are included.
to conclude the complexity for representative selection i.e.
algorithm without the optimalselection function is bounded by the complexity ofnonskylinepruning.
integer linear programming problem.
optimalselection function is essentially solvinga0 1integer linear programmingproblem which is a well known np complete problem.
therefore algorithm is np complete.
the ultimate goal of the representative selection is to reduce the number of competing services required to be solved by the optimalselection function in order to improve the overall performance for algorithm .
evaluation we conducted experiments to evaluate our approach to service selection using p rohr.
.
research quesions we attempted to answer the following research questions rq1 rq4 .
rq1.
how is the performance of p rohr in comparison to the state of the art?we analyze how different stages contribute to the performance of p rohr.
firstly we investigate how well service preprocessing performs.
in particular what is the number of services that arepruned in the service preprocessing stage.
secondly we also lookinto the performance of p rohr algorithm without the constraint pruning preprocessing.
the reason is to facilitate the comparison with the state of the art as well as to enable us to evaluate how well the probabilistic ranking and hierarchical refinement work withoututilizing the constraint pruning preprocessing.
lastly we evaluate the performance of p rohr as a whole.
rq2.
how is the accuracy of the concrete services that are selected by p rohr?
we measure the accuracy using the following formula accuracy g cs heu g cs exact whereg cs heu andg cs exact are the global optimality values of concrete services returned by heuristic method and exact methodrespectively.rq3.
how scalable is p rohr?
rq4.
how do different termination threshold values epsilon1influence the selection process of p rohr?
.
experiment setup implementation.
we implemented all algorithms in c .
for solving the mixed integer programming models we used the gurobi solver .
the experiments were conducted on an intel core i74600u cpu with gb ram running on windows .experimental setup.
to answer the previous research questions we evaluate p rohr using a real world dataset .
we compare our methods with which is the existing state of the art for theoptimal selection of services to the best of our knowledge.
foreffective comparison we choose to use dataset of anti correlated distribution as it presents the most challenging dataset for methodsthat make use of non skyline pruning .
note that both andour methods utilize non skyline pruning in the preprocessing stage.
methods to compare.
we compare the efficiency of the following methods.
service class sizecomputation time ms a performance prohr prohrsky kmeans exact service class sizeaccuracy b accuracy prohr prohrsky kmeans exact service class sizecomputation time ms c different st .
.
.
.
service class sizecomputation time ms d different st worst case .
.
.
.
figure experiment results service class sizecomputation time ms prohr prohrsky kmeans exact figure worst case performancename agg.
type name agg.
type response time sum compliance mult availability mult best practices mult throughput min latency sum successability mult documentation mult reliability mult figure qos attributes size nonskyline .
.
.
.
.
constraint .
.
.
.
.
preprocess .
.
.
.
.
figure preprocess results .prohr our method described in section .
.prohrsky our method described in section with the modification that only non skyline pruning is used in the preprocessing stage.
.kmeans the hierarchical k means clustering method proposed in .
.exact the standard global optimization problem for all service candidates represented in the mip model.
the reason for adding prohrsky is because kmeans is also using non skyline pruning as their preprocessing method.
using the same preprocessing method will allow both methods to reduce the sameamount of services at the preprocessing stage therefore enable us to compare the strength of the service selection algorithms for thesetwo methods.dataset.
we make use of the qws dataset which is a public dataset collected from public registries search engines and ser vice portals using a specialized web crawler.
the dataset con tains web services and there are a total of qos attributesmeasured using commercial benchmark tools.
more details on the dataset can be found at .
in our experiments there are five ser vice classes.
for each round of experiments the concrete services for the service classes are randomly chosen from the qws dataset.
we generate sets of qos constraints q q ... q10 where i of the qws services satisfy constraints qi.
for example of the qws services satisfies q1.
for each round of experiments we randomly select a qos constraint from q. qos attributes.
the details of these qos attributes can be found in figure .
the name and agg.
columns in figure provide the names of the qos attributes and the aggregation functions summation sum multiplication mult minimum min for those attributes.
the type column shows whether these attributes are negative or positive .
we randomly partition the dataset into 10service classes and the qos constraints are set randomly.
we runeach experiment for times and report the average values of the metrics.
.
experiments we conduct several experiments e1 e6 to answer the researchquestions r1 r4 .
for experiments e1 to e4 we set the termination threshold at .
and different termination thresholds are evaluated in experiments e5 and e6.
for experiments e1 to e3 there 92exists a feasible selection that can satisfy the global constraints.
we report our findings in the following.
e1 we record the number of services that have been pruned using non skyline pruning nonskyline constraint pruning constraint and the combination of both pruning methods preprocess .
the numbers reported are the percentage of services that are prunedwith respect to the total number of services.
the experiment results can be found in figure .results.
the non skyline pruning has achieved .
.
reduction rate.
as the dataset for experiment has anti correlated distribution and it is known that the non skyline pruning does not per form well in such dataset therefore we can expect the method to perform better for datasets of different distributions e.g.
correlated distribution .
for constraint pruning it has achieved .
.
reduction rate.
the high reduction rate is attributed to thereason that a seemingly lenient global constraint of composite service can result in a high expectation of the qos attribute of component services.
for example the global constraint of availability isset to .
and since there are service classes the average avail ability of the involved component services that need to fulfill theglobal constraint is .
.
.
therefore it results in high reduction rate when combined with the constraint reduction usingresponse time attribute.
another observation is that when thesetwo pruning methods are combined preprocess it can achieve a reduction rate that is greater than any individual pruning method applied alone.
e2 we compare the computation time with respect to the number of services for each service class which varies from to .
the experiment results can be found in figure a .results.
we notice that both prohr and prohrsky have significant improvement over exact and kmeans methods.
since prohrsky and kmeans are both using the same preprocessing method nonskyline pruning this result suggests that probabilistic ranking andhierarchical refinement of prohr have provided faster performance over kmeans.
interestingly although substantial number of services have been pruned by constraint pruning prohr has only achieved slight improvement of performance over prohrsky.
this result suggests that the services that are pruned by constraint pruning are ranked lower by probabilistic ranking algorithm and ser vices that are part of the feasible selection are ranked higher.
therefore the hierarchical refinement effectively locates a feasible selec tion by using a significant smaller subset of the services in a service class.
e3 we compare the accuracy with respect to the number of services for each service class which varies from to .
the experiment results can be found in figure b .results.
we notice that all methods achieve accuracy higher than .
for prohr and prohrsky both have outperformed kmeans by achieving almost accuracy.
this result shows that the service ranking algorithm of prohr has accurately ranked the service such that the feasible selection that has been chosen by the hierarchical refinement algorithm is near optimal or optimal selection.
e4 we compare the computation time with respect to the number of services for each service class which varies from to in the case where it does not exist a selection that can satisfy the global constraints.
the experiment results can be found in figure .results.
we notice that kmeans has fast growing computation time.
the reason is that kmeans appliesk means clustering at each round of selection and it is known that k means clustering is np hard in the worst case.
therefore this makes the method sensitiveto the number of services.
we also notice that prohrsky outperforms kmeans significantly.
there are two reasons for this.
firstly prohrsky only incurs sorting at the start of the selection and it does not incur extra operations between rounds of selection.
sec ondly the number of services that are used for selection increasessignificantly at each round therefore it effectively explores all services in the service classes in a few number of rounds.
prohrsky is slower than exact due to the extra time that it spent on multiple rounds of hierarchical refinements before all concrete services in the service classes are explored at the final round while for exact it explores all services from the beginning.
we also observe that prohr outperforms exact .
this is attributed to the constraint pruning preprocessing in prohr since most of the services are pruned by constraint pruning due to the strict global constraints that make no feasible selection and this let prohr achieve higher performance than exact .
e5 e6 we compare prohr using different termination thresholds with respect to the number of services for each service class which varies from to in the case where it exists e5 and does not exist e6 a selection that can satisfy the global constraints re spectively.
the results of experiments e5 and e6 are shown in figure c and figure d respectively.
results.
it suggests that the smaller the value of termination threshold the faster it tends to complete.
for example the dynamic selec tion algorithm with termination threshold of .
tends to complete faster than the other termination thresholds.
this result is due to the fact that the smaller the termination threshold the fewer elements will be chosen in each round by the dynamic selection algorithm.
we illustrate why this can end up in a faster searching time using an example.
suppose the services that are part of a feasible selection are all ranked at fifth position in their service classes.dynamic selection algorithm with termination threshold of .
can choose fewer services say five services at a single round while dynamic selection algorithm with termination threshold of .
can choose more services say ten services at single round.
although the services selected by dynamic selection algorithm for termination thresholds .
and .
both contain the feasible services but dynamic selection algorithm for termination thresholds .
will be solved faster by the mip solver since it contains fewer services.
nevertheless there is a disadvantage for choosing a smaller termi nation threshold.
experiment e6 has shown that the dynamic selection algorithm with smaller termination threshold tends to finishslower since fewer items that are chosen at each round will lead to more rounds to iterate before all concrete services in each serviceclass are explored.
it is therefore a tradeoff to choose a smaller termination threshold over a larger one.
answer to research questions.
.to answer the research questions rq1 rq3 we can see that both prohr and prohrsky outperform kmeans in terms of performance accuracy and scalability from experiments e1 e4.
research question rq4 is answered by the analyses of experiments e5 and e6.threats to v alidity .there are several threats to validity.
the first threat to validity is due to the fact that competing services are selected from services offered by the qws public dataset.
although the number of services is reasonably large there could stillbe observations that do not make obvious by the set of qos attributes we obtained from these services.
the second threat to va lidity is stemmed from our choice to use a few example values as experimental parameters that include global constraints and termi nation thresholds in order to cope with the combinatorial explosion 93of options.
to address these threats it is clear that more experimentations with different datasets and experimental parameters are required so that we can further investigate the effects that has notbeen made obvious by our dataset and experimental parameters.
discussion worst case scenario.
for our method the worst case scenario happens when no optimal service selection exists.
in such a case our method would need to go through multiple rounds of hierarchicalrefinement algorithm and mip solving until all services are included in representative services.
we can then conclude the non existence of optimal service selection.
however the non existence of optimal service selection is normally due to overly restrictiveglobal constraints which no service selection is able to satisfy.
this signifies that the preprocessing algorithm algorithm may haveremoved most of the competing services from the beginning.
this makes our algorithm still perform well in the worst case scenario.we have evaluated p rohr in the worst case scenario in section .
estimation of qos values.
in practice the values of qos attributes may be obtained from the sla of the service for example amazon ec2 has guaranteed that the monthly uptime percentageof their services would be at least .
.
the qos values can also be estimated based on past invocations of the service by usingmethods such as .
based on the observation from past invocations the user can use an appropriate estimation method suchas expected value or i th percentile according to the requirements of the user.
if a user requires an estimation of qos value that holds for most of the time the user can make use of the expected value of the observed values.
on the other hand if the user requires a moreconservative estimation the user can for example make use of theqos value at the th percentile i.e.
the qos value is worse than of all observed values .
pareto optimal solution.
given two service selection cs 1and cs where both satisfy all global constraints the selection cs is said to dominate cs i f i q prime i cs q prime i cs j q prime i cs q prime i cs wherei j ... k andkis the number of qos attributes.
cs is called a pareto optimal solution ifcs is not dominated by any other cs primethat satisfies the global constraints.
our method with weighed qos attributes equation is provable to produce a pareto optimal solution.
for the proof interested readers can refer to theorem .
.
.
to obtain mul tiple pareto optimal solutions the user can run our method for several times with different weights for each qos attribute each time.
related work the problem of qos aware web service selection and composi tion has received considerable attention during recent years.
in the authors present an approach that makes use of global planning to search dynamically for the best concrete services for servicecomposition.
their approach involves the use of mixed integer programming mip techniques to find the optimal selection of com ponent services.
ardagna et al.
extend the mip methods to include local constraints.
cardellini et al.
propose a methodology to integrate different adaptation mechanisms for combining concrete services to an abstract service in order to achieve a greater flexibility in facing different operating environments.
our work isorthogonal to aforementioned works as it does not assume particular formulation of the mip problems.
although the methodin aforementioned works efficiently for small case studies it suffers from scalability problems when the size of the case studiesbecomes larger since the time required grows exponentially withthe size of concrete services.
yuet al.
propose a heuristic algorithm that can be used to find a near optimal solution.
the authors propose two qos compositional models a combinatorial model and a graph model.
the time complexity for the combinatorial model is polynomial whilethe time complexity for the graph model is exponential.
however the algorithm does not scale with the increasing number of web ser vices.
to address this problem alrifai et al.
present an approach that prunes the search space using skyline methods and they make use of a hierarchical k means clustering method for representative selection.
the work of alrifai et al.
is the closest to ours.
our approach has several advantages over their approach.
firstly their work does not take into account of the provided global constraints for representative selection.
therefore it does not scale well withrespect to the number of attributes and the performance can be significantly degraded by providing restrictive constraints.
secondly making use of k means clustering for the purpose of representative selection can be expensive since the operation is np hard in general while in our work the worst case performance of representative selection is much lower see details in section .
.
dionysis et al.
propose a method that allows users to specify their perception of quality in terms of user defined quality model.their method is based on a k means approach to match the user defined quality model to the search engine s quality model automatically.
their work focuses on providing intuitive quality abstraction and is not related to the optimal selection of services.stephan et al.
propose a qos based service ranking and selection approach.
their approach ranks the services according totheir satisfactory scores and selects the optimal service that satisfies users qos requirements.
raed et al.
propose a method that makes use of analytical network process anp to calculatethe weight associated with each qos attribute and rank the service based on users satisfaction degrees.
and can only be used to choose for a single optimal service that can satisfy the users qos requirements.
in contrast our work aims to select a set of servicesthat are optimal for a service composition.
in we propose approaches to synthesize the local time requirement for component services given the global time require ment of composite service.
in this work we focus on the set of component services that not only can satisfy the global qos constraint but also provide the overall optimal qos for the compositeservice.
in we propose the usage of evolutionary algorithm to optimize the selection of competing features in software productline.
in this work our focus is to optimize the selection of competing services in service composition.
this work is related to analysis of service composition.
in we propose a method that enables integrated verification of functional and non functional properties of service composition.
in we leverage genetic algorithm in calculating the optimal recovery plan during service failure.
in this work our focus is on optimizing the service selection in service composition.
conclusion and future work in this paper we have addressed the optimal selection problem by proposing a new technique namely the probabilistic hierarchical refinement p rohr .
the technique considerably improves the current service selection approaches by considering only a subset of representatives that are likely to succeed before exploring a larger search space.
the full search space will be explored only if all the smaller search spaces have failed to produce a result.
the evaluation has shown great improvement over the existing methods.
for future work we plan to investigate how p rohr can be extended to other search based software engineering problems.