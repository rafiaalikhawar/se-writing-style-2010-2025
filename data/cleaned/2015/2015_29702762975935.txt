automated testing and notification of mobile app privacy leak cause behaviours joseph chan joo keng school of information systems singapore management university joseph.chan.
phdis.smu.edu.sg abstract i describe the design implementation and evaluation of a novel hybrid static dynamic analysis system for automatically uncovering and testing for the user triggered causes and paths of privacy leaks in android applications privacy leak causes .
i describe how i plan to further evaluate and demonstrate improvements in accuracy coverage and testing speed of my hybrid testing approach against other currently available systems.
i also show how user privacy is improved by the presentation of information on leak causes in a eld study as privacy notices.
i present plans to investigate which of the commonly utilized mobile noti cation mechanisms is best suited to the presentation of leak causes as well as how users may set better privacy control policies with the information provided.
ccs concepts security and privacy !privacy protections software and its engineering !automated static analysis dynamic analysis .
introduction while mobile applications help to manage many aspects of urban lifestyle many of them do not optimize usage of privacy data and follow good practices in privacy design.
many apps in mobile stores even popular and well regarded ones access and leak privacy data to the network.
it would be greatly bene cial for tools to perform analysis of app binaries to analyze their privacy behaviours.
of particular interest in my dissertation is the discovery and utilization of user triggered causes and paths of privacy leaks of mobile apps privacy leak cause .
to output the privacy leak causes and paths i proposed and implemented a graph aided directed automated testing solution for android apps .
the system is based on a novel utilization of hybrid static dynamic analysis.
static analysis is used to capture activity page transitional paths of the android application as well as identify target activpermission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
ase sept singapore c acm.
isbn .
that leak privacy data.
after identi cation of target activities automated app testing is utilized for determination con rmation of actual runtime privacy behaviours.
while a number of automated testers have been proposed and developed automated testing remains a very time and resource intensive process.
ensuring good coverage of mobile apps in a su ciently low testing time is a very challenging problem due to the large number of app windows and states involved.
reaching the desired states whereby privacy behaviours are involved in a practical amount of time is a challenge.
an e cient and e ective means of automated runtime testing will remove hurdles to increased adoption.
to solve the problem i utilize analysis of callback control ow to generate an activity transition graph.
this allows automated testing to directly traverse apps towards privacy related activities for veri cation.
on e ective and accurate discovery of privacy related leakcauses in mobile apps an important problem is in improving the privacy behaviours of users with the knowledge obtained.
privacy related noti cations in current privacy detectors are largely based on the just in time concept whereby privacy noti cations appear to the user at runtime.
such noti cations inform users when privacy leaks occur but not how these leaks occur or the privacy related characteristics of the app.
e ective noti cation of privacy leak causes in apps could provide users with better understanding on the privacy behaviours of their apps and enable them to improve their privacy behaviours and set better policies.
.
motivations and existing work privacy analysis of apps i aim to produce a solution for automatically uncovering the user triggered causes and paths of privacy leaks in android apps.
while systems such as for e.g.
flowdroid taintdroid and appsplayground are able to analyze privacy in apps they do not output this information.
user triggered causes and paths represent an additional context information in privacy analysis that could likely be valuable.
automated app testing part of my solution involves testing and veri cation of the privacy leaks using automated app testing.
the commonly used android monkey performs testing using random event generation.
testers such as dynodroid and vanarsena are also based on random exploration but have systematic and improved event selection to increase testing e ciency.
amc and decaf utilize gui models obtained at runtime for path determination.
a3e and orbit utilize static analysis to obtain gui models prior to runtime.
while solutions permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
ase september singapore singapore c acm.
... .
exist automated app testing remains time and resource intensive.
i aim to design and implement an automated testing solution that is more time e cient than these existing systems for testing privacy leak cause behaviours.
privacy noti cations privacy leak detection tools are geared towards the monitoring of privacy infringements rather than on e ective noti cations to the user.
for e.g.
balebako et al.
investigated improving the taintdroid leak detector noti cations by a visualization mechanism which displays the tabulated total number of privacy requests each app has requested in a summarized list.
providing additional context or insights into the privacy characteristic of apps in privacy notices could potentially improve the value of privacy notications and aid users in improving their privacy.
i aim to investigate providing this additional context in the form of user triggered causes and paths of privacy leaks.
.
proposed solution approach hybrid static dynamic analysis system my proposed approach involves using static analysis to capture activity page transitional paths of the android application as well as identify target activities that leak privacy data.
obtaining such transitional paths require the control ow between android call back functions.
due to the event driven nature of the android framework the controlow between call back functions will not be available from a standard controlow graph.
to overcome this problem i initially utilized the callback controlow graph ccfg using the gator tool .
however due to scalability issue i formulated and built a new implementation for analysis of the controlow between call back methods of android activities and the unique gui components linked to these call back methods using soot and the jimple bytecode representation.
the sequence of user actions from the controlow can then be used to directly traverse apps towards privacy related activities for testing.
privacy hci my approach involves providing deeper context and insights into the characteristic of apps in privacy notices by displaying the user triggered causes of privacy leaks and leak characteristics of apps in privacy notices.
to the best of my knowledge the display of user triggered causes of privacy leaks to users has not been studied before.
i investigate how users react in response to these notices as well as how their mobile privacy behaviours can be improved from knowledge obtained from the notices.
i do so by studying their privacy related inclinations after utilizing applications with and without information on usertriggered causes.
such privacy related inclinations could be captured from user activity from usage logs as well as from surveys that users answer during the course of the study.
i also plan to evaluate which noti cation delivery mechanism works best in a lab setting.
lastly i also study if displaying information on user triggered causes can enable users to set better privacy policies in privacy data managers.
.
contributions automated privacy analysis system design and implement a novel hybrid static dynamic tool for outputting user triggered causes and paths of privacy leaks in android apps formulate an e ective algorithm for analyzing the control ow between callback functions that are involvedin activity page transitions in android apps and to create an activity transition graph utilize the activity transition graph to directly traverse applications towards privacy related activities for automated testing and veri cation scale up automated testing and veri cation to many thousands of android apps so that the current leakcause path sequencing behaviours and characteristics of apps in the android ecosystem can be empirically studied.
evaluate the system with those of other automated testing solutions.
noti cation of privacy leak behaviours investigate the e ects of providing the additional context of user triggered causes of privacy leaks to real users in the eld.
evaluate the e ectiveness of di erent privacy messaging mechanisms e.g.
toast message overlays standard android noti cations dialogs etc.
in terms of whether user behaviours are positively modi ed and whether their knowledge of app privacy behaviours are enhanced.
investigate if information on user triggered causes enable users to form better privacy policies.
i describe the currently completed work in the next section.
.
automated graph aided directed testing of android apps in my initial results i demonstrated that utilizing static analysis to guide runtime dynamic analysis has signi cant testing time improvements.
i developed a solution and implementation for time and resource e cient automated testing of android apps based on pre runtime discovery of activity state transitional information from controlow of app byte code.
automated graph aided directed testing the directed testing system is called mamba and the overall system diagram is displayed in figure.
.
from figure path searches are performed from callback controlow graphs ccfg using the gator tool .
the paths sought out were reaching paths from root to all target activities in the app.
a sensitive api linking tool was also built which performed a static analysis on decompiled app smali code to link activities with call graph links to sensitive api calls.
sensitive api calls were any method calls which accessed any form of a user s on phone data or sensor information e.g.
phone identi ers contact list gps location etc.
.
activities with links were identi ed as target activities that are to be reached by the automated tester.
on identi cation of target activities the ccfg paths for these targets were ltered out.
test cases consisting of useractions were then built from these ccfg paths and provided to a user event simulator for enaction on a mobile testdevice.
privacy leaks upon reaching these targeted activities were then detected and veri ed using privacy detectors .
an evaluation was performed using the mamba tester on a set of android apps downloaded from the google 8812android .apk smali code gator callback control flow graph ccfg soot bytecode amc directed testing with test cases elipsis activities associated with sensitive api target activities search for sensitive data apis along call graph ccfg paths reaching target activities search for paths from root to other activities within app build test cases filter target activities figure system diagram of mamba directed testing of android applications for checking privacy speci cations playstore.
a comparison was performed against an exhaustive testing approach whereby clickable app widgets were ordered sequentially and each tried in turn before backtracking to the previous page.
the total testing times required and activity coverage were measured.
the results are detailed in the following section.
.
results on average graph aided tester mamba took just over minutes and seconds to complete testing compared to over minutes and seconds average time for the exhaustive testing approach.
this represented a .
factor improvement in testing times.
in all target activities in the apps were required to be tested.
both testing concepts achieved on a .
average coverage of target activities.
from leak reports in the taintdroid and pmp privacy detectors of targeted activities were found to access privacy data .
over apps .
while of target activities .
over apps were found to leak privacy data to the network.
these results are promising and show that mamba can be used to perform dynamic runtime testing of android apps at a scalable rate.
.
usage of automated app testing output to improve user privacy i conducted a week long eld user study to evaluate the e ectiveness of privacy messages detailing leak cause behaviours of android apps on a set of real users on their personal un rooted mobile phones .
users in test users in control they consisted of sta students as well as external working adults.
i utilized test apps that many of the users had already been using regularly social media utility news as well as game apps .
privacy messages appeared during app usage upon app start ups as well as were overlaid directly on top of privacy invasive buttons widgets.
figure shows an example of a privacy overlay on top of aclickable app widget.
original leak informa0on message overlay the leak informa0on message figure utilizing outputs of privacy checking privacy messages overlaid on top of culprit buttons widgets during application usage.
the users were randomly divided into separate groups of test with messages and control without messages .
users in test users in control i captured the characteristics of users from pre and post study surveys on point likert scale as well as yes no questions.
these characteristics include users prior app usage time familiarity surprise level usability privacy consciousness level and disapproval of app data usage .
a multiple regression with characteristics as independent variables and the duration of app usage log and no.
of leak buttons clicked log as dependent variables.
these dependent variables were investigated as they were proportional to the amount of privacy data being leaked by the application.
.
results the results of the multiple regression are displayed in table .
it was found that users prior app usage time familiarity was the dominant individual factor in a ecting the duration of app usage while user education was signi cant in reducing the no.
of leak buttons that users clicked.
there were signi cant factor interactions which indicated that the privacy messages were e ective for users who disapproved of the data use and had appropriate user education professed high privacy consciousness levels or were surprised with the data accesses.
the study highlights the conditions under which a nonenforcing mechanism can be e ective.
in particular it was found that user disapproval with accesses user education inherent levels of privacy consciousness as well as high surpriselevels play a part in e ectiveness.
.