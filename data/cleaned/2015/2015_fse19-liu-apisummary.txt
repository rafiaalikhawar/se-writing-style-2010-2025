generating query specific class api summaries mingwei liu fudan university chinaxin peng fudan university chinaandrian marcus the university of texas at dallas usa zhenchang xing australian national university australiawenkai xie fudan university chinashuangshuang xing fudan university china yang liu fudan university china abstract source code summaries are concise representations in form of text and or code of complex code elements and are meant to help developers gain a quick understanding that in turns help them perform specific tasks.
generation of summaries that are task specific is still a challenge in the automatic code summarization field.
we propose an approach for generating on demand extrinsic hybrid summaries for api classes relevant to a programming task formulated as a natural language query.
the summaries include the most relevant sentences extracted from the api reference documentation and the most relevant methods.
external evaluators assessed the summaries generated for classes retrieved from jdk and android libraries for several programming tasks.
the majority found that the summaries are complete concise and readable.
a comparison with summaries produce by three baseline approaches revealed that the information present only in our summaries is more relevant than the one present only in the baselines summaries.
finally an extrinsic evaluation study showed that the summaries help the users evaluating the correctness of api retrieval results faster and more accurately.
ccs concepts information systems summarization software and its engineering documentation .
keywords code summarization api knowledge graph code retrieval m. liu x. peng w. xie s. xing y. liu are with the school of computer science and shanghai key laboratory of data science fudan university china.
x. peng is the corresponding author pengxin fudan.edu.cn .
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse august tallinn estonia association for computing machinery.
acm isbn .
.
.
.
reference format mingwei liu xin peng andrian marcus zhenchang xing wenkai xie shuangshuang xing and yang liu.
.
generating query specific class api summaries.
in proceedings of the 27th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse august tallinn estonia.
acm new york ny usa pages.
introduction automated software summarization is the process of generating a concise representation of one or more software artifacts that conveys the information needed by a software stakeholder to perform a particular software engineering task .
researchers have proposed techniques for the summarization of many software artifacts including source code posts on question and answer forums bug reports and issue requests user manuals code and product reviews code changes etc.
one of the goals of these summaries is to facilitate quick understanding of the software artifacts.
for example during code retrieval tasks the summaries of the retrieved code help developers decide quickly whether they are irrelevant or whether they require in depth analysis to establish relevancy.
software artifacts are usually comprised of natural language text and or source code.
the produced summaries may be textual contain source code only or hybrid i.e.
contain both .
approaches that generate textual summaries for textual software artifacts rely on standard techniques from the field of automated natural language text summarization .
more challenging are the approaches that summarize code base and hybrid artifacts where standard techniques do not apply.
among these hybrid documents and summaries are difficult as they usually require establishing relationships between the text and source code components.
a common trait of the automated code summarization techniques is that the generated summaries are independent from the user task i.e.
what the summary is needed for .
binkley et al.
studied human written summaries for the same code but different tasks and concluded a person produces different summaries of the same code for different task.
it also highlighted that summarizing non trivial unfamiliar code is extremely challenging and it is unclear what level of detail is required for a task specific summary.
in addition mcburney and mcmillan showed that there are significant differences between source code summaries written byesec fse august tallinn estonia mingwei liu xin peng andrian marcus zhenchang xing wenkai xie shuangshuang xing and yang liu the authors of the code or by the readers i.e.
users of the same code.
also human written summaries have different properties than automatically generated summaries.
a major challenge left unaddressed by researchers is to determine what type of summary fits best a given user task.
while this paper does not solve this problem entirely it achieves one important step forward by introducing and evaluating a technique named kg apisumm that automatically generates source code summaries based on the user programming task expressed as a natural language query.
many developer tasks are related to using certain apis application programming interfaces .
to find the relevant apis developers often resort to api documentations .
in this paper we focus on automatically generating hybrid extractive summaries for classes supporting developers in finding apis relevant to their programming task .
the summaries are generated on demand in response to a user textual query which describe the programming task at hand.
the summaries are hybrid because they include summary sentences attached to the relevant methods of the class being summarized.
kg apisumm is an extractive summarization approach because the summary sentences are selected from the reference documentation.
the summaries are task specific because the extracted sentences and methods are the ones most related to the user query.
in other words a class may have two different summaries for two different queries.
most existing automated code summarization techniques rely on the summarized code artifact only for generating the summary.
relationships between code elements and other information sources are rarely used hence they cannot be used for creating programming task specific summaries.
only a few summarization techniques rely on extracting code related information from sources external to the summarized code element see section .
one problem is that information about the apis relevant for solving a programming task is scattered across multiple information sources and they relate to each other in more than one way.
our solution to this problem is the construction of an api knowledge graph api kg which represents fine grained information about a library at method and sentence level.
the ability to reason about individual sentences in documentation is essential for generating query specific and succinct summaries.
we constructed an api kg for jdk and android and conducted several empirical studies for the intrinsic and extrinsic evaluation of the class api summaries involving external evaluators.
the evaluators found the summaries to be complete concise and readable.
in addition they contain relevant information which is missing in summaries obtained with three baseline summarization approaches.
finally the summaries helped users identify apis relevant for a programing tasks faster and more accurately.
kg based class api summarization kg apisumm takes as input a natural language user query q describing the developer task a class cfrom an existing library l and the api knowledge graph of the library l api kg l .
theapi kg l is used to extract up to ssentences describing c s functionality and up to mmethods miinc most relevant to q. for each mikg apisumm also includes in the summary up to smost relevant sentences extracted from the reference documentation.
m figure summary example with m methods and s sentences per method class andsare customizable by the user which determine the maximum size of the summaries.
an example with m i.e.
up to three methods are included and s i.e.
each method and the class are described by two sentences is shown in figure .
for generating the summaries kg apisumm needs to relate api elements to each other and to individual sentences from the reference documentation.
the api kg captures such relationships.
.
api kg construction for constructing the apikg l we extract all the the api definitions and descriptions from l s reference documentation.
the first step in building the api kg is the extraction of structural information of the apis.
the api kg is later enriched with relationships between api elements and api descriptions.
the highlevel schema of the api kg is shown in figure which contains entities circles and their relationships arrows .
the api kg includes two parts i.e.
the structural knowledge white circles and the descriptive knowledge rectangles .
thestructural knowledge describes the structure of the apis entities e.g.
api packages classes methods fields and the signatures of the apis e.g.
parameters and return values of api methods .
it includes various api entities as well as the containment and generalization implementation relations between them.
in addition each api entity has properties such as fully qualified name added in version api documentation url etc.
the structural knowledge also describes the parameters return values thrown exceptions of methods and their types.
it also includes the seealso relation between api elements which indicates closely relevant api elements e.g.
api methods that provide similar functionalities .
thedescriptive knowledge describes the functionalities and directives of the apis.
these descriptions are expressed as natural language sentences and will be further processed in the knowledge fusion part for identifying concepts and linking them with each other and with general software concepts.
.
.
structural knowledge extraction.
api entities and their relations in the structured knowledge are extracted from class interface declarations class interface member declarations and method declarations in the api reference documentation.
we developed a web crawler which obtains the api reference documentation from thegenerating query specific class api summaries esec fse august tallinn estonia figure schema of the structural knowledge graph web.
we also developed a parser based on the structure of specific api reference documentation e.g.
jdk and android api documentations to extract api entities and their properties and relations.
note that parameters and return values are independent api elements that can be shared by multiple methods.
for example two methods may have the same return value.
methods that accept parameters or return values with the same meanings can be indirectly connected.
we determine the similarity of the parameters or return values of two methods by matching the names for parameters only types and the descriptions.
.
.
descriptive knowledge extraction.
we use the natural language text descriptions of various api elements extracted from api reference documentation as input for the descriptive knowledge extraction.
these descriptions include package class interface field method method return value and method parameter descriptions.
the extracted text descriptions are processed as follows all html tags and separate code segments are removed.
code elements mentioned in sentences are preserved.
each text description is split into sentences.
the sentences are classified into different types.
as reported by maalej and robillard about a half of the documentation units attached to api class members in jdk and .net contain information of little or no value.
the purpose of sentence classification is to exclude meaningless sentences and identify sentences relevant for different types of descriptive knowledge.
based on the findings of previous studies and our analysis of the jdk and android api reference documentations we define the following sentence types relevant for descriptive knowledge extraction.
description of the functionality of api entities.
example object used to report key and button events .
description about the usage of the api such as correct or incorrect usage situations constraints on method parameters situations of exception throwing.
example illegalargumentexception if the modifiers parameter contains invalid modifiers .
all other situations usually implementation details.
example there are two ways to programmatically determine the version number .
we use a back propagation bp neural network to train a classifier for classifying the sentences into one of the three types.
to this end we transform the sentences into the inputs to the bp neural network in the following way convert each sentence into a bag of words using standard preprocessing procedure i.e.
tokenization stop word removal and lemmatization generate a vector for each sentence by averaging the vectors of words from the sentence and use word2vec to train word vectors based on the corpus of all the sentences from the api reference documentation.
to prepare the training data we randomly select a subset of the sentences and manually label each of them into one of the three types.
the details on the training and calibration of the classifier in our implementation is presented in section .
.
finally for each sentence of an api element that is classified as or we create a hasfunctionality or hasdirective relation between the api element and the sentence.
.
.
knowledge fusion.
we link concepts referenced in the descriptions of different api elements with each other and also with concepts from more general knowledge graphs.
the these concept relationships help determining relationships between api elements and their relevance to user queries.
the descriptions of different api entities may refer to various api related concepts such as system service download system notification .
for simplicity we will refer to these concept which are referred to in api descriptions as api concepts .
identifying these concept