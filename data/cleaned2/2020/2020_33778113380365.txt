reducing run time adaptation space via analysis of possible utility bounds clay stevens university of nebraska lincoln department of computer science and engineering clay.stevens huskers.unl.eduhamid bagheri university of nebraska lincoln department of computer science and engineering bagheri unl.edu abstract self adaptive systems often employ dynamic programming or similar techniques to select optimal adaptations at run time.
these techniques suffer from the curse of dimensionality increasing the cost of run time adaptation decisions.
we propose a novel approach that improves upon the state of the art proactive self adaptation techniques to reduce the number of possible adaptations that need be considered for each run time adaptation decision.
the approach realized in a tool called thallium employs a combination of automated formal modeling techniques to i analyze a structural model of the system showing which configurations are reachable from other configurations and ii compute the utility that can be generated by the optimal adaptation over a bounded horizon in both the best and worst case scenarios.
it then constructs triangular possibility values using those optimized bounds to automatically compare adjacent adaptations for each configuration keeping only the alternatives with the best range of potential results.
the experimental results corroborate thallium s ability to significantly reduce the number of states that need to be considered with each adaptation decision freeing up vital resources at run time.
keywords formal methods self adaptive systems run time adaptation multiobjective optimization acm reference format clay stevens and hamid bagheri.
.
reducing run time adaptation space via analysis of possible utility bounds.
in 42nd international conference on software engineering icse may seoul republic of korea.
acm new york ny usa pages.
introduction self adaptive systems are becoming more pervasive particularly in applications such as autonomous vehicles and medical or iot devices .
these systems need to quickly adapt to an uncertain dynamic environment without external intervention which is especially challenging given the nearly infinite situations such environments may present the short window of time available permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
icse may seoul republic of korea copyright held by the owner author s .
publication rights licensed to acm.
acm isbn .
.
.
.
adapt and the potentially limited computing resources available for making adaptation decisions at run time.
in an ideal scenario where adaptations are instantaneous and immediately beneficial a reactive self adaptive system can respond effectively after a change in the environment has been detected.
however in cases such as provisioning a new cloud based virtual machine the adaptations enacted by the system may take some time requiring a proactive approach which can account for thelatency of adaptation tactics .
while such proactive latencyaware pla approaches promise to improve the overall fitness of the adaptations chosen they need to look ahead and predict future states of the environment.
recent approaches to pla selfadaptive systems model the environment as a stochastic process independent of the state of the system .
adaptation decisions can then be made via stochastic planning using the predictions of future states of the environment as input.
historically stochastic planning problems have been described and modeled using markov decision processes mdps which can be solved using dynamic programming to optimize some utility or cost.
if the number of distinct properties or settings available to the system to adapt is large this solution can suffer from bellman s curse of dimensionality where the number of states that must be visited and evaluated grows factorially based on the number of values that can be assumed by the variables representing the system state.
prior decision theoretic planning research has explored ways to curtail this state explosion such as minimization of mdps reachability analysis and machine learning .
however despite significant progress the adaptation space the possible state transitions that must be pondered for each run time adaptation decision is still enormous even considering only allowable adaptations.
this in turn renders dynamic run time adaptation for real world systems expensive in practice.
this is especially problematic in volatile environments like distributed pervasive systems where high volumes of routinely volatile software components often exist and coordinate in tandem.
there is thus a need for methods to facilitate efficient analysis of huge adaptation spaces.
in this paper we present a novel approach dubbed thallium1 that automatically trims the adaptation space to be explored at runtime by the underlying adaptation decision maker.
unlike all prior techniques thallium retains only the adaptations with pareto optimal potential to provide the best utility.
thallium recognizes opportunities for trimming the dynamic adaptation space by combining the state of the art structural and behavioral modeling 1thallium tl atomic number is a metallic element with very few strong lines in its emission spectrum the light produced by burning it is trimmed to only a few bands when passed through a prism.
ieee acm 42nd international conference on software engineering icse icse may seoul republic of korea clay stevens and hamid bagheri techniques for reachability analysis with a possibilistic process for bound analysis of the utility achievable from each system state.
specifically using lightweight model checking thallium analyzes the structural system model to produce a markov decision process capturing the possible adaptations from each system state.
it then employs probabilistic model checking to derive information from the behavioral system model about the bounds on the utility achievable from each state.
thallium then utilizes possibilistic analysis to resolve values representing the potential of each system state with respect to each optimization objective accounting for both the positive and negative consequences of uncertainty in the environment.
such automatically derived information is used in concert with the reachability information to spot the pareto frontier in terms of potential for the valid adaptions from each state.
pruning away non optimal or strictly dominated adaptations results in a trimmed mdp that only includes the adaptations that lead to states with the pareto optimal potential which in turn drastically reduces the analysis time for each dynamic adaptation decision.
to summarize this paper contributes effective adaptation space reduction at run time.
we introduce a novel approach for effective trimming of the adaptation space to be analyzed for each run time adaptation decision achieving remarkable speed ups in dynamic adaptation.
the novelty of our approach comes in using a possibilistic analysis to combine prior approaches in reachability analysis with an analysis of the best and worst case bounds on adapatation utility.
implementation we have realized the ideas in thallium a framework which relies on the alloy lightweight modelchecker to generate an mdp representing the allowable adaptations of the system and on the prism games extension of the prism model checker to perform the bound analysis.
we make thallium publicly available to the research and education community .
experimental evaluation we present results from experiments run on diverse subject systems rigorously replicating prominent earlier studies corroborating thallium s ability to significantly reduce the effort required for run time adaptation without sacrificing overall system utility.
in the remainder of this paper we describe the motivation and intuition behind our approach in section followed by a detailed explanation of our approach in section .
sections and cover our experiments and their results and section discusses possible threats to validity.
sections and conclude with an overview of related work followed by a summary of our contributions.
illustrative example in this section we describe the motivation and underlying insight of our research by way of an illustrative example.
we consider a publish subscribe messaging system used to monitor audio data collected from various sources where each received chunk of data must be streamed to and acknowledged by an arbitrary number of subscribers.
audio data is collected from each source by a dedicated publisher service which streams the data to a relay service for source source publisher subscriber relay source publisher publisher subscriber subscriber relay figure pub sub system example distribution to the subscribers.
an overview of the relationships of the various parts of the system is shown in figure .
each publisher can only harvest from one source and can only send data to a single relay.
each relay can only sustain a limited number of total connections or load comprising publishers subscribers and downstream relays beyond which the latency of packet delivery through that relay increases sharply.
the goal of the system is to deliver the streamed audio to each subscriber with as low a latency as possible with steep penalties associated with audio latencies above a certain threshold.
the system adapts to changes in its environment in the following ways pub as needed the system can provision a new publisher service to harvest the audio from a new or otherwise unharvested source or assign that source to a running but idle publisher.
there is a cost for each online source that is not being harvested and a cost associated with each running publisher.
provisioning a new publisher takes a non zero amount of time before the publisher starts harvesting audio from a source adding a tactic latency lp to this adaptation.
rly as needed the system can provision a new relay service for use in future connections.
each running relay service carries an attended cost for the duration of its operation whether it is serving any connections or not.
there is also some tactic latency lr involved in provisioning a new relay.
each relay also has a threshold number of active connections below which the relay is able to immediately handle data on that connection and above which all connections to that relay begin to suffer additional latency as the relay begins to buffer and switch between connections .
pub rly as needed the system can also deactivate a publisher or a relay or both .
no tactic latency is assumed here.
wait for the sake of completeness and to represent the passage of time in the case of tactics with latency the system can elect to do nothing and simply wait for the next time step.
figure shows an example mdp that represents this system.
in this markov decision process the states are labeled using a fourvalued tuple consisting of the number of publishers the number of relays the number of time steps remaining for a pub tactic and the number of time steps remaining for a rly tactic respectively.
1523reducing run time adaptation space via analysis of possible utility bounds icse may seoul republic of korea figure system mdp example publishers relays latency considering reachability only.
each adaptation decision must evaluate on the order of adaptations.
the number of publishers and of relays are both constrained to be either one or two and lp lr .
the adaptation goal in the system is to minimize the total cost of the system over time which can be computed for each time step as a function of the state of the system and the state of the environment at that time.
the system state sat time tcan be modeled as a tuple p st the number of active ready publishers p st the number of provisioned publishers including those still starting up but not yet active ready r st the number of active relays and r st the number of provisioned relays.
the environment state eat time tcan be modeled as a pair q et the number of active sources and s et the number of active subscribers.
at each time step the overall cost for that step comprises four objectives that each map the system and environment states at that time to a real value where sis the set of all system states and eis the set of all environment states the audio latency cost cl q n r a function of the current average load on each active relay s e q and the connection threshold of the relays t n where st et s et p st r st r st the publisher cost cp n r which is a function of the number of provisioned publishers p st the relay cost cr n r which is a function of the number of provisioned relays r st and the unharvested source cost cs n n r which is a function of the number of active publishers p st and the number of active sources q et .
to make the adaptation decision a dynamic programming solution would need to recursively evaluate the total cost that could be produced by starting from each relevant system configuration up to some finite look ahead horizon h and select the adaptations leading to the state with the optimal result.
hbecomes yet another multiplier on the amount of work needed.
the potentially nearly infinite values from the environment are additional multipliers figure trimmed mdp produced using thallium t s et .. q et .. .
adding a new relay is not pareto optimal given the bounds of the environment states and can be disregarded.
drastically increasing the number of possible adaptations.
to extend our pubsub example consider such a system where p st r st and lp lr .
the configuration space allows for unique configurations.
if there will be at most subscribers s st .. and at most active audio sources q st .. the space for the system andthe environment would have members.
if h quite small a dynamic programming solution must still find optimal adaptations among states.
state of the art systems such as pla sdp exploit the insight that only a subset of states are reachable via adaptation from any given state at a given time.
some adaptations such as adding and removing a publisher may be mutually exclusive.
others such as adding a relay or publisher may take a non trivial amount of time to complete.
to utilize the additional reachability information pla sdp uses lightweight model checking to exhaustively explore the structural relationships between states and construct a markov decision process mdp representing the allowable adaptations within the system.
in our example it would produce an mdp like the one shown in figure .
this reduces the number of adaptations that need to be considered at each step within the horizon down to or fewer depending on the current state.
however pla sdp may still recursively consider adaptations that would not improve the overall outcome.
if each relay in the system can simultaneously manage connections i.e.
the relay connection threshold t a single relay could easily handle all subscribers and all audio sources.
adding a second relay would only increase the cost for the number of active relays cr without reducing the latency cost cl.
given that the tactic of adding a new relay would still be reachable it would still be considered by pla sdp for each step within the horizon even though there would be no benefit to selecting such a strategy under any circumstances.
thallium aims to reduce the number of sub optimal adaptations considered by employing information about the bounds of the possible values for each objective.
in the example provided above we would consider the best case to be when there are no active subscribers or sources and the worst case to be when there are active subscribers and active sources.
in either case adding a new relay would only increase crwithout improving the cost for any other objective i.e.
it would not be pareto optimal so thallium would remove those adaptations from the consideration set.
with our assumed values the mdp produced by thallium would trim all states with more than one relay greatly reducing the adaptation space.
the final mdp for our example is shown in figure .
1524icse may seoul republic of korea clay stevens and hamid bagheri figure thallium overview approach this section presents our approach to effectively trim the adaptation space at run time.
as depicted in figure thallium comprises four automated components.
the reachability analysis component performs lightweight model checking of a provided system structural model to construct an intermediate markov decision process mdp representing the states reachable via adaptation from each system configuration.
the utility bounds analysis component leverages probabilistic model checking to analyze the behavioral system specification formalized as a stochastic multiplayer game smg .
this step automatically determines new previously unused information about guaranteed bounds of achievable utility in the best and worst case scenarios which is in turn used to define a fuzzy set of possible utility values for each optimization objective at each state.
the potential synthesis component leverages possibilistic analysis to transform the derived fuzzy sets into a single value representing the potential of each state to provide the highest utility for each objective.
finally the mdp optimization component compares the available adaptations at each node in the derived mdp apropos their potential for each objective and prunes strictly dominated adaptations from the final mdp.
thallium requires the user to specify two formal models of the system a structural model defining the states the system can assume and the transitions between them and a behavioral model specifying the behavior of the system as an smg including the probabilities of each transition for players representing the system and its operating environment.
in this paper we present examples of the structural models using alloy which allows users to model systems using a lightweight approachable syntax familiar to many developers.
we present the behavioral models as smgs defined using the prism model checker as it has been widely used in research and has extensive documentation .
these widely used familiar modeling techniques ease the burden placed on users to develop the models required for input.
.
reachability analysis to construct an intermediate mdp representation of the system thallium generates the graph of all reachable states in the system using the method described by moreno et al.
.
reachability is defined using the following predicates for system states c c c immediate transitions ri c0 c1 c1can be reached from c0 using an immediate transition i.e.
applying no tactic or one with no latency delayed transitions rd c0 c1 c1can be reached from c0 in one time interval using a delayed transition by applying a tactic with latency and transitive transitions rt c0 cn cncan be reached in one time interval using a delayed transition followed by one or more immediate transitions or more formally c1 ... cn rd c0 c1 ri c1 c2 ... ri cn cn these predicates can be used to fully define the feasible transition matrix of the system configuration mdp which requires evaluating a large number of possible combinations of tactics transitions.
to generate such a transition matrix we use alloy to formally specify both the system configuration and the reachability predicates.
alloy is a formal modeling language based on relational logic amenable to fully automated yet bounded analysis.
it facilitates representing abstract system structures and the relationships between them as a set of constraints.
once a system has been described as a collection of structural type signatures and constraints the alloy analyzer can be used to automatically find model instances that satisfy all the constraints.
three alloy specifications are conjoined to define the structural system configuration model the system state specification the tactics specification that can execute transitions between states and a trace specification that maps a configuration state to a set of other configuration states that can be reached by sequential applications of allowed tactics.
figure partially represents the system state specification for our running example cf.
section .
according to lines the systemcfg signature contains two fields activerlys andactivepubs that represent the number of active relays and publishers respectively the prog field represents the latency of any delayed tactics as a unique progress value for each tactic with latency.
the next step is to formalize the progress on each particular tactic which captures whether the tactic will reach a state succeeding the current state in the model s ordering.
such formal specification of each tactic s progress enables us to automatically compute rd.
each tactic will need a predicate definition to check whether the successor thereof can be reached in a single time interval and to model the effect of the tactic completion.
as a concrete example figure represents the addrly prog tactic progress specification.
this predicate holds between two states for transitions involving theaddrly tactic with latency.
given a concrete analysis scope that bounds the search for each top level signature in the system specification e.g.
systemcfg and prog thallium uses the alloy analysis engine to exhaustively generate all model instances that satisfy the rdpredicate.
those instances are then encoded in a lookup table for use at run time.
computing riis conducted by automatically generating traces representing the sequential applications of each no latency tactic that can be applied to transitions from one state to another.
figure represents the trace signature definition along with its predicates for theaddrly no latency tactic.
according to lines the tetrace signature contains two fields config and start tactics that represent a particular system configuration and the set of tactics needed to be started to reach that state from the preceding state in the trace respectively.
tactic specific predicates formalize both 1525reducing run time adaptation space via analysis of possible utility bounds icse may seoul republic of korea 1sig rlycount each value in the system state needs a 2sig pubcount signature to represent its domain 4abstract sig tactic tactics 5abstract sig ltactic tactics w latency extends tactic define all tactics with latency 9one sig addrly addpub extends ltactic define all instantaneous tactics 11one sig droprly droppub extends tactic each tactic with latency requires a progress value 14abstract sig prog 15sig addrly p extends prog 16sig addpub p extends prog the system configuration itself 19sig systemcfg activerlys one rlycount activepubs one pubcount prog ltactic prog every tactic in ltactic has a progress ... prog .
univ ltactic ... at most one ... prog .
prog in iden ... and each from its own domain .
prog inaddrly p prog inaddpub p figure system state specification for the pub sub example cf.
section including instantaneous tactics droprly droppub and tactics with latency addrly addpub .
latency is modeled by adding a progress field to the configuration for each tactic with latency.
1open util ordering as rlycount o 2open util ordering as addrly po 4pred addrly prog c. prog addrly po last implies if the tactic is running the predicate holds for successor states that have the next progress value c .
prog addrly po next c .
prog addrly po last implies if that is the last progress value then it holds if the relevant state value has been updated to reflect the tactic s execution c .
activerlys rlycount o next else otherwise the state value stays the same c .
activerlys c. activerlys else if the tactic is not running assert that it stays the same in the successor c .
prog addrly po last c .
activerlys c. activerlys the progress predicates can be composed sequentially to compute the actual delayed reachability predicate 24pred rd some tc systemconfig addrly prog and addpub prog figure tactic progress predicate for the pubsub example.
this predicate holds between two states for transitions involving a tactic addrly with latency.
whether a particular tactic can be applied to the current system configuration lines and the results of applying an instantaneous configuration if applicable lines .
the traces fact lines specifies which transitions from one system configuration to another are valid by composing the applications of the various1open util ordering as trace trace of sequential applications of no latency tactics 4sig te config one systemcfg start tactics set t checking whether the tactic can be applied to the current system configuration 9pred addrly ok tactic not running e. config .
prog addrly po last !
addrly ine.
start tactics !
droprly ine.
start tactics initiate the progress for the addrly tactic 15pred addrly start addrly ok e. config .
activerlys rlycount o last e .
start tactics e. start tactics addrly let c e. config c e .
config start the progress for this tactic and change nothing else c .
prog addrly po first equals ltactic addrly c. prog inc .
prog 25fact traces let fst trace first fst .
starts none all e te trace last let e next equals and equals ordroprly enact ordroppub enact oraddrly start oraddpub start figure example trace predicates to track pubsub system evolution.
the traces fact defines which transitions from one configuration to another are valid by composing the application of the tactic specific predicates.
tactic specific predicates e.g.
droprly enact andaddrly start .
thallium again uses the alloy analysis engine to obtain all valid traces i.e.
those satisfying the traces fact and capture them in a lookup table for rito be used at run time.
.
utility bounds analysis to compute the upper and lower bounds on the overall system utility achievable from a given state thallium analyzes the input behavioral model as a stochastic multiplayer game smg in which players alternate selecting transitions based on the transitions assigned probabilities.
the smg is analyzed using a probabilistic model checker as described by c mara et al.
.
the system configuration and its transitions modeled in the smg are controlled by one player and the environment s state is controlled by another player.
the players take turns selecting from the available transitions in the underlying model until the time horizon measured in discrete time steps has been reached.
depending on the properties set on the execution of the game the players can either cooperate to achieve a shared goal or compete by pursuing their own individual goals.
in the context of prismgames these properties can be expressed using the rpatl logic a branching time temporal logic based ultimately on atl .
it has been widely used for game theoretic reasoning systems involving multiple agents such as the system and environment in adaptation decisions.
our research uses both the coalition operator c adopted from atl and the reward operator c rr max ?
which is an extension of the generalized reward operator r .
this operator 1526icse may seoul republic of korea clay stevens and hamid bagheri quantifies the maximum accumulated reward rthat can be guaranteed by the players in coalition calong any paths leading to a state satisfying regardless of the actions taken by any players outside the coalition.
we use prism games to verify two properties of theupper bound for the cumulative reward and the lower bound for the cumulative reward for each reachable system configuration.
in the following formulas sysis the player representing the adaptive system envis the player representing the stochastic environment and is a predicate defining a termination state.
sys ru max ?
sys env ru max ?
property the lower bound for the cumulative reward represents the maximum utility ufor the overall system that can be guaranteed bysysalone along any path leading to a terminal state this is the worst case that can be achieved by an optimal player.
property the upper bound for the cumulative reward represents the best case for the overall system utility wherein sysandenvare working together to maximize the reward over time.
the prism games commences with a definition of both the players and the rewards based on the relevant utility functions followed by a series of modules for each set of independent i.e.
not mutually exclusive tactics and the environment evolution.
the turns are controlled by a specific module for each turn which is synchronized with the tactic modules for that turn.
the time intervals and horizon are modeled using a special clock module that keeps track of the discrete time progression.
rewards are assigned during a distinct reward turn by a corresponding module.
as a concrete example figure shows a tactic module from the pubsub behavioral model of the pubsub system.
each tactic module includes all possible outcomes for the mdp.
for example five possible outcomes for the relay module tactic have been modeled in the figure where each one is labeled using the same transition label.
this allows prism games to resolve each step in the simulation using whichever of the concurrent tactics would provide the best strategy for the coalition.
similarly each possible evolution of the environment s state must be provided as a possible choice of action for prism games which we define in a module dedicated to that evolution.
figure shows an example environment evolution module.
it represents the number of active subscribers in the pubsub system.
a similar module would be synchronized using do env to simulate the number of audio sources in the pubsub environment.
we can then resolve the lower and upper bounds for the cumulative reward as shown in equation and equation respectively.
we vary the initial system state values e.g.
init relays andinit rprog for each tactic in order to determine the worstand best case utility that can be attained over the time horizon starting from each admissible system configuration.
the admissible system configurations include configurations where the progress on a latency bearing tactic is non zero indicating that the system had started but not yet finished executing a tactic.
running the prism games models described above for each example computes a value for the properties defined in equations and .
we vary the constants used in the model to simulate starting from each possible system configuration.
this produces a best 1module relay relays init init relays relay prog init init rprog skip do nothing turn sys turn true initiate the latency bearing tactic to inc .
the value turn sys turn relays max relays relay prog min relay prog relay prog max relay prog advance the progress for the latency bearing tactic turn sys turn relay prog min relay prog relay prog relay prog finish the latency bearing tactic turn sys turn relay prog min relay prog relay prog min relay prog relays relays enact the no latency tactic to decrement the value turn sys turn relays min relay val relay prog min relay prog relays relays 23endmodule figure example tactic module from the pubsub behavioral model.
the relay module has both an instantaneous tactic to drop a relay and a tactic with latency add a relay and must keep track of tactic progress.
1module subscriber subscribers init init subs turn env turn subscribers min subs turn env turn subscribers min subs ... turn env turn subscribers max subs 7endmodule figure example environment evolution module representing the number of active subscribers in the pubsub system.
and worst case value for the cumulative utility achievable from that configuration.
we can also compute the expected value using prism by simulating the expected probabilistic reward using the roperator with no coalition of players.
those three values are interpreted to define a triangular distribution of a fuzzy value representing the membership of a utility value in the set of possible utility values for the given reward.
the worstcase value up represents the most pessimistic result possible no worse outcome is achievable so the degree of membership in the set of possible values is taken to be zero.
similarly the best case value uo is assigned a degree of membership of zero since it is themost optimistic value possible.
the expected value e u is assigned a degree of membership of one it is the most likely value and therefore should be a member of the set.
.
potential synthesis the fuzzy values generated by computing the utility bounds are then normalized and optimized to produce one value per reward per state representing the potential of that state with respect to that reward.
the key insight in computing the potential state value per reward inspired by poised is to simultaneously optimize three values from the possibility distribution by selecting a system configuration.
we define the optimization objectives as follows maximize the expected reward or minimize the expected cost ze e u 1527reducing run time adaptation space via analysis of possible utility bounds icse may seoul republic of korea figure triangular possibility distribution with optimization values zp ze zo indicated.
zeis the expected or mostlikely value zpthe down side and zothe up side .
maximize the positive consequences of uncertainty or upside potential zo uo e u and minimize the negative consequences of uncertainty or downside potential zp up e u .
figure depicts a schematic representation of the quantities involved in the calculation of the potential state value along with a triangular possibility distribution.
in order to compare two of these fuzzy sets we must be able to resolve any trade offs between the values.
for example for one configuration the value of uoor upside may be greater than that of an alternate configuration which is desirable but the value of upor downside may also be greater which is not desirable .
also the ranges for each of the three objective values may differ making direct comparison more difficult.
therefore we first normalize the values and then reframe the overall problem as a single objective optimization problem.
the values can be normalized by applying a linear normalization function zj to map the domain of each of the three objectives zj where j p e o to a value between and .
a mapped value of corresponds to the minimum value of zjand corresponds to the maximum value with a linear mapping of all intervening values .
with the values normalized we reframe the multi objective optimization problem as a single objective optimization function via optimizing an auxiliary function returning the weighted minimum of the normalized values as shown in equation with wjrepresenting the weight argmax c c where wj zjand jwj 1forj p e o by maximizing the auxiliary function we also optimize the original objectives.
thallium stores the maximized value of for each system configuration as the potential metric for each configuration and uses it in the next step for trimming the mdp transitions.
.
mdp optimization with the potential values determined for each configuration and each reward thallium can then compare adjacent transitions to determine which transitions if any can be eliminated from the generated reachability graph cf.
section .
.
thallium compares each configuration by finding which of the neighboring transitions will move the system into a state whose potential is pareto optimal with respect to all of the reward objectives rather than using a single weighted composite value representing figure example potential values for pubsub system starting from .
and are dominated by the others for every objective so the transitions to those states i.e.
adding a relay can be trimmed.
and form the pareto frontier as the former is better for cpand the latter for cswhile they are equal for clandcr.
all of the objectives.
more formally a transition tto a system configuration cwill only be retained if there is no other transition t to a different configuration c such that the potential of any of the rewards at c is greater than the same reward potential at candthe potential of all other rewards at c is at least equal to the corresponding potential at c. all other transitions will be trimmed leaving only the pareto optimal siblings to be considered when selecting adaptations.
an example using the pubsub system from section is shown in figure which shows potential values from starting state .
the and states are dominated by the others for every objective so adaptations to those states i.e.
adding a relay can be trimmed.
the and states form the pareto frontier since the former is better for cpand the latter for cswhile they are equal for clandcr.
the resulting trimmed mdp produced by thallium is then used at run time to facilitate efficient adaptation decision making without sacrificing the overall system utility.
evaluation our evaluation of thallium addresses these questions rq1 how well does thallium perform in reducing the adaptation space both offline and at run time?
rq2 does thallium provide comparable utility for the system compared to the state of the art approaches?
to answer these questions we have designed and conducted experiments using the apparatus we developed based on the presented approach.
thallium uses the alloy analyzer version .
to model the system configuration and generate the system mdp and the prism games extension of the prism model checker version .
to determine the utilities of the best worst and most possible cases.
we developed thallium as a custom java program which generates possibility values and trims sub optimal adaptations from the system configuration mdp.
.
experimental subjects we used two exemplar systems each from a separate domain for our experiments swim a simulator of self adaptive web infrastructure and dart a system that simulates a team of unmanned aerial vehicles uavs detecting targets while avoiding threats during a reconnaissance mission.
these systems are described in more detail below.
1528icse may seoul republic of korea clay stevens and hamid bagheri swim our first experimental subject is swim simulator of web infrastructure and management a self adaptive system designed to simulate a load balanced web application.
the system supports adding or removing servers as well as controlling a dimmer setting that regulates the level of content returned for each request.
swim is implemented on top of omnet a discrete event simulation environment and simulates only the high level processing of web requests as computational work.
the system is highly extensible providing monitoring information about the current state of the simulation and effectors to simulate the execution of tactics.
we define swim s system configuration ci c during an arbitrary discrete time step i as the tuple si di i where sirepresents the number of active servers direpresents the setting of the dimmer which increases or decreases the percentage of optional content with a corresponding decrease or increase to the service rate respectively and irepresents the number of time steps remaining for an active tactic execution.
the environment state ei for the same time step represents the number of web requests that arrived at the server during that time step.
the adaptation goals of the swim system are to minimize the average response time minimize the server provisioning costs and maximize the percentage of optional content delivered.
dart as the second experimental subject we use the dart self adaptive system developed by the carnegie mellon software engineering institute .
dart simulates a team of uavs flying a reconnaissance mission in formation over a bounded hostile environment containing both reconnaissance targets and enemy threats.
one of the drones is designated as the leader and autonomously decides the actions the team should undertake in order to fulfill the mission goals such as changing altitude or formation.
in our experimental scenario the team flies along a planned route of d equal segments at a constant rate using a downward facing sensor to detect as many targets as possible while avoiding destruction from any threats.
both the number and location of the targets and threats are static but unknown at the beginning of the run.
due to that uncertainty the team must self adapt by changing altitude or formation to maximize the number of targets safely detected.
flying at a lower altitude increases the probability of detecting a target but also increases the chance of being destroyed by a threat.
similarly flying in a loose formation provides better target detection while a tight formation decreases the probability of destruction.
.
experimental design to address our research questions we compared thallium with the state of the art technique in proactive latency aware self adaptation namely pla sdp .
we conducted three experiments on our exemplar systems.
for each we applied both pla sdp and thallium to construct mdps for the system.
the mdp generated by pla sdp for each system was considered a baseline for each of the three experiments against which we compared the relevant outcomes using the trimmed mdps produced by thallium.
all three experiments were run on a macbook pro with a .
ghz intel core i5 processor and gb of ram.
experiment .
for the first experiment we sought to evaluate thallium s effectiveness at reducing the size of the static adaptation figure percentage of adaptations trimmed by thallium from baseline pla sdp mdp for each evaluated system using different values for wp we wo see section .
space represented by the system mdp.
both pla sdp and thallium rely heavily upon the modeling choices and utility functions specified with the structural and behavioral models provided as input but thallium also introduces additional configuration the weights assigned to the optimization objectives during potential synthesis see section .
.
as such we used thallium to generate multiple mdps for each system with different weights for each.
we compared the number of transitions in each of the those resulting mdps to the number of transitions in the baseline mdp reporting the outcome as a percentage reduction compared to the baseline.
experiments and .
for the second and third experiments we executed simulators included with the swim and dart exemplars respectively.
we tested the number of adaptations dynamically evaluated at run time and the overall system utility achieved when adapting based on the baseline mdp vs. a trimmed mdp generated by thallium.
we varied the adaptation manager provided to guide adaptation either the mdp from pla sdp or thallium and measured the number of adaptations evaluated during each run time adaptation decision and the overall utility measurement relevant to each exemplar.
in addition we introduced a purely reactive adaptation manager to serve as a third comparison for experiment detailed in section .
.
.
experiment static mdp trimming for our first experiment we evaluated thallium s effectiveness in reducing the size of the static adaptation space compared to plasdp for each of our exemplar systems.
as discussed in section .
the potential value generated for each system state and used for the pareto optimization is synthesized by normalizing and optimizing the three values from a triangular possibility distribution zp ze zo each with a corresponding weight.
since the weighting needs to be specified by the user we also sought to quantify the impact of the weighting on the reduction of the adaptation space.
therefore we ran thallium on each exemplar system using each of sixteen valid weight assignments ranging from equal weighting to exclusively considering a single value.
figure summarizes the results for each system and each weighting reporting the percentage of allowable adaptations trimmed by thallium compared to the number in the mdp generated by pla sdp.
1529reducing run time adaptation space via analysis of possible utility bounds icse may seoul republic of korea a num.
adaptations evaluated for each adaptation decision b cumulative system utility figure comparing thallium and the state of the art pla sdp technique for the swim self adaptive system .
thallium a reduces the number of adaptations considered by .
and b achieves higher cumulative utility.
for the swim exemplar pla sdp generated a total of possible system configurations connected by admissible adaptations.
the model provided to the utility bounds analysis component was drawn from a real world trace of tcp activity published by clarknet which fluctuated between and requests per period.
thallium trimmed between and adaptations from consideration reducing the adaptation space by between .
and .
as shown in figure .
averaged across all weight settings thallium reduced the number of adaptations for swim by .
.
for dart pla sdp devised system configuration states with admissible adaptations thallium reduced that number by an average of .
trimming between and adaptations.
overall the differing weights in all cases produced only a small variation in the number of adaptations trimmed from the baseline mdp consistently hewing close to the mean.
for swim the relative standard error in the percentage of adaptations trimmed across all weightings was only for dart it was .
for each weighting evaluated thallium consistently trimmed adaptations when compared to pla sdp and all of the tests across all the subject systems resulted in a reduction of the adaptation space.
.
experiment swim simulation our second experiment evaluated thallium s impact at run time through the use of the swim network simulator.
the experiment measures two values the number of adaptations evaluated as a mean adaptations evaluated per simulation.
b cum.
num.
successful simulations.
figure comparing thallium and the state of the art pla sdp technique over the dart self adaptive system.
thallium a reduces the number of adaptations considered by .
and b produces more successful simulation runs.
part of each adaptation decision and the overall cumulative utility reported by the simulator.
the results for both measurements are summarized in figure .
for the first number of adaptations evaluated we found large differences in the number of run time comparisons performed using each approach during adaptation decisions.
figure a shows the number of joint system environment states to which adaptation was evaluated.
the adaptation manager based on pla sdp averaged comparisons per adaptation decision.
this number is much higher than the adaptations present in the system mdp generated by pla sdp as the look ahead done by the proactive manager and the uncertainty in intertwined environmental states balloons that number in order to fully evaluate each possible adaptation at run time.
thallium cuts that number in half to run time comparisons a reduction of .
for each adaptation decision.
figure b summarizes the overall system utility determined by the swim simulator for pla sdp and thallium.
pla sdp generated a cumulative utility value of over the course of the trace while thallium achieved a higher cumulative utility total with a final tally of .
the difference in the observed cumulative utility between pla sdp and thallium becomes more and more pronounced as the execution time increases.
alongside pla sdp and thallium we also assessed a third purely reactive adaptation mechanism that responded to the observed response time not shown .
the reactive manager frequently violated the 1530icse may seoul republic of korea clay stevens and hamid bagheri millisecond response time threshold imposed by the simulator s utility function resulting in a negative cumulative utility due to the accrued penalties.
.
experiment dart simulation our third experiment evaluated thallium s impact at run time through the use of the dartsim simulator of the dart system.
the simulator plotted the course of a drone team over a randomlygenerated step course containing four targets and six threats allowing the drones to adopt two formations and one of five altitudes.
figure depicts the results of experiments conducted over such courses.
according to the experimental results a remarkable reduction in the number of adaptations evaluated at run time is observed when using thallium.
dart with pla sdp performed comparisons per evaluation on average across the simulated evaluation periods whereas thallium compared an average of only joint states .
fewer .
for overall utility dart determines whether or not each mission was an overall success i.e.
the team was not destroyed andit detected at least half of the targets.
figure b summarizes the successful missions by both pla sdp and thallium.
the success rate achieved by thallium is noticeably higher than that of pla sdp.
specifically out of the runs pla sdp resulted in successful missions total whereas thallium was successful in .
discussion this section details our interpretation of the results obtained with respect to each research question and presents some limitations.
.
rq1 adaptation space reduction all three experiments contributed some data to address rq1 which questioned thallium s efficacy at reducing the adaptation space compared to state of the art techniques.
experiment evaluated the reduction in the number of adaptations represented in the static model of each exemplar.
in all cases cf.
figure thallium successfully reduced the number of adaptations compared to pla sdp with an average reduction of .
for swim and .
for dart.
furthermore these results show that thallium consistently reduces the adaptation space even as the weightings for the potential synthesis vary.
the relative standard error for each exemplar was quite low for swim and for dart indicating that thallium provides a robust improvement no matter the specific tuning of its additional input parameters.
also as shown in experiments and cf.
figures a and a respectively thallium significantly cuts the number of run time comparisons done during the adaptation decision.
for swim the number is cut in half .
from to comparisons.
we observed the same trend with dart where thallium compared only joint states rather than .
fewer .
we interpret these data as supporting our insight that information about the bounds of possible utility can be employed to reduce the explosion of the adaptation space.
.
rq2 overall utility of adaptation strategy our next criterion was the overall utility achieved by each technique.
experiments and collected data on the utility by simulating the swim and dart exemplars respectively.
as shown in figures b and b thallium produced higher cumulative system utility for the swim simulation compared to pla sdp as well as more total successes among the simulated missions run with the dart simulator for thallium vs. for pla sdp .
we interpret this data as suggesting that thallium despite significantly trimming the search space provides better overall utility compared to the state of the art techniques in selfadaptation.
.
limitations extending our work to apply to other systems and situations is subject to a few limitations.
first thallium is specifically targeted to reducing the state space in solutions that operate on a markov decision process constructed to represent the structure of the system itself independent of the stochastic environment.
systems where the two are not independent would require a modification to this approach but the underlying insight of trimming a graph based problem space should still apply.
second thallium is most suitable in situations where there is a trade off in the choice between objectives.
if one objective tends to dominate the others there are fewer opportunities to trim the search space.
third as described in section .
thallium and similar formal analysis techniques such as pla sdp are heavily dependent on models of the system both structural and behavioral and the utility functions provided as part of the world specified by the user.
the models obviously must represent the system with a high fidelity in order to provide correct results but checking the models for correctness is beyond the scope of this paper.
as an example of the impact of the utility function the swim simulation used in our evaluation solved the underlying decision problem using a weighted sum of three optimization objectives a cost based on the number of provisioned servers a reward for having a higher dimmer value delivering more optional content and a reward for a low response time.
following moreno et al.
those objectives were weighted as .
.
and .
respectively.
in our evaluation this led to both pla sdp andthallium immediately reducing the dimmer to the lowest level in order to gain the benefit to the service rate.
while that may seem like a surprising strategy it makes perfect sense given the lack of a penalty.
while our evaluation shows thallium s general applicability in reducing adaptation space specific outcomes are very sensitive to manual parameter tuning of this sort as are other similar approaches such as pla sdp .
threats to validity the internal validity of these results relies on the correctness of our custom implementation of part of the approach particularly the components used to optimize and generate the metric for each node s potential section .
and that used to compare and trim the output mdp using pareto analysis section .
.
conceptually our possibilistic analysis was based directly on prior research and comparing multiple objectives to determine pareto optimality is a well known problem.
therefore our correctness would only 1531reducing run time adaptation space via analysis of possible utility bounds icse may seoul republic of korea be threatened due to the skill of the implementer.
to address this concern we thoroughly validated all of our tool components to ensure their correctness.
moreover by using the same objects as our baseline systems we can compare the results produced by thallium with those previously reported to help ensure correctness at the potential cost of external validity.
while these systems are small and exhibit only a limited number of available adaptations for each decision point we believe that they are representative of real world self adaptive systems e.g.
autonomous load balancers .
we also believe that systems with more choices at each step would see even more benefit from our approach as they have more potential states to trim.
we intend to explore larger systems in future work on this topic.
related work many studies have utilized structural or architectural models to drive self adaptation including proactive self adaptation .
in particular thallium is largely founded on the research done by moreno et al.
and c mara et al.
on proactive latency aware self adaptive systems.
the pla sdp system used as a baseline for our evaluation was drawn from this body of work .
that approach pioneered the modeling of the reachable states in a self adaptive system which our approach improves upon.
rather than relying only on reachability thallium also leverages information about the bounds of possible utility to evaluate the potential of each state.
this bound information is extracted from the behavioral model by simulating a stochastic multiplayer game as described by c mara et al.
.
while they use the bound information simply as a verification technique thallium includes that additional information about the possible behavior of the system as a way to improve overall adaptation decision making.
esfahani et al.
use the mathematics of fuzzy sets and possibility theory to evaluate the likelihood each system state presents to satisfy the requirements of the system.
in their work they establish the bounds of the fuzzy sets using confidence intervals on the probability distribution for each uncertain element gathered from observation or stakeholder interviews.
our approach is novel in determining the bounds instead based on the guarantees from the behavioral model.
thallium addresses the adaptation state explosion by analyzing the bounds but there are other approaches to reducing the space.
quin et al.
recently propose an approach that adds a learning module to the mape k loop to select subsets of adaptations for consideration at run time.
fusion also uses learning to reduce the adaptation space as well as integer programming solvers to solve the underlying optimization problem.
learning based approaches could be employed on the reduced adaptation space from thallium suggesting future research in combining the approaches.
plato and valkyrie employ evolutionary algorithms to solve single objective optimization problems.
pascual et al.
present an approach to using multi objective evolutionary algorithms moeas to optimize configurations for dynamic software product lines.
femosaa also utilizes moeas to select configurations but improves upon previous work by giving preference to knee solutions along the pareto frontier.
knee solutions may provide a better balance of objectives for the final solution.
identifyingknee solutions while trimming transitions is a possible avenue for future research with thallium.
conclusion and future work in this paper we presented thallium a novel technique to reduce the number of possible system configurations that need be considered for a self adaptive system to make adaptation decisions at run time.
thallium improves upon prior research in proactive latency aware self adaptation by using probabilistic model checking to glean information about the bounds of system behavior.
we find a value representing each state s potential through possibilistic analysis and trim all transitions to states that are strictly dominated by neighboring states across all objectives.
in the experiments conducted over the self adaptive systems drawn from recent studies thallium was shown to significantly trim the transitions under consideration.
the experimental results further corroborate that thallium despite considerably shrinking the search space features higher overall utilities for all the systems under analysis compared to the state of the art techniques.
in future research we hope to evaluate the approach we have taken with thallium in different domains and extend the approach to leverage new and different analysis techniques.
we also hope to explore additional related techniques to further reduce the decision space for self adaptive systems.
trade off analysis provides a potentially fruitful avenue for further research related to thallium.
these analysis techniques often utilize formal models to synthesize a set of possible system architectures or design choices and optimize among competing objectives to select a set of candidates to present to a user.
while static analysis of the tradeoffs can often be done cheaply a full dynamic analysis can be more expensive.
the behavioral and possibilistic analysis done by thallium could possibly be employed to eliminate some candidate systems a priori before performing the expensive dynamic analysis.
similarly self adaptive systems may benefit from techniques developed for evolutionary trade off analysis.
these may include static or dynamic analysis of the system that can provide additional information to the bound analysis done by thallium .
any new information generated by such techniques will also help to reduce the run time burden on the system.
lastly our presentation of thallium demonstrated using a pareto analysis to trim dominated adaptations from the search space.
other techniques also exist to perform such a multi objective optimization including game theoretic or stochastic approaches.
depending on the level of trimming desired from the system different heuristic could be applied to further reduce the number of adaptations considered at runtime.
we would like to further explore these types of analysis which we believe would complement thallium s use of the bound information.
we have made thallium as well as the specifications used in conducting our experiments publicly available for use by other researchers .
acknowledgment we would like to thank the anonymous reviewers for their valuable comments.
this work was supported in part by awards ccf1755890 and ccf from the national science foundation.
1532icse may seoul republic of korea clay stevens and hamid bagheri