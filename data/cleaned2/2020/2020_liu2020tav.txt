towards automated verificationofsmartcontract fairness ye liu li0003ye ntu.edu.sg nanyang technologicaluniversity singaporeyili yi li ntu.edu.sg nanyang technologicaluniversity singapore shang wei lin shang wei.lin ntu.edu.sg nanyang technologicaluniversity singaporerongzhao rong.zhao ntu.edu.sg nanyang technologicaluniversity singapore abstract smart contracts are computer programs allowing users to define and execute transactions automatically on top of the blockchain platform.
many of such smart contracts can be viewed as games.
a game likecontractacceptsinputsfrommultipleparticipants and upon ending automatically derives an outcome while distributing assets according to some predefined rules.
without clear understandingofthegamerules participantsmaysufferfromfraudulent advertisements and financial losses.
in this paper we present a framework to perform semi automated verification of smart contract fairness whose results can be used to refute false claims with concreteexamplesorcertifycontractimplementationswithrespect to desired fairness properties.
we implement faircon which is able tocheck fairnesspropertiesincludingtruthfulness efficiency optimality and collusion freeness for ethereum smart contracts.
weevaluate faircon onasetofreal worldbenchmarksandthe experimentresultindicatesthat faircon iseffectiveindetecting property violations and able to prove fairness for common types of contracts.
ccs concepts softwareanditsengineering softwareverification software verification andvalidation .
keywords smartcontract fairness mechanismdesign.
acmreference format ye liu yi li shang wei lin and rong zhao.
.
towards automated verificationofsmartcontractfairness.in proceedingsofthe28thacmjoint europeansoftwareengineeringconferenceandsymposiumonthefoundationsofsoftwareengineering esec fse november8 13 virtual event usa.
acm new york ny usa 12pages.
.
permissionto make digitalor hard copies of allorpart ofthis work for personalor classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
esec fse november 8 13 virtual event usa associationfor computing machinery.
acm isbn ... .
introduction theblockchaintechnologyhasbeendevelopedrapidlyinrecent years since the introduction of bitcoin by nakamoto in .
thedistributedandtamper resistantnatureofblockchainhasmade it the perfect platform for hosting smart contracts.
smart contractsarecomputerprogramsrunningatopblockchainplatforms to manage large sums of money carry out transactions of assets andgovernthetransferofdigitalrightsbetweenmultipleparties.
ethereum andeos areamongthemostpopularblockchain platforms which support smart contracts and have them applied in many areas.
as of february there are over one million smart contracts deployed on ethereum which is a fold increase since just two years ago.
these smart contracts have enabled about .7k decentralized applications dapps serving 20k daily users on finance health governance gambling games etc.
the security of smart contracts has been at the center of attention ever since their adoption in the management of massive monetary transactions.
one of the most notorious cases is the daoattack onethereum whichresultedinalossof 60millionworth duetothe reentrancyvulnerability beingexploitedby malicious attackers.
several gambling games on eos including eos.win andeosplay were recently hacked using a technique calledthe transactioncongestionattack andledtosignificant asset loss.
what these incidents share in common is that certain security vulnerabilities neglected during contract development are exploited by malicious parties causing a loss for the contract owners andpossiblyotherhonestparticipants .thesevulnerabilities areprogrammingerrors indicatingamismatchbetweenthecontractdevelopers expectationsandhowthecontractcodeactually works.
they areeasy to detect oncethe vulnerabilitypatterns are recognized.infact muchresearchhasbeendedicatedtopreventing discovering andmitigating such attacks.
in contrast the fairnessissues of smart contracts have not yet attractedmuchattention.asmartcontractisunfairtocertainparticipantsifthereisamismatchbetweentheparticipants expectations and the actual implementation of the game rules.
it is possible that amalicious partymay gainan advantageoverothersthroughthe exploitationofsecurityvulnerabilities e.g.
examiningotherparticipants actionsinasealedgame.inthispaper wewouldliketofocus more on the fairness issues introduced by the logical design of the contracts instead which are orthogonaltothe security issues.
for example smart contracts may well be advertised as social games with apromised return for any investment but turn out to be ponzischemes .inthiscase thepossibilitythatthegamemay 666esec fse november8 virtualevent usa ye liu yili shang weilin androng zhao eventually slowdownandnever payback isintentionallyleft out.
similarly many auction dapps claim to be safe and fair yet it is stillpossibleforbidderstocolludeamongthemselvesorwiththe auctioneer to make aprofit at the expenses of the others .
the fairness issues mostly reside in contract logic some of them are unfairbydesign whiletherestarecarelessmistakes.thismakes thedetectionofsuchissuesparticularlychallenging becauseevery case can be different and there is no hope in identifying predefined patterns.
sinceitisoften notthecontractcreators interestatrisk or even worse when they gain at the expenses of participants thereislittleincentiveforthemtoallocateresourcesinensuring thefairnessoftheircontracts.ontheotherhand itisratherdifficult for inexperienced users to tell whether a contract works as advertised even withthe sourcecode available.
inthispaper wepresent faircon aframeworkforverifyingfairness properties of smart contracts.
since general fairness is largely asubjectiveconceptdeterminedbypersonalpreferences thereis no universal truth when considering only a single participant.
we view a smart contract as a game or mechanism which accepts inputs from multiple participants and after a period of timedecidestheoutcomeaccordingtosomepredefinedrules.upon game ending each participant receives certain utility depending on the game outcome.
with such a mechanism model we can then verifyawiderangeofwell studiedfairnessproperties including truthfulness efficiency optimality andcollusion freeness .itisalso possible to definecustomizedpropertiesbasedonspecific needs.
therealchallengeinbuildingthefairnessverificationframework is onhow to translatearbitrary smart contract code into standard mechanism models.
our solution to this is to have an intermediate representationforeachtypeofgames whichhasdirectsemantic translationtotheunderlyingmechanismmodel.forinstance the keycomponentsinanauctionaredefinedbythesetofbidders their bids and the allocation and clear price rules of the goods in sale.
to synthesize the intermediate mechanism model for an auction smartcontract wefirstmanuallyinstrumentthecontractcodewith customized labels highlighting the relevant components.
then we perform automated symbolic execution on the instrumented contracttoobtainsymbolicrepresentationsforauctionoutcomes in terms of the actions from a bounded number of bidders.
this is finally mapped to standard mechanism models where fairness properties can be checked.
we either find property violations with concretecounterexamplesorareabletoshowsatisfactionwithin theboundedmodel.forpropertiesofwhichwedonotfindviolation weattempttoprovethemforunboundednumberofparticipants on the original contract code with program invariants observed from the boundedcases.
by introducing the intermediate representations we could keep theunderlyingmechanismmodelandpropertycheckingenginestable.wedefinedanintermediatelanguagefortwotypesofgame like contracts popular on ethereum i.e.
auction and voting.
we implementedfaircon toworkonethereumsmartcontractsandapplied it on real auction and voting contracts from etherscan .
the effortofmanuallabelingisreasonablylow consideringthestructuralsimilarityofsuchcontracts.theexperimentalresultsshow thattherearemanysmartcontractsviolatingfairnesspropertyand faircon is effective to verify fairness property and meanwhile achieves relativelyhigh efficiency.contributions.
our main contributions are summarized as follows.
weproposedageneralfairnessverificationframework faircon to check fairness properties of smart contracts.
in particular we demonstrated faircon on two types of contracts and four types offairnessproperties.
we defined intermediate representations for auction andvoting contracts anddesigneda semi automatedapproachtotranslate contractsourcecodeintomathematicalmechanismmodelswhich enable fairnessproperty checking.
in addition to discovering propertyviolations forbounded models weapplyformalverificationtoprovesatisfactionofproperties for the unboundedcasesas well.
we implemented faircon and evaluated it on real world ethereum smart contracts.
the results show that faircon is abletoeffectivelydetectfairnessviolationsandprovefairness propertiesforcommontypesofgame likecontracts.thedataset rawresults andprototypeused areavailableonline org .
n9 0bevrt .
organizations.
the rest of the paper is organized as follows.
section2illustratestheworkflowof faircon withanexample.section3presentsa general mechanismanalysis model and definesa modeling language customized for auction and voting contracts serving as an intermediate representation between the contract source code and the underlying mechanism model.
we then describe the model construction and fairness checking as well as verification techniques in sect.
.
section5gives details on the implementation and presents the evaluation results.
sections 6and7 compare faircon withtherelatedworkandconcludethepaper respectively.
fairconby example in this section we use an auction contract to illustrate how our approachworksinconstructingtheintermediatemechanismmodel andverifying fairnessproperties.
example2.
.
figure1showsasimplifiedethereumsmartcontract named cryptoromeauction written in solidity taken frometherscan .1the contract implements a variant of open englishauctionforablockchain basedstrategygame whereplayers areallowedtobuyvirtuallandswithcryptocurrencies.theauction isgivenapredefinedlifecycleparameterizedbystartandendtimes.
a participant can place a bid by sending a message to this contract indicatingthevalueofthebid.theaddressoftheparticipantand thebidamountarestoredinvariables msg.sender andmsg.value respectively.
the address of the current highest bidder is recorded inhighestbidder line9 andamapping refunds isusedtokeep thecontributionsofeachparticipant line10 forpossiblerefunding later.
the bid function lines 11 21 is triggered upon receiving the message.the bid isrejected if thebid amount isno more than thesumofthecurrenthighestbidandtheminimalincrementvalue duration lines13 15 .otherwise theprevious highestbidder getsa refund lines16 18 and the highestbidder line19 and highestbid line are updatedaccordingly.
667towardsautomatedverification of smartcontract fairness esec fse november8 virtualevent usa 1contract cryptoromeauction faircon annocations individual msg.sender msg.value value allocate highestbidder price highestbid outcome bid 8uint256 publichighestbid 9address payable publichighestbidder 10mapping address uint refunds 11function bid public payable 12uintduration 13if msg.value highestbid duration revert 16if highestbid !
refunds highestbid 19highestbidder msg.sender 20highestbid msg.value figure the cryptoromeauction soliditysource code.
table example instancesofcryptoromeauction.
truthful untruthful collusion bidder p1p2p3p1p2p3p1p2p3 valuation bid allocation price utility threatstocontractfairness.
onewaythat cryptoromeauction can become unfair to the participants is through the so called shill bidding ashilltriestoescalatethepricewithoutanyintention of buying the item.
this can be induced by either the auctioneer or adversarialparticipants andotherbiddersmayneedtopaymoreas a result.
occasionally theshill wins theauction ifnootherhigher bid comes before auction ends.
the item may then be sold again at alatertime.
apartfromshillbidding thereareanumberofotherwell studied properties from the game theory and mechanism design literature which can be used to evaluate the fairness of an auction.
we use theexampleinstancesshownintable 1todemonstrate.suppose there are three bidders p1 p2 andp3 participating in the auction.each ofthemhas avaluation of the item i.e.
the item worth three four and six units of utility for p1 p2 andp3 respectively.
thecolumns truthful untruthful and collusion intable show the three example scenarios where the players act truthfully untruthfully and collude among themselves.
the rows bid allocation price and utility show the bids placed the final allocation oftheitem theclear price and theutilitiesobtained by the bidders respectively.
same as other first price auction schemes cryptoromeauction is nottruthful i.e.
bidding truthfully according to one s own valuation of the item is not a dominant strategy.
in the ideal truthful scenario all bidders bid according to their valuations and p3wins thebidwithautilityofzero becausethepaymentequalstohis hercryptoromeauction ms sender ms value ms sender ms value ms sender ms value assume not ms value ms value and not ms value ms value allocate argmax ms value ms value ms value price max ms value ms value ms value figure the mechanism model of cryptoromeauction with three bidders.
valuationoftheitem.inanotherscenario where p3bidsfive untruthfully his her utility would increase by one because of the lower clear price.
this is called bid shading which only affects the revenue from the auction in this example but may affect other participants utilities insomeothercases.
in the third scenario p2andp3collude in order to gain extra profits.withfullknowledgeofeachother svaluations p2andp3 maydecidetoformacartelandperformbidshading.onepossibility istohave p2forfeithis herchanceand p3bidsfour andtheydivide theprofitequallyamongthemselves.eachofthemgainsoneunit ofutilityas aresult.
checking fairness properties.
given a mechanism model abstracting the auction settings the set of fairness properties are well definedandcanbeformallyspecifiedbasedonthemodel.the mainchallengeremainsonhowtoextracttheunderlyingmechanismmodelfromthesmartcontractsourcecode.nowweillustrate how this is done for cryptoromeauction infaircon and outline the process of automated property checking as well as verification.
albeitvariations inimplementations all auction contractsshare somecommoncomponents suchasthebidders identifiers their bids and the allocation as well as clear price rules.
we rely on users to provide annotations for these components directly on the source code which are demonstrated on lines 2 7 in fig.
.
specifically theannotationsspecifythebidders informationasatuple individual msg.sender msg.value indicatingthevariables usedtostoretheidentifierandthebidvalue respectively.similarly allocation highestbidder and price highestbid indicate that the allocation result and the clear price are stored in highestbidder andhighestbid respectively.finally outcome isusedto label the function defining the auctionallocation logic.
with these labels we perform symbolic execution on the bid function treating the participants inputs msg.value as symbolicvariables .theresultofthiswouldbetwosymbolicexpressions for both highestbidder andhighestbid which symbolicallyrepresenttheallocationandclearpricefunctions respectively.
wecanthenusetheseinformationtosynthesizeanintermediate mechanism model shown in fig.
.
the model is specified in a customizedlanguagedesignedforauctionandvotingcontracts.details ofthelanguagesyntaxandsemanticscanbefoundinsect.
.atthe highlevel themodelspecifiesinformationoftheparticipatingindividuals and the auction rules we consider a bounded model with onlythreebidders i.e.
ms sender ms sender andms sender their bids have to satisfy the constraint specified in the assume clause the allocation function is given as argmax ms value 668esec fse november8 virtualevent usa ye liu yili shang weilin androng zhao ms value ms value and the clear price function is given as max ms value ms value ms value .
the intermediate mechanism model in fig.
2has well defined mathematical semantics which can be used to check the desired fairness properties.
we encode both the model and the property withansmtformulasuchthatacounterexampleexistsifandonly if the formula is satisfiable.
more details on the encoding can be foundinsect.
.
.iftheformulaisunsatisfiable weareconfident that the property holds for the bounded case with three bidders.
wethenattempttoprovethepropertybyinstrumentingthecontract program with program invariants encoding the allocation and clear price clauses synthesized previously but parameterized by an unbounded number of bidders.
the instrumented program and thepropertyarethenpassedtoaprogramverificationtool suchas dafny to perform the automatedverification.
the analysisframeworkforsmart contractfairness inthissection wefirstprovidenecessarybackgroundanddefinitions on mechanism models and fairness properties well studied inthemechanismdesignliterature .thenwegivetheabstract syntax and semantics of our mechanism modeling language to support automatedmodelconstruction andproperty checking.
.
smartcontractsas mechanism models mechanismdesignisusedtodesigneconomicmechanismsorincentivesto helpattain thegoalsofdifferentstakeholders whoparticipate in the designated activity.
the goals are mainly related to the outcomethatcouldbedescribedbyparticipants payoffandtheir returnintheactivity.wemodelthelogicbehindsmartcontracts withamathematical objectknownas the mechanism.
inamechanismmodel wehaveafinitenumberofindividuals denoted by n ... n .
each individual iholds a piece of privateinformationrepresentedbya type denoted i i.letthe types of all individuals be 1 ... n and the space be i i. the individuals report possibly dishonestly a type strategy profile .
based on everyone s report the mechanism model decides an outcome which is specified by an allocation function d mapsto o and atransfer function t mapsto rn whereo oi n ioi isthe setofpossible outcomes.
the preferences of an individual over the outcomes are representedusinga valuationfunction vi o i mapsto r.thus vi o i denotes the benefit that individual iof type ireceives from an outcome o o andvi o i vi o i indicates that individual iprefersotoo .
the individual i s utility under strategy profile is calculated by subtracting the payment to be made from the valuation ofacertainoutcome ui vi i ti .
.
fairnessproperties thefairnessofsmartcontractsisusuallysubjecttotheunderstandings and preferences of the participating parties a contract fair to someone may be unfair to the others.
in particular fairness can be consideredfromboththeparticipants andthecontractcreators points of view.
to capture such nuances individual parties have to be modeled separately before such subjective fairness properties can be specifiedagainst the model.generally speaking all properties which can be expressed in termsofthemechanismmodeldefinedinsect.
.1aresupported byourreasoningframework.tokeepthepresentationsimple in this paper we focus on analyzing a set of generic fairness propertiesbasedonthemechanismmodels.werestrictthediscussion to four types of well studied properties in the literature namely truthfulness optimality efficiency andcollusion freeness.
toformallydefinetheproperties wefirstintroduceanimportant concept dominant strategy .
we use ito denote the strategy profile of the individuals other than i i.e.
1 ... i i ... n .therefore i i isusedtodenotethestrategyprofilewhich differsfrom only on i. definition .
dominant strategy .
a strategy i iis a dominantstrategyfor i if i i i ui i i ui i i .when equalityholds the strategy isaweakdominant strategy.
we say that a mechanism model is truthful if and only if for anyindividualandstrategyprofile reportingone srealtype truthtelling i.e.
i n i i isadominant strategy.
definition3.
truthfulness .
formally amechanismistruthful if andonly if i i i ui i i ui i i .
givenan auction smart contract with manybidderscompeting forasingleindivisiblegood theaccountwhichcreatesthecontract istheauctioneer andtheaccountswhichjointheauctionarethe bidders.
if the auction prevents bidders from benefiting more by bidding less it is truthful.
when bidding untruthfully is not a good strategy the auction can generally attract more honest bidders and the auctioneer can gethigher revenue for the goodonsale.
definition3.
efficiency .
wesayamechanismisefficientifand only if its allocation function achieves maximum total value i.e.
d summationtext.
ivi d i summationtext.
ivi d i .
suppose no bidder can affect any other bidder s valuation.
if the onlywinneristhebidderwhovaluesthegoodthemost theauction isefficient.
definition .
optimality .
we say a mechanism is optimal if and only if its transfer function achieves maximum total net profit i.e.
t summationtext.
iti summationtext.
it i .
similarly if the winner is the one who bids the highest the auction is optimal.
in this case the auctioneer receives the highest revenue.
we use ijto denote the strategy profile of individuals other thaniandj i.e.
1 ... i i ... j j ... n .
definition3.
collusionfree .
wesayamechanismis2 collusion free if there does not exist a cartel of individuals iandj whose untruthfulstrategiesincreasethegrouputility formally ui i j ij uj i j ij ui i j ij uj i j ij .
collusion is a big concern in auction and other multi player games.thebasic2 collusionfreenesspropertyinanauctionmeans thatany twobidders collusion cannothelp them achieve higher gain.thispreventsbidpricemanipulationtoacertainextent which helps guarantee fair chance for allbidders andmaintain goodrevenue for the auctioneer.
a more general version i.e.
n collusion freeness can be definedinasimilar way.
669towardsautomatedverification of smartcontract fairness esec fse november8 virtualevent usa individual id s bid n val n func max argmax exp individual .id individual .bid n exp exp func exp bool exp exp exp exp not bool bool and bool assumption assume bool outcome allocate exp price exp allocate exp property bool forall bool mechanism individual assumption outcome property figure syntax oftheauction voting mechanismmodel.
id1 bid1 val1 ... idn bidn valn n ... n bid1 ... bidn vi oi i vali assume assumption allocate allocation d eval assumption allocation assume assumption price clearprice t eval assumption clearprice figure semanticrulesoftheauction voting model.
.
mechanism modeling language we nowpropose a domain specificlanguage to facilitate the automatedtranslation from smart contracts to mechanismmodels.
we define an abstract syntax of the mechanism modeling language which is applicable to both auction and voting.
figure shows the context free grammar of the language.
a mechanism model comprises one or more individuals anassumption anoutcome and apropertyto be verified.
an individual is defined as a triplecontainingtheidentifier id bidamount bid andvaluation val .anassumptionisabooleanconstraintwhichshouldbesatisfied upon the entry of the contract.
the outcome of the contract is specified by the allocation and the clear price functions which are expressionsover idandbid.votingcontracttypicallydoesnothave aclearpricefunction.weallowpropertiestobespecifiedusinga boolean expressionoptionallyprecededbya forall quantifier.
languagesemantics.
the semanticmappingfromthemodeling language to the underlying mechanism model is summarized in fig.
.
the indiv rule maps the individuals and their reported types as well as valuations.
more specifically the individuals bids are mapped to their reported types and an individual of type i s valuation of the item vi oi i isvali whereoidenoted the outcomewheretheitemisallocatedto i.the alloc ruleconjuncts thebooleanexpression assumption fromthe assume clauseand thesymbolicexpression allocation intermsofindividuals strategies from the allocate clause which is evaluated as the allocation function.similarly thetransferfunctionistheconjunctionofthe assumption andtheclearprice expressions.therearesomedifferencesbetweenauctionandvoting clearpriceisabsentfromvoting where allocation is done by comparing the number of ballots bids bytheparticipatingindividuals whereasinauction theindividuals whobidnoless thanthe clear price can be allocatedthe item.
thislanguageworksforthemostcommonlyseenauctionand voting contracts with fairness concerns.
for example ethereum smartcontractsmeetingtheerc voting anderc blind auctions under review standards all follow the same interfaceandstructure thereforecanbeautomaticallytranslated intoourmodelinglanguage.similarlanguagescanalsobedesigned for other types of contracts e.g.
social games .
the proposed modelinglanguagecanbemodifiedandextendedtoestablishsuitable mappingsfromnewcontracttypestotheclassicmechanismmodel.
withthenewmodelinglanguage themodelextractionandproperty checking algorithms can be directlyreused.
the fairconframework in this section we present the faircon verification framework for smart contract fairness.
figure 5shows the overall workflow of faircon.theframeworkconsistsofthreemodules namely model extraction propertychecking andfairness verification .
the smart contract source code is first automatically instrumented accordingto user provided annotations.at thisstage we consider a k player bounded model and the instrumented contract code contains a harness which orchestrates the interactions between the players and the target contract.
the extraction of the mechanismmodelispoweredbysymbolicexecutionoftheharness program and an intermediate mechanism model issynthesized as aresult.
inordertoperformpropertychecking theintermediatemechanismmodel alongwiththedesiredproperty areencodedasan smtformula suchthattheformulaisunsatisfiableifandonlyif thepropertyholdswithrespecttothemodel.weuseansmtsolver to check and may declare the property holds when the number ofparticipantsareboundedby k otherwise acounterexampleis generatedwhichdisputesthe property.
if we fail to find a counterexample in the bounded case we may proceedtothefairnessverificationofthepropertiesforunbounded number of participants.
to do that we modify the harness to accountforanunlimitednumberofplayers instrumentitwithprogram invariant as well as the desired properties as post conditions andrelyonprogramverificationtoolstodischargetheproofobligations.thiseithertellsusthatthepropertyissuccessfullyproved orthevalidityofthepropertyisstillunknown inwhichcasewe are only confident aboutthe fairnessfor the boundedcase.
.
mechanism model extraction to extract a mechanism model out of the smart contract source code wefirstinstrumentthecontractcodewithaharnessprogram mechanismharness showninfig.
.theharnessprogramorchestrates the interactions of kplayers with the target contract.
this is achieved by declaring symbolic variables to represent the possible bid and valuation of each player stored in the arrays bid line and value line4 respectively.thena for loop lines5 19 is usedtosimulatetheactionsperformedbythe kplayers.insmart contract allplayershavetomovesequentiallysinceparallelization 670esec fse november8 virtualevent usa ye liu yili shang weilin androng zhao instrument contract k player smart contract fairness property pgenerate symbolic pathssynthesize mechanism modeltranslate to smt encoding k player bounded model example guided invariant generationprove fairness property pverification conditionscheck fairness property p fairness proof model extraction property checking counter examples examples predefined invariant templatesfailure success failuresuccessunfair fair unknowninstrumented harness programlegend input process data result figure workflow ofthe faircon framework.
1contract mechanismharness k player bounded model 3uintbid symbolic values 4uintvalue symbolic values 5for uinti i k i example msg.sender i 7require individual.id tostr i example msg.value bid 9require individual.bid bid example bid function inlined outcome example allocate highestbidder 13allocate allocate example price highestbid 15price price check loop invariant price max bid allocate argmax bid 18assert invariant check post condition 21assert property figure6 theharnessprogramformechanismmodelorchestration.
is not allowed.
the ordering is not important becausethe players are symmetric.
we rely on the annotations provided by users e.g.
fig.
to constructtheloopbody whichtriggersamovefromoneparticular player.
the variables controlling the player s identifier and bid value are assigned the corresponding symbolic values lines and .
in the case of example .
these variables are msg.sender and msg.value respectively.thentheallocationfunction e.g.
bid in example .
is inlined and the resulting variables annotated by allocate and pricearestoredassymbolicexpressions lines and .
there are also two placeholders at lines and for assertions of loop invariant and post conditions which will be describedinsect.
.
.
we then run symbolic execution on the harness program to collect a set of feasible symbolic paths.
each symbolic path is representedintheformof condition effect where condition and effect are boolean expressions in terms of the symbolic variables defined earlier e.g.
bid andvalue in fig.
.
here condition represents the path condition which enablesthe execution of a particular program path effect represents the values oftheresultingvariables e.g.
allocate andpriceinfig.
.we take all path conditions condition j where the effect is successfully computed i.e.
not running into errors or reverts and use the disjunction of them as the assumption of the model i.e.
assume logicalortext.
jcondition j .
similarly we use the effects as the corresponding allocationandclearpricefunctions.forexample inthemechanism model wehave allocate logicalortext.
j condition j effectj and price logicalortext.
j condition j effectj .
.
bounded property checking forpropertychecking givenamechanismmodel mandaproperty p ourgoalistoconstructaformula suchthat isunsatisfiableif andonlyif m p.withthesemanticrulesdefinedinsect.
.
it is straightforward to obtain a formula encoding the allocation and clear price functions i.e.
m d t .
weillustratetheencodingofpropertiesusingthetruthfulness as an example.
definition .2states that a model mis truthful if andonlyifthetruth tellingstrategyperformsnoworsethanany other strategies.
therefore the high level idea is to first encode the truthful and untruthful strategies separately for an arbitrary player and then asserting that the utility of the player is higher when he she acts untruthfully.
the encoding of the truthfulness property pisshownas follows i j i nequalj m bidi vali bidj valj truthful m bidi bid i ui u i bid i nequalvali untruthful ui u i utility whereiis ageneric playerwithutility ui.thetruthful scenariois when all players including i bid the same amount as their valuations i.e.
bidi valiandbidj valj.
the untruthful model is constructedbysubstitutingthebidandutilityvariablesof iwith newcopies bid iandu i andasserting bid i nequalvali.finally weassert thatui u i. ifpis satisfiable we find a counterexample where anuntruthfulstrategyperformsbetterthanthetruthfulstrategy.
671towardsautomatedverification of smartcontract fairness esec fse november8 virtualevent usa otherwise thetruthfulstrategyisadominantstrategyfor i.the encodings ofotherpropertiesare similar.
.
formal proofforunbounded model considertheharnessprograminfig.
.theloopiterates ktimes to model kplayers joining in each iteration.
we use induction to prove that the smart contract satisfies the fairness property forarbitrarynumberofplayers.followingthestandardapproach to proving program correctness an invariant for the for loop is required i.e.
invariant infig.
.normally theloopinvariant hastobederivedmanually.fortunately smartcontractsareusually written in a more standard way than arbitrary programs which makes it easier to generalize invariants for the same type of smart contracts e.g.
auctionsconsideredinthiswork.asetofpredefined invariant templates accordingtospecifictypes ofcontracts have to be providedto the framework as inputs .
the followings are three common types ofinvariantsrequiredfor auctions.
allocate argmax bid topbidder price max bid 1st price price max bid bid 2nd price the topbidder invariantrequiresthatthebidderwiththehighest bid becomes the winner.
the 1st price invariant requires that the highest bid is the clear price while the 2nd price invariant requires that the secondhighestbidisthe clear price.
however theinvarianthastosatisfytwoconditionstoconclude that the smart contract satisfies the fairness property.
to elaborate ontheconditions wedefinethefollowingnotations.lettheharness program infig.
6be abstractedas for cond s assert q assert p wherecondis the loop condition qandpare the invariant and property respectively and srepresentsthestatementsin theloopbodybeforetheassertionoftheinvariant.wealsoneed thestrongestpostcondition operatorfordiscussion.thenotationsp pre stmt represents the strongest postcondition after the programstatement stmtisexecuted providedtheprecondition pre before the execution.
for example sp x x x would bex .
wenowformallydefinethevalidityforinvariants.theinvariant has to satisfy the following twoconditions the invariant is inductive i.e.
sp cond q s q. intuitively itmeansthatnomatterhowmanyiterationstheloop performs the invariantalwaysholds.
theinvariantisstrongenoughtoguaranteethefairnessproperty i.e.
q p. if the conditions are satisfied we can conclude that the smart contract is fair for arbitrary number of players.
the validity of the conditionscanbecheckedbyanyprogramverificationtools and we use dafny inthis work.
noticethat inthesearchforvalidinvariant wegiveupthose violatingthetwovalidityconditionswhenanalyzingmechanism models for bounded number of players c.f.
sect.
.
.
that is only those invariants that are valid for the bounded models are consideredinprovingforarbitrarynumberofplayers.morefairness propertiesmaybeprovedwhencustomizedinvariantsareprovided.
implementation and evaluation we implement the proposed approach in our tool faircon which takes an annotated smart contract source code with the fairness property to be checked as input extracts its mechanism model for a finite number of players c.f.
sect.
.
and then automatically performsymbolicpathanalysisonthemodel c.f.sect.
.
.ifthe fairness property is violated in one symbolic path faircon generatesacounterexamplerelatedtothatpath.allthesymbolicpath analysisisachievedbasedonthez3smtsolver.ifnocounterexample is founded within a finite number of players faircon then tries to prove that the smart contract satisfies the fairness property basedoninductionwiththesetofpredefinedinvariants.duringthe process dafny is used to check the two validity conditions of invariants c.f.
sect.
.
to establish the fairness proof.
to explore thecapabilityofourproposedapproachinthispaper weevaluated faircon to answer the research questionsbelow.
rq1 how accurately does faircon check fairness properties onsmart contracts?
rq2 how efficient could faircon be for mechanism model extractionandfairnessproperty checking?
rq3 what are the common patterns for unfair smart contracts?
.
experiment setup many ethereum smart contracts are token based and derived from standard templates e.g.
there are erc contracts on etherscan but such contracts have little fairness concerns.
we collected verified2smart contracts running on ethereum from the etherscan website among which we found contracts whose name or code contains keyword auction .
after code review for these smart contracts we selected typical auction contracts.
the contracts that are not selected are either the presale contractsforauctionortheauctioncontractsthatendimmediately after getting one bid which are not within the scope of our fairness analysis in this paper.
these selected contracts are actively in use impactingmanyrealusers.forexample cryptoromeauction hotpotatoauction anddeedare used to support popular dapps anddeedhas more than transactions.
in fact the number ofdappsonethereumissmall .7k comparedwiththetotalnumber of contract instances.
among the selected auction contracts we found that four auctions completely have the same structure.
finally afterremovingduplicateorsimilarcontracts weselected12 distinct auction contracts for our experiments.
apart from auction contracts wealsoselectedfivevotingsmartcontracts.sototallywe have17publicsmartcontracts 12forauctionandfiveforvoting for our experiments.
to find counterexamples we set some configurations on mechanismmodelstobechecked.fortheauctionmechanismmodel there arethreebidders andthebidpriceandthevaluationofbiddersare arbitrary while allocation will be for one winner only.
similarly forthevotingmechanismmodel weassumethatfivevotersvote for twoproposals asthebasic configuration.votervotes toany of proposalsrandomly andhisballotcouldbereflectedintothebid in our mechanism model.
voter has his own valuation for different proposals and the winning proposal means the allocation.
the 2a contract is labeled verified on etherscan if its source code matches with the deployed version onethereum.
672esec fse november8 virtualevent usa ye liu yili shang weilin androng zhao table fairnesscheckingon auction contracts.
contractsproperties time seconds t c o e tmodeltcheck auction1 .
.
auction2 .
.
auction3 .
.
auctionitem .
.
auctionmanager .
.
auctionmultipleguaranteed .
.
auctionpotato .
.
betterauction .
.
cryptoromeauction .
.
deed .
.
etherauction .
.
hotpotatoauction .
.
table3 fairnessprovingonfairauctioncontractsintable .
contracts allocation inv.
price inv.
proved property auctionitem topbidder 1st price o deed topbidder 2nd price t c e etherauction n a n a betterauction topbidder 1st price o actual valuation of winning proposal or failing proposal is the sum ofvoters valuationtothatproposal.onethereumvotingcontracts are open to users we assume voter cannot get any utility if the voter ssupportingproposalisnotthewinningproposal.andthe valuation of voter to proposal could be measured in two way.
the firstisthatthevaluationismappedtorealnumber.forinstance voter may prefer proposal a much more than any other voters prefera.thatisthesituationwherevotersareheterogeneous.the second setting assigns or to valuation of voter to proposal.
for instance voter wants proposal a rather than proposal b. this simplifiedversioncouldbeappliedtothesituationwherethevoters arehomogeneous.underthesesettings faircon checksthefour fairnesspropertiesatagivennumberofparticipantsaimingtofind counterexamples.
with the configurationsfor mechanism models we spent6 humanhourstomanuallyannotatemechanismcomponentsandinstrumenttheharnessinthesesmartcontracts.ourexperimentsare conductedonubuntu18 .
.3ltsdesktopequippedwithintelcore i7 core and 32gb memory.
we discuss the experiment results in the following subsections.
the raw results and the replication package are available at .
.
experiment results we nowdiscuss the experiment findingsindetails.
results for rq1.
toanswerrq1 weevaluated faircon bythe selected17smartcontractswiththeconfigurationsmentionedin sect.
.
.
tables2and4show the results for fairness checking onauctionandvotingcontracts respectively.intable thefirst column shows the names of the contracts and the middle four columnsshowtheresultforthefourfairnessproperties truthfulness t collusion freeness c optimality o andefficiency e table fairnesscheckingon voting contracts.
contractsvaluation r valuation tmodel t c e tcheck t c e tcheck association .
.
.
ballot .
.
.
ballot doc .
.
.
hidera .
.
.
sbibank .
.
.
respectively.therightmostcolumnindicatesthetimeformechanism model extraction tmodel and for fairness property checking tcheck .amongtheselected12contracts fourofthemarefoundto be fair on at least one fairness property while the remaining eight contractsarenotfairforallthefourfairnessproperties withcounterexamplesgenerated .wehadmanuallycheckedthegenerated counterexamples and confirmed that they are not false positives.
regarding the execution time in our three bidders experiments modelextractiontimevariedfrom1.61to14.25secondsbecausedifferentcontracts have differentmechanismmodelstobe extracted.
property checking is much faster than model extraction which took around .
secondsfor eachcontract.
table3shows the result of proving fairness properties for the auctioncontracts that are fair onat leastone fairnessproperty as shownintable .thefirstcolumnshowsnameofcontract.thesecond and third columns show the invariant templates that are valid for proving fairness properties.
the last column indicates which fairnesspropertycanbeproved tfortruthfulness cforcollusionfreeness o for optimality and e for efficiency .
the auctionitem andbetterauction contractscanbeprovedtosatisfytheoptimality property using the allocation invariant topbidder together withthe priceinvariant 1st price whichalso confirmsthat they are first price auctions.
the deedcontract satisfies the topbidder and 2nd price invariants based on which faircon can prove three properties for deed namely truthfulness collusion freeness and efficiency.it also confirms that deedis a second price auction.
theetherauction contract is shown in fig.
which is an variant of second price auction for a designated bid price only.
line requires a fixed new higher bid price to update the four variablessecondhighestbid secondhighestbiddder highestbid andhighestbiddder in lines 15 18 respectively.
it turned out thatnoneofourpredefinedinvariantsarevalidtoproveanyfairnessproperty.thisisbecause etherauction adoptsthestrategy of fixed bid price for each round which makes it similar to but actually not typicalsecondprice auctions.
table4shows the result of property checking for the selected five voting smart contracts each of which is for five voters and two proposals.
the first column shows the names of contracts.
thelastcolumn tmodel showsthemodelextractiontime inseconds .themiddletwolargecolumnsshowtheaverageproperty checkingtime inseconds forthethreeproperties truthfulness t collusion freeness c andefficiency e .we have twosettings for the valuation component in our mechanism model.
one is ranging over real numbers r while the other is ranging over .
the reason of having two settings is that no contract was found fair regarding any property as shows in the second large column of 673towardsautomatedverification of smartcontract fairness esec fse november8 virtualevent usa 1contract etherauction anyone can bid by calling this function and supplying the corresponding eth 3function bid public payable 4require auctionstarted 5require now auctionendtime 6require msg.sender !
auctioneer if sender is already the highest bidder reject it.
8require highestbidder !
msg.sender 9address newbidder msg.sender 10uintpreviousbid balances 11uint newbid msg.value previousbid each bid has to be .
eth higher 13if newbid highestbid return the highest bidder is now the second highest bidder 15secondhighestbid highestbid 16secondhighestbidder highestbidder 17highestbid newbid 18highestbidder newbidder 19latestbidtime now update the bidder s balance so they can later withdraw any pending balance 21balances newbid figure the etherauction soliditysource code.
table4 because the diverse rvaluation of proposals brings the incentive for voters to lie and to conspire with others.
in the valuation setting as shows in third large column of table all the five contracts are truthful collusion free and efficient.
this is because if a voter lies he she gets at most zero worth utility and thus has no incentive to lie.
based on table we can observe thatfairnessproperty maydepend ontheconfigurationofmechanismmodels.differentconfigurationsmayhavedifferentresults onfairnessproperty checking.
thecheckingtimefortheoptimalitypropertyisnotlistedintable4becausesmartcontractsforvotingdonothavethecomponent of transfer functions in our mechanism model so that optimality cannotbedefined c.f.sect.
.
.inaddition noneofthepredefined invariants are valid to prove that the five selected voting contracts arefair.weneedtoconstructothervalidinvariantsmanually which isone ofour future works.
answer to rq1 since there is a lack of ground truth we manuallyinvestigatedthecasesandtheresultsof faircon were confirmed.
results for rq2.
the time costs studied in rq2 can be divided into two parts model extraction and property checking.
overall the model extraction takes much longer time and the property checking is efficient taking less than one second for each case as shownintables 2and4.
to explore the efficiency of faircon further we selected the cryptoromeauction contract to make performance experiments onfaircon.figures8and9showtheexecutiontimeformechanism model extraction and fairness property checking when the numberofbiddersincreases respectively.infig.
thex axisshows thenumberofbidders whilethey axisshowsthemechanismmodel extractiontimeinseconds.wecanobserve thatmodelextraction timeisnearlyexponentialtothenumberofbiddersinvolved which is reasonable because every participant is independent.
when the number of bidders is under six the model extraction time is less3 .
.
.
.
.
.52model extraction time s figure model extraction time with increasing number of bidders.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.34property checking time s truthfulness collusion freeness optimality efficiency figure9 propertycheckingtimewithincreasingnumberof bidders.
than minutes which is tolerable.
once the number of bidders goes beyondsix the time increasesexponentially.
figure9shows the property checking time where the x axis indicatesthenumber ofbidders andthey axisindicatesthepropertycheckingtimeinseconds.wecanobservethesametrendas that in fig.
i.e.
the execution time isexponentialto the number of bidders involved.
however property checking is much faster than model extraction since model extraction requires symbolic execution which is heavy in computation.
mostly the checking timeislessthanonesecond.wecanalsoobservethatthechecking time for truthfulness or collusion freeness is at least doubled than that foroptimality andefficiency.
thisis because truthfulness and collusion freeness properties need to consider the strategy as well astheoutcomespaces whileoptimalityandefficiencyproperties only have to considerthe outcome space.
running faircon onalargenumber i.e.
k whichistheoretically unbounded ofplayers is impracticalfor symbolicexecution.
theresultsindicatethat faircon canfindscounterexample s with smallk e.g.
threetofive ifthecontractisindeedunfair e.g.
k in table2andk in table .
otherwise as shown in table faircon could use invariants observed during the small kruns in anattempttoprovethatthefairnesspropertyholdsforarbitrary valuesof k. 674esec fse november8 virtualevent usa ye liu yili shang weilin androng zhao answertorq2 althoughmodelextractionisthebottleneck offaircon itisaone timetaskandneednotbeperformedfor a largek.faircon is efficient for fairness property checking.
resultsforrq3.
fairnessissuesinsmartcontractsarereal.forexample etherauction asshowsinfig.
wasreportedasascam where bidders compete for one ether by gradually increasing their bids.
our results confirmed its unfairness although truthfulness andcollusion freenessholdsforabounded k optimalityandefficiencyareviolated.basedonourreviewofthesubjectcontracts we summarize somepatterns below.
contractsimplementingthefirstpriceauctionandtheirvariantsdonotsatisfythetruthfulnessproperty.forexample the aforementioned betterauction isimplementingatypicalopen first price auction where the top bidder has the incentive to lower his herbidprice but stillremainthe winner.
contracts implementing the first price auction and variants do not prevent against collusion.
for example betterauction doesnotsatisfy thecollusion freenessproperty sincetwo bidders have the chance to lower the clear price and to be the winner increasing theirgroup utility.
contracts implementing the second price auction and their variants do not satisfy the optimality property.
for example deedis one of the contracts implementing the second price auction.
since the clear price is the second highest bid the contractmaynotbe optimalwithapotentialdecreasein total revenue.
contractsimplementingthefirstpriceauctionandtheirvariants are not efficient.
this is because first price auctions are untruthful and the winner may not be the one who has the highestvaluation ofthe item.
weenvisionthatfairnesscheckingbeincludedasapartofthe common practice validation processtoimprove users confidence towards dapps powered by smart contracts.
we hope the fairness issuesinsmartcontractscanbemitigatedbyalertingdevelopers andusersthesecommon patterns.
.
threatsto validity our evaluation results are subjectto common threatsto validity.
lackofgroundtruth.
it lacks ground truth for the contracts and properties we studied.
two of the authors manually inspected the subjects and our results independently which took around half an hour for each contract.
we confirmed that the counterexamples providedbyour toolare valid.
external validity.
the types of contracts and properties consideredinthisworkarelimited.ourfindingsmaynotbegeneralizedto other cases.
the dapps implemented with smart contracts usually follow typical patterns mainly due to thelimitations onlanguage syntax and considerations on gas consumption.
we believe that othertypes ofgame likecontracts wouldbehave similarly.
related work our work is closely related to the following research areas the functional correctness and security analysis of smart contracts the verification of fairness properties in traditional software systems andmechanismdesignas well as game theory.
.
smartcontract analysis andverification since smart contract applications are often used to manage a large sumoffunds detectionofsecurityflawsinsmartcontractsreceived a lot of attention.
the violation of important security properties leadstomanywell knownsmartcontractvulnerabilities .for example a smart contract which fails to check the return value of a possibly failed external call operation has the unchecked callvulnerability .theexecutionlogicofasmartcontract that is not independent of environmental variables e.g.
the block timestamp is prone to dependence manipulation including the timestamp dependency vulnerability .
if the business logic of a smart contract depends on its mutable state parameters such as balanceandstorage thenithasthe transaction orderingdependence problem.
a smart contract is reentrant if provided with enough gas an external callee can repeatedly call back into it within a single transaction.
missing permission checks for the execution of atransfer or aselfdestruct operation make a smart contract prodigalandsuicidal respectively .absenceofproperchecks forarithmeticcorrectnessmakeethereumcontractsproneto integer and batch overflow underflow .
furthermore the progress of a smart contract can be compromised by gas exhaustive code patterns .
to address these security issues ellul et al.
developed a runtime verificationtechnique contractlarva toruleoutcertainunsafe behaviorsduringtheexecutionofsmartcontracts.oyente is one of the first to detect smart contract vulnerabilities using symbolic execution.
contractfuzzer is among the early fuzz testing tools and mythril is a well known security analysis tool which combines symbolic execution and taint analysis to detect nearly classes of vulnerabilities.
there are many other tools designedfor the similar purpose.
another popular direction is using formal techniques to ensure thefunctionalcorrectnessofsmartcontracts.bhargavanetal.devisedafunctionalprogramminglanguage named f tofacilitate the formal verification of ethereum smart contracts.
based onf grishchenko et al.
presented the first complete small step semantics of evm bytecode .
hildenbrandt et al.
presented an executable formal semantics for the ethereum platform named kevm based on which park et al.
presented a deductive verification tool capable of verifying various high profile and safety criticalcontracts.
jiaoetal.
developedthe operational formal semantics for the solidity programming language named ksolidity .
abdellatif et al.
formalized blockchain and users behaviors to verify properties about their interactions using statisticalmodelchecking.nehaietal.
appliedmodelchecking to verifysmart contracts from the energy marketfield.
mostofthesmartcontractanalysesmentionedabovefocuson findingbugsorsecurityvulnerabilities whichhighlightmismatches betweencontractdevelopers expectationsandhowthecontract code work whereas the fairness issues considered in our paper 675towardsautomatedverification of smartcontract fairness esec fse november8 virtualevent usa highlightmismatchesbetweenthecontractusers expectationsand the actual implementationofthe game rules.
.
fairnesschecking in softwaresystems we believe that fairness should be considered a software quality attribute amongfunctionalcorrectness security privacy etc.
one needs to consider throughout the software development process.
smart contract is an emerging type of software application with oftenmultipleinteractingparticipants wherefairnessbecomesa lot more relevant.
the problem of algorithmic fairness is considered in manymodern decision making programs either learned from data orcreatedbyexperts.theterm fairness canbesubjectivedependingontheactualcontexts.vermaandrubin collecteddefinitions of fairness from different software domains and explained therationales behindthesedefinitions.
fromthesoftware specificationandverificationperspective albarghouthietal.
treated decision makingalgorithmsasprobabilisticprogramsandproposed toverifyformallydefinedfairnesspropertiesonawideclassofprograms.
d antoni et al.
introduced the concept of fairness aware programming andpresentedaspecificationlanguageandruntime monitoringtechniquewhichallowprogrammerstospecifyfairness propertiesintheircodeandenforcethepropertiesduringexecutions.
in general the fairness definition in such decision making programsisthattheprogramshowsnobiastowardscertaingroups ofusers.thereislittleconsiderationintermsoftheinteractions interests and conflicts between users and programs or between usersandusers.
withregardtosmartcontracts bartolettietal.
foundthrough asurvey thatnearly0 .
ofthe transactionsonethereumcould beowingtoponzischemes.chenetal.
identifiedpatternsin contractapplicationsimplementingponzischemes andbuiltaclassifier to detect suspicious schemes using data mining and machine learning.
such contracts can be considered violating fairness properties inthesensethatnotallparticipantshavethesamechance ofgainingprofits.inthiswork weexpandthenotionoffairnessin smartcontractstoincludeanypropertiesexpressibleinmechanism models.
.
mechanism design andgametheory mechanismdesignhasbeenwellstudiedintheeconomicdomain .
these works offer the theoretical foundation for our modelextractionandfairnessverification.manyfairnessproperties weusedinthispaperarealsoinspiredbythem.maskin articulatedsomeimportantconcepts suchas outcomes andsocialgoals in implementation theory which is a part of mechanism design.
heofferedawell definedexampletoshowhowtoachievesocial goals.
jackson presented mechanism theory in a full view and provided formal definitions to many concepts belonging to this domain while klemperer introduced the most fundamental concepts for auction and carried out a thorough analysis of optimal auctions the equivalence theorem and marginal revenues.
lehmann revealed how to exploit truth revelation in realizing approximatelyefficientcombinationauctionwhichemphasizedthe co exist problem of optimalauctionand efficientauction.mechanism design and game theory were also applied on the smart contract design.
hahn et al.
implemented a vickrey second price auction on a smart contract to setup and operate a marketofenergyexchanges.similarly chenetal.
providedan e auctionmechanismbasedonblockchaintoensureconfidentiality non repudiation andunchangeabilityof theelectronicsealed bid.
creams implemented a collusion resistant k vickery auction.
galal and youssef presented a smart contract protocol for a succinctlyverifiablesealed bidauctionontheethereumblockchain to protect bidders privacy.
mccorry et al.
proposed the first implementation of a decentralized and self tallying internet voting protocol using smart contract to guarantee secure e voting.
bigi et al.
combinedgametheoryandformalmodelstoanalyzeand validate a decentralized smart contract protocol named dscp and used game theory to analyze users behavior.
chatterjee et al.
studied two player zero sums games and performed a quantitative analysisofplayers worstcaseutilities.theseworksemploycertain levels of fairness analyses mostly manual on some one off applications.
in contrast we provide a more general framework withmaximal automation support.
conclusion and futurework in this paper we proposed an approach to analyze fairness properties of smart contracts.
we implemented faircon to automatically extractmechanismmodelsfromsmartcontractswithuser provided annotations and experimentally evaluated it on real world auction and voting contracts.
the experiment results indicate that faircon is effective in detecting property violations and able to prove fairnessfor common types of contracts.
in the future we would like to apply faircon to other types of smart contracts beyond auction and voting.
it can also be extended to check for other types of fairness properties that are critical in maintainingthe integrityof blockchainapplications.