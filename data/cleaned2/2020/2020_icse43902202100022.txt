hero on the chaos when path meets modules ying wang liang qiao chang xu yepang liu shing chi cheung na meng hai yu and zhiliang zhu software college northeastern university china email wangying swc.neu.edu.cn qiaoliangneu .com yuhai zzl mail.neu.edu.cn state key laboratory for novel software technology and department of computer science and technology nanjing university china email changxu nju.edu.cn southern university of science and technology china email liuyp1 sustech.edu.cn the hong kong university of science and technology china email scc cse.ust.hk virginia tech usa email nm8247 cs.vt.edu abstract ever since its first release in the go programming language golang has been well received by software communities.
a major reason for its success is the powerful support of library based development where a golang project can be conveniently built on top of other projects by referencing them as libraries.
as golang evolves it recommends the use of a new library referencing mode to overcome the limitations of the original one.
while these two library modes are incompatible both are supported by the golang ecosystem.
the heterogeneous use of library referencing modes across golang projects has caused numerous dependency management dm issues incurring reference inconsistencies and even build failures.
motivated by the problem we conducted an empirical study to characterize the dm issues understand their root causes and examine their fixing solutions.
based on our findings we developed h ero an automated technique to detect dm issues and suggest proper fixing solutions.
we applied h ero to popular golang projects.
the results showed that h ero achieved a high detection rate of .
on a dm issue benchmark and found new dm issues in popular golang projects.
we reported issues among which .
issues have been confirmed and of them .
have been fixed or are under fixing.
almost all the fixes have adopted our fixing suggestions.
index terms golang ecosystem dependency management i. i ntroduction the go programming language golang is quickly adopted by software practitioners since its release in .
like other modern languages golang allows a project to import and reuse functionalities from another golang project i.e.
library by simply specifying an import path .
there are four popular sites hosting golang projects namely bitbucket github launchpad and ibm devops services .
among them github hosts nearly golang projects as of june .
while golang s library based development boosts its adoption its library referencing mode has undergone a major change as the language evolves.
prior to golang .
libraryreferencing was supported by the gopath mode.
libraries referenced by a project are fetched using command go get .
this mode does not require developers to provide any configuration file.
it works by matching the urls of the site hosting referenced libraries with the import paths specified by chang xu is the corresponding author.thego get command.
however it fetches only a library s latest version.
to overcome this restriction developers use third party tools such as dep and glide to manage different library versions under the vendor directory1.
to satisfy developers need for referencing specific library versions in august golang .
introduced the go modules mode which allows multiple library versions to be referenced by a module using different paths.
a module comprises a tree of golang source files with a go.mod configuration file defined in the tree s root directory.
the configuration file explicitly specifies the module s dependencies with specific library versions as well as a module path by which the module itself can be uniquely referenced by other projects.
the file must be specified according to the semantic import versioning siv rules .
for instance projects whose major versions arev2or above should include a version suffix like v2 at the end of their module paths.
compared with gopath go modules is flexible and allows multiple library versions to coexist in a golang project .
developers are suggested to migrate their projects libraryreferencing modes from gopath togo modules .
however the migration took a long time.
we sampled popular golang projects on github.
as of june only .
projects had migrated to go modules while the rest .
were still using gopath resulting in the coexistence of two different library referencing modes.
what s more many projects suffered from various dependency management dm issues caused by such mixed library referencing modes.
specifically we made the following three observations go modules is not backward compatible with gopath .
there are two scenarios.
first a golang project can be referenced by its downstream projects.
after it migrates to go modules its introduced virtual import paths with version suffixes cannot be recognized by downstream projects still in gopath .
this causes build errors to these projects.
second a downstream project that has migrated to go modules may not find its referenced libraries in gopath or may fetch unintended library versions due to different import path 1the vendor attribute allows a golang project to reference a library s different versions and keep them in different folders under a vendor directory.
ieee acm 43rd international conference on software engineering icse .
ieee v2.
.
v2.
.
v2.
.
v2.
.
v2.
.
v2.
.
v2.
.
a b fig.
.
dm issue examples interpretations by the two modes.
siv rules can be violated even if a golang project and its referenced upstream projects both use go modules .for instance a project of major version v2may not necessarily include a version suffix at the end of its module path.
such violation can be due to developers misunderstanding or weak siv rule enforcement discussed later in sec ii a .
they can cause a large number of unresolved library