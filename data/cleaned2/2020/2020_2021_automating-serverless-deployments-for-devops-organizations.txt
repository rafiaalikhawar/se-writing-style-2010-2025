automating serverless deploymentsfordevops organizations daniel sokolowski sokolowski cs.tu darmstadt.de technical universityof darmstadt germanypascal weisenburger pascal.weisenburger unisg.ch universityof st. gallen switzerlandguido salvaneschi guido.salvaneschi unisg.ch universityof st. gallen switzerland abstract devopsunifiessoftwaredevelopmentandoperationsincross functional teams to improve software delivery and operations sdo performance.ideally cross functionaldevopsteams independently deploytheirservices butthecorrectoperationofaserviceoften demandsotherservices requiringcoordinationtoensurethecorrect deploymentorder.
this issueiscurrentlysolvedeitherwith a central deployment or manual out of band communication across teams e.g.
viaphone chat oremail.unfortunately bothcontradicttheindependenceofteams hinderingsdoperformance the reason why devopsisadoptedinthe firstplace.
inthiswork weconductastudyon73itprofessionals showing that in practice they resort to manual coordination for correct deployments even if they expect better sdo performance with fully automated approaches.
to address this issue we propose s muse anoveliacsystemautomatingdeployment coordinationinafullydecentralizedfashion stillretainingcompatibilitywiththedevopspractice incontrasttotoday ssolutions.
we implement s demonstrate that it effectively enables automated coordination introduces negligible definition overhead has noperformanceoverhead andisbroadlyapplicable asshownby the migrationof64 third partyiacprojects.
ccs concepts computersystemsorganization cloudcomputing softwareanditsengineering orchestrationlanguages cloud computing architecture descriptionlanguages.
keywords devops infrastructure as code cloud serverlesscomputing acmreference format daniel sokolowski pascal weisenburger and guido salvaneschi.
.
automating serverless deployments for devops organizations.
in proceedingsofthe29thacmjointeuropeansoftwareengineeringconference andsymposiumonthefoundationsofsoftwareengineering esec fse august 23 28 athens greece.
acm new york ny usa 13pages.
permissionto make digitalor hard copies of allorpart ofthis work for personalor classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthefirstpage.copyrights forcomponentsofthisworkownedbyothersthanthe author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspecificpermission and or a fee.
request permissions from permissions acm.org.
esec fse august 23 28 athens greece copyright heldby the owner author s .
publicationrightslicensed to acm.
acm isbn ... .
introduction whileagilemethodshadadeepinfluenceonsoftwareinitorganizations software development andoperations aretraditionallyseparated.
operationssummarizesallactivitiesafterthedevelopment including configuration resource provisioning and deployment monitoring alarming reporting andsupport.thewidespreadadoption ofagile methods set the focus on changing requirements and software quality aiming for minimal change response time.
operations however focuses on stability and reliability which are typicallyassumedtobethreatenedbyfrequentchange.
devopsaims to mitigate this tension organizationally devops strengthens collaboration between development and operations staff often by unifyingboth tasksin cross functionalteams .
technically devopsleveragescode basedtoolsforoperations too achieving a high degree of automation continuous delivery .
both lead to a smootherworkflow improvingservicequality andchange managementperformance .
indevops infrastructureascode iac isacoretechnique to automate software deployment by managing the it infrastructure with machine readable files i.e.
code replacing manual configuration via interactive configuration tools.
such iac definitions allow versioning debugging updating andreviewingoftheinfrastructure setup reusingwell developedtechniquesfromthe domain of traditional application code.
iac has shown a tremendous impact on the speed of change.
for example introducing iac scripts in ambitenergyhasincreaseddeploymentfrequencybyafactorof .
intercontinental exchange ice uses iac to maintain ofits20kservers reducingthetimetoprovisiondevelopment environments from 1 2days to minutes .
wefocusoniacforserverlesscomputing e.g.
asinawscloudformation azureresourcemanager orterraform.serverlesscomputing isaparadigmfordeployingcloudapplicationsclosetothe cloud soriginalpay as you goconceptandsimplifiesoperational concerns regarding application availability scalability and fault tolerance .
serverless infrastructure is therefore an excellent fitfordevopsbecauseitreducestherequiredoperationsknowledge makingspecializedoperationsteamsobsolete .werefer toserverlesscomputingtoincludenotonlyfunction as a service faas but all offerings where the cloud provider transparently manages the provisioning and scaling of underlying servers in agreement with the current use of serverless computing at major cloud providers e.g.
serverless containers serverless databases orserverlessstoragesolutions.
implementingdevopswithcross functionalteamsfollowinga service basedarchitectureideallyimpliesthateachteamindependently deploys its own services.
however the correct operation of a service often depends on the availability of other services.
ifthesedependenciesspanacrossteams theirdeploymentshave to be coordinated to ensure that dependencies are not violated.
57esec fse august athens greece daniel sokolowski pascalweisenburger andguidosalvaneschi unfortunately existing iac solutions to orchestrate multiple deployments e.g.
aws cloudformation stackset or sceptre are centralized and cannot ensure that dependencies between services in deployments of different teams are satisfied.
hence as we show inthispaper suchdependenciesrequire manualcoordinationof deployments i.e.
teams have to communicate out of band to ensurethecorrectdeploymentorder e.g.
viaphone chat oremail.
thisapproachisproblematicbecauseit slowsdownsoftware evolution and iserror pronebecauseofpotentialmiscommunicationbetweenteams .thisalsoappliestoapproaches from academia where work so far either focuses on centralization cf.
section .
.
and10.
which counteracts the decoupling of the teams or does not provide executable descriptions of the infrastructure cf.
section .2and10.
which hinders automation.beyondpreviouswork westrivetoprovidedecentralizedand automatedmanagementfor dependencies among deployments.
in this paper we conduct an empirical cross sectional online questionnaire survey on it professionals highlighting the issue ofmanualcoordinationandshowingtheneedforbetterautomation in devops.
we close this gap by proposing s muse a noveliacsystem.
sfullyautomatesdeploymentcoordinationina decentralizedfashion enablingteamstoexecutetheirdeployments independently and asynchronously with no need for manual coordinationbetweenteams.
sdeploymentsdecentrallyensurethat servicesareonlydeployedwhentheirdependenciesareavailable and undeployed otherwise.
we show that seffectively automates the deployment coordination for a representative service based application on aws we run benchmarks indicating no performance overheadcomparedtoindustrial strengthcompetitors andweport third partyprojectsto s.in summary we survey it professionals showing that application dependenciesareverycommonandthat inpractice developersresort to manual coordination for correctdeployments.
wedesign s aniacapproachthatensurescorrectdeployment acrossteamswithneithercentralizationnormanualcoordination ensuringsafe deploymentsindevopsorganizations.
we implement sas an iac language and novel continuous deploymentruntimebyextendingthe pulumi sdk.
we evaluate s showing that it is effective in coordinating decentralizeddeployments itisefficient anditiseasilyapplicable.
the deploymentcoordination issue tobetterunderstandtheissuesrelatedtodeploymentcoordination we conducted a cross sectional self administered online questionnairesurveywith73itprofessionals1aboutsoftwaredependencies and deployment order at their organization.
the raw data and a technical report with its fulldescription and results including the adherencetothesurveystandardsoftheacmsigsoftcommunity are publiclyavailable underccby .
.
therespondentshavevariousprofessionalexperiencelevels figure1d .
they were reached through snowball sampling in the authors personal network and via socialmedia .
their companies cover a broad spectrum of sizes figure 1e and sectors figure 1a .
most participants have development or operations 1assuming55.3millionitprofessionalsworldwide andaconfidenceinterval of entailsanerrormargin of .
technology financial services education ?
other a industry sector.
development engineering devops sre ops.
infra.
other b department.
asia europe north america ?
other c location.
years3 years6 years11 years years d experience.
2k2k 5k 10k e employees.
lowmediumhighelite f sdo performance.
monthly monthy monthly weekly daily g deployment frequency.
months months month week day hour h change lead time.
week week day hour i timeto restore.
j change fail rate.
figure survey demographics and sdo performance.
tasksandarelocatedineurope figures 1band1c .albeit ourdata doesnotindicatesignificantlydifferentresponsesinotherregions.
we measure the companies software delivery and operational sdo performance with an instrument by forsgren et al .
showing how well the devops goals are achieved.
it comprises deploymentfrequency leadtimefor changes delaybetween development and production time to restore service on failure and changefailrate.ourresultsforthesequestionsareinfigures1gto1j.
forsgren et al.
found that the metrics correlate and formfourclusters low medium high andelite .infigure 1f we apply this clustering to our respondents companies using minimal euclideandistance mainlyhavingmediumandhighsdoperformance .
our study leads to the following research insights.
ri1 most applications depend on other applications.
only oftheparticipants primaryapplicationsdonotrequireanother application for their correct operation while 2 5 dependencies are common .
dependonmorethan10otherapplications figure2a .
dependencies among applicationsare very common.
ri2 dependencies between applications constrain the order of their deployment.
only of the participants state that dependencies do not constrain the deployment order while answerthattheydo theanswersinbetween meanthatsome dependenciesimplyadeploymentorder figure 2b .thelikelihood of such deployment order has a significant negative correlation6 2using kruskal wallis test with posthoc wilcoxon signed rank test with .
3productmanager manager consultant coachortrainer information security c level executive releaseengineering other .
4industrials manifacturing retail consumer e commerce telecommunications media entertainment non profit healthcare pharmaceuticals government energy .
5africa oceania southamerica .
6using both kendalland spearmanrankcorrelationcoefficientswith .
58automatingserverlessdeployments fordevopsorganizations esec fse august athens greece .
.
.
.
.
a number of dependencies.
definitely probably possibly prob.
not def.
notdefinitely probably possibly prob.
not def.
not20.
.
.
.
.
.
.
.
.
.
deployment undeployment b dependency implies deploymentorder.
manual coordination combination of both automated coordination31.
.
.
c coordination method.
figure state ofdependenciesanddeployment order.
manual coordinationautomated a depl.frequency.
manual coordinationautomated b change lead time.
manual coordinationautomated c timeto restore.
manual coordinationautomated d change fail rate.
e total difference.
figure3 assumedsdoperformancecomparedtonocoordination similar worse better .
jitter added to the data points forbetter visualizationon thediscrete scales.
with the company s sdo performance i.e.
dependencies less often constraindeploymentorderinmoredevelopeddevopsorganizations.this correlation isnot significant for the order ofundeployment whichislesslikelytobeconstrainedbydependencies.still theresponsesfordeploymentandundeploymenthaveasignificant positive correlation.6in summary our survey indicates that in practice dependenciesconstraindeploymentorder eventhough this contradicts the widespread goal of idealistic loose coupling as promotedby e.g.
service basedarchitectures .
ri3 deploymentsacrossteamsneedmanualcoordination.
oftheparticipantsrelyonmanualcoordinationtoensurethe correct deployment order across teams figure 2c .
do not supportthedeploymentcoordinationwith automationat all.the more respondents rely on manual coordination the stronger they agree that dependencies constrain the deploymentorder in ri2.
ri4 it professionals think that automated coordination has better sdo performance than manual coordination.
for each sdoperformancemetric weaskedseparatelyfor automatedand for manual coordination whether they are likely to be similar better or worse compared to a scenariowith no required coordination figures 3ato3d .
in figure 3a as an example a data point meansthatbothcoordinationmethodsleadtosimilarly frequentdeployments andapoint meansthatmanualcoordination has less frequent deployments and automated coordination hasmorefrequentones.themajorityofparticipantsbelievethat automated coordination has similar or better sdo performance than manualcoordination i.e.
most data points are above thediagonal.
the sum of the differences between the scores for automated andmanualcoordinationoverthefoursdometricsyieldsthetotal differencein foreachparticipant figure 3e showingthatvpc cluster persistence registrydb load balancer webuirecommender service shared resource dedicated resourceimage auth figure components and functional dependencies of the teastore.every service is managed by adedicated team.
assume better sdo performance with automated coordination andonly assumeworse sdo performance .
oursurveyconfirmsthatapplicationsdepend oneachother ri1 oftenconstrainingtheirdeploymentorder ri2 .inmostcases manual coordination is used to ensure the correct deployment order across teams ri3 even though it professionals assume better sdo performance with automated coordination solutions ri4 .
theseresultsindicatetheneedtoautomatethedeploymentcoordinationamong teams whichwe address inthe following section.
deploymentcoordination indevops to illustrate deployment coordination techniques for devops organizations weconsidertheteastoreapplication acasestudyon onlineretailingforbenchmarkingandmodelingservicesoftware thatweuseasarunningexamplethroughoutthepaper.teastore isarepresentativecasestudyaccordingto ri1 ri4 cf.section .
teastore consists of six services figure webuiis publicly accessed through a load balancer imagehosts images auth handles authentication recommender provides product recommendations persistence isthestoragebackendforallservices backed by a database db registrylists all service instances forloadbalancing.allcomponentsresideinasingle virtualprivate cloud vpc .theyrunasserverlesscontainerservices asoffered e.g.
by aws fargate within the same container cluster and the dbisserverless too as offered e.g.
byawsrds .
teacorp teastore scompany adoptsdevops eachservicein figure4isdevelopedandoperatedbya dedicatedteammanaging the service s infrastructure and deployment.
also the webui team managesthe loadbalancer the persistence team its service s db andthe registry team maintains the sharedvpc andcluster.
.
dependenciesandcoordination the arrows in figure 4are dependencies between services e.g.
persistencedependsondbandregistry.apartfromregistry everyteastoreservicerequirestwotofive incaseofwebui other applicationsforitscorrectoperation acommoncase ri1 .dependencies between services constrain their deployment order ri2 because each service requires that its dependencies are satisfied for correct operation.
for instance before persistence is deployed dbandregistrymustbeupandrunning.symmetrically dband registry should not be undeployed before persistence.
such dependencies are not limited to services but may refer to any infrastructureentity e.g.
persistencealsodependsonthecluster.ensuring 59esec fse august athens greece daniel sokolowski pascalweisenburger andguidosalvaneschi that a service is only deployed when its dependencies are satisfied requires deploymentcoordination as we discuss next.
manual coordination.
most commonly deployments are coordinatedmanually ri3 .currentiacsolutionsprovidelimitedsupport forthisapproach eachteamindependentlymaintainsascriptfor deploying its services without any guarantee that dependencies aresatisfiedacrossteams section .
.asaresult theteamsin teacorp manually coordinate tasks and have to communicate synchronously e.g.
viachatorphone toplanthedeploymenttogether.
more advanced iac solutions still do not fully solve thisissue.
for example with pulumi stack