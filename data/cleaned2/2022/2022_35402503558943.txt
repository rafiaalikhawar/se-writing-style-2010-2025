testing of machinelearning models withlimitedsamples an industrial vacuum pumping application ayanchatterjee ayan.chatterjee kau.se deptofmathematics andcomputer science karlstaduniversity karlstad v rmlands l n swedenbestouns.ahmed bestoun kau.se deptofmathematics andcomputer science karlstaduniversity karlstad v rmlands l n swedenerikhallin antonengman erik.hallin uddeholm.com anton.engman uddeholm.com uddeholms ab hagfors v rmlands l n sweden abstract there is often a scarcity of training data for machine learning ml classification and regression models in industrial production especiallyfortime consumingorsparselyrunmanufacturingprocesses.
traditionally amajorityofthe limitedground truthdataisused for training while a handful of samples are left for testing.
in that case thenumberoftestsamples is inadequate toproperly evaluate the robustnessof the ml modelsunder test i.e.
the system under test forclassificationandregression.furthermore theoutputof these mlmodelsmay be inaccurate or evenfailifthe input data differfromtheexpected.thisisthecaseformlmodelsusedinthe electroslag remelting esr process in the refined steel industry topredictthepressureinavacuumchamber.avacuumpumping event that occurs once a workday generates a few hundred samplesinayearofpumpingfortrainingandtesting.intheabsence of adequate training and test samples this paper first presents a method to generate a fresh set of augmented samples based on vacuum pumping principles.
based on the generated augmented samples threetestscenariosandonetestoraclearepresentedto assess the robustness of an ml model used for production on an industrial scale.
experiments are conducted with real industrial production data obtained from uddeholms ab steel company.
the evaluations indicate that ensemble and neural network are the mostrobust whentrainedonaugmenteddatausing theproposed testing strategy.
the evaluation also demonstrates the proposed method s effectiveness in checking and improving ml algorithms robustness in such situations.
the work improves software testing s state of the art robustness testing in similar settings.
finally the paper presentsan mlopsimplementation ofthe proposed approachforreal timemlmodelpredictionandactionontheedge node and automated continuous delivery of ml software from the cloud.
ccsconcepts softwareanditsengineering softwaretestinganddebugging computingmethodologies machinelearning source separation applied computing industry and manufacturing .
esec fse november 14 18 singapore singapore copyright held bytheowner author s .
acm isbn978 .
data augmentation software testing vacuum pumping data decomposition machine learning mlops acm referenceformat ayan chatterjee bestoun s. ahmed erik hallin and anton engman.
.
testingofmachinelearningmodelswithlimitedsamples anindustrial vacuumpumpingapplication.in proceedingsofthe30thacmjointeuropean software engineering conference and symposium on the foundations of softwareengineering esec fse november14 18 singapore singapore.
acm newyork ny usa 11pages.
introduction machine learning ml software has grown in popularity in recent years due to the availability of massive amounts of training data andapplicationsize.whentraininganmlsoftware ingeneral the conventionalapproachistodividethedataintotrainingandtesting forregressionorclassification.alargeportionofthegroundtruth gt is often used for training leaving a fraction of the samples for test usually or less.
a problem arises when insufficient dataisavailable whichtakespracticallyallthegtfortrainingand leavesafewsamplesfortestingusingtheconventionalapproach.
for example when an event is performed n n times a day duringtheworkday suchasamanufacturing productionprocess it addsuptoroughly300ndifferenteventsperyear.deliveringstable decisionsovertimeisacriticalissueintheindustrialapplication.
therefore testingtherobustnessofsuchasoftwareproductisan essentialqualityassurancecheck.robustnessisanon functional quality attribute of ml software.
testing the robustness of ml software under limited data conditions is underexplored in the literature.
the question remains whether these limited data are sufficient to render a robust ml model using the conventional training test split strategy.
aninstancewhere there areinsufficient dataavailable isinthe refined steel industry specifically vacuum pumping in the electroslag remelting esr process .
the process includes furnace cleaning which requires vacuum pumping or extractingoxygenfromthefurnace.aspartoftheesrprocess whena vacuumpumpingeventoccurs thesensorsattachedtothechamber collect data on the total pressure inside the chamber.
the pumping process is terminated when the desired pressure threshold is reached.predictingtheminimumpressureofavacuumchamber earlyinthepumpingprocesscanpotentiallyidentifyissuessuch aspumpfailuresandleaks.however apumpingeventoccursonce adayonaverage andgenerates afew hundredevents inayearto splitbetweentrainingandtest.inthiscase foranmlmodel there thiswork islicensedunderacreativecommonsattribution4.0international license.
esec fse november14 18 singapore singapore ayan chatterjee bestoun s.ahmed erik hallin andanton engman are only a few hundred occurrences to divide between training and test data.
it becomes difficult to obtain the appropriate test data to determine whether the ml model for pressure prediction is overfitting .
theoretically to avoidoverfitting oneof thefollowingsteps is taken i removing features such as random forest ii increasingtheamountofdataavailablefortraining iii performing cross validation or with iv regularisation which includes calibratingthehyperparametersforthegivendata.dataaugmentation isonesuchtechniqueforgeneratingslightlyalteredcopies of existing data or creating new synthetic data and boosting the numberoftrainingsamplesavailable.weusedataaugmentationin anewindustrialapplicationintheesrprocess.thedataaugmentation technique and the testing approach discussed in this paper are based on the general principles of vacuum engineering.
vacuum pumping isusedacrossmultiple domains includingfusionpower plants and euv lithography for global silicon manufacturing .
this paper focused on esr due to the availability of pumping datafromtheuddeholmsab steelcompany.however inprinciple this augmentation and testing techniquecan be applied inmultiple disciplines where vacuum pumping is part of the manufacturing process.
thisstudyoffersafreshperspectiveondataaugmentationfor vacuum pumping from the software testing point of view.
the approach presented in this paper first decomposes the data using domain knowledge and then generates random and fresh samples utilizingtheconceptsofvacuumpumping.althoughthisbodyof work focuses on vacuum pumping for the steel industry which is comprised of well modeled concepts the decomposition and augmentationtechniquecanbeappliedtootherdomains.forthe generalcase thegtcanbedecomposedtoitsfundamentalbasis usingapproacheslikeblindsourceseparation fordomainsthat do not have well modelled relationships which is subsequently utilized to generate augmented data.
the newly generated augmented data are then used to assess ml models robustness on an industrial scale.
here careful test scenarios were designed to determine the end to end functionality of the ml systems.
each scenarioiscombinedwithatestoracletodeterminethepassand failcasesduringrobustnesstesting.theoraclehasbeendesigned from a combination of theory and domain knowledge background in industrial production.
therefore ml models are subjected to robustnesstesting animportantnon functionaltestingproperty of ml software .
here robustness testing is used to ensure thattheyworkasexpectedwithgtdata remainwithinphysical constraints and in theory are resilient to future unknown data.
to assess the robustness in the presence of limited data this paper makesthe following contributions a data augmentation approach for esr vacuum pumping is developedthatusesdomainknowledgetogeneratesynthetic data.
a strategy is developed to evaluate the robustness of an ml model based on real and augmented data to compensate for insufficientgt test data.
thepaperusedrealdatafromsteelproductionandmlmodels onan industrialscale.
an mlopsimplementationofthe proposedapproach.the remainder of the paper is structured as follows.
section gives an overview of ml training with small samples and vacuum pumping theory to describe the principles underlying the data decomposition and pumping speed dictionary mentioned in the proposed work.
the subsequent section 3describes i an efficient data augmentation approach for vacuum pumping and ii tests to evaluate the robustness of a trained ml model.
section 4shows howtheproposedapproachisusedinindustrialproduction where training testing and real time prediction and actions of the ml softwarearecarriedoutautomatically followedbysection 5which contains experiential results.
section 6concludes the paper and providesfuture directions for continuing this study.
backgroundand related work .
smallsampleml anddata augmentation smallsampleshavelowstatisticalpower makingitdifficultforthe mlsoftwareto trainrobustly .itisdifficulttoaccuratelypredict performance from a small set of measured variants especially ifthosefeaturesinteract.anapproachtostatisticallearningperformancepredictionthatconsidersvariabilityispresentedinthepaper by guo et al.
.
the method uses a series of random samples to detect feature interactions step by step without additional effort.
the method investigates and exploits the correlation between featureselectionsandperformancetopredictperformanceinaconfigurablesoftwaresystem.thiscorrelationcanbeeasilyrevealedby measuringtheperformanceofallsoftwaresystemconfigurations and then providing direct answers e.g.
which configuration is the fastest .in addition small sample mlrequires arobustvalidation method.
the simulations in vabalas et al.
s paper show that thek foldcross validationproducesstronglybiasedperformance estimateswithsmallsamplesizes andthebiasisstillapparentwith sample sizesof1000.
increasingthetrainingsamplesizeinaprincipledmannerisa constant demand for ml software.
increasing training data with dataaugmentationimprovedaccuracyinvariousareas.twokey categoriesaredefinedinthesurveypaperbywenetal.
ontimeseries data augmentation basic and advanced.
basic approaches include the time domain the frequency domain and the timefrequencydomain whichincludeaugmentationapproachessuch as noise injection flipping and jittering.
advanced methods include decomposition statistical generative models and learning.
thesurvey sprimaryfocusisonclassimbalanceanddataaugmentation for members of the minority class.
among other methods generative adversarial networks gans have been shown to be abletoproduceartificialdatathataresimilartotherealdata.when faced with the problem of unbalanced data classification gans can provide an alternative solution.
by generating artificial data that are similar to the original data and thus augmenting the trainingdataset ganscanbeusedfordataaugmentation.gans for example in the papers by shao et al.
ortego et al.
and more recently in jain et al.
are intended to produce realistic synthesizedsignalswithlabels forfurther useinmachine faultdiagnosis.alimitationofsuchmethodsisthatallaugmentedsamples producedmaynotbephysicallyplausibleandmayshowunrealistic artifacts.arecentstudybyleeandlee presentsauniquedeep 1281testingof machinelearning modelswithlimitedsamples anindustrialvacuum pumping application esec fse november14 18 singapore singapore learning methodology for evaluating the interior noise in automobiles.the method usesdomainknowledgefor dataaugmentation and for model development has seen substantial increase in ml software accuracy.thus unlike other approaches thispaper expands on data augmentation in esr and proposes a new method that combines domain knowledge and ml to test the robustness of such software products.
.
esr vacuumpumping theesrprocessinvolvesremeltingtheconsumableelectrodeas thesteelisrefinedandsolidified .figure1depictstheschematic diagram of the esr where the region above the slag requires nearvacuumconditionstoavoidcontaminantsduringtheprocess.as aresult thevacuumpumpsattachedtotheesrpumpoutexcess oxygen orair from the chamber.
ingotliquid poolslag vvacuum electrode figure schematicsketchofesr.
theoretically vacuum pumps in the esr process reduce the number of gas molecules ina vacuumsystem by creating a volume flow determined by the rate at which the pressure in a vacuum systemofconstantvolumedecreasesovertime .whenpumping occurs theoverallpressureinsideachamberisdirectlyproportional to the amount of gas extracted by the pump and therefore there is less leakage and flow through the inner surfaces of the chamber.
theamountofgaspumpedoutandtheamountofgasthatleaksin are constantly changing over time.
dmitrieva et al.
describe the total pressure inside a vacuum system at a time t as pt with an initialpressureof p0 thevolumeofthevacuumpumpchamber vc theaveragepumpingspeed s theleakageflow ql andthe flowfrom the innersurfaces qi whichis pt ql qi s p0 ql qi s e ts vc in the above equation qldepends on the total conductance that determines the aggregate bandwidth of all leaks.
and qiis proportionaltothesurfaceareaofthevacuumchamber adegassing coefficient and a constant that depends on the material and roughnessofthevacuumchamber.however inpractice avacuumpump canonlylowerthepressuretoacertainpoint andthetimetaken isreferredtoasthepump downtime.anapproximatemodel with effective pumping speed st at pump down time t is given as st vc tln pt p0 the pumping event is not a common occurrence in real production.forexample inasteelcompanysuchasuddeholmsab insweden forwhichthisstudyisconducted thepumpingevent occurs once a day on average for approximately twenty minutes to pump out oxygen from the vacuum chamber.
after pumping for twentyminutes expertsinspectthechambertoensurethatitmeets qualitystandardsbeforemovingontothenextphase suchaschecking internal pressure.
if the quality requirements are not achieved the chamber is inspected and re pumped for an additional twenty minutes.
the role of ml in this situation is to observe the first few seconds or a minute of pumping and to forecast the minimum pressure.
in this case accurate pressure forecasts save valuable time and increase production efficiency with an early decision and action.
however with the limited occurrence of the event a few hundredsamplescanbegeneratedinayearofpumpingfortraining andtestingthatwillaffecttherobustnessoftheimplemented ml model.
the proposedapproach this paper presents two concepts for the esr vacuum pumping applicationwithlimitedtrainingdata i datadecompositionand augmentationtogeneratenewvacuumpumpingdata and ii tests forevaluatingtherobustnessofatrainedmodelusingthegenerated augmenteddata andnewtest scenarios.
.
augmented samplegeneration a three step strategy is designed togenerate augmented dataand address the scarcity of training data for vacuum pumping.
the first step is to decompose the gt and interpret the initial pressure andpump downtime.second adictionaryofpumpingspeedsis constructedthatisindependentoftheinitialpressure.thefinalstep generates sparse representations for the dictionary and produces a fresh set of augmented samples.
the following subsections address thesesteps.
.
.
decomposingthegtdata.
eachpumpingeventisaseparate anddistinctoccurrence.foragivenvacuumchamber i.e.
aconstant volume equation 2mandates that one must understand st t andthe p0 inordertointerpret pt .atminimumpressure all three mentioned variables are scalars.
however a vector is formed forstwhen we look at the entire pumping period t to t .
we take theapproach to decomposethe ground truth by interpreting thep0andtdistributionsandextractingthe stintoadictionary or a matrix containing only the unique stvectors.
as a result we use the central limit theorem and the law of large numbers to approximate the initial pressure and pump down time as a gaussiandistribution.althoughfuturepumpingoccurrencesare unknown this assumption will in principle assist a regression pressure prediction model in learning about the different pumping events in a proactive manner.
the mean and standard deviation of the distributions for p0andtare computed using the maximum likelihoodestimationfrom ground truth data.
.
.
extractingadictionaryofpumpingspeeds.
afterobtaining thep0andtdistributions thenextstepistoobtainthepumping 1282esec fse november14 18 singapore singapore ayan chatterjee bestoun s.ahmed erik hallin andanton engman speedssper unit volume at regular intervals.
because the amount of gas coming in and going out changes over time we extracted allsfrom equation .
the collected swas then reduced to the independent pumping speeds to a dictionary ds rx y ds s assuming a simplex and linear mixing.
mathematically for an acceptable residual error andarepresentation itisgiven as min ds r ds row 0s.t.
s ds .
.
generatingaugmentedsamples.
oncetheparameters p0and tfromsection .
.
andadictionary dsmentionedinsection .
.
for the vacuum chamber and pump setup are determined the next step is to generate as many augmented samples m m n as are required.
for each of the msamples a sparse vector ry isgeneratedatrandom resultinginauniquepumpspeedthatis a fractional combination of historical events.
the mathematical conditions of are y y 0and afterthat arandominitialpumpspeed p0andpump downtime taregeneratedfortheirrespectivedistributions andaconvolution operation with equation 2creates a unique augmented sample.
thisaugmentedsamplediffersfromthegtdatawhileremaining withintheconstraintsof vacuumpumping sphysicalcapabilities.
theprocedureisrepeatedmtimestoyieldmuniquesamples.a diagram of the proposed data augmentation is depicted in figure .
extract ds dic onary ground truth augmented data augmented datagenerate sparse representa on extract p0andt distributions new p0andt figure2 adiagramshowingtheproposeddataaugmentation techniqueforesrvacuumpumping.
.
teststo evaluate robustnessofatrained ml model once an ml model is trained using augmented data it must be testedtoensurethatitisrobust.weproposethreetestscenarios to evaluate the robustness of the model.
each of the three test scenarios addresses aunique concern whichare as follows feasibility test scenario is to see if the trained model remainswithin the physical limits of vacuum pumping.
gttesting examinesthetrained model saccuracy and its performance when appliedto knowndata.
volume enclosed testing under a given residual error examines how well the trained model should operate under theconstraints ofvacuumpumping e.g.
incaseofa driftin the data orchanges inthe pumping conditions .
dependingontheapplication ssensitivity theresultsfromthe scenariosarecollectedintoatestoraclethatdeterminesifanapplied robustnesstest ofthe machine learningmodelispassedorfailed.
.
.
feasibilitytestscenario.
thefeasibilitytestscenarioensures that a trained model stays within the physical limits of vacuum pumping.
this scenario warrants that no direction from initial pressure and pump down time is impractical i.e.
the predicted pt isalwayspositivewhen p0andtarepositive.mathematically itis p0 0andt pt .
.
testing the gt.
after the feasibility test we have a scenario that uses the ground truth and a scenario that uses augmented data.
the second test scenario evaluates the residual error of the data from the ground truth test data.
the mean absolute error mae equation also known as the manhattan distance or the l1 norm of the residual error divided by the number of observations and the goodness of fit measure r squared r2 equation value.
an additional l with the real and augmented data shows the maximum expectedprediction errorfor the given data.
mae a b summationtext.1n i ai bi n r2 a b summationtext.1n i ai bi summationtext.
i ai a where a nn i 1ai .
.
volumeenclosedunderagivenresidualerror.
thethirdtest scenario involves estimatingthe volume of occupied spacewithin a specified residual error threshold.
a higher volume indicates a more robust methodforthegiven data andthreshold.
agraphical illustration ofthe concept isshowninfigure .
thistestretrievesaugmentedsampleswhoseresidualerrorisless than a specified threshold t .
afterward the linearly independent columns are located.
in the end the determinant method is usedto compute the volume whichis v p det pt p d !
where p 1283testingof machinelearning modelswithlimitedsamples anindustrialvacuum pumping application esec fse november14 18 singapore singapore theoretical pumping possibilities augmented data observed ground truth pumping data where prediction is under acceptable threshold figure3 atwo dimensionalillustrationoftheareaenclosed by the residual error under a desired threshold of pumping measurements.
.
.
testoracle.
inthefinalphase theresults outputofthethree testscenariosarefedintothreesub oraclesandthentothemain oracle.
figure 4displays the flow diagram of the sub and main oracles.
scenario feasibility test scenario ground truth testing scenario volume enclosed testing oracle oracle oracle main oracle figure4 robustness testingtestoraclefortheesrvacuum pumping oracle the first sub oracle or oracle is to identify whether a vacuum pump pressure prediction ml model predicts positive valueswith the augmented samples.
if any of the augmentedsamples as inputreturnsa negative pressure themlmodelundertestisconsideredafailureofthetest.
mathematically itisgiven by pt braceleftbigg1 pass fail oracle the second sub oracle gets its input from scenario2 orground truthtesting .thesub oraclecompares the predicted values scores against acceptable thresholds determined by field experts.
selecting thresholds is about determining how pure each block of steel should remain.
in principle ahigherminimumpressure means thatmore gasmoleculesremaininthechamber reactingwiththesteel duringsubsequentproductionprocessesaftervacuumpumping.
the output of this sub oracle determines whether a ml modelmeetsthethresholdrequirementsoftheapplication.for example for a given threshold of t for the mae the pass failcriteriais mae braceleftbigg t pass t fail oracle the third sub oracle inputs two volume measurementsfromthevolumeenclosedtestingscenario thevolume of the augmented sample space in its entirety vtot and the volume of the augmented data space vt which is under thefieldexpertdeterminedthreshold.theratioofthetwo volumesiscalculated andthepass failcriteriaisgiven by a threshold tv as vt vtot braceleftbigg tv pass tv fail onceanmlmodelundertestpassesthesub oracle the vt valueispassedonto the main oracle.
main oracle the main oracle takes input from all three sub oracles and determines the robustness of the ml model.
arobustmodelmuststaywithinthephysicalboundary i.e.
passed the oracle meet the business requirements i.e.
passedtheoracle2 andbeabletoadapttoslightchangesin the gt data i.e.
passed oracle .
however suppose that an mlmodelundertestpassesoracles1and2only.inthatcase itsuggeststhatthemlmodelfairswellwiththegtdata but any deviation or drift may produce unreliable predictions or be less robust.
for this reason the main oracle considers an ml model under test a robust model when it has passed all threesub oracles.finally amongseveralmlmodelsunder testthat passed themain oracle themost robust ml model is the one with the largest volume demonstrating resilience towards changes in the gt while delivering the required accuracyinthe currentdata.
mlopsimplementation continuous and automated ml software development also known as mlops is becoming increasingly popular as a result of the success of continuous software development devops in particular.
thispaperdescribesanearly stageimplementationtocontinuously delivermlsoftwareintheesrfortheproposeddataaugmentation andtestingapproach.thearchitectureoutlined infigure 5shows the proposed implementation with services and microservices split betweencloudandedgenode.serviceslikemlsoftwaretraining and retrainingand the persistent storing of pumping dataare executedinthecloud.microservicesattheedgeoperateinreal time makingdecisions andtaking action automatically.
.
real time predictionandaction automatedandreal timedecisionsinproductionaremadepossible by containerizedmicroservicesontheedgenode.agreattoolfor creating containerized applications is docker1 .
during vacuum pumping the deliveryandcollection microservicereceivesrealtime data from pressure sensors attached to the esr.
the real time streamingdatapipelinesandapplicationsbuiltwithapachekafka2 is an example of delivery and collection .
after t seconds after 1284esec fse november14 18 singapore singapore ayan chatterjee bestoun s.ahmed erik hallin andanton engman microservices on edge node delivery and collection servicesvacuum pump pressure predictionaction servicepersistent storage api layervacuum pump pressure prediction ml model training service automated deployment actuator display outputesr vacuum pump pressure sensordata augmentation ml model training ml model testing cloud or offline real time or online figure data pipeline for mlops implementation of the proposed approach in industrial setting enabled by a combination of i sensor actuator and edge microservices light blue for real time analysis prediction and action and ii cloud services light green foroffline ml software training andtesting.
pumping delivery and collection microservice transmits the collecteddatatothe vacuumpumppressureprediction microservice where the ml model trained by our proposed approach is run.
the mlmodelpredictswhetherornotthedesiredminimumpressure willbereachedandsendsthepredictedminimumvaluetothenext microservice action .
the action microservice signals the actuatortostoppumpingwhenthepredictedminimumdoesnotmeet the expected requirements in a fully autonomous setup.
alternatively or in addition the action microservice sends a signal to displaythepredictedminimum forahumanfieldoperatorto take appropriate steps.
the action microservice is customizable based onthe business needs.
.
continuousandautomated ml software training anddeployment inordertoprovidecontinuousdeliveryofthemlvacuumpump predictionsoftware dataflowsfromthesensorsattachedtoesrto the deliveryandcollection microserviceontheedge.thepumping dataissubsequentlyforwardedtothecloudforlong term persistent storage.theapilayerinthecloudoffersaninterfacebetween microservicesontheedge cloudservices andpersistentstorage.
the ml software with the proposed approach is then trained with the historical pumping data and when an ml model passes our proposedmainoracle anewversionofthemlpredictionsoftware container is automatically deployed to the edge.
at the currentstage the ml model is trained periodically after a few months however future work in the architecture will involve the research onadditionalmicroservicestodetectandclassifymodeldegradationandtrigger are training automatically.
experimentalevaluation and results .
datasetandml methods the experiments carried out in this paper are using proprietary data from uddeholms ab on two furnaces of equal volume and manufacturingspecifications termed furnacem and furnaces.
fromjanuarytooctober2021 furnacemhas203events subfigure a infigure andfurnaceshas107events subfigure c infigure .forthisexperiment thegoalofthepressurepredictionmodel is to predict the minimum pressure in mbar reached after twenty minutes of pumping based on the data collected during the first minuteofpumping subfigure b infigure .
three machinelearning approachesare evaluatedin thispaper using the default settings in matlab s i optimizable ensemble3 optensemble ii asingle layeredneuralnetwork nn and iii optimizable gaussian process regression5 or opt gpr .
bayesian 1285testingof machinelearning modelswithlimitedsamples anindustrialvacuum pumping application esec fse november14 18 singapore singapore time s 020040060080010001200pressure mbar a esr m time s 20030040050060070080090010001100pressure mbar b first minute of a taken as input for prediction time s 020040060080010001200pressure mbar c esr s figure6 twoesrpumpsaredepictedinthisfigure pumpmin a andpumpsin c .subfigure b displayspumpingdatafrom thefirstminutethat isutilized as input to aml modelforpredictingtheminimumpressure.
optimization6wasusedtooptimizethemodels hyperparameters duringrun time.similaroptimizersexistinotherplatforms such as hyperopt in python and the paper by bergstra et al.
which use random search and two new greedy sequential methods based on the expected improvement criterion to optimize hyperparameters.the hyperparameters are mentionedintable .
table table showing the optimized ensemble and gpr hyperparameters and the default hyperparameters of the singlelayered nn.
model hyperparameters method bootstrapaggregation bagging number oflearners opt ensemble minimum leafsize number ofpredictorsto sample layer size nn activation relu standardize data yes sigma .2e basis zero emptymatrix opt gpr kernelfunction nonisotropicexponential standardize data yes ourproposeddataaugmentationmethodandtheclassical traditional approaches under test are both trained on like for like conditions with matlab s bayesian hyperparameter optimizer in this paper.
using the conventional training test split approach referred to as classic in tables and figures and augmentedsamples referredtoas aug intablesandfigures all three approaches were trained using furnace m data.
classic methods use of gt data for training while aug approaches train withtheaugmentedsamples.aftertraining themodelsweretested ondata from furnaces.
data decompositionandaugmentation thefirststageindataaugmentationofthepumpmdataisusing maximum likelihood to estimate the distributions of initial pressure p0 andpump downtime t .thedistributionsof p0andt respectively aredepictedinsubfigures a and b infigure .the pumping speeds st are then calculated using equation .
after that the gt data is converted from temporal domain to a timeindependentsparsedomain.inotherwords allindividualpumping datawiththeirownlengthfromt 0tothepump downtime t are interpolatedtothesamelengthusingcubicsplineinterpolation7.
withanaveragepump downtimeof333s weselectedadictionary resolution or length of .5x to capture minute changes in pumpspeeds.thecollectionofallpumpingspeedsisthensubsetto theindependentpumpingspeedswithagreedydictionarylearning approach presentedinalgorithm .
algorithm pseudocode for the extraction of the pumping speed dictionary input s whilestoppingcriteriafor do f ds s representation s ds residual error sm argmax p sm element withmax ds ds uniontext.1sm add selected smtods end while output ds inprinciple therepresentationisan l0minimizationproblem which is np hard is often approximated to l1or in this case we choose the greedy approach which is dts s. this approach iteratively selects the pump speed with the highest residual that is orthogonal to the previously selected pumping speeds.
with a smallresidualerrorof1e 03for thedictionaryselects40different pumping speeds.the outputdictionary isshowninfigure 7c.
after decomposing esr m data a random sparse representation and a random initial pressure p0 and pump down time t are 1286esec fse november14 18 singapore singapore ayan chatterjee bestoun s.ahmed erik hallin andanton engman pressure mbar esr m ground truth estimated distribution a initial pressure p0 time s esr m ground truth estimated distribution b pump down time t .
.
.
.
.
.
.
.
.
101pumping speed per unit volume c pumping speeddictionary figure7 figureshowingthedistributionsoftheesrm sinitialpressurein a withameanandstandarddeviation1e .
andpump downtimein b withameanandstandarddeviationof333.
.
.subfigure c showstheextracted pumping speed dictionary.
.
.
.
.
.
.
.
.
.
.
.
dictionary element time s pressure mbar representation figure8 threeexamplesofaugmentedsamples eachwithapump downtimeof218 and222seconds respectively topto bottom andwith initial pressuresof1007.
.
and996.
mbar respectively.
generated for augmented data generation.
p0andtare generated with pearson system random numbers8within the limits of the gt data.figure 8showsthree examplesofaugmentedsamples.
theprocedureisrepeatedfor100kaugmentedsamplesinthis experiment.
the augmented data of all samples is shown in figure .
testingtheml models .
.
feasibility test.
when all six models three with classic and three with aug are run through the feasibility test both opt ensembleandoptgprpassthetest.incontrast theclassicnnfailed thetest predictinganegativepressurefromtheaugmenteddata.
despite the fact that five out of six models predicted only positive values.
1287testingof machinelearning modelswithlimitedsamples anindustrialvacuum pumping application esec fse november14 18 singapore singapore table2 residualerror ofthe sixmodels in furnacem furnaces andthe maximumerror observed in the augmented data.
since aug models were trained using augmented samples they use of gt data for testing unlike classic approaches that use only20 ofgt data fortesting.
furnacem furnaces augmae model maer2l maer2l l s m opt ensemble classic .
.
.
.
.
.
.
.
opt ensemble aug .
.
.
.
.
.
.
.
nn classic .
.
.
.
.
.
.
.
nn aug .
.
.
.
.
.
.
.
opt gpr classic .
.
.
.
.
.
.
.
opt gpr aug .
.
.
.
.
.
.
.
a 100ksamples of augmenteddata pressure mbar at10s020040060080010001200pressure mbar at270saugmenteddata groundtruth augmenteddata fillingthegaps b gtand augmenteddata differences figure9 augmentedpumpingdatafromdecomposedesr mgt.
.
.
testing the gt.
if a model passes the feasibility test this scenario calculates the residual error with ground truth data.
with 60secondsofinputdata theresidualerror betweenthepredicted minimum pressure and the actual minimum pressure is calculated.
table2shows mixed mae outcomes between furnace m and s individually between classic and aug training.
however there is an increase inthe r2score andconsistency intheresultsbetween bias and variance when trainedwith augmentedsamples.figure 10illustrates the improvements showing that training with augmenteddatasurpassestheclassicaltechnique inadditiontospikes anddeviations.
.
.
volumeenclosedunderagivenresidualerror.
thelasttest estimatesthevolumeofthetrainedmodelintemporalspacewhose residualmaeerrorisbelowtheacceptableerrorthreshold.forthis experiment athresholdof1mbardeterminedbyuddeholmfield experts is selected.
when the data is collected once per minute we have60temporaldimensionswiththefirstminuteofpumpingdata as input.
table3shows that compared to classic models the enclosed capacityforaugmodelshasincreaseddramatically.however all sixmodelscoverlessthan0.
ofthewholeaugmentedsample space necessitatingfurtherresearchintoadeeplearningmodelfor vacuum pumping predictions.
table3 volumeenclosedbyaugmentedsamplesfor60seconds of pumping data whose prediction residual error is below the threshold of mbar.
the volume of augmented data inthisspaceis1.1331e .
model volume increase opt ensemble classic .46e opt ensemble aug .39e .85e nn classic .86e nn aug .93e .96e opt gpr classic .25e opt gpr aug .48e .98e .
.
the test oracle.
finally the output from the feasibility test andthefindingsfrom tables 2and3are inputintothetestoracle to measure the robustness of the six ml models under test.
the thresholds for the pass fail criteria for each sub oracle will vary according totheapplication ssensitivity.for this experiment we 1288esec fse november14 18 singapore singapore ayan chatterjee bestoun s.ahmed erik hallin andanton engman pumpingeventminimumpressure mbar groundtruth furnaces opt.ensemble classic opt.ensemble aug a optensemble pumpingeventminimumpressure mbar groundtruth furnaces nn classic nn aug b nn figure10 afigureshowingthe predictionof optensemble andnnmodels with bothclassicandaug training.
used the following thresholds determined by field experts mae of .
mbar r2threshold of .
l threshold of mbar and volume belowtheresidualerrorthresholdof1.0e .twoofthesixmodels pass the three sub oracles and the main oracle opt ensemble and nn werebothtrainedusingaugmentedsamples.and basedonthe volumeenclosed optensemble aug covers 330xmorevolume than nn aug making opt ensemble trained with augmented samples the mostrobust ofthe six models.
conclusion in this paper we show that the traditional split between training and testing insoftware testing is inadequate for machine learning with small samples.
furthermore this paper improves on the state of the art software testing practices in robustness testing and presents a data augmentation technique that comprises newlydevelopedtestscenariosandoraclestodetermineatrainedmodel s robustnessintheabsenceofsufficienttrainingandtestdata.the earlyexperiments suggestthataddingaugmenteddatagenerated by the proposed approach to ml models training improves the testdatapredictionaccuracyand moreimportantly reducesthe bias and variance difference between different vacuum pumping production dataforesrapplications.
additionally we identified that the six ml models under test do not capture events where the minimum pressure deviates substantially from the training distributionmean whichwillbeinvestigatedinfutureworkand require the development of a bespoke model for vacuum pumping application.
the augmentation and testing approach is designed to aidfuture modeldevelopmentandhowtodesignarobusttesting methodology when workingwithsmall sample ml.
in the future further model investigation will need to be carried out including research into deep learning and the integrationanduseofseveraltrainedmodelssimultaneously.thispaper presentsourbestpracticetodateinaddressingqualityassurance challenges in an mlops workflow.
although the paper focuses onvacuumpumpinginthesteelproductionindustry robustness testingmethodologyandgeneralqualityassuranceworkflowcan be appliedacrossmultiple disciplines.