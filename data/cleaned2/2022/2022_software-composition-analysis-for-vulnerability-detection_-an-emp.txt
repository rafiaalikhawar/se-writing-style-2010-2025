singapor e management univ ersity singapor e management univ ersity institutional k nowledge at singapor e management univ ersity institutional k nowledge at singapor e management univ ersity resear ch collection school of computing and information systems school of computing and information systems softwar e composition analysis for vulner ability detection an softwar e composition analysis for vulner ability detection an empirical study on ja va projects empirical study on ja va projects lida zh ao sen chen zhengzi xu lyuye zh ang jiahui wu see next page for additional authors follow this and additional works at https ink.libr ary.smu.edu.sg sis r esear ch part of the softwar e engineering commons citation citation zhao lida chen sen xu zhengzi zh ang l yuye wu jiahui sun jun and liu y ang.
softwar e composition analysis for vulner ability detection an empirical study on ja va projects.
.
esec fse pr oceedings of the 31st a cm joint e uropean softwar e engineering conf erence and symposium on the f oundations of softwar e engineering san f rancisco december .
.
available at available at https ink.libr ary.smu.edu.sg sis r esear ch this conf erence pr oceeding ar ticle is br ought t o you for fr ee and open access b y the school of computing and information systems at institutional k nowledge at singapor e management univ ersity .
it has been accepted for inclusion in resear ch collection school of computing and information systems b y an authoriz ed administr ator of institutional k nowledge at singapor e management univ ersity .
for mor e information please email cher ylds smu.edu.sg .
author author lida zh ao sen chen zhengzi xu l yuye zh ang jiahui wu jun sun and y ang liu this conf erence pr oceeding ar ticle is a vailable at institutional k nowledge at singapor e management univ ersity https ink.libr ary.smu.edu.sg sis r esear ch software composition analysis for vulnerability detection an empirical study on java projects lida zhao nanyang technological university singapore lida001 e.ntu.edu.sgsen chen college of intelligence and computing tianjin university tianjin china senchen tju.edu.cnzhengzi xu nanyang technological university singapore zhengzi.xu ntu.edu.sg chengwei liu nanyang technological university singapore chengwei001 e.ntu.edu.sglyuye zhang nanyang technological university singapore zh0004ye e.ntu.edu.sgjiahui wu nanyang technological university singapore jiahui004 e.ntu.edu.sg jun sun singapore management university singapore yangliu ntu.edu.sgyang liu nanyang technological university singapore yangliu ntu.edu.sg abstract software composition analysis sca tools are proposed to detect potential vulnerabilities introduced by open source software oss imported as third party libraries tpl .
with the increasing complexity of software functionality sca tools may encounter various scenarios during the dependency resolution process such as diverse formats of artifacts diverse dependency imports and diverse dependency specifications.
however there still lacks a comprehensive evaluation of sca tools for java that takes into account the above scenarios.
this could lead to a confined interpretation of comparisons improper use of tools and hinder further improvements of the tools.
to fill this gap we proposed an evaluation model which consists of scan modes scan methods and sca scope for maven ssm for comprehensive assessments of the dependency resolving capabilities and effectiveness of sca tools.
based on the evaluation model we first qualitatively examined sca tools capabilities.
next the accuracy of dependency and vulnerability is quantitatively evaluated with a large scale dataset maven modules with unique dependencies under two scan modes i.e.
build scan and pre build scan .
the results show that most tools do not fully support ssm which leads to compromised accuracy.
for dependency detection the average f1 score is .
and .
for build and pre build respectively and for vulnerability accuracy the average f1 score is .
.
however proper support for ssm reduces dependency detection false positives by .
and false sen chen and zhengzi xu are the corresponding authors.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse december san francisco ca usa copyright held by the owner author s .
publication rights licensed to acm.
acm isbn .
.
.
.
by .
.
this further leads to a reduction of .
in false positives and .
in false negatives in vulnerability reports.
ccs concepts software and its engineering software libraries and repositories security and privacy software security engineering general and reference empirical studies .
keywords sca package manager vulnerability detection acm reference format lida zhao sen chen zhengzi xu chengwei liu lyuye zhang jiahui wu jun sun and yang liu.
.
software composition analysis for vulnerability detection an empirical study on java projects.
in proceedings of the 31st acm joint european software engineering conference and symposium on the foundations of software engineering esec fse december san francisco ca usa.
acm new york ny usa pages.
introduction open source software oss is getting increasing attention in software communities.
programmers import the oss as third party libraries tpls to avoid redundant development and boost software development .
however importing oss as dependencies also brings critical security threats .
for example in remote execution vulnerabilities were revealed in a critical oss named apache log4j2 .
more than java packages are affected which accounts for roughly of the packages in maven central repository .
therefore individual developers and companies urge to determine whether their projects have introduced vulnerable versions of log4j2 as dependencies.
to protect software from such security threats from tpl software composition analysis sca tools have been proposed and widely adopted to identify tpl reuse and to expose the hidden vulnerability threats.
with the growing complexityesec fse december san francisco ca usa lida zhao sen chen zhengzi xu chengwei liu lyuye zhang jiahui wu jun sun and yang liu figure overview of our work of software functionality sca tools are facing various scenarios.
firstly the working environment and target project format are diverse.
throughout the devsecops process artifacts transition between different formats e.g.
source code binaries in different environments e.g.
code repositories deployed runtime .
secondly dependencies can be introduced by various approaches such as through package managers or manual imports.
thirdly different package managers maintain distinct dependency specifications for flexible dependency management such as version control.
additionally some package managers have unique designs for specific features such as peer dependencies in npm and dependency scopes in maven .
in summary there are three diversities that sca tools need to consider including diverse formats of artifacts diverse dependency imports and diverse dependency specifications .
to get a deeper insight into the sca tools some research has been conducted.
nasif et al.
studied the differences among nine sca tools by comparing the vulnerability results to provide insights into the adoption of sca tools for both java and javascript.
andreas et al.
evaluated the robustness of sca tools in detecting vulnerabilities from tpl by four types of jar java archives modifications i.e.
patched uber jar bare uber jar and re packaged uber jar .
however the existing studies only peek into the performance of sca tools by directly comparing the vulnerability results.
they neglect the uneven capabilities of resolving dependencies and the various scenarios that sca tools encountered.
in fact there is still a lack of comprehensive assessments of the sca tool s dependency resolution capabilities that take into account the above.
such a lack could lead to a confined interpretation of comparisons improper use of tools and hinder further improvements of the tools.
to fill this gap we proposed an evaluation model which is a guideline for a comprehensive assessment of the dependency resolution capabilities and effectiveness of sca tools for java.
in correspondence with the three diversities the evaluation model evaluates sca tools from three aspects scan modes scan methods and scan scopes .scan modes consider the various working environments and formats of target projects scan methods consider the tpl detection algorithms scan scopes considered the range of dependencies to be included.
by following the evaluation model we can have a deep insight into the strength and weaknesses of the evaluated tools.
our objective is to evaluate the performance of state of theart sca tools in their applicable scenarios based on the proposed evaluation model and to seek further improvements.
figure gives an overview of our work.
based on the three diversities encountered by sca tools we proposed the evaluation model and introduce the three evaluation aspects in section including scan methods scan modes and scan scopes .
in addition we specified the scan scopes in the context of maven to obtain the scanscope for maven ssm .
subsequently in rq1 we first qualitatively investigated the tool sdependency resolving capabilities based on the evaluation model.
in rq2 we then quantitatively measured the dependency detection accuracy of the sca tools in two scan modes i.e.
build scan pre build scan defined in section .
on a large set maven modules with unique dependencies .
in rq3 we further investigated the vulnerability accuracy of all the tools and measured the improvements brought about by ssm.
the results show that current sca tools do not support ssm well.
owasp has the best performance in dependency detection under build scan while t11performs the best in vulnerability reporting both build scan pre build scan.
the average f1 score of dependency detection is .
and .
for build andpre build respectively and the average f1 score of vulnerability reporting is .
.
note that proper support for ssm reduces dependency detection false positives by .
and false negatives by .
.
this further leads to a reduction of .
in false positives and .
in false negatives in vulnerability reporting.
based on our comprehensive evaluation insightful suggestions for improving sca tools user suggestions and lessons learned are discussed.
in summary we made the following main contributions we proposed an evaluation model consisting of scan methods scan modes and sca scope for maven ssm for sca tools for comprehensive assessments of the dependency resolution capabilities and effectiveness of java sca tools.
to investigate the situation of ssm support for sca tools we built and shared a test suite to evaluate tools coverage of maven dependency specifications.
based on the proposed evaluation model we conducted a comprehensive study evaluating state of the art sca tools for their capabilities of dependency and vulnerability detection on real world maven projects.
useful findings are highlighted for further improving sca tools.
background .
workflow of sca as shown in figure a typical workflow of sca can be summarized into four steps .
in the first step scanning the target projects and associated artifacts are scanned to identify the reused tpls.
in this step various scenarios should be taken into account for accurate tpl detection.
specifically the target projects can exist in diverse environments and formats section .
the tpls can be introduced in different ways section .
and different package managers may maintain distinct dependency specifications section .
.
in the step of comparison the detected oss components are compared to vulnerability databases such as national vulnerability database nvd for potential security risks.
the quality of the results is affected by both the performance of dependency resolution and the completeness and correctness of the vulnerability databases.
during the analysis phase guidance is provided for evaluating risks associated with detected vulnerable components specifically security vulnerabilities.
finally in reporting results from analysis are reported to end users in various digital formats such as software bill of materials sbom .
in this study we mainly focus on 1one of the commercial tools in our study.
details are in section .
.software composition analysis for vulnerability detection an empirical study on java projects esec fse december san francisco ca usa figure sca workflow the first two steps because we aim to evaluate the dependency and vulnerability detection capabilities of the tools.
.
diverse formats of artifacts software projects could be presented in different formats i.e.
source code and binary in different environments e.g.
code repositories deployed run time across their software lifecycle.
figure demonstrate the main stages of devsecops .
we place emphasis on the stages where changes occur in the format or environment of the code.
in the develop stage projects typically exist as source code within a development environment or code repositories that lack specific code execution environments e.g.
github .
during thebuild stage the projects remain in the form of source code but are accompanied by the complete compilation environment.
the building output may be a binary file such as a jar file.
during therelease deliver stage the projects typically take the form of binary files that are prepared for deployment in the runtime environment or to be released into artifact repositories.
.
diverse dependency imports tpls can be introduced into projects in multiple ways and can reside in different locations or formats.
specifically three ways are identified 1by package managers 2by external