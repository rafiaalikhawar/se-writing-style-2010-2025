combinatorial testing of restful apis huayao wu state key laboratory for novel software technology nanjing university china hywu nju.edu.cnlixin xu state key laboratory for novel software technology nanjing university china lxxu smail.nju.edu.cn xintao niu state key laboratory for novel software technology nanjing university china niuxintao nju.edu.cnchanghai nie state key laboratory for novel software technology nanjing university china changhainie nju.edu.cn abstract thispaperpresentsrestct asystematicandfullyautomaticapproachthatadoptscombinatorialtesting ct totestrestfulapis.
restct is systematic in that it covers and tests not only the interactionsofacertainnumberofoperationsinrestfulapis but also the interactions of particular input parameters in every single operation.thisisrealisedbyanoveltwo phasetestcasegeneration approach whichfirstgeneratesaconstrainedsequencecovering array to determine the execution orders of available operations and then applies an adaptive strategy to generate and refine several constrained covering arrays to concretise input parameters of each operation.
restct is also automatic in that its application relies on only a given swagger specification of restful apis.
the creation of ct test models especially the inferring of dependency relationships in both operations and input parameters and the generation and execution of test cases are performed without any humanintervention.experimentalresultson11real worldrestful apis demonstrate the effectiveness and efficiency of restct.
in particular restctcanfindeightnewbugs whereonlyoneofthemcanbetriggeredbythestate of the arttestingtoolofrestfulapis.
ccs concepts software and its engineering software testing and debugging.
keywords restful api combinatorial testing test case generation acm reference format huayao wu lixin xu xintao niu and changhai nie.
.
combinatorial testing of restful apis.
in 44th international conference on software engineering icse may21 pittsburgh pa usa.
acm newyork ny usa 12pages.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may pittsburgh pa usa association for computing machinery.
acm isbn ... .
introduction modern web applications are usually built as a composition of heterogeneouswebservicesthatinteractwitheachotherthroughweb application programming interfaces apis .
the representation state transfer rest represents an architectural style for creating suchapis andthe apisconformingto restare therebyreferred toasrestfulapis .theuseofrestfulapiscanprovideauniform and flexible way to access and manipulate web resources via http method operations which has become the de factostandard for the design and implementation of modern web services .
given the increasing prevalence and widespread adoption of restful apis it is of great importance for these apis to be thoroughly tested.
currently web service developers usually use the swaggerspecification moreformally openapi todocumentrestful apis in which the exact operations that can be performed and the format of input and output parameters are explicitly de scribed .
the availability of this common specification has thenmotivatedresearcherstodevelopblack boxtestingapproaches of restful apis .
however it remains challenging to design test cases that can effectively ex ercise service behaviours as the available operations which canbeexecuted in manydifferent orders andtheir associatedinputparameters which can be concretised using many different values typically constitute a potentially huge input space that is unlikelyto be exhaustively explored.
apart from the many possible ways to execute restful apis thedependencyrelationships i.e.
constraints inbothoperations and input parameters also contribute to the complexity of test case generation.
a constraint in restful apis might prohibit specific executionordersofoperations e.g.
datareceivedintheresponseofoperation xisnecessaryforexecutinganotheroperation y itmightalsorestrictthewaysinwhichinput parametersofasingleoperationcanbecombinedandconcretised e.g.
ifinput parameter xisset theninput parameter ymustbesettoo .clearly anytestcasegenerationapproachthatcannotproperlyhandlesuchconstraints will lead to invalid http requests and thereby reduce testing effectiveness.
the huge and constrained input space of restful apis especiallyasksforasmartapproachtogeneratetestcasesthatareas cost effectiveaspossible.currently despitethatapproacheslikemodel based and fuzzing are developed they are not in a position that takes combinations of operations and also input parameters into account.
in particular a primary focus of existingapproachesisontheconstructionofconstraints satisfying ieee acm 44th international conference on software engineering icse authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa huayao wu linxin xu xintao niu and changhai nie operation sequences .
this helps to reach and exercise every testable operation but it is unlikely to effectively trigger failures due to certain execution orders of operations and also certain combinations of input parameter values .
moreover for each given operation the values of its inputparameters should also be carefully determined to produce concrete and valid http requests.
existing studies havepresentedavarietyofvaluerenderingstrategies e.g.
using dynamic objects static directory examples random values and knowledgebases butunfortunately theyareusuallyunawareof theconstraintsbetweeninput parameters.infact thesupportof inter parameter constraints is important because such constraints are frequently observed in real world restful apis .
although testers can chooseto use formal languages tore write constraints to fulfil automatic constraints handling it could be moredesirabletoautomaticallyinfersuchconstraintsfromnatural language descriptions of the swagger specification.
in this study we make use of combinatorial testing ct to devisea systematicandfully automaticapproach restct to test restful apis.
our aim is to cover and test the interactions of a certain number of operations and also a certain number of inputparameters describedinthespecification sothattheservicebehaviours can be systematically exercised.
meanwhile we also seekto automatically model the input space of restful apis including theinferringofconstraintsinoperationsandinput parameters so that the complete testing process can be fully automated.
tothisend restctadaptstheconceptsofbothsequenceand classical covering arrays to implement a novel two phase test case generation approach.
specifically given a swagger specificationas the input restct first generates a constrained sequence cov ering array to determine the execution orders of operations in which the hierarchical relations of resources and crud semantics create read update and delete are used together to handle the constraints between operations.
next for each operation sequence generated before restct uses an adaptive strategy to generate several constrained covering arrays to concretise input parameters of each operation i.e.
producing concrete http requests .
in this phase restctreliesonseveralheuristicstrategiestodetermine valuedomainsofinput parameters andleveragesnaturallanguage processingtoimplementapattern basedapproachforextracting inter parameter constraints.
wehaveimplementedrestctasatestingtool1 andcarriedout experimenton11real worldrestfulapisof gitlabandbingmaps toevaluateitseffectivenessandefficiency.theexperimentalresults reveal that restct can successfully test on average of operations described in the swagger specification while this proportion is only for the state of the art testing tool restler .
restct isalsotimeefficient asitspendsnomorethantenminutesin55 of cases studied.
in addition we have further investigated the impact of coverage strengths on the performance of restct.
we find that the coverage strengthapplied for generating operation sequences tendstohave agreatinfluence and coveragestrengthtwo isthe most cost effective choice.
overall restct detects eight new bugs of the subject apis where only one of them can be triggered by restler.
figure an example of swagger specification.
summing up the main contributions of this paper are twofolds we proposed restct the first systematic and fully au tomatic approach that adopts combinatorial testing to test rest fulapis and wepresenteddetailedexperimentalresultsthatevaluate the effectiveness and efficiency of restct on realworldrestfulapis.thisstudyalsoextendstheknowledgeofboth restfulapisandcombinatorialtestingliteratures asitnotonly exploresasystematicstrategy i.e.
ct totestoperationsandinputparameters of restful apis but also provides an application of ct in which the test models can be automatically created without testers manual efforts.
therestofthispaperisorganisedasfollows section 2covers the background on swagger specification of restful apis andcombinatorialtesting.
section 3describesthedetailedprocess of restct.
section 4presents the experiment for evaluating restct.
section5discusses possible threats to validity.
section 6discusses related works and section 7concludes this paper.
background webeginthisstudywithbackgroundonspecificationofrestful apis and basic concept of combinatorial testing.
.
specification of restful apis modern web services usually rely on restful apis to expose their services to the web.
in this way each service should provide its resourcesinatextualrepresentation typically injsonformat and allowtheseresourcestobeaccessedandmanipulatedbyasetof crud operations create read update and delete .
in practice a resource of restful apis is generally identified by auniformresourcelocator url overhttpprotocol.thecrudoperationsarethenrealisedbyhttpmethodoperations i.e.
post get put and delete .
accordingly a client can send an http authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
combinatorialtesting of restful apis icse may pittsburgh pa usa table a way constrained covering array p1p2p3p4 requestto the service in which a certain url an http method andcorrespondinginput parametervaluesshouldbespecified.the servicewillthenreturna responsewiththerequiredrepresentation of the resource.
in order to document the necessary information for using restfulapis astructuredspecificationshouldbeprovided.currently the most widely recognised choice is the openapi specification it is also known as the swagger specification for versions older than v3.
whichdefinesastandardtospecifytheexactsyntaxofallthe available requests and expected responses of the apis .
figure1 forexample givesasnippetoftheswaggerspecification inyamlformat .here the pathsfielddescribesalistofresources available i.e.
apiendpoints eachofwhichcorrespondstoasetofhttpmethodsthatcanbeperformed e.g.
the postmethodissupportedfortheresource users .foreachhttpmethod theformat of input and output parameters are described in the parameters andresponses fields e.g.
theinput parameter password should take a string value it is optional and should be sent in the request body .
in addition some parameters might be associated with a schema whoseformatisdefinedinthe definitions field e.g.
the input parameter username isassociatedwithanobject username which consists of two parameters of the string type .
.
combinatorial testing combinatorial testing ct is a popular testing approach to test in teractionsofparametersthatinfluencethesoftware sbehaviour .therationalofthisapproachderivesfromtheobservationthat many software failures are triggered by combinations of param etervalues .accordingly ctemploysa coveringarray as the test suite to systematically cover such combinations hoping to achieveagoodbalancebetweentestsuitesizeandfailurerevelation effectiveness.
assumethatthebehaviourofasystemisinfluencedby nparameters p p1 p2 ... pn andeach parameter picantakediscrete values from a finite set vi for i n. such parameters pand their value domains v v1 v2 ... vn constitute a test model of ct whichdepicttheinputspaceofthesystem.then atestcase can be constructed by assigning to each parameter a specific value and we refer to a combination of tparameter values as a t way combination.
definition covering array .
given a set of parameters and their associated value domains a t way covering array ca is a set of test cases in which every t way combination is covered at least once.
the value of tindicates the coverage strength of the array.
inadditiontothecombinationofparametervalues sometimes the behaviour of the system can be influenced by a set of nevents table a way constrained sequence covering array test cases unique way sequences covered 1o1 o4 o3 o2 o1 o4 o3 o1 o4 o2 o1 o3 o2 o4 o3 o2 2o3 o1 o4 o2 o3 o1 o4 o3 o1 o2 o3 o4 o2 3o1 o3 o4 o1 o3 o4 e o1 o2 ... on that can be executed in different orders.
in thiscase thetestmodelconsistsofasetofevents e andatestcase indicatesasequenceof k ndistincteventsin e thatis thetest casescanbeofdifferentlengths2 .werefertoapermutationof t events as a t way sequence.
definition seqence covering array .
given a set of n events a t way sequence covering array sca is a set of event sequences inwhichevery t waysequenceiscoveredatleaseonce the tevents of a t way sequence are not required to be adjacent in an event sequence .
theabovementionedcoveringarraysassumethatallpossible t waycombinations or t waysequences arefeasibleandshould thus be covered.
however this might be unrealistic due to the presence of constraints .
aconstraint of the system depicts the dependency relationships between software parameters or events.
any test case that violates constraints is considered invalid and should thus be excluded from the final test suite.
to cater for the constraints in ct the definition of a covering array or a sequence covering array should be extended to that ofaconstrainedcoveringarray oraconstrainedsequencecovering array.specifically givenasetofconstraints c eachtestcaseina constrained ca or a constrained sca should be c satisfying and every c satisfying t waycombination or t waysequence should be covered at least once in the array .
accordingly the ct test modelshouldspecifynotonlythesetofparametersandtheirvaluedomains orthesetofevents butalsotheconstraintsinthesystem.
forexample table 1givesa wayconstrainedca ofthetest model with p p1 p2 p3 p4 v1 v2 v3 v4 and one constraint if p1 then p2 .
in addition table 2gives a way constrainedsca of the testmodel with e o1 o2 o3 o4 and two constraints o4can only be executed after o1 and no event can be executed after o2.
the restct approach given a swagger specification as the input an effective black box testing approach of restful apis should generate not only appropriate execution orders of available operations but also valid value assignments of each operation s input parameters.
restct adopts combinatorialtestingtoaddresstheabovetwoproblems.itsoverall workflow involves two main phases operation sequence generation whichseekstomodeltheinputspaceofavailableoperations and construct a sequence covering array as a representative setofoperationsequences and input parametervaluerendering which seeks to model the input space of input parameters of each 2we note that this definition of test case is different from that of traditional sequence covering array where all test cases should be of the equal length.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa huayao wu linxin xu xintao niu and changhai nie figure an example of hierarchical relations of resources.
operation andsamplerepresentativevalueassignmentsviaseveral covering arrays to produce concrete http requests.
.
operation sequence generation inthisstudy werefertoan operation asacombinationofaresource and an associated http method e.g.
post users in figure .
restct will first parse the swagger specification to find the set of available operations and their dependency relationships and then generatea ts wayconstrainedsequencecoveringarray i.e.
aset of operation sequences to determine the execution orders of these operations.
.
.
handling constraints between operations.
given a swagger specification thesetofalltheavailableoperations o o1 o2 ... om can be directly extracted from the pathsfield of the specification.thechallengehereistoappropriatelycaterfortheconstraints between these operations .
restct relies on the hierarchical relations of resources and crudsemantics tohandle constraintsinoperation sequencegeneration.
in restful apis the hierarchical relations of resources are specifiedbytheforwardslash inresources urls.suchrelations canalsobedepictedusingatreestructure astheexampleshown infigure includingthehttpmethodsthatcanbeperformedon eachresource .inthiscase book id isachildnodeof book because it is a direct sub resource of book by contrast there is no direct relation between bookand author.
according to the crud semantics a resource and its all subresources shouldnotbeaccessedbeforeitscreation norafterits deletion.hence a t waysequence s ok1 ok2 ... okt isconsideredconstraints satisfying ifforanyresource xinvolvedin s noneof the operations associated with xandx s sub resources appears beforepost x orafter delete x .forexample accordingtofigure get book id get book is a constraints satisfying way sequence becausenooperationappearsbefore post orafter delete operations.
the way sequence get book id post book i s notconstraints satisfying becausetheoperationassociatedwith sub resources of book i.e.
get book id appears before post book.similarly delete book id get book id alsoviolates the constraints.
onceaconstraints satisfyingsequencecanbedecided wecan then determine whether an operation oican be used to extend an existing operation sequence of length t s ok1 ok2 ... okt .
in particular we refer to oias afeasibleoperation for extendingalgorithm the generation of operation sequences input a set of operations o and coverage strength ts output a set of operation sequences sthat satisfies ts way sequence coverage s u set of constraints satisfying ts way sequences of o while u nequal do s an empty sequence whiletruedo a candidate operations s o ifa nequal then select a athat contributes the most to ts way sequence coverage ties break by random ifacannot help cover any ts way sequence then break end if a prime predecessor operations s a append a primeandatos else break end if end while addsintos and remove ts way sequences that are covered bysfrom u end while return s s if the t way sequence constructed by appending oitos ok1 ok2 ... okt oi is constraints satisfying.
here an operation is feasible for extending sdoes not necessarily mean that this operation can be directly executed after s. for example the operation get book id is feasible for extending s post author butitcannotbedirectlyexecuted becausethe resource bookis yet to be created.
in this case the crud semantics should be further accounted for to determine the additional predecessoroperationsthatarerequiredtobeexecutedearlierthan executing a feasible operation e.g.
post book is the predecessor operation for executing get book id in the above example .
we note that the constraints handling strategy presented above differs from previous strategies that rely on the common field in bothresponsesandrequests .givenaparticularoperationsequence thepreviousstrategies primarilyfocusonoperations that can be directly executed basically every dynamic object that isrequiredshouldhavebeenproduced .bycontrast ourstrategy seeks to find operations that have the chance to be executed in the future even though the resource required is yet to be created whichismorehelpfulingeneratingoperationsequencesofhigh sequence coverage.
.
.
generating operation sequences.
withtheaboveconstraints handling strategy restct will then apply a greedy algorithm i.e.
algorithm togeneratea ts wayconstrainedsequencecovering arraytocoverinteractionsofany tsoperations.thisalgorithmfirst determinesthesetofconstraints satisfying ts waysequences u oftheoperationsundertest line2 .then itgeneratesanoperation sequence that covers the most previously uncovered ts way authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
combinatorialtesting of restful apis icse may pittsburgh pa usa sequencesateachtime untilall ts waysequencesin uarecovered lines .
to generate each operation sequence algorithm 1will start with an empty sequence s and then extend siteratively lines .the candidate operations s o function line6 willreturn a set of candidate operations that are not included in s i.e each operation in ooccurs at most once in s and at the same time are feasible for extending s i.e.
appending the operation to sdoes not violate the constraints .
at this step if no candidate operation can be found i.e.
a then the iteration terminates line and the sequence sconstructed so far is added into the final set ofoperationsequences s.otherwise thealgorithmwillevaluate thenumber of ts waysequences thatcanbepotentially coveredby appendingevery candidateoperation in atos and selectthe best operation a afor extension lines .
notethatthebestoperation aselectedheremightnotbeableto bedirectlyexecutedafter s asexplainedinsection .
.
.so the algorithm will additionally account for the crud semantics to determine the predecessor operations a prime that should be additionally executed before executing a i.e.
thepredecessor operations s a function in line a prime noneif no predecessor is required .
finally the operations in a primeandawill be appended to the current sequence s line13 andthealgorithmwillrepeattheaboveprocess to find the next best operation for extension.
.
input parameter value rendering once the set of operation sequences is produced restct will then generate concrete http requests to execute operations in these sequences.theaimofinput parametervaluerenderingistoconcretise input parameters with as many valid value assignments aspossible andatthesametime coverinteractionsofparticular input parameters.tothisend restctwilluseanadaptivestrategy to generate constrainedcovering arrays in which the cttest models are dynamically created and modified according to both specification and test execution results.
.
.
identifying input parameters and their value domains.
given eachoperation restctwillextractallapplicableinput parameters fromthe parameters fieldoftheswaggerspecification.suchparameters can be located in path query header form and body andtheycanbeofvarioustypes.currently restctsupportsparameters of the string integer number boolean array and objecttypes.eachparameterofthenon objecttypeexactlyindicates a unique input parameter of the operation in this study we let the length of the array be one .
while for the object typed parameters their formats are defined as schemas and each nonobject typedparameterinvolvedintheschemaisextractedasa unique input parameter e.g.
for the schema username in figure twoinput parametersofstringtype firstname andlastname will be extracted .
for each input parameter identified restct will use one of the followingstrategiestodetermineitsvalue domains i.e.
thesetof values that the input parameter can take dynamic using resources dynamicallycreated in a prior operations.
it takes run time information of the service into account which is often necessary for constructing valid http requests .
specifically givenan input parameter figure3 apatternofconstraintbetweeninput parameters.
pand a set of previously received responses r this strategy will usea heuristic namematching approach tosearch for output parameters in rto find those that have the most similarnameswith p duetothenaminginconsistencybetween output and input parameters .
then the values of such output parameters will be used as p s value domain.
specification using values described in the swagger specification.
it relies on values provided by developers which could exploit domain specific information of the serviceundertest .specifically ifaninput parameter pis associated with an enumordefaultfield the corresponding values are directly used as its value domain.
otherwise this strategy will search the example fields of all inputparameters that have the same name with p and select at most two example values at random as p s value domain.
success usingvaluesthatappearinprevioussuccessful requests i.e.
returning http status codes of range whichreliesonthetestexecutionhistorytore executean operation.here ifthepreviousvalueisdeterminedbythe random strategy this value will be mutated to increase the diversity of test inputs e.g.
avoiding to create resources of the same name .
random generatingthreedifferentvaluesatrandomas the value domain.
this strategy will be used if no value can be identified by the above strategies.
here becauseinput parametersthatarelocatedin path i.e.
the parameter valueis partof theoperation s url must alwayshave avalue andthe valueis usuallydependent onprevious responses their value domains will be determined by the dynamic strategyonly.whilefortheotherparameters restctwilltryallthe above strategies in a decreasing priority until the value domain isdetermined.inaddition accordingtothe required fieldofthe specification eachinput parameteriseither requiredoroptionalfor constructing anhttprequest.
for the optionalinput parameters anonevalue will be additionally added into its value domain indicating that no value is assigned to this parameter.
.
.
inferring constraints.
similar to the constraints between operations there are also inter parameter dependencies that might restrictthewayinwhichspecificinput parametersofanoperation canbeconcretised .currently theswaggerspecificationjust authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa huayao wu linxin xu xintao niu and changhai nie figure the adaptive strategy to generate concrete http requests to execute each single operation.
encourages developers to use natural language to describe constraints between input parameters as a part of the description field e.g.
from figure i f random password isfalse then password musttakeavalue .toautomaticallyinfersuchconstraintsfromtheinformaldescription restctleverages spacy3 an open source library for natural language processing to implement a pattern based approach.
figure3 for example gives a pattern used in restct which describes the constraint if param a is value b param c is required .here the pattern fieldgivesthematchingrule whichis encoded as a combination of tokens similar to regular expressions butwithmoreflexibilityinmatchingnaturallanguage .inthiscase thefirsttokenmatchestheexactword if thesecondtokenmatches an entity that is an input parameter name or a specific input parameter value and the fifth token matches any punctuation .
thismatchingrulewillthenbeusedbythepattern basedmatching engineof spacytoextract constraint describingsentencesfrom a giventext.inaddition the constraint fieldinfigure 3givesthe structuredrepresentationoftheconstraintdescribed where aa bb andccindicatethefirst second andthirdentityinvolvedinthe sentence respectively.
once a constraint describing sentence is extracted the corresponding input parameter names and values i.e.
entities will then be reorganised according to this representation to produce the final constraint.
in this study we rely on an exiting catalogue of inter parameter dependencies tomanuallycreateasetof23patternsforrestct.
thiscatalogueclassifiesconstraintsobservedin40real worldrestfulapisintoseventypes andprovidesthemostfrequentlyused linguisticstructuresthatdescribeconstraintsofeachtype eachconstraint type can be described in different ways .
we carefully studied these structures and tried to develop patterns correspondingly.
some structures were excluded because they cannot be directlytransformed into the format required by the tool that we use to generatecoveringarrays.finally 23patternswereobtained which cover all linguistic structures involving two parameters about of all structures available and six of the seven constraint types.
4adetailedexplanationoftokenattributescanbefoundat generating concrete http requests.
with the above approachestoidentifyinput parametersandinferconstraints restct willthenutiliseanadaptivestrategy asillustratedinfigure to generateconcretehttprequeststoexecuteoperationsinthegiven operation sequence one after another.
suppose that the operation sequence is s o1 o2 o3 o4 and restctisgoingtoexecutethethirdoperation o3.asrestcttypically generates multiple http requests for each operation in this case o1ando2 thereisaneedtodeterminewhichexactresponses ofo1ando2should be used to identify the value domains of o3 s input parameters thatis the dynamic strategyasexplainedin section3.
.
.
to this end restct will memorise a set of response chains r inwhicheachresponsechainisalistofpreviouslyreceived successful responses i.e.
the http status code received isin200range .forexample assumingthatthreehttprequests are generated and successfully executed for o1 leading to three successful responses r1 r1 and r1 here ri jindicates the j th responsereceivedwhenexecutingoperation oi .whilefor o2 all subsequenthttprequestsgeneratedaccordingto r1 1andr1 3fail andtwohttprequestsgeneratedafter r1 2success leadingtotwo successful responses r2 1andr2 .
at this point the set of response chains is r r1 r1 r2 r1 r2 r1 and restct will baseonthelongestresponsechain r r tiesbreakbyrandom to generate value assignments for executing the next operation.
assumingthat r r1 r2 1isselectedinthiscase.thisindicates that thedynamic strategy will use the values received in r1 2and r2 1to determine the value domains of o3 s input parameters.
onthebasisofthepreviouslyreceivedresponses r restctwill thenutiliseseveralconstrainedcoveringarraystogenerateconcrete http requests.
the core idea is to ensure the successful execution of thetarget operationfirst notethat theinput parameter values identified and constraints extracted before might be incorrect and thenexerciseasmanyservicebehavioursaspossible.tothisend restctwillexploretheinputspacegovernedbyessentialinputparametersfirst step1infigure andthengrowthisinputspace to include all applicable input parameters step in figure .
specifically in step restct creates a ct test model me that contains essential input parameters only including all required parameters andthoseoptionalparametersthathavedependency authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
combinatorialtesting of restful apis icse may pittsburgh pa usa relationships onrequired parameters .
it thenuses a popular coveringarraygenerationtool acts5 togeneratea te wayconstrained covering array caeofme and construct and send concrete http requests according to cae.
after this step a set of successful requests i.e.
returning http status codes of range is obtained and recorded e.g.
t2 t3 and t5in figure .
next instep2 restctextends metoanothercttestmodel ma tofurtherincludeallapplicableinput parameters.thisextension is basedon thetest executionresults ofstep where allessential input parametersarecombinedasanabstractparameter pa and theparticularvalueassignmentsthatappearinprevioussuccessful requests are used as pa s value domain e.g.
in figure pacan take three values which correspond to the value assignments in t2 t3 and t5 respectively .
then restct uses the acts tool again togeneratea ta wayconstrainedcoveringarray caaofma and construct and send concrete http requests accordingly.
at this moment if at least one successful request is produced restctwillappendeverysuccessfulresponsereceivedin caeand caatothecurrentresponsechain rtoupdate r e.g.
giventwo successfulresponses r3 1andr3 r r1 r2 1willbereplacedby twonew chains r1 r2 r3 1andr1 r2 r3 .otherwise restct will analyse the message received in failed responses to find input parameters that cannot be appropriately concretised.
it will ignore such input parameters and repeat the above processwith a different response chain r step in figure hoping to concretise input parameters of this operation in a different way in this study the maximum number of repetition is set to three .
experiment thissectiondescribestheexperimentperformedtoevaluatetheeffectivenessandefficiencyoftherestctapproach.inparticular we are interested in answering the following two research questions rq1isrestctacost effectiveapproachwhencomparingwith the state of the art testing tool of restful apis?
rq2howdothecoveragestrengthsappliedimpacttheperformance of restct?
.
subject apis in this study we used real world restful apis as the exper imental subjects.
table 3summarises the number of operations described in each subject s swagger specification as well as the average number of input parameters that can be extracted in each of these operations using the approach described in section .
.
specifically the first six restful apis come from gitlab a popular open source web service for hosting git repositories.
this serviceisselectedbecauseitcontainscomplexapisandhasbeen usedinpreviousstudies .thesubjectapisrepresentgroupsof operations that are related to branches commits issues groups projects andrepositoriesfunctionalitiesof gitlab andwefollowed the previous study to test these individual groups separately.
wenotethat gitlabdoesnotprovideofficialswaggerspecification files for its current api version v4 .
so we manually created therequired specifications based on its latest online document we accessed in april table the subject apis used in the experiment apis operations input parameters gitlab branch .
commit .
groups .
issues .
project .
repository .
bing maps elevations .
imagery .
locations .
route .
timezone excluded apis that are only available in the paid services .
in addition we relied on an existing docker image7to deploy gitlab and performed testing in a local environment on a machine with intel xeon cpu .3ghz and 128gb memory .
theremainingfiverestfulapiscomefrom bingmaps aw eb mappingservicedevelopedbymicrosoft.thisserviceisadditionally selected because it contains a large number of inter parameter constraints .similarly sincethereisnoavailableswaggerspecificationfilesfortheseapis wemanuallycreatedthespecifications based on the latest online api document8.
we note that the online documentof bingmaps classifiesallavailableoperationsintoseven apigroups andweexcludedtwogroupsthatcontainoneoperation only.
in addition because bing maps is not an open source project we relied on its publicly hosted service to perform testing.
we note that the website offers a repository of swagger specifications and some previous studies have used this website as the resource of subject apis.
in this study we did not directly select specifications from that website becausesuch specifications might be incorrect in fact a specification of gitlabis available there but many input parameters are missing or inconsistency with the current services versions the remotely deployedservicesmightbeupdated .instead wechosetocreate specificationsourselvestoensurethecorrectnessandcompleteness of the inputs taken by the testing approaches studied.
.
experimental procedures we chose to compare restct with restler v8.
.
a state ofthe art black box fuzzing tool for testing restful apis for an swering the first research question.
restler is originally devel oped to explore deep service states reachable only through spe cific operation sequences .
currently it is still under active development and has incorporated several techniques reportedin recent studies .
we note that there are other studies thatproposeblack boxtestingapproaches ofrestfulapis.theseapproacheswerenotincluded becausethey cannot automatically handle the dependencies between operations tag of image .
.
ce.
accessed in may authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa huayao wu linxin xu xintao niu and changhai nie table the numberof operation sequences exercised seq and theiraverage length len proportion of1 way and way sequences that are actually tested c1 wayand c2 way number of unique bugs detected bug number of http requests executed total and test execution cost cost in minutes of different testing approaches restler restct seq len c1 way c2 waybug total cost seq len c1 way c2 waybug total cost branch .
.
.
.
.
.
.
commit .
.
.
.
.
.
.
groups .
.
.
.
.
.
.
.
issues .
.
.
.
.
.
.
project .
.
.
.
.
repository .
.
.
.
.
.
.
elevations .
.
.
.
.
imagery .
.
.
.
.
.
.
.
.
.
locations .
.
.
.
.
.
.
.
.
route .
.
.
.
.
.
.
.
timezone .
.
.
.
.
.
average .
.
.
.
.
.
.
.
.
.
.
.
.
e.g.
someresourcesshouldbeinitiallycreated oronlyaproof ofconcept tool isprovided e.g.
the service authentication whichis required for testing both gitlabandbing maps is not supported .
specifically we configured restler with its default settings andusedits fuzzmodetoperformtesting.inthismode restler williterativelyextendoperationsequencesconstructedsofarby a breadth first search strategy.
while for restct the coverage strengths ts for operation sequence te for essential input parameters and ta for all input parameters were used.
we set tsandtato two because this is the most popular choice in ct applications we set teto three because a higher coverage strength could help in testing more interactions of essential input parameters.
we note that no initialisation process was performed e.g.
creating resourcesthat are required for executing someoperations beforetheexecutionofbothrestlerandrestct because these two approaches are able to resolve the dependencies betweenoperations.weallocatedonehourtimebudgetforeachofthesetwoapproachestotesteachsubjectapi andtheirexecutions wererepeatedfivetimestoaccountfortherandomnessinvolved in their implementations.
to analyse the testing results we followed the common practice ofrestfulapistestingthatusesthehttpstatuscodereceivedin responsesastestoracle .specifically anhttprequestis successful ifacodeof200rangeisreceived andis invalidifthecode isin400range accordingly anhttprequestis validifthecode receivedisnot4xx .thecodeof500rangerepresentsan internal servererror exposed i.e.
theservercrashisnothandledgracefully which is probably due to a defect in the system.
a potential bug is thus considered to be detected if such a 5xx code is observed.
withrespecttotheimpactofcoveragestrengthsusedinrestct i.e.
thesecond researchquestion weperformed a base choice experiment to investigate the relative performance of restct under different coverage strength configurations.
specifically we used ts te ta as abaseconfiguration.
then we changed the values of each coverage strength separately range forts andta andrange forte whilelettingtheothersremainthe same tocreateaseriesofconfigurations.lastly foreachsubjectapi weranmultipleversionsofrestctusingtheaboveconfigurations andcomparedtheresultsobtained.here duetotheuse ofhighercoveragestrengths accordingly higherexecutiontime costs the execution time budget was set to five hours and the execution of each configuration was repeated three times.
.
results .
.
comparison with existing tool rq .thefirstresearch question concerns the relative performance of restct to the stateof the art testing tool.
table 4gives the results obtained.
here an operation is considered actually tested if at least one http request of this operation is a valid request i.e.
the status codereceived is either 2xx the operation is successfully executed or5xx a potential bug is detected .
accordingly a t way sequence of operations is actually tested i fe v e ry toperation involved in the sequence is actually tested note that each single operation exactly indicates a way sequence .
fromtable wecanseethatrestctgenerates onaverage .
operation sequences for each subject api i.e.
the size of wayconstrained sequence covering array and the average length of theseoperationsequencesis9.
.byutilisingseveralconstrained coveringarraystoexecutetheseoperations restctcanactually test on average of operations described in the specification i.e.
waysequences andthisproportionishigherthan80 in foursubjectapis i.e.
branch imagery locations and timezone .
for way sequence coverage the operation sequences generated by restct with ts ensure to cover all way sequences of operations i.e.
all elements in uin algorithm where of them are actually tested.
nevertheless there remain three subjects i.e.
imagery locations and timezone where more than of way sequences can be actually tested.
bycontrast wecanseethattheexistingtool restler cannot performwellinalmostallsubjectapisstudied.itcanonlyexercise an average number of .
operation sequences and the average lengthoftheseoperationsequencesisaboutone i.e.
eachsequencecontainsoneoperationonly .theaverageproportionofoperations authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
combinatorialtesting of restful apis icse may pittsburgh pa usa figure the impact of tson the performance of restct.
i.e.
way sequences that are actually tested by restler is also low atonly3 andthereisno2 waysequencethatcanbeactually tested.wenotethattheaboveresultsofrestleraredifferentfrom thosereportedinthepreviousstudy .themainreasonisthat the previous study only tries to test required input parameters ofeachoperation whileinthisstudy therestlertoolwasusedto find value assignments of all input parameters the default setting ofthistool .thisindicatesthatrestctismorelikelytoproduce valid http requests to test operations that have complex and constrained input parameters.
thebugcolumn of table 4gives the total number of unique bugsthatarerevealedineachsubjectapi.inthisstudy wereferto acombinationofanoperationanda5xxerrorcodeasa bug and all bugs observed are clustered to determine the set of unique bugs.
overall restct can find a total number of eight bugs where only one of them can be triggered by restler.
these bugs have been manually analysed and reproduced to confirm their existence.
as far as the testing efficiency is concerned from table w e can see that restct usually takes fewer time costs to generate and execute much more http requests than restler.
specifically restct can generate and execute an average number of .
httprequestsacrossallsubjectapis andthisnumberisonly554.7forrestler.meanwhile thetestexecutioncostofrestctobserved on average .
minutes is also lower than that of restler .
minutes .
especially in six subject apis restct takes no more than ten minutes to perform the test.
answerto rq1 theexistingtestingtool restler cannoteffectivelytestthesubjectapisstudied asittestsonly3 ofoperationsdescribedinthespecification.bycontrast restctcanactuallytest of operations on average and the test execution cost is less than ten minutes in six out of subjects.
especially restct finds eight new bugs of the subject apis where only one of them can be triggered by restler.
.
.
impact of coverage strengths rq .thesecondresearch questionconcernstheimpactofcoveringstrengthsontheperformanceofrestct.thisincludesthecoveragestrengthofoperationsequences ts andthecoveragestrengthsofessentialandallinputparameters in each operation teandta .
figures 5to7give the increaseratesofspecificmetricswhenchangingthevaluesof ts te andtaseparately eachboxcontains11valuesobtainedfromthe 11subjectapis .forexample infigure theaveragenumberof operationsequencesgeneratedfor branchare1.
and25.3when figure the impact of teon the performance of restct.
figure the impact of taon the performance of restct.
tstakes and respectively.
the increase rates of way way and3 way way are thus .
.
and .
.
.
regarding the coverage strength of operation sequences ts from figure we can see that a larger tstends to lead to more operation sequences i.e.
larger sequence covering arrays andaccordingly higher test execution costs.
in particular for half of cases the number of operation sequences and test execution costs ofts 2areatleast5.3and4timeslargerthanthoseof ts and these two values will increase to .
and when tsincreases from to .
whereas the increase rate of average length of operationsequencesisrelativelylow lessthan1.4inallcases.generally a highertestingcostislikelytoresultinalargernumberofoperations that can be tested.
however the increase rate of the number of operations tested of way way is around .
which is much lowerthanthatof way way onaverage .
.thatis theuse ofts will lead to much higher test execution costs than ts butitwillnottestsubstantiallymoreoperations.so ts 2tendsto be the most cost effective choice for the subject apis.
regardingthecoveragestrengthofessentialinput parameters te fromfigure wecanseethattheimpactofdifferentchoices ofteis not as great as that of ts as the increase rates observed are all less than .
.
in particular when comparing with te the use of te will slightly increase the proportion of valid requests generated per operation by a factor of .
times median value whereasthisincreaseratewilldropto0.9when tefurtherincreases to .
since a similar trend can also be observed for the other three authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa huayao wu linxin xu xintao niu and changhai nie metrics a larger value of tedoes not necessarily result in a higher testing performance of restct.
lastly regardingthecoveragestrengthofallinput parameters ta from figure we can see that a higher value of tawill lead to more http requests generated for each operation i.e.
larger covering arrays and the median of increase rates observed is around .
for both way way and3 way way.
however increasing ta from2to3isnotlikelytoresultinasubstantiallyhigherproportion ofvalidhttprequestsperoperation andalso moreoperations tested .
nevertheless the use of ta can result in on average .
times higher proportion of valid http requests per operation and test .
times more operations than the use of ta .
answer to rq2 the coverage strength of operation sequences ts greatlyinfluencestheperformanceofrestct and ts 2tends to be the most cost effective choice for the subject apis studied theuseof ts 3willtakeabout8timeshighertestexecutioncosts than ts but it can only test a similar number of operations .
by contrast the different choices of teandtatend to have little influence on the number of operations tested as the increase rates observed are less than .
in all cases.
threats to validity asfarasinternalthreatstovalidityareconcerned theexperimental resultsreportedinthispapermightbeinfluencedbytheconcrete implementation of the restct approach.
we have carefully inspected our codes to avoid potential mistakes and made them publiclyaccessiblesothatotherscancheckandextend.theexperi mentalresultscanalsobeinfluencedbytheswaggerspecificationsused.
in this study due to the unavailability of official specification files of subject apis we manually created the required specifi cations based on their online api documents.
note that restct reliesona pattern basedapproachtoextractconstraintsbetween input parameters.
we manually developed patterns based on an existing catalogue of inter parameter dependencies and we followedthelinguisticstructuresprovidedinthesamecatalogueto describeconstraintswhenwritingspecifications thesetwotasks wereperformedindependentlybytwoauthorsofthispaper .we chose such a strategy because we want to reflect thecommon practiceofwebdevelopersfordocumentingapis whichcouldmake these specifications more useful for future studies rather thanusing our own writing styles.
consequently restct especially the constraints extraction approach might exhibit different performance if the specifications arewritten in different ways.
given the fact that the linguistic structures in the catalogue indicate the most frequently used ones in practice we believe that restct could work well for specifications of similar writing styles.
in addition regarding the testing tool for comparison we chose to use the default recommended configuration to run the restler toolintheexperiment.weacknowledgethattheperformanceof restlercanbeimprovedbyperformingseveralmanualupdates e.g.
fixing specifications adding new dependencies of operations providingadditionalfuzzingdictionaries etc.
assuggestedinits online document10.
improvingcoverage.mdasfarasexternalthreatstovalidityareconcerned inthisstudy theeffectivenessandefficiencyofrestctareonlyevaluatedon11 restfulapis.onereasonthatpreventsrestctfrombeingevaluatedmorebroadlyisthattheserviceundertestusuallyrequires authentication.
moreover the publicly hosted services typically prohibitfrequentrequestsofshortperiodsoftime andcouldban theaccountinanunpredictableway whichtherebyintroducesa substantial manualeffort to applyand manageapi keys actually we had to create several accounts to test bing maps but such costs could be reduced if the testing is performed in a local environ ment .
as a result restct might exhibit different performance whentestingdifferentapis especially apisofdifferentapplication domains .
nevertheless both gitlabandbing maps are real world large scale andpopularrestfulwebservices.webelievethatthey are representative subjects for the evaluation of restct.
related work inorderto automatically generatetestcasesforrestfulapis both white box and black box testingapproacheshavebeendeveloped.black box approaches attract more attentions in the current literature because they require no access to the source code of the system which are more applicable for testing complex and remote web services.
model based testing i sa representative approach in early studies of this research direction.
althoughtestcasesthatsatisfycertaincoveragecriterioncanbe automaticallyderivedbasedonspecificmodels e.g.
aumlstate machine testersshouldstillcreatesuchamodelbyhandat the beginning of testing.
recently the increasing popularity of the swagger specification more formally openapi offers a more common and standard way for documenting restful apis .
accordingly a variety of specification basedapproaches have been developed which seek to automatically generate test cases basedontheswaggerspecificationonly.inthisway theoperationsthattheserviceundertestprovides andinput parametersthateachoperationrequirescanbeeasilyidentified.whilethechallengelies inthedeterminationofthemostappropriateexecutionordersof different operations as well as the value assignments of inputparameters of each operation.
withrespecttotheexecutionordersofoperations somestudies onlyfocusonthetestingofeachsingleoperation accordingly certain resources should be created before the testing proceeds .bycontrast viglianisietal.
proposedtoconstructa singlesequencethattraverseseveryoperationoncetotestnominal and exceptional scenarios of restful apis.
their approach firstanalyses the common data field in both responses and requeststo build an operation dependency graph.
the next operation tobe executed will then be decided based on the graph and crud semantics.inaddition atlidakisetal.
proposedtoexploreall possibleoperationsequencestotestdeepservicestates.theirapproach restler relies on the producer consumer relationship i.e.
whether a resource received in the response of a prior operation is necessary as input of a followingoperation to handle constraints betweenoperations.then asearchstrategy likebreadth firstor random search is appliedto iteratively extendexisting sequences authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
combinatorialtesting of restful apis icse may pittsburgh pa usa with all constraints satisfying operations.
later restler is further reused by several studies to develop approaches such as security testing and differential testing of restful apis.
regardingthedeterminationofconcreteinput parametervalues theusesofstaticmappingdirectoryandrandomvaluesareprobably the most straightforward choices in current studies .
the examplevaluesdescribedinthespecification andadditional knowledgebases arealsousedtoaccountforthedomain specific informationoftheapis.inaddition whensequencesofoperations areinvolved thereisaneedtotaketheruntimeinformation i.e.
resources dynamically created in prior operations into account .
there are also studies that seek to modify the schema structures of payload to trigger as many error types as possible.
similar to the constraints between operations there are also inter parameterdependenciesineachsingleoperation.theempiricalstudyofmartin lopezetal.
hasrevealedthatconstraints between input parameters are pervasive in real world restful apis butunfortunately theyarebarelyaddressedintheabovementionedapproaches .inordertohandlesuchconstraints martin lopez et al.
proposed a formal constraintsdescribinglanguagefortheopenapispecification.theyalsodeveloped automatic approaches to generate constraints satisfying value assignments as long as the constraints can be formally described in the specification.
more recently mirabella et al.
proposed to use deep learning techniques to predict whether a value assignment is constraints satisfying or not.
discussions .
the restct approach presented in this paper differsfrompreviousapproachesinthreemainaspects.first unlike previous model based approaches restct is fully automatic thatis the testmodels ofcombinatorial testing areautomatically created .
second restct applies combinatorial testing to systematically cover and test the interactions of available operations whiletheprimarygoalofpreviousapproachesiseither to test every operation once or to explore all possibleoperationsequences .atlast restctcanautomatically extract constraints between input parameters from natural language descriptions in the swagger specification.
this differs from approaches that rely on a specific formal language should be written by testers to realise automatic constraints handling.
conclusion thispaperpresentstherestctapproachthatadoptscombinatorial testing to test restful apis.
the primary goal of restct is to systematically and automatically cover and test the interactions of available operations and also input parameters of each operation describedintheswaggerspecification.tothisend restctutilises the concepts of both sequence and classical covering arrays to generate concrete http requests during which the constraints in both operations and input parameters are automatically extracted andhandled.theeffectivenessandefficiencyofrestct aswellas the impact of coverage strengths applied are evaluated on realworld restful apis of gitlabandbing maps.
the experimental results demonstrate the superiority of restct against the state ofthe art testing tool of restful apis.
in order to aid others to replicate and extend our experiment weprovideswaggerspecificationsofallsubjectapisandscriptstoreplicateexperimentat archived artifact is also available at .