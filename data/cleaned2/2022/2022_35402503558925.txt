polyfax a toolkitfor characterizing multi languagesoftware wenli washingtonstateuniversity pullman wa usa li.wen wsu.edulili monashuniversity melbourne victoria australia li.li monash.eduhaipeng cai washingtonstateuniversity pullman wa usa haipeng.cai wsu.edu abstract today s software systems are mostly developed in multiple languages i.e.
multi languagesoftware yettoolsupportforunderstanding andassuring these systems israre.
to facilitate future researchonmulti languagesoftwareengineering thispaperpresents polyfax atoolkitthatoffersautomatedmeansfordatasetcollection from github and two analysis utilities a vulnerability fixing commitcategorizationtool vcc andalanguageinterfacingmechanism identification categorization tool lic .
the vcc tool immediately assists with assessing the vulnerability proneness of a given multi languageproject basedon itsversion histories while the lic tool enables dissection of the most important aspect of the constructionofmulti languagesystems.applicationof polyfax to 113multi languageprojectswith12.6millioncommitsshowedits practical usefulness in terms of promising efficiency and accuracy.
ccsconcepts security and privacy software security engineering .
keywords multi language software tool language interfacing vulnerability acm referenceformat wenli lili andhaipengcai.
.
polyfax atoolkitforcharacterizing multi language software.
in proceedings of the 30th acm joint european software engineering conference and symposium on the foundations of softwareengineering esec fse november14 18 singapore singapore.
acm newyork ny usa 5pages.
introduction large scalestudiesofexistingsoftwareprojects alongwiththecorrespondingcoderepositories e.g.
thoseongithub havepropelled significantprogressinunderstandinghenceimprovingmodernsoftware systems.
practical tool support forminingsuchprojects and analyzingthosesystemscanbegreatlyinstrumental asthey allowresearcherstofocusmoreonthecoreresearchquestionsand insights.
for instance tools for automated data collection crawling filtering cleaning and commoncharacterizationanalysesare essentialforresearch basedon miningopen source projects.
in fact a large body of research aims to mine and study opensourcerepositories enabledoratleast haipeng caiis thecorresponding author.
esec fse november 14 18 singapore singapore copyright held bytheowner author s .
acm isbn978 .
by the underlying characterization tools.
however few of these studies provided a commonly reusable set of data collectionandcharacterizationutilities e.g.
forprojectprofiling completecommits sourceretrieval etc.
.mostimportantly existing characterizationtools e.g.
d2a andvccfinder arelargely limited to single language projects.
tools dealing with typically multi languageprograms e.g.
forandroidappswithnative codeand fordistributedsystemsoftenbuiltwithvarious languagesfordifferentcomponents endeduponlyaddressingpart ofthose systems that is written in one language e.g.
java .
yet the majority of today s software systems are written in multiplelanguages hencetheyarenotedas multi language software for example a recent prior study confirmed that more than ofopen sourceprojectsongithubaredevelopedwithmore thanone language.it is also found latelythatmulti language software is notably prone to security vulnerabilities mainly induced bythe interfacing betweendifferent languages used inasoftware project infact thispronenesshasfoundcorrespondenceto cross languagevulnerabilitieswithsevereconsequences .on the other hand tools supporting studies of multi language software e.g.
those for identifying language interfacing and assessing pronenesstovulnerabilitiesacrosslanguages arecriticallylacking.
to fill this gap we present polyfax a toolkit for characterizing multi language projects on github and dissecting the construction of multi language systems.
polyfax consists of three related tools modules acrawler ascrubber andtwoanalyzers.thecrawler retrievesprojectdatapergivencriteria includinggeneralproperties andhistoricalcommits i.e.
commitlogs authors codesnippets andsources.thescrubbersupportsdatapre processingtofacilitate further analysis.
as two instances of such analyses polyfax includesa tool forvulnerability fixing commit categorization vcc andoneforlanguage interfacingidentification categorization lic .
thevcctoolclassifiesagivencommitasonethatpotentiallyfixesa vulnerabilityofaparticularclass basedonfuzzymatchingbetween thecommitlogandkeywords phasessummarizedfromcwe .
the lictool identifiesthe mechanismsin which the different languages usedin amulti language systeminterface with eachother.
to assess its efficiency and effectiveness we used polyfax to characterize projects with .
million commits.
it finished crawling scrubbing and analyzing the .9gb data in .
.
and .
hours .
for vcc and .
for lic respectively.
our evaluation of the two analyzers based on random sampling and cross validation showed that they achieved precision and recall.polyfax is the technical enabler of a recent study on the vulnerability proneness of multi language software and expected to serve future studies of these systems.
the vcc tool is alsoimmediately applicable tosingle language projects.
a demovideofor polyfax ishereandtoolpackage here .
thiswork islicensedunderacreativecommonsattribution4.0international license.
esec fse november14 18 singapore singapore wenli lili andhaipeng cai architecture polyfaxpolyfax configure github reportscrawlerproject metadatascrubber analyzer vcc analyzer lic analyzer ...... figure1 overviewof polyfax .figure1gives an overview ofpolyfax s architecture.
as itsprimaryinput polyfax retrieves open source projects from github optionally users can customize the configuration as another input to letpolyfax only collectsamples ofinterests.
with these inputs polyfax performs data analysis with three modules crawler scrubber andanalyzer .
atfirst the crawler grabs repository profiles clones the projects and retrieves historical commits to the specified local storage.
then the scrubber performspre processing ofthetextualinformation e.g.
project descriptions commit logs outofallthe projectmetadata.
finally the analyzer executes vulnerability fixing commit categorization vcc and language interfacing mechanism categorization lic .vcc utilizes thefuzzywuzzytechnique oncommit logs to classify the commits into three high level vulnerability categories i.e.
porous defenses risky resource management and insecure interaction .
lic takes project sources as input and scansthemwithafinitestatemachine fsm modeledonsummaries oflanguageinteraction patterns itoutputs atuple oflanguageinterfacingmechanismsfor eachproject.afterallof theseanalyses complete the analyzer reports the results to users.
design and implementation this section describesthedesign and implementationof polyfax elaboratingits three modules crawler scrubber andanalyzer.
.
crawler crawler by domaincrawler by language githubcommit crawlerrepository profiles commitsprofile crawler figure overview of polyfax .thecrawler searches repositories using the github api filtering grabbingrepositories matching the criteria as configured.
specifically it consists of three sub modules twoprofile crawlers i.e.
crawler by language and crawler bydomain anda commitcrawler as showninfigure .
.
.
profile crawler.
a specific configuration defines the criteria of repository collection specifying project attributes such as popularity primary languages size creation date and updated date.withtheseconstraintvalues the profilecrawler constructs profile requests following the manual ofgithub sapi .
twoprofilecrawlersareavailablein polyfaxforcomplementary purposes.
crawler by language grabs repositories according to the user specified languages while crawler by domain searches andgrabsrepositoriesbasedonagivenfunctionality domainlist.
when no languages or domains are specified the crawler grabs projectswithstars greater than1 configurable bydefault.
for the over different project properties available on github polyfax retrieves7 i.e.
repositoryid stargazerscount languages url pushed date topics and description .
users can customize toinclude more or less to meet varying analysis needs.
as the output asetofrepository profiles isstoredinadatabase.
.
.
commitcrawler.
withtherepositoryprofilesasinput commitcrawler clonesalltheprojectstothelocalstorage andthen retrieves simply using git and parses all the commit information for each repository.
this approach is much more efficient than grabbing thecommitsusing githubapisdueto therate limitsof github .
for each commit polyfax saves five primary features i.e.
commitidentifier author date relatedissue ifexisted and commitlog henceuserscanretrievecodechangesanddetailsof issuesfor the commits for further in depthanalyses.
.
scrubber usually aninsightfulanalysisisnotreadilyfeasiblebyjustdirectly using the raw potentially noisy e.g.
textual information .
hence the scrubber is responsible for data cleaning taking the raw text e.g.
project descriptions commit logs as input.
this pre processing procedure transforms the text to accommodate a naturallanguageprocessing nlp algorithmviafourstepswhile leveraging nltkfor python a remove all charactersbesides numbers letters and commas from the input text b tokenize remaining text c lemmatize each token and d eliminate stop words.thisprocessresultsinasetofwordsthatcapturethecritical information for eachtextsnippet.
.
analyzer theanalyzer analyzesthedatacollectedfromgithub.specifically inpolyfax itincludes twoanalysistools vccandlic.
.
.
vulnerability fixingcommitcategorization vcc .
wedevelopedvccbased on the following assumption if the log of a commitcontainskeywords phrasesindicatingaclassofvulnerabilities thenweregardthecommitasaimingtofixthosevulnerabilities.
this is in the same spirit as prior work identifying bug fixing commits basedonkeywordsearch incommit logs.
based on the assumption vccworks in two steps vulnerabilitykeywordssummarizing.bysummarizingthetop25mostdangerouscwes threehigh levelcategories areobtainedas porousdefenses 11cwes riskyresourcemanagement 8cwes and insecure interaction cwes .
we applied the scrubber to the description for each category and extracted security related keywords or phrases.
vulnerability keywords matching.
based on the per category keywords we improved the fuzzywuzzy technique to classifycommit logsas outlinedinalgorithm .
the algorithm first retrieves these categories line and cleans thegivencommitwithpre processtext line3 followedbycomputinga matchscore between each category and the commit lines .
specifically it retrieves line and traverse keywords phrases in each category lines .
next the commit log is split into n grams lines for a given phrase keyword of length nand matched against thephrasewithfuzzywuzzy line18 .
forbetter precision we use a minimal score of as the threshold lines andtakethethehighestscoreforallphrasesofacategory lines1920 asthescore againstthat category line21 .
the best matching category is eventually returned as the vulnerability category for the given commit lines22 .
1663polyfax a toolkitforcharacterizing multi languagesoftware esec fse november14 18 singapore singapore algorithm1 identifying and classifying a vulnerability fixing commit input cmmt a commit includingitslogandcodesnippet output vcat thevulnerability category of cmmt 1function classifycommit cmmt 2vc initvulcategory categories with keywords phrases 3cmmt pre processtext cmmt tokenize stemmatize etc.
4catscore 5foreachcatinvcdo score the minimum match score as the threshold phraselist cat.phrases keywords phrases of category cat foreachphraseinphraselist do np getwordnum phrase ifphrase is a keyword nc getwordnum cmmt number of tokens xgramset the set of n grams in cmmt n np index whileindex ncdo end index np split cmminto n grams xgramstr cmmt xgramset .append xgramstr index match phrase againstcmm s n grams with fuzzywuzzy result fuzzywuzzy.
extractone phrase xgramset ifresult.score scorethen score result.score catscore score keep the best match score with cat 22vcat maxscorecat catscore take the best matched category returnvcat .
.
language interface categorization lic .
through manually checking respective languages official documentation we derived fourbasic languageinterfacingmechanisms foreign function invocation ffi .
with ffi the host language providesaforeignfunctioninterfacetobridgeitsownsemantics and calling conventions and those of the guest language s e.g.
java native interface jni injava .
implicit invocation imi .
imi is a cross language interfacing mechanism based on inter process communications e.g.
remote procedure call rpc .
embodiment ebd .
with this mechanism the languages are interdependent and coexist with each other with the code of one language often embedded in that of another language e.g.
the interfacingamong css html javascript .
hiddeninteraction hit .
withhit thereisnoexplicitindication of direct interaction between languages but there may be indirectdata connection between differentlanguages.
then wedevisedarule basedclassificationmodel cbasedon pattern matching andfinitestate machine fsm as follows c s0 f s r s0 f s s r s inthemodel s0andfrepresenttheinitialandendstaterespectively sisthestateset risthepatternset isthestatetransitionfunction and isaregularexpressionengine.given asequenceofinputs i i0 i1 ... in cobtains a set of matched rules r i iff s0 r fthen we sayiisclassifiedby c. ffi classifier set imi classifier set ebd classifier set hit classifier setc python classifier...... classifierruby java classifier s0s1 f s2import.
ctypes include python.h ctypes.cdll py initialize.
...... ...... ......language manuals lice categories repositoryclassifier encode module classifier scan module figure languageinterfacingmechanismclassification.algorithm2 classifyingaprojectbylanguageinterfacingmechanisms input p a multi language project repository output lp theset ofinterfacingmechanism labels for p 1function classifyproject p 2ac getclassifiers convene all the classifiers in l ice 3r compileregex ac compile all regexs in ac 4rc createmap ac create a map from regexs to classifiers 5foreachfileinpdo rm scanregex r file obtain matched regexs pc pickclassifier rc rm fetch relevant classifiers foreachcinpcdo ifclassifymatch c rm then lp.insert c.label one mechanism recognized iflp then lp.insert hit not ffi imi or ebd so defaulted to hit returnlp 14function classifymatch c rm 15sq initstatequeue c initialize with the initial state of c foreachrminrmdo qlen sq.length fork 0toqlen 1do s sq ns nextstate s rm state transition on input rm ifns nullthen continue ifisfinalstate c ns then returntrue reached a final state else sq.push ns save context for a matched pattern returnfalse basedonthismodel wedevelopedalanguageinterfacingclassificationengine lice asshowninfigure .liceconsistsoftwo collaboratingmodules classifier encode andclassifier scan .
classifier encode module cem .
cem aims to construct a chain ofclassifierset ffi imi ebd andhit .forthefficlassifierset we manuallysummarized the interfacing code patterns for top languages and20 fficlassifierswerefinallyconstructed e.g.
c java c python .
for imi we implemented classifiers byinvestigatingcodepatternsbased onstandardcomponents that support remote calls e.g.
d bus grpc .
theebd classifier set consists of one classifier for languages javascript css html asonlythesethreelanguagesareinterdependentand existinthetoplanguageselections.the hitsetincludesone classifier for the projectswithoutexplicit code patterns.
classifier scan module csm .
with a repository as input csm scans the source files one by one and works in a best effort fashiontoobtainalllanguageinterfacingtypes.asshownin algorithm aftercompilingregexsinalltheavailableclassifiers lines polyfax finds matched patterns r i line in each file line and picks relevant classifiers line .
if a classifier accepts all the matched patterns regexs the correspondingmechanismisrecognized line8 .todetermine the acceptance polyfax runs the nfsm as a non deterministic finiteautomatonagainstthoseregexs lines15 .importantly it maintains a matching context via the state queue sq to obtain allpossiblyacceptedregex sequences.
evaluation weevaluate polyfax throughthefollowingtworesearchquestions rq1whatisthe efficiency of polyfax?
rq2whatisthe accuracyof polyfax?
1664esec fse november14 18 singapore singapore wenli lili andhaipeng cai table1 timecostofindividualmodulesonanalysisof7 projectswith .6million commits.
module crawler scrubber vcclic time cost inhours .
.
.
.
table2 polyfax stimecostswithgrowingsamplesizes t denotes the timecost in minutes of .
subsetno.
projects size gb commits k t vcc t lic .
.
.
.
.
.
.
.
.
experimentsetup.
we ran the crawler inpolyfax without languages or domains specified the default star count for repositories wasconfigured in andonly multi language projects were saved.
both crawlers andanalyzers inpolyfax worked in asingleprocess.allexperimentswereconductedonaubuntu18.
systemwitha32 core amd 3970x cpuand256gb memory.
.
rq1 efficiencyof polyfax with the defaultconfiguration polyfax took a total of .
hours tofinishthewholeprocessofdatacollectionandanalysis during which projectsand12.
million commits were collected .
the time costs of individual modules are shown in table .
by contrast polyfax is much more efficient since it could take about three months to grab .6million commits bygithubapi .
tofurtherevaluatetherelationshipbetweentheefficiencyofthe twoanalyzersandthesamplesize wedividedthe7 113samples into three subsets and evaluated the time cost on the subsets as shownintable .fromtheresults wecanseethatthetimecost of vcc grows almost linearly as the number of projects or the number of commits increases a similar correlation can be found betweenlicandcommitorprojectcount.thisshowsthat polyfax iscapableof scalablefor large scale repository mining.
.
rq2 accuracyof polyfax to evaluate the effectiveness of polyfax we adopted a strategy of random sampling followedbycross validation.
evaluation of vcc.
to evaluate the accuracy of vcc we randomlysampled50projectsand500commitsperprojectfromthe dataset and constructed ground truth manually for gauging the precisionandrecallofvcc.specifically theauthorsindependently labeled the sampled commits following three steps read the commit log check the associated code snippet and check the issuecomments if they exist.
it is worth noting that each ground truth vulnerability fixing commit corresponds to an actual confirmed vulnerability rather thanjustkeyword phrasematches.afteralltheauthorscompleted independentlabeling theycross validatedandacceptedthelabelfor eachcommit when all agreed.
for cases withinitialdisagreement dedicateddiscussionswere held to reachfinal decisions.
table3summarizes the evaluation results.
while not complicated our tool achieved a quite competitive level of accuracy comparedtothestate of the artpeertoold2a whichonlyreported accuracy basedonasmallmanualstudyofonly57commitsin total althoughwecannotmakestrongclaimsheresincewedid notcomparebothtoolsonthesamedataset.moreover d2aonly targets c c projects while polyfax is language independent hence itcan be appliedmore broadly.table cross validation results ofthe vcc tool category commits precision recall porousdefenses riskyresourcemanagement insecure interaction table cross validation results ofthe lic tool category projects precision recall ffi imi ebd hit evaluation of lic.
per its design lic can identify a set of language interfacing mechanisms for each input repository.
for instance givenarepositorywithlanguageselection java c python lic may classify it as ffi ii because javainteracts with c through jni while cinteracts with pythonthrough d bus.
to evaluatelic sprecision werandomlysampled150projectsandconductedacross validationproceduretomeasuretheprecisionand recallbasedonmanualgroundtruth.accordingto theimplementation described in section .
.
the evaluation results are based onthe samples top languages .
table4presents the precision andrecallof liconthesamples since licesummarizedallthe possible interfacing mechanisms between top languages according to the respective official manuals it achieved high precision and recall.
specifically the precision ranged from a minimum of for imi upto for ebd andthe recallrangedfrom to .
.
discussion polyfax offers a series of useful features including repository crawling commitclassification andlanguageinterfacingcategorization.itsprecisionandrecallindicateitspotentialofbeingapplicable for multiple purposes.
for example the vcc can be used for empiricalanalysisaswellsforprovidingabundanttrainingdatafor machinelearning ordeep learning basedvulnerabilitydetectors sincethecodesnippets issues orevencvesofthecommitscan be retrieved from the results of vcc.
moreover it is not limited to particularlanguagesdueto its language independent nature.
foranotherexample resultsofthelicmayinformthedesign ofacross languagevulnerabilitydetector algorithmsspecificto eachinterfacingmechanismwillbemoreprecisethangenericones for arbitrary interfacing mechanisms.
for instance for ffi the algorithm may identify vulnerabilities with more precise data flow analysisbasedonforeign native function calls.
conclusion we presented polyfax a novel toolkit for characterizing multilanguage software.
it offers the capabilities of mining the repositories of open source multi language projects.
it also includes two analysistools forvulnerability fixingcommitcategorizationand language interfacing mechanism identification categorization respectively.weempiricallydemonstrated polyfax smeritsinefficiencyandeffectivenessagainstreal worldopen sourceprojects ongithub.
polyfax isopen sourceandpubliclyavailable.
acknowledgment wethank ourreviewersforconstructivecomments.
thisresearch wassupportedbynsf ccf andonr n000142212111 .
1665polyfax a toolkitforcharacterizing multi languagesoftware esec fse november14 18 singapore singapore