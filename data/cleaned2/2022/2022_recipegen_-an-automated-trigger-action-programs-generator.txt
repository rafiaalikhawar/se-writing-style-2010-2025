singapor e management univ ersity singapor e management univ ersity institutional k nowledge at singapor e management univ ersity institutional k nowledge at singapor e management univ ersity resear ch collection school of computing and information systems school of computing and information systems recipegen an aut omated trigger action pr ograms gener ator recipegen an aut omated trigger action pr ograms gener ator imam nur bani y usuf singapor e management univ ersity imamy .
phdcs.smu.edu.sg diyanah abdul j amal singapor e management univ ersity diyanahj.
scis.smu.edu.sg lingxiao ji ang singapor e management univ ersity lxjiang smu.edu.sg david l o singapor e management univ ersity davidlo smu.edu.sg follow this and additional works at https ink.libr ary.smu.edu.sg sis r esear ch part of the artificial intelligence and robotics commons and the softwar e engineering commons citation citation yusuf imam nur bani abdul j amal diy anah ji ang lingxiao and l o david.
recipegen an automated trigger action pr ograms gener ator.
.
esec fse pr oceedings of the 30th a cm joint e uropean softwar e engineering conf erence and symposium on the f oundations of softwar e engineering singapor e no vember .
.
available at available at https ink.libr ary.smu.edu.sg sis r esear ch this conf erence pr oceeding ar ticle is br ought t o you for fr ee and open access b y the school of computing and information systems at institutional k nowledge at singapor e management univ ersity .
it has been accepted for inclusion in resear ch collection school of computing and information systems b y an authoriz ed administr ator of institutional k nowledge at singapor e management univ ersity .
for mor e information please email cher ylds smu.edu.sg .
recipegen an automated trigger action programs generator imam nur bani yusuf diyanah binte abdul jamal lingxiao jiang david lo school of computing and information systems singapore management university singapore imamy.
phdcs.smu.edu.sg diyanahj.
scis.smu.edu.sg lxjiang smu.edu.sg davidlo smu.edu.sg abstract trigger action programs taps are event driven rules that allow users to automate smart devices and internet services.
users can write taps by specifying triggers and actions from a set of predefined channels and functions.
despite its simplicity composing taps can still be challenging for users due to the enormous search space of available triggers and actions.
the growing popularity of taps is followed by the increasing number of supported devices and services resulting in a huge number of possible combinations between triggers and actions.
motivated by such a fact we improve our prior work and propose recipegen a deep learning based approach that leverages transformer seq2seq sequence to sequence architecture to generate taps given natural language descriptions.
recipegen can generate taps in the interactive one click or functionality discovery modes.
in the interactive mode users can provide feedback to guide the prediction of a trigger or action component.
in contrast the one click mode allows users to generate all tap components directly.
additionally recipegen also enables users to discover functionalities at the channel level through the functionality discovery mode.
we have evaluated recipegen on real world datasets in all modes.
our results demonstrate that recipegen can outperform the baseline by .
.
in the goldstandard benchmark and .
in the noisy benchmark.
demo tool github ccs concepts software and its engineering search based software engineering information systems retrieval models and ranking computing methodologies machine translation .
keywords trigger action programming ifttt program generation deep learning encoder decoder acm reference format imam nur bani yusuf diyanah binte abdul jamal lingxiao jiang david lo.
.
recipegen an automated trigger action programs generator.
in proceedings of the 30th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than the author s must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse november singapore singapore copyright held by the owner author s .
publication rights licensed to acm.
acm isbn .
.
.
.
singapore singapore.
acm new york ny usa pages.
introduction trigger action programs simply taps are event driven rules used to automate smart devices and online services.
the rules are typically written in the form of if a trigger is satisfied then execute anaction .
the trigger andaction correspond to api calls provided by service providers.
taps have been applied in various use cases such as home automation business and data management .
in this work we are interested in generating taps automatically using natural language descriptions.
description from a user saves any photo tagged with me in it on fb to dropbox tap trigger facebook.you are tagged in photo action dropbox.add file from url url name path figure a simplified tap and its description.
figure shows an example of a tap.
to compose a tap users usually specify a trigger and an action sequentially.
for each trigger and action the user needs to select three components i.e.
a channel a function and a set of fields.
a channel is an entity that provides services.
a function is an api that represents a particular service.
for instance in figure the trigger channel is facebook and the trigger function is you are tagged in photo .
fields are additional parameters needed to control how a function works.
a field is composed of a field name and a field value.
fields can be either requisite or optional.
in figure the action function has several field names i.e.
url name and path .
the field values correspond to the actual values given by users.
writing taps can be challenging due to the enormous search space when choosing trigger and action components.
to exemplify in ifttt there are distinct channels resulting in possible combinations of trigger and action functions in .
the number of channels becomes in causing such possible combinations to increase further.
hence there is a need for a tool that can help end users to generate taps from such an enormous search space.
such a fact motivates a number of researchers to propose approaches to generate taps using natural language descriptions.
the existing approaches adopt classification based techniques to generate taps .
these approaches employ a number of distinct classifiers to predict each trigger and action component individually as illustrated in figure a .
consequently such approaches cannot perform well on ambiguous descriptions because it cannot leverage the implicit relationship between each predicted component.
we address this drawback in our recent work by proposing recipegen .esec fse november singapore singapore imam nur bani yusuf diyanah binte abdul jamal lingxiao jiang david lo figure a a classification model predicts each component in isolation given a description while b recipegen considers both the prior predicted components and the description when generating a prediction.
recipegen leverages transformer seq2seq architecture to translate a description to a sequence of trigger and action components.
as illustrated in figure b recipegen considers the prior predicted components as additional information besides the description to generate a tap component.
this mechanism allows recipegen to leverage the implicit relationship between each predicted component.
moreover recipegen adapts autoencoding pretrained models to warm start the encoder in the seq2seq model to boost the generation performance.
although the aforementioned works demonstrate great potential they only serve as a prototype to illustrate the viability of a research idea rather than to help users compose taps in the real world.
novice users may face difficulties using existing tools because they often still need to set up the tools and their environments.
moreover existing tools also force users to interact through a command line interface.
the lack of an easy to use tool to help users compose taps motivates us to improve our original tool and propose recipegen .
first we add a graphical user interface in recipegen to interact with end users and additional modules to prepare the input and output see figure .
second we add the interactive generation mode in recipegen besides the existing one click mode.
the interactive mode guides users to compose taps step by step resulting in users having more flexibility when composing such taps.
third we add the functionality discovery mode to let users discover more functionalities by generating taps at the channel level.
this mode is motivated by corno et.
al.
who found that users may not realize that a more suitable function exists for their use case as generating taps at the function level often yield results that do not capture such a function.
we have evaluated recipegen on real world datasets in each mode.
our results demonstrate that recipegen can yield better performance against the baseline by .
.
in the gold standard benchmark and .
in the noisy benchmark.
our work makes the following contributions we propose recipegen the first usable tool that leverages the transformer seq2seq architecture to generate taps using functionality descriptions.
recipegen frames the problem as a sequence learning problem and leverages a pre trained model to warm start the encoder.
figure user interface of recipegen .
we deploy recipegen such that the community can use our tool1directly without additional setup or installation steps.
moreover we also release the codebase2to train the model and replicate the results.
the rest of this paper is organized as follows.
section explains the usage of our tool.
section explains the technical details of recipegen .
section describes the evaluation setting and presents the results.
section discusses related works.
finally section concludes our work.
tool usage recipegen has three working modes i.e.
interactive one click andfunctionality discovery .
first users who want to have more flexibility when composing taps can use the interactive mode.
this mode guides the users using a step by step wizard.
users can select a component e.g.
trigger channel from a set of predicted tap components at each step then use the selected component as feedback to the model to guide the next tap component prediction e.g.
trigger function .
in contrast users who prefer to see the tap candidates quickly for a given description can leverage the oneclick mode.
this mode allows users to generate all tap components using a one click button press.
users who are not sure yet which channels or functions to use can explore the available channels and functions through the functionality discovery mode.
this mode enables users to find relevant channels based on the given description and allows them to inspect their functions exhaustively .
figure shows the user interface of recipegen .
users can describe the intended tap in the functionality description text box and tune the number of tap candidates using the beam width slider.
afterward users can generate tap candidates by pressing the generate taps button.
the generated candidates are shown in the table at the bottom.
note that the table can be scrolled horizontally.
the tap candidates are ordered based on the probability prediction a result with a high ranking is more relevant according to the model than those that are lower.
3recipegen this section explains the workflow of recipegen that consists of two stages training and deployment.
figure shows the modules involved in each stage.
in the training stage the initializer an automated trigger action programs generator esec fse november singapore singapore descriptionpreprocessortrained modelpostprocessorprediction filter graphical user interfacetap candidatesbackend frontendconfiguration initializer trainertrained model a b figure the workflow of recipegen consists of two stages training and deployment.
the modules involved in the former and latter stages are indicated by a and b respectively.
receives a configuration file as the input to instantiate the model.
subsequently trainer takes the model as the input and trains it to translate descriptions to taps.
in the deployment stage the frontend receives inputs from users and displays outputs from the model to users.
moreover backend modules have a role to perform preprocessing to user inputs generate tap candidates and perform postprocessing to model outputs.
.
training first we explain the general training pipeline that involves initializer and trainer.
second we explain the technique to augment the training data to train a model for the interactive mode.
.
.
training pipeline.
given a configuration file initializer instantiates the model using the transformer seq2seq architecture.
subsequently initializer warm starts the model encoder weights using a pre trained model.
the reason is that a pre trained model has been trained using a huge amount of data from english corpora and tap descriptions have a similar nature to such data see figure .
consequently the learning burden can be reduced if the encoder can have such knowledge at the beginning of its training.
then the trainer trains the model to translate functionality descriptions to taps.
the trainer input is description tap pairs.
first some special tokens are inserted into the descriptions and taps.
second a tokenizer converts the descriptions and taps into a sequence of subword tokens.
for example s saves any photo to dropbox s is tokenized into s save any photo to drop box s .
the motivation for tokenizing both descriptions and taps to subword level is to let the model exploit the subword similarity between the descriptions and taps.
third the tokenizer converts each subword token to the corresponding token idsx1 x2 ... x n. fourth the encoder transforms it into a sequence of context vectors c1 c2 ... c n. finally the decoder takes these context vectors and the sequence of token ids from taps y1 y2 ... y nas the input to generate the predictions p2 p3 ... p n .
.
.
data augmentation for interactive model.
the idea of the interactive model is to predict tap components in several steps where each step corresponds to one tap component prediction.
to train the model to generate taps in such a way the descriptions in the training instances should contain information about which component to generate and components that have been selected by users.
hence we apply algorithm to augment the original trainingalgorithm generating training instances for interactive generation input description a description of a tap components an ordered list of tap components prefixes a dictionary that maps a tap component to a prefix output outputs a list of training instances 1outputs 2n components getlength components 3foridx in range n components do target component components feedback converttostr components prefix prefixes.get target component final description prefix description feedback outputs.append final description target component 9end for pairs with such information.
algorithm converts descriptions in the original pairs to prefix description feedback line where prefix is used to indicate which component to generate and feedback corresponds to synthetic user feedback.
the feedback is obtained by concatenating the tap components before the current target component line .
.
deployment the deployment stage involves a graphical user interface gui module and a number of backend modules.
the input of the deployment stage is a description and the output is a ranked list of tap candidates.
.
.
graphical user interface gui .
the gui module allows users to interact with recipegen easily users can provide functionality descriptions through a text box generate predictions using a button and inspect the generated predictions through a graphical interface.
.
.
backend modules.
the backend consists of several modules.
the preprocessor transforms the description into a sequence of token ids.
the trained model then takes these token ids as the input to generate the tap candidates.
the postprocessor processes the tap candidates by removing the special tokens and converting them into a compatible representation for the gui module.
as we mentioned previously the model generates the prediction at the subword level.
consequently the model may generate invalid tap components because a set of predicted subwords does not form a valid component e.g.
non existent channel or function .
hence the prediction filter verifies each generated component to avoid such a case.
if the prediction filter finds invalid components then such components will be discarded.
evaluation and results .
experimental setting .
.
models.
we train recipegen and leverage roberta to warm start the encoder.
for the baseline we use lam which is the best classification based approach for tap generation.
weesec fse november singapore singapore imam nur bani yusuf diyanah binte abdul jamal lingxiao jiang david lo do not specifically compare with recipegen because it is the same as recipegen that works in one click mode.
.
.
datasets.
we use the ifttt datasets from quirk et.
al.
and mi et.
al.
to train and evaluate each model.
each instance in the datasets is a description tap pair where each tap is a sequence of a trigger channel trigger function action channel and action function.
there are two test sets gold and noisy.
both test sets are human annotated.
the annotation process is done by labeling each description with the tap implementation.
the gold set contains the instances with at least three annotator agreements.
the instances with less than three agreements belong to the noisy set.
.
.
scenario.
we evaluate each model in three different settings one click interactive and functionality discovery.
we leverage the original pairs from the test sets in the one click setting.
we omit the function components from the original taps in the functionality discovery setting.
we apply algorithm to convert the original pairs to prefix description feedback component pairs in the interactive setting.
.
.
metrics.
we leverage mean reciprocal rank mrr as the evaluation metrics .
mrr k is computed using equation mrr k q q i rank i where rank iindicates the first rank of the first hit or relevant result.
the value of1 rank iis if the ground truth is not in the top k returned taps.
mrr indicates the average number of predictions that a user needs to investigate to find the correct one.
table mrr results on gold and noisy set at different setting.
setting modelmrr gold noisy functionality discoveryrecipegen .
.
lam .
.
one clickrecipegen .
.
lam .
.
interactiverecipegen .
.
lam .
.
.
results table shows the mrr results on the gold and noisy sets in three different settings.
first recipegen outperforms lam by .
and .
on gold and noisy sets in the functionality discovery setting.
such results indicate that recipegen can have high accuracy in finding the relevant channels using the given description.
the improvements become .
and .
respectively when the models generate channels along with functions in the one click setting.
such results indicate that recipegen can rank taps with relevant functions better than lam.
moreover the improvements on the gold and noisy sets in the interactive setting are .
and respectively.
the improvements are smaller than the other two settings because the target taps consist of only onecomponent making the prediction easier.
however the significant improvement on the noisy set against other modes may indicate that user feedback can be useful in resolving ambiguous descriptions.
overall our results in table demonstrate that recipegen can outperform lam in all evaluation settings.
related work several approaches have been proposed to help users compose taps.
quirk et al.
trained classifiers using linguistic features such as word n grams.
beltalgy et al.
improved the previous approach by combining a logistic regression classifier with a multilayer perceptron mlp .
both approaches still ignore the description s semantics because they treat the description as bag ofwords.
this limitation is addressed by lam using lstm based classifiers.
however lam still performs poorly when the description is ambiguous due to formulating the problem as classification.
recipegen which is our proposed approach addresses this limitation by framing the problem as sequence learning.
some studies to generate taps interactively have also been carried out.
huang et al.
introduced a framework called instructablecrowd that allows users to compose taps by having a conversation with crowdworkers via a smartphone app.
chaurasia et al.
automate the previous approach by replacing the crowd workers with a conversational agent built using lam.
although it can scale better the conversational agent still has the same drawback as lam because it leverages lam as the core.
recently corno et.
al.
also developed several approaches to recommend taps .
however these approaches require additional information such as usage history user preference and semantic graph representation.
in contrast recipegen only requires users to input functionality descriptions to generate taps.
conclusion and future work this work presents recipegen a tool to help users compose taps using functionality descriptions of the intended taps.
recipegen frames the problem as sequence learning to allow the model to leverage the implicit relationship between each predicted component.
moreover recipegen also warm starts the encoder using a pretrained model to boost the generation performance.
recipegen can assist users in three different working modes interactive oneclick and functionality discovery.
our evaluation results show that recipegen can outperform the baseline with significant margins in all working modes.
in the future we plan to extend our tool to generate field values instead of only field names.
generating field values can be challenging as the description may not contain the necessary information to fill in the field values.
moreover we also plan to adapt recipegen to generate a tap with multiple triggers and actions.