on the vulnerabilityproneness ofmultilingual code wen li washingtonstateuniversity pullman wa usa li.wen wsu.eduli li monash university melbourne victoria australia li.li monash.eduhaipeng cai washingtonstateuniversity pullman wa usa haipeng.cai wsu.edu abstract software construction using multiple languages has long been a norm yetitisstillunclearifmultilingualcodeconstructionhassignificant security implications and real security consequences.
this paperaimstoaddressthisquestionwithalarge scalestudyofpopularmulti languageprojectsongithubandtheirevolutionhistories enabledbyournoveltechniquesformultilingualcodecharacterization.wefoundstatisticallysignificantassociationsbetweenthe proneness of multilingual code to vulnerabilities in general and of specific categories and its language selection.
we also found this associationis correlated with that of thelanguage interfacing mechanism notthat of individual languages.
we validated our statisticalfindingswithin depthcasestudiesonactualvulnerabilities explainedviathemechanismandlanguageselection.ourresults callforimmediateactionstoassessanddefendagainstmultilingual vulnerabilities for which we providepractical recommendations.
ccsconcepts security andprivacy software security engineering .
keywords multi languagesoftware multilingualcode softwaresecurity crosslanguagevulnerability languageinterfacing regression analysis acm reference format wen li li li and haipeng cai.
.
on the vulnerability proneness of multilingual code.
in proceedingsof the 30thacm jointeuropean software engineering conference and symposium on the foundations of software engineering esec fse november14 18 singapore singapore.
acm newyork ny usa 13pages.
introduction studies have shown that software written in multiple languages i.e.
multi language software is dominant .
intuitively thisprevalencehastodowiththebenefitsofcombining the best functional capabilities of different languages .
yet the decisions on language selection may not fully depend on functionalityconsiderations asearlierworksinitiallysuggested thedecisionsmaycomewithsecurity consequences.
cyber threats rooted in code vulnerabilities as introducedduringtheconstructionofsoftware havebeenontherise .
haipeng caiis thecorresponding author.
esec fse november 14 18 singapore singapore copyright heldby theowner author s .
acm isbn .
practice for years it is still not clear whether multilingual construction has significant security implications and real security consequences in terms of vulnerabilities in the code .
in particular we do not know whether certain language combinations are more associatedwithcodepronenesstovulnerabilitiesthanothers and ifso whatcontributestothegreaterorweakerassociations .italsoremains unknown whether the association if exists indicates actual vulnerabilities.
answers to these questions are essential for understanding anddefendingthe holistic security of multi language software.
amonga number ofrelevant looking works the majority addressed individual languages.
of the few works on multi language software most were focused on prevalence and good bad practices of developers or only limitedto jni java c programs .grichiet al.
reportedlikelygreatersecurityrisksofmultilingualcodethansinglelanguage ones but still for jni code only and based on only projects.
individual languages were found to have little association withbugproneness .yetitisunclearifthesameholdsbetweenvulnerability pronenessandselectionsofmultiplelanguages.
relevantworks lookedathigh levelcompanionship amonglanguages butnotcode levelinterfacingbetweenlanguages norwere they concernedwith security vulnerabilities.
inthispaper weconducta security focusedcharacterizationstudy ofmulti languagesoftware targetingthoseintheopensourceworld whilewithafocuson vulnerabilityproneness throughthelensof languageselection andlanguageinterfacingmechanism .
motivated bythe foregoingquestions ourstudy has three specific aims elucidatethesecurityrelevanceoflanguageselectioninterms ofthequantitativeassociationbetweensuchselectionsandthe resultingcode s vulnerability proneness explain justify the relevance via such proneness of individual languages andlanguageinterfacingmechanisms validate concretize statistical findings about the vulnerability proneness byconnectingitto actualvulnerabilities.
to that end we developed a new taxonomy and two novel tools formultilingualcodeanalysis hence conductedextensivestatisticalanalyses of4 popularmulti language projects on github and .
million commits in their year evolution history and manuallyinspected50projectsand500commitsforeach bothrandomly sampled.
with these facilities we answered three questions justifiedbythe specific aims with key findings as follows rq1 how is language selection related to the vulnerabilitypronenessofmultilingualcodethatusesthelanguages?
wefoundthatlanguageselectionwasoverallstronglyassociated with the proneness and the association was even stronger for specificcategoriesofvulnerabilities.somelanguageselections e.g.
c python were much more prone to vulnerabilities overall thiswork islicensedunderacreativecommonsattribution4.0international license.
esec fse november14 18 singapore singapore wenli lili andhaipeng cai thanothers e.g.
c c python andthesameselection e.g.
c shell canbemuchmorepronetoonevulnerabilitycategory e.g.
risky resourcemanagement thantoothers e.g.
insecureinteraction .
the mostprone selections were c c shell andc python.
rq2 what are the underlying factors contributing to the strongerorweakervulnerabilitypronenessofalanguage selection than others?
we identified and examined two intuitive contributors the individual languages selected and the mechanisms of interfacingacross languages.
we found that the interfacing mechanisms especially those via code level function calls either explicitly or implicitly were overall strongly associatedwiththemultilingualcode spronenesstobothvulnerabilitiesingeneralandtoparticularvulnerabilitycategories.some mechanisms e.g.
foreign function invocation were clearlymore prone than others e.g.
embodiment and the most prone mechanism was implicit invocation .
we found overall even stronger associationof individual languages among the studiedselections with such proneness.
the most prone were javaandc.
however the proneness of language selections was correlated with that of themechanism ofinterfacingacross theselected languages not with the proneness of the individual languages in the selections.
rq3doesthevulnerabilitypronenessofmultilingualcode indicate actual vulnerabilities in the code?
the statistical proneness was validated and concretized in sizable random manual sampling to strongly indicate actual vulnerabilities.
extensivein depthcasestudiesfurther demonstratedthepresence of various kinds ofreal world vulnerabilities in thesampled multilingual code.
all of the vulnerabilities were explainable by the underlying languageselection andinterfacingmechanism.
importantly wedefine quantify the pronenessofmultilingual code as likelyvulnerability fixingcommitsinthecode sversionhistory.
then wedefinethe pronenessofanindividuallanguage alanguage selection oraninterfacingmechanism astheirstatisticalassociation with the proneness of the underlying code and quantify these pronenessmetricsviatheassociationsignificance coefficients.this paper only addresses such associations notcausality we never intend to claim multilingual code vulnerabilities are caused by or dueto theindividuallanguages theholisticlanguageselections orthe languageinterfacingmechanismsusedinthe code.
contributionsandsignificance.
ournovelempiricalresultsprovidenotonlytheoverallstrongstatisticalgroundsforthevulnerabilitypronenessofmultilingualcode butalsoofferextensiveevidence onconnectionsbetweenthepronenessandactualvulnerabilities.
basedonthesefindings weprovided practicalrecommendations to researchers developers and tool builders which facilitate understanding analyzing and defending against vulnerabilities in multilingualcode.wealsocontributeanautomatedvulnerability classifierofcommitsmoreaccuratethanstate of the artpeertools thefirstautomatedlanguageinterfacingmechanismdetectorbased onthefirsttaxonomyofsuchmechanisms andareal worldvulnerabilitydatasetofagreatersize accuracy anddiversity covering more projects than peer datasets.
these newtoolsanddataset immediately support the practical adoption ofour suggestions.
data availability statement.
source code and datasets are all availableinour artifact andhavebeenmadepubliclyaccessible.
vulnerability categorization vc language interfacing classification lic negative binomial regression nbr in depth case studies ics vc resultsgithub repositories repository miningtechniques for study chosen repository list commits lic results ics results rq1 rq2 rq3figure overview ofour studyprocess.
methodology .
studyoverview figure1illustrates the overall process flow of our study.
as its primary input the process takes the repositories of open source projectsongithub .fromthissource weminedrepositorymetadata hence selected multilingual projects that met a few criteria andthen retrievedcommit information for eachproject.
based on this dataset we performed three main analyses vulnerabilitycategorization vc languageinterfacingclassification lic andin depthcasestudies ics .vcidentifiesandcategorizes security vulnerabilities based on commits further with the vc results anegativebinomialregression nbr analysis examines the relationships between vulnerability proneness and language selectiontoanswer rq1.then licanalyzeseachproject scodeto recognizeandclassifyitslanguageinterfacingmechanism.wealso applied nbr over the same set of projects as for rq1 to discover theassociationofthosemechanismsandindividuallanguageswith the project vulnerability proneness to answer rq2.
finally we randomlysampledasubsetoftheprojectstoexaminetheirvulnerability specifics through extensive manual inspections concretizing thestatisticalfindingsobtainedfromrq1andrq2 toanswer rq3.
.
repositorymining we mined repositories using the github api while applying fourfilters selection criteria as summarizedandjustifiedbelow the repository has or more stars a popularity indicator andthresholdusedinpeerpriorstudies these projects gained more attention thus the multi language softwarepracticeembodiedinthempotentiallyhasgreaterinfluence.
therepositoryhasbeenupdatedinthelatest6months areasonableindicatorofactiveness moreactiveprojectsismorelikely to be representative of ongoingpractices.
therepositoryhasbeeninmaintenanceforatleastthreeyears until orlater a reasonablylongversion history for identifyingvulnerabilitypronenessbasedoncommits.
the language selection did not change during the studied evolution period i.e.
three years essential for validly analyzing the effectsoflanguageselection onvulnerabilityproneness.
withthese filters ourdata samplingworkedintwosteps.first we sampledprojectsthatsatisfythefirsttwocriteriauntilweobtained satisfying projects this number represents a reasonably largescale.second wefilteredthese10 000projectsusingtheother twocriteriawhiledismissing single language projects.
specifically for the second step we ensured to only include unique projects noproject is afork of another in the dataset.
we alsoignoredthosethatarenotactualsoftwaredevelopmentprojects 848on the vulnerabilitypronenessof multilingual code esec fse november14 18 singapore singapore e.g.
course projects teaching tutorial code many on github arenot .foreachproject weretrievedthelanguageurlfor its repository with which the github api enables us to query thedetailedlanguageinformation includingthesetoflanguages selected referred to as language combination orlanguage selection oftheproject.languageswith oftotalcodesizewereremoved from each project s language selection and then projects using languagesleft were dismissed.
the above two steps resulted in multi language projects which were eventually used in our study these projects cover a varietyoflanguageselectionsunevenlydistributed e.g.
css html javascript .
c c shell .
c python .
.wethenretrieved all the commits of each chosen project in its year version history resultingin20.
million commits intotal.
.
vulnerability categorization vc to examinethesecurity relevanceof language selection asaway to justify such selections we needed to know for each project the overall vulnerability proneness and the proneness with respect to particular vulnerability categories.
to that end we developed anewtoolthatidentifiesandcategorizesvulnerabilitiesbasedon commits andapplieditto eachprojectinour sample set.
in a well known list compiled by mitre and the sans institute the top most dangerous cwes are categorized into threehigh levelcategories porousdefenses 11cwes risky resource management cwes and insecureinteraction cwes .
for each category we applied common text pre processing e.g.
tokenize lemmatize remove stop words to the description of eachcwe in thecategory to extract security related keywords or phrases.forinstance weextractedthephrase integeroverflow for cwe in risky resourcemanagement .
table1lists suchkeywords phrasespercategory.wethenappliedthesameprocessto changedcodeineachcommitasanaturallanguagetokensequence.
next we used the fuzzywuzzy technique to match the keywords phrases that characterize each of the three vulnerability categoriesagainstthetokensinacommitincludingitslog i.e.
commitmessage andcode.comparedtootherpopularapproaches e.g.
direct keyword searching regex matching fuzzywuzzy does not requireexactstringmatchingbutreportsthesimilaritybetweenthe patternsandinputstrings henceitstrikesabetterbalancebetween precision andrecall.
for instance inourpreliminary experiments direct keyword searching caused too many false negatives due to exact string matching with respect to diverse irregular wording stylesofcommitmessages betweenvulnerability relevantand irrelevant ones regex matching was relatively more effective but notusinganywildcardsdegeneratedittodirectkeywordsearching whileextensivelyusingwildcardscausedtoomanyfalsepositives.
as shown in algorithm we first retrieve these categories line andapplythesametextpre processingtothegivencommit line followed by computing a match score between each category and the commit lines 5 21 .
for each category we retrieve line and traverse its keywords phrases lines 8 20 .
next for each phrase keyword of length n the pre processed commit text is split inton grams lines 9 17 which are matched against the phrase with fuzzywuzzy line .
for better precision we use a minimal score of as threshold lines and take the highest score overall all phrases of a category lines 19 20 as the score against thatalgorithm1 identifying and clasifying a vulnerability fixing commit input cmmt a commit includingitslogandcodesnippet output vcat thevulnerability category of cmmt 1function classifycommit cmmt 2vc initvulcategory categories with keywords phrases 3cmmt preprocesstext cmmt tokenize stemmatize etc.
4catscore 5foreachcatinvcdo score the minimum match score as the threshold phraselist cat.phrases keywords phrases of category cat foreachphraseinphraselist do np getwordnum phrase ifphrase is a keyword nc getwordnum cmmt number of tokens xgramset the set of n grams in cmmt n np index whileindex ncdo end index np split cmminto n grams xgramstr cmmt xgramset .append xgramstr index match phrase againstcmm s n grams with fuzzywuzzy result fuzzywuzzy.
extractone phrase xgramset ifresult.score scorethen score result.score catscore score keep the best match score with cat 22vcat maxscorecat catscore take the best matched category returnvcat category line .
the best matched category is finally returned as the vulnerabilitycategory of the commit lines22 23 .
anycommitwasidentifiedasavulnerability fixingcommitif itwascategorizedintooneofthethreecategorieswithscore .
thekey assumptionhere isthatifa commitincludes phrases keywords relevant to a category in its log or code then the commit represents an attempt to fixthe corresponding type of vulnerabilities.given thataccuratevulnerability detection categorization remains an open challenge we used this approximate yet efficient and language agnostic approach under this assumption in thesamespiritaspriorwork identifyingbug fixingcommits basedonsinglekeywordsearchbutincommitlogsonly.eventuallyout ofthetotalof .
million commits we detected .38k as vulnerability fixing of which fall in the three categories respectively as shownintable .
to evaluate our approach we randomly sampled projects and500commitsforeach andmeasuredtheprecisionandrecall based on manual ground truth.
the results are listed in the last two columns of table .
in producing the ground truth the authorsindependentlylabeledthesampledcommits by reading the commit log checking the associated code snippet and checkingtheissuecommentswheneveravailable.then theycrossvalidatedandacceptedthelabel for eachcommit when allagreed.
forcaseswithinitialdisagreement dedicateddiscussionswereheld toreachfinaldecisions.itisworthnotingthateachground truth vulnerability fixing commit corresponds to an actual confirmed vulnerability rather than justkeyword phrase matches.while not complicated our technique achieved a quite competitive level of accuracycomparedtothestate of the artpeertools e.g.
d2a which only reported accuracy based on a small manual study ofonly57commitsintotal andvccfinder whichwaseven less accurate.
we cannot make strong claims here though since we did not compare thesetools on thesame dataset it is not immediately feasible to compare them against our tool on multi language projectsastheybothtargetc c projects.meanwhile ourtool liceislanguage independent hence more widely applicable.
849esec fse november14 18 singapore singapore wenli lili andhaipeng cai table1 characteristicsandourvulnerabilitycategorizationprecision prec andrecall rec ofthe20.37millioncommits cts category securityvulnerability description search keywords phrases ctsprecrec porous defensesthesearethevulnerabilitiesthatarerelatedtodefensivetechniquesthatareoftenmisused abused orjustplainignored.missing authentication missing authorization hard coded credential missing encryption unnecessary privilege user controlled key authorizationbypass brokencryptographic excessive authentication privilege escalation etc.
riskyresource managementthe creation usage transfer or destruction of important system resources is not properly managed.deadlock datarace dataleak bufferoverflow stackoverflow memoryleak exposed danger integer overflow memory corruption untrusted control etc.
insecure interactiondata is sent and received between separate components modules programs processes threads or systemsininsecure ways.sqlinjection commandinjection requestforgery reflectedxss unrestrictedupload csrf unintended proxy unintended intermediary incomplete blacklist originvalidationerror etc.
.
language interfacingclassification lic to gain an in depth understanding of the security relevance of languageselection wehadtodeterminethelanguageinterfacing mechanismofeachproject.wethusdevelopedataxonomyofsuch mechanismsthroughextensivemanualsearchviacodeandrelevant documentation reviews.
as per this taxonomy we then developed anewtoolfor automatedinterfacingclassification.
.
.
taxonomy.
in our taxonomy we definefourmechanisms foreign function invocation ffi a primary way of interfacingbetweenmainstreamprogramminglanguageisffi withwhichthehostlanguageprovidesaforeignfunctioninterface to match its semantics and calling conventions with those of the guest language.
for instance java the host provides java native interface jni to support interaction with native code written in c the guest .
two prominent features of ffi are that the language interfacing follows standard definitions as documented e.g.
jni python extension and the interactions are implementedwith explicitfunctioninvocations.
implicitinvocation imi we define imi as a mechanism with whichdifferentlanguagecomponentsinteractimplicitlyviainterprocesscommunication ipc forinstance socket basedmessage passing.
this is often seen in multi language distributed systems.
embodiment ebd the involved languages do not interact by explicit implicitinvocationsbutviaoneembodyingtheother the actualinteractionoftenoccurswithintheunderlyingruntimesystem e.g.
awebbrowserengine thatexecutesthemulti language program.
typically these languagesare interdependent on each other and even co exist.
for instance interfacing in the language selection css html javascript isviaebd as seen inwebapps.
hidden interaction hit in a selection with this mechanism there are no any code level evidence of connection even implicit ones between the languages.
the interaction is often realized through external data sharing.
for instance a python component downloads webdata as inputsofan analyzerwritten inc. .
.
classification technique.
for our study we developeda languageinterfacingclassification engine lice as describedbelow.
asshowninfigure licetakesaprojectrepositoryasitsinput anditoutputsthemechanismlabelsfortheproject.itworksasa chainofclassifiersets whereeachsetfocusesononeofthefour mechanisms and each classifier focuses on a unique pair of languages.underlyingeachclassifier cisacustomfinitestatemachine cfsm asillustratedfor c python inthefigureanddefinedbelow c s0 f s r s0 s f s s r s s r s wheres0istheinitialstate fisthefinalstateset sisthestateset r istheinputset asetofpatternseachrepresentedbyaregex isthe state transition function and is a regex engine.
given a sequenceffi classifier set imi classifier set ebd classifier set hit classifier setc python classifier classifierruby java classifier s0s1 fin s2import.
ctypes include python.h ctypes.cdll py initialize.
mechanism labelsproject repository liceinitial state figure2 the proposedinterfacingclassificationtechnique.
of inputsi i0 i1 ... in liceapplies the engine to obtain a set of matched patterns r i .
iff s0 r f iis accepted by cand the resulting label is that of the mechanism focused on by the classifier set that includes c otherwise licemoves to the next classifier set thelast hit setmustaccept i. first we manually built eachclassifier in lice.
we started with the top languages in the top language selections found in our study resultsforrq1 .then foreachofthe c2 66languagepairs we summarized the code e.g.
relevant functioncall patterns of interfacingbetweenthetwolanguageseachasaregexbyextensively inspecting related real world programs and official documentation e.g.
that on jni .
next we crafted the cfsm from the resulting regexsandtheirrelationships giventhediversityofspecificuse casesofinterfacingbetweenthetwolanguages usuallymultiple patterns need to be observed in particular sequences to accurately recognizeamechanism whichjustifiesouruseofautomatonfor classification.intheend wefound20ofthe66pairsusedffihence created20 classifiers for the ffiset.
similarly for the imi classifier set we created classifiers by inspecting relevant artifacts e.g.
d bus grpc .
from our top language selections we only found one javascript css html usingebd thuswecreatedoneclassifierfortheebdset.finally thehitset also includes oneclassifierwhich trivially acceptsany inputandlabelsitas hit .followingourprocedure licecanbe easily extended to include additional classifiers.
further details on the current29 classifiers can be foundinour artifact package .
when applying it to a project liceproduces the mechanism label s by analyzing the source files as i according to algorithm .
after compiling regexs in all the available classifiers lines 2 4 licefinds matched patterns r i line in each file line and picks relevant classifiers line .
if a classifier accepts all the matched patterns regexs the corresponding mechanism is recognized line 8 10 .
to determine the acceptance liceruns the nfsm as a non deterministic finite automaton against those regexs lines 15 27 .
importantly it maintains a matching context via the state queue sq to obtain allpossiblyacceptedregex sequences.
850on the vulnerabilitypronenessof multilingual code esec fse november14 18 singapore singapore algorithm2 classifyingaprojectbylanguageinterfacingmechanisms input p a multi language project repository output lp theset ofinterfacingmechanism labels for p 1function classifyproject p 2ac getclassifiers convene all the classifiers in l ice 3r compileregex ac compile all regexs in ac 4rc createmap ac create a map from regexs to classifiers 5foreachfileinpdo rm scanregex r file obtain matched regexs pc pickclassifier rc rm fetch relevant classifiers foreachcinpcdo ifclassifymatch c rm then lp.insert c.label one mechanism recognized iflp then lp.insert hit not ffi imi or ebd so defaulted to hit returnlp 14function classifymatch c rm 15sq initstatequeue c initialize with the initial state of c foreachrminrmdo qlen sq.length fork 0toqlen 1do s sq ns nextstate s rm state transition on input rm ifns nullthen continue ifisfinalstate c ns then returntrue reached a final state else sq.push ns save context for a matched pattern returnfalse table evaluationresults for lice category projects precision recall ffi .
imi .
ebd .
hit .
average asshown licemayreturnahybridmechanism.forinstance givenarepositorywithlanguageselection java c python licewill classify it as ffi imi java interfaces with c through jni while c interactswithpythonthroughd bus.followingasimilarprocedure to that for evaluating our vulnerability categorization technique we evaluated liceagainst randomly sampled projects with manual ground truth.
the results are summarizedintable .
.
statistical methods we usenbrto model the number of vulnerability fixingcommits as aresponse against a set of factors as predictors related to multi languagesoftwareprojectstostudytherelationshipbetween vulnerability proneness and several indicator factors e.g language selection asinspiredbypeerwork .wechose nbrasitcan process data with over dispersion a property of our datasets.
in this regression analysis for rq1 each language selection project pairisconsideredasamplefromthepopulationofmultilanguagesoftware.anyoftheprojectpredictorsislikelytoinfluence the response.
we consider the following predictors each as an independent control variableofthemodel projectage dayssince creation language selection size languages selected and the languageselectionitself.wemainlyfocusonlanguageselections as the indicator variables inour analysisto answer rq1.
asthefactorsinourstudyareunbalanced thenumberofprojects ofdifferentlanguageselectionsvariesinourdatasets weemployed weighted effects coding .
with this method each regression coefficient indicates the relative effect of the use of a particular languageselectionontheresponseascomparedtotheweighted mean of the dependent variable across all samples.
like in table distribution of the studied projects over the top 20language selections by selecting projects languageselection selectingprojects css html javascript .
c c shell .
python shell .
html python .
html ruby .
css html javascript python .
javascript python .
css html javascript shell .
javascript shell .
c shell .
java javascript .
html java .
c python .
c python .
objective c ruby .
go shell .
c c python .
javascript php .
c c python shell .
java shell .
table nbrcoefficients on the vulnerability proneness of language selections.
aic bic .
log likelihood deviance .
marks p .
p .
p .
independent factors coeff.
std.error intercept .
.
projectage .
.
languageselection size .
.
css html javascript .
.
python shell .
.
go shell .
.
c c python shell .
.
javascript python .
.
css html javascript shell .
.
c c python .
.
objective c ruby .
.
html python .
.
css html javascript python .
.
c python .
.
html ruby .
.
c python .
.
c c shell .
.
java shell .
.
javascript shell .
.
javascript php .
.
html java .
.
java javascript .
.
c shell .
.
weusedachi square testtocheckthedependencebetween two factor variables in a case of dependence we used an r c equivalentofthe phicoefficient to compute the effectsize .
we did the same analysis for rq2 but changing the indicator variables to interfacingmechanismsandindividuallanguages.
results in this section we present anddiscuss main results andfindings.
.1rq1 languageselection ssecurityrelevance we studied two aspects of the security relevance of language selection differentialvulnerability pronenessoflanguage selections whether some language selections are more vulnerability prone than others and topic traits of security relevance the traits of security topics in the underlying commit data that contribute to andthushelpinterpret theeffectsoflanguageselectionsonmultilanguagesoftwaresecurity.forbrevity weelaboratetheresultsfor the top most frequent language selections in our dataset as listed in table .
as we found in preliminary experiments examining moreorevenall selectionsdid not changeour conclusions .
851esec fse november14 18 singapore singapore wenli lili andhaipeng cai .
.
differentialvulnerabilitypronenessoflanguageselections.
toquantifytheoverallrelationshipbetweenlanguageselectionand the proneness we used a nbrmodel in which language selections are encoded with weighted effects as predictors and the number of vulnerability fixingcommitsasaresponse i.e.
dependentvariable .
details ofthis modelare summarizedintable .
thefirsttwoindependentfactors projectsize languageselection size are controlvariables.ourstudyis not focusedon theimpact of these factors albeit all the impact issignificant as expected.
all of the other independent factors the language selection variables e.g.
html ruby are indicator variables.
thecoefficientsherecompareeachlanguageselection perproject tothegrandweightedmeanoflanguageselectionsinallprojects.
each coefficient falls in one of three categories statistically insignificantaccordingtothe pvalues .
significantand positive and significantandnegative.apositivecoefficientindicatesthecorrespondinglanguageselection e.g.
c c shell css html javascript shell isassociated with more commitsintended for fixingsecurityvulnerabilities henceismorevulnerabilityprone than anaveragelanguage selection.
likewise a negative coefficient indicates a language selection e.g.
html python objective c ruby isless vulnerability prone than the average case in other words these selections are less likely to result invulnerability fixingcommits.
table5 nbrcoefficientsonthepronenessoflanguageselectionstoeachofthethreehigh levelvulnerabilitycategories.
marks p .
p .
p .
independent factorsporous defense riskyresource mgmt.
insecureinteraction coeff.std.err.
coeff.std.err.
coeff.std.err.
intercept .
.
.
.
.
.
projectage .
.
.
.
.
.
languageselection size .
.
.
.
.
.
css html javascript .
.
.
.
.
.
python shell .
.
.
.
.
.
go shell .
.
.
.
.
.
c c python shell .
.
.
.
.
.
javascript python .
.
.
.
.
.
css html javascript shell .
.
.
.
.
.
c c python .
.
.
.
.
.
objective c ruby .
.
.
.
.
.
html python .
.
.
.
.
.
css html javascript python .
.
.
.
.
.
c python .
.
.
.
.
.
html ruby .
.
.
.
.
.
c python .
.
.
.
.
.
c c shell .
.
.
.
.
.
java shell .
.
.
.
.
.
javascript shell .
.
.
.
.
.
javascript php .
.
.
.
.
.
html java .
.
.
.
.
.
java javascript .
.
.
.
.
.
c shell .
.
.
.
.
.
aic bic .
.
.
log likelihood deviance .
.
.
in essence the coefficient of the languageselection variablecan beunderstoodastheexpectedchangeinthelogorithmofdependent variable i.e.
vulnerability fixing commits with the other independent variables considered constant.
if we define a base factor the average of expected changes across all language selections here as foragivencoefficientofone languageselection then wecanpredicttheresponseas n e .forexample ifaproject with an average language selection had five vulnerability fixing commits amongsometotalnumberof anykindof commits then thenumber of vulnerability fixingcommits wouldbe expected as e0.
.74in the case of using c c shell much greaterthantheaverageoffive.similarly selecting html python wouldmean fewer e .
.
vulnerability fixingcommits.
vulnerability proneness of the studied projects were strongly associated withlanguage selections overall.some selections were clearly moreprone thanothers c c shell andc pythonwere most prone.
.
.
topictraitsofsecurityrelevance.
togainadeeperunderstand of this relevance we examined how language selection is associatedwithspecificcategoriesofvulnerabilitiesintermsofthe topic traits of the underlying commit data logs and changed code .
to that end we built a separate nbrmodel for each of the three categories .eachmodelisthesameastheonefortheoverallrelationshipexceptthattheresponse dependentvariable isthe numberof vulnerability fixing commitsbelonging to the particular category.table 5liststhe details of the three models.
thedevianceforeachper category nbrmodelissmallerthan the deviance for overall vulnerability proneness in table indicating that language selection had a greater impact on the proneness to specific vulnerability categories than its overall impact on the pronenesstoanykindofvulnerabilities.forexample thecoefficient ofcss html javascript was not significant per table .
in contrast it wassignificant intwoper category models here.
porous defenses.
vulnerabilities of this category are due to the misuseorlackofuseofnecessarysecuritydefensetechniques e.g.
missing authentication for critical function use of hard coded credentials missing encryption of sensitive data .
our results suggest a strongassociationbetweenlanguageselectionandthesevulnerabilities similar to the overall association .
certain selections wereparticularlystronglyassociatedwithporousdefensevulnerabilities.
the most noticeable is css html javascript python for its greatestpositivecoefficient0.
andhighestlevelofsignificance strengthtoo .notethat css html javascript haslittle and insignificant impact onthesevulnerabilities though.
this contrastpoints totheclearsecurityinfluenceof pythonwheninteractingwiththose three web languages.
in particular using just javascript andpython hadasimilarproneness coefficient0.
thus thesetwomaybe mostresponsibleforthe greatest vulnerabilitypronenessof css html javascript python .ontheotherhand someselections e.g.
html ruby had strong but negativeimpacts e.g.
coefficient .
suggestingtheyarerelativelysecureagainstthisvulnerabilitycategory.
similar observations can be madefor otherlanguageselections.
riskyresource management mgmt.
of our vulnerabilityfixingcommitsfallinthiscategoryofvulnerabilities whicharedue toimpropercreation usage transfer ordestructionofimportant system resources e.g.
integer overflow wraparound uncontrolled format string .
the results show that the impact of language selection on these vulnerabilities was generally more significant than that on the porous defenses category.
one exception is java javascript whichhadasignificantimpacton thelatterbutalmost no impact on resource management vulnerabilities.
most of the languageselectionshavingagreater than averageassociationwith these vulnerabilities include corc both are with unmanaged memory type hence prone to memory errors and wellknownfor being prone to memory vulnerabilities .
insecure interaction.
thesevulnerabilities towhich16 ofour vulnerability fixingcommits belong are aresultofinsecureways 852on the vulnerabilitypronenessof multilingual code esec fse november14 18 singapore singapore inwhichdataissentandreceivedbetweenseparatecomponents modules programs processes threads orsystems e.g.
crosssite request forgery cross site scripting sql injection .
while this category was the weakest among the three with respect to the residualdevianceofthemodel thedevianceexplainedbylanguage selectionwasstillstrong.theselectionswithsignificant positive coefficientsweremostlycombinationsoflanguagescommonlyused inwebapplications e.g.
javascript php java javascript .thiscanbe explainedbythefactthatvulnerabilitiesinducedbytheinteraction amongthesewebdevelopmentlanguagesareindeedprevalentin webapplications inparticular interfacesbetweentheselanguages arewellknowntobevulnerabletocodeinjections e.g.
cross site scriptingcommonly exploitedbyinjecting javascript code .
languageselectionwasmorestronglyassociatedwiththeproneness tospecificcategoriesofvulnerabilitiesthantovulnerabilitiesoverall.
the top selections were more prone to resource management risks and insecureinteractionsthanto porous defenserisks.
.
rq2 factors contributingto therelevance earlierstudiesrevealedcross languagelinksaspossiblepointsof high risks in multi language systems in general and interlanguage dependencies as contributors to the vulnerabilities of jni programs in particular .
we thus examine the effects of languageinterfacingonthevulnerabilitypronenessofmultilingual code that uses corresponding interfacing mechanisms as a way to justify explainthesecurityrelevanceoflanguageselection.westart withanoverviewofhowvariousmechanismsareused followed bythesametwoaspectsofsecurityrelevanceasexaminedforrq1.
another potential contributing factor lies intuitively in the individuallanguagesselected.thus we alsoexamine theireffects.
.
.
overalluseofinterfacingmechanisms.
foreachproject lice mined the interfacing mechanisms as completely as possible resulting in some language selections having hybrid mechanisms.
in total it found combinations of mechanisms over which our language selections were non overlappingly distributed as pureffi8.
ffi ebd .
ffi imi .
ffi imi ebd .
pure imi29.
imi ebd .
pure ebd5.
pure hit .
.implicitinterfacing was dominant of them used imi ebd orboth.onereasonwasthatonlyasmallportion of thelanguagepairswhoseinterfacingpatternsunderlaidtheconstruction of lice cf.
.
.
supported ffi not many languages support foreign functions.
another justification lies in the benefits of implicit interfacing it helps reduce the coupling among different language components andthecomplexity difficulty although increasing the flexibility of implementing the software especiallywiththeavailabilityofmaturesupportingframeworks e.g.
grpc for interfacing among c python java ruby .
we also found a substantial use of ebd mainly due to projects using theselection javascript css html .thisechoespriorfindingsonthe commonuseofgeneral purposeprogramminglanguagesinterfaced withdomain specific languages .
implicit interfacing was dominantly used over explicit mechanisms like ffi e.g.
jni justifiable by the practical benefits of the former.
.
.
differentialvulnerabilitypronenessoflanguageinterfacing.
the combinations of interfacing mechanisms were consideredtable nbrcoefficients on the vulnerability proneness of language interfacing mechanisms.
aic bic .
log likelihood deviance .
marks p .
p .
p .
independent factors coeff.std.error ffi .
.
ffi imi .
.
ffi ebd .
.
ffi imi ebd .
.
imi .
.
imi ebd .
.
ebd .
.
hit .
.
the independent variables and predictors in our nbr model here wherethenumberofvulnerability fixingcommitsisagainencoded as a response.
table 6shows the details of this model which quantifiesthe overallsecurity effectsof languageinterfacing.
thenbrnumbersrevealedstrongeffectsoflanguageinterfacing explicit i.e.
ffi orimplicit e.g.
imi aloneorwith ffi onthe vulnerabilitypronenessofmultilingualcode.itisknownthatusing multiple languages make a system more vulnerable than when usingasinglelanguage .ourresultscomplementbyoffering clearevidenceoflanguageinterfacingmechanismasamajorfactor oftheoverallsecurityrelevanceofusingmultiplelanguages.indeed contrasting the result here e.g.
table with that for rq1 e.g.
table4 confirmsthat themore less vulnerablemechanismswere thoseused in themore less vulnerable languageselections .
table7 nbrcoefficientsonthepronenessoflanguageinterfacing mechanisms to each of the three high level vulnerability categories.
marks p .
p .
p .
independent factorsporousdefense risky resource mgmt.
insecure interaction coeff.std.err.
coeff.std.err.
coeff.std.err.
intercept .
.
.
.
.
.
ffi .
.
.
.
.
.
ffi imi .
.
.
.
.
.
ffi ebd .
.
.
.
.
.
ffi imi ebd .
.
.
.
.
.
imi .
.
.
.
.
.
imi ebd .
.
.
.
.
.
ebd .
.
.
.
.
.
hit .
.
.
.
.
.
aic bic .
.
.
log likelihood deviance .
.
.
three mechanisms ffi ffi imi imi were significantly morevulnerability prone whichaccountedforthemajority .
of the language selections in our dataset.
meanwhile other mechanismswerelessprone e.g.
ffi ebd ornotsignificantlyassociated with the proneness e.g.
ebd hit .
based on ourextensive case studiesbycodeinspection akeyreasonforthesedifferentialeffects is thatffiandimiallow for immediate data interoperations at language boundaries via code level explicit implicit data control flows induced by direct function calls.
such high data interoperability promises for programming ease but welcomes additional surfacesforstealthyattacks.incontrast thesearenotreadilypossible withebdorhit.
interestingly ebdseemed to be not only more securethanaveragebyitself italsoappearedtohelpmitigatethe insecurity of more vulnerable mechanisms e.g.
ffiversusffi ebd imiversusimi ebd .thisislikelybecauseitsusehelpedreduce the amount of vulnerable cross language data exchanges that wouldotherwisebe fully handledbythe vulnerable mechanisms.
853esec fse november14 18 singapore singapore wenli lili andhaipeng cai bothexplicitandimplicitlanguageinterfacingmechanismswere strongly associated with code vulnerability proneness overall ffi and imi werethemost vulnerability prone mechanisms.
.
.
topic traits of interfacing effects.
to understand the effects on specific vulnerability categories we built a separate nbr model for each category using the same predictors as in .
.2but the number of vulnerability fixing commits only belonging to that category as a response.
table 7lists the details of the three models.
theresultsshowthatthethreeoverallmostvulnerablemechanismswerestronglyassociatedwitheachofthetwodominating vulnerabilitycategories cf.table whichlargelyexplainedthe overallassociationstrength.meanwhile amongthesethree both ffiandffi imi actually had less than average proneness to insecure interaction vulnerabilities.
the reason is because these vulnerabilitiesweretypicallyassociatedwithweblanguages cf.
.
.
whichdonotinteractthrough ffi.thisexplanationwasconsolidatedbythepositiveassociationbetweenthisvulnerabilitycategory and ebd the dominant mechanism of interfacing across web languages e.g.
javascript php .thesamecanalsoexplainthestrong effectofffi ebd onthiscategory.toverify wemanuallysampled and examined projects that use ffi ebd and found that of them used the language selection c c css html javascript the dominationofweblanguagescaused insecureinteractions .
proneness to insecure interaction vulnerabilities was most strongly associated with using ebd but the strength was counteracted by usingimi themostoverall vulnerability pronemechanisms ffi imi weremost prone to porous defensevulnerabilities.
.
.
effectsofindividuallanguages.
weperformedthesamenbr analysis as in .
.
with the model predictors changed to individuallanguagesamongthestudiedselections 1stcolumnof table4 and every data point changed to kpoints each for one oftheklanguagesselectedintheprojectbutwiththesameproject vulnerability proneness value.
table 8shows the model details.
overall the associations of individual languages were strong even strongerthanthoseoflanguageselections withthepronenessto bothvulnerabilitiesingeneralandthethreespecificvulnerability categories.the mostprone languageswere java c go andc .
however put together with tables 4and5 the results show thatthepronenessoftheseindividuallanguageshadgenerally no consistent correlation with that of language selections.
in some cases thelanguageselections e.g.
c python andsomeoftheselected individual languages e.g.
c were consistently prone or not.
yet inmorecases languageselections e.g.
c c python thatinclude one or more strongly prone languages e.g.
candc were not significantlyproneatall orevennegativelyprone .also thereare languageselections c python c python c c shell thathavemuch stronger pronenessthanany ofthe individuallanguagesselected.
ontheotherhand contrastingtables and8revealedmostly consistentcorrelationinthepronenessbetweenlanguageselections andthecorrespondinginterfacingmechanisms.forinstance the proneness of c c shell and that of the interfacing mechanism mostcommonlyusedinthisselection imiwereconsistentlystrong.
foranotherexample thepronenessof html rubyandhtml javawastable8 nbrcoefficientsonthepronenessofindividuallanguages.
marks p .
p .
p .
independentfactorsoverall porous defense riskyresourcemgmt.
insecureinteraction coeff.std.err.
coeff.std.err.
coeff.std.err.
coeff.std.err.
intercept .
.
.
.
.
.
.
.
html .
.
.
.
.
.
.
.
javascript .
.
.
.
.
.
.
.
shell .
.
.
.
.
.
.
.
ruby .
.
.
.
.
.
.
.
go .
.
.
.
.
.
.
.
java .
.
.
.
.
.
.
.
css .
.
.
.
.
.
.
.
python .
.
.
.
.
.
.
.
c .
.
.
.
.
.
.
.
c .
.
.
.
.
.
.
.
php .
.
.
.
.
.
.
.
objective c .
.
.
.
.
.
.
.
aic .
.
.
bic .
.
.
.
loglikelihood .
.
.
deviance .
.
.
.
table9 sampledprojectsandnumbersofconfirmedvulnerabilities vul in each by language selection langsel left table andinterfacingmechanism intermech right table langsel projects vul c c shellpencil 15ncmpcpp proxysql fontforge lnav c pythonlily 9redisearch pillow osmc phoenix java shellehcache3 6elassandra quasar smali siddhi 0intermech projects vul ffiangr 13restkit moderngl printrun2 sdmongodb ffi imimysql5.
8brackets shell openbr upx vispy imi ebdui grid 4flask admin wormhole securedrop statamic3 negative whichisconsistentwiththenegativepronenessof emd themostcommonlyusedinterfacingmechanisminthoseselections.
the proneness of language selections was generally consistently correlated with that of the underlying interfacing mechanisms but not consistentlywiththat ofthe individuallanguagesselected.
.
rq3 real worldmultilingualvulnerability ourresultsforrq1andrq2revealed strong statistical relevance of language selection to vulnerability proneness of multilingual code and strong statistical contribution of language interfacing mechanismtothatrelevance.nowquestionsremain a dothose general statistical findings hold in concretemultilingual code?
and b does the statistically strong proneness indicate actualvulnerabilities?
and if so c what do they look like and how are they inducedby thelanguageselectionsandinterfacingmechanisms?.
to answer these we conducted two large scale manual studies one to concretize validate statistical findings from rq1 and rq2 whiletheotherto demonstrate explainactualvulnerabilities in multilingualcode indicatedbythe statisticalproneness.
.
.
concretize validatestatistical findings.
we randomly chose 3toplanguageselectionsandrandomlysampled5projectsforeach as listed in table left .
then we randomly sampled commits foreachprojectandlookedintoeachcommittoconfirmifitwas indeedforfixingan actualvulnerability.thelasttwocolumnsof thetable showthe numberof confirmedvulnerabilities vul per project and the total for the language selection.
the per project vuls are sortedto easecomparisons acrosslanguageselections.
854on the vulnerabilitypronenessof multilingual code esec fse november14 18 singapore singapore as per our statistical numbers the selection c c shellwas noticeably more vulnerability prone than the selection c python coefficient .
vs. .
with the same level of significance strength p .
.
now per the numbers of actual vulnerabilitiesfound the c c shell projectswereindeednoticeably more vulnerable than the c python projects in our random samples.
similarly the statistical finding that java shell was the leastpronetovulnerabilities coefficient0.2766with p .
among thethreechosenselectionsisalsoconsistentwithourcasestudy resultshere the java shell projectssampledhadtheleast vuls .
withasimilarprocedurebutstartingwith3randomlychosen interfacingmechanisms we manuallystudiedanother randomset of5projectspermechanism aslistedintable right .pertable ffi coefficient0.2817with p .
was morevulnerability prone thanffi imi coefficient0.1676with p .
.thisisconsistentwith theactual vulnerabilities found inour samples the projects using ffihadgenerallymorevulnerabilitiesthanthoseusing ffi imi.
the least statistical proneness of imi ebd coefficient .
with p .
wasalsoconfirmedbythefewestvulnerabilitiesoverallin our sampledprojectsusing this interfacingmechanism.
ourstatisticalfindingsonthedifferentialvulnerabilityproneness of both language selection rq1 and interfacing mechanism rq2 were validated by consistent with the magnitude of actual vulnerabilitiesin concretemultilingual codein ourextensive casestudies.
.
.
demonstrate explainactualvulnerabilities.
weobservedwide presencesofcross languagevulnerabilitiesinourdataset.forspace limits wedemonstratethatin4 casesthat coverdifferent language selections and interfacing mechanisms.
in the per case figures arrow dashedlinesshowthevulnerableinformationflows ofwhich cross language ones are in red the associated vulnerability fixing commits are indicatedbythe code diffswithdeletedlinesgrayed.
case figure3 .revealedviacommit thetiffimageis the user input taken line and loaded line in pythonand then decoded line eventually via ffi offered with python sc extension by decodestrip inc line20 .withinthis cfunction theincorrectboundarycheck line27 ledtoa bufferover read vulnerabilityatline32.thecheckshouldensuretherealrowsize ofthetiffimage row byte size islessthantheexpected calculated size unpacker row byte size asfixedbythecommit line28 .thisvulnerabilityis explainedby theselectionof c which ismemory unsafe andtheuseofinterfacingmechanismffi which propagatesthe pythondata to the unsafememory operation in c. case figure4 .
found via commit aninsecure string copyvulnerability was induced by ffi offered with native abstractionsfornode js alsobutinadifferentlanguageselection c javascript .injavascript testport wastakenastheuserinput line1 .atline3 a serialport objectwasinitialized thenthe c functionopen definedatline20 wascalled line4 .eventually the vulnerability occurred at line where the string format specifier s wasmissinginthe c functionsprintf causingtheinsecure stringcopy vulnerabilityacrossthe twolanguageshere.
case figure5 .thecommit ledustoa crosssiterequest forgery csrf across3languages twiginterfacedwith javascript viatheebdmechanism while javascript andphpexchangeddata atoken overthenetwork i.e.
viatheimimechanism .thevulnerabilitywasfixed byretrieving and validatingthe token line figure case 1 buffer over read across c python .
figure4 case2 insecurestringcopyacross c javascript .
figure case 3 csrf across twig javascript php .
forafileoperation renaming .
thetokenwasintegratedintothe javascript function renamefile which wasembeddedin twig html atline3.then thedefinitionof renamefile wasmodified accordingly in javascript line including adding parameters and obtaining the token.
in php the token was extracted from the request line and verified line .
if the token is invalid the server wouldrefuse the request andabort line22 .
case figure6 .thecommit fixedanullpointerdereferencevulnerability explained by using the lilylanguage and c that interfaced via the hit mechanism.
a code snippet in lily was passed to an interpreter tat lines where the variable 855esec fse november14 18 singapore singapore wenli lili andhaipeng cai figure case 4 null pointerdereferenceacross lily c. b2was initialized as none.
whenb2reached line the interpreter implemented in ctried to decode its class id at line right value.container class id .
however the container pointerwasnullwhen b2wasnone causingthenullpointer dereference vulnerability.
to fix this issue theinterpreter added a validation checkat line17 before dereferencing the pointer.
cross language vulnerabilities were widely present in the studied multilingual code and were all explainable through the language selectionandinterfacingmechanismsamongtheselectedlanguages.
related work studyofqualityeffectsoflanguages.
recentstudieshavelooked at the fault proneness of design smells in multi language software and how inter language dependencies affect code quality .
yet they were both limited to one particular language selection java c and a small set only or less sample projects.
the study by abidi et al.
revealed that understandability is the most impacted quality attribute in a multi language system based on the perceptions of developers.
another study provided empiricalevidencethatmostdevelopers hadencounteredatleast onebugrelatedtocross languagelinkingandthattheuseofmultiple languages increased the difficulty of bug fixing .
a few otherrelevantstudies areonindividuallanguagesrather than language combinations.
our work differs in addressing the security impact of language selection in real world multi language projects.
on the other hand it would be interesting future work to studythevulnerabilitypronenessof single language projects prior works examined single language code s proneness to defects in general including security defects but did not particularly investigatethepronenesstosecurityvulnerabilities.thesekinds ofresults can be comparedwithandcomplementours.
analysisoflanguageinteractions.
bissyand etal.measuredthe closenessbetweendifferentlanguagesthatinformsaboutlanguage interoperability .
similar results were also obtained through an assessment of polyglotism which indicated strong relationships between languages and revealed the sets of languages that tend to be used together in practice .
our study also concerns the interactions between languages but indirectly yet more deeply aswelookedatlanguagesinselections.ourworkalsodiffersbylooking beyond the companionship of languages into the security rationales underlying the languageinteractions viainterfacing .
commit based vulnerabilityidentification.
likeourvctechnique prior works also explored identifying vulnerabilities in code repositories through analysis of commits.
d2a uses static analyzersandlearning basedclassifierstodetectvulnerability fixing commits.anotherrelevanttoolisvccfinder whichusescode metricsandgithubmetadataasfeaturestotrainasvmclassifierto labelacommitasvulnerability contributingornot.thetoolin usesfeaturesbasedoncommitmessagesandbugreportstoclassify a commit or report as vulnerability related or not.
our approach is differentandtendedtobemoreaccurate accuracyversus by d2a by vccfinder by for commit classification .
real world vulnerability datasets.
we contribute a dataset on vulnerability fixingcommits whichissimilartod2a innature but much larger in size ours versus their such commits with much greater accuracy.
meanwhile our dataset complements to cve based datasets such as bigvul and cvefixes whichare muchsmallerandfor c c code only.
discussion .
toolsanddataset despite the overwhelming and growing dominance of multilingual systems inreal worldsoftwaredomains toolsupport forunderstandingandanalyzingthese systemsislacking.beyond ourempiricalfindings wecontributetwonoveltools vc .
for automaticallyidentifying classifyingvulnerability fixing commits andlice .
forautomaticallyidentifying classifyinglanguage interfacing mechanisms .
both tools offer promising accuracy they not only enabled our study but also will empower future characterization studies andtool development for multi language software.inparticular vc outperformed thestate of the artpeer tools asdiscussedin whileliceisthefirstofitskindbasedon ournovel first taxonomy of languageinterfacingmechanisms.
importantly usingvc wecontributeanimportant much needed sizabledataset asetof141.38kvulnerability fixingcommits along withtherepositoryinformation associatedissueids andbugtagging whenever available.
beyond supporting relevant empirical studies thisdatasetcanboosttheperformanceofmachinelearning ml especially deep learning dl based vulnerability analysis e.g.
detection repair tools.
extant such tools sufferpoorperformanceonreal worlddatasets mainlybecause theml dlmodelswereonlytrainedonlargelyartificialdatasets whichdonotwellrepresentrealisticvulnerabilitiesandcodebases existing realistic datasets e.g.
are small while existing sizeabledatasetsareonlyartificial.ourcommitdatasetcorresponds to141.38kpairsofreal worldvulnerablesamplesandtheirfixed versions which can serve as a large scale realistic dataset to train dl mlmodelshenceimprovetheirperformanceagainstreal world software.asdiscussedin oursismuchlargerandofhigherquality duetovc shigheraccuracy thanthemostrecentpeerdataset.
licecan also be used beyond our studies.
for instance with the interfacingmechanism it reports it can guide the development of cross language vulnerability detection techniques.
interfacingmechanism specificdetectionrules algorithmscanbethendevised which would be more accurate than a universal generic technique handling multilingualcode of arbitrary interfacingmechanisms.
856on the vulnerabilitypronenessof multilingual code esec fse november14 18 singapore singapore .
implications .
.
attentiontocross languagevulnerabilities.
wefoundstrong vulnerability proneness of multilingual code .
.
.
our extensive case studies further confirmed that the proneness did indicate actualvulnerabilities .
.yet existingworksonthesevulnerabilitiesarerare.forexample afterchecking1 papersonprogram analysis randomly chosen from those published in the past years intheacmdigitallibrary wefoundonly0.
oftheseare generally relatedtocross languageanalysis andthese0.
almost exclusivelytargetedaparticularlanguageselection c java .
however c javawasnoteveninourtop 20languageselections.
we suggestthatour communitystarts to attendto this severe gap andurgentissuebyinvestingintoolsandstudiesoncross language defectswhilegoing beyondjava c jni software.
.
.
practicalrecommendationsforresearchers.
whilebothbased ongithub earlierstudies foundlittleeffectof individual languages on software proneness to defects whereas ours revealed strong effects of language selection on the vulnerability proneness of multilingual code .
.
we further found .
that these effects weregenerally correlated with thoseoflanguageinterfacing mechanisms rather than with those of individual languages.
thus we suggest researchers examine and utilizelanguage interfaces when addressing multilingualcode security.
we found ffi and imi as the most vulnerability prone mechanisms for language interfacing.
both of them allow for direct data interoperations via code level invocations explicit or implicit .
we suggest to prioritize on multilingual code using these mechanisms addressingnotonlyexplicitcross languageinteractions e.g.
via foreign native functions but alsoimplicitones e.g.
viarpc .
.
.
practicalrecommendationsfortoolbuilders.
inparticularfor thosetobuildtoolsformultilingualsecurity wesuggesttheyleverage ml dl models in addition to program analysis approaches.
ml dl models can be built using attributes of language selections e.g.
size properties like types of each selected language and those of interfacing e.g.
mechanism category interface parameters as learning features while leveraging our large realistic vulnerability dataset for training and validation.
meanwhile given thediversityoflanguageselectionandinterfacing wesuggestcodeanalysis based approaches focus on language independent analyses e.g.
developingalanguage selection specificanalysislike the onesfor java cis notsufficient .
onespecificapproach is tocompute cross languageinformationflow toidentifymultilingual vulnerabilities as we demonstratedinour casestudies .
.
.
.
practicalrecommendationsfordevelopers.
ourresultsclearly indicate that some language selections e.g c python were significantlymorepronetovulnerabilitiesthanothers .
andthe pronenessdidindicaterealvulnerabilities .
soweresomeinterfacing mechanisms e.g.
ffi imi than others .
.
we suggest developerschooselessproneselectionsandmechanisms ifpossible tomakethemultilingualcodepotentiallymoresecure.moreover wefoundthatitwasnotuncommonthatdifferentkindsofinterfacingmechanismswereusedforthesamelanguageselection.thus if alanguageselectionmustbechosen wesuggesttostillchooseless vulnerability prone mechanisms for interfacing among the chosen languagesifpossible.finally basedontables 5and7 wesuggesttomake choices of the selections and mechanisms that are less prone to thecategories ofvulnerabilitiesthat are mostconcerning.
.
threatsto validity the validity of our results was affected by the inaccuracy of our licetoolusedforlanguageinterfacingclassification.moreover the tool was built on our manual summaries of interfacing patterns among the top mainstream languages and it was applied in our studyaroundthemanuallyderivedtaxonomy.andthetechnique wasevaluatedonlyagainstasmallsample.biasesanderrorsduring such manual processes may have caused greater inaccuracy in our studyresultsthanwhatwereported.asimilarthreatappliestoour tool for commit based vulnerability categorization and the manual processofevaluatingitsaccuracy.inaddition thecorrectnessof bothtoolsislimitedbytheaccuracyoftheunderlyingtoolsused nltk regex and fuzzywuzzy .
to mitigate these threats we followed a cross validation procedure by which the results were approvedbythethreeauthorsinvolved.wealsochosetosample randomly in the manual evaluation to reduce the associated threat.
relativetothepopulationofmulti languagesoftware ourdatasets onlyrepresentsmallsamples.thus ourfindingsandconclusions are best interpretedfor the sampled projects and we cannot claim that our results generalize to any other projects.
to reduce this threat we used a reasonably large dataset and applied multiple projectfiltersalongwithrandomsamplingtoreducedatanoises.
meanwhile we cannotrelyoncvesdueto the small dataset size.
inaddition wedidnotdifferentiatelanguagesofdifferentclasses data modeling versus programming languages and treated all languages equally in calculating code sizes in bytes.
we actually intendednottolimitourstudytoaparticularlanguageclass note that non programming languages can play critical roles in code vulnerabilitiestoo e.g.
the twigtemplatinglanguagecontributed tothevulnerabilityinfigure wealsodidnotruleoutanyparticular kind of language because we do not have a priori knowledge regardingwhichkindsmustnotberelevanttovulnerabilities.yet thistreatmentmayhavecausedbiasesinourresultsinterpretations.
thevalidityofmostofourresultsisalsoaffectedbytheinaccuracy ofgithublinguist we usedfor retrievinglanguageselections.
conclusion we presented a large scale study on the vulnerability proneness of multilingualcode enabled by a novel taxonomy of language interfacing mechanisms two novel dedicated tools and new sizable datasets.
from github projects and .
million commits in their repositories we revealed strong statistical relevance of language selectionand interfacing mechanismtothe proneness and evenstrongeroneswithrespecttospecificcategoriesofvulnerabilities.wefurtherconducted extensive manualinspectionstudiesof50 sampleprojectswith500commitsforeach bothrandomlysampled hence validated our statistical findings and demonstrated actual multilingualvulnerabilitiesindicatedbytheproneness.basedon our results we provided insights and actionable suggestions on addressing multilingualvulnerabilitiesfor variousstakeholders.
acknowledgment wethank ourreviewersforconstructivecomments.
thisresearch wassupportedbynsf ccf andonr n000142212111 .
857esec fse november14 18 singapore singapore wenli lili andhaipeng cai