windranger a directed greybox fuzzer driven by deviation basic blocks zhengjie du state key laboratory for novel software technology nanjing university nanjing chinayuekang li nanyang technological university singapore yang liu nanyang technological university singaporebing mao state key laboratory for novel software technology nanjing university nanjing china abstract directed grey box fuzzing dgf is a security testing technique that aims to steer the fuzzer towards predefined target sites in the program.
to gain directedness dgf prioritizes the seeds whose executiontracesareclosertothetargetsites.therefore evaluating thedistancebetweentheexecutiontraceofaseedandthetarget sites aka theseeddistance isimportantfordgf.thefirstdirected grey box fuzzer aflgo uses an approach of calculating the basic blockleveldistancesduringstaticanalysisandaccumulatingthe distancesoftheexecutedbasicblockstocomputetheseeddistance.
followingaflgo mostoftheexistingstate of the art dgf techniques use all the basic blocks on the execution trace and only the control flow information for seed distance calculation.
however not every basic block is equally important and there are certainbasic blocks where the execution trace starts to deviate from the target sites aka deviation basic blocks .
inthispaper weproposeatechniquecalledwindrangerwhich leveragesdeviationbasicblockstofacilitatedgf.toidentifythe deviation basic blocks windranger applies both static reachabilityanalysisanddynamicfiltering.toconductdirectedfuzzing windranger uses the deviation basic blocks and their related data flow information for seed distance calculation mutation seed prioritizationaswellasexplore exploitscheduling.weevaluated windranger on datasetsconsisting of programs.
theexperimentresultsshowthatwindrangeroutperformsaflgo afl and fairfuzz by reaching the target sites and faster and detecting the target crashes and faster respec tively.
moreover we found a day vulnerability with a cve id assignedinffmpeg apopularmultimedialibraryextensivelyfuzzed by oss fuzz with windranger by supplying manually identified suspect locations as the target sites.
corresponding author.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acmmustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
request permissions from permissions acm.org.
icse may pittsburgh pa usa association for computing machinery.
acm isbn ... .
concepts securityandprivacy softwaresecurityengineering software and application security keywords fuzz testing directed testing acm reference format zhengjie du yuekang li yang liu and bing mao.
.
windranger adirectedgreyboxfuzzerdrivenbydeviationbasicblocks.in 44thinternationalconferenceonsoftwareengineering icse may21 pittsburgh pa usa.
acm new york ny usa pages.
.
introduction softwarevulnerabilityisamajorthreattosoftwaresecurity.fuzzing is a software testing technique for finding vulnerabilities.
the key idea of fuzzing is to feed the program under test put with a large amount of test inputs and observe for abnormal behaviors e.g.
crashes of the program.
according to how much information about the program internals is used fuzzing techniques can be categorizedasblackbox greyboxandwhitebox.blackboxfuzzing techniquesrequirenoknowledgeabouttheinternalsoftheputand theymaylackeffectivenesswhentestingprogramswithcomplex states.
whitebox fuzzing techniques captures the entire execution context memory registersetc.
oftheputandtheyoftenapplytechniques such as symbolic execution or taint analysis which maylimittheirapplicabilityonlargeprograms.greyboxfuzzing techniquesuselight weightprograminstrumentationstocollect therun timeinformationneededforguidingthefuzzingprocess.
greyboxfuzzinghasthebestofbothworldssinceitisbotheffective enough to detect deeply embedded bugs and scalable enough to be applied to large programs.
therefore greybox fuzzing is widely used by both practitioners and researchers .
despitebeinghighlyeffective greyboxfuzzinggenerallylacks the directedness to reach predefined target locations in the put aka target sites1 .
to address this issue b hme et al.
proposed the concept of directed greybox fuzzing dgf in .
the key feature of dgf is that it spends most of its time budget onreaching and testing the target sites without wasting resources 1inthispaper weassumeeachtargetsitecorrespondstoonebasicblockintheprogram ieee acm 44th international conference on software engineering icse authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhengjie du yuekang li yang liu and bing mao stressingunrelatedprogramcomponents.thus dgfcanreachand test the target sites in the put faster than general purpose fuzzing techniquessuchascoverage guidedgreyboxfuzzing cgf which focuses on maximizing the code coverage.
this feature makes dgf excel in certain usage scenarios such as patch testing crash reproduction and static analysis report verification .
for patch testing thepatchedcodesitescanbesetasthetargetsitesandwith thedgftechnique onecanquicklytestwhetherthepatchesare completeornot.forcrashreproduction thecrashingsitecanbe set as the target site and with the dgf technique one can quickly reproduce and acquire the proof of concept crashing input.
for static analysis report verification the suspicious locations reported viastaticanalysescanbesetasthetargetsitesandwiththedgf technique one can check whether the reported locations really contains vulnerabilities.
from these usage scenarios we can observe that reaching the targetsitesistheprimarygoalfordgf.inpractice thetimebudgetsfortheseusagescenariosareoftenlimitedandthenumberoftarget sitestoreachcanbehuge.therefore speedinguptheprocessofdirecting the fuzzer to reach the target sites can help to betterfulfill these tasks.
for example for static analysis verification if thedgfcanreachmoretargetsiteswithafixedamountoftime then the chance of revealing vulnerabilities is increased.
in recent years researchers have proposed several techniques to allow dgf toreachandtestmoretargetsiteswithalimitedtimebudget .
in dgf to gain directedness the fuzzer needs to identify and prioritizetheseeds2whoseexecutiontracesare closertothetarget sites.thus correctlymeasuringthe distanceofagivenseedtowards thetargets isan importantfactor forboosting theperformanceof dgf.tocalculatethedistanceofaseedefficiently theauthorsof aflgo proposed a novel two step approach first during static analysis computethedistancebetweeneachbasicblockandthe targetsitesonthecallgraphandcontrolflowgraphandtheninstrument the distance information into the program during fuzzing aggregatethedistancevaluesofeachexecutedbasicblockasthe distance of the seed.
this approach enables aflgo to calculate the seed distances with low runtime overhead.
although aflgo s approach of seed distance calculation is efficientandhelpswiththetargetorientationofthefuzzer itsuffers from two pitfalls the seed distance calculated with allthe basic blocksontheexecutiontracecanbebiasedbecausenoteveryblock is the key of driving the execution towards the target sites.
forexample suppose the fuzzer needs to evaluate two seeds a andb.
assume seed a goes through a lot of basic blocks which arefar away from the target site before it ends up somewhere very close to the target site while seed b does not go through too many basic blocks and it ends up somewhere not as close.
rationally the fuzzer should prioritize seed a rather than seed b since seed a can eventually get closer to the target site.
however if all the basic blocks are counted the distance of seed a can be larger due to the noisesintroducedbysomeofthebasicblocks.
theseeddistance calculationis onlybasedoncontrolflowinformationwhilethedata flowinformationisignored.currently thedistancebetweenabasic blockandatargetsiteiscalculatedbasedonthenumberofedges 2in this paper we denote all the files fed to the program in fuzzing as inputs and only the inputs preserved for subsequent fuzzing as seedsbetween them on the control flow graph and call graph.
however this distance cannot represent the difficulty of reaching the targets with the seed.
for example a basic block of a comparison for a checksum value can have two edges extending from it one for the equalbranchandoneforthenotequalbranch.fulfillingtheedgeoftheequalbranchismuchharderthanthenotequalbranchwithout avalidinput.thus thesetwoedgesshouldbetreateddifferently during distance calculation.
tofindsolutionsfortheaforementionedpitfalls wescrutinize theexecutiontracesfailingtoreachthetargetsitesandobservethat for every execution trace there are some key basic blocks where it startstodeviatefromthetargetsites.wenamesuchbasicblocks asdeviation basic blocks dbbs .
if the execution trace at the dbbs can be altered then the target site can be reached.
based on this observation weproposewindranger3 adirectedgrey boxfuzzer augmented by dbbinformation.
the workflow of windranger contains two major steps static analysis and fuzzing.
during static analysis windranger first identifies all the potential dbbs which contain branches where the execution can deviate from the target sites.
then windranger calculates the distanceof the identified basic blocks to the target sites.
during fuzzing given a seed andits execution trace windranger first selects the dbbsf r o mt h e statically identified candidates for the seed based on its executiontrace.
.
then windrangercalculatesthedistancevaluefor the seed based on the dbbs and adjusts the distance value based ontheconditionmatchingdifficultyofthese dbbs .
.withthe calculated distances windranger then prioritizes the seeds by adjustingthepowerschedulingstrategy.inaddition baseson dbbs windranger also improves the seed prioritization strategy .
mutationstrategy .
aswellastheexplore exploitswitching decision process .
to further enhance the performance.
to evaluate the performance of windranger we selected programsfrom3datasetsasbenchmarksandusedaflgoaswellas two coverage guided grey box fuzzers afl and fairfuzz as baselines.
we conducted cpu hours of experimentsto evaluate windranger s capability ofreaching target sites inthe programs andreproducingcrashes.ourexperimentresultsshowthatcompare with aflgo afl and fairfuzz windranger can reach the targetsitesfasterby21 and37 anddetectthetargetcrashesfasterby44 and77 respectively.inpractice withmanually selected target sites windranger successfully discovered a day vulnerability on one of the sites with a unique cve id assigned in ffmpeg .
themain contributionsofthispaperaresummarizedas follows wepresenttheconceptofdeviationbasicblockandanapproachofidentifyingthedeviationbasicblockswithstatic and dynamic analysis.
we present windranger a directed grey box fuzzer leverages the deviation basic block information to augment seed scheduling and mutation strategies.
we implementthe prototype for windranger and publish the source code for future research.
weevaluatewindrangerthoroughlywithextensiveexperiments and demonstrate the superiority of windranger.
3windranger is a heroine in the game dota2.
her ultimate skill is called focus fire which allows her to quickly take down the target enemy.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
windranger a directed greybox fuzzer driven by deviation basic blocks icse may pittsburgh pa usa this paper is accompanied by a website com view windranger directed fuzzing .
the experimental data and source code are available on this website.
motivating example figure shows a code snippet crafted from cve whereuse after freebugscanbetriggeredwhentheprogramcalls thegetnamefunction fromthe decompilejump function.
besides thesourcecode figure1alsoshowsthecorrespondingcontrolflow graphofthecodesnippetwhereeachnoderepresentsabasicblock.
suppose we are trying to use dgf to reproduce this cve we will need to set the basic blocks containing line and line as the target sites and calculate the distance of each basic block to the target sites accordingly.
for simplicity here we use the number of edges between a basic block and the nearest target site as its distance value.4in the control flow graph in figure the notation of x y means that x is the line number of the first instruction of the basic block and y is the distance of the basic block towards the target.
if the target sites are not reachable from a basic block only thelinenumberislabeled.forexample node6 3meansthebasic block starts from line six and it can reach the nearest target site online16bytraversingthreeedges.anotherexampleisnode18 which starts from line that is a return.
since the program can neverreachthetargetsitesafterthereturn nodistanceisassigned to node .
limitationsofexistingapproaches.
assumethedirectedgreybox fuzzer has found three seeds a b and c and their execution tracesareshowninfigure1.fortheexecutiontracesofseedsin figure the executed basic blocks are marked with dark background and the executed edges are represented with dashed lines.
now weneedtocalculatethedistanceofeachseedtodecidewhich one should be prioritized.
following the idea of where the distance of a seed is the arithmetic mean of the distances of allthe basic blocks on its execution trace the distances of seed a ba n dca r e3 .
.
and3 respectively.basedonthesedistances itseemsseedcshouldbe preferred.
however in reality the condition on line is very hardforthefuzzertopenetratethrough meaningthattheedgebetweennode15 1andnode16canhardlybeexecuted.asaresult seedcisnotagoodchoiceifweconsiderthepathconditions.thediscussion aboutseedcshowsthat onlyusingthecontrolflowinformationto calculate the distance is not enough data flow information should also be considered.
now that seed c has been excluded we need to select from seed a and seed b. at first glance seed b has a smaller distance .33vs2.
andthefuzzershouldpreferseedb.nonetheless if we check the execution trace we can see that the execution trace of seed a is actually closer to the target site on line and seedaisthebetteronetoselect.thereasonforseedatohavea larger distance is that it executes node node and node whichincreasestheoverallseeddistance.thecomparisonbetween seed a and b shows that the seed distance calculated with all the basic blocks can be biased and thus inaccurate.
4in harmonic means are used to balance the distance between multiple target sites.inwindranger wefocusonimprovingtheseeddistancecalculation soweuse a naive approach to calculate the basic block distance in this example for simplicity.our observations.
from the execution traces in figure we can see that for an execution trace that fails to reach the target sites it must deviate from the target sites at certain basic blocks.
forexample fortheexecutiontraceofseeda whenitreachesnode21 it deviates from the target by not entering the if condition.note that node is not a deviation point because both edges extended from this node can possibly reach a target site.
similarly for seed b the deviation point is node and for seed c the deviationpointisnode15 .inthispaper wecallsuchbasicblocks thedeviation basic blocks dbbs .
ourapproach.
ifwecalculatethedistancesbyaveragingonlythe dbbs the seed distances for a b and c are and respectively.
if we can further adjust the distance of seed c according to thehard to meet condition on line we can eventually prioritizeseed a the actual best seed here.
as we have demonstrated the importanceofthe dbbs theproblemnowbecomeshowtoidentify them.
although in this example all the dbbs happen to be the basicblockswiththeshortestdistance theidentificationofthemis not that straightforward.
suppose we have another seed d whose execution trace is .
for this seed even though node has a shorter distance than node the latter oneshould bethe dbbsincethe executiontraceactuallydeviates fromthetargetsitesatnode9 .thisisbecausethesuccessorofnode is node which is unreachable to the target sites not node12 3whichisreachable.alteringthebranchingonnode9 can affect whether the target sites can be reached or not.
on thecontrary no matter how we alter the branching at node the executiontracealwayshasachancetoreachatleastonetargetsite.
in windranger we give a clear definition of dbbs in the context of dgf and propose an approach to identify them on execution traces.
furthermore we propose an approach to leverage the dbbs informationaswellasdataflowinformationforbetterseeddistance calculation.
last but not least we integrate the improvements into different components of dgf to maximize the performance boost.
approach of windranger figure2showstheoverviewof windranger.windrangercontainstwomajorcomponents staticanalysisandfuzzing.thestatic analysis of windranger is used to identify the plausible candidates of the deviation basic blocks dbb s calculate their distance andinstrumentthisinformationintothetargetprogram.moreover like in cgf the instrumentation can also collect edge coverage toguide the grey box exploration of different program states.
in the fuzzing process before selecting a seed input from the seedqueue windrangerwillfirstdecidewhetheritshouldrunin the exploration mode or the exploitation mode x .
the switching isdecideddynamicallytobalancebetweenexplorationandexploitation and avoid getting stuck in local optimums.
in the exploration stage windrangerworkslikeanormalcoverage guidedgrey boxfuzzer.intheexploitationstage windrangerprioritizestheseeds with shorter distances via selecting them first and allocating more energy for mutating them y .
after a seed is selected from the queue and allocated a power schedule to determine how many newtestinputstobegeneratedfromit windrangerwillconduct mutation z augmented with the results of the data flow analysis authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhengjie du yuekang li yang liu and bing mao static int decompilejump int n swf action actions int maxn struct swf actionif sactif sactif null ... if ... if ... sactif struct swf actionif actions if !sactif return ... if ... if xxx hard condition getname actions bug function return if ... if xxx easy condition getname actions bug function ... source code control flow graph6 execution trace of seed a execution trace of seed b execution trace of seed c22 figure code snippet crafted from cve its corresponding cfg and execution traces of different seeds source codeedge coverage collection info deviation basic block and distance info compile instrumentinstrumented binarystatic analysis executionexecution trace analysisnew seedsseed queueexplore exploit switch energy scheduler power schedule selected seed mutation mutated inputscrashes static analysis fuzzing probing based taint analysis deviation basic block info effector mapdistance calculation figure the overall workflow of windranger .
the mutation helps to steer the fuzzer to pass the conditionals ofthedbbs.then afteramutatedinputisexecuted windranger will analyze the execution traces to decide whether to keep the input as a new seed and if the input is kept as a new seed windranger will also confirm the corresponding dbbs .
before addingtheseedtotheseedqueue windrangerwillcalculateits distance towards the target sites according to the dbbs and adjustthedistancevalueaccordingtothedataflowanalysisresults .
this marks the end of one iteration in the fuzzing loop.
in the following sections we will explain in detail the following questions how does windranger identify the dbbs for a seed usingstaticanddynamicanalyses .
howdoeswindranger perform the probing based taint analysis .
how does windranger calculate the seed distance and fine tune it with the taint analysis result .
how does windranger mutate the input with the taint analysis result .
how does windranger use thedbbs for seed prioritization .
how does windranger make decisions on switching between exploration and exploitation .
.
.
deviation basic blocks identification deviationbasicblock dbb isanimportantconceptinwindranger.
toidentifythe dbbsintheexecutiontraceofaseed windrangerfirst finds the potential dbbs in the program with static analysis.
then during fuzzing windranger pinpoints the dbbsi nt h e executiontracewithanalysesonexecutedbasicblocksandtheir relations with the potential dbbs.
static dbbcollection .
herewe providethe definitionof the potentialdbbs for a program and then discuss how windranger finds the potential dbbs with static analysis.
definition potential dbbs for a program .given a program p allitsbasicblocks allbb p andasetoftargetsites t thepotential dbbso fp denoted as p is a set of basic blocks p b allbb p isreachable b t c successors b whereisreachable x t is a function which returns true if the basic block xis reachable to at least one target site in ton the interprocedural control flow graph and returns false otherwise successors b is the set of all succeeding basic blocks of b. inplaintext definition1canbeexplainedas thepotential dbbs ofaprogramarethebasicblockswhichcanreachtoatleastone targetandatleastoneofitssucceedingbasicblocksisnotreachable to any target.
the rationale of this definition is double fold.
first a potential dbbmust be reachable to the target sites otherwise it cannothelptoreachthetargetsites andthereisnopointtoanalyze authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
windranger a directed greybox fuzzer driven by deviation basic blocks icse may pittsburgh pa usa thedeviationissueonthenon reachablebasicblocks.second at least one of the successors of a potential dbbis not reachable because ifallsuccessorsofabasicblockarereachabletothetarget executiontracescannotdeviatefromthetargetsonthisbasicblock.
in practice windranger constructs an interprocedural control flowgraph icfg ofthetargetprogramandcomputesthereachability for each basic block and the target sites base on the icfg.
a basic blockis considered reachableto a target siteif there existsa pathfromthebasicblocktothetargetsiteontheicfg.thenfor eachbasicblockthatisreachabletotargetsites ifatleastoneof itssuccessorisunreachabletoanytarget windrangeraddsthis basic block to the p .
dynamic dbbcollection .
here we define the dbbso fa ne x ec u tion trace andthen discuss how windranger identifies the dbbs dynamically.
definition dbbs for a seed .given the potential dbbs p and a seed s thedbbs of the execution trace of s denoted as s is a set of basic blocks s b s b p c reachablesucc b where s denotes all basic blocks in the execution trace of the seeds reachablesucc b isallsuccessorsofthebasicblock bwhich can reach to the target sites.
inplaintext definition2canbeexplainedas the dbbsofaseed are the basic blocks in its execution traces which are the potential dbbsoftheprogramandalloftheirreachablesuccessorsarenot executed by this seed.
the rationale of this definition is doublefold.
first a dbbof the execution trace by nature must be one ofthepotential dbbsoftheprogram.second allofthereachable successors ofa dbbshould notappear inthe executiontrace.
the reasonforthesecondpointisthatifoneofthereachablesuccessors of a basic block is in its execution trace the program is running towards instead of away from the targets on this basic block and thus the basic block is not an actual dbbfor this execution trace.
thepotential dbbsforaprogramareusedasintermediateresults to acquire the dbbs for seeds that are used for guiding the dgf.
thus in the following sections discussing the key steps of the fuzzing process if not specially mentioned the term dbbrefers to dbbfor seeds.
.
probing based taint analysis windranger uses probing based taint analysis similar to fairfuzz andgreyone tocollectdataflowinformationabout which bytes in the seed can influence the constraints for a given branch.
the data flow information is then stored in a hash map calledeffectormap wherethekeyisthebasicblockaddressfora branch constraint and the value is a set of indexes of the bytes on the seed which can influence the branch constraint.
the effector map is used for seed distance calculation .
and data sensitive mutation .
.
algorithm1showstheprocessofgeneratingtheeffectormap wherevalueof var s returnsthevalueofvariable varforaseed s. foraseed sanditsexecutiontrace s windrangerfirstextracts allthevariablesrelatedtobranchconstraintsontheexecutiontrace var .
then windranger mutates the seed byte by byte with a set of predefined mutation operators op .
with each mutated input windrangerchecksforeveryextractedvariablewhetherits valueremains unchangedafter themutation.
ifthe variablevalue is changed windranger updates the effector map to take note that the mutated position of seed scan affect the variable.
inthecurrentimplementationof windranger wepredefine three mutation operations for op bit flip.
modify the byte at the given position by flipping each bit of it.
insertion.
insert a randombyteatthegivenposition.
deletion.deletethebyteat the given position.
algorithm effector map inference input s the seed to be probed input op the predefined mutation operators input p prime the instrumented program output m the effector map of s initwithemptymap m s execute s p prime var extractconstraintvariables s for0 pos s do forop opdo s prime mutate s pos op forvar vardo ifvalueof var s valueof var s prime then m m pos .
seed distance calculation seeddistancecalculationisimportantin dgf.seedswithshorter distances are prioritized and allocated with more energy for mutation.
with the target basic blocks tb the distance of a seed sis ds s tb summationtext.
m s db m tb s wheredb m tb isthedistancebetween dbbmandthetargetbasic blocks s consist of the dbbs in the execution trace of seed s.i n other words forseed s equation3uses theaverage distanceof the dbbs in its execution trace as its distance to target basic blocks tb.
notethatstructureofequation3andthedefinitionof db m tb areboththesameasinaflgo andhawkeye exceptthatwe usethedbbsinsteadofallthebasicblockstocalculatethedistance.
however equation is still not accurate enough since only control flow information is used for the distance calculation.
we needtofurtherbalancethedistanceofeach dbbwiththedataflow information and the equation now becomes ds s tb summationtext.
m s db m tb s m s where s m is used to judge the degree of difficulty to penetrate the constraint on dbbmwith seed s. s m is defined as s m min max numofeffectivebytes s m wherenumofeffectivebytes s m indicatesthenumberofinput bytes that can affect the constraint variable s of maccording to authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhengjie du yuekang li yang liu and bing mao the effector map of s is a constant ratio which controls the granularity max is a constant which is the upper bound of s m .
the intuition here is that the more input bytes are influencing the constraint the more difficult it is for the fuzzer to penetrate the constraint.
we use the number of bytes affecting the constraints instead of branchdistancesmainlybecausebranchdistancescannotreflectthe difficulty of penetrating a branch if the input content goes through complex data transformations before reaching the branch condi tions.
for example suppose we have an ifcondition comparing themd5sumoftheinputcontentwithaconstantstring.assume the constant string is deadbeef and the md5sum of the input is headbeef .ifweusebranchdistancehere thecalculateddistanceis very short since the md5sum is only one byte away from matching the constant string.
however the fuzzer will need to modify the contentoftheentireinputtomakethemd5summatchtheconstant string.
therefore in this case using the number of bytes affecting the constraints is a better choice.
in addition we empirically found in the experiments that using the number of bytes affecting the constraints can yield good results .
.
data flow sensitive mutation with the information provided by the effector map windranger adopts data flow sensitive mutation to better penetrate branchconditions.givenaseedanditseffectormap windrangerfirst checksifitisrunningintheexploitationstageorexplorationstage.
if windranger is running in the exploitation stage it identifiesthe input bytes related to the constraint variables of the dbbsa s high priority bytes.
otherwise it identifies the input byte relatedto all the constraint variables as high priority bytes.
during the randommutation highprioritybytesaregivenalargerchanceofmutation.
in addition fora constraint variable andits related input bytes iftherelatedinputbytesareconsecutive windrangeralsochecks if the variable and the related input bytes share thesame value.
if they have the same value it is likely that the input bytes did notgothroughdatatransformations.inthiscase windrangerwilltry to replace the related input bytes with the value of the othercomparison operand of the constraint before applying random mutations.
.
seed prioritization similar to data flow sensitive mutation the seed prioritization also works differently during the exploitation stage and exploration stage.
during the exploitation stage windranger maintains a two levelpriorityqueue.first foreach dbb windrangerfinds a list of seeds that can cover this dbb.
then windranger sorts the list of every dbbin ascending order according to the distances of the seeds.
lastly windranger selects the first seed on everylist and puts them into the favored queue with higher priority and puts the rest of the seeds into the less favored queue.
whenselecting the next seed for mutation windranger has a higherchance to select from the favored queue.
during the exploration stage windrangerworkslikeanormalcgfandprioritizesthe seeds which can help to achieve better code coverage.as for power scheduling windranger follows the simulated annealing algorithm proposed in aflgo .
the only difference is the seed distance used for energy calculation.
.
dynamic switch between explore and exploit stage although the purpose of dgf is to reach the targets as fast as possible dgf still needs enough coverage exploration to avoid gettingstuckinlocaloptima.forexample aflgoadoptsauserdefinedtimebudgetinadvancetosplittheexplorationstageand exploitation stage.
however strong domain knowledge is required fortheuserstofindsuitabletimebudgetsfordifferentprograms.
toaddressthisissue weproposetodynamicallyswitchbetween theexploration andexploitation stageaccording tothe execution status ofdbbs.
specifically during fuzzing windranger maintains all existing dbbsasaglobalset denotedas f .intheexploitstage when alldbbsi n f have been exploited adequately windranger switchestotheexplorationstage.whethera dbbhasbeenexploited adequatelyisdecidedaccordingtohowmanytimesthe dbbhas been executed.
formally whether an input xcan hit a basic block b denoted as hit x b or not can be defined as hit x b braceleftbigg1 b x b x where x consist of all basic blocks in the execution trace of x. during fuzzing windranger records the number of how many times each basic block has been hit.
formally the hit count of a basic block bis numhit b summationdisplay.
x ihit x b whereiis the set of all inputs produced by fuzzing so far.
basedonthehitcount abasicblock bisconsideredasexploited adequately such that numhit b min b prime tnumhit b prime wheretisthesetofallbasicblockswindrangerhasencountered during fuzzing is a constant factor.
as forswitching fromthe explorationstage tothe exploitation stage if windrangerdiscoversnew dbbduringtheexploration stage it will switch to the exploitation stage.
note that the switching between stages always happens after windranger finishes mutatingaseedandbeforeitselectsanewseedtomutate asshown in figure .
implementation evaluation the implementation of windranger mainly consists of two parts static analyzer and dynamic fuzzer.
for the static analyzer we leverage the static analysis framework svf to construct icfg from llvm ir.
the static analyzer is implemented with about lines of c c code.
the dynamic fuzzer is implemented based on afl version .52b with about lines of c code.
withtheimplementedprototypeof windranger weconducted largescaleexperimentstoanswerthefollowingresearchquestions authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
windranger a directed greybox fuzzer driven by deviation basic blocks icse may pittsburgh pa usa rq1 how good is the ability of windranger for reaching predefined target sites?
rq2 howgoodistheperformanceof windrangerintermsof reproducing the target bugs?rq3 howdoeseverycomponentinwindrangeraffecttheoverall performance?rq4 can windranger help in real world bug hunting?
.
evaluation setup evaluationdatasets .weuseprogramsfromthefollowingdatasets as the evaluation benchmarks unibench isarecentdatasetproposedtoevaluatefuzzing works.
it contains real world programs of different categories categorized according to the input file type .
we selected 4targetsitesperprogramfromthisdatasettoevaluatethetimeto targets ttt of different techniques.
this set of benchmarks are used to answer rq1andrq3.
aflgo test suite is a set of programs with n day vulnerabilities used in the experiments of aflgo .
this test suite hasbeenusedinseveralresearchworks toevaluate dgf techniques.
this set of benchmarks are used to answer rq2.
fuzzertestsuite isasetoffuzzingbenchmarksproposed by google.
it contains several real world programs with known vulnerabilityinformationandisacommonbenchmarkusedin fuzzing research .
this set of benchmarks are used to answerrq2.
evaluated techniques .
since windranger is built on the top of afl we compare windranger with several afl based fuzzers to avoid the potential bias caused by the implementation of the techniques windranger is the tool proposed in this paper.
we empirically set the values of various configurable options such as in equation .
all the settings for the configurable options are available on our website .
aflgo is a state of the art dgf technique.
other directed grey box fuzzers e.g.
hawkeye fuzzguard etc.
are not publicly available by the time of writing this paper.
afl is a representative coverage guided grey box fuzzer whichisthebasisofmanyotherfuzzingtechniques .
fairfuzz is a derivation of afl.
we chose fairfuzz for comparisonbecausefairfuzzalsousestheprobingtechniqueto collect taint information to facilitate fuzzing.
note that although fairfuzzsharessimilaritieswithwindranger itstillrepresents advanced cgf techniques since its purpose is to maximize code coverage.
by comparing with the cgf techniques we can demonstrate thatwindrangercantrulybringdirectednesstogrey boxfuzzers.
by comparing with aflgo we can demonstrate the effectiveness of the strategies proposed in windranger.evaluation criteria.
we use two types of criteria to evaluate the performance of different techniques time to target ttt is used to measure the time used by the fuzzer to generate the first input which can hit the specifiedtargetsite.thiscriterionisusedtoevaluatethetechniqueson benchmarks without known bugs.
time to exposure tte isusedtomeasurethetimeusedbythe fuzzer to trigger a known bug.
this criterion is used to evaluate the techniques on benchmarks with known bugs.
experiments settings .
by default all the experiments were repeated10timeswithtimebudgetsof24hours exceptfortheexper imentsontheaflgotestsuite.wefollowedthesetupinthepaperof aflgowheretheexperimentswererepeated20timeswithtimebudgetsof8hours.forthestatisticaltest weusethemann whitney u test p value to measure the statistical significance of the experiment results.
moreover we also use the vargha delaney statistic a12 to measure the chance for one technique to perform better than another.
experiments environment .
we conducted the experiments on machines equipped with intel r xeon r gold cpu .30ghz with cores using ubuntu .
.
lts as the operating system.
during experiments each fuzzer instance runs in a docker container and binds to one cpu core.
.
target site reaching capability rq1 currently there is no standard dataset for evaluating ttt for dgf techniques.
although google fuzzer test suite contains three projects libjpeg turbo libpng .
.
andfreetype2 withgiventargetsitestotesttheabilityoffuzzerstocoverthese locations wefoundtheminsufficient.first theamountoftarget sitesissmall only5 .second usingafl basedfuzzers sometarget sites are easy to reach second with provided seeds or can notreach within the time budget hours without provided seeds because this test suite was initially designed for libfuzzer.
to get a dataset with abundant and valid target sites we use the unibenchdatasetwhichhasdiverseprograms.tocollectthetarget sites from the programs we use the following steps for each program first we run afl for 24h repeat times.
during eachrun we record the first reach time the time cost to generate thefirst seed to cover the basic block for each basic block then we calculate the average first reach time across the runs for each basic block based on the average first reach time for each basic block we use four scale time values hours hours hours 20hours toselectfourtargetsites.normally thereexists no basic block that happens to be reached exactly at the scale time values.underthiscircumstance we choosethetargetsiteswhose first reach time is close to the scale time value.
with the benchmark built on top of unifuzz we compare windrangerwiththebaselinestoevaluatehowmuchtimetheycost to reach the selected target sites.
we conducted the experiments onalltheprogramsinunibench theresultsforalltheprograms areonourwebsite .however duetothepagelimitation we select programs one program for a program type and showthe results in table .
on most of the target sites windrangeroutperformsallotherfuzzersandachievestheshortest ttt.overall intermofmeanttt windrangeroutperforms cgfs afl fairfuzz by56 and55 respectivelyandoutperforms dgf aflgo by .
besides windranger outperforms aflgo afl and fairfuzz by and respectively on all the programs.accordingtothevaluesofmean a12againstotherfuzzers .
with afl and fairfuzz .
with aflgo we have enough authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhengjie du yuekang li yang liu and bing mao table time to target results on programs from unibench.
for each target site the statistically significant p value .
values of a12is highlighted in bold the shortest mean ttt is marked with an asterisk the detailed experiment results for all the programs are on our website prog targetsafl aflgo fairfuzz windranger runs ttt factor a12runs ttt factor a12runs ttt factor a12runs ttt imginfojpc cs.c 1h28m .
.
1h1m .
.
1h17m .
.
36m17s bmp dec.c 2h20m .
.
1h40m .
.
2h12m .
.
1h2m jas image.c 6h30m .
.
7h42m .
.
5h51m .
.
5h8m jas stream.h 16h33m .
.
15h24m .
.
18h0m .
.
11h37m lamegain analysis.c 1h10m .
.
51m35s .
.
1h17m .
.
22m40s bitstream.c 5h16m .
.
3h59m .
.
5h39m .
.
4h8m get audio.c 14h40m .
.
11h46m .
.
13h1m .
.
8h51m mpglib interface.c 19h37m .
.
15h53m .
.
18h13m .
.
11h57m mp42aacap4bytestream.cpp 4h43m .
.
4h12m .
.
5h25m .
.
3h11m ap4lish.h 9h38m .
.
7h1m .
.
9h14m .
.
7h11m ap4cttsatom.cpp 15h48m .
.
14h31m .
.
15h22m .
.
10h47m ap4elstatom.cpp 20h10m .
.
18h38m .
.
21h43m .
.
17h14m mujsjsrun.c 5h39m .
.
5h11m .
.
7h13m .
.
3h50m jsdump.c 10h12m .
.
4h59m .
.
7h13m .
.
4h21m jsdump.c 14h1m .
.
9h23m .
.
13h11m .
.
7h33m jsvalue.c 19h10m .
.
17h44m .
.
18h55m .
.
14h58m objdumpobjdump.c 5h6m .
.
4h38m .
.
6h13m .
.
3h55m section.c 10h8m .
.
11h29m .
.
11h50m .
.
8h24m objdump.c 15h31m .
.
12h54m .
.
16h31m .
.
13h46m dwarf2.c 20h58m .
.
19h59m .
.
19h19m .
.
17h49m tcpdumpprint ppp.c 5h2m .
.
4h35m .
.
5h29m .
.
3h20m extract.h 9h53m .
.
7h34m .
.
8h24m .
.
5h48m print l2tp.c 15h4m .
.
14h27m .
.
15h21m .
.
12h33m print decnet.c 20h23m .
.
22h37m .
.
19h53m .
.
21h39m tttinc mean a12 .
.
.
ttt inc all programs confidencetoconcludethatwindrangerhasbettercapabilityto reach the given target sites than other tools.
.
bug reproducing capability rq2 reproducingbugs crashesisanimportantapplicationofdirected fuzzing.
here we study the bug reproducing capability of windrangerbycomparingitwiththebaselinesusingthettecriterion.
.
.
aflgo test suite.
inthepaper andwebsite of aflgo therearesomeprogramswithknownvulnerabilitiesbeusedtoevaluatethedirectness ofdgf.hence wecomparethe performanceof windrangerontheseprogramsdirectlywithothertools.specially gun binutils .
and libming .
.
with cves are used in this experiment.
we follow the same experiment settings in each instance conducted times with the time budget set to hours use an empty file as initial seed.
thistest suiteconsistsof programsfrom gunbinutils2.
andlibming0.
.
with9cves.however inthepreliminary experiments wefoundthatplentyofcrashesarisewhenfuzzing binutils .
but only cves among them were used in the experimentsof aflgo.itrequirescumbersomemanualeffortstoclassify these crashes to find the corresponding cves.
to minimize thedeviationcausedbymanuallabelingandimprovethesoundness of the results we conduct experiments on binutil .
in which all thecvesusedintheexperimenthavebeenpatched.foreachcve we reverse its related patch es to ensure only this cve is exposed in the experiments.
table2showstheresultsfromwhichwecanobservethat for cves which are difficult to expose tte hour windranger significantly outperforms other tools by .
to .
faster to expose them.
for cve and cve windranger getthemosthittingrounds 6and8rounds .
the valueof a12 shows that windranger steadily achieves better performance especially for cve and cve of which a12is equalorgreaterthan0.75againstothertools.
forcve and cve windranger do not exhibit better performancethanaflgo.however thesecvesareeasytoexposewhich only need few minutes.
on these cves the randomness of fuzzing matters for tte.
.
.
fuzzer test suite.
compared to the bugs in aflgo test suite thebugsingooglefuzzertestsuiterequirenoclassificationsince eachprogramonlycontainsonebug.theexperimentresultsare shown in table .
the results in table demonstrate that by settingvulnerabilitieslocationsastargetsites dgfs windranger andaflgo canachievebetterperformanceonexposingrelative crashes than cgfs afl and fairfuzz .
among the vulnerabilities windrangergainsbetter tteon .overall windranger achieves a mean speed up in tte of against afl and againstfairfuzz.comparedtoaflgo the30 speedupshows thatwindrangerownsbetterdirectednesscapability.moreover authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
windranger a directed greybox fuzzer driven by deviation basic blocks icse may pittsburgh pa usa table crash exposure results on aflgo test suite.
for each cve the statistically significant p value .
values of a12ishighlightedinbold theshortestmeantteismarked with an asterisk cve id tool runs tte factor a12 binutils2016 4487windranger 1m58s afl 3m41s .
.
aflgo 3m18s .
.
fairfuzz 4m15s .
.
4488windranger 10m25s afl 16m39s .
.
aflgo 13m15s .
.
fairfuzz 15m57s .
.
4489windranger 5m7s afl 6m38s .
.
aflgo 4m22s .
.
fairfuzz 5m19s .
.
4490windranger 2m5s afl 1m21s .
.
aflgo 1m29s .
.
fairfuzz 2m48s .
.
4491windranger 5h26m afl 6h37m .
.
aflgo 7h4m .
.
fairfuzz 7h28m .
.
4492windranger 8m32s afl 14m34s .
.
aflgo 9m39s .
.
fairfuzz 15m4s .
.
6131windranger 4h58m afl 7h17m .
.
aflgo 6h5m .
.
fairfuzz 6h57m .
.
libming2018 8807windranger 1h32m afl 2h16m .
.
aflgo 2h41m .
.
fairfuzz 2h49m .
.
8962windranger 1h38m afl 2h22m .
.
aflgo 3h36m .
.
fairfuzz 2h50m .
.
three vulnerabilities only take a few minutes or seconds to trigger note that the two vulnerabilities on which windranger does not achieve the best results both belong to these three vulnerabilities .
normally these easy to trigger crashes can hardly benefit from dgf andifweonlyconsiderthevulnerabilitieswhose tteexceed hour windranger can achieve larger performance gain with speed up of against afl against aflgo and against fairfuzz.
.
impact of different components rq3 toinvestigatetheimpactofdifferentcomponentsinwindranger wedisableeachcomponentindividuallyandconductexperiments on the same targets selected from unibench as in .
.
table shows the results.
we can observe that disabling each componentcausesanincrease onttt whichmeanseach component has a significant impact on the performance of win dranger.
among the four components the data flow sensitivemutation component contributes the most with a speed up on tte.
by disabling other components distance calculation seedprioritization and explore exploit stage switch we also see an increaseintteof12 and15 respectively.notethatallthesecomponentsarerelatedtotheconceptof dbb whichdemonstrates the usefulness of dbbin dgf.
.
new vulnerability rq4 figure3 thetimecosttoexposethenewvulnerabilityin10runs tochecktheif windrangercanbeusedforhuntingpreviously unknownbugs wegavetheprototypeof windrangertoasecurity expert5.
this security expert tried windranger on an interesting target ffmpeg which is a popular multimedia library and is well fuzzed .itisheavilyfuzzedbyoss fuzzwithclustersof machinesandusingconventionalfuzzingstrategiescanhardlyyield any crash bug.
therefore the security expert conducted manual codereviewtoidentifysuspiciouslocationsbeforefuzzing.tobe specific she selected assertions as the interesting locations to test details about the assertion locations can be found on our web site .
then shetriedtobuildagoodenoughseed thoughcannotreach anyofthetargets andfedtheinterestinglocationsastargetsites towindrangertoperformdirectedfuzzing.eventually shefound one assertion fail among assertions on the development branch.
note that on the release branch all assertions will be removedand this assertion fail can possibly lead to security issues.
theassertion fail has been confirmed as a vulnerability and fixed by thedevelopers.
moreover itreceived acve id cve .
thenwetooktheinitialseedtogetherwiththevulnerableversion of ffmpeg and used the vulnerability as the target site to comparewindrangerwithaflgoonexposingthenewvulnerability.
figure shows the results.
the horizontal axis indicatesthe time cost to expose tte the vulnerability.
the boxes in thegraphindicate thette resultsof correspondingtools in10 runs.
fromfigure3 wecanobservethatwindrangercostslesstime to expose the vulnerability in almost every run.
specifically themedian tte of windranger 8220s is .
smaller than the meadian tte of aflgo 13440s .
threats to validity thefirstinternalthreatcomesfromtheaccuracyofthereachability analysis which directly affects the identification of dbbs.
the currentimplementationof windrangerusesthesvfframework toobtaintheicfgtoanalyzethereachabilityofthebasicblocks.
the icfg can be erroneous due to some pitfalls such as inaccurate 5the security expert works in a security company and is not involved in the development of our tool.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhengjie du yuekang li yang liu and bing mao table time for exposing the known crashes in google fuzzer test suite.
for each vulnerability the statistically significant p value .
values of a12is highlighted in bold the shortest mean tte is marked with an asterisk.
bo buffer overflow uaf use after free ml memory leak ae assertion error prog typeafl aflgo fairfuzz windranger tte factor a12 tte factor a12 tte factor a12 tte boringssl uaf 1h47m .
.861h21m .
.821h55m .
.
52m36s guetzli ae 6h13m .
.
5h58m .
.
6h30m .
.
3h40m libarchive bo 5h33m .
.794h12m .
.
5h21m .
.
3h29m libssh ml 4m41s .
.
5m12s .
.
5m46s .
.
5m38s libxml2 bo 4h41m .
.783h54m .
.675h16m .
.
2h59m pcre2 uaf 6h12m .
.815h52m .
.748h3m .
.
3h23m pcre2 bo 9h26m .
.718h38m .
.
9h6m .
.
6h39m re2 bo 7h2m .
.678h29m .
.767h39m .
.
5h49m woff2 bo 2h51m .
.871h55m .
.
2h48m .
.
1h13m c ares bo 54s .
.
53s .
.
1m6s .
.
58s openssl .
.1f bo 5m38s .
.
5m31s .
.
6m1s .
.
5m6s tte inc tte 1h inc table ttt results of disabling each improved component in windranger.
short names for components dc distance calculation sp seed prioritization m data flow sensitive mutation ees explore exploit stage switch prog targetsdefault no dc no sp no m no ees runs tttruns tttruns tttruns tttruns ttt imginfojpc cs.c 36m17s 43m57s 50m18s 58m44s 41m20s bmp dec.c 1h2m 1h21m 1h36m 1h19m 1h30m jas image.c 5h8m 5h48m 5h22m 5h32m 5h29m jas stream.h 11h37m 12h48m 13h6m 14h17m 13h8m lamegain analysis.c 22m40s 33m18s 43m15s 53m14s 40m54s bitstream.c 4h8m 4h27m 4h43m 4h19m 3h54m get audio.c 8h51m 9h43m 10h18m 10h36m 10h9m mpglib interface.c 11h57m 13h5m 12h44m 14h39m 14h7m mp42aacap4bytestream.cpp 3h11m 3h29m 3h41m 4h3m 3h57m ap4lish.h 7h11m 7h33m 7h5m 7h15m 6h55m ap4cttsatom.cpp 10h47m 12h7m 13h10m 13h43m 13h19m ap4elstatom.cpp 17h14m 17h51m 17h36m 18h11m 18h28m mujsjsrun.c 3h50m 4h46m 4h24m 4h53m 4h36m jsdump.c 4h21m 4h52m 5h18m 5h33m 5h35m jsdump.c 7h33m 9h16m 8h49m 9h17m 8h20m jsvalue.c 14h58m 16h47m 15h45m 17h21m 16h57m objdumpobjdump.c 3h55m 4h29m 4h11m 4h53m 4h29m section.c 8h24m 9h10m 8h54m 8h49m 8h33m objdump.c 13h46m 13h45m 12h47m 13h21m 13h6m dwarf2.c 17h49m 18h28m 18h42m 18h55m 18h11m tcpdumpprint ppp.c 3h20m 3h38m 4h13m 4h5m 3h30m extract.h 5h48m 6h15m 7h13m 6h31m 7h21m print l2tp.c 12h33m 12h42m 13h40m 12h54m 13h16m print decnet.c 21h30m 19h44m 21h34m 21h14m 20h52m tttinc .
pointer analysis.
after analyzing the experiment results we empirically find that the quality of the current reachability analysis is enoughtoyieldgoodperformance.thus weleavetheimprovement of the reachability analysis as future work.
the second internal threat comes from the configurable options in windranger such as the variable for tuning the seed distances andthethresholdfortheexploration exploitationswitching.we empirically choose the variable values for experiments and the currentexperimentresultsarepromising.webelievefine tuningtheconfigurableoptionscanfurtherimprovetheexperimentresults butitisnotthekeytechniquetodiscuss.thus weleavefine tuning the configurable options as future work.
the external threats mainly come from the experiment setup.
tool evaluation results should always be taken with a grain of salt.
to mitigate the randomness in the experiments we follow thesuggestions in to repeat the experiments for or runs and applystatisticaltestsontheresults.tomitigatetheinfluencesof different implementations we choose the techniques implemented authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
windranger a directed greybox fuzzer driven by deviation basic blocks icse may pittsburgh pa usa basedonaflasbaselinessincewindrangerisalsobuiltontop of afl.
furthermore we also conduct fine grained crash triage for the tte experiments to acquire more accurate results.
related work instead ofdiscussing all therelated works we focuson the most relatedones.ourworkismainlyrelatedtothreetopics directed symbolicexecution directedgrey boxfuzzingandcoverage guided grey box fuzzing.
directed symbolic execution.
directed symbolic execution dse isatechniquewhichreliesonsymbolicexecutiontoreach thetargetsites.severalworkshavebeenproposedtodeploydsein diversetasks suchaspatchtesting totestcriticalsystem calls to validate static analysis reports .
dse leverages synergisticprograminformationtogaindirectness comparedwith generalsymbolicexecutiontechniqueslikeklee dsecaneffectivelytestdesiredpartsofput.however dseisnoteffectiveon real world programs as symbolic execution techniques suffer from problemslikepath explosion .comparetodse oursolution windranger belongs to directed grey box fuzzing dgf which is only rely on lightweight program analysis and is more effective on real world programs as discussed in .
directedgrey boxfuzzing .directedgrey boxfuzzing dgf aims to bring directedness to grey box fuzzing.
aflgo i st h e first dgf.
to gain the directness ability the authors of aflgo proposedmethodstocalculatethedistancebetweenaseedtraceand target sites this distance is used in the power schedule to decide the energy of the seed.
hawkeye improves aflgo with trace augmented power schedule seed prioritization and adaptive mutation.aflgoandhawkeyebothconsiderallbasicblocksintheseeddistancecalculation.differentfromthis windrangerfocusesonimportantbasicblockswhichhinderinputsreachingtargetsitestoimprove theefficiencyofdgf.besides fuzzguard leverages deeplearningtofilteroutinputswhichareunreachabletotarget sitesbeforefeedingthemtodgf .however w indrangerimproves the efficiency of dgf and is orthogonal to fuzzguard.
some works deployed dgf on different kinds of target sites.
leopard usesprogramsmetricstoidentifythevulnerablecode intheprogramandsetthemastargetsites.parmesan identifies the program locations instrumented by sanitizers like asan and uses these locations as target sites.
besides parmesan calculatesdistancebasedondynamicallyconstructedcfg.cafl leveragesinformationoforderedtargetsitesanddataconditions to boost up the dgf s capability to expose targeted crashes.
these works can gain better performance with more efficient dgf which windranger aims at.
coverage guided grey box fuzzing .
coverage guided greyboxfuzzing cgf aimstoguidefuzzingtocovermorecode.afl isaclassiccgfthatemployscoverageasfeedbacktoguideseeds evolution.
to increase the coverage in cgf a research direction is tohelp cgf solvethe conditionconstraints in theput.
hybrid fuzzing combines cgf and symbolic execution to enhance the constraint solving ability in cgf.
several other works adopt lightweightmethodstohelpwithconstraintsolving.steelix useslight weightstaticanalysisandbinaryinstrumentationtogain thecomparisonprogressinformationwhichhelpscgftoexplorepaths protected by magic bytes comparisons.
angora uses a novel technique called gradient descent based input search to solvingconstraintswithoutsymbolicexecution.greyone adopts fuzzing driven inference to conduct taint and uses data flow features to guide the evolution of fuzzing.
fairfuzz identifies and masks the bytes which influence producing inputs covering rarebranches.besidestechniquesforpenetratingbranches thereare alsosomeothertechniquesfocusingonimprovingtheseedschedul ingprocess detectingspecifictypesofbugs and automatic fuzz harness generation .
although the aimof windrangerisreachingtargetsitesefficientlyinsteadof increasing code coverage windranger can benefit from some of thetechniquesusedincgf e.g.
theconstraintsolvingtechniques .
conclusion in this paper we propose the concept of deviation basic block in the context of directed grey box fuzzing.
we propose an approach called windranger to effectively identify and use the deviationbasic blocks to facilitate directed grey box fuzzing.
we conduct 400cpuhoursofexperimentstoevaluatewindranger.the evaluation results show that windranger can outperform the state of the art directed grey box fuzzer by reaching the targetsites faster and exposing the vulnerabilities faster.
last but not least windranger shows practical usefulness by helping a security expert to find a day vulnerability in an extensively fuzzed popular media library.