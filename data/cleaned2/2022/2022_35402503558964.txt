metadata based retrieval for resolution recommendation in aiops harshit kumar harshitk in.ibm.com ibm research indiaruchi mahindru rmahindr in.ibm.com ibm t.j. watson research center usadebanjana kar debanjana.kar1 ibm.com ibm research india abstract for a cloud service provider the goal is to proactively identify signals that can help reduce outages and or reduce the mean timeto detect and mean time to resolve.
after an incident is reported the site reliability engineers diagnose the fault and search for a resolution by formulating a textual query to find similar historical incidents this approach is called text based retrieval.
however it has been observed that the formulated queries are inadequate and short.
an alternate approach presented in this paper integrates information spread across heterogeneous and siloed datasets as a ready to use knowledge base for metadata based resolution retrieval.
additionally it exploits historical problem context for building metadata prediction models which are used at run time for automatically formulating queries from log anomalies detected by the log anomaly detection module.
the query thus formed is run against the metadata based index unlike the text based index in text retrieval resulting in superior performance in terms of relevancy of the resolution documents retrieved.
through experiments on web application server applications deployed on the cloud we show the efficacy of metadata based retrieval which not only returns targeted results as compared to text based retrieval but also the relevant resolution document appear amongst the top positions for of the queries.
ccs concepts information systems information integration query reformulation software and its engineering cloud computing .
keywords incident remediation metadata based retrieval cloud aiops acm reference format harshit kumar ruchi mahindru and debanjana kar.
.
metadata based retrieval for resolution recommendation in aiops.
in proceedings of the 30th acm joint european software engineering conference and symposium on the foundations of software engineering esec fse november singapore singapore.
acm new york ny usa pages.
https permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page.
copyrights for components of this work owned by others than acm must be honored.
abstracting with credit is permitted.
to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission and or a fee.
request permissions from permissions acm.org.
esec fse november singapore singapore association for computing machinery.
acm isbn .
.
.
.
introduction while cloud computing offers it information technology infrastructure at a low cost it comes with the complexity of having loosely coupled micro services to enable agile development dynamic deployment and fast continuous improvement .
therefore the role of operators it operation engineers or site reliability engineers sres towards availability latency performance efficiency change management monitoring emerging response and capacity planning has become even more challenging due to the a complexity and scale of the software and hardware system and b the vast amount of machine generated data .
even the most experienced sre teams face challenges especially with the rapidly proliferating data generated by hybrid cloud and cloud native technologies.
artificial intelligence for it operations aiops empowers sres by providing a platform infused with ai that supports development and operations practices in an open hybrid cloud environment to enable free collaboration.
the aiops platform primarily includes mining a voluminous amount of disparate data sources to extract events logs metrics alerts incidents anomalies correlate and group them by inferring patterns to localize the fault and use these to find similar historical incidents for action recommendation.
figure illustrates the components in a typical aiops pipeline for applications deployed on cloud log aggregation normalizes poorly structured log data into streams of structured event objects event detection includes log anomaly detection and metric anomaly detection from log and metric data event correlation groups different events such as alerts and anomalies into homogeneous related clusters fault localization localizes a fault to a particular service or component of the application and finally incident similarity allows an sre to formulate a query to retrieve resolutions using a text based retrieval.
there are several key challenges that require attention as discussed below.
cloud service providers manage data centers that serve a wide variety of applications across a large number of customers while keeping the cost low with minimum downtime.
however to scale the operations they are utilizing general practitioners and investing in ai based solutions such as aiops.
sres may be general practitioners with expertise in certain domains hence they may not be highly efficient in performing the problem diagnosis and remediation for applications where they lack expertise.
also sres work with complex systems generating volumes of logs and metrics data which may be hard to infer for a non domain expert.
as an example consider a sample anomalous log line dmxz0302e raexception occurred.
error code is rmfail .
exception is .
.
.
ra exception .
.
.
invalid operation connection is closed.
errorcode 4x8 state esec fse november singapore singapore harshit kumar ruchi mahindru and debanjana kar figure flow of a typical aiops pipeline for applications deployed in cloud where dmxz0302e is the messagecode and raexception occurred.
error code is rmfail.
exception is .
.
.
ra exception .
.
.
is the messagestring .
to comprehend the above logline can be a little challenging for a non expert and a lot more difficult to identify and resolve the underlying problem.
the above mentioned challenges lead to the following inefficiencies a inadequate query formulation for resolution retrieval in order to find the resolution to a problem sres formulate a query.
however without a thorough understanding of the problem domain it may be highly ineffective and a challenging task for them to create a viable query .
therefore this may lead to a highly inefficient trial and error based problem diagnosis and resolution retrieval.
b incorrect problem routing one of the key pain points that sres report is related to problems getting bounced around from one team to another due to insufficient details and misunderstanding of the problem .
in turn this may lead to increased mean time to resolve mttr and business service level objective slo violations.
c ad hoc problem diagnosis and resolution application lack of problem understanding leads to incomplete and incorrect query formulation.
therefore the resolutions retrieved would be irrelevant if not incorrect.
hence leading to adhoc problem diagnosis and remediation.
it operations data such as tickets resolution articles log data resolution taxonomy etc.
are distributed heterogeneous and available in silos.
data in silos is incomplete because it cannot be used effectively for example for resolution retrieval.
traditionally sres would switch between a variety of tools for problem diagnosis and resolution.
for example they would use alog aggregator to manually identify anomalous log lines which are grouped together for fault isolation followed by the identification of relevant cues such as message code s in each group.
a query is formulated from the cues which is run against historical incidents to return resolution articles that can help an sre to resolve the fault.
the aforementioned steps require an sre to switch between multiple tools and do manual processing which is highly inefficient and time consuming.
the aforementioned challenges may lead to lower productivity of sres lack of confidence in problem solving and longer mttr and violated slas service level agreements in turn leading to lower customer satisfaction.
to address the above challenges we propose to build an augmented metadata based knowledge base kb which will allow a faster matching of the identified fault and recommend relevant resolution articles for fault remediation.
the key attributes of the augmented metadata based kb are extracted from disparate data sources such as tickets resolution taxonomy product catalog and log data.
in addition we propose an automatedquery formulation mechanism from detected log anomaly events and predicted context models are proposed to predict values of contextual attributes to retrieve targeted and relevant resolution documents from the augmented kb.
the key contributions of this paper are augmented metadata based kb creation and building metadata prediction models metadata prediction for problem explainability and query formulation metadata based retrieval mbr for resolution recommendation an industrial case study showcasing an insurance application deployed on our organization cloud with aiops integration for anomaly detection feeding into the proposed mbr based resolution recommendation.
one of the key contributions that must be emphasized is that via mbr for of the queries the most relevant document appears in the topranked position.
and for of the queries the correct result is within the top .
this is a key element to be noted because it may lead to a significant improvement in sres productivity and mttr as the resolution recommendations are pre populated along with explanations of the auto detected log anomalies.
the rest of the paper is structured as follows.
section describes our proposed approach.
section describes the datasets experimental settings discussion of quantitative and qualitative results and a case study in section .
section includes a brief summary of related work with respect to text based retrieval and metadata based retrieval.
finally section concludes the paper.
approach in order to address the above limitations this paper contributes a semi supervised approach for resolution retrieval refer figure described as follows figure metadata based retrieval augmented dataset creation the augmented dataset with metadata attributes is created at build time.
in addition to bringing structure to the heterogeneous unstructured data 1380metadata based retrieval for resolution recommendation in aiops esec fse november singapore singapore such as historical tickets support documents etc.
this step helps build an integrated ready to use kb.
such an integrated dataset exploits and combines information nuggets spread across multiple siloed datasets leading to comprehensive and richer resolution recommendations.
indexing the augmented kb section .
enables metadata based retrieval mbr and metadata prediction model training.
metadata prediction for problem explainability and query formulation sres typically receive large volumes of historical data in the form of tickets that are created due to problems issues reported by clients seeking support for problem diagnosis of their it operational issues.
the historical ticket data typically contains problem categories annotated by sres as a way to summarize the problem in simpler terms similar to tags used in forums .
such data is a rich source of information that can be exploited in various ways one of them being problem explanation.
as mentioned earlier some of the log message may be difficult to absorb for non experts but annotations database connection as category andj2c jdbc driver assub category may lead to an easier comprehension.
such annotations help provide the context of the problem to the sre for example that the problem is related to database connection due to driver issue.
the proposed system exploits the historical annotations associated with anomalous loglines that were referenced in the ticket data to train the metadata prediction models.
at run time given an auto detected log anomaly via anomaly detection component shown in figure .
the first step is to predict the metadata i.e.
problem category and subcategory using the metadata prediction model as shown in figure and described in section .
.
next it uses the predicted metadata and the detected log anomaly to automatically formulate a query without sre intervention in turn addressing the inefficiency of inadequate query formulation for resolution retrieval discussed earlier in section .
metadata based retrieval mbr finally perform an mbr section .
on the metadata based augmented kb using the automatically formulated query to retrieve targeted and relevant resolutions for solving the underlying problem.
the results are presented with the explanation of the anomalous logline using contextual information such as category andsub category to describe the problem in simpler terms.
presenting explainable results containing resolutions boosts sres confidence gaining their trust and thereby improving sres efficiency with a more systematic and comprehensive problem diagnosis.
.
metadata extraction and indexing we leverage information spread across four different siloed datasets described in table for an application server product.
we explain below why and how these datasets are combined together to prepare an augmented dataset that is indexed for mbr.
we begin with a discussion of the challenges in using these datasets.
firstly as the datasets exist in silos each contains information nuggets that if integrated provide a more holistic and contextual view of the events to aid in the improvement sres productivity for faster and moretable sample it datasets and the corresponding metadata dataset metadata ticket data ticketnumber reportedtime productname productversion severity ticket ticketbody resolution taxonomyticketdescription resolutiontitle resolutionurl category sub category product contentmessagecode alphanumeric identifier messagestring resolutiondescription resolutionurl log data timestamp logline contains loglevel messagetype messagecode effective resolution derivation.
secondly as log lines could run into hundreds of millions per system application component associating anomalous log lines with historical ticket data to retrace the actual time when the event happened is non trivial.
thirdly resolution taxonomy is maintained by subject matter experts smes and hence the same resolution may be categorized in different category andsub category metadata based on their experience and understanding of an event leading to data ambiguities.
when a new ticket is created in support it is manually annotated by the smes with the problem category andsub category metadata hence during run time when a log anomaly is detected its problem category and sub category needs to be predicted.
therefore machine learning models are exploited to predict such metadata which is explained in sub section .
.
the algorithm below provides steps to prepare an augmented dataset for metadata prediction model training and index creation for resolution retrieval refer to figure .
for each event from ticket data andresolution taxonomy extract the metadata see table for the corresponding ticketnumber where resolutionurl is a sme identified resolution related to the event reported.
for each event check if the corresponding logs for the affected entity are available.
a use the reportedtime from step to identify the time window within the delta of the reportedtime to extract logs note this may still be thousands of logline s .
b run the extracted log lines through the log anomaly detection lad model to identify anomalous log lines output may be a couple of anomalous log lines .
extract logline s from the ticketbody which contains a full transcript of interactions between the client and smes including a small number of curated erroneous log lines.
combine category sub category from step and logline s from step b and step as training data for metadata prediction model described in sub section .
.
use custom defined rules to extract metadata from the dataset product content.
additionally define a new attribute isactionable which is set to yif an actionable keyword semantic role labeling is present in resolutiondescription else set it to n. combine data extracted in step step b step and step using messagecode as the common attribute.
we observed that resolutionurl andmessagecode exhibit manyto many relationship.
therefore we compute the resolutionspecificityscore rss that indicates the confidence on the resolutionurl for each messagecode .
assume that the frequency 1381esec fse november singapore singapore harshit kumar ruchi mahindru and debanjana kar ofresolutionurl uiformessagecode j mcj iscij then rssis calculated as follows rss cij jcj log mc mcj mc urli mcj wheremcis a set of all messagecode s. the first term cij jcj captures the importance of the resolutionurl uiformessagecode j mcj .
the second term mc mcj mc urli mcj captures the importance of the messagecode j mcj for the resolutionurl ui.
figure metadata based augmented kb creation .
metadata selection and prediction sub section .
.
explains how to identify metadata attribute s that are relevant for the task of resolution retrieval.
some of these attributes may be readily available at run time as part of the input log anomaly for example operating system version etc.
while others such as problem category andsub category which are traditionally manually annotated by the sres are not readily available at run time.
hence it is prudent to build prediction models from the historical annotated data as explained in sub section .
.
and .
.
.
.
.
metadata selection.
for a given task in this case retrieval of resolution document selecting metadata attributes from a given set of attributes in the metadata based augmented kb is essential for effective retrieval.
the retrieval of the resolution document will be based on the match of metadata attribute values and the number of such metadata attributes should be kept to a minimum otherwise the query formulation will be very complex.
for a faster convergence the system needs to find metadata attributes along which the system has minimum entropy impurity or randomness in attribute values .
entropy information gain and correlation among the metadata attributes are calculated to identify useful contextual features for resolution retrieval.
let ube a set of nmetadata attributes u u1 u2 ... un where each metadata attributeuifor itsmunique values has an associated distribution vi c1 vi c2 ... vim cm ci s being the frequency .
then theentropyaifor a metadata attribute uiis calculated as follows p ci j ci j m k 1ci k e ai m j 1p ci j log2p ci j based on the application server dataset that we have used for our experimentation the entropy of sample metadata attributes severity category sub category resolutiontitle and resolutionurl are .
.
.
.334and7.
respectively.
the range of entropy values is from to log2m wheremis the number of distinct values in the metadata attribute distribution when m for binary class the maximum value of entropy is .
to identify which metadata attribute is relevant for the task of resolution retrieval we compute its correlation with the resolutionurl .
while severity reports the lowest entropy its low correlation with resolutionurl renders it as an attribute of less importance.
low entropy attributes such as category andsub category report a high correlation with resolutionurl and thus constitute strong candidates for contextual metadata prediction.
the following sub sections explain how to build prediction models for category andsub category metadata attributes.
.
.
category prediction.
using output of step of data augmentation algorithm described in sec.
.
we train stochastic gradient descent sgd 1based supervised classifiers to predict problem category andsub category .
while we report a good performance on different sample test sets as discussed in section .
we observed a sharp increase of .
in category prediction accuracy when the three most probable category predictions are used as opposed to the most probable predicted category.
this means that although the most probable predicted category may not match the ground truth however one of the top predicted categories matches the ground truth.
this warranted a formulation of a filtering strategy to improve the category prediction accuracy discussed next.
filtering strategy .
from the training dataset a local frequency table lft is constructed consisting of messagecode extracted from logline category along with frequency.
the lft captures how often a particular combination of messagecode and category were seen in the training corpus.
a two step filtering process is applied to select a predicted category from the top for each messagecode m letpibe a set of top predicted categories andqmbe a set of observed categories obtained from thelft .
the intersection of piandqmretains all those categories that were also observed in the training data fm pi qm m lft where fmis a set of retained categories found in both piandqm intuition behind this step is that among the predicted categories pi those that were unobserved in the corpus for a particular messagecode mare most likely incorrect predictions.
letpribe a sorted set of prediction probability scores corresponding to predicted categories in set pi.
the difference in probability scores of the top two predicted categories below a sgdclassifier.html 1382metadata based retrieval for resolution recommendation in aiops esec fse november singapore singapore certain threshold indicates that category prediction model is not confident about the predicted category with a lower prediction score in such a scenario lft guides the category prediction model to select the category fmwith the highest frequency as the predicted category difi pa pb pa pb pri b a b a len pri sp sorted difi psi pri qm c pi sp t psi pri sp t where psiis a new probability score for each pi calculated by taking a dot product of category probability score and its frequency count obtained from lft.
if the difference in difi a pre defined threshold tthen choose the category with the highest prediction probability implying that the model is confident about its prediction.
otherwise choose the category with the highest frequency count.
we empirically observed t .
as a good discriminator to gauge the confidence of category prediction model values greater than .
is a stricter threshold which resulted in comparatively more false negatives and values less than .
increased the number of false positives thus degrading the overall performance of category prediction.
.
.
sub category prediction.
the metadata attribute sub category depends on the category forming a two level taxonomy.
figure illustrates the three approaches to predict the sub category for an input logline .
figure approaches for sub category prediction independent given an input logline both category andsubcategory classifiers are trained independently to predict their respective classes.
conditional asub category classifier model is trained which is conditioned upon the input logline and the predicted category obtained from the trained category classifier.
hierarchical logline and predicted category are input to predict the sub category classes that are related to category based on the two level taxonomy relationship.
this leads to one sub category model per category each equipped to predict a set ofsub category classes within the predicted category leading to a more precise and faster classification.
for instance when using a conditional approach there will be only one large subcategory model for all sub category classes.
whereas whenusing a hierarchical approach there will be n sub category models one for each category that will predict one of the subcategory classes within its hierarchy.
several extensive grid search experiments were performed to identify the most optimal set of hyper parameters category andsub category prediction.
.
text based retrieval text retrieval is a popular choice to find relevant documents for a given textual query.
the most preferred method is to index documents textual content to create an index.
at run time a query is formulated by a human which is run against an index to return relevant documents.
however for the system proposed in this paper query formulation is automatic based on the log anomaly and metadata prediction.
hence avoiding the inefficiency ad hoc problem diagnosis and resolution application discussed earlier in the section .
in text retrieval the average length of a query is two to three words .
whereas in this case the query consists of the whole log anomaly that includes the messagecode messagedescription and or exception message.
we represented each resolution document as a dimension vector using glove pre trained embeddings.
these embeddings were then indexed using the annoy index .
annoy allows the capability to index embeddings and uses approximate nearest neighbor for retrieval.
.
metadata based retrieval for a stream of anomalous loglines arriving from an upstream anomaly detection module refer figure the proposed metadatabased retrieval mbr predicts the value of metadata attributes category andsub category using pre trained models.
furthermore it masks the logline to remove any run time environment specific parameter values.
if a messagecode is present in the log anomaly then a query is formulated consisting of messagecode and predicted metadata .
otherwise masked anomalous logline augmented with predicted metadata is used to formulate a query.
execute the query on the metadata based augmented kb refer figure created using the algorithm described in section .
to return top k result set along with the metadata.
next the results are re ranked using the maximum resolutionspecificityscore .
finally a result set is prepared that consists of predicted metadata along with resolutiontitle resolutionurl productname productversion severity providing explainability to the sre for the retrieved result set.
experiments this section provide details of the experiments to demonstrate the effectiveness of the proposed system including the dataset and its characteristics baseline models and analysis of results.
table characteristics of the application server datasets train test category sub category app.
serverdset dset dset 1383esec fse november singapore singapore harshit kumar ruchi mahindru and debanjana kar .
dataset the data for experiments were collected from an in house deployment of applications on the cloud that uses a web application server.
these applications range from insurance finance education etc.
the duration of log data spans from july to may .
in order to study the effect of varying dataset sizes on the metadata prediction model training and the downstream resolution retrieval task the application server dataset was divided into three sub datasets dset dset dset of varying sizes from smallest to largest.
experimenting with datasets of varying sizes allowed us to understand the sensitivity of the learning algorithm to training dataset size.
this is highly critical because when engaging with clients the sales team and client representative teams need to clearly articulate the training data requirements upfront to the clients.
not all clients may have large volumes of data available transparency pertaining to dataset size and model training accuracy leads to a clear set of goals and expectations for both the client and the cloud service provider.
table presents the statistics of the three datasets.
each record in the dataset contains an original logline category sub category and the resolutionurl .
.
evaluation metrics to evaluate the performance of the metadata prediction algorithms accuracy is used as an evaluation metric.
metadata prediction is a multi class classification algorithm where categories andsubcategories are the classes.
first a confusion matrix is computed where the classes are listed in the same order in the rows as in the columns therefore the correctly classified elements are located on the main diagonal from top left to bottom right.
the rows represent the ground truth i.e.
the actual classification and the columns represented the predicted classification.
second the accuracy is calculated from the confusion matrix as accuracy tp tn tp tn fp fn wheretp tn fp fnare the observed true positives true negatives false positives and false negatives respectively.
to measure the performance of the resolution retrieval precision k and accuracy are used as evaluation metrics.
precision k measures the number of cases where the relevant resolutionurl occurs within top k positions.
and accuracy is calculated if the top k results contain the relevant resolutionurl for a given query.
.
baseline methods and proposed methods here we list the baseline methods including different versions of them with and without the contextual information and the proposed metadata based retrieval method.
text content based retrieval methods the following baseline models use the index created from the contents of resolution documents refer section2.
.
cbr ll uses the input anomalous logline as a query to search the text based index to return the resolution documents.
cbr mc for a given anomalous logline extract the messagecode for query formulation to search the text based index to retrieve the resolution documents.
cbr mc cat for a given anomalous logline extract the messagecode and predict the category .
use the messagecode and thecategory for query formulation and search the text based index to retrieve the resolution documents.
cbr mc cat sub cat for a given anomalous logline extract the messagecode and predict the category and subcategory .
use the messagecode the predicted category and the sub category to formulate a query and search the text based index to retrieve the resolution documents.
metadata based retrieval methods the following proposed models use the metadata based augmented knowledge base kb which was explained in section .
.
mbr ll the proposed model uses the input anomalous logline as a query to search the metadata based augmented kb .
mbr mc the proposed model formulates a query from the messagecode extracted from the logline to search the metadatabased augmented kb .
mbr mc cat the proposed model formulates a query from the combination of a messagecode extracted from the given anomalous logline b predicted category for the given anomalous logline .
the query thus formed is used to search themetadata based augmented kb to retrieve resolutions.
mbr mc cat sub cat the proposed model formulates a query from the combination of a messagecode extracted from the given anomalous logline b predicted category andsubcategory for the given anomalous logline .
the query thus formed is used to search the metadata based augmented kb to retrieve resolution documents.
.
results and discussion this section presents the results of the experiments along with a detailed analysis.
evaluation metadata prediction the main objective of the evaluation is to compare the correctness of metadata prediction across varying dataset sizes and using the three metadata prediction models explained in section .
.
.
based on the evaltable accuracy of metadata attributes category and subcategory prediction using the three different models independent ind conditional cond and hierarchical hier category predictionsub category prediction ind cond hier dset .
.
.
.
dset .
.
.
.
dset .
.
.
.
uation results in table we share the details of our analysis and observations below.
model accuracy improves on larger dataset first observation is that with the availability of more data dset vs dset the percentage improvement in metadata prediction for category andsub category is approximately from .
to .
and depending on the sub category prediction algorithm respectively.
for dset and similar for other datasets we observed that the long tail categories corresponding to instances were classified incorrectly.
this indicates that the prediction models performed well on the majority of data classes where the number of training examples was .
1384metadata based retrieval for resolution recommendation in aiops esec fse november singapore singapore table comparing accuracy precision k and average execution time per query sec on mbr and cbr for resolution retrieval on dset method accuracy p p p p p average execution time mbrmbr ll .
.
.
.
.
.
.
mbr mc .
.
.
.
.
.
.
mbr mc cat .
.
.
.
.
.
.
mbr mc cat sub cat .
.
.
.
.
.
.
cbrcbr ll .
.
.
.
.
.
.
cbr mc .
.
.
.
.
.
.
cbr mc cat .
.
.
.
.
.
.
cbr mc cat sub cat .
.
.
.
.
.
.
increase in categories and sub categories with dataset size although the number of category andsub category increased considerably from 44in dset to 69in dset and from 266in dset to 499in dset respectively the model performance improved on the long tail categories.
this is because for the dataset of a larger size each class had more instances to train the prediction model.
hierarchical classifier is the winner for the sub category prediction task hierarchical classifier outperforms independent and conditional classifier a percentage improvement in independent vs hierarchical across the three datasets are for dset .
for dset and .
for dset .
the superior performance of the hierarchical classifier can be attributed to the fact that it exploits the taxonomy relationship between metadata attributes when training category specific models.
further utilizing taxonomy relationship with predicted category labels reduces the search space for the sub category classifier considerably thereby improving its prediction accuracy.
next we discuss the usefulness of the metadata prediction models for the resolution retrieval task.
evaluation resolution retrieval table compares the resolution retrieval accuracy of the proposed metadata based retrieval mbr and the baseline text content based retrieval cbr .
results show that the proposed methods perform much better than the baseline methods.
especially note that mbr with messagecode and predicted context mbr mc cat sub cat has an overall retrieval accuracy of .
.
whereas cbr with messagecode and predicted metadata cbr mc cat sub cat has an overall accuracy of .
the percentage improvement is approximately.
this indicates the usefulness of metadata based augmented kb that is the data that otherwise existed in silos when integrated together and converted into a structured form results in a more effective resolution retrieval.
also it is to be noted that the use of contextual information i.e.
messagecode category and sub category for query formulation improves the retrieval performance for both mbr and cbr method.
when contextual metadata information is provided for query formulation the improvement in accuracy for mbr is more prominent than for cbr.
for instance when mbr is used without and with context the retrieval accuracy improves from .
to60.
an absolute improvement of points.
whereas when cbr is used the retrieval accuracy improves from .
to16.
respectively an absolute improvement of .
points.precision k measures if the relevant resolution document occurs in the top k position.
the results indicate that when category andsub category are used along with the messagecode for query formulation with mbr approximately of the queries a relevant resolution document appears at the first rank and for of the queries a relevant resolution document appears in the top positions.
whereas for the cbr when the context is provided only .
of the queries have a relevant document at the first rank and of the queries return a relevant document at the top positions.
these results show that the mbr with contextual information ranks the relevant document at the top position.
this is an extremely critical achievement to address the challenges discussed earlier in section about improving sres productivity this is because for of the input queries sres are confident that the result at the top rank is the correct resolution.
hence it increases their confidence in problem solving and in turn improves their productivity with a more systematic problem diagnosis and resolution retrieval.
furthermore the more systematic problem diagnosis and resolution retrieval lead to a reduction in mttr and increased customer satisfaction hence improved slas.
to summarize for resolution retrieval mbr outperforms cbr by a significant margin and the use of contextual information for query formulation helps improve the overall retrieval accuracy of both the method used.
next we compare the retrieval accuracy of the method mbr with contextual information mbr mc cat sub cat across the three datasets.
we want to study the effect of dataset size on the quality of retrieved resolutions.
table shows the retrieval accuracy on three datasets when independent conditional and hierarchical sub category prediction approaches are used for metadata prediction.
although category andsub category prediction models perform better as they are exposed to larger datasets for training the same is not reflected in the retrieval accuracy.
for example referring to table the metadata prediction accuracy of category class improves from .
to83.
and the sub category class improves from from .
to69.
for the independent .
to72.
for conditional and .
to75.
for hierarchical.
however when the independent model is used for metadata prediction the resolution retrieval accuracy shows a reasonable improvement of .
to .
.
whereas the resolution retrieval accuracy drops for the conditional .
to .
and hierarchical models .
to .
.
this leads to our first observation which is smaller datasets have biases which may lead to inconsistent results.
hence it is recommended to use a larger dataset for training models to get consistent and reliable results.
1385esec fse november singapore singapore harshit kumar ruchi mahindru and debanjana kar irrespective of the size of the dataset as we move from left to right that is independent to conditional or hierarchical the resolution retrieval accuracy improves.
this is because the models being trained to have seen enough variations of category andsubcategory class instances.
for example for dset the resolution retrieval accuracy improves from independent model to hierarchical model percentage improvement of .
whereas for dset the resolution retrieval accuracy improves from .
independent model to .
hierarchical model a percentage improvement of .
.
this leads to the second observation that the conditional and hierarchical models are superior to the independent model as they exploit the taxonomy relationship between category andsub category .
hence leveraging relationship between metadata for building metadata prediction model is essential.
table comparing resolution retrieval accuracy for mbr mc cat sub cat for three metadata prediction models across three datasets of different sizes resolution retrieval accuracy independent conditional hierarchical dset .
.
.
dset .
.
.
dset .
.
.
evaluation average execution time the last column in table shows the average execution time per query in seconds for the baseline and the proposed methods.
the cbr ll method takes .
seconds on average to return resolution documents whereas the mbr ll method takes only .
seconds .
when contextual information is used for query formulation in mbr the average execution time remains more or less the same in the range of .
to .
seconds.
whereas when contextual information is provided for cbr the average execution time reduces from .
to .
seconds.
this is because the availability of contextual information creates a view over the whole index which is a subset this reduces the search space to find relevant documents hence the reduction in execution time.
we also observed that the average execution time per query for the hierarchical model is two times faster than the conditional model .
this is because the hierarchical model has one sub category model per category hence it has a smaller number of classes to predict from and is thus faster.
qualitative evaluation metadata prediction and resolution retrieval in addition to the quantitative evaluations discussed earlier we conducted a qualitative evaluation for both metadata prediction and metadata based retrieval.
sixteen unique most frequently occurring log anomalies were selected.
for result validation five sres who manage the application server product were consulted and majority voting was used to arrive at the final result.
for each anomalous logline a row in table shows the obfuscated messagecode and the last character e w i indicates whether it is an error warning or informational column a number of retrieved resolutionurl s using baseline method b number of retrieved resolutionurl s using mbr c number of retrieved resolutionurl s using mbr that contain steps that can be executed bytable qualitative evaluation of metadata prediction category and resolution retrieval a b c d e f g h mc1e jdbc jdbc y mc2e security security n mc3e system system y mc4w jdbc jdbc y mc5e transac transac n mc6e perf jms n mc7w system webserv y mc8w classloader http y mc9i jdbc y mc10i security n mc11e system y mc12w perf y mc13i jpa y mc14w security y mc15w security n mc16i security y total ses for problem diagnosis and resolution d validation of column d by ses e actual category label based on the historical data f predicted category label g ses validation of f and g h .
for instance for a given anomalous logline mc15w the res1 could not be found for element with id attribute res2 the extracted messagecode ismc15w the metadata prediction model predicted category issystem .
the formulated query is messagecode mc15w and category system that returns results using mbr.
whereas for the same query the baseline returns results as the messagecode is not present in the dataset.
however the masked logline and the predicted category help mbr to find the matching results.
note that among the returned results all are actionable i.e.
executable by ses .
however ses suggested that only result out of is relevant a result is relevant if it helps resolve the problem.
overall qualitative accuracy of the predicted category is .
i.e.
.
for the messagecode smc2e andmc5e ses indicated that the ground truth category labels were incorrect highlighting that the model is trained on imperfect subjective data.
we recomputed the category prediction accuracy on valid ground truth data only then the predicted category accuracy is .
i.e.
.
the joint accuracy of the category andsub category prediction is .
for each of the unique anomalous log lines category is predicted using the conditional metadata prediction model.
in table across unique log lines mbr returned column c results as compared to column b returned by the baseline a reduction of in the result set this is because mbr leverages contextual metadata during query formulation resulting in a more targeted result set.
using rule based approach for resolution classification step during augmented dataset preparation in section .
resolutions are actually actionable i.e.
executable .
hence it is clear that mbr would derive productivity improvement of sres by addressing the inefficiencies discussed in section as they do not have to go through non actionable resolutions e.g.
reference to another repository or messages like the problem solved or no action needed or contact support .
finally per ses evaluation .
1386metadata based retrieval for resolution recommendation in aiops esec fse november singapore singapore figure log anomalies detected from days of logs obtained from an application deployed on cloud results were found relevant and based on observations discussed above there is room for improvement.
furthermore messagecodes of type informational and warning are predictive in nature indicating that an incident may occur in near future.
given that mbr leverages logline for log anomaly detection the system identifies anomalous log windows containing such predictive signals based on the messagecode s in table are informational and warning that can aid in proactive remediation of incidents.
industrial case study to test the usefulness of the proposed mbr based resolution recommendation we deployed an insurance application on our organization cloud application server.
for a period of days from 1stmarch to 15thapril a total of 186ksystem log lines were collected.
each application server log contains a designated messagecode orloglevel or both.
these logs are aggregated into second windows this process is called as windowed log events resulting in 186klog windows.
each log window has a message field that contains a log message and there are other fields such as messagecode starttimestamp endtimestamp severity and other information related to logging.
a total of 196log anomalies were detected by the log anomaly detection component of aiops pipeline shown in figure1 out of these only 98contain error messagecode .
figure shows five batches of log anomalies detected at different time intervals.
the first march second march and fifth april batch contain transitory log anomalies that are likely false events and can be ignored.
the third batch contains 39log anomalies the first one appeared on march and it persisted for minutes.
similarly the fourth batch contains 55log anomalies first of which appeared on march and it persisted for minutes.
for both batches the most significant message code is mc1e which requires sre attention.
now that a significant and persistent log anomaly event with messagecode has been identified the proposed mbr based resolution is used to retrieve the resolution.
figure shows the user interface of our proposed mbr based resolution retrieval system.
it takes as input the above anomalous log line withmessage code to retrieve up to top resolution documents.
it also predicts the context category andsub category of the log anomaly which is otherwise difficult to comprehend this addresses the two challenges mentioned in the introduction about adhoc problem diagnosis and resolution application andincorrect problem routing .
the query is automatically formulated from the message code in the log anomaly and the predicted contextual information which addresses the second challenge inadequate query formulation for resolution retrieval .
overall the proposed system empowers the sre to quickly isolate the anomalous log events from a large amount of log data and provide the resolution documents to mitigate the issue thereby reducing the mttd and mttr.
the third and fourth batches of log anomalies have a lot in common.
the first time log anomaly event with message code mc1e was detected the sre could have used the proposed mbr to retrieve resolutions and followed it to resolve the problem.
hence avoiding recurrence of the problem.
that is with the availability of the mbr based resolution recommendation there will be only one major event as compared to fivein the days period and that too would have been resolved much more efficiently.
in a nutshell through this case study we have showcased the potential usefulness of the proposed system in terms of productivity improvement of sres trust and confidence in problem solving and reduced mttr and improved slos in turn leading to increased customer satisfaction.
threats to validity sampling bias although we have made a best effort to prepare three different sub sets of application server datasets of varying sizes so that the trained ml algorithm is not biased.
there may be a possibility that one may get different results if the ml algorithm is changed or a dataset from a different domain is used.
subjectivity of human evaluation typically there is a subjectivity in human labeling which is also present in our datasets.
we observed that some of the category labels that our algorithm predicted matched the ground truth however ses evaluation indicated that the ground truth labels were incorrect.
1387esec fse november singapore singapore harshit kumar ruchi mahindru and debanjana kar figure user interface for metadata based resolution recommendation in aiops constrained query formulation while formulating a query metadata attributes are used.
it may be the case that out of nmetadata attributes if one could use mmetadata attributes where m is a subset of n then it may return more results and one of them may be the relevant one.
that is constraining a metadata based query based on number of attributes could have an effect on the final quality of results and one needs to strike a balance between choosing the metadata attributes for query formulation.
related work an application or a service deployed on the cloud is as much vulnerable to outages as any other service deployed on premise.
when an outage happens leading to alerts and anomalies an sre comes into action whose role is to ensure that the services run uninterrupted i.e.
if they fail they return to normal execution as quickly as possible without impacting any client business .
aiops enables sres to respond more quickly and proactively to slowdowns and outages with a lot less effort and toil .
incident remediation in aiops includes finding similar incidents for a given event log anomaly or alert or metric anomaly .
the most widely used approach for incident remediation is based on indexing the textual description of problem statements from historical tickets and using that for matching a run time incident description.
this is essentially a text based retrieval .
there are several challenges to this approach.
first in traditional text retrieval the queries input by a user consists of a few keywords .
whereas in incident remediation the query formulated by an sre is descriptive this is because the sre has to define the symptoms of the issue being observed so it can match with the descriptions of historical incidents.
the second problem stems from how the descriptions were penned down by the sres.
after an incident is resolved and ifit is a customer impacting incident each sre would analyze the issue and document it for future reference.
however it has been observed that the quality of those documents is subpar that is these descriptions are at times incomplete or are unable to capture the essence of the underlying issue.
lidar linked incident identification with data driven representation a deep learningbased approach for incident remediation incorporate the textual description of incidents and structural information extracted from historically linked incidents to identify possible links among a large number of incidents.
routing of incidents to sres is also based on finding similar incidents they also investigated the applicability of traditional bug triage techniques to incident triage which aims to provide useful insights for future study.
another very closely related problem is incident identification and routing which involves automatic incident detection for cloud systems.
the proposed system in this paper does not use historical incidents alone it uses both historical incidents and resolution documents for indexing.
we propose a novel way of combining different sources of data that are otherwise in silos and using them for metadata based retrieval of resolution documents.
retrieving information can be based on full text or other contentbased indexing or searching for the metadata that describes data the latter is known as metadata based retrieval.
metadata for information retrieval has been widely used for both text search and image search .
metadata based retrieval is a natural choice for image search because image attributes are easily accessible that can be modeled as metadata attributes.
for textual documents and queries it is extremely challenging to extract metadata from both this is because textual documents are large and queries are two to three keywords.
to the best of our knowledge metadata based retrieval has not been explored for resolution retrieval in incident management for aiops.
it appears that the log anomalies have a natural overlap with support documents and historical incident tickets.
this allows creation of a metadata based augmented kb refer figure and section index from support documents and incident tickets.
therefore at run time extracting and predicting metadata attributes from the incoming anomalous logline for automatic query formulation allows searching of the metadata based index to return resolution documents with high accuracy.
conclusion this work demonstrates the importance and usefulness of bringing multiple sources of data together for building a metadata based index that can be used for retrieving highly relevant and targeted resolution documents for incident remediation with automatic query formulation from detected log anomalies in an aiops cloud setup.
the proposed approach based on metadata based retrieval utilizes various contextual metadata to enrich the problematic event e.g.
anomalous log line in question for targeted and precise resolution retrieval in aiops.
on a large dataset of 5k log instances we show the usefulness of our approach for both metadata prediction and resolution retrieval.
we are confident that the observations and recommendations shared are insightful for both researchers and practitioners in building an effective production ready incident remediation system.
these insights can be further applied to other components in the aiops pipeline.
1388metadata based retrieval for resolution recommendation in aiops esec fse november singapore singapore