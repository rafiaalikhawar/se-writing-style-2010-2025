metamong detecting render updatebugsin web browsers through fuzzing suhwan song seoulnational university seoul southkorea sshkeb96 snu.ac.krbyoungyoung lee seoulnational university seoul southkorea byoungyoung snu.ac.kr abstract a render update bug arises when a web browser produces an erroneousrenderingoutputduetoincorrectrenderingupdates.such render updatebugsseriouslyharmthe usabilityandreliabilityof webbrowsers.however we f indthatdetecting render updatebugs ischallengingbecausetherender updatebugisasemanticbug given arenderingresult it isdifficulttodetermineifitiscorrect due to the complex rendering speci f ication of dom and css.
thus unlike memory corruption bugs the incorrect rendering output doesnotraisetheviolationorcrash.inpractice render updatebug detection relies on the time prohibitive manual analysis of domain expertsto determinethe bug.
this paper proposes metamong an automated framework to detect render update bugs without false positive issues via differential fuzz testing.
metamong features two key components i pagemutator and ii render updateoracle.thepagemutator generates render update operations which change the content of thewebpage totriggerarender updatebug.therender update oracleexploitsanhtmlstandardrule so calledyielding toproducethecorrectrendering resultofagivenwebpage.combining thesecomponents metamong createstwohtml f ileswhereeach constructs the same web page but only one of them induces the render update.
it then uses differential testing to compare their renderingoutputstodetermineabug.weimplementedaprototype ofmetamong which performs differential fuzz testing on popular browsers chromeandfirefox.byfar metamong identi f ied19new render update bugs in chrome and two in firefox.
all of those have been con f irmed by each browser vendor and f ive are already f ixed demonstrating the practical effectiveness of metamong in identifying render updatebugs.
ccs concepts softwareanditsengineering softwaretestinganddebugging .
keywords rendering update web browser fuzz testing corresponding author permissionto make digitalor hard copies of allorpart ofthis work for personalor classroom use is granted without fee provided that copies are not made or distributed forpro f itorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe f irstpage.copyrights forcomponentsofthisworkownedbyothersthanthe author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspeci f icpermission and or a fee.
request permissions from permissions acm.org.
esec fse december san francisco ca usa copyright heldby the owner author s .
publicationrightslicensed to acm.
acm isbn ... .
format suhwan song and byoungyoung lee.
.
metamong detecting renderupdatebugsinwebbrowsersthroughfuzzing.in proceedingsofthe31st acmjointeuropeansoftwareengineeringconferenceandsymposiumonthe foundationsofsoftwareengineering esec fse december3 san francisco ca usa.
acm new york ny usa 13pages.
.
introduction therenderingperformancehasbeenthekeyrequirementforthe webbrowsers.traditionalbrowserswereveryslowbecausetheyreruntheentirerenderingprocessforeverywebpageupdate.unlike traditional browsers in order to speed up the browser s rendering process modern browsers employ a new technique render update which re renders only the updated part of the web page .
this technique reuses previous rendering results and re renders only the region that needs to be updated for efficiency.
it is very suitableandusefulformostofmodernwebapplicationsbecause they frequently updatetheir webpage.
theproblemisthistechniqueintroducesabugwherethebrowser doesnotre rendertheareasofthewebpagethatshouldbeupdated generatinganincorrectrenderingoutput.wewillcallsuch abuga render update bug inthispaper.
a render update bug is abug that occurswhenawebbrowsergeneratesanincorrectrenderingoutput duetoanincorrectrender updateofthebrowser.render update bugscanseverelyharmtheusabilityandreliabilityofthewebpage anditsservice.inparticular thisbugisveryfataltomodernweb applications because it arises from render update and modern web applicationsfrequentlyinvoke render update toupdatetheirweb pages.
as an example a major electric car company tesla had a service interruption because of a render update bug where chrome 87doesnotproperlychangethecolorofthecar disturbingusers from its service .
therearetwokeychallengesto f ind render update bugs.first it is challenging to generate javascript triggering render update bugs.
this is because the render update bugs can be triggered only when the browser performs the incorrect render update .
second itischallengingtoautomaticallydetect render update bugswithout false positives.
to be speci f ic there is no oracle that can determine whether the visual appearance of the web page violates html css speci f ications .
this is because it is difficult to translate complex html css speci f ications into programmable expressions which allow automated validation.
moreover as some ofthefeaturesforrenderinginspeci f icationsareunder speci f ied the complete speci f ication translation is infeasible.
to solve this issue previousworksleverageddifferentialtestingandproposed two testing methods cross browser testing and cross version testing .itispossibletoadaptthesemethodstodetect esec fse december3 san francisco ca usa suhwan song andbyoungyounglee render update bugs but they have a critical limitation a false positive issue.this is because the rendering outputs can be benignly differentduetotheunder speci f iedfeatures e.g.
tablewidthdistribution orthenewfeatureimplementation e.g.
csshas selector .
in thispaper we propose metamong aframeworktailored for detecting render update bugs inmodern browsers without the false positiveissue.inordertoaddresstheaforementionedchallenges we design two key components page mutator and render update oracle.
the page mutator is used to trigger render update bugs.
as therender update bugcanbetriggeredonlywhenthebrowserruns therender update thepagemutatoronlygenerates render update operations which change the content of a web page such as dom tree and css styles.
by executing the render update operations metamong makes the browser run render update and enhances the chance of triggering render update bugs.
the render update oraclecanidentifythe render update bugswithoutthefalsepositive issues.
the key insight of render update oracle is each web page hasexactlyonerenderingoutputregardlessofwhetheritiscreated bythe wholeorpartial rendering i.e.
render update .
to leverage thiskeyinsight weexploitanhtmlstandardrule yielding .
by exploiting yielding metamong can change the web page while preventingthebrowserfromrunning render update .byusingthese components metamong creates two html f iles that both build anidenticalwebpage butonlyoneofthemcausesa render update .
metamong then uses differential testing to verify whether their renderingoutputsarethesame.finally metamong determinesa render update bugif theirrendering outputs are different.
weimplementedtheprototypeof metamong andconductedthe evaluationontwopopularbrowsers chromeandfirefox.during theevaluation metamong wasabletodetectall28previous renderupdatebugs that were reported within two years at chrome and firefox bug trackers all chrome and all firefox bugs .
more importantly metamong has found render update bugs in chrome and four in firefox .
all of the bugs were con f irmed by the respective browser vendors of them were new bugs and f ive of them were f ixed revealing metamong s practical capability to detect render update bugswithoutfalse positives.
tosummarize this paper makesthe following contributions design.wedesigned metamong aframeworktoautomatically detect browser render update bugs without false positives.
it features two components for render update bugs i a renderupdateoracletodetect render update bugsand ii apagemutator to trigger render update bugs.
promisingresults.
whileperformingtheevaluation metamong candetectallof28previous render update bugsobtainedfrom chrome and firefox bug trackers.
importantly it found new render update bugs in chrome and firefox.
all of these were con f irmed by the respective developers and f ive have already been f ixed.
these results suggest the strong practical aspects of metamong for detecting render update bugsinbrowsers.
background .
fuzzing anddifferential testing fuzzing.
fuzzingisapopularbug f indingmethod.itcontinually executes atargetprogramwiththe randomlygenerated testcasesto see if the target program s behavior is incorrect e.g.
crashing .
sincefuzzingdoesnotrequiredomainexpertknowledgeofatarget program it is widely used in many software applications to detect bugs.mostfuzzersaredevelopedtohuntformemorycorruption bugs .thisisbecausethe bugcannotbediscoveredbyafuzzeronitsown rather aparticular bug condition must be observed during fuzzing.
because of this most fuzzing approaches have been presented to uncover memory corruptionvulnerabilities whichare operatedwithmemoryerror detectors that clearly de f ine bug situations or conditions e.g.
asan andubsan .
differentialtesting.
duetothedifficultyofexpressingsemantic bugs as a bug condition and the requirement for domain expert knowledge to identify them fuzz testing alone is ineffective for detecting semantic bugs.
in this sense differential testing methods are widely used for detecting semantic bugs.
more speci f ically differentialtestingemploysanumberofprograms eachofwhich is meant to get the same result for the same input.
if the results are different for each program we can determine that the program might include a semanticbug.
asdifferentialtesting describesthe bugconditionofthesemanticbugs recentresearchhaveemployed differentialtestingwithfuzzingtouncovermanytypesofsemantic bugs.forinstance itisusedtodiscoversemanticbugsincpurtls ssl tlsimplementations webbrowsers debuggers compilers and java virtual machines jvm .
.
the rendering ofaweb browser rendering is turning the content e.g.
html css and javascript intothepixels i.e.
screenoutput .torenderthecontent modernbrowserssuchaschromeandfirefoxbuild thedatastructure called a page.
the page is the browser speci f ic memory object representing the html document.
each page consists of html css andjavascriptandhasitsownrenderingoutputaccordingtodom and css speci f ications .
we will call the rendering output asrenderin this paper.
the page can be modi f ied by various actions such as javascript and mouse clicks and its rendering output alsochangesaccordingtotheupdatedpage.traditionalbrowsers re dothewholerenderingprocesswheneverawebpageismodi f ied or updated .
however they have a critical limitation re the whole rendering process is very heavy and increases the latency.
this limitation seriously degrades the performance of the browsers and it also impacts most modern web applications as they frequently updatetheir page.
to address this limitation modern browsers build the rendering process into two phases render initial and render update .render initialisthe f irstrenderingphasethatabrowser loads orparses anhtml f ile buildsapagewithit anddrawsthe page scorresponding output.tobe speci f ic the render initialis u1d45d u1d456 u1d45b u1d456 u1d461 u1d435 u1d462 u1d456 u1d459 u1d451 u1d443 u1d44e u1d454 u1d452 uni210e u1d45f u1d456 u1d45b u1d456 u1d461 u1d43c u1d45b u1d456 u1d461 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d45d u1d456 u1d45b u1d456 u1d461 where i u1d435 u1d462 u1d456 u1d459 u1d451 u1d443 u1d44e u1d454 u1d452 buildstheinitial page u1d45d u1d456 u1d45b u1d456 u1d461basedonthehtml f ile uni210e and ii u1d43c u1d45b u1d456 u1d461 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f draws the initial render u1d45f u1d456 u1d45b u1d456 u1d461based on theinitial page u1d45d u1d456 u1d45b u1d456 u1d461.notethatthe render update isnottriggered inthis phase.
1076metamong detectingrender update bugs in webbrowsers through fuzzing esec fse december3 san francisco ca usa style .a background plum .b background aqua style body p class a example p body html h body p example background plum initial page p!
!
class a initial render r!
!
2phase render initial body p example background aqua updated page p class b updated render r phase render update js j letn document .queryselector p n.setattribute class b figure the example ofthebrowser rendering process.
render updateisthesecondrenderingphasethatthebrowser re rendersonlythechangedareasofthepagewheneverthepageis updated.
this approach reuses previous rendering results and only re renders the changed parts of the page to efficiently generate the page scorresponding output.tobe speci f ic the render update is u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d443 u1d44e u1d454 u1d452 u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 u1d45d u1d456 u1d45b u1d456 u1d461 u1d457 u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 u1d45f u1d456 u1d45b u1d456 u1d461 u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 where i u1d443 u1d44e u1d454 u1d452 u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 executes the javascript u1d457and updates the initial page u1d45d u1d456 u1d45b u1d456 u1d461totheupdated page u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 and ii u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 updatestheinitial render u1d45f u1d456 u1d45b u1d456 u1d461totheupdated render u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452which isthecorrespondingrenderingoutputof u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452.asrender update does not render the entire area yet only re renders the part of the area which should be updated the browser can signi f icantly decrease the performance overhead of the rendering with it.
besides the render update canbealsoperformedontheupdated page u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452toefficientlygeneratetherenderingoutputwhenthepage isupdatedagainthroughthe javascript.
anexampleofthebrowserrenderingprocessisshownin figure .
in phase the browser loads the html f ile uni210eand builds theinitial page u1d45d u1d456 u1d45b u1d456 u1d4611.itproducestheinitial render u1d45f u1d456 u1d45b u1d456 u1d461based ontheinitial page u1d45d u1d456 u1d45b u1d456 u1d4612.then whenthejavascriptcodeisexecuted thebrowserconductsthesecondrenderingphase.inthis example thejavascriptcodechangesthe classattributeof p elementnodefrom a to b .asthevalueofthe classattributeis changedto b thebackgroundcolorofthe p nodechangesfrom plum to aqua and the initial page becomes the updated page u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d4524.finally thebrowserperforms render update basedon theupdated page u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452andtheinitial render u1d45f u1d456 u1d45b u1d456 u1d461togenerate theupdated render u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452.asonlythebackgroundcolorofthe p node is changed the browser re renders only the area of p node i.e.
plum rectangle tochangeto theaquacolor andit does not re renderthe restofthe area .
.
render update bug the browser developers try to optimize the render update by maximizing the reuse of previous rendering results and minimizing the areas to be re rendered as possible.
however while making render update efficient thebrowserdeveloperscanintroduceabug that the browser incompletely re renders the areas of the page that should be updated.
we will call such a bug a render update bug.
arender update bug isa bug where the browserincorrectly performs render update on an updated page and generates an incorrect rendering outputof the page different from the dom and1 !doctype html script 3functionupdate page box.innerhtml important text script style box transform rotatey 0deg height 30px style body example of render update bug divid box div body a poc htmlcode execute update page b actual result incorrect .
execute update page c expectedresult correct .
figure a render update bug example chrome issue .
a actual result incorrect .
b expectedresult correct .
figure a render update bug chrome issue triggered on tesla s homepage .
the car color does not change to whiteeven after theuserclicks the white color button.
cssspeci f ications.
itisworthnotingthatthe render update bug and the rendering bug have different root causes although both generate the incorrect rendering outputs which violate dom css speci f ications.
render update bugs can harm users and web application developers in many ways.
for instance if the browser has arender update bug and it is triggered on the web application importantelementsthatshouldbedisplayedmaybecomedistorted orinvisible severelyharmingtheservicequality.furthermore if elements are placed at awkward locations users may not understandthecontentsormaybemisguided.
inaddition render update bugs introduce unnecessary challengesto the web application developers.supposethedeveloperfoundacertainbugintheirweb application.
then the developer starts to manually debug the issue butsuchadebuggingprocessistypicallyperformedundertheassumption thatthe underlying browser hasno bugs.
if thisbug is a render updatebug thedeveloperwillneedtospendquiteatimeto f inally notice itis a browser s issue or oftenfail to triage thebug.
we explain the exampleof a render update bug withthe html code shown in figure .
in this example the chrome browser f irst opens the html code and generates its rendering output i.e.
initial render .itthenexecutes update page atline 3tomodify thepagebysettingthetextof div elementwith important text .
afterward the chrome browser performs render update on the updatedpageandgeneratesitsrenderingoutput i.e.
updated render .
if the chrome browser works correctly the text important text highlighted with the red box should be drawn below the text 1077esec fse december3 san francisco ca usa suhwan song andbyoungyounglee !doctype html style body font size 30px style script 4functionupdate page 5document.stylesheets .insertrule ul has li background plum script body ul li hello world li ul body a poc htmlcode update page b actualresultofchrome104 correct update page c actualresultofchrome105 correct figure afalsepositive example ofcross versiontesting.
example ofrender update bug as shown in figure 2c .
however the chrome browser incorrectly performs render update it does notre renderthehighlightedareabecauseitdeterminesthatthe highlighted area which should be re rendered does not need to be re rendered.
as a result the chrome browser does not draw the textimportant text and produces the incorrect rendering result as shownin figure 2b .
therender update bug can severely harm the usability and reliability of the page and its service if such a page is for commercial services.weexplainsuch acasewithareal worldexamplewhere therender update bugwastriggeredontesla shomepageasshown infigure .
initially the black buttonon the homepage was selected so the color of the car was black as well.
then the user can select the color to change the car color.
when the user selects the white color the browser should change the car color from black to white.
however the problem was that eventhoughthe user selects thewhitecolor orothercolors thecolordoesnotchangetowhite andremainsblackdueto a render update bug.
challenge and approach .
challenge we elaborate on two challenges in triggering and detecting the render update bugs.
challenge triggering render update bugs.
it ischallengingto generate javascriptthattriggers render update bugs.
this is because the render update bugs can be triggered only when the browser performs the render update .
if the javascript does not change the page the browser never performs render update which is the origin of render update bugs.
to trigger the render update bugs thejavascriptneedstochangethepageandmakethebrowser perform the render update .
thus toincreasethe chancetotrigger render update bugs the generated javascript should induce the complex page andrenderchangefrom the browser.
challenge detectingrender updatebugswithoutfalse positives.
inordertodetect render update bugs thereshouldbean oraclethatcantellthecorrectnessofthe render update .however itisverychallenging tobuildsuch a render update oraclebecausetherender update bugisasemanticbug.tobemorespeci f ic the render update bug is triggered due to the semantically incorrect behavior of render update .
it entails incorrect rendering outputs which violate dom and css speci f ications .
however it is difficult to automatically validate their semantic correctness because unlike the memory corruption bug the incorrect rendering output does not trigger the violation or crash.
this means that it is impossibletodetectwhetherthebrowserviolatesdomandcss speci f ications.
hence detecting render update bugs relies on the manual analysis of domain experts or the bug reports from the usersandwebapplicationdevelopers.
to resolve this issue several studies leverage differential testing that compares the result of two different browsers for detecting rendering bugs.
to be speci f ic the research area has proposed two testing methods by using differential testing i cross browser testing and ii cross versiontesting .bothmethods can be used to f ind the render update bugs but they have a critical limitation theysufferfromthefalsepositiveissueon f inding renderupdatebugs.
cross browser testing can be used to detect the render update bugsbycomparingtheresultoftwoindependently implemented browsers e.g.
chromeandfirefox .itdeterminesthereisa renderupdatebug when two browsers generate different results from thesameinput consistingofhtml csswithjavascript whichis usedtotrigger render update .thismethodcanbeeasilyemployed to detect render update bugs because it does not require domain knowledge.however r2z2 hasshownthattheresultoftwo independently implementedbrowserscanbedifferentduetothe benign browser incompatibilities e.g.
different feature support so the cross browsertestingalone can trigger manyfalse positives.
the cross version testing compares the result of two different versions of the same browser e.g.
chrome version and to detect the render update bugs.
it determines there is a renderupdatebug when two browsers generate different results from the same input consisting of html css with javascript.
unlike cross browser testing it does not suffer from benign incompatibilitiessuchasdifferentsupportedfeaturesanddifferentdesigns.
this is because such incompatibilities are introduced when two browsers are independently implemented.
however this approach still suffers from the false positive issue the result of two different versionsofthesamebrowsercanbebenignlydifferentduetothe feature update or the bug f ix.in other words it isstill challenging to determinewhichone iscorrectwhen tworesults are different.
weexplainanexampleofafalsepositivecasethatcanbecaused bythefeatureupdate i.e.
csspseudo class has asshownin figure4.csspseudo class has isnotsupportedbeforechrome105 anditis f irstintroducedinchrome105.inthisexample chrome 104and105producethesamerenderingoutputswhenopeningpoc html code.
after they execute update page to insert the css rule their rendering outputs become different where only chrome 105paintstheplumbackgroundon the li node.thisisbecause has is not supported by chrome so chrome ignores theinsertedcssrule.theproblemhereisthateventhoughboth browsers produce the correct rendering outputs the cross version testingapproachdeterminesthiscaseas render update bug leading to afalse positive.
1078metamong detectingrender update bugs in webbrowsers through fuzzing esec fse december3 san francisco ca usa style before background plum after background aqua style body p id before example p body test html h!
!
body p example background plum initial page p!
!
!
id before initial render r!
!
!
body p example background aqua updated page p!
!
!
id after updated render r!
!
!
style before background plum after background aqua style body p id before example p body script before.setattribute id after script reference html h render checkerbefore.setattribute id after body p example background aqua reference page p !
id after reference render r !
integratorhtml generator page mutator .
bug report8 render update oracle .
bug triggering phase bug detection phase js j figure the overallwork f low of metamong .
summary both cross browser and cross version testings triggermanyfalsepositives.
this isaverycriticalproblem because the browser developers should spend their time and effortonthe bugs whichactually donot exist.
.
ourapproach approach generating render update operations only.
toaddresschallenge webuildthepagemutator whichgenerates render update operationstochangethepageandtriggerthe renderupdate.wedothisbasedonthefactthatthe render update isthe origin of the render update bugs and the browser performs renderupdatewhen itchanges the page and has to re render the page.in this respect the page mutator generates the mutation primitives changing the dom tree or the css style of the page.
by executing such mutation primitives metamong can f ind more render update bugsbecausethebrowserdrawsthepagebasedonitsdomtree and css style and performs render update whenever the dom tree andcssstyle are changed.we willdescribe the detailofthe page mutatorat .
.
approach exploiting an html standard rule to build render update oracle.
to address challenge we build the render update bugoraclewhichcanidentifythe render update bugs withoutthefalsepositiveissues.thekeyassumptiontobuildthe render update oracle is that an initial render can be used as a reference oranswer renderfromtheperspectiveofthe render update bug.
we can use this assumption because when the browser generatestheinitial render itdoesnotperform render update whichis the rootcause of render update bugs.
to leverage this key assumption we exploit one of the html standard rules called yielding.
yielding is when the browser encounters the javascript while parsinganhtml f ile it f irstblockstheparsing executesthejavascript andthenresumesparsingthehtml f iletobuildthepage.byexploiting yielding we can make the browser build the page that weaimforwithoutperformingthe render update .inotherwords the browser only performs the render initial on the page so that wecangetthereferencerenderoftheaimedpage.tobespeci f ic metamong generatestwohtml f ileswheretheybuildthesame page but one triggers the render update and the other does not.metamong then leverages differential testing to check whether their rendering outputsare the same.
ifthey generate different renderingoutputs the render update bugoracledeterminesthiscaseas arender update bug.wewilldescribethedetailofthe render update oracle at .
.
design wedesign metamong aframeworkfor f inding render update bugs inthemodernbrowsersthroughdifferentialfuzztestingwithout the false positive issue.
first we introduce the overall design of metamong .
.
then we introduce the page mutator which generatesthemutationprimitivesinjavascripttotriggerthe renderupdatebug .
.metamong usesthehtml f ileandthemutation primitives to build the test page and get its rendering result which is used to determine the render update bug later in .
.
lastly we present the render update oracle that can detect the renderupdatebugs without the false positive .
.
therender update oracle consists of two components integrator and render checker.theintegratorexploitsyielding whichistheoneofthe htmlstandardrules.itmergesthehtml f ileandthemutation primitives to construct the reference html f ile which is used to get the reference rendering result of the test page.
the render checkercomparestherenderingresultoftestpageanditsreference rendering result to determine whether the browser triggers the render update bug.
if they are different metamong considers it as arender update bug.
it is worth noting that the render update oracle can be easily adopted to the other dom fuzzer to detect the render update bugs.
.
overview theoveralldesignandwork f lowof metamong areshownin figure5.metamong consistsoftwophases bugtriggeringphase and2 bugdetectionphase.inthebugtriggeringphase metamong f irstgeneratesandopensanhtml f ile i.e.
uni210e u1d461 u1d452 u1d460 u1d461 onthebrowserto buildtheinitial page i.e.
u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461 andproduceitscorrespondingrendering output i.e.
initial render denoted as u1d45f u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d4611.
in this example theinitial page u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461hasa body nodeasarootanda p node asachild.the p nodehastheidattributeanditsvalueis before sothestyleofthenode p iscalculatedasbackground plum .the 1079esec fse december3 san francisco ca usa suhwan song andbyoungyounglee after beforebody button example color seagreen id a body button example color seagreen id a fieldsetappend field render update a.insertadjacenthtml afterend fieldset fieldset js a domnodeinsertion.after beforebody button example color seagreen id a body button example color seagreen id a add attribute hidden render updatehidden hidden a. setattribute hidden hidden js b domnodeattribute insertion.after beforebody butto n example color seagreen id a body button example color seagreen id a focus button render update a. focus js c domnodefocus.
figure the examples ofdom mutation primitive.
browserdrawsthe u1d45f u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461wherethetext example isdrawninside of the plum rectangle.
then it uses the mutation api generator to make the mutation primitives which can trigger the render update .metamong executes the mutation primitives on the page u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461 to trigger the render update bug3.
after that the browser updates u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461to the updated page i.e.
u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 and performs the render update toupdate u1d45f u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461totheupdated render i.e.
u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 .inthisexample u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461becomes u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 theidattributevalue of the p node changes to after and its style also changes to background aqua .
at the same time the browser performs the render update and generates u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 where the text example is stilldrawn within the plum background.
in the bug detection phase the render update oracle uses the integrator to combine the html f ile uni210e u1d461 u1d452 u1d460 u1d461with the mutation primitives to generate the reference html f ile i.e.
uni210e u1d45f u1d452 u1d453 .
then therender update oracleopens uni210e u1d45f u1d452 u1d453onthebrowsertogetitsreference render i.e.
u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 which is the correct rendering output of u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 .inthisexample beforethebrowserreachestothe script tag the page has the body node as a root and the p nodeasachildwiththe idattribute before .whenthebrowser reaches to the script tag the browser executes the mutation primitivetarget.setattibute id after .
itchangestheid attribute value from before to after so the style of the p node is calculated as background aqua .
the browser then conducts the render initial to draw the u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453where the text example isdrawninsideoftheaquarectangle.finally itleveragestherender checker to determine the render update bug by comparing two renderingoutputs u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 and u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d4537.if u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 isnotsameas u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 metamong determines this case as the render update bug8.
in thisexample thetext example shouldbedrawninsideoftheaqua rectangle i.e.
u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 butthebrowserfailstoupdatethebackground colortoaqua.inthisrespect wecandeterminethatthebrowser triggers the render update bug.
.
page mutator it is important that the render update bug can be triggered only whenthebrowserperformsthe render update onthepage.tomake thebrowserperformthe render update thepageshouldbeupdated or modi f ied via javascript.
to be speci f ic the work f low of pagebody button examplecolor seagreen background plum id a body button examplecolor seagreen id a after beforerender updateappend css rule background plum document .stylesheets .insertrule a background plum js figure anexample ofcss mutation primitive.
mutatoris u1d457 u1d43a u1d452 u1d45b u1d452 u1d45f u1d44e u1d461 u1d452 u1d440 u1d462 u1d461 u1d44e u1d461 u1d456 u1d45c u1d45b u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 u1d443 u1d44e u1d454 u1d452 u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461 u1d457 u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 u1d45f u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461 u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 where i u1d43a u1d452 u1d45b u1d452 u1d45f u1d44e u1d461 u1d452 u1d440 u1d462 u1d461 u1d44e u1d461 u1d456 u1d45c u1d45b randomlygeneratesthemutationprimitives u1d457 ii u1d443 u1d44e u1d454 u1d452 u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 mutatestheinitial page u1d45d u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461totheupdatedpage u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 by executing the mutation primitives u1d457 in javascript and iii u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d448 u1d45d u1d451 u1d44e u1d461 u1d452 updates the rendering output u1d45f u1d456 u1d45b u1d456 u1d461 u1d461 u1d452 u1d460 u1d461to the u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 which isthe corresponding renderingoutput of u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 .
asthebrowserdrawsthepagebasedonitsdomtreeandcssstyle we employ two page mutation methods dom tree mutation and2 cssstyle mutation.
dommutationprimitive.
metamong currentlyhasthreedom mutation operations dom node insertion deletion dom nodeattributeinsertion deletion domevent fordomnode insertion metamong randomly selects where to insert and then generates the dom node.
then it uses insertadjacentelement position element domapitoinsertthenodeintheselected position.similarly fordomnodedeletion metamong randomly selectsanddeletestheoneofthedomnodesvia remove dom api.
the example of dom node insertion is described in figure 6a.
before mutation the page has the body node as a root and the child node i.e.
the button node .
the button node has theid attribute with its value a the text nodeexample and the css stylecolor seagreen .here metamong selectsthe body node generates the fieldset node and inserts it inside the body nodeafteritslastchild node i.e.
button node .after mutation thebrowser performs render update todraw the fieldset node belowthe textexample.
1080metamong detectingrender update bugs in webbrowsers through fuzzing esec fse december3 san francisco ca usa for dom node attribute insertion metamong randomly selects the one of dom nodes and inserts the attribute with the value viasetattribute name value .
similarly for dom node attribute deletion metamong randomly selects the one of dom nodes and deletes the one of selected node s attribute names via removeattribute name .
the example of dom node attribute insertionisdescribedin figure6b .metamong selectsthe button nodeandinsertsthe hiddenattributewiththevalue hidden .after mutation thebrowserperforms render update toerasethe button node andits textnode as well.
metamong currentlyhasthreedomeventoperations dom nodefocus domnodescrolling and windowresizing.for dom node focus metamong randomly selects and focuses one of the dom nodes via focus dom api.
for dom node scrolling metamong randomlyselectsandmovesthescrollvia scrollto x y domapi.forwindowresizing metamong randomlychangesthe size of the browser window via resizeto width height dom api.anexampleofdomnodefocusisshownin figure6c.metamong selects and focuses the button node so the browser performs render update to thicken the outer edge ofthe button node.
css mutation primitive.
metamong currently has one css mutation operation css style insertion deletion for css style insertion metamong randomly generates the css rule and selects the index into which the css style rule is to be inserted via insertrule rule index api.
similarly for css style deletion metamong randomlyselectsanddeletesoneofthecssstylerules viadeleterule index api.anexampleofcssstyleinsertionis describedin figure7.metamong selectsoneastheindexandinserts the css style rule p background plum .
after mutation the browser performs render update to paint the background of the text example .
.
render update oracle overview.
therender update bug is a semantic bug which is triggered if the browser incorrectly performs the render update whenchangingthepagethroughthejavascript.duetotheincorrect render update it generates the incorrect rendering output.
in order todetectthe render update bug webuildthe render update oracle basedonthe following assumption assumption initial render is the reference or answer rendering result of the page.
the updated render should bethesameasthereferencerender i.e.
initial render iftheir pagesare the same.
this assumption is based on the following two properties of the browser rendering process i each page has exactly one rendering output and ii the browser only performs the render initial phase not therender update when generating the initial render.
based on these properties if the initial render and the updated render are generated from the same page they should be the same.
if they are different this impliesthat atleastone ofthemis incorrect.in this paper the initial render is always correct based on our assumption becausewefocuson f indingthe render update bug whichcanbe onlytriggeredinrender updatephase not inrender initial phase.to this end the render update oracle determines a render update bugwhen the updated render andthe initial render are different.
tobe speci f ic the render update oracle is uni210e u1d45f u1d452 u1d453 u1d43c u1d45b u1d461 u1d452 u1d454 u1d45f u1d44e u1d461 u1d456 u1d45c u1d45b uni210e u1d461 u1d452 u1d460 u1d461 u1d457 u1d45d u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 u1d435 u1d462 u1d456 u1d459 u1d451 u1d443 u1d44e u1d454 u1d452 uni210e u1d45f u1d452 u1d453 u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 u1d43c u1d45b u1d456 u1d461 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d45d u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 u1d45f u1d452 u1d460 u1d462 u1d459 u1d461 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d436 uni210e u1d452 u1d450 u1d458 u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 where i u1d43c u1d45b u1d461 u1d452 u1d454 u1d45f u1d44e u1d461 u1d456 u1d45c u1d45b mergesthehtml f ile uni210e u1d461 u1d452 u1d460 u1d461withthemutation primitives u1d457togeneratethereferencehtml f ile uni210e u1d45f u1d452 u1d453 ii u1d435 u1d462 u1d456 u1d459 u1d451 u1d443 u1d44e u1d454 u1d452 buildsthepagewith uni210e u1d45f u1d452 u1d453 iii u1d43c u1d45b u1d456 u1d461 u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f rendersthepage u1d45d u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453to draw the reference or answer render u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 and iv u1d445 u1d452 u1d45b u1d451 u1d452 u1d45f u1d436 uni210e u1d452 u1d450 u1d458 checkswhether u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 isequalas u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453anddeterminesthe renderupdatebugif they are different.
integrator.
the integrator generates the reference html f ile which is used to get the reference rendering result of the updatedpage u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 .
to do so it exploits yielding one of html rules de f inedinhtmlstandard yielding whenthebrowserencountersthejavascriptwhile parsing orloading anhtml f ile itblockstheparsing executes the javascript andthen resumes to parse the html f ile.
byusingthisproperty wecangetaninitial render i.e.
reference render of the page which is the same as u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 .
that is the integrator can make the reference html f ile that can be used to build the same page as u1d45d u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 without the render update .
to be speci f ic if we execute the javascript right before the browser f inishes building the page we can make the browser block the renderingprocessandchangethepage.afterthepagechanges the browserperformstherender initialsothatwecangetthereference render ofthe page withouttriggering render update .
to do so the integrator wraps the primitives with script tag and then appends it to the test html f ile to generate the referencehtml f ile.by html f ile the browser loads the html f ile andexecutes the mutationprimitives toupdate thepage.then it f inishesbuildingthe pageandperformstherender initialtodrawthereferencerender ofthe page.
render checker.
after the integrator produces the reference render u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 therender update oracle leverages the render checker to determine render update bug.
the render checker compares two rendering outputs u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 and u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 and determines as renderupdatebug if they are different.
to compare the rendering outputs weadoptthesameimagecomparisonalgorithm i.e.
phash andcon f igurationusedbyr2z2 becausethe render update bugs are very similar to the rendering bugs hunted by r2z2.
it is worth noting that other image comparison algorithms also can be used to detectrender update bugs.finally iftherendercheckerdetermines there isa render update bug itgeneratesthe bugreport.
implementation we implemented metamong on topof r2z2 todetect renderupdatebugs from modern browsers.
the prototype of metamong 1081esec fse december3 san francisco ca usa suhwan song andbyoungyounglee table the number of render update bugs detected by each oracle.
browser ofbugs r2z2 lqc render updateoracle chrome .
firefox .
total .
canfuzzchromeandfirefoxbrowsers.forthehtmlgenerator weleverageddomatofuzzer astate of the artgrammar based dom fuzzer.
we modi f ied domatofuzzer to generate the html f ile i.e.
an initial test page without animations and javascript.
in order toimplement the pagemutator we selected dom css apis changingthedomtreeandcssstylefromthegrammarof domato fuzzer.we modi f iedr2z2 s fuzzingimplementationtoimplement theintegratorof render update oracle.fortherenderchecker we adaptr2z2 simagecomparisonimplementationandusedthesame imagecomparisonalgorithmandcon f igurationofr2z2.intermsof theimplementationcomplexity metamong isimplementedwith linesofpython.
evaluation weevaluate metamong byansweringthefollowingresearchquestions rq .canmetamong detectthe render update bugs?
rq2.whichmutationprimitiveiseffectiveto f ind render update bugs?
rq .howmanybugshas metamong found?
forevaluation weuseda24 core serverrunningubuntu20.
withintelxeon r gold .30ghz cpusand512gb ofram.
.
effectiveness ofrender update oracle .
.
recallofrender updateoracle.
inordertoshowtheeffectivenessof render update oracleindetectingbugs wecomparedthe render update oracleagainsttwodifferentoracles r2z2 and lqc .
tobespeci f ic we f irstselectedthepopularwebbrowsers chrome and firefox.
then we collected the render update bugs whichwere alreadyreportedinchromeandfirefox bugtrackers.
from the chrome bug tracker we searched the render update bugs thatwerereportedfrom2021to2022andobtained15 render update bugs .
from the firefox bug tracker we searched the renderupdatebugs that were reported from to and obtained 13render update bugs .
afterwe collectedthe render update bugs we simpli f ied bugs for evaluation and ran three oracles to check whether they can detect these render update bugs.
then we setup the experiment environment for each oracle.
to run r2z2 we provided the similar experiment setup as described in its paper.
we f irst selected a beta version of each bug as band a stable version released at the time of basa.
then we selected the independently developedbrowserasthereferencebrowser i.e.
r wheretheversionof ristheclosestof b. torunlqc weused the same experiment setupas metamong .
table 1describes the number of render update bugs detected by threeoracles.lqcidenti f iedthree render update bugsinchrome andnineinfirefox i.e.
therecalloflqcis42.
.however itwas not able to detect chrome bugs and four firefox bugs that were triggered by dom events e.g.
scroll because lqc onlyallows tomutate the dom tree and css style to prevent false positives.
on theotherhand r2z2failedtodetectanyofthe28render update bugs resulting in a recall rate of .
.
this failure is largely due to thefollowingtworeasons.firstly r2z2isspeci f icallytailoredto detect regression bugs and render update bugs did not fall under this category.
secondly r2z2 can only identify render update bugs when the browser interoperability conditions are met i.e.
chrome andfirefoxgeneratethesamerenderingresultforagiveninput .
in the case of chrome render update bugs only two out of were regression bugs and r2z2 successfully detected the differences betweenversions aandbfortwobugs.however r2z2failedto detect two chrome render update bugs due to the unique design variationsbetweenchromeandfirefox whichmader2z2failto meetthebrowserinteroperabilityconditions.furthermore r2z2 failedtodetect anyofthefirefox render update bugsbecausethere werenoregressionbugs.
lastly the render update oraclewasable todetectallof28 render update bugs i.e.
therecallof render update oracleis100 .
thisdemonstrates metamong sstrongpractical capability indetecting render updatebugs.
case study chrome issue .
this bug is interesting becausemetamong wasableto detect thebuganddidnot report the falsepositive eventhough thereference render is incorrectaccordingtodom cssspeci f ications.
inotherwords evenif u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453is incorrect fromthe perspective of dom css speci f ications it is correctfromtheperspectiveofthe render update bug.
thisisbecause theinitial rendercanbegeneratedonlybyrender initialphaseand therender update bugcanbecausedonlybytheincorrectbehavior ofrender updatephase i.e.
theoriginof render update bug .
in this respect the initial render can be used as the reference renderingresult i.e.
u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453 todeterminethe render update bug making metamong avoidthefalsepositive.
besides metamong wasable to detect this bug because u1d45f u1d462 u1d45d u1d451 u1d44e u1d461 u1d452 u1d461 u1d452 u1d460 u1d461 is different to u1d45f u1d456 u1d45b u1d456 u1d461 u1d45f u1d452 u1d453.
this case study signi f ies that even if the reference result is incorrect accordingtodom cssspeci f ications metamong does notgeneratethe false positive and is able to detect the bug if render update triggers arender update bug.
.
.
accuracyofrender updateoracle.
ideally the render update oracle should not trigger the false positive issue.
this is because therender update oracle compares tworendering outputs that are generated from two same pages where one is updated and the other is not.
as each page has exactly one rendering output there must be a render update bug if two rendering outputs are different.
ourclaimcanbesupportedbyourevaluationtesting metamong because all of the render update bugs reported by metamong werecon f irmedbythedevelopersofeachbrowser.thatis wecould not f ind any false positive casewhileevaluating metamong .
the limitation of lqc is it cannot detect render update bugs which can be triggered by dom events because it employs only dom nodeand css style mutationprimitives topreventthefalse positive.inthisrespect iflqcisemployedtodetect render update bugs triggered by dom events it will suffer from the false positive issues.forexample figure8illustratesafalsepositivecaseoflqc thatcanbecausedbythedomevent i.e.
scroll .inthisexample chrome drawsthe correctrendered result asshown in figure 8b afterexecutingthefunction update page whichmovesthetext 1082metamong detectingrender update bugs in webbrowsers through fuzzing esec fse december3 san francisco ca usa !doctype html script 3functionupdate page target.scrollto script body divid target style height 100px overflow auto divstyle height 800px background coral example div div body a poc htmlcode b actual result correct c referenceresultoflqc incorrect figure8 a falsepositiveexampleoflqcwith scrollmutation primitive.
node insertnode deleteattribute insertattribute deletefocus scoll window resizestyle insertstyle deletenumber of bugs mutation primitivechrome firefox figure the average number of bugs triggered by each mutation primitive on 100k html testcases across three experiments.
false positive 10pixelsupwards.theproblemhereisthatlqc doesnotconsiderthedomeventwhengeneratingthereference result.
as a result lqc generates the incorrect reference result shown in figure 8c and triggers the false positive as both results i.e.
figure 8andfigure 8c are different.
.
effectiveness ofpage mutator the effectiveness of mutation primitives are important as they are the key to trigger render update bugs.
to evaluate their impact we conducted three experiments measuring the number of bugs triggered by each mutation primitive using the same set of htmltestcasesonbothchromeandfirefox.
figure9describes theaveragenumberof render update bugsforeachmutationprimitiveonchromeandfirefoxacrossthreeexperiments.according tothisevaluation focusandstyle delete arethebestmutation primitives triggering render update bugs in chrome and firefox respectively.node insert andstyle delete areeffectivemutation primitives on both browsers as they can change many parts of the page.
on the other hand attribute delete andscrollare the worstmutationprimitivestriggering render update bugsinchrome and firefox respectively.
in this experiment we were unable to identify patterns of effective mutation primitives because the number ofrender update bugs for varies depending on the browser.
we leave this as afuture work.
!doctype html script 3functionupdate page document.stylesheets .deleterule script style update offset path path m l update transform translatez child width 100px height 100px background lightblue style body dlid update divid child div dl body a poc htmlcode.
b before c after actual d after expected figure acasestudyofchrome issue .
.
newrender update bugs discoveredby metamong to discover render update bugs we ran metamong on chrome and firefox which were the latest browser versions at the time ofperformingourexperiment.thenweconductedanadditional experiment on the latest version of chrome i.e.
chrome in ordertouncovermore render update bugs.
duringthe f irstexperiment metamong found f ive and four render update bugs in chrome and firefox respectively and total of nine renderupdatebugs were con f irmed by each browser vendor.
furthermore itwascon f irmedthat f ive of the chromeandtwooutof fourfirefoxbugswerenew render update bugs.inadditionalexperiment metamong found render update bugs in chrome and the chromedeveloperscon f irmedthattotalof12 render update bugs were true andnew render update bugs.
to summarize metamong has found and four render update bugs 21intotal and17and2ofthem 19intotal werenew renderupdatebugs in chrome and firefox respectively.
the list of render update bugsfoundby metamong isshownin table2.all of 21render update bugs were con f irmed by the developers of each browser vendor of them were new render update bugs and f ive ofthemwere f ixedsofar showingtheefffectivenessof metamong fordetecting render update bugs.
inaddition thechromedeveloper has shown a positive reaction mentioning that the design ofmetamong is interesting .
it is difficult for us to clearly measure how long it takes to f ind a certain vulnerability as we kept running metamong andmetamong sbehavior particularly itsmutation ismostlyrandom.overallweran metamong fortwo months whichincludesthetimetodetectandanalyzethebugas well as updating metamong .
case study chrome issue .
thisrender update bug occurs when chrome performs render update on the node that has the child node and the transform css style.
chrome should update the node and its child node when the css style of the node is changed.
however due to the performance optimization ontransform cssstyle chromeonlyupdatesthenodeanddoes not update the child node triggering the render update bug.
the snippet of a poc code is shown in figure 10a .
first chrome opens the poc html code and draws the rendering output figure 10b .
1083esec fse december3 san francisco ca usa suhwan song andbyoungyounglee table the list of21 render update bugsfoundby metamong inchrome and firefox.
browser issue id correct incorrect new fixed description chrome .
.
.
the dashed underline is incorrect after removing an element.
chrome .
.
.
the text in dl moves to the wrong position after removing acss rule content .
chrome .
.
.
the details movestoawrongpositionafterremovingcss rules column and position .
chrome .
.
.
theheightof dd islargerthanexpectedafterremovingacss rule height .
chrome .
.
.
the position of h4 is incorrect after adding a css rule position chrome .
.
.
thewidthof keygen doesnotchangeafterremoving acss rule border style .
chrome .
.
.
thetextislargerthan expected afterremoving acss rule scale .
chrome .
.
.
thepositionof dialog is incorrectafterremovinga css rule backdrop f ilter .
chrome .
.
.
the size of th is incorrect after removing a css rule writing mode .
chrome .
.
.
the border line of f ieldset is not updated after removing acss rule offset path .
chrome .
.
.
theheightof f ieldset doesnotdecreaseafterremovingacss rule margin right .
chrome .
.
.
theshapeof q isincorrectafterremovingacssrule font weight .
chrome .
.
.
the height of th is incorrect after removing a css rule margin left .
chrome .
.
.
theborderlineisincorrectafterremovingacssrule webkit border end .
chrome .
.
.
thesizeof table isincorrectafterremovingacss rule font face .
chrome .
.
.
the position of quote is incorrect after removing an element.
chrome .
.
.
thelocationoftextisincorrectafteraddinganelement.
firefox .0a1 the line moves to a wrong position after adding a css rule display .
firefox .0a1 the size of dir isbigger unexpectlyafteraddingan element.
firefox .0a1 the position of dialog is incorrect after adding an element.
firefox .0a1 the position of label is incorrect after removing a css rule input .
then itexecutesthefunction update page todeletethecssrule update offset path path m l .
the correct behavior is that chrome removes the css rule from the dl node and its child node div and performs render update to update the rendering output.
the correct rendering output is shown in figure10d.however aschromedoesnotupdatethechildnode div it generates the incorrect rendering output figure 10c introduced bytherender update bug.
figure illustrates a potential negative consequence of this render update bug.considerascenariowhereawebsiteisselling a new laptop and users can view the laptop image by clicking a button.
the intended correct behavior is once the button is clicked the cssoffset path is removed and the laptop image should be placed below the button as depicted in figure 11b .
unfortunately as illustrated in figure 11a chrome fails to move the laptop imagedue to the render update bug disturbing users from viewing the laptop image.
related work browserlayouttesting.
previousresearchhassuggestedtesting methodstoaidwebapplicationdevelopersin f indingcross browser incompatibilities in their web applications .
they discovered cross browser incompatibilities in web applications by checkingwhethertwoindependently implementedbrowsersproducedifferentrenderingoutputsfromthesamepage.theydetermine the bug if two browsers produce different rendering outputs.
note that unlike the previous research metamong focuses on detecting render update bugs in web browsers not in web applications.
in addition metamong does not trigger any false positive 1084metamong detectingrender update bugs in webbrowsers through fuzzing esec fse december3 san francisco ca usa a actual result incorrect .
b expectedresult correct .
figure a possible negative consequence of the renderupdate bug by chrome issue .
the laptop image shouldbeplacedbelowthebuttononceclicked buttheimage doesnotmove due to thebug.
issue butthepreviousresearchsuffersfromthefalsepositiveissue duetobenigncross browserincompatibilities.anotherprevious research has used the manually implemented oracle with image comparisontechniquetodetecthtmlpresentationfailuresinweb applications .notethat metamong doesnotrequiremanualeffortanddomainknowledgetobuildtheoraclewhichisthe key contribution of our paper.
there is another work r2z2 which detects regression rendering bugs from web browsers.
it combines cross browser testing cross version testing and wpt tests to avoid false positive issues.
nonetheless it still suffers from the false positive issue due to the missing wpt tests.
lqc detectsrender update bugs in web browsers using differential testing.
it f irstupdatesthepage reloadstheupdatedpage andcompares pages before and after reloading.
it determines the bug if pages before and after reloading are different.
however this approach cannot detect render update bugs that dom events can trigger due tothecharacteristicofpagereloading.notethat metamong can detectrender update bugstriggeredbydomevents meaningbetter practical abilityinbugdetection.
browserlayoutveri f ication.
severalworkspartiallyformalized the browser layout algorithm .
they used static analysis techniquestoverifytheoverallimplementationofthebrowser s rendering component.
to do so they translated the html and css speci f ications into the formalized rules for the static analysis.however thisapproachhasthecriticallimiation writingthe formalizedrulesnot onlyrequiresdomainknowledgebut alsois very labor intensive and error prone.
in this respect this approach suffers from the false positive issuewhen the formalizedrulesare incorrectorinsufficient.
semanticbugfuzzing.
difuzzrtl proposesanewcoverage metric to capture the states of an rtl design and detect cpu bugs.
r2z2 combinesthecross browserandcross versiontestings todetecttheregressionrenderingbugsfromthebrowser.several works f indsemanticbugsinjavavirtualmachine jvm implementationsviadifferentialtesting .somestudiesleveraged the fuzzing to f ind the semantic bugs from the deep learning libraries .
automaticallyinferstherelationalapisto f ind the inconsistencies from the deep learning libraries.
leverages theopensourcetoinfertheapiinputparametertypesforeffective deeplearninglibraryfuzzing.pgfuzz proposesapolicy guidedfuzzer to detect policyviolations from robotic vehicle controlprograms.fuzzorigin proposesastaticorigintaggingmechanism to detectuxssvulnerabilitiesinbrowsers.
discussion sufficient number of mutation primitives.
metamong currently has three dom and one css mutation primitives.
comparedtoother domfuzzerssuchas domato andfreedom metamong leverages a few number of dom and css apis.
one might think using a small number of apis extremely limits the bug f inding.
however while evaluating the recall of render update oracle .
.
weobservedthatall28 render update bugscanbe triggeredby metamong smutationprimitives.thisshowsthatthe current implementation of metamong does not limit the renderupdatebug f inding.
lackofguidingmethods.
metamong employsdomatofuzzerto generatehtml f iles.
domatoisagrammar basedgenerationfuzzer anditdoesnotuseguidancemethodssuchascoverage guidingfor testcasegeneration.thus itispossiblethatthe render update bugis hiddendeepinthebrowser srenderingimplementationand domato fuzzer cannot generate the html f ile triggering the render update bug.however theunsuitableguidingmethodcanfurtherdisturb f indingbugs.forinstance freedomguidedbycoveragetriggers3.8x fewer crashes indom fuzzing compared to its generation fuzzing.
nonetheless wethinkleveragingasuitableguidingapproachwould de f initelyenhance metamong sbug f indingcapability.weleave this as future work.
conclusion thispaperproposed metamong a frameworktailoredfor detectingrender update bugs in web browsers without false positives.
metamong consistsoftwokeycomponents apagemutator and arender update oracle.thepagemutatorgeneratesthemutation primitiveschangingthedomtreeandcssstyles totrigger renderupdatebugs.
the render update oracle exploits an html standard rule yielding to detect render update bugs without false positives.
withtheprototypeimplementationof metamong itdiscovered19 newrender update bugsinchromeandfirefoxbrowserswithout false positives demonstrating its effectiveness and practical ability in f inding render update bugs.
data availability wedisclosedthesourcecodeof metamong andaswellasthedata usedinthispaperat .