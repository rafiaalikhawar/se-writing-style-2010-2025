kvs a tool for knowledge driven vulnerability searching xingqi cheng yangzhou university yangzhou china cinqi1026 gmail.comxiaobingsun yangzhou university yangzhou china xbsun yzu.edu.cn lili bo yangzhou university yangzhou china lilibo yzu.edu.cnyingwei yangzhou university yangzhou china qq.com abstract itisdifficulttoquicklylocateandsearchforspecificvulnerabilities andtheirsolutionsbecausevulnerabilityinformationisscattered intheexistingvulnerabilitymanagementlibrary.toalleviatethis problem weextractknowledgefromvulnerabilityreportsandorganize the vulnerability information into the form of a knowledge graph.
then we implement a tool for knowledge driven vulnerability searching kvs.
this tool mainly uses the bert model to realize the vulnerability named entity recognition and construct the vulnerability knowledge graph vulkg .
finally we can search vulnerabilities of interest based on vulkg.
the url of this tool is .
video of our demo is available at .
ccsconcepts software and its engineering softwaredefect analysis computingmethodologies information extraction .
keywords vulnerability knowledge graph bert namedentity recognition acm reference format xingqi cheng xiaobing sun lili bo and ying wei.
.
kvs a tool forknowledge drivenvulnerabilitysearching.in proceedingsofthe30th acmjointeuropeansoftwareengineeringconferenceandsymposiumonthe foundationsofsoftwareengineering esec fse november14 singapore singapore.
acm new york ny usa 5pages.
.
alsowithinstituteofcomputerscience heidelberguniversity heidelberg germany correspondingauthor also with state key laboratory for novel software technology nanjing university nanjing china permissionto make digital or hardcopiesof all orpart ofthis work forpersonal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation on the first page.
copyrights for components of this work owned by others than acm mustbehonored.abstractingwithcreditispermitted.tocopyotherwise orrepublish topostonserversortoredistributetolists requirespriorspecificpermissionand ora fee.
requestpermissions frompermissions acm.org.
esec fse november14 singapore singapore 2022association forcomputing machinery.
acm isbn ... .
introduction some famous vulnerability collection platforms such as cve common vulnerabilities and exposures and nvd national vulnerabilitydatabase arewidelyusedtosupportanalysisofsoftware vulnerabilities.thescaleofvulnerabilitiescontinuestoexpand and thenumberofvulnerabilitiesinthevulnerabilitymanagementdatabase increases.
since cve first included vulnerabilities in the number of vulnerabilities has been on the rise every year from in to in .
the increase in the number of vulnerabilitieshasmadeitdifficulttomanageandsearch.therefore whendeveloperswanttocomprehensivelysearchforvulnerabilities related to their own work they not only need to spend time finding similar vulnerabilities but also need time to analyze the relationships among related vulnerabilities.
this makes vulnerability analysisandfixing time consumingandlaborious.
in ordertoreduce the manual maintenance costofsoftware securityandimprovetheutilizationofdatainthepublicvulnerability management database we developed a tool called kvs.
the tool has three key components namely the vulnerability named entity recognition vulner part the vulnerability knowledge graph vulkg storage part and the vulkg visualization part.
we use vulner to extract knowledge from the vulnerability description and use the extracted information to build vulkg then perform further search operations based on vulkg.
achieving the purpose ofin depthanalysisofvulnerabilitydataincveandnvd along with improving the accuracy of search makes search results more intelligentandthe searchprocessmore effective.
usageexample kvsismainlybasedonthevulkgtosearchforvulnerabilities and its functionalarea is dividedinto three.
graphdisplayarea infigure mainlydisplaystheforcedirected graph realized by d3 data driven documents includingallthenodesandrelationships whichisthemajor part of the page.
graph information display area in figure is used to displaythe information of the currently selectednode.
user operation area includes node and text display mode switching infigure graphsearch infigure and multi legendmodelswitch infigure whichisthearea that userscan interact.
esec fse november14 singapore singapore xingqicheng xiaobingsun lilibo and yingwei kvs uses different legends to represent different types of nodes.
the information extracted by the named entity recognition ner task is represented by yellow nodes other vulnerability attributes are represented by green nodes and cwe id the type of cve representedbybluenodes.userscanzoominoroutofthegraph withthemousewheel.mousedraggingisalsoprovidedtoincrease interactivity.
when the mouse is placed over a node only nodes relatedtothecurrentnodewillbedisplayed infigure and all relevant information will be visible in texton the right side in figure .
figure1 theoverallinterfaceof kvs figure2 displayresult of a nodeselected by themouse vulnerability search is the most vital function of kvs which mainlyincludeskeyword basedsearchandidnumber basedsearch.
keyword based search means the user can enter any keywords he she wants to find as long as they exist in the graph.
figure shows the search based on the keywords.
when the user enters the race condition in the input box in figure the web page will return the search results.
however a search for race condition from the cve website 3will return a list of cve ids and their descriptions.
the information is unstructured and it is hard to capture key information.
compared with the search results displayedinthecvewebsitelist thegraphicalsearchresultsshown infigure 3displaykeyinformationandresultrelationshipsinan orderlymanner.asshowninfigure the racecondition isthe cause ofmultiple cves.
when hovering overa specificcve node the user can also view detailed information.
by comparing with suchsearchresults vulnerabilityanalysiswillbecomeeasierand more comprehensive.
figure search and display model switch example approach the overview of the kvs is shown in figure .
kvs obtains unstructuredandsemi structureddatafromcveandnvd.thenkvs performsfine grainednerusingthebert bilstm crfmodelfor unstructureddata.theextractedinformationtogetherwithsemistructured data forms entities and relation tables.
finally vulkg isvisualizedusingthefront endtechnique.thissectionoutlines each constructionstep andgives a detailedexplanation.
vulnerability reports vulnerability reports unstructured text summary semi structured text cwe id cvss score entity table relation table vulkg front end visualization crf bilstm bilstm bilstm bert w0w1 wn crf bilstm bilstm bilstm bert w0www0w1www1 wnwwwn figure overviewof the kvs .
data preparation inthissection wemainlydevelopedanewfine grainednerdataset forthevulnertask.weusethebig vuldatasetconstructedbyjiahao fan et al.
in as a data resource.
big vul crawls data on cveandnvdwebsites includessemi structuredtextsuchascwe id cvss score and unstructured text such as summary as shown infigure .this paperuses thesummaryinformation inbig vul for data labeling and constructs a fine grained vulner dataset.
summaryisaspecificdescriptionofeachcvevulnerability which ishigh qualityunstructureddatasource.afterpreprocessingthe summarydata whichisseparatethepunctuationandcharactersin thetext we use the preprocesseddata fordata labeling.
examples of data labeling are shown in table .
the number for the train set is915 thetestsetis102andthepredictionsetis4114.thispaper defines eight entity categories for vulner task namely version consequence attacker triggering operation location cause occurrence scenario and related issue.
the distribution of each entity category on the train andtestdata setsis shown in figure .
1732kvs atool forknowledge driven vulnerability searching esec fse november14 singapore singapore table datalabelingexample summaryinteger overflowin the pango glyph string set sizefunction in pango glyphstring.cin pango before .24allows context dependentattackers to causea denial ofservice via a long glyphstring that triggersa heap based bufferoverflow.
label cause integeroverflow location pango glyph string set sizefunction in pango glyphstring.c version pangobefore .
attacker contextdependent attac kers consequence a denial of serviceconsequence a heap basedbufferoverflow triggeringoperation a long glyph string .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
version consequence attacker triggering operation location cause occurrence scenario related issue trian test figure5 entities distributionfortrainand test set .
vulnerabilitynamed entity recognition vulner based on the eight entity types we defined the next step is to use natural language processing nlp technology to identify these entities.
ner is essentially a sequence labeling task in the downstreamtaskofnlp.weadoptthebiomethodtolabeleach sentence b ne indicates the beginning of an entity of type ne i neindicatesthemiddle includingtheend ofanentityoftype ne an predictthedistributionofnewsentencesandtheirlabelsthrough countlesssentences andtheirbiotags.
since google proposed the bert bidirectional encoder representations from transformers pre training model in itsexcellentperformanceindifferentdownstreamtaskshasmade the use of bert one of the mainstream choices for completing ner tasks.
therefore this paper introduces the bert base as a pre trainedmodel usingbilstm crf onthetopasthemodel architecturetoidentifyvariousentitiesofthecvesummary.the model architecture withbioexample is shown in figure .
.
vulkgstorage and visualization vulkg is composed of relationships and nodes.
the definition and number of nodes and relationships as well as the color of each typeofnode areshownintable .afterdataprocessing theeight entitiesidentifiedbyvulnerandtheselectedkeysareextracted to form entity tables and relation tables as shown in fig.
.
the o lstmb cause i cause o b location i location i location o lstm lstm lstm lstm lstm lstm lstm lstm lstm lstm lstm lstm lstm lstm bert .
clstmcrf layer forward lstmbackward lstm integer overflow in pango figure bert bilstm crf model definition of the relationship is the relationship between cve and entities extracted info selected keys cwe id thus the source node in each pair of relationships is the cve id the target node is one of the remaining nodes.
the relationship nameisthesameasthetargetnodename.vulkg containsatotal of nodes and relationships stored in a graph database called neo4j.
for the visualization of vulkg we combined d3.js to realize the front end visualization.
for searching with vulkg therealizationofthevisualquerymainlyconvertsthejsondata formatreturnedbyneo4jintothed3requiredformatandthenuses the d3 binding query event to search the results finally rendering the resultsandvisualizing themto the user.
table thenumberof nodes and relationships in vulkg nodes relationships extracted info yellow cause cve cause consequence 1567cve consequence version cve version location cve location attacker cve attacker triggering operation 1896cve triggering operation occurrence scenario224cve occurrence scenario267 relatedissue 107cve related issue keys blue publish date 838cve publishdate score cve score project cve project vulnerability classification54 cve vulnerability classification4114 commitid cve commitid update date 688cve update date idscweid cve cwe id cveid total experiments .
experimentalsettings the hardware environment of the experiment is gpu nvidia tesla t4 cpu inter r xeon r silver 4214r and the software environment ispython .
and pytorch1.
.the bertmodel uses 1733esec fse november14 singapore singapore xingqicheng xiaobingsun lilibo and yingwei thepytorchversion .themodelhas12layers 12headpatterns 768dimensional hidden layers and 110m parameters.
then connect different layers to form bert softmax and bert bilstm crf model.
the related parameters of the experiment are shown in table .
table experimental parametersettings parameter bert softmax bert bilstm crf maxlength batchsize learning rate .00e .00e dropout .
.
weightdecay .
.
gradient clipping .
experimental results in order to better evaluate the recognition results of the model we use the u1d45d u1d45f u1d452 u1d450 u1d456 u1d460 u1d456 u1d45c u1d45b u1d443 u1d45f u1d452 u1d450 u1d44e u1d459 u1d459 u1d445 and the u1d4391to evaluate the results separately.
the formula is as follows u1d443 u1d447 u1d45d u1d447 u1d45d u1d439 u1d45d u1d445 u1d447 u1d45d u1d447 u1d45d u1d439 u1d441 u1d4391 u1d443 u1d445 u1d443 u1d445 u1d447 u1d45drepresentsthenumberofentitiescorrectlyidentifiedbythe model u1d439 u1d45drepresentsthenumberofentitiesincorrectlyidentified bythemodel and u1d439 u1d441isthenumberofentitiesnotidentifiedbythe model.
after epochs the precision recall and f1 score of the two models are shown in table .
from the overall results aspect comparedwiththebenchmarkmodelbert softmax therevisedmodel bert bilstm crfhasaprecisionrateincreaseof2 arecallrate increaseof4 andanf1scoreincreaseof3 .fromtherecognition resultsofeachentityaspect bert bilstm crfisalsopowerful than bert softmax.this is because the bilstm layer adds semantic cohesion at the temporal level and the crf layer makes the predictedoutputlabelsofthesequencecorrelatewitheachother which is more conducive to the recognition of long entities such as location entity and consequence entity.
however there are also twotypesofentitieswithpoorrecognitioneffectscomparewith otherentities thatis occurrencescenarioentitiesandrelatedissue entities theirf1scoredoesnotexceed0.8inthetwomodels.the reason for the result may consider that these two types of entities have fewer training samples as shown in figure thus the model cannot learn their features well.
based on the results of this experiment the better bert bilstm crf model is used for entity prediction on the prediction set.
however the accuracy of the prediction resultscannotbemeasured.
thetwoner modelsused inthispaperperformwellinfine grainedentityrecognition but thereisstillalotofroomforimprovement.duetotherelatively furtherresearchcanconsideraddingmoretraining samplesto improve the recognition accuracy ofthe model.
table entities result and overallresult ontwomodels entitiesbert softmax bert bilstm crf p r f1 p r f1 version .
.
.
.
.
.
consequence .
.
.
.
.
.
attacker .
.
.
.
.
.
triggering operation .
.
.
.
.
.
location .
.
.
.
.
.
cause .
.
.
.
.
.
occurrence scenario0.
.
.
.
.
.
relatedissue .
.
.
.
.
.
overallresult .
.
.
.
.
.
relatedwork croft et al.
investigated the inconsistency over the software vulnerability reports and reported this inconsistency can significantlyreducetheperformanceofpredictingtasksbyupto77 .gao et al.
conducted the vulnerabilities evolution study based on androidbyreconstructinglineagesandapks.insecuritydomain knowledgegraphconstructionresearches thereweremanymodels and methods proposed.
du et al.
collected and integrated dataofcve maven andgithubtoformasoftwarevulnerability knowledge graph.
jia et al.
used stanford ner to recognize security related entities build a cybersecurity knowledge graph.
qin et al.
proposed the aarv model for automatic analysis and reasoning basedon vulnerability knowledge graph.
compare with the worksmentionedabove kvs uses differentdata sources.
moreover kvs defines more entity types to recognize and adds more vulnerability detailstothe knowledge graph.
conclusion in this paper we design a vulnerability search tool kvs based on theknowledgegraph.throughkvs userscanobtainthehidden relationshipbetweenvulnerabilities searchtherelevantknowledge fora certain vulnerability.