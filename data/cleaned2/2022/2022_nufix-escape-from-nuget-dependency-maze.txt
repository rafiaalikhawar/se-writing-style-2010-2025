nufix escape from nuget dependency maze zhenming li software college northeastern university shenyang china lzmneu .comying wang software college northeastern university shenyang china wangying swc .neu.edu.cnzeqi lin microsoft research asia beijing china zeqi.lin microsoft .com shing chi cheung the hong kong university of science and technology and guangzhou hkust fok ying tung research institute hong kong china scc cse.ust.hkjian guang lou microsoft research asia beijing china jlou microsoft .com abstract developers usually suffer from dependency maze dm issues i.e.
package dependency constraints are violated when a project s platform or dependencies are changed.
this problem is especially serious in .net ecosystem due to its fragmented platforms e.g.
.net framework .net core and .net standard .
fixing dm issues is challenging due to the complexity of dependency constraints multiple dm issues often occur in one project solving one dm issueusuallycausesanotherdmissuecroppingup theexponential search space of possible dependency combinations is also a barrier.
in this paper we aim to help .net developers tackle the dm issues.first weempiricallystudiedasetofrealdmissues learning their common fixing strategies and developers preferences in adopting these strategies.
based on these findings we propose nufix anautomatedtechniquetorepairdmissues.nufixformulates therepairtaskasabinaryintegerlinearoptimizationproblemto effectively derive an optimal fix in line with the learnt developers preferences.
the experiment results and expert validation showthat nufix can generate high quality fixes for all the dm issues with popular .net projects.
encouragingly projects including affected projects such as dropbox have approved and merged our generated fixes and shown great interests in our technique.
ccs concepts software andits engineering softwarelibrariesandrepositories.
ying wang and zeqi lin are corresponding authors.
permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation onthe firstpage.copyrights forcomponentsof thisworkowned byothersthan the author s mustbehonored.abstractingwithcreditispermitted.tocopyotherwise or republish topostonserversortoredistributetolists requirespriorspecificpermission and or a fee.
request permissions from permissions acm.org.
icse may pittsburgh pa usa copyright held by the owner author s .
publication rights licensed to acm.
acm isbn ... .
.org .
.3510118keywords .net nuget dependencies empirical study acm reference format zhenming li ying wang zeqi lin shing chi cheung and jian guang lou.
.
nufix escape from nuget dependency maze.
in 44th international conference on software engineering icse may pittsburgh pa usa.
acm newyork ny usa 13pages.
.org .
.
introduction .net is an open source development platform for building various types of projects e.g.
mobile apps microservices implemented using c f and vb .
microsoft provides a tool nuget for buildingprojectsandsharingpackagesonmultiple.netplatforms at a central repository nuget.org .
as of august nuget.org maintains over three million package versions.
withtherapidevolutionofthe.netecosystem managingdependencies in .net projects becomes a critical challenge.
this is mainly due to the fragmentation of .net ecosystem which makes dependency constraints between packages especially complicated there are nine actively used and updated platform variations e.g.
.net framework .net core involving platform versions .most.netpackagesarespecifiedtosometargetplatform versions while incompatible with other ones.
at different target platform versions a packagetypically requires different transitive dependencies.
as a package evolves new versions may require different dependencies or support different target platforms.
duetofragmentationof.netecosystem aproject sdependency graph can be greatly changed when developers upgrade migrate its .net platform or depended packages.
these changes can easily introducebuilderrors.basedonnuget sbuildrules thepackage installationsofaprojectwillbeblockedifthereareconflictingcon straints e.g.
constraints on package versions and target platforms imposed by the project or its depended packages.
in this paper we refer to such build errors as dependency maze dm issues.
figure shows a real dm issue and illustrates the complication in fixing it.
in figure a a .net project received a build error when upgrading its direct dependency easynetq.di to version .
.
.
this is because the upgrade introduced a new dependency ieee acm 44th international conference on software engineering icse authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhenming li ying wang zeqi lin shing chi cheung and jian guang lou project .net core .
.0easynetq.di.microsoft aspnetcore.app t6.
.
t2.
.
nu1107 version conflict detected for extensions.dependencyinjectionextensions.dependencyinjection extensions.dependencyinjection t2.
.
t2.
.
.
.
project .net core .
.0easynetq.di.microsoft aspnetcore.app nu1202 aspnetcore.app .
.
is not compatible with .net core .1extensions.dependencyinjection extensions.dependencyinjection t2.
.
t2.
.
.
.
.net core .
.0upgrade project .net core .
.
a series of build errorsupgrade t6.
.
t2.
.
project .net core .
.0easynetq.di.microsoft aspnetcore.app t6.
.
t2.
.
extensions.dependencyinjection extensions.dependencyinjection t2.
.
t2.
.
.
.
downgrade issue of easynetq... figure an illustrative example of issue in easynetq ofdependencyinjection version .
.
.thenewdependency however conflictedwiththedependencyof dependencyinjection version .
.
.
.
introduced by aspnetcore.app .a sa result the upgrade failed with an error code of nu1107.
toresolvetheconflicts developersfirsttriedtoupgrade aspnetcore.app toversion2.
.
whichdependsonanewer dependencyinjection version .
.
.
.
as shown in figure b .
however a new dm issue arose because aspnetcore.app .
.
targets.netcore2.
.0platform whichisincompatiblewiththe project s target platform .net core .
.
.
therefore they had to upgradeproject stargetplatformto.netcore2.
.0toresolvesuch a conflictas shown in figure1 c .
however the platformupgrade inducedmany changestothe project sdependencies.aseries of new build errors arose.
it is difficult to figure out a solution toresolve all these dm issues the developers finally rolled back all thechangesandfiledanissuereport to easynetq.di s developers seeking for assistance to downgrade its dependency of dependencyinjection to .
.
as shown in figure d .
the example illustrates the complexity of dm issues.
it also shows that dm issues can manifest themselves in multiple types with respect to different root causes see .
.
fixing a dm issue can be challenging.
multiple dm issues often occurinaprojectatthesametime.forthoseprojectswithlargedependency graphs fixing such issues is a time consuming and error proneprocessthatexercisesaseriesofchangesindependency constraints in response to newly induced dm issues.
among our collected dm issue reports from representative .net projects .
of them involves more than five simultaneous build errors error count varied from to and .
of them involves more than two error types see .
.
out of the issues have documented fixes.
on average each fix requires a combination of .
dependency changes and each change involves .5possiblechoicesinpackageversionconstraints whichinvolves alargesolutionsearchspace.moreimportantly whendecidinga fixingsolution developersoftenconsidertheirdesiredproperties of configuration e.g.
inducing fewer risky build warnings which are echoed by the discussions in many issues such as of aspnetcore .however it isdifficultfordeveloperstoimagine allpossibledependencygraphsaffectedbydependencychanges to figure out an optimal solution that satisfies their preferences.in this paper we aim to develop a technique to help .net developers tackledm issues.
we canformulate a dm issuescenario including installed and available package versions and user upgraderequirements buildrulesanddevelopers preferencesasa linearoptimizationproblemtofindfeasibledmissuefixingsolutions.toachievethis threetechnicalchallengesshouldbecarefully studied howtoformallydefinetheconfigurationpreferences in line with .net developers practices how to rigorously assign weights for the preferences encoded in a linear programming model how to find an acceptable fixing solutions that can induce build warnings based on nuget s build rules if the fully safe solutions do not exist.
the existing work adopted a linear programming model to resolve the package upgradeability problem for gnu linux based distributions.
however it cannot be directly adapted to repair dm issues since the three challenges are still unresolved in this approach see baseline comparisons in .
.
toaddresstheabovechallenges weproposeaneffectivetechnique nufix to repair dm issues.
nufix is built on top of ourcomprehensive study of developers preferences in fixing dm is sues.
since deriving a developer preferred solution typically requiresrichdomainknowledgeofdependencyconfigurations we first empirically studied a collection of real dm issue reports to learnthecharacteristicsoffixingstrategies.byencodingtheempiricalfindingsintoalinearoptimizationmodel nufixseeksfor the global optimal fixing solution.
furthermore we proposed a variantoptimizationmodelbasedonnuget sbuildrules toseek anoptimalsub solutionwhenafullysafesolutiondoesnotexist.
finally wecollectedasetofrealdocumentedfixesofdmissuesby .net developers as a training dataset to learn the role played by each preference in determining a solution.
ourevaluationshowsthatnufixcangeneratehigh qualityfixes forthedmissueswith262popular.netprojects.weinvitedten experienced .net experts working at microsoft to evaluate the quality our generated fixes.
their feedback indicates that thegeneratedfixesmeetthedevelopers desiredpropertiesforthebuild management.inparticular wefurtherreportedourgeneratedfixes tothecorrespondingprojectdevelopersfor validation.encouragingly project developers including affected projects such as dropbox have replaced their real fixes with the ones derived by nufix and shown great interests in our technique.
to summarize this paper makes the following contributions originality to the best of our knowledge we conducted the firstempiricalstudytolearnfixingstrategiesofdmissuesand developers preferences when deciding fixes.
technique we developed the nufix tool to efficiently derive fixes for dm issues satisfying developers preferences.
reproductionpackage weprovidedareproductionpackageon nufix s website forfutureresearch whichincludes adatasetof169dmissues studiedinourempiricalstudy abenchmarkcontaining392 documented fixes for real dm issues available nufix tool.
background .
fragmentation of .net ecosystem two types of fragmentations exist in the .net ecosystem.
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nufix escape from nuget dependency maze icse may pittsburgh pa usa packages in the .net ecosystem are mostly platform specific which target only specific versions of some .net platform variantsdifferent versions of a package may provide assemblies requiring different dependencies for the same target platform and support different .net platforms system.drawing.common nlog .
.
statistics supported platforms .net framework .
.
.
.
.
.net core and .net standard .
and .
.net framework client profile xamarin android xamarin ios u w p84 total downloads downloads of current version downloads per day avg .net framework .
no dependencies.
.net framework .
no dependencies.
.net standard .
microsoft.extensions.platformabstractions t1.
.
netstandard.library t1.
.
system.componentmodel.primitives t4.
.
.net standard .
system.componentmodel.typeconverter t4.
.
system.data.common t4.
.
...dependencies of different assemblies version history version downloads .
.
.
.
.
.
.
.
.
.
.
.
... rf.contracts .
.
supported platform .
n e t nlog .
.
dependencies .netstandard .
system.componentmodel.typeconverter t4.
.
system.data.common t4.
.
oonnnn nlog nlog .
.
dependencies .netstandard .
system.componentmodel.typeconverter t4.
.
system.data.common t4.
.
system.diagnostics.stacktrace t4.
.
supported platforms.net supports nine platform variations which are actively used and updated .net standard .net framework .net core universal windows platform uwp .
.
.
.
.
.
... various .net platformsversion evolution .
.
.
.
.
.
... .
.
.
.
.
.
... .
.
.
.
...installing a different .net platform version can introduce changes in different transitive package dependencies into a project s local environmenta .net platform may be incompatible with the packages targeting the other .net platforms and other vers ions of the same .net platform ... .net core .
.
local environmentremote packages netcore.dotnethostpolicy t .
.
netcore.platforms t2.
.
netstandard.library t2.
.
local environment .net core .
.
.net core .
.
libuv t1.
.
codeanalysis.csharp t .
.
netstandard.library t1.
.
log4net .
.
supported platforms .net framework .
.
.
incompatible.net platform version support .net core 1.
1.1 2.0 2.1 2. .
.
.net framework 4.
4.
.1 4.
.2 4.
.2 4. .
... uwp 8.
8.1 10.
10. .
t b d mono 4.6 5. .
4platform version .net standard .
incompatible with .net standard .
packages compatible with.net standard .
packages ... a b c dmono ... .
.
.
.
.
.
.
.
... dddddrf.contracts .
.
supported platform .net standard .
figure the severity of fragmentation in the .net ecosystem platform level fragmentation.
.net supports nine platform variations which are actively updated.
for instance five .net platforms including.netframework .netcore .netstandard mono anduniversalwindowsplatform uwp wereintroducedtosupportwindowsos.byaugust2021 thefiveplatformshave released versions .
two evolution characteristics across these versions lead to the platform level fragmentation problem installingadifferent.netplatformversioncanintroducechanges intransitivepackagedependencieswithspecificversionconstraints toaproject slocalenvironment.
figure2 a givesanexampleof thechangeintransitivedependenciesintroducedby.netcore platformtothelocalenvironmentfrom38packagesto3packages after upgrading the platform from version .
.
to .
.
.
a.netplatformmaybeincompatiblewiththepackagesthat targetother.netplatformsorotherversionsofthesame.netplatform.for instance packages targeting one of the four platforms including .net framework .net core mono and uwp areincompatible with the other three platforms.
as shown in figure2 b package log4net .
.12isincompatiblewith.netcore since it only supports the .net framework .
.
to broaden the.netpackageecosystem since2016 microsoftintroduced .netstandardplatformforpackagedevelopers toprovideaunifiedclasslibrarythatareavailablefordifferent.netvariations.
hence the packages targeting .net standard can be installed on multiple platforms.
nevertheless the uniformity of ecosystemhas not been realized since each .net standard version onlysupports limited versions of .net platforms.
figure c givesan illustrative example.
based on .net standard s documentation apackagetargeting.netstandard2.1canbeinstalled on.netcore3.0and3.
mono6.
anduwptbd whileitis incompatible with other platforms.
package levelfragmentation.
packagesinthe.netecosystem are mostly platform specific which target only specific versions of some .net platform variants.
each package version providesan isolated assembly for each supported platform version.
when building a package version nuget selectively installs an assembly compatible with the target .net platform version.
the set of dependencies required by each isolated assembly varies.
consider package nlog4.
.
described in figure d .
its assemblies that target .net framework .
and .
require no dependen cies whereas its assemblies that target .net standard .
and .
require and different dependencies respectively.
moreover different versions of a package may provide assemblies requiring different dependencies for the same target platform and supportdifferent.netplatforms.forinstance nlog4.
.
and nlog4.
.7requiredifferentdependenciesforthesametarget platform .net standard .
.
in another example the upgrade ofrf.contracts from .
.
to .
.
migrate its target platform from.netstandard2.1to.net5.
.thesepackagecharacteristics induce many variations across various .net platforms.
.
nuget dependency maze we briefly describe the dm issues numbered by nuget bnu1605 downgrading dependency due to the direct dependency priority rule suppose that different version constraints of the same package are introduced into a project as a direct dependency and transitive dependencies respectively.
based on nuget sdirectdependencypriority rule itinstallssuchapackage based on the direct dependency s version constraint.
nuget will reportanu1605error iftheresolvedpackageversionislower than its transitively introduced version constraint s .
bnu1107 unable to resolve dependency constraints between transitivepackages ifdifferentversionconstraintsofthesame package are introduced into a project as transitive dependencies nuget will report a nu1107 error when it cannot resolve a version satisfying all the constraints of conflicting dependencies.
bnu1202 packagedoesnotcontainanyassembliescompatible with the client project s target platform if a package does not authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhenming li ying wang zeqi lin shing chi cheung and jian guang lou containanyassembliescompatiblewiththeclientproject starget platform nuget will report a nu1202 error when installing it.
bnu1203 packagedoesnotsupporttheoswheretheclientproject runs .net packages can use configuration attribute runtime identifier to designate on which os they can be installed.
nuget will report a nu1203 error if the runtime identifier of a required assembly is inconsistent with the os where client project runs.
bnu1108 circulardependencyisnotallowed nugetwillreport anu1108error ifacirculardependency e.g.
pkga pkgb pkga is introduced into the project.
empirical study we empirically study the characteristics of dm issue fixing solutions with the aim to answer two research questions rq1 fixing strategies what are common practices for fixing dm issues?
what are challenges of figuring out a fix?
rq2 configuration preferences what are developers preferences when determining fixes for dm issues?
to answer rq1 we collected top popular .net projects on github by starcount and randomly selected subjects denoted as subjectset to mine dm issue reports from their issue trackers.
we focused on the build failures due to conflicting constraints imposed by build rules.
to identify the fixing strategies of dmissues weanalyzedtheirissuedescriptions developers discussions and fixes.
note that the rest collected .net projects not used in rq1 denoted as subjectset were adopted to evaluate our dm issue repair technique later see .
.
data collection step1 collecting .net projects.
we collected top popular .net projects from github based on their starcounts and from whichwerandomlyselected500subjectsas subjectset .figure3 shows the projects demographics.
they are non trivial in size on average having .
kloc well maintained on average having239 codecommits popular ofthem have over stars complicated in dependencies .
of themhave more than direct dependencies diverse concerning projects targeting nine types of .net platforms .step2 collecting dm issues.
we collected dm issues from the projects in subjectset .
to locate dm issues we searched the projects for the issue reports filed between may and may2021 i.e.
in the past three years using keywords version conflicts incompatibletargetplatform andbuilderrornumbers e.g.
nu1107 .thoseissuereportsthatdonothaveaclearerrornumber werefoundbythefirsttwokeywords.keywords versionconflicts incompatibletargetplatform andinstallationerrornumbersreturned1 922and1 012issuereports respectively.weremoved duplicated reports from the search results and then retained those that explain the issues as well as their root causes.
eventually wecollected169dmissuereports covering116.net projects.
among them issues have fixes and issues have clear fixing plans agreed by developers.
there are .
issues thatcancauseoverfivebuilderrors.notethatthesereportsmay notcontainthenewbuilderrorsintroducedbythefixingprocess.
figure4showsstatisticsofthe167issuereports where nirdenotes thenumberofissuereportscontainingeachtypeofdmissues.for .net core .net framework .net standard mono uwp xamarin.iso xamarin.mac xamarin.android unity figure demographics of the subjects log scale number of dm issues in each issue report number of dependency changes in each issue report figure statistics of the dm issue reports log scale each issue type maxandavgdenote the maximum and average issue count in an issue report respectively.
each report on average describes7.1issues where42 .
reportsdescribemorethan two issue types.
for the issue reports with fixes the number of involved dependency changes varies from to i.e.
.
.
.
step3 dataanalysis.
toanswerrq1 weperformedanin depth analysis on fixes of the issues planned solutions of the remaining issues and comments in the issue reports.
we followedan opencoding procedure a widely usedapproach for qualitative research to categorize the fixing strategies and configuration preferences discussed in issue reports.
initially two authors of this paper who have over three years .net development experience independently analyzed the fixes and developers discussions of85issuereports.afterthefirstroundofanalysisandlabeling thetwo authors gathered to compare and discuss their results in order toadjustthetaxonomy withthehelpofathirdauthortoresolve conflicts.
in this manner we constructed the pilot taxonomy.
next thefirsttwo authorscontinuedtolabel thefixesordiscussionsof the remaining issue reports and iteratively refined the results as wellasthelabelingstrategy.theconflictsoflabelingwereagain discussed during meetings and resolved by the third author.
we adjusted the pilot taxonomy and obtained the final result.
.
rq1 fixing strategies viaanalyzingourcollecteddata weobservedthreefixingstrategies.
strategy upgrading downgrading the direct dependencies that directly or transitively introduce the problematic package versions .thisstrategywasadoptedby116 .
ofissuereports to resolve five types of dm issues.
for example in issue project installer directlyreferencespackage netcore.app with constraint .
.
and transitively depends on netcore.app again with .
.
via package reverseproxy .
nuget resolves authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nufix escape from nuget dependency maze icse may pittsburgh pa usa netcore.app s version as .
.
based on the direct dependency s constraint .
.
i.e.
direct dependency priority rule .
it then reports a nu1605 error since reverseproxy has to reference a lower version of netcore.app than it expects.
developers faced thechoiceoftwopossiblesolutions upgrading netcore.app to .
.
downgrading reverseproxy to a version that was compatible with netcore.app .
.
.
they adopted solution as their project was incompatible with netcore.app .
.
.
whilestrategy1canfixtheoriginaldmissues itmayintroduce multipletypesofnewdmissues.eachdirectdependencyupdate can affect the rest of a project s dependency graph introducing multiple types of new dm issues e.g.
issue o f easynetq as discussed in .
as a result developers may need to change more dependencies to resolve the new dm issues.
lightbulbfinding upgrading downgradingthedirectdependenciesthatintroducethe problematicpackage versionsis themost commonstrategy to fix all types of dm issues.
the fixes can induce new dm issues.
strategy adding direct dependencies with appropriate version constraints to override the problematic package versions .
.
of issue reports adopted this strategy to solve nu1107 issues.
for example in issue two conflicting constraints .
.
and .
.
on newtonsoft.json weretransitivelyintroducedby directdependencies tokens.jwt .
.1and sdk.functions .
.
respectively.withtheaidofnuget s directdependencypriority rule developersexplicitlydeclared newtonsoft .json .
.1asadirect dependency to override its other required versions.
after the overriding these packages can be successfully installed.
while the originalnu1107issuewasresolved nugetgeneratedanewnu1608 warning that the installed version .
.
of newtonsoft.json exceededtheconstraint .
.
specifiedby sdk.functions .
.
.
at the end the developers chose to ignore the warning and enable the nowarn property for nu1608 in the configuration file.
weobservedthatallthe61issuereportssolvednu1107issues usingstrategy2 atthecostofinducingnu1608warnings.asdiscussedinissue 18of servicefabric sinceitsdeveloperscould not figure outhow tofix theirnu1107issues using strategy they temporarily tolerated the nu1608 warnings induced by strategy .
lightbulbfinding addingdirectdependenciesisacommonstrategytofix nu1107 issues.
however it often causes nu1608 warnings.
strategy3 upgrading migratingtheclientproject stargetplatform .
.
of the issue reports solved nu1202 issues by upgrading migrating the client project s target platform.
for example in issue o f unmocakable a project got an error when installing unmocakable .
.
.
the above package only supports.netstandard2.
whichisnotcompatiblewiththeproject s target platform .net core .
.
.
by analyzing the interactive compatibilitymatrix of.netstandard developersupgradedtheir target platform to .net core .
.
compatible with .net standard .
in order to work with the desired unmocakable version.
sincepackagescontain multipleassemblieswithdifferenttransitive dependencies that support different target platform versions strategy may greatly affect client project s dependency graph.
weobserved that8 out of10 issue reportsadopting strategy to solve nu1202 issues introduced a series of new dm issues e.g.
issue 1039of refit .insuchcases developerscontinuedtofix the new issues using a combination of strategies 2and3.
lightbulbfinding3 upgrading migratingtargetplatformissometimesadopted to fix dm issues.
however the fixes can have large impact to dependencies and tend to induce new dm issues.
finally in30outof169issuereports developerscannotfigure outfixing solutions.
theyhaveto coordinatewiththedevelopers of problematicpackages to adjusttheir configurations.
we donot consider this solution as a recommended strategy since it requires developer coordination and is not subject to full automation.
.
rq2 configuration preferences for rq2 we found clues for developers configuration preferences in issue reports and summarized as follows avoid inducing incompatibility issues.
in of the issue reports .
toavoidinducingincompatibilityissuesatruntime developers tend to adopt a combination of fixing strategies with two preferences below.
preference fewer upgrades downgrades of dependencies major versions .
based on the semantic versioning strategy developers are suggested to increase their projects major version number if they make incompatible api changes.
whenexploring dm issue solutions developers tried to make fewerupgrades downgrades that change direct dependencies major versionstoavoidincompatibilityissues.theaboveviewpointwas discussed in six issue reports e.g.
issue of easynetq .
preference2 fewerchangesindirectdependencies versions .
developers favored fixing solutions with fewer changes in the version constraints of direct dependencies because this can usuallylowerthechancesthatincompatibilitiesariseafterresolving dm issues.
moreover upgrading is preferable to downgrading if eitherofthemcanresolvedmissues.developersexpressedsuchapreferenceintenissuereports e.g.
issue 153of androidx .
avoidaffectingprojectmaintainability.
weobservedthefollowingthree preferencesused in38 ofthe 54issue reports .
for the sake of project maintainability.
preference fewer installed packages .
introducing too many packages into a project will complicate the topological structureofitsdependencygraph.hence developerspreferto install the package versions with fewer transitive dependencies to prevent potential dm issues.
such preference was echoed by discussions in seven reports e.g.
issue of standard .
preference4 fewerinstalledpackagestargetinginconsistent.net platform with client project .
many .net standard packages can be directly or transitively introduced into the .net core .net framework uwp mono projects.
while the projects targeting .net standard .
and above can install specific versions of .net framework packages.
since each .net standard version supports limited versions of other .net platforms introducingmorepackagestargetinginconsistentplatformwith client project would be more likely to cause dm issues when theprojectsupgrade migratetheirtargetplatformsinfuture.toease maintenance developers try to ensure that more packages introduced in their projects support the same .net platform as the localones.suchpreferencewasrevealedinsevenissuereports e.g.
issue of aspnetcore .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhenming li ying wang zeqi lin shing chi cheung and jian guang lou preference fewer risky build warnings .
in issue reports developersexpressed thattheydid notwant to adoptthe solutions inducing the build warnings below into their projects exclamation trianglenu1608 package version is outside of dependency constraint when different version constraints of a package are introducedasadirectdependencyandtransitivedependencies respectively nuget resolves such package version based on the directone.anu1608warningwillbereportediftheresolvedversion of a package is outside of its other dependency constraints.
weobservedthatdevelopersrolledbackfixing strategy2 when exploringsolutionsfornu1107issuesinfiveissuereports e.g.
issue 5696of aspnetcore becausetheycouldnottolerate the risky nu1608 warnings induced by such solutions.
exclamation trianglenu1103 nostablepackageversionsarefoundintheversion constraint if there are no stable versions within a package s specified version constraint but only pre release versions e.g.
.
.
beta nuget will reports a nu1103 warning.
since the pre release package versions were not reliable developersdid not adopted the fixing solutions introducing such nu1103 warnings in six issue reports e.g.
issue of corefx .
exclamation trianglenu1701 package does not specify its target platforms if an introduced package does not specify its target platforms nuget will reports a nu1701 warning as its assemblies may not be compatible with the client project.
to avoid potentialincompatibility issues developers gave up the fixing solutions thatcausednewnu1701warningsandadoptedotheronesinfive issue reports e.g.
issue of googlecloudplatform .
methodology from our empirical study we understand the pervasiveness and seriousnessoftheproblem andlearntheatomicfixingstrategies and developers preferences from real dm issue fixes.
motivated byourempiricalfindings thesolutiondesignisexpectedto meetfourproperties modelingabilitytorepresentvariousdependency constraints .
problematic projects with multiple dm issues .
and potential fixes composed of multiple atomic fixing strategies .
learning ability to better adapt developers preferencesby distillingcharacteristics ofreal dmissue fixes .
online inference efficiency to derive the fixes within users acceptable waiting time.
based on the above analysis we propose nufix a novel technique to derive fixes for dm issues.
the key idea is to leverage binary integer linear programming upon which we can systematicallyreformulatethistaskandencodeourempiricalfindings i.e.
fixingstrategiesanddevelopers preferences intolinearconstraints andoptimization functions.binaryinteger linearprogrammingis a well studied technique that meets our efficiency requirements.
moreover totunehyperparametersrigorouslybylearningfromreal documentedfixes weincorporatebayesianoptimizationintoour model to optimize the hyperparameters in a non gradient manner.
.
overall architecture figure gives the overall architecture of nufix.
we list the inputs of nufix as follows dependency configurationinput output test validation dependency maze graph optimization model for seeking safe fixes optimization model for seeking risky fixes bayesian optimization for tuning hyperparameters candidates platforms and package versions top kfixes fix report developers customizations ci tools refine inputs figure architecture of nufix problematic dependency configuration file i.e.
.csproj .
it configures the client project s direct dependencies and the specified version constraints on them.
candidatetarget.netplatforms.itisanorderedlistofacceptableplatforms sinceoneofourfixingstrategiesistoupgrade migrate client project s target platform strategy .
candidate range of direct dependencies versions developers re quirements optional .
nufix allows developers to customize theirpackageupgraderequirements orthesearchscopeofpackage versions to avoid inducing undesired program behaviors.for example developers may want to specify the version of lucene.net tobelimitedwithin .
.
.
.
iftheyarealready aware of the incompatible versions .
.
through experience.
onealternativedesignistoonlyconsiderthepackageversions without introducing api breaking changes but this is too strict itisacommonpracticethatdevelopersmaybewillingtoresolve the dm issues at an acceptable cost of adapting the api changes.
nufix mainly consists of modules generating dependency maze graph .
.
given a target platform and the dependency configuration with customizedpackage versions this module generates a dependency mazegraph consisting of all possible dependencies both direct and transitive and the constraints among them.
seeking safe fixes .
.
given a dm graph this module tries to seek the fixes that does not introduce risky build warnings refer to as safe fixes .
these fixes are based on strategy upgrading downgrading direct dependencies the most commonly adoptedstrategyinourempiricalstudy finding1 .toaddressthe combinatorial explosivesearch space problem we firstpropose toformulatetherepairtaskasabinaryintegerlinearprogrammingmodel andthenwecanobtainthefixesusingmathematical optimization solvers in nufix we use python mip .
seekingriskyfixes .
.sometimesthereisnosafefix.therefore we propose a variant optimization model to seek fixes that may introduce some risky build warnings nu1608 nu1103 and nu1701 .
this model allows not only strategy but alsostrategy adding direct dependencies to override the problematic package versions .
tuning hyperparameters .
.
the aforementioned two optimizationmodelsinvolvesomehyperparameters.inthismodule we tune these hyperparameters based on bayesian optimization.
note that this is an offline step.
generating fix reports .
for each dm graph this module reports the top kfixes.
to help developers understand the derived authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nufix escape from nuget dependency maze icse may pittsburgh pa usa fixes nufixalsoreportstheirproperties e.g.
alistofbuildwarnings induced by this fix .
the developers can review these fix reports to choose their preferred one.
nufix also provides a test validation feature that triggers client project sbundledtestcases.thishelpsdevelopersawareofprogram behavior changes induced by the fix.
this is an optional step as it is time consuming to re compile the project and trigger its tests.
.
dependency maze graph consideradirectedgraph g v e withvthesetofverticesand e i j i j v the set of edges each vertex v vdenotes a package version e.g.
nlog4.
.
.
weusetwoattributes v.pkgandv.vertodenotethepackage andtheversion respectively.eachedge e i j eindicates thatidirectly depends on j.pkg andj.versatisfies the version constraintspecifiedby i.weexcludethepackageversionsthat may lead to nu1202 errors or nu1103 warnings.
weuseaspecialvertex v vtorepresenttheclientproject.for each vertex vsatisfying v v e it means that this project depends on v.pkg andv.veris a candidate version of v.pkg for this project.
for each v v there is always at least one path fromv tov.
moreover to handle the transitive dependencies of platform figure2 a thespecifiedplatformwillalsobeadded as a successor vertex of v .
giveng ourmaintaskistofindaset v v whichrepresentsa dependency both direct and transitive configuration of the client projectthatcanresolvedmissues.foreach v nufixautomatically generates the corresponding fix.
.
seeking safe fixes weformulatetherepairingtaskasabinaryintegerlinearprogramming model as follows.
variables.
for each v v we introduce a binary variable v. i.e.
v. representingwhether vshould bea dependency either direct or transitive in the fix v v v v v. constraints.
first v .
.
second each project will not depend on more than one version of the same package according to nuget s build rules i.pkg p summationdisplay.
i vi.
p v.pkg v v third for each vertex in v i.e.
the variable of this vertex takes thevalue1 wedivideitssuccessorsintoseveralgroupsbythepkg attribute.
for each group there should be one and only one vertex that is in v. these constraints guarantee that for each package inthefinalsolution itsdependencyrequirementswillalwaysbe satisfied.
formally we have v i e i.pkg p summationdisplay.
i vi.
v. v v p v prime.pkg v v prime e last transitivedependenciesshouldconformtothe lowestapplicable version rule in nuget dependency resolution j i e summationdisplay.
j vj.
ilb j i i. i v v v e v whereilbis an indicator function of whether or not i.veris a lowestapplicationversionof i.pkgforj.thisconstraintguaranteesthat dependency configuration vis entirely based on strategy upgrading downgrading the direct dependencies .
objective function.
we design the objective function based on the identified preferences discussed in .
.
to encourage preference developers prefer fewer dependency upgrades downgrades crossingtheir major versions we incorporate it into our objective function as a factor maxz1 summationdisplay.
v vv.
imv v whereimvis an indicator function of whether or not v.pkgis a direct dependency and v.vershares the same major version as the original version.
to encourage preference developers prefer fewer changes on direct dependencies versions we have maxz2 summationdisplay.
v vv.
iu v maxz3 summationdisplay.
v vv.
id v whereiu idis an indicator function of whether or not v.pkgis a direct dependency and v.veris greater lower than its original versionintheproblematicconfigurationfile.weuseindicatorfunctionsiuandidto distinguish between upgrades and downgrades.
to encourage preference developers prefer to introduce fewer packages in project s dependency graph we have maxz4 summationdisplay.
v vv.
to encourage preference fewer installed packages targeting inconsistent .net platform with client project we have maxz5 summationdisplay.
v vv.
c v whereicisanindicatorfunctionofwhetherornot vtargetsinconsistent .net platform with client project.
in this section we ignore preference introducing fewer warnings because this model will never introduce warning.
we define our overall objective function as maxz summationdisplay.
k 1 k zk where 1 2 3 4 5 summationtext.
i 1 i are hyperparameters.
.
details the tuning hyperparameter procedure.
.
seeking risky fixes sometimesitisinfeasibletofindsafefixes.therefore inthissection we propose a variant model that can seek risky fixes i.e.
fixes that may introduce build warnings .
as introduced in .
we need to considerthreetypesofbuildwarnings nu1608 packageversion isoutsideofdependencyconstraint nu1103 nostablepackage versions are found in the version constraint nu1701 package does not specify its target platforms .
tofindfixeswithnu1103andnu1701 weallowunstableversions denoted as vnu1103 and versions that do not specify their target platforms denoted as vnu1701 i ng.
we have maxz6 summationdisplay.
v vnu1103v.
maxz7 summationdisplay.
v vnu1701v.
it is challenging to find fixes with nu1608 because nu1608 means that some constraints in equation will be violated.
concretely equation should be relaxed as i.pkg p summationdisplay.
i vi.
v. .
authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhenming li ying wang zeqi lin shing chi cheung and jian guang lou this relaxation makes the model intractable because the search space explodes and we cannot trace the number of violated constraintsinequation3.toaddressthisproblem weintroduceanauxiliarybinaryvariable xv pforeachv v v andp v prime.pkg v v prime e .thisvariableindicateswhetherornot v sdependencyconstraint onpis violated.
then we have another relaxation for equation xv p v i e i.pkg p summationdisplay.
i vi.
v. .
we want to violate constraints in equation as few as possible maxz8 summationdisplay.
v pxv p similar to z equation the overall objective function of the variant model for seeking risky fixes is maxz prime summationdisplay.
k 1 prime k zk .
tuning hyperparameters we use bayesian optimization to tune the hyperparameters in our models 1 ... 5 for safefixes and prime ... prime for riskyfixes.bayesianoptimizationisaglobaloptimizationalgorithm built upon bayesian inference and gaussian process that attempts to find the maximum minimum value of a black box function in as few iterations as possible.
here black box means that we do not have access to the gradient of our models with respect to .
to start a bayesian optimization task we need to specify the function ftobeoptimized.intuitively wewishtofindan that makes the fixes returned by our model as similar as possible to realfixesprovidedbydevelopers.concretely consideratraining datasetdconsisting of some pairs in the form of g v gis a dm graph and vis thereal fix this trainingdataset isdetailed in sec .
.
then we have minf summationdisplay.
g v d z g z g v wherez g is the maximum value of the objective function z that our model solves given gand .
evaluation we study two research questions in our evaluation section rq3 effectivenessof nufix how effective is nufix in fixing dm issues for .net projects?
rq4 usefulness of nufix do the fixes generated by nufix make sense from practitioners perspectives?
to answer rq3 we constructed a high quality benchmark to evaluate nufix s capability of fixing dm issues.
toanswerrq4 weinvitedtenexperienced.netexpertsfrom industry to manually validate the fixes generated by nufix and furtherreportedourgeneratedfixestothecorrespondingproject developers in open source community for validation.
.
benchmark construction weconsideredthe2 .netprojectsin subjectset 2assubjects.by mining these projects code commits on github we constructed a high qualitybenchmarkconsistingofrealcommitsforresolving dm issues.
specifically we filtered commits based on four criteria commits with dependency changes were filtered out.number of dm issues in each issue report number of dependency changes in each issue report .net core .net framework .net standard mono uwp xamarin.iso xamarin.mac xamarin.android unity0 figure statistics of instances in our benchmark log scale table statistics of documented fixes in our benchmark nu1605 nu1107 nu1202 nu1203 nu1108 nir max avg .
.
.
.
.
table statistics our training and test datasets training dateset fixes inducing warnings fixes not inducing warnings nu1608 nu1103 nu1701 test dataset fixes inducing warnings fixes not inducing warnings nu1608 nu1103 nu1701 some fixes induce more than one types of warnings.
weonlykeptthecommitswhoselogsexplicitlystatedthatthe revisions aimed to upgrade migrate the projects platforms.
this is based on our empirical finding that platform changes often trigger more complicated dm issues.
for each project we manually upgraded migrated the project to the specified new platform.
only commits which could reveal dm issues were kept.
the final benchmark consists of angbracketleftinput fix angbracketrightinstances inputis a tuple angbracketleftc p0 p1 r angbracketright.
specifically cis a set of packages paired with their specified versions extracted from the problematic configuration file before merging the commit p0 is the original .net platform before updating p1is the target .net platform after merging the commit ris the constraints of packageversions.notethat tobefairincomparisonwithreal fixes rexcludesallpackageversionsthatwerereleasedafterthe timestamp of code commit.
fixisasetofdependencychanges.weshouldnotdirectlyuseall changeddependenciesofthecommitas fix becausenotallthese changesare toresolvethedm issues.assuch wedefine fixas theminimumsubsetofdependencychangesinacodecommit satisfying that the subset can tackle the dm issue in p1.
asshowninfigure6andtable1 theinstancesinbenchmark cover five types of dm issues and involve the projects targeting ninetypesofplatforms.eachinstanceconcerns8.2dmissueson average.thenumberofdependencychangesconcernedineachfix varies from to i.e.
.
.
.
.
rq3 effectiveness of nufix webrieflydescribetheexperimentdesignandresultsinthissection.
toeasepresentation werefertothefixesderivedbynufixas n fix and a fix derived by developers in our benchmark as a real fix.
data splits.
according to approaches a sample size ten times the number of hyperparameters is reasonable for training.sincenufixrequires13hyperparameters werandomly heldout of the instances as the training dataset for tuning authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nufix escape from nuget dependency maze icse may pittsburgh pa usa table tuned hyperparameters used in our object functions seeking safe fixes 1 ... 5 .
.
.
.
.
1 z1 2 z2 3 z3 4 z4 5 z5 .
.
.
.
.
seeking risky fixes prime ... prime .
.
.
.
.
.
.
prime z1 prime z2 prime z3 prime z4 prime z5 prime z6 prime z7 prime z8 .
.
.
.
.
.
.
.
hyperparameters.
the rest of them are regarded as the test dataset.
statistics of two datasets are described in table .
evaluation metrics.
we define four evaluation metrics below fr fixingratio theproportionofdmissuecasesforwhichthe technique can derive fixes.
sfr safelyfixingratio theproportionofdmissuecasesfor which the technique can derive safe fixes.
tpr testpassing ratio the proportion ofderived fixesthat can pass the projects bundled tests.
similarity howsimilararethederivedfixestothecorresponding real fixes.
we define similarity based on iou similarity changesn changesr changesn changesr wherechangesnandchangesrarethechangesinducedbythe derived and real fix respectively.
we define two types of simi larity based on how the equivalence operator between two de pendency changes a type a two changes will be regarded equivalent iftheysharethesamepackage majorversion and directdependencyconstraints b type b twochangeswillbe regardedequivalent iftheysharethesamepackageandmajor version.
for each instance in our benchmark we averaged the similarity values of the top k derived fixes as the result.
comparison.
twobaselineapproachesareconsideredinourstudy cudf for .net cudf isproposedtoresolvethe package upgradeabilityproblemforgnu linux baseddistributionsusingalinearprogrammingmodel.weadaptittoderivedmissuefixes denotedas c fixes byencodingnuget sbuildrules.itdefines fiveuserpreferencestoexploreconfigurations.weonlyconsider three of them fewer newly installed packages fewer changes in direct dependencies andfewer packages that are not up to date whiletheresttwopreferencesarenotapplicabletonuget sbuild rules.incudf theweightsofuserpreferencesarenotrigorouslydefined.assuch weadopttheempiricalweightsassignedforthe above three user preferences in approach v where v is available version count of required packages.
pydfixfor.net pydfix isproposedtofixunreproducibility in python builds caused by dependency version errors.
we adoptittoderivefixesfordmissues denotedas p fixes based on nuget s build rules.
pydfix considers the available versions of packages that cause dm issues as the search space of fixing strategies.such strategiesaresorted bythehighest versionpriority.
it iteratively tries out each fixing strategy and then adds it intoadocumentedfixifsuchastrategycanrepairatleastone unresolved dm issue.
this procedure continues until all the dm issuesareresolved orallthefixingstrategieshavebeentested.notethatineachiteration itre buildstheprojecttoverifythe fixingstrategy.sincesuchaprocessiscomputationallyexpensive we set pydfix s time budget to be minutes.table nufix s effectiveness on dm issue fixing fr sfr tpr nufixcudfpydfixnufixcudfpydfixbenchmark nufixcudfpydfix difficult .
.
.
.
.
.
.
.
.
moderate .
.
.
.
.
.
.
.
.
easy .
.
.
.
.
.
.
.
.
average .
.
.
.
.
.
.
.
.
time avg nufix .
seconds cudf .
seconds pydfix .
minutes similarity nufix cudf pydfix type atype btype atype b type a type b difficult .
.
.
.
.
.
moderate .
.
.
.
.
.
easy .
.
.
.
.
.
average .
.
.
.
.
.
difficult cases ns moderate cases ns easy cases ns t figure distribution of five properties of n fixes and real fixes hyperparameters.
table2showsthetunedhyperparameters by applyingbayesianoptimizationalgorithmtoourtrainingdataset.
to understand how nufix balances the developers preferences we compared the average value of each weighted preference based factor i.e.
k zkand prime k zkfor our two optimization models respectively which indicates the factor influence for seeking fixes.
fromtable3 wecantellthatfor.netpractitioners ensuring the compatibility of packages indicated by k plays a leading role in dm issue fixing in practice dependency upgrades k are preferable to downgrades k nu1608 warnings indicatedby k aremuchmoreintolerablethannu1103and nu1701warningsfordevelopers developersindeedpreferto install packages as few as possible k and introduce fewer packages targeting inconsistent .net platform with their client projects k but these two preferences are not the top priority.
results.table4showstheevaluationresults.toeasediscussion wefurtherdividedourtestingdatasetintothreegroupsbasedon their difficulties by dependency changes nsin real fixes .
nufix generates fixesfor each .netproject within12.
seconds and achievesa100 frfortheinstanceswithdifferentdifficulties.
.
n fixesaresafefixes ofwhichthesafelyfixingratioishigherthan real fixes .
.
while cudf achieves fr sfr .
since it does not support a variant model to seek risky fixes if safe fixes do not exist.
in contrast pydfix exhibits poor performance in our evaluation.
the main reason is dm issues in .net ecosystem ismuch more complicated than those in python ecosystem on av erage .
dependency changes for fixing unreproducibility in a pythonbuild v.s.
.
.9dependencychangesinarealfixof our benchmark thus the iterative search methodology of pydfix is insufficient to deal with the exponentially large search space.
forthe192outof262instanceshavingbundledtestcases we deployed their ci tools to further evaluate whether n fixes would authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
icse may pittsburgh pa usa zhenming li ying wang zeqi lin shing chi cheung and jian guang lou cause test failures.
encouragingly nufix achieves .
tpron average owing to its well defined objective function i.e.
prefer fewerupgrades downgradesofdependencies majorversionsand fewer changes in direct dependency versions .
the above tprcan be improved via iteratively refining the search scope of package versions by developers.
however cudf and pydfix do not restrict their algorithms to seek solutions with fewer package upgrades downgradescrossingmajorversions.instead theyreward thefixeswithmoreup to datepackages.asresult onaverage they achieve .
and .
tpr respectively.
nufix achieves the type aandtype bsimilarities of .
and .
respectively whichsignificantlyoutperformsthebaseline approaches.
figure shows the distribution of five properties of the generated fixes.
we can observe that n fixes can better satisfypreferences and2than real fixes which is indicated by the fact thatp prime p1andp prime p2are significantly greater than for nufix preference3 isasecondaryfactorcomparingto preference and a s p prime p3varies from to for cudf most of p prime p2 andp prime p3are greater than and close to those of n fixes since it considers properties and3as user preferences.
cudf and pydfixprefertoinstallnewestpackageversionsanddoesnottake properties and4into account.
as such its p prime p1andp prime p4are significantlylowerthanthoseofn fixes.
p5andp prime 5indicatethat n fixes induced far fewer build warnings than c fixes p fixes and realfixes low similarity doesnotnecessarilymeanthatn fixes arenotgood astheabovephenomenaaremoresignificantwhen thesimilarity is low.
to further understand these n fixes with low similarity we performed expert validation in .
.
.
rq4 usefulness of nufix inthisresearchquestion weaimtovalidatetheusefulnessof nufixbymeansofthefeedbackfrom.netexpertsandprojectdevelopers.
setup for expert validation.
a dm issue can have multiple fixing solutions.
as such we want to evaluate if a fix generated by nufix is valid even if it differs significantly from the real fix.
to conducttheevaluation weinvited.netexpertsfromindustryto manually assess the generated fixes.
participants.
weinvitedten.netexpertswithoverthreeyears development experience from microsoft to participate in our study.
subjects.all the top fixes generated by nufix in .
were selectedif their similarity eithertype aorb withthecorresponding real fixes is less than and they do not result in test failures.
pairs of n fixes and real fixes were selected.
procedure.
theformalstudysessionwassupervisedbytwoauthors.weprovideda10 minutebriefingtothetenparticipants on the two tasks before starting the tasks.
task1.backgroundinformationcollection.
wecollectedfrom the participants their experience in years the .net platforms that they have worked on and whether they haveencountereddmissues intheirprojectsinthe pastthree months.
we collected the information to investigate whether the participants had experience in dealing with dm issues.
task .
fix assessment.
each participant was assigned to examine or fix pairs.
the participant was asked to choose the preferred fix in each fix pair.
to facilitate that the participantwasgiventheoriginaldependencyconfigurationaswellasthe dmissuesaroseforeachfixpair.wealsoprovidedeachparticipant a visualization of the package dependency graph after adopting a fix.
the graph contains the updated packages and the information of their five properties figure as auxiliary info.toavoidbiasedresults wedidnotdisclosetoparticipants which of the fix in a fix pair is the real fix or the n fix.
setup forproject developer validation.
wefurthervalidated the usefulness of n fixes by checking if the project developers would replace their real fixes with n fixes.
we wanted to focus on the n fixes of those projects whose developers were more likelyto give us feedback.
therefore from the n fixes selected in expert validation we chose the ones if they satisfy their code repositories have commit records in the past month actively maintained and therearenodependencyupdatessincethesereal fixesaremerged ensuringthecurrentconfigurationsequaltherealfixes .
following these two criteria we finally chose n fixes.
we made pull requests prs to revise their configurations based on the n fixes.
the pull requests also explained the improvements of oursuggested configurationsin termsof thefive properties e.g.
inducing fewer packages .
ethicalconsiderations.
weprovidedall.netexpertswitha form that informed them about the study purpose the data we collectedandstored andemailtocontactusincasetheyhadconcerns.
additionally before making prs to project developers for validation wehavethoroughlytestedthefixesderivedbynufix toavoid spamming the open source community.
all prs were submitted in compliance with projects contribution guidelines and licenses.
results of expert validation.
figures and show the experience background of our participants.
of participants have years experience in .net development and of themare proficient with more than four types of platforms.
in particular they all have experience with dm issues in the past three months.
theexpertvalidationresultsaredescribedinfigure8 .in70.
of the cases participants preferred the fixes generated by nufix to therealfixes.whilein22.
ofcases theyconfirmedthateitherof thetwofixeswasacceptableforthem sincethefixeswereevenly matchedinpractitioners desiredproperties.inparticular anexpert commented on a pair of fixes for resolving dm issues nu1107 and nu1202 errors in commit 3bb49c4 ofh5 one fix real fix addressedtheissuesatthecostofinducingtwonu1608warnings.
while the other fix n fix is excellent because it did not cause any warnings with one more upgrade of package s major version.
in eight cases .
experts only adopted the real fixes.
we furtheranalyzedtheseinstancesandfoundthattoguaranteefewerup grades downgradesofdependencies majorversions higherweight in nufix s objective function nufix derived the fixes at the ex pense of introducing numerous additional packages.
for exam ple toresolveeightnu1202issuesincommit 008e928 ofproject restaurant developers changed four direct dependencies majorversionsin therealfix.while nufixfixonlyupgrades two dependencies major versions it induces more packages.
results of project developer validation.
among our submittedprsthatsuggestedprojectdeveloperstoreplacetheirreal fixes with the ones derived by nufix prs .
have beenquickly merged.
most of the fixes are confirmed by the affected authorized licensed use limited to lahore univ of management sciences.
downloaded on august at utc from ieee xplore.
restrictions apply.
nufix escape from nuget dependency maze icse may pittsburgh pa usa years years years years years05 .net core.net framework.net standardmonouwpxamarin.iosxamarin.macxamarin.androidunity6.
.
.
real fix n fix either of them expert experience in years .net platforms experts have worked on experts feedback figure results of expert validation projectssuchas dropbox .theremaining5prsarepending.
developers of these projects have not made decisions.
we have not received rejection of our suggestions.
the results indicate that n fixes can resolve the encountered dm issues better than or as good as the original fixes.
a developer specially left a comment in pr ofcharlessolar atthetimeconfigurationhadissues but i believe that they were fixed by these commits.
developers also showed interest in the nufix tool.
for example one developer commented for my own curiosity what is the name of the tool you used to generate the fixes?
please do share it once you are ready!
in fortnox s pr .
details of our prs can be found on nufix s website.
threats to validity subjectivity of inspection.
in our empirical study we adopted manual analysis to construct the taxonomy of fixing strategies and discuss developers configuration preferences.
the manual analysis may pose threats to the validityof empirical findings.
to minimizethisthreat weadoptedanopencodingprocedure to categorize the results.
each issue report was inspected and labelled bytwoco authorsindependently.anydiscrepancywasdiscussedand resolved by the third author until consensus was reached.biasin expertvalidation.
thedatafromexpertvalidationmay besubjecttobias.tolimitthisbias weinvestigatedparticipants profiles and ensured they have over three years .net development experience.inparticular theyhavedealtwithdmissuesinthepast three months.
to guarantee that they fully understand the tasks we gathered ten experts and gave them a minute briefing at the beginning of study session.
we did not disclose to participants which fix was the real fix n fix in each given fix pair.
related work build failure repair.
studiesonautomatedprogramrepair are emerging in recent years especially the build failure repair techniques .forexample bart isa toolthatsummarizes mavenbuildlogsandprovidesrelevantonline links to reduce developers resolution efforts.
hirebuild uses historical build fix information to generate fixes for build scripts thathaveledtosimilartypesofbuildfailures.hobuff applies dataflowanalysistobuildlogsandgeneratingfixesforthefaults analyzed.buildmedic repairsdependency relatedbuildfailuresformavenprojectsbasedonthreecommonfixingstrategies.
pydfix is the latest technique proposed to detect and fix unreproducibilityinpythonbuildscausedbydependencyversionerrors.buildmedic andpydfix shareacommonworkflow theyconsideredthepossiblepackageversionupdatesasthesearchspace of fixing strategies.
they iteratively try out each fixing strategy and then add it into a documented fix if such a strategy can repair at least one unresolved build error.
this procedure continues until all the build errors are resolved or all the fixing strategies have beentested.suchaprocessiscomputationallyexpensivesinceit re buildstheprojectineachiterationtoverifythefixingstrategy.
however thesearchspaceofpossiblefixesfordmissuesin.net ecosystemisexponentiallylarge.ourcomparisonresults see .
showsthattheaboveiterativesearchmethodologyexhibitspoor performance in repairing dm issues.dependency solving.
various studies have been made on dependency management .
studies mainlyfocusondetectingdependencyissues rather than fixing.
in this paper we focus on resolving dependency issuesarisingfromsoftwareevolution.approaches aimtoresolvethepackageupgradeabilityproblem for gnu linux based distributions.
vouillon et al.
identify a set of packages that cannot be installed upgraded together using graph theoretic transformations.
mancinelli et al.
propose an approach that formulates the resolution of dependencies andinter package conflicts as a linear optimization problem amongfeasible upgrade solutions.
recent techniques make furtherenhancementintheconsiderationofdeveloperpreferences.
however these existing works are inapplicable to resolve the dmissuesin.netprojectsbecausetheylack empiricalsupports for the defined user preferences a rigorous process to assign weights for user preferences and providing an optimal subsolution when a perfect solution fixing all issues does not exist.
in this paper we address these limitations and propose an effective techniquetoderivedmissuefixes inwhichdevelopers preferences are empirically investigated and systematically explored.
conclusions and future work inthispaper weempiricallystudieddmissuesin.netprojects which are prevalent and challenging for developers to address.
we investigatedtheirfixingstrategiesanddevelopers configuration preferences.tohelpdevelopersrepairdmissues wedevelopedthenufixtool byformulatingthistaskasabinaryintegeroptimization problem.
theevaluation confirmedthe effectiveness of nufix as itsderivedfixeswereinlinewithdevelopers desiredproperties.inthefuture weplantouseeffectivetesting staticanalysistechniques to efficiently validate nufix s generated fixes.