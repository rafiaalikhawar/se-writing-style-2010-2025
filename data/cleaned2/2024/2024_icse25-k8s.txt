on prescription or off prescription?
an empirical study of community prescribed security configurations for kubernetes shazibul islam shamim dept of swegd kennesaw state university marietta ga usa mshamim kennesaw.eduhanyang hu team lead company a ca usa phenom.hu gmail.comakond rahman dept.
of computer science and software engineering auburn university auburn al usa akond auburn.edu abstract despite being beneficial for rapid delivery of software kubernetes deployments can be susceptible to security attacks which can cause serious consequences.
a systematic characterization of how community prescribed security configurations i.e.
security configurations that are recommended by security experts can aid practitioners to secure their kubernetes deployments.
to that end we conduct an empirical study with security configurations recommended by the center for internet security cis survey respondents and configuration files obtained from the open source software oss and proprietary domains.
from our empirical study we observe i practitioners can be unaware of prescribed security configurations as of the survey respondents are unfamiliar with prescribed configurations and ii for company a and oss respectively .
and .
of the configuration files include at least one violation of prescribed configurations.
from our evaluation with static application security testing sast tools we find i only kubescape to support all of the prescribed security configuration categories ii the highest observed precision to be .
and .
respectively for the company a and oss datasets and iii the highest observed recall to be respectively .
and .
for the company a and oss datasets.
our findings show a disconnect between what cis experts recommend for kubernetes related configurations and what happens in practice.
we conclude the paper by providing recommendations for practitioners and researchers.
dataset used for the paper is publicly available online.
index terms configuration container orchestration devops devsecops empirical study kubernetes security static analysis i. i ntroduction practitioners use containers to rapidly deploy software changes to end users.
in order to efficiently manage provisioned containers practitioners use the practice of container orchestration where popular tools such as kubernetes are used to manage thousands of containers .
usage of kubernetes has yielded benefits for organizations.
for example practitioners at openai reported that using kubernetes the deployment time reduced from couple of months to two or three days for hundred of servers .
as another example in the case of spotify the time to run a new software service in production reduced from one hour to seconds .despite reported benefits practitioners face challenges in securing their kubernetes deployments.
according to the state of kubernetes security report security of kubernetes deployments is reported as one of the biggest concerns for adoption by practitioners .
the survey also reports of survey respondents delayed or slowed down software deployments because of kubernetes related security concerns.
furthermore of the respondents in the same survey reported to experience losses in revenue or customers because of security concerns related to container orchestration .
kubernetes related security weaknesses can cause serious consequences.
for example a kubernetes related configuration facilitated a security attack called cryptojacking.
cryptojacking is the attack of using a computing resource to stealthily mine cryptocurrency without the user s awareness .
cryptojacking can be used to incur thousands of dollars in unwanted expenditures as it happened for the telnet cyptojacking attack1.
the above mentioned discussion showcases the importance of using configurations that can enhance the security of kubernetes deployments.
in order to aid practitioners both researchers and practitioners have provided guidelines on how to integrity security into kubernetes deployments in forms of tools and prescribed security configurations i.e.
security configurations that are recommended by a group of cybersecurity experts .
for example the center for internet security cis organization has recommended multiple security configurations that practitioners can follow .
despite their availability there is a lack of understanding on how frequently prescribed configurations are followed by practitioners.
let us consider the examples presented in figure in this regard.
figures 1a and 1b presents an example of violating a prescribed configuration which resides in a repository maintained by company a and an open source pre printc ontainers name efs plugin securitycontext !
p rivileged t rue image amazon aws efs csi driver v1 .
.
imagepullpolicy ifnotpresent 1a cni cnibindir var lib cni bin cniconfdir etc cni multus net .d chained false cniconffilename istio cni .
conf excludenamespaces istio system kube system loglevel info !
privileged true b fig.
examples where cis prescribed configurations are violated in company a s repository figure 1a and in an oss repository figure 1b .
software oss repository .
both configuration files use privileged true which violates the recommendation of minimize the admission of privileged containers .
one kubernetes expert colloquially referred to the configuration privileged true as the the most dangerous flag in the history of computing as this configuration gives the illusion of containerization but in fact disables security features provided by kubernetes for a container or a group of containers .
examples presented in figure showcases that kubernetes configuration files maintained by oss and proprietary organizations are susceptible to include configurations that violate what is recommended by cybersecurity experts namely from cis.
we take motivation from the examples presented in figure and conduct a systematic analysis of how frequently prescribed security configurations are violated.
as part of our analysis we also investigate what tools are capable of detecting violations of cis prescribed security configurations.
such an analysis which currently remains under explored can aid practitioners with recommendations on how to secure their kubernetes deployments.
we answer the following research questions rq1 how frequently do static application security testing tools support community prescribed security configurations in kubernetes deployments?
rq2 what are the practitioner perceptions of community prescribed security configurations for kubernetes deployments?
rq3 how frequently are communityprescribed security configurations violated in kubernetes configuration files?
rq4 what is the detection accuracy of static application security testing tools in detecting violations of community prescribed security configurations in kubernetes configuration files?
the goals of our paper are to help i practitioners securetheir kubernetes deployments and ii researchers identify new research avenues.
we accomplish our goals by conducting a mixed method empirical study with static application security testing sast tools and cis prescribed configurations.
first we compute how frequently does each of the sast tools support each of the prescribed configurations.
using and configuration files collected respectively from oss repositories and repositories used by companya we compute the detection accuracy of five sast tools.
we also conduct an online survey with practitioners from company a and the oss domain to evaluate the perceptions of the prescribed configurations.
datasets and scripts used in our paper is available online as a replication package .
dataset availability dataset used for the paper is publicly available online .
contributions we list our contributions as follows an evaluation of how frequently prescribed security configurations are violated in kubernetes configuration files an evaluation of detection accuracy of five sast tools for configuration files used in the oss and the proprietary domain and an evaluation of practitioner perceptions of cis prescribed security configurations.
ii.
rq1 s upport for cis prescribed configurations we first provide necessary background information in section ii a. next we provide the methodology and results respectively in sections ii b and ii c. a. background kubernetes configuration files container orchestration is the practice of automatically provisioning and managing multiple containers .
kubernetes is a tool to implement the practice of container orchestration .
a kubernetes installation is colloquially referred to as a kubernetes cluster or a kubernetes deployment .
in order to pre printapiversion v1 kind pod metadata name nginx spec containers name nginx image nginx .
.
ports containerport 80kind podname of the pod container name image name 1fig.
an example of a kubernetes configuration file.
manage multiple containers practitioners develop configuration files similar to that of figure .
the example shows the configurations of a kubernetes entity called pod which is the most fundamental deployment unit.
these developed configuration files are later executed by kubectl which is provided by kubernetes.
the configuration files are developed in yaml.
cis prescribed configurations for kubernetes our empirical study focuses on prescribed configurations i.e.
security configurations that are recommended by a group of cybersecurity experts.
cis is a u.s based non profit organization that provides security guidelines for a wide range of software systems such as database systems and operating systems .
each guideline is derived using two steps first experts from different backgrounds such as academia industry and government prepare a working draft of recommendations.
second the experts discuss the draft and reach a consensus.
a collection of recommendations is referred to as a guideline where one guideline includes multiple prescriptions.
each prescription is a recommended activity to enhance software system security.
in the case of kubernetes cis provides guidelines on which configurations can secure kubernetes base deployments.
we use cis prescribed configurations as our empirical study focuses on security configurations that are prescribed by a community of cybersecurity experts who specialize in kubernetes.
we use a guideline called the cis amazon eks benchmark v1.
.
that prescribes configurations for kubernetes deployments that use amazon eks.
amazon eks is a service that can be used to run kubernetes in the aws cloud and on premise data centers .
each of the configurations map to a category that is listed in table i. for example the prescribed configuration enable audit logs belongs to the category logging .
each of the prescribed configuration includes a name a description of the reasoning behind the recommendation and necessary remediation steps when the configuration is violated.
these cis prescribed configurations are i adopted by the cloud native community2 ii demonstrated through webi2 and iii recommended by aws for its customers4.
b. methodology for rq1 we use the following steps identify the source of community prescribed security configurations in our empirical study we use the cis amazon elastic kubernetes service eks benchmark that lists a total security configurations.
we use this set of recommendations because of company a s kubernetes deployment pipeline uses aws eks.
each recommendation is mapped to a category.
for example the recommendation enable audit logs is mapped to a category called logging .
in all the guidebook includes recommendations that are mapped to categories.
selection of sast tools in order to answer rq1 we identify a set of sast tools that is capable of detecting violations of the recommendations listed in the aws eks guide book.
we start the selection process by conducting a search using the google search engine with the search string security tools for kubernetes .
from the collected top search results we identify program analysis tools for kubernetes.
from the list of tools we further apply the following criteria to identify the tools that we plan to use.
criterion the tool must be publicly available online.
criterion the tool must be able to detect violations of prescribed configurations by applying static analysis with configuration files.
the first author of the paper read the documentation of each tool related to kubernetes to determine if the tool detect violations of security related configurations.
criterion the tool must be executable automatically using the command line interface.
we exclude tools such as snyk as it requires manually uploading of kubernetes configuration files for security related analysis.
criterion the tool must detect violations of at least five security configurations.
our assumption is that by using this criterion we will be able to exclude tools that are specialized to detect a specific type of security weakness in kubernetes based deployments.
this criterion is consistent with prior research on security tool evaluation that has used the count of five security weakness types to determine how generalizable a tool is .
we use the source code and documentation of each tool to apply the filtering criteria.
upon application of the following criteria we identify five tools of which checkov kubescape and trivy are internally used at company a. attributes of these five tools are available in table i. checkov is an oss sast tool that scans kubernetes configuration files for security weaknesses .
checkov can be installed as a package and executed from the command line interface.
checkov provides output results in sarif format.
pre printtable i attributes of selected sast tools tool size kloc source output format checkov .
github sarif json xml csv kubelinter .
github sarif json kubescape .
github sarif json xml html pdf slikube13.
tosem sarif csv trivy .
github sarif json xml html .
.
.
.
.
.
.
.
.
.
.
.
checkovkubelinterkubescapesli kubetrivy auth.
cluster netcni plugincontainer oseks keygenericiamimagekubeletloggingpod policiesrbac secret mgmtuntrusted loadworker files categorytool fig.
answer to rq1 support for cis prescribed configurations.
kubescape is an oss sast tool developed by armo that supports misconfiguration scanning risk analysis and security compliance inside a kubernetes deployment .
kubescape can work as a sast tool to scan source code in a local directory with a command line interface.
kubelinter is an oss sast tool developed by stackrox that identifies security misconfigurations and deviations from security best practices in kubernetes configuration files .
according to the red hat survey kubelinter is the most popular static security analysis tool among kubernetes practitioners .
kubelinter can analyze kubernetes configuration files from the command line interface in the local directory.
sli kube is an oss sast tool developed by researchers that identifies categories of security misconfigurations in kubernetes manifests .
sli kube can be executed from the command line.
trivy is an oss sast tool developed by aqua security that can detect security weaknesses in operating systems languagespecific packages and kubernetes configuration files .
trivy identifies security weaknesses for known vulnerabilities cve misconfigurations and runtime security issues.
map prescribed configurations to rules implemented in the tools answer to rq1 requires a systematic analysis to identify which of the recommendations are supported by which tool.
we use a qualitative technique called closed coding to perform a mapping between each of the recommendations and a rule implemented within the tool.
as part of applying the closed coding technique the first author and the second author of the paper read each of the recommendationsin the guidebook and identify if the recommendation security configuration is detected by inspecting the source code or documentation of the tool.
upon completion of the closed coding process we record a cohen s kappa of .
between the first and second authors which indicates almost perfect agreement .
the disagreement occurred for rules of the tools for recommendations that are resolved by the last author of the paper.
the last author s decision is final in this regard.
upon completion of the closed coding process we derive a mapping between each prescribed configuration and one or multiple rules for each tool.
metric to answer rq1 we use the derived mapping from section ii b3 to answer rq1.
we report which of the prescribed security configurations are detected by each tool.
we also report the support by computing the proportion of supported configurations for each category using equation .
support category c total of configurations detected by tool total of configurations in the category c. answer to rq1 we find one recommendation to be supported by at least two of our five selected tools.
a complete breakdown is available in table ii.
the category column presents the category name to which each recommendation belongs to.
for example violations of enable audit logs is detected by kubescape.
we also report the support of each tool based on categories in figure .
we observe kubescape to have support of .
for all categories of prescribed configurations.
answer to rq1 amongst the five sast tools kubescape provides the most support with respect to detecting violations of cis prescribed configurations.
iii.
rq2 p ractitioner perceptions we provide the methodology and results respectively in sections iii a and iii b. a. methodology for rq2 we conduct a quantitative survey by recruiting practitioners from company a and from the oss domain.
we initially start with a item likert survey similar to that of prior research .
following kitchenham and pfleeger s guidelines we conduct a pilot survey that revealed practitioners may not be familiar with some of the prescribed configurations.
accordingly we added another item called unfamiliar inclusion of likert items that express unfamiliarity is commonplace and useful in opinion based studies .
a item likert survey similar to ours is also reported to have higher validity .
we deploy the constructed survey to practitioners working in company a and contributing to oss projects.
the second author of the paper provided the email addresses of practitioners who are working in company a. in the case of oss pre printwe emailed practitioners.
the email addresses are collected by the first author who contacted the same set of practitioners who they interviewed in prior work.
all selected practitioners are confirmed to be knowledgeable about kubernetes by the first and second author.
the survey is conducted from october to july .
the online survey consists of questions in total.
each of the remaining questions is a question asked using a six item likert scale.
the six items are unfamiliar not important little important somewhat important important and extremely important .
each of these questions focus on assessing the practitioners perceptions about the importance of the prescribed security configurations.
following guidelines from kitchenham and pfleeger we use a five item likert scale to assess importance.
we also add one item called unfamiliar as from our pilot deployment we found a voluntary participant to not be familiar with of the prescribed configurations.
we do not collect any personal information such as name email industry experience as we did not get permission from company a. the survey questionnaire is available as part of replication package .
b. answer to rq2 we receive responses from practitioners.
of the respondents work in company a and contribute to oss projects.
mean and maximum years of professional experience for participants from the oss domain is respectively .
and .
years.
our oss participants reported their job titles to be vice president senior software engineer cto and solution architects .
our answers to rq2 is available in table iii.
in the survey response column the numbers on the left hand side present the proportion of participants who are not familiar with a prescribed configuration.
for example of the surveyed practitioners are not familiar with enabling audit logs .
the data presented on the right hand side showcases the proportion of participants who find a configuration to be extremely important .
for example of the surveyed practitioners find enabling audit logs as extremely important.
surveyed practitioners are not familiar with all configurations.
for example for configurations we found at least one respondent to be unfamiliar.
answer to rq2 all survey respondents are familiar with out of cis prescribed configurations.
for the remaining configurations survey respondents are unfamiliar.
iv.
rq3 f requency of violated configurations we provide the methodology and results respectively in sections iv a and iv b. a. methodology for rq3 we use the following steps construction of evaluation dataset we use two datasets to evaluate the detection accuracy i the company a dataset i.e.
the dataset with configuration files that are provided by our partner at company a and ii oss configuration files mined from repositories on github.
all configuration files provided by company a is obtained from two repositories for which we apply no filtering criteria.
the two repositories in total includes kubernetes configuration files.
we use the ghtorrent data dump hosted on google bigquery to mine oss repositories.
initially we start with repositories.
we apply a filtering criteria to identify repositories with kubernetes configuration files.
the criteria are i at least of the files in the repository must be kubernetes manifests ii the repository must be available for download iii the repository is not a clone to avoid duplicates iv the repository must have commits per month.
munaiah et al.
previously used the threshold of commits per month to determine which repositories have enough software development activity v the repository has contributors vi the repository is not used for a toy project.
we consider a project as toy project if description and content of the readme file for each projects indicates that the project is used to demonstrate examples conduct course work and used as book chapters and vii the repository is deployed using amazon eks.
we use this criterion as the repositories used by company a also uses amazon eks.
this criterion allows us to identify repositories that are consistent with companya s repositories that are deployed using amazon eks.
we apply this criterion by reading each of the readme files and descriptions for the repositories that we identified by applying criteria i vi .
upon application of this filtering criteria we identify oss repositories that contains configuration files.
we apply a confidence interval to select a random sample from both datasets namely company a and oss.
using our selected random sample we identify and configuration files in the company a and oss dataset.
attributes of both datasets is available in table iv.
qualitative analysis each of the configuration files in the company a and oss datasets is inspected for presence of violations by two raters the first and second authors of the paper.
each rater individually inspects each file in order to determine which file violates what security configuration.
the raters apply closed coding while inspecting where they first identify coding patterns in the file that are indications of violating a prescribed configurations.
next they map the identified coding pattern to any of the prescribed configurations.
if the mapping is found then that coding pattern is identified as a true positive i.e.
an instance of a valid violation.
the same process is repeated for all and files respectively in the company a and the oss dataset.
for example the coding pattern audit disabled is a violation of ensure audit logs whereas the coding pattern audit enabled is in compliance for the recommendation.
pre printtable ii answer to rq1 support for detecting violations of configurations prescribed by cis category id prescribed configuration checkov slikubekubelinter kubescape trivy logging .
.
enable audit logs .
.
ensure that the kubeconfig file permissions are set to or more restrictive worker node configuration files .
.
ensure that the kubelet kubeconfig file ownership is set to root root .
.
ensure that the kubelet configuration file has permissions set to or more restrictive .
.
ensure that the kubelet configuration file ownership is set to root root .
.
ensure that the anonymous auth is not enabled .
.
ensure that the authorization mode argument is not set to alwaysallow .
.
ensure that a client ca file is configured .
.
ensure that the read only port is disabled .
.
ensure that the streaming connection idle timeout argument is not set to kubelet .
.
ensure that the protect kernel defaults argument is set to true .
.
ensure that the make iptables util chains argument is set to true .
.
ensure that the hostname override argument is not set .
.
ensure that the eventrecordqps argument is set to or a level which ensures appropriate event capture .
.
ensure that the rotate certificates argument is not present or is set to true .
.
ensure that the rotatekubeletservercertificate argument is set to true container optimized os .
.
prefer using a container optimized os when possible .
.
ensure that the cluster admin role is only used where required .
.
minimize the access to secrets .
.
minimize the wildcard use in roles and clusterroles rbac and service accounts .
.
minimize access to create pods .
.
ensure that default service accounts are not actively used .
.
ensure that the service account tokens are only mounted where necessary .
.
avoid use of system masters group .
.
limit use of the bind impersonate and escalate permissions in the kubernetes cluster .
.
minimize the admission of privileged containers .
.
minimize the admission of containers wishing to share host process id namespace .
.
minimize the admission of containers wishing to share host network namespace pod security policies .
.
minimize the admission of containers wishing to share host ipc namespace .
.
minimize the admission of containers with allowprivilegeescalation .
.
minimize the admission of root containers .
.
minimize the admission of containers with added capabilities .
.
minimize the admission of containers with capabilities assigned cni plugin .
.
ensure cni supports network policies .
.
ensure that all namespaces have network policies secrets management .
.
prefer using secrets as files over secrets as environment variables .
.
consider external secret storage .
.
create administrative boundaries between reources using namespaces generic .
.
apply security context to your pods and containers .
.
the default namespace should not be used .
.
ensure image vulnerability scanning using amazon ecr image scanning or a third party provider image .
.
minimize user access to amzon ecr .
.
minimize cluster access to read only for amzon ecr .
.
minimize container registries to only those approved identity and access management iam .
.
prefer using dedicated eks service accounts aws eks key management service5.
.
ensure kubernetes are encrypted using custom master keys cmks managed in aws kms .
.
restrict access to the control plane endpoint .
.
ensure clusters are created with private endpoint enabled and public access disabled cluster networking .
.
ensure clusters are created with private nodes .
.
ensure network policy is enabled and set as appropriate .
.
encrypt traffic to https load balancers with tls certificates authentication authorization .
.
manage kubernetes rbac users with aws iam authenticator for kubernetes untrusted workload .
.
consider fargate for running untrusted workloads pre printtable iii answer to rq2 the survey response column presents perceptions of practitioners related to the importance for each of the recommendations.
id prescribed configuration survey response .
.
enable audit logs .
.
ensure that the kubeconfig file permissions are set to or more restrictive .
.
ensure that the kubelet kubeconfig file ownership is set to root root .
.
ensure that the kubelet configuration file has permissions set to or more restrictive .
.
ensure that the kubelet configuration file ownership is set to root root .
.
ensure that the anonymous auth is not enabled .
.
ensure that the authorization mode argument is not set to alwaysallow .
.
ensure that a client ca file is configured .
.
ensure that the read only port is disabled .
.
ensure that the streaming connection idle timeout argument is not set to .
.
ensure that the protect kernel defaults argument is set to true .
.
ensure that the make iptables util chains argument is set to true .
.
ensure that the hostname override argument is not set .
.
ensure that the eventrecordqps argument is set to or a level which ensures appropriate event capture40 .
.
ensure that the rotate certificates argument is not present or is set to true .
.
ensure that the rotatekubeletservercertificate argument is set to true .
.
prefer using a container optimized os when possible .
.
ensure that the cluster admin role is only used where required .
.
minimize the access to secrets .
.
minimize the wildcard use in roles and clusterroles .
.
minimize access to create pods .
.
ensure that default service accounts are not actively used .
.
ensure that the service account tokens are only mounted where necessary .
.
avoid use of system masters group .
.
limit use of the bind impersonate and escalate permissions in the kubernetes cluster .
.
minimize the admission of privileged containers .
.
minimize the admission of containers wishing to share host process id namespace .
.
minimize the admission of containers wishing to share host network namespace .
.
minimize the admission of containers wishing to share host ipc namespace .
.
minimize the admission of containers with allowprivilegeescalation .
.
minimize the admission of root containers .
.
minimize the admission of containers with added capabilities .
.
minimize the admission of containers with capabilities assigned .
.
ensure cni supports network policies .
.
ensure that all namespaces have network policies .
.
prefer using secrets as files over secrets as environment variables .
.
consider external secret storage .
.
create administrative boundaries between resources using namespaces .
.
apply security context to your pods and containers .
.
the default namespace should not be used .
.
ensure image vulnerability scanning using amazon ecr image scanning or a third party provider0 .
.
minimize user access to amzon ecr .
.
minimize cluster access to read only for amzon ecr .
.
minimize container registries to only those approved .
.
prefer using dedicated eks service accounts .
.
ensure kubernetes are encrypted using custom master keys cmks managed in aws kms5 .
.
restrict access to the control plane endpoint .
.
ensure clusters are created with private endpoint enabled and public access disabled .
.
ensure clusters are created with private nodes .
.
ensure network policy is enabled and set as appropriate .
.
encrypt traffic to https load balancers with tls certificates .
.
manage kubernetes rbac users with aws iam authenticator for kubernetes .
.
consider fargate for running untrusted workloads unfamiliar not important little important somewhat important important extremely important once done we compute the cohen s kappa between the two raters is respectively .
and .
for the companya and the proprietary dataset.
in the case of disagreements the raters discussed on why an identified coding pattern is a valid or invalid violation.
the second author s decision is final during disagreement resolution as the they are actively working for company a and has more practical perspectivesthan the first author.
upon completion of this process we obtain two datasets where each file is labeled with a violation.
metrics we use two metrics to answer rq3 i the count of configuration files that violates a certain prescribed configuration and ii the proportion of configuration files that include at least one violation of a prescribed configuration.
we use these three metrics as they can help us contextualize the pre printtable iv attributes of datasets dataset attribute value company a configuration files total size loc total repositories oss configuration files total size loc total repositories frequency of violations from multiple perspectives.
b. answer to rq3 we report our findings in tables v and vi using the answer to rq3 column.
in this column we report the count and proportion data for each cis prescribed configurations that are mapped to their cis ids.
here count reports the count of configuration files for which violations occur whereas proportion reports the proportion of configuration files that include violation of any of the prescribed configurations.
we observe the most frequently violated configuration to be ensure that the service account tokens are only mounted where necessary for the oss dataset and create administrative boundaries between resources using namespaces for the company a dataset.
in all we observe a total of and configuration files for which violations occur respectively for the company a and oss dataset.
answer to rq3 for the company a dataset .
of configuration files include at least one violation of cis prescribed configurations.
for the oss dataset .
of configuration files include at least one violation of cis prescribed configurations.
v. rq4 d etection accuracy of sast t ools we provide the methodology and results respectively in sections v a and v b. a. methodology for rq4 we use the evaluation dataset that we construct in section iv a to answer rq4.
the dataset contains a mapping of which kubernetes configuration file violates one or multiple of the prescribed configurations for company a s repositories and oss repositories.
similar to prior research on security tool evaluation we use precision and recall to determine the accuracy of the five tools for two datasets.
we use the following formulas to calculate precision and recall precision truepositive tp truepositive tp falsepositive fp recall truepositive tp truepositive tp falsenegative fn for oss and company a datasets we calculate precision and recall for two scenarios i individual here we compute theprecision and recall for each sast tool individually.
here we report the precision and recall for each of the violated prescribed configurations and ii combined here we compute the precision and recall for multiple combinations of sast tools.
we report the precision and recall across all prescribed configurations for both datasets.
we use combinations of two three four and five sast tools in this case.
b. answer to rq4 we report the precision and recall for the five sast tools using tables v and vi.
the highest average precision and recall for the company a dataset is observed respectively for kubelinter and trivy.
the highest average precision for the oss dataset is observed both for checkov and trivy.
the highest recall for the oss dataset is observed for checkov.
for both datasets the average precision is .
which is lower than that of acceptable precision for static analysis tools according to practitioners .
one possible explanation for this low precision and recall could be the use of patterns that they use to detect violations.
another possible explanation is related to the differences between the taxonomy of cis that we used and the taxonomy of the tools.
for example categories used by sli kube and categories prescribed by cis are different.
precision and recall for each combination are available in table vii.
when combinations of tools are used we observe an increase in precision and recall.
for example for the company a dataset the precision of kubelinter increases from .
to .
when combined with checkov and kubescape.
the recall of trivy increases from .
to .
for the same dataset when combined with checkov sli kube kubelinter and kubescape.
for the oss dataset the recall of checkov is .
for two combinations i checkov trivy kubelinter and ii checkov trivy kubelinter and kubescape.
the highest precision is .
that is lower than that of the average precision of checkov and trivy.
despite improvements in recall for both datasets the precision is .
which is still lower than that of acceptable precision .
according to prior work practitioners expect a precision of .
for usage of static analysis tools.
answer to rq4 when sast tools are evaluated individually the highest observed precision is .
and .
respectively for the company a and oss datasets.
the highest observed recall is .
and .
respectively for the company a and oss datasets.
when all the five sast tools are combined the recall increases to .
and .
respectively for the company a and oss datasets.
vi.
d iscussion we discuss the implications of our findings and threats to validity respectively in sections vi a and vi b. pre printtable v frequency of violated prescriptions and detection accuracy of kubernetes sast for the company a dataset cis id answer to rq3 freq.
answer to rq4 detection accuracy count proportion sli kube checkov kubescape kubelinter trivy precision recall precision recall precision recall precision recall precision recall .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
all cis id .
.
.
.
.
.
.
.
.
.
.
table vi frequency of violated prescriptions and detection accuracy of kubernetes sast for the oss dataset cis id answer to rq3 freq.
answer to rq4 detection accuracy count proportion sli kube checkov kubescape kubelinter trivy precision recall precision recall precision recall precision recall precision recall .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
all cis id .
.
.
.
.
.
.
.
.
.
.
a. implications implications for sast tool usage in kubernetes configuration management reported detection accuracy in section v b showcases the limitation of sast tools with respect to precision.
while we acknowledge this limitation we advocate for combining sast tools in order to detect violations of prescribed configurations.
according to recent research practitioners have expressed that even if sast tools have low precision they still provide value in secure software development as finding something would be better than nothing .
based on data precision and recall data presented in table vii we advocate for the following combinations i kubelinter and checkov ii kubelinter and kubescape and iii the combination of checkov kubelinter kubescape slikube and trivy.
findings reported in section iii b provide a nuanced perspective for the cis prescribed configurations.
we observe of survey respondents to be unfamiliar with of the configurations which shows how practitioners experienced in kubernetes can be unaware of potential security threats due to kubernetes related configurations.
while alarming this finding is not surprising as it aligns with prior research thathas shown practitioners to be unaware of all configurations in software systems .
this lack of awareness is also applicable for a software system such as kubernetes which is complex relatively novel and evolving .
we advocate for the usage of security testing techniques such as sast tools so that practitioners are informed on the configurations that can have security related consequences.
implications on improving sast tools data reported in table ii also shows of the survey respondents to find of the prescribed configurations to be not important or little important .
this finding showcases that certain prescriptions can be perceived as irrelevant to practitioners.
this finding is counter intuitive as the prescriptions are derived by industry experts i.e.
cis contributors.
while this finding in counterintuitive the finding can enhance the configuration process in the following manner localization of identified configurations in the case of security tools practitioners seek information on how a detected alert is used in the software project which in turn leads to taking an action .
accordingly for kubernetesrelated sasts we advocate for accurate reporting of the violations and the locations where the violations occur.
pre printtable vii detection accuracy of sast tools when used as combinations combination company a oss precision recall precision recall sli kube kubelinter .
.
.
.
sli kube checkov .
.
.
.
sli kube trivy .
.
.
.
sli kube kubescape .
.
.
.
kubelinter checkov .
.
.
.
kubelinter trivy .
.
.
.
kubelinter kubescape .
.
.
.
checkov trivy .
.
.
.
checkov kubescape .
.
.
.
trivy kubescape .
.
.
.
sli kube kubelinter checkov0.
.
.
.
sli kube kubelinter trivy0.
.
.
.
sli kube kubelinter kubescape0.
.
.
.
sli kube checkov trivy .
.
.
.
sli kube checkov kubescape0.
.
.
.
sli kube trivy kubescape0.
.
.
.
kubelinter checkov trivy .
.
.
.
kubelinter checkov kubescape0.
.
.
.
kubelinter trivy kubescape0.
.
.
.
checkov trivy kubescape .
.
.
.
sli kube kubelinter checkov trivy0.
.
.
.
sli kube kubelinter checkov kubescape0.
.
.
.
sli kube kubelinter trivy kubescape0.
.
.
.
sli kube checkov trivy kubescape0.
.
.
.
kubelinter checkov trivy kubescape0.
.
.
.
sli kube kubelinter checkov trivy kubescape0.
.
.
.
incorporate attack related information a lack of meaningful alerts is a pain point in using sast tools which we postulate can be mitigated through incorporation of attack related information.
while reporting violated configurations tools should also discuss if a single or a combination of configurations can lead to a security attack.
improve detection accuracy the detection accuracy of the studied tools can be improved by i enhancing the rules with examples that are available in our dataset ii incorporating the configurations that are not covered by tools but are present in cis guidelines iii incorporating practitioner feedback and iv deriving control and data flow analysis techniques unique to kubernetes entities.
on the value of dynamic analysis for securing kubernetes deployments according to table ii a sast tool alone can only detect out prescribed configurations.
furthermore the precision and recall for sast tools is underwhelming as discussed in section v b. these shortcomings of sast tools highlight the potential of using dynamic application security testing dast tools such as kubebench .
practitioners can use dast tools to identify violations of prescribed security configurations in kubernetes deployments.
future work our findings provide the groundwork for further research in the following directions derive human and socio technical factors that explain why practitioners do not implement prescribed configurations derive methodologies to increase usage of cis prescribed configurations conduct evaluation of cis prescribed security guidelines for other software systems evaluate studied tools for non security and security defects and derive defect and vulnerability detection techniques by understanding the unique properties of kubernetes entities.
b. threats to validity we describe the limitations of our paper as follows external validity our survey participants include practitioners from company a which may not reflect the opinion of other practitioners who use kubernetes.
we mitigate this limitation by including additional practitioners in our survey who are contribute to oss projects.
also reported findings for rq3 and rq4 may not generalize for all repositories that contain kubernetes configuration files.
we mitigate this limitation by using oss repositories mined from github.
our static analysis tools evaluation results are limited to two proprietary repositories used by company a which may not generalize to other repositories.
we mitigate this challenge by evaluating the static analysis tools on oss repositories.
answers to rq3 are dependent on the scripts that we select and their sources.
a different dataset may result in different precision and recall values for the studied tools.
conclusion validity the mapping between the rules of security analysis tools and prescribed configurations are susceptible to rater bias.
we mitigate this limitation by using two raters of which one is an industry practitioner with industry experience in cybersecurity.
construction of our evaluation dataset is also susceptible to rater bias.
we mitigate this limitation by using two raters.
the survey respondent count is which may influence the results.
we acknowledge that the survey response rate is on the lower end but low survey response rare is common in software engineering where one publication reports the survey response rate to be as lows as .
internal validity one of the raters who performs the mapping is a practitioner working at company a. this affiliation may affect intuitively affect the mapping process.
we mitigate this limitation by using another rater who has no affiliation with company a. usage of precision and recall may also bias the evaluation process of the sast tools that we studied.
vii.
r elated work our paper is related with prior research that have addressed defects in dockerfiles docker swarm kubernetes security and security tool evaluation.
pre printa prior research on dockerfiles defects in configuration scripts used to set up docker containers have garnered a lot of interest amongst researchers.
azuma et al.
and ksontini et al.
in separate research studies systematically investigated defects in dockerfiles.
other researchers such as haque et al.
wist et al.
jain et al.
pinnamaneni et al.
liu et al.
shu et al.
zerouali et al.
and lin et al.
have focused on characterizing security defects in container images.
b prior research on docker swarm similar to kubernetes docker swarm is also a tool used for container orchestration.
while it is not as popular as kubernetes researchers have conducted multiple research studies on the scheduling mechanism of systems managed by docker swarm.
researchers have conducted performance related evaluation .
also through systematic comparative evaluations researchers find kubernetes to be better than that of docker swarm with respect to scalability features and security .
c prior research on kubernetes security prior research has used graph and anomaly based approaches for kubernetes security.
for securing kubernetes clusters researchers adopted anomaly based approaches .
tien et al developed an anomaly detection tool to monitor and detect attacks in the kubernetes cluster .
cao et al.
developed an anomaly detection tool using a state machine model for kubernetes deployment .
hariri et al.
proposed an anomaly detection tool for scientific applications in kubernetes .
researchers also have adopted graph based approaches to secure kubernetes clusters.
blaise et al.
used a graph based approach to extract the attack path for kubernetes deployment .
empirical analysis is another topic for kubernetes security research.
bose et al.
performed qualitative analysis and constructed a dataset with security related commits .
the research that is closest in spirit to our paper is the paper authored by rahman et al.
.
they developed a security analysis tool for detection of misconfiguration .
our paper is different from their paper in the following manner i we analyze the practitioner perceptions of cis prescribed recommendations for kubernetes ii we analyze the support and detection accuracy for sast tools while detecting violations of cis prescribed configurations and iii we quantify the frequency of and cis prescribed configurations respectively for the company a and oss dataset.
d prior research on evaluation of security analysis tools our paper is related to prior research on sast tool evaluation.
li et al.
evaluated sast tools and found the precision of these tools to be .
valentina et al.
performed a comparison using static analysis tools on java related projects and found little to no agreement between the tools.
hamda et al.
evaluated the effectiveness of non commercial security analysis tools based on owasp top security vulnerabilities and reported that sast tools are inadequate to uncover all common weaknesses .
researchers also have investigated the impact of combining sast tools.
paulo et al.
combined security analysis tools todetect web based vulnerabilities .
fransesc et al.
combined static dynamic and interactive analysis tools and reported the n tools combination s average effectiveness in reducing false positives .
ranganath et al.
evaluated android security analysis tools and found a combination of these tools to detect out known vulnerabilities .
the above mentioned discussion showcases a lack of research in sast tool evaluation for kubernetes configuration files.
we address this gap in our paper.
our paper shows cis prescribed configurations are violated in practice and existing sast tools are inadequate in detecting these violations.
in the context of kubernetes related studies these findings are novel as none of the above mentioned papers have reported these findings.
furthermore our paper shows a disconnect between what cis experts recommend and what happens in practice.
viii.
c onclusion despite the existence of community prescribed guidelines for securing kubernetes deployments there is a lack of understanding of how practitioners perceive these guidelines and to what extent existing sast tools detect violations of these guidelines.
we have conducted an empirical study with configurations prescribed by cis.
for company a and oss respectively we find .
and .
of the configuration files to include at least one violation of prescribed configuration.
we also observe of the surveyed practitioners be unaware about the configurations.
when sast tools are evaluated individually the highest observed precision is .
and .
respectively for the company a and oss dataset.
the highest observed recall is .
and .
respectively for the company a and oss dataset.
when all the five sast tools are combined the recall increases to .
and .
respectively for company a and oss.
based on our findings we recommend practitioners to use a combination of sast tools as combinations of sast tools can identify violations of prescribed configurations with more accuracy.