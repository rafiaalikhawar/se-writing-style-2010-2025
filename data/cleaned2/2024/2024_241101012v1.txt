pairsmell a novel perspective inspecting software modular structure chenxing zhong state key laboratory of novel software technology nanjing university china zhongcx smail.nju.edu.cndaniel feitosa faculty of science and engineering university of groningen the netherlands d.feitosa rug.nlparis avgeriou faculty of science and engineering university of groningen the netherlands p.avgeriou rug.nl huang huang state grid nanjing power supply company china sgcc.huang.huang gmail.comyue li state key laboratory of novel software technology nanjing university china yueli.dom outlook.comhe zhang state key laboratory of novel software technology nanjing university china hezhang nju.edu.cn abstract enhancing the modular structure of existing systems has attracted substantial research interest focusing on two main methods software modularization and identifying design issues e.g.
smells as refactoring opportunities.
however remodularization solutions often require extensive modifications to the original modules and the design issues identified are generally too coarse to guide refactoring strategies.
combining the above two methods this paper introduces a novel concept pairsmell which exploits modularization to pinpoint design issues necessitating refactoring.
we concentrate on a granular but fundamental aspect of modularity principles modular relation mr i.e.
whether a pair of entities are separated or collocated .
the main assumption is that if the actual mr of a pair violates its apt mr i.e.
an mr agreed on by multiple modularization tools as raters it can be deemed likely a flawed architectural decision that necessitates further examination.
to quantify and evaluate pairsmell we conduct an empirical study on c c and java projects using established modularization tools to identify two forms of pairsmell inapt separated pairs insep and inapt collocated pairs incol .
our study on instances reveals that their architectural impacts are substantial on average .
and .
of software entities are involved in insep andincol mrs respectively insep pairs are associated with more co changes than properly separated pairs while incol pairs are associated with fewer co changes than properly collocated pairs both indicating a successful identification of modular structures detrimental to software quality and both forms of pairsmell persist across software evolution.
this evidence strongly suggests that pairsmell can provide meaningful insights for inspecting modular structure with the identified issues being both granular and fundamental making the enhancement of modular design more efficient.
i. i ntroduction software modularity is an essential quality attribute reflecting how a system is structured into different parts modules .
this attribute has demonstrated a substantial impact on software reuse and has been considered in various modern design scenarios e.g.
microservices based systems and llm enabled systems .
although the debate over whatconstitutes a single module has sparked broad academic interests determining appropriate modules is still challenging in practice.
the reason is that modules can evolve quickly due to updated business features and infrastructure technologies.
modules that worked well in the past might not fit into the current system.
thus a large part of the community s effort was spent on providing methodological support to improve the modularity of existing systems focusing primarily on two methods on one hand software modularization has been extensively investigated for nearly years with at least papers published in the past decade .
relevant work treats modularization as an optimization problem and searches for a near optimal modular solution to replace the original modules.
such solutions often ask for expensive changes to original systems which might prevent developers from adopting them.
for example even with refactoring effort as the optimization objective a solution may introduce up to move class operations to a system .
on the other hand some studies focus on identifying issues in modular structure e.g.
based on quality metrics anti patterns or smells .
the issues are regarded as opportunities for refactoring in subsequent development aiming at improving the degraded modules.
the problem is that most of the issues are coarse at the module level making it difficult for developers to determine refactoring strategies .
a typical example is cycle dependency where the chain of relations among several modules breaks the desirable acyclic nature of modules dependency structure.
although we know that cycle dependencies should be broken it is difficult to decide which dependencies to break .
our idea in this paper builds on both aforementioned methods.
rather than replacing the original modules we propose that modularization tools can help identify issues that require refactoring.
we focus on issues with a specific granularity whether an entity file pair is collocated or separated withinarxiv .01012v1 nov 2024123456781carelement.java x2body.javax x3wheel.javax x4engine.javax x5carelementvisitor.javaxxx x6car.javaxxxxx 7carelementprintvisitor.javaxxxxx 8carelementdovisitor.javaxxxxx a dependency matrix of the system.
x is a directional dependency between files.
oo3o o4oo ooo6o oo7oo o8ooo ooo2o oo3 o4 o5oo o6ooo 7o 8o b solutions from wca left and fca right .
o means two files collocated in the same module.
c consensus mrs. blue collocated red separated.
fig.
.
mrs agreed upon by multiple modularization tools are more reliable as they comply with multiple rule sets.
the same module termed modular relation mr .
this characteristic is central to several fundamental modularity principles like common closure principle and single responsibility principle .
for instance the common closure principle suggests grouping entities that often change together .
moreover entity pairs and their relationships are fundamental to many architecture analyses .
our assumption is thatif multiple modularization tools consensually design a mr as collocated or separated it can be deemed a promisingly apt mr due to the consideration of diverse viewpoints.
this assumption inspired by consensus clustering where similar cluster assignments indicate strong grouping between a pair of entities reflects the consensus based decision making in software development e.g.
.
on the contrary if the mr of a pair violates the apt one this violation indicates an inappropriate architectural decision which we refer to as pairwise modular smell pairsmell .
in a nutshell pairsmell offers granular yet fundamental insights helping developers inspect and improve software modules more effectively.
it aims to identify issues necessitating refactoring based on multiple modularization tools making development effort more targeted.
in this paper we introduce quantify and evaluate pairsmell as a novel type of issue for inspecting modular structure.
to assess the severity of this issue we conducted an empirical study involving c c and java projects from github.
to support this study we developed a tool integrating established modularization tools to automatically detect pairsmell from the modular structure of a development architectural view.
we mined code commits across diverse snapshots and inspected separated and collocated pairs of entities.
based on the dataset our study identified pairsmells including inapt separated pairs a.k.a.
insep and inapt collocated pairs incol .
the empirical results reveal that pairsmell is prevalent among projects with insep andincol instances covering .
and .
entities on average on average entities in insep mrs co change more than in other separated pairs and entities in incol mrs co change less than other collocated pairs dramatically deviating from wellstructured modules pairsmell persists in software projects if left unaddressed where the percentages of insep andincol pairs remain stable as systems grow.
in summary our study makes the following contributions a novel type of architectural smell and its identification approach are proposed enabling the revelation of granular yet fundamental modular issues.
an empirical study on the architectural smell is present revealing that such smells are prevalent but detrimental to software maintenance and change and could persist for long if left unaddressed.
the novel smell is discussed and its implications for practice and future research are illustrated.
the benchmarks and replication package collected from open source projects are publicly available for continued research of the novel type of smell.
ii.
p airwise modular smell before proposing pairsmell we first illustrate its assumption inspired by consensus clustering where similar cluster assignments for a pair of entities indicate that these entities should be grouped together.
specifically a simple java system from is modularized using two widely used modularization tools wca and fca detailed in section ii c as shown in fig.
a and b .
comparing these resulting solutions we found promising insights in cases where both solutions consensually design the mr of a pair as fig.
c .
an instance of collocated mr is found between carelementvisitor row and car .
by inspecting the architecture in fig.
a we notice that these two files are structurally connected featuring two direct dependencies and multiple indirect dependencies i.e.
via files in row and .
another example is a separated mr between carelement and wheel where we observe only a direct dependency.
this separated mr appears justifiable given the densely connected nature of this architecture.
to summarize this example illustrates the rationale behind using mrs agreed by multiple modularization tools as promisingly apt mrs. it is crucial to recognize that these mrs are not infallible they inherit potential biases from the individual tools involved.
nevertheless this usage is justified as it diminishes the risk of biases that might be present when relying solely on a single modularization tool thus offering a more reliable inspection regarding potential mr issues.
in the remainder of this section we first define pairsmell and then present an automated approach for its identification.tool tool m... m0112 m1 m11 m02 m1 me1e2e3e4e1e2e3e4apt 011010111101e1e2e3e4e1e2e3e4afolder structureincol e1 e4 ...insep e1 e2 ... apt mrsactual mrspairsmells fig.
.
overview of identifying pairsmell.
a. pairsmell definition we define a pairsmell as a tuple regarding a pair of entities eiandej where the actual mr violates its apt mr pairsmell ei ej mract ei ej mrapt ei ej the first element ei ej denotes a pair of entities in a target system where ei ej.
in this study we consider an entity as a single code file following the common practice of architecture level analyses e.g.
.
both the second and third elements mract ei ej andmrapt ei ej denote modular relations between the entities eiandej.
the mr of a pair in a specific design dis separated or collocated formally mrd ei ej ifmod d ei mod d ej ifmod d ei mod d ej where mod d ei is the module to which eibelongs in design d.mract ei ej is the actual modular relation of the pair which could be extracted from a system snapshot.
inspired byconsensus clustering this work considers an mr apt if it is agreed upon by multiple modularization tools.
in contrast if modularization tools disagree it suggests that the pair may be reasonably designed as either collocated or separated.
formally an apt mr exists if mrd1 ei ej ... mrdm ei ej where mis the number of modularization tools considered.
b. identification approach for pairsmell identification we first infer the apt mrs agreed upon by multiple modularization tools and then utilize them as