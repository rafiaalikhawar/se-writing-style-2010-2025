Quantifying Permissiveness of Access Control Policiesâˆ—
WilliamEiers
UniversityofCaliforniaSantaBarbara
SantaBarbara,CA,USA
weiers@cs.ucsb.eduGaneshSankaran
UniversityofCaliforniaSantaBarbara
SantaBarbara,CA,USA
ganesh@cs.ucsb.eduAlbertLi
UniversityofCaliforniaSantaBarbara
SantaBarbara,CA,USA
albert_li@cs.ucsb.edu
EmilyOâ€™Mahony
UniversityofCaliforniaSantaBarbara
SantaBarbara,CA,USA
emilyomahony@cs.ucsb.eduBenjaminPrince
UniversityofCaliforniaSantaBarbara
SantaBarbara,CA,USA
benjaminprince@cs.ucsb.eduTevfikBultan
UniversityofCaliforniaSantaBarbara
SantaBarbara,CA,USA
bultan@cs.ucsb.edu
ABSTRACT
Duetoubiquitoususeofsoftwareservices,protectingtheconfiden-
tialityofprivateinformationstoredincomputecloudsisbecoming
anincreasinglycriticalproblem.Althoughaccesscontrolspecifi-
cationlanguagesandlibrariesprovidemechanismsforprotecting
confidentialityofinformation,withoutverificationandvalidation
techniquesthatcanassistdevelopersinwritingpolicies,complex
policyspecificationsarelikelytohaveerrorsthatcanleadtounin-
tendedandunauthorizedaccesstodata,possiblywithdisastrous
consequences.Inthispaper,wepresentaquantitativeanddiffer-
ential policy analysis framework that not only identifies if one
policyismorepermissivethananotherpolicy,butalsoquantifies
therelativepermissivenessofaccesscontrolpolicies.Wequantify
permissivenessofpoliciesusingamodelcountingconstraintsolver.
Wepresentaheuristicthattransformsconstraintsextractedfrom
accesscontrolpoliciesandsignificantlyimprovesthemodelcount-
ingperformance.Wedemonstratetheeffectivenessofourapproach
byapplyingittopolicieswritteninAmazonâ€™sAWSIdentityand
AccessManagement(IAM)policylanguageandMicrosoftâ€™sAzure
policylanguage.
CCS CONCEPTS
â€¢Security and privacy â†’Logic and verification ;Access con-
trol.
ACM Reference Format:
William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin
Prince, and Tevfik Bultan. 2022. Quantifying Permissiveness of Access
ControlPolicies.In 44thInternationalConferenceonSoftwareEngineering
(ICSE â€™22), May 21â€“29, 2022, Pittsburgh, PA, USA. ACM,NewYork,NY,USA,
13pages.https://doi.org/10.1145/3510003.3510233
1 INTRODUCTION
Modernsoftwareservicesrunoncomputeclouds.Amongthemost
popularcloudserviceprovidersareAmazonWebServices(AWS),
âˆ—ThismaterialisbasedonresearchsupportedbyanAmazonResearchAwardandby
NSFunderGrantsCCF-2008660,CCF-1901098,CCF-1817242
This work is licensed under a Creative Commons Attribution International 4.0 
License.
ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Â© 2022 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-9221-1/22/05.
https://doi.org/10.1145/3510003.3510233MicrosoftAzure,andGoogleCloudPlatform(GCP),eachofwhich
letscustomerssecuretheirservicesbywriting accesscontrolpolicies.
Accesscontrolpoliciesspecifyrulesthatallowauthorizedaccess
whiledenyingunauthorizedaccesstoclouddata.Policiescanbe
writtenusingmanyaccesscontrolspecificationlanguages,likethe
AWSIdentityandAccessManagement(IAM)[ 40]languageorthe
eXtensible Access Control Markup Language (XACML) [ 64]. In
contrast, libraries such as CanCan [ 22] and Pundit [ 58] provide
supportforspecificationofpoliciesattheimplementationlevel.
Bythemselves,theseareusefullanguagesandlibraries;however,
withoutverificationandvalidationtechniquesthatcanassistin
writingpolicies,policyspecificationsarelikelytohaveerrorsthat
canleadtounintendedandunauthorizedaccesstodata.Infact,
incorrectspecificationofaccesscontrolpoliciesincloudstorage
serviceshasresultedintheexposureofmillionsofcustomersâ€™datatothepublic.Forexample,itwasreportedthat[
28]datarecordsfor
morethan2millionDowJones&Co.customerswereexposedduetoanaccesscontrolerror.Exposeddataincludednames,addresses,
accountinformation,emailaddresses,andlastfourdigitsofcredit
cardnumbersofsubscribers.TheexposeddatawasinapubliclyaccessibleAWSSimpleStorageService(s3)bucket.Thisisadis-
astrouserrorinthepolicyspecificationforcloudstoragebuckets.
Asimilarerrorresulteddataexposureof50thousandAustralian
employeesthatincludedfullnames,passwords,salaries,IDs,phone
numbers,andcreditcarddata[ 2].Yetanothererrorexposedthe
accountrecordsof14millionVerizoncustomers[ 63].Avulnera-
bilityinMicrosoftâ€™sAzureCosmosDBservice[ 10]allowedpublic
accesstoaccountsanddatabasesofthousandsofcustomers.
Theseexampleshighlighttheurgentneedtodeveloptechniques
toprotectclouddata.Automaticallyfindingaccesscontrolissues
wouldpreventexposureofprivatedata,protectingtheprivacyof
millions of people. Hence, it is necessary to develop automated
verificationtechniquesthatcananalyzeaccesscontrolpoliciesfor
computeclouds.Inordertocheckforcorrectnessofapolicy,itis
necessarytohaveaspecificationofcorrectnessproperties,butwrit-
ingcorrectnesspropertiesmanuallycanbechallengingandtime
consuming.Moreover,writingexpectedpropertiesofthepolicy
iserror-prone.Hence,whenaninconsistencybetweenaproperty
specificationandapolicyisidentified,itdoesnotnecessarilymean
thatthepolicyhasanerror;thepropertyspecificationitselfcould
beerroneous.Adifferentialpolicyanalysisapproachremovesthe
needtomanuallyspecifypolicyproperties;instead,itcompares
differentpoliciesandidentifiesinconsistenciesamongthem.Basic
policies can be compared to a complex policy to verify that the
18052022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin Prince, and Tevfik Bultan
latterdoesnothaveunintendedconsequences.Forexample,we
maywanttoverifythatacomplexpolicyspecificationisnotmore
permissivethanasimplepolicythatspecifiescommonsenseaccess
rules.Moreover,differentialpolicyanalysistechniquescanidentify
differencesbetweendifferentversionsofapolicy.Whenapolicy
specification is modified, it would be worthwhile to know how
thepermissivenessofthepolicyhaschanged.However,abinary
answertoaquestionthatcomparestwopoliciesmaybeinsufficient.
Forexample,itmaynotsufficethatweknow ifonepolicyismore
permissivethananother.Wemaywanttoknow howmuchmore
permissiveapolicyisthananother,i.e.,wemaywantto quantify
therelativepermissivenessofdifferentpolicies.Modelcounting
constraintsolversfindthenumberofsatisfyingassignmentsfora
givenconstraint,withinagivenbound[8,19,24,25,47,48].They
havebeenappliedtoseveralquantitativeanalysisproblemssuch
asprobabilisticanalysis,reliabilityanalysis,andquantitativeinfor-
mationflowanalysis[12â€“14,18,31,35,55â€“57].
Inthispaperweproposeaframeworktoquantifypermissiveness
ofaccesscontrolpoliciesusingmodelcountingconstraintsolvers.
Ourcontributionsincludethefollowing:
â€¢Aformalmodelforaccesscontrolpolicies
â€¢Aformalizationofaccesscontrolpolicypermissiveness
â€¢Anautomatedapproachforquantifyingpermissivenessofac-
cesscontrolpoliciesbytranslatingapolicytoaSMTformula
andusingamodelcountingconstraintsolvertoquantifyits
permissiveness
â€¢Anextensionoftheformalmodelandautomatedapproach
toquantify relativepermissivenessbetweenpolicies
â€¢Aheuristicthattransformsformulasextractedfrompolicies
forimprovingmodelcountingperformance
â€¢An open-source tool, qacky, that implements the auto-
matedapproachtoanalyzepolicieswritteninAWSIdentity
andAccessManagement(IAM)andAzurepolicylanguages
â€¢Apubliclyavailablepolicydatasetconsistingofdozensof
real-worldpoliciesfromAWSforumsandAzuredocumenta-
tion,aswellashundredsofpoliciessynthesizedbyapplying
mutationtechniquestothereal-worldpolicies
â€¢Anexperimentalevaluationof qackyonthedataset
Therestofthepaperisorganizedasfollows.Insection2wefirst
introduce cloud policies and motivate the need for quantitative
permissivenessanalysis.InSection3wepresentourformalpolicy
model,inSection4wediscussSMT-basedpolicyanalysis,inSection
5wediscussquantitativepermissivenessanalysis,inSection6we
presentourconstrainttransformationheuristic,inSection7we
discusstheimplementationofourapproachonAWSandAzure
policies,inSection8wediscussourexperiments,inSection9we
surveyrelatedwork,andinSection10weconcludethepaper.
2 BACKGROUND AND MOTIVATION
In this section we first introduce access control policies for the
popularcloudservicesAmazonWebServices(AWS)andMicrosoft
Azure.Wethendiscussseveralexamplesmotivatingtheneedfor
quantitativeanalysisofaccesscontrolpolicies.2.1 Access Control Policies for the Cloud
AmazonWebServicesPolicies. AmazonWebServices(AWS)uses
asharedresponsibilitysecuritymodelwhereAWSguaranteesse-
curityof the cloud , but users are responsible for security in the
cloud. AWS lets users control who has access to their resources
withaccesscontrolpolicieswrittenintheAWSpolicylanguage.
Accessrequestsareevaluatedagainstpoliciesandadynamicen-
vironmentcontextwithinapolicyevaluationenginethateither
allowsordeniesaccess.
AWSdefinesapolicylanguagewherepolicieseitherallowor
denyaccessthroughdeclarativestatements.A statementisa5-tuple
(Principal,Effect,Action,Resource,Condition)where
â€¢Principalspecifiesalistofusers,entities,orservices
â€¢Effect={Allow,Deny}specifieswhetherthestatemental-
lowsordeniesaccess
â€¢Actionspecifiesalistofactions
â€¢Resourcespecifiesalistofresources
â€¢Conditionisanoptionallistofconditionsfurtherconstrain-
inghowaccessisallowedordenied
Eachconditionconsistsofaconditionoperator,conditionkey,and
condition value on elements of the request context. Full details
ofthelanguagecanbefoundin[ 11].Notethatwhilemostofthe
elementsofapolicyarestrings,certainconditionkeysspecifyother
typesofconstraints(e.g.,s3:max-keysexpectsanintegralnumber).
Additionally,theAWSpolicylanguageallowstheuseoftwospecial
characterswithinstrings:â€˜*â€™,orwildcard,representsanystring,and
â€˜?â€™whichrepresentsanysinglecharacter.Givenanaccessrequest
andassociatedpolicy,permissionisgrantedifandonlyif,forthe
givenprincipal,action,resource,andconditionkeyvaluesinthe
request context, a statement in the policy allows access and no
statementinthepolicyexplicitlydeniesaccess.
Microsoft Azure Policies. LikeAWS,Azureusesasharedrespon-
sibilitysecuritymodel,wheresecurity inthecloud isachievedby
role-based access control (RBAC). Azure RBAC defines a policy
language consisting of role definitions and role assignments. A
role definition isasetofallowedactions
(ActionsâˆªDataActions )\(NotActions âˆªNotDataActions )
where
â€¢Actionsisalistofallowedmanagementactions
â€¢DataActions isalistofalloweddataactions
â€¢NotActions âŠ†ğ´ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ isalistofdeniedmanagementactions
â€¢NotDataActions âŠ†ğ‘ğ‘œğ‘¡ğ´ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘  isalistofdenieddataactions.
Arole assignment isatuple (principalId, roleDefId, scope, condition)
where
â€¢principalId identifiesa Principalgrantedaccess
â€¢roleDefIdidentifiestheroledefinition
â€¢scopeidentifiesasetof Resourcesgrantedaccess
â€¢conditionisanoptionalexpressionforgrantingaccess
The scope is a path in Azureâ€™s resource hierarchy, rooted at â€˜/â€™.
Resourcesrootedatthepatharegrantedaccess.UnlikeinAWS,
theAzureconditionisaninfixlogicalexpression.Azurehaslogical
operators and relational operators on strings and integral num-
bers,butitalsosupportscrossproductrelationaloperatorsonsets,
likeForAnyofAllValues:StringEqals.LikeAWS,Azureallows
1806Quantifying Permissiveness of Access Control Policies ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
wildcardsinstrings(exceptscope).Givenanaccessrequest,role
definition,androleassignment,permissionisgrantedifandonly
if,boththeroledefinitionandroleassignmentexplicitlyallowthe
principalandactionunderthescopeandcondition.
2.2 Motivating Examples
CapitalOneDataBreach. CapitalOneisoneofmanycompanies
whichuseAmazonWebServices(AWS)fortheircloudcomputing
needs.AWSprovidesanaccesscontrolmechanismforcontrolling
accesstoresourcesthroughtheIdentityandAccessManagement
(IAM)policyspecificationlanguage.AWSIAMallowscustomersto
createIAMrolesandtogivepermissionstorolesbyattachingIAM
policiestotherole.PolicieswrittenintheIAMpolicylanguage
allowAWSuserstocontrolaccesstoresourcesandAWSservices
through fine-grained permissions. A role can then be assumed
by a user or application. Recently, a server run by Capital One
was breached by an outside attacker who was able to run user
commandsunrestricted[ 23,52].Theattackerwasthenabletolist
thebuckets(whichstoreresourcesasobjects)ontheserverand
downloadthecontentsofeachbucket.Theattackitselfinvolvedtwo
maincomponents.First,theattackerwasabletogainauthenticated
accesstoanAWSIAMrole[ 23].Secondly,therolehadbroadaccess
to S3 buckets due to a misconfigured policy. For confidentiality
reasons,themisconfiguredpolicyisnotpubliclyavailable.
Thefollowingrepresentsasimplifiedmodelofthepermissions
allowedintheCapitalOnedatabreach.
Effect : Allow
Action : [s3:ListBucket,s3:GetObject]
Resource : *
WhenattachedtoanIAMrole,thepolicygrantsbroadaccesstothe
s3service,allowingtheroletolistandgatherdatawithins3buckets.
However,iftheattachedroleiscompromisedbyamalicioususer(as
intheCapitalOnedatabreach)agreatdealofdatacanbeexposed.
Alesspermissivepolicymightrestrictresourcestoasinglebucket
Resource = [firewall, firewall/*]
orrestrictresourcestoonlytwoobjectswithinabucket
Resource = [firewall, firewall/log10, firewall/log20]
Existingpolicyanalysistechniques[ 11,38]canverifyifapolicyis
moreorlesspermissivethananotherbuttheycannotquantify the
magnitude of permissiveness ineachcase.Ourworkcanquantify
thedifferencesinpermissivenessbetweenallthreepolicies.Ifwe
assumevalidresourcesarealphanumericandâ€™:â€™,â€™-â€™,â€™_â€™,â€™/â€™characters
with max length of 20, the initial policy allows the GetObject
actionon2 .50Ã—1036moreresourcesthanwhenaccessisrestricted
toasinglebucket,whichallowsactionon1 .05Ã—1020moreresources
thanwhenaccessisrestrictedtotwoobjectswithinabucket.
Policies in the Wild. Fortheaverageuser,theabovepoliciesare
simple enough to manually analyze without sophisticated tech-
niques.Thisisnotalwaysthecase.Policiescanbecomplex,espe-
ciallytothoseunfamiliarwithaccesscontrol.AWSprovidesforums
whereuserscanposttheirpoliciesandgetfeedbackfromother
users(andAWSemployees).Weconsiderasetofpoliciestakenfrom
theforumstoshowcasetheusefulnessofourapproach.Forsimplic-
ityweassumevaluesforfieldsinapolicycontainalphanumeric
andâ€™:â€™,â€™-â€™,â€™_â€™,â€™/â€™characters."Statement" :[{
"Effect" :"Allow" ,
"Action" :[
"s3:GetAccelerateConfiguration" ,...,
"s3:ListBucketMultipartUploads" ],
"Resource" :"*"}]}
"Statement" :[{
"Effect" :"Allow" ,
"Action" :[
"s3:DescribeJob" ,...,
"s3:GetAccelerateConfiguration" ,...,
"s3:GetObject" ,
"s3:GetObjectLegalHold" ,...,
"s3:ListBucketMultipartUploads" ],
"Resource" :"*"}]}
"Statement" :[{
"Effect" :"Allow" ,
"Action" :[
"s3:DescribeJob" ,...,
"s3:GetAccelerateConfiguration" ,...,
"s3:GetObjectLegalHold" ,...,
"s3:ListBucketMultipartUploads" ],
"Resource" :"*"}]}
Figure 1: Initial (topmost, (a)), modified (middle, (b)), and
fixed(bottom,(c)),versionsofapolicyusedbyAWSSupport
Quantifying Allowed Actions and Requests. InDecember2021,
theAWSSupportServiceRolePolicypolicyusedbyAWSSupport
automatedsystemswasmodifiedtoallowmoreactions.However,
thismodificationinadvertentlyallowedtheactions3:getobject[ 6],
whichgreatlyincreasedthenumberrequestsallowedbythepolicy
(due to the nature of the getobject action). A bot detected the
changeandpublishedittoGitHub,whereseveralusersraisedcon-
cernsaboutgetobject[ 7].Withouthumanswhohadsubstantial
AWSknowledgeandwhomanuallyinspectedthepolicychange,
thisvulnerabilitymaynothavebeenmitigatedasquickly,thusne-
cessitatingtheneedforautomatedverification.Additionally,prior
work(suchasbinarydifferentialanalysis)wouldbeinsufficient,as
anadditionalactionwouldundoubtedlyincreasepermissiveness
butthegetobjectactioninparticularincreasespermissiveness
byalmostanorderofmagnitude.AWSeventuallyfixedthepolicy,
removinggetobject.Simplifiedinitial,modified,andfixedpolicies
areshowninFig1.Thefixedpolicydoesnotallowgetobject
WecanquantifythepermissivenessofPolicy1(a)intermsofhow
manyactionsandrequestsareallowedbythepolicy.Assumingthat
resourcesarenomorethan100characterslong,ourtoolreports
that24actionsand4 .09Ã—10138requestsareallowedbythepolicy.
ThisresultiswithrespecttothesetofvalidAWSs3actionsandall
possibleresources,notthesetofresourcesintheuserâ€™sorganization.
Ifthesetofresourcesisknown,theycanbeaddedasaconstraint
andthenourapproachwouldcounttherequestsallowedbythe
policywithrespecttothesetofknownrequests.
WecanquantifythepermissivenessofPolicy1(b)and1(c).Our
toolreportsthat47actionsand2 .22Ã—10205requestsareallowed
byPolicy1(b).ByremovinggetobjectfromPolicy1(b),ourtool
reportsthat46actionsand1 .78Ã—10205requestsareallowedby
Policy1(c).NotethatbothpoliciesareidenticalexceptthatPolicy
1(c) does not contain the s3:getobject action. If instead of the
s3:getobjectactionbeingremovedfromPolicy1(b),anotheraction
(suchass3:describejob)wereremoved,thenourtoolreportsthat
46actionsand2 .22Ã—10205requests(asopposedto1 .78Ã—10205
1807ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin Prince, and Tevfik Bultan
"Statement" :[{
"Effect" :"Allow" ,
"Principal" :"*",
"Action" :"s3:GetObject" ,
"Resource" :"arn:aws:s3:::myexamplebucket/*" },
{
"Effect" :"Deny",
"Principal" :"*",
"Action" :"s3:GetObject" ,
"Resource" :"arn:aws:s3:::myexamplebucket/*" }]
"Statement" :[{
"Effect" :"Allow" ,
"Principal" :"*",
"Action" :"s3:GetObject" ,
"Resource" :"arn:aws:s3:::myexamplebucket/*" },
{
"Effect" :"Deny",
"Principal" :"*",
"Action" :"s3:GetObject" ,
"Resource" :"arn:aws:s3:::myexamplebucket/*" ,
"Condition" :{
"StringNotLike" :{
"aws:userId" :[
"AROAEXAMPLEID :*","AIDAEXAMPLEID" ,"111111111111 "]}}}]
Figure 2: Initial (top, (a)) and fixed (bottom, (b)) versions of
a policy for restricting access to certain users
requests)areallowedbytheresultingpolicy.Thisdemonstrates
theneedforquantitativeanalysisinthecontextofaccesscontrol.
Quantifying Allowed Users. Depending on the scenario, most
AWSuserswantamixofpublicandprivateaccesstotheirdata.
This entails creating complex policies specifying access to their
data,whichoftenrequiresin-depthknowledgeoftheAWSpolicy
language.Inonescenario,auserpostedontheforumsseekinghelp
inhowtograntaspecificsetofusersaccesstoabucket.Theuser
wasunabletocraftapolicywithoutallowingunintendedaccess.
Fig2showsthepoliciesanotheruserpostedinresponse.Policy2(a)
deniesallaccesstoanydata(eliminatingallaccess).Policy2(b)isa
modificationoftheinitialpolicysothatonlyaspecificsetofusers
canaccessdatawithinthebucket(aswellasdenyinganonymous
access).Suchpoliciesthatalignwiththeuserâ€™sintentioncanbe
difficulttocraft,oftenduetocomplexaccesscontrollogicneeded
orsheercomplexityinhowpermissionsshouldbegoverned.
WecanquantifythepermissivenessofPolicy2(b)intermsof
how many aws:userIds are allowed by the policy. This lets the
userverifythatachangeinpolicysemanticsmatchestheoriginal
intentiontoonlyallowaccessforacertainsetofusers.Assuming
thatvalidaws:userIdsarenomorethan20characterslong,ourtool
reportsthat8 .39Ã—1010aws:userIdsareallowedbythepolicyout
of2.50Ã—1036possibleaws:userIds.Thisresultiswithrespecttothe
setofallpossibleuserIds,andnotthesetofuserIdsintheuserâ€™s
organization.IfthesetofuserIdsisknown,theycanbeaddedasa
constraintandthenourapproachwouldcounttheuserIdsallowed
bythepolicywithrespecttothesetofknownuserIds.
IfwemodifyPolicy2(b)andremovethewildcardinthecondition
that defines allowed userIds (i.e., the line "AROAEXAMPLEID:*" ),
thenourtoolwouldreportexactlythenumberofalloweduserIds
(2inthiscase).So,inascenariowhereanAWSuserwantstospecify
apolicywithaconcretenumberofpermissions,ourquantitative
analysiscanbeusedtoverifythequantityofpermissions.Quantifying Trusted Values Inferred From A Policy. TrustSafety,
introduced in [ 20], is the notion that a policy should not allow
untrusted(i.e.public)access.Determiningifapolicyis TrustSafe
requiresinferringthesetof trustedvalues fromthepolicybyanalyz-
ingthevaluesfor trusted keys andmakingsuretheydonotmatch
anâ€œoverlylargeâ€setofvalues.In[ 20]asyntacticcheckofthepolicy
isperformedtolookforvaluescontainingawildcardcharacter(â€œ*â€),
andifso,thepolicyisdeemednotTrustSafe.However,ingeneral,
asyntacticcheckcannotdeterminethesizeofasetofvaluesinan
accesscontrolpolicy.Ourapproachcanbeusedtopreciselydeter-
mineifthesetofvaluesisâ€œoverlylargeâ€byquantifyingthesizeof
thesetofvalues.Ifthesizesurpassesapredeterminedthreshold,
thepolicywouldbedeemednotTrustSafe.
3 POLICY MODEL
Inthissection,weintroduceourpolicymodelwhichformsthebasis
ofourframework.Ourmodelisdesignedtobeexpressiveenoughto
modelcomplexpolicyspecificationsthatcanbeefficientlyandpre-
ciselyanalyzedbymodernverificationandvalidationtechniques.
Weuseanapproachsimilarto[ 11]indefiningourpolicymodel.
Anaccesscontrolpolicyspecifies whocandowhatunderwhich
conditions.Wedefineanaccesscontrolmodelinwhich declarative
policiesfieldaccessrequestsfromadynamicenvironment,andall
requestsareinitiallydenied.Anaccessrequestisatuple (ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆ
Î”Ã—ğ´Ã—ğ‘…Ã—ğ¸where Î”isthesetofallpossibleprincipalsmaking
a request, ğ‘…is the set of all possible resources which access is
allowedordenied, ğ´isthesetofallpossibleactions,and ğ¸isthe
environmentattributesinvolvedinanaccessrequest.Anaccess
controlpolicy P={ğœŒ0,ğœŒ1,...ğœŒğ‘›}consistsofasetofrules ğœŒğ‘–where
each rule is defined as a partial function ğœŒ:Î”Ã—ğ´Ã—ğ‘…Ã—ğ¸â†©â†’
{ğ´ğ‘™ğ‘™ğ‘œğ‘¤,ğ·ğ‘’ğ‘›ğ‘¦ }.Thesetofprincipalsspecifiedbyarule ğœŒis
ğœŒ(ğ›¿)={ğ›¿âˆˆÎ”:âˆƒğ‘,ğ‘Ÿ,ğ‘’:(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆğœŒ} (1)
ğœŒ(ğ‘)forğ‘âˆˆğ´,ğœŒ(ğ‘Ÿ)forğ‘Ÿâˆˆğ‘…,ğœŒ(ğ‘’)forğ‘’âˆˆğ¸aresimilarlydefined.
Givenapolicy P={ğœŒ0,ğœŒ1,...ğœŒğ‘›},arequest (ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)isgranted
accessif
âˆƒğœŒğ‘–âˆˆP:ğœŒğ‘–(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)=ğ´ğ‘™ğ‘™ğ‘œğ‘¤âˆ§/nexistsğœŒğ‘—âˆˆP:ğœŒğ‘—(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)=ğ·ğ‘’ğ‘›ğ‘¦
Thepolicygrantsaccessiftherequestisallowedbyaruleinthe
policyandisnotrevokedbyanyotherruleinthepolicy.Explicit
deniesoverruleexplicitallows(ifarequestisallowedbyonerule
anddeniedbyanotherrule,therequestisultimatelydenied).The
setofallowrulesanddenyrulesfor Paredefinedas:
PAllow={ğœŒğ‘–âˆˆP:(ğ›¿ğ‘–,ğ‘ğ‘–,ğ‘Ÿğ‘–,ğ‘’ğ‘–)âˆˆğœŒğ‘–âˆ§ğœŒğ‘–(ğ›¿ğ‘–,ğ‘ğ‘–,ğ‘Ÿğ‘–,ğ‘’ğ‘–)=Allow}(2)
PDeny={ğœŒğ‘—âˆˆP:(ğ›¿ğ‘—,ğ‘ğ‘—,ğ‘Ÿğ‘—,ğ‘’ğ‘—)âˆˆğœŒğ‘—âˆ§ğœŒğ‘—(ğ›¿ğ‘—,ğ‘ğ‘—,ğ‘Ÿğ‘—,ğ‘’ğ‘—)=Deny}(3)
Givenapolicy P,therequestsallowedbythepolicyarethosein
whichapolicyrulegrantstheaccessthroughan Alloweffectand
isnotrevokedbyanypolicyrulewitha Denyeffect:
Allow(P)={(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆÎ”Ã—ğ´Ã—ğ‘…Ã—ğ¸
:âˆƒğœŒğ‘–âˆˆP:(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆğœŒğ‘–âˆ§ğœŒğ‘–(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)=Allow
âˆ§/nexistsğœŒğ‘—âˆˆP:(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆğœŒğ‘—âˆ§ğœŒğ‘—(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)=Deny}(4)
1808Quantifying Permissiveness of Access Control Policies ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Thesetofprincipals,resources,oractionsallowedbyapolicyis
Allow(P,Î”)={ğ›¿âˆˆÎ”:(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆAllow(P)}(5)
Allow(P,ğ´)={ğ‘âˆˆğ´:(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆAllow(P)}(6)
Allow(P,ğ‘…)={ğ‘Ÿâˆˆğ‘…:(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)âˆˆAllow(P)}(7)
4 PERMISSIVENESS ANALYSIS
Inthissectionwediscusshowthepermissivenessofourpolicy
modelisanalyzed.Givenapolicy,thegoalistodeterminewhat
requestsareallowedbythepolicy,andifthepolicyismoreorless
permissivethananotherpolicy.Thisisdonebyreducingpolicies
tologicformulas,similartotheapproachusedin[11,38].
4.1 SMT Encoding of a Policy
The permissiveness of a policy is determined by the number of
requeststhatitallows:themorerequestsallowedbyapolicy,the
higheritspermissiveness.Thepolicyallowingallpossiblerequests
isthemostpermissivepolicy,andthepolicywhichdeniesallre-
questsistheleastpermissivepolicy.Itfollowsthat,givenapolicy,
reasoningoverallpossiblerequestsallowedbythepolicydeter-
minesthepermissivenessofthepolicy.Weencodethesetofpossi-
blerequestsbyintroducingvariables {ğ›¿ğ‘ ğ‘šğ‘¡âˆˆÎ”,ğ‘Ÿğ‘ ğ‘šğ‘¡âˆˆğ‘…,ğ‘ğ‘ ğ‘šğ‘¡âˆˆ
ğ´,ğ‘’ğ‘ ğ‘šğ‘¡âˆˆğ¸}inthegeneratedSMTformula.
/llbracketP/rrbracket=/parenleftbigg/logicalordisplay.1
ğœŒâˆˆPAllow/llbracketğœŒ/rrbracket/parenrightbigg/logicalanddisplay.1
Â¬/parenleftbigg/logicalordisplay.1
ğœŒâˆˆPDeny/llbracketğœŒ/rrbracket/parenrightbigg
(8)
/llbracketğœŒ/rrbracket=/parenleftbigg/logicalordisplay.1
ğ›¿âˆˆğœŒ(ğ›¿)ğ›¿ğ‘ ğ‘šğ‘¡=ğ›¿/parenrightbigg/logicalanddisplay.1/parenleftbigg/logicalordisplay.1
ğ‘âˆˆğœŒ(ğ‘)ğ‘ğ‘ ğ‘šğ‘¡=ğ‘/parenrightbigg/logicalanddisplay.1
/parenleftbigg/logicalordisplay.1
ğ‘ŸâˆˆğœŒ(ğ‘Ÿ)ğ‘Ÿğ‘ ğ‘šğ‘¡=ğ‘Ÿ/parenrightbigg/logicalanddisplay.1/parenleftbigg/logicalordisplay.1
ğ‘’âˆˆğœŒ(ğ‘’)ğ‘’ğ‘ ğ‘šğ‘¡=ğ‘’/parenrightbigg(9)
TheSMTencodingofapolicy Pisgivenby /llbracketP/rrbracketandrepresentsthe
setofrequestsallowedby P.Policyrulesareencodedasvaluesfor
setsof(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’),whereeachvaluesetpotentiallygrantsorrevokes
permissions. Satisfying solutions to /llbracketP/rrbracketcorrespond to requests
allowedbythepolicy,i.e.,
Allow(P)={(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’):(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)|=/llbracketP/rrbracket}(10)
4.2 Relative Permissiveness of Policies
Forasinglepolicy,equations8,9provideawaytomodelthese-
manticsofapolicyinisolation.Below,weprovideapolicyanalysis
frameworkthat,giventwopolicies,determinestherelativepermis-
sivenessbetweenthetwo.
Intuitively,giventwopolicies P1andP2wecandeterminewhether
oneismorepermissivethantheotherbyanalyzingformulas /llbracketP1/rrbracketâ‡’
/llbracketP2/rrbracketand /llbracketP2/rrbracketâ‡’/llbracketP1/rrbracket.However,itispossiblethatbothpolicies
allowdifferentsetsofrequests,orthesetofrequestsoverlap.In
general,therearefourpossibleoutcomes:
(1) Allow (P1)âŠ‚Allow(P2)
(2) Allow (P1)âŠƒAllow(P2)
(3) Allow (P1)=Allow(P2)
(4)P1andP2donotsubsumeeachother
Therelativepermissivenessof P1andP2directlyfollowsfromeach
scenario: P1islesspermissivethan P2,P1ismorepermissivethanP2,P1andP2areequallypermissive,or P1andP2areincompara-
ble.Thecalculationinvolvessatisfiabilitychecksoftwoformulas:
/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracketand /llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracket
â€¢If/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracketisnotsatisfiable,then P1cannotbemore
permissivethan P2(P2isatleastaspermissiveas P1).
â€¢If/llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracketisnotsatisfiable,then P2cannotbemore
permissivethan P1(P1isatleastaspermissiveas P2).
â€¢Ifboth /llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracketand /llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracketarenotsatisfiable,
then P1andP2areequivalent.
â€¢Otherwise, P1andP2donotsubsumeeachother.
Notethattheformula /llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracketcanbesimplifiedas
/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracket=/llbracketP1/rrbracketâˆ§Â¬/llbracketP2/rrbracket (11)
whichcanbecheckedusinganSMTsolver.
5 QUANTIFYING PERMISSIVENESS
TranslatinganaccesscontrolpolicyintoanSMTformulaforsat-
isfiability checking allows some permissiveness analysis, but it
doesnotgiveinsightastohowpermissiveapolicyis.Inthissec-
tion,weintroduceanovelapproachformoreprecisereasoningin
determiningthepermissivenessofasinglepolicyortherelative
permissivenessoftwopolicies.
Given P,Allow(P)isthesetofallrequestsallowedby P.Let
|Allow(P)|denotethenumberofsuchrequests.Thepermissive-
nessof Pisgivenby
|Allow(P)|=|/llbracketP/rrbracket| (12)
Where|/llbracketP/rrbracket|denotesthenumberofmodelsforformula /llbracketP/rrbracket.Using
amodelcountingconstraintsolver,wecanautomaticallycompute
thevalueof |/llbracketP/rrbracket|.Largervaluesfor |/llbracketP/rrbracket|indicateamorepermissive
policy;lowervaluesindicatealesspermissivepolicy.Ametricfor
analyzingpermissivenessofapolicyistoconsiderthelikelihood
that a randomly generated request is allowed by the policy. Let
ğ·bethesetofallpossiblerequests,with |ğ·|beingthenumber
ofallpossiblerequests.If |/llbracketP/rrbracket|=0allrequestsaredeniedby P,
if|/llbracketP/rrbracket|=|ğ·|allrequestsareallowedby P.Letğœ=(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)be
a request chosen uniformly at random from the set all possible
requests.Theprobabilitythat ğœisallowedby Pis
ğ‘(ğœ|=/llbracketP/rrbracket)=|/llbracketP/rrbracket|
|ğ·|(13)
Thiseffectivelygivespermissivenessofapolicywithrespectto
itsdomain.Higherprobabilitiesindicatemorepermissivepolicies,
lowerprobabilitiesindicateslesspermissivepolicies.Aprobability
of0.5indicatesthepolicyallowshalfofallpossiblerequests.Note
thataprobabilityof0indicatesapolicywhichdeniesallrequests
whileaprobabilityof1indicatesapolicyallowingallrequests.
Thisapproachcanbeextendedforquantifyingrelativepermis-
siveness between policies. Given policies P1,P2, the number of
requestsallowedby P1andnotallowedby P2is:
|/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracket|=|{(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’):(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)|=/llbracketP1/rrbracketâˆ§Â¬/llbracketP2/rrbracket}|(14)
Thenumberofrequestsallowedby P2andnotallowedby P1is:
|/llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracket|=|{(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’):(ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)|=/llbracketP2/rrbracketâˆ§Â¬/llbracketP1/rrbracket}|(15)
Recallthatwhencalculatingrelativepermissivenesstherearefour
possibleoutcomes: P1isequivalentto P2,P1ismorepermissive
1809ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin Prince, and Tevfik Bultan
Algorithm 1 TransformActions (ğ¹,ğ‘€):
Input:SMTformula ğ¹,mapğ‘€
Output:SMTformulawithmappingappliedtoactions
1:ifğ¹â‰¡ğ¹1âˆ¨ğ¹2then
2:returnTransformActions (ğ¹1,ğ‘€)âˆ¨TransformActions (ğ¹2,ğ‘€)
3:else ifğ¹â‰¡ğ¹1âˆ§ğ¹2then
4:returnTransformActions (ğ¹1,ğ‘€)âˆ§TransformActions (ğ¹2,ğ‘€)
5:else ifğ¹â‰¡(ğ‘ğ‘ ğ‘šğ‘¡=ğ‘)then return (ğ‘ğ‘ ğ‘šğ‘¡=ğ‘€(ğ‘))
6:else ifğ¹â‰¡(ğ‘ğ‘ ğ‘šğ‘¡â‰ ğ‘)then return (ğ‘ğ‘ ğ‘šğ‘¡â‰ ğ‘€(ğ‘))
7:else ifğ¹â‰¡(ğ‘ğ‘ ğ‘šğ‘¡âˆˆğ‘Ÿğ‘’ğ‘”ğ‘’ğ‘¥)then
8:ğ¹/prime=False
9:forğ‘ğ‘–âˆˆGetActionsFromRegex (ğ‘Ÿğ‘’ğ‘”ğ‘’ğ‘¥)do
10: ğ¹/prime=ğ¹/primeâˆ¨(ğ‘ğ‘ ğ‘šğ‘¡=ğ‘ğ‘–)
11:end for
12:returnTransformActions (ğ¹/prime,ğ‘€)
13:end if
14:returnğ¹
thanP2,P1islesspermissivethan P2,orP1andP2areincomparable.
Usingequations14,15:
â€¢IfP1ismorepermissivethan P2then|/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracket|quanti-
fieshowmuchmorepermissive P1isthan P2
â€¢IfP2ismorepermissivethan P1then|/llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracket|quanti-
fieshowmuchmorepermissive P2isthan P1
â€¢IfP1andP2donotsubsumeeachother, |/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracket|and
|/llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracket|can be used to determine which policy is
objectively more permissive (totalrequestsallowed)
6 CONSTRAINT TRANSFORMATION
Inthissectionwepresentaheuristicthattransformsasetofequality
andinequalityconstraintsforastringvariabletoasetofrange
constraints on an ordered set. We do this by mapping a set of
stringconstantstoanorderedsetofvalues.Aswediscussbelow,
thisenablesustocompactlyencodeconstraintsonpolicyactions
extractedfromaccesscontrolpolicies.
Inpractice,thereareafinitenumberofvalidactionsinanaccess
controlpolicy.Forexample, s3:GetObject isavalidaction,butthe
fictitiousaction s3:FooBar isnot.Forouranalysistobeprecise,
constraintsspecifyingvalidactionsmustbespecified.Recallthat
/llbracketP/rrbracketistheconstraintformulaextractedfrompolicy P.I.e., /llbracketP/rrbracketâ‰¡ğ¹
whereğ¹isanSMTformula.Inaformula ğ¹extractedfromanaccess
controlpolicy,weobservethreetypesoftermsthatinvolveactions
ğ‘ğ‘ ğ‘šğ‘¡=ğ‘ğ‘ ğ‘ ğ‘šğ‘¡â‰ ğ‘ğ‘ ğ‘ ğ‘šğ‘¡âˆˆğ‘Ÿğ‘’ğ‘”ğ‘’ğ‘¥(16)
whereğ‘isastringconstantand ğ‘Ÿğ‘’ğ‘”ğ‘’ğ‘¥isaregularexpression.We
first consider cases where only the first two types of terms are
present in a formula, and then discuss how the transformation
handlesregularexpressionconstraints.Considertheformula:
ğ¹â‰¡(ğ‘ğ‘ ğ‘šğ‘¡=s3:ListBucket )
âˆ¨(ğ‘ğ‘ ğ‘šğ‘¡=s3:ListBucketVersions )
âˆ¨(ğ‘ğ‘ ğ‘šğ‘¡=s3:ListBucketMultipartUploads )(17)
Bymapping s3:ListBucket â†¦â†’0,s3:ListBucketVersions â†¦â†’1,
s3:ListBucketMultipartUploads â†¦â†’2,ğ¹canberewrittenas
ğ¹â‰¡(ğ‘ğ‘ ğ‘šğ‘¡â‰¥0âˆ§ğ‘ğ‘ ğ‘šğ‘¡â‰¤2) (18)
Theuseofrangeconstraintsgivesamorecompactencodingfor
constraintson policyactions, particularlywhenthereisa large
numberofconstraintsonpolicyactions(suchastheconstraints
specifyingthesetofallvalidactions). WeintroduceaconstraintAlgorithm 2 DisjunctionToRange (ğ¹):
Input:SMTformula ğ¹withmappedactions
Output:TransformedSMTformulawithdisjunctionscollapsedintorange
constraintswhenpossible
1:ifğ¹â‰¡ğ¹1âˆ¨...âˆ¨ğ¹ğ‘›then
2:ğ¹ğ‘…=False
3:ğ¹/prime=False
4:ğ‘†={}
5:forğ¹ğ‘–âˆˆ{ğ¹1,...,ğ¹ ğ‘›}do
6: ifğ¹ğ‘–â‰¡(ğ‘ğ‘ ğ‘šğ‘¡=ğ‘)then
7: ğ¹ğ‘…=ğ¹ğ‘…âˆ¨ğ¹ğ‘–
8: ğ‘†=ğ‘†âˆª{ğ‘}
9: else
10: ğ¹/prime=ğ¹/primeâˆ¨DisjunctionToRange (ğ¹ğ‘–)
11: end if
12:end for
13:ifsize(ğ‘†)â‰¥2andsize(ğ‘†)âˆ’1=max(ğ‘†)âˆ’min(ğ‘†)then
14: returnğ¹/primeâˆ¨(ğ‘ğ‘ ğ‘šğ‘¡â‰¥min(ğ‘†)âˆ§ğ‘ğ‘ ğ‘šğ‘¡â‰¤max(ğ‘†))
15:else
16: returnğ¹/primeâˆ¨ğ¹ğ‘…
17:end if
18:else ifğ¹â‰¡ğ¹1âˆ§...âˆ§ğ¹ğ‘›then
19:ğ¹/prime=True
20:forğ¹ğ‘–âˆˆ{ğ¹1,...,ğ¹ ğ‘›}do
21: ğ¹/prime=ğ¹/primeâˆ§DisjunctionToRange (ğ¹ğ‘–)
22:end for
23:returnğ¹/prime
24:end if
25:returnğ¹
transformationwhichtransformstheconstraintsonvalidactions
intoamuchsmallersetofrangeconstraints.Let ğ‘‰(ğ‘)bethesetof
allvalidactions.Thekeyinsightisthattheset ğ‘‰(ğ‘)canbemapped
toatotallyorderedset ğ‘‰/prime(ğ‘)whichcanbecompactlyrepresented
usingacombinationofequalityandinequalityconstraints.The
mappingand ğ‘‰/prime(ğ‘)arestraightforwardtoconstruct:eachvalid
actionğ‘âˆˆğ‘‰(ğ‘)ismappedtoauniqueinteger ğ‘–âˆˆ[0,|ğ‘‰(ğ‘)|âˆ’1],
andğ‘‰/prime(ğ‘)isthesetofallsuchintegers.
Theconstrainttransformationheuristicconsistsoftwophases:
thefirstappliesthemappingtoconstraintsonactions,thesecond
transformsdisjunctionconstraintsintorangeconstraints.Givena
constraintformulainnegationnormalformandtheactionmapping,
Algorithm1firsttransformsconstraintscontainingactionvariable
ğ‘ğ‘ ğ‘šğ‘¡soitisconsistentwiththemapping.Forconstraints ğ‘ğ‘ ğ‘šğ‘¡=ğ‘
orğ‘ğ‘ ğ‘šğ‘¡â‰ ğ‘whereğ‘issomestringconstant, ğ‘isreplacedbytheinte-
geraccordingtothemapping.Forregularexpressionconstraintson
actionğ‘ğ‘ ğ‘šğ‘¡âˆˆğ‘Ÿğ‘’ğ‘”ğ‘’ğ‘¥,thefunction GetActionsFromRegex (ğ‘Ÿğ‘’ğ‘”ğ‘’ğ‘¥)
returnsallvalidactionssatisfiedbytheregex(thenumberofvalid
actionsisfinite)andadisjunctiononallpossibilitiesisreturned:
e.g.,iftheconstraintis (ğ‘ğ‘ ğ‘šğ‘¡âˆˆs3:ListBâˆ—)(whereâˆ—correspondsto
awildcard)thenGetActionsFromRegexreturnstheonlyvalidac-
tionsmatchingtheregex,s3:ListBucket,s3:ListBucketVersions,
s3:ListBucketMultipartUploads.Aftertheactionconstraints
havebeenmapped,Algorithm2attemptstotransformequalitycon-
straintsonactionsunderasingledisjunctionintorangeconstraints
(suchasinequation18).Ifthetransformationisnotpossible(e.g.,
theconstantsarenotcontiguous)theinputformulaisreturned.
7 ANALYZING AWS AND AZURE POLICIES
Basedonourproposednotionofpolicypermissivenessandour
approach for quantifying permissiveness, we have developed a
differentialpolicyanalysisframeworkforpermissivenessanalysis
ofaccesscontrolpolicies.Ourframeworkisgeneralenoughtobe
1810Quantifying Permissiveness of Access Control Policies ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
appliedtoavarietyofpolicieswritteninmultiplepolicylanguages.
Todemonstratetheeffectivenessofourapproach,weshowthatit
canbeappliedtoexistingrealworldaccesscontrolmodels:policies
forAWSIAMandMicrosoftAzure.
7.1 Translation and Implementation
ScopeandTranslationoftheAWSPolicyLanguage. TheAWSpol-
icylanguageisenormous,witheachservicehavingitsownrules
onactionsandresources.Weconsiderthreeofthemostpopular
AWSservices:ElasticComputeCloud(ec2),IdentityandAccess
Management(iam),andSimpleStorageService(s3).Weconsider
two levels of constraints for each service. First, actions are con-
strainedtothesetofactionsdefinedbytheservice.s3:ListBucket
or s3:PutObject are valid s3 actions but s3:FooBar is not. Sec-
ond, actions and resource types are constrained by each other:
certainactionscanactonlyoncertainresourcetypes;e.g.,action
S3:ListBucketoperatesonresourcearn:aws:s3:::bucket.Addi-
tionally,resourcetypesareconstrainedbynamingrequirements;
e.g.,lengthofbucketnamesisbetween3and63characters
An AWS policy is a list of statements, each statement allow-
ing or denying access for a given set of principals, actions and
resources.Foreachstatement,wecreatearule ğœŒcapturingitsse-
mantics.Principals,actions,andresourceswithinastatementmap
toÎ”,ğ´,ğ‘…inğœŒ.Modelingconditionsintoenvironmentattributesof
ğ¸ismorecomplex.Eachconditionkeytogetherwithacondition
operator specifies values for which access is allowed or denied.
Theenvironmentattributesarethusasetoftuplesspecifyingthe
conditionkeyandtheirrespectivevalues,wherethenumberof
tuplesdependsontheconditionoperator.Forwildcardoranychar
(â€˜âˆ—â€™,â€˜?â€™)symbols,weuseregularexpressionstocapturethesetof
allowed strings. For example, resource=bucketâˆ—translates to
(matchresource/bucket.*/ )whereâ€˜.â€™correspondstoanychar,â€™/â€™de-
notesthestartandendofaregularexpression,â€˜*â€™representsKleene
star.WehandleconditionoperatorssuchasStringLikesimilarly.
ScopeandTranslationoftheAzurePolicyLanguage. LikeAWS,
eachAzureservicehasitsrespectivesetofrulesonactionsand
resources.WeconsiderAzureVMsandBlobStorage,whichare
analogoustoec2ands3.Weconsiderthesametwolevelsofcon-
straintsaswedoforAWS.
AnAzureâ€œpolicyâ€isgivenbyalistofroledefinitionsandalistof
roleassignments.Wejointhemtogetheronthe roleDefIdintorules
ğœŒ.Foreach ğœŒ,wemap principalId toÎ”,(ğ´ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ âˆªğ·ğ‘ğ‘¡ğ‘ğ´ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘  )\
(ğ‘ğ‘œğ‘¡ğ´ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘  âˆªğ‘ğ‘œğ‘¡ğ·ğ‘ğ‘¡ğ‘ğ´ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘  )toğ´,andğ‘ ğ‘ğ‘œğ‘ğ‘’toğ‘….Thecondition
isparsedintoatreewhoseleavesspecifyconditionkeysandtheir
respectivevalues;thesearetheenvironmentattributes.Likefor
AWS,weuseregexforwildcards.
TranslatingActionandResourceTypeConstraints. LetTbethe
setofconstraintsrepresentingactionandresourcetyperestrictions.
Equation12nowbecomes
|/llbracketP/rrbracket|=|/llbracketP/rrbracketâˆ§T| (19)
Forcomparingmultiplepolicies,equations14,15become
|/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracket|=|(/llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracket)âˆ§T|(20)
|/llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracket|=|(/llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracket)âˆ§T|(21)Algorithm 3 TranslatePolicy (P):
Input:policy P
Output:SMTformula /llbracketP/rrbracketencoding P
1:/llbracketPAllow /rrbracket=False
2:/llbracketPDeny/rrbracket=False
3:forruleğœŒinPdo
4: /llbracketğ›¿/rrbracket=Encode(ğœŒ(ğ›¿))
5: /llbracketğ‘/rrbracket=Encode(ğœŒ(ğ‘))
6: /llbracketğ‘Ÿ/rrbracket=Encode(ğœŒ(ğ‘Ÿ))
7: /llbracketğ‘’/rrbracket=Encode(ğœŒ(ğ‘’))
8: /llbracketğœŒ/rrbracket=/llbracketğ›¿/rrbracketâˆ§/llbracketğ‘/rrbracketâˆ§/llbracketğ‘Ÿ/rrbracketâˆ§/llbracketğ‘’/rrbracket
9:ifğœŒâˆˆ/llbracketPAllow /rrbracketthen /llbracketPAllow /rrbracket=/llbracketPAllow /rrbracketâˆ¨/llbracketğœŒ/rrbracket
10:else /llbracketPDeny/rrbracket=/llbracketPDeny/rrbracketâˆ¨/llbracketğœŒ/rrbracket
11:end if
12:end for
13:return /llbracketP/rrbracket=/llbracketPAllow /rrbracketâˆ§Â¬/llbracketPDeny/rrbracket
Algorithm 4 Permissiveness (P,ğ‘):
Input:policy P,boundğ‘
Output:permissivenessof P
1:/llbracketP/rrbracket=TranslatePolicy( P)
2:T=GetTypeConstraints()
3:ifIsSAT( /llbracketP/rrbracketâˆ§T)then return CountModels( /llbracketP/rrbracketâˆ§T,ğ‘)
4:else return 0
5:end if
Algorithm 5 RelativePermissiveness (P1,P2,ğ‘):
Input:policies P1,P2;boundğ‘
Output:relativepermissivenessof P1,P2
1:/llbracketP1/rrbracket=TranslatePolicy( P1)
2:/llbracketP2/rrbracket=TranslatePolicy( P2)
3:T=GetTypeConstraints()
4:ğ¹1=/llbracketP1/rrbracketâˆ§Â¬/llbracketP2/rrbracketâˆ§T
5:ğ¹2=/llbracketP2/rrbracketâˆ§Â¬/llbracketP1/rrbracketâˆ§T
6:ifIsSAT(ğ¹1)and notIsSAT(ğ¹2)then
7:return"P1ismorepermissive",CountModels( ğ¹1,ğ‘)
8:else if not IsSAT(ğ¹1)andIsSAT(ğ¹2)then
9:return"P2ismorepermissive",CountModels( ğ¹2,ğ‘)
10:else if not IsSAT(ğ¹1)and notIsSAT(ğ¹2)then
11:return"P1andP2areequivalent"
12:else ifIsSAT(ğ¹1)andIsSAT(ğ¹2)then
13:return"P1andP2donotsubsumeeachother",
14: CountModels( ğ¹1,ğ‘),CountModels( ğ¹2,ğ‘)
15:end if
We implement translation for T for AWS by scraping the AWS
resource andproperty typesreferencewebpages toidentify the
resourcetypeseachactioncanoperateon.ForAzure,wegenerate
constraintsbyreadingaCSVfilefromtheAzurePortalthatrelates
actionstoresourcetypes.Notethatpriorwork[ 11,20]doesnot
considertypeconstraintsintheiranalysisofaccesscontrolpolicies.
Policy Translator. Basedonourapproach,weimplementedan
open-sourcetoolcalledqackythatquantifiespermissivenessor
relativepermissivenessbytranslatingpoliciesintoSMTformulas
andpassingtheformulastoamodelcountingconstraintsolver.Our
implementationusesthepopularAutomata-basedModelCounter
(ABC)[8,9]whichusesautomata-theoretictomodelcountstring
andnumericconstraints.ABCcountssatisfyingsolutionstothe
formulabyconstructingautomataforanSMTformulaandperform-
ingpathcountingontheautomata.SMTformulasfromqacky
canalsobefedintootherSMT-LIB-conformantconstraintsolvers,
suchasMicrosoftZ3.
1811ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin Prince, and Tevfik Bultan
qackytranslatesapolicy PintoaSMTformula /llbracketP/rrbracketbytrans-
latingeachrule ğœŒ,asshowninAlgorithm3.Toquantifytheper-
missivenessofapolicy P,qackytranslates P,appendsthetype
constraintsT,andcallsABCtocountthesolutionssatisfying /llbracketP/rrbracketâˆ§T,
asshowninAlgorithm4.Toanalyzetherelativepermissiveness
betweentwopolicies P1andP2,qackyproducestwoSMTfor-
mulas /llbracketP1/rrbracket/negationslashâ‡’/llbracketP2/rrbracketand /llbracketP2/rrbracket/negationslashâ‡’/llbracketP1/rrbracketandcallsABCtochecktheir
satisfiabilityandtocountmodels,asshowninAlgorithm5.
8 EXPERIMENTAL EVALUATION
Below,wefirstdescribeourmethodologyforgatheringpolicies;
thenwediscussthefourexperimentsweconductedtoevaluateour
approachanditsimplementationinqacky1.Thefirstexperiment
benchmarksqacky,anditevaluatesqackyâ€™sperformanceand
identifieswhichfactorsinfluencetheanalysis.Thesecondexper-
imentevaluateshoweffectiveqackyisatreasoningaboutthe
relativepermissivenessofaccesscontrolpolicies.Thethirdexperi-
mentcomparestheperformanceof qackywithanenumerative
modelcountingapproachbasedonSMTsolvers.Thefourthex-
perimentdemonstratesthatourapproachcanbeappliedtoAzure
policies.Unlessotherwisenoted,allexperimentsusetheconstraint
transformationheuristic,andincludetypeconstraints.
Intheexperimentsreportedbelowweassumestringvariables
(principal,action,resource,conditionkeys)containanyofthe256
ASCIIcharactersandatmost100characterslong,unlessotherwise
specified.Wereportpermissivenessasnumberofrequestsallowed
(arequestisatuple (ğ›¿,ğ‘,ğ‘Ÿ,ğ‘’)).Resultsarereportedinlog-scale.
For all experiments, we use a desktop machine with an Intel i5
3.5GHzX4processor,128GBDDR3RAM,withaLinux4.4.0-198
64-bitkernel,Z3v4.8.11,andthelatestbuildofABC2.
8.1 Policy Datasets
Duetosecurityimplicationsofmakingaccesscontrolpoliciesthat
areusedinanorganizationpublic,policiesthatarebothpublicly
availableandrepresentativeofreal-worldpoliciesarepractically
non-existent.WeareunawareofanysuchdatasetforneitherAWS
(thosein[11,21]werenotreleasedtothepublic)norAzurepolicies.
Toevaluateourapproach,acomprehensivedatasetisrequired.We
usetwoAWSpolicydatasetscollectedfromusersandarguethese
datasetsarerepresentativeofreal-worldpoliciesandcomprehen-
siveenoughtoshowthatourapproachiseffective.Wealsocompile
adatasetofAzureroledefinitionsfromMicrosoftDocs.
ObtainingAWSPoliciesfromUsers. Thelackofpubliclyavailable
policydatasetsforAWSmeansthatfindingqualitypoliciesisa
cumbersometask.AWSuserstendnottosharepoliciespossibly
containingsensitivedata(policiescanleakorganizationstructure).
However, we found this to notbe the case when users needed
assistancedesigninganddebuggingtheirpolicies.AWSpolicies
canbecomplexandunwieldy,especiallytothoseunfamiliarwith
accesscontrol.Consequently,AWSprovidesforumswhereusers
needingassistanceoftenposttheirpoliciesandotherusers(and
AWSemployees)canprovideassistance.Suchpoliciesareusually
sanitizedandvaryincomplexity,makingtheAWSforumsagood
sourceforcompilingadataset.
1Toolandbenchmarksavailableathttps://github.com/vlab-cs-ucsb/quacky
2https://github.com/vlab-cs-ucsb/ABCAWSPolicySelectionCriteriaandBreakdown. Asof2021,AWS
offersmorethan200services,manyofwhichuseaccesscontrol
policiesandallofwhichhavededicatedforums.Wesearchedfor
policiesbasedonseveralcriteria.Wefocusedoniam,s3,andec2
astheyareamongthemostpopularservicesandaremorelikely
toyieldthebestsampleofpolicies.Ourgoalwastohaveagood
balanceofsimpleandcomplexpoliciesaswellaspolicysets,and
weonlyincludedpoliciesthataresemanticallyvalid.
Outofseveralhundredforumpostsdatingbackseveralyears,
weidentified30postscontainingatotalof41well-formedpolicies
(the vast majority of posts either contained no policies or frag-
mented/invalidpolicies):fromec29postswithsinglepoliciesand
2postswithmultiplepolicies(4policies),fromiam2postswith
singlepoliciesand3postswithmultiplepolicies(6policies),from
s39postswithsinglepoliciesand5postswithmultiplepolicies(11
policies).Fromourobservations,wefoundthatwhenuserssought
assistanceviatheforums,theyoftenonlypostedasinglepolicyin
isolation.Only10postscontainedeithermultipleversionsofthe
samepolicyormultiplepoliciescombinedtogetherinapolicyset
(multipleAWSpoliciescanbecombinedintoasinglepolicy).
Synthesizing AWS Policies Through Mutations. We synthesize
AWSpoliciesthroughmutationsfortworeasons.First,wewanta
largerdatasetonwhichtoevaluateourpolicyanalysisframework
andtool.Second,wewanttomimicrealisticscenarioswherethe
semanticmeaningofapolicyisslightlymodifiedbyanemployee
withinsomeorganization.Modificationstoapolicycanalterthe
permissivenessofapolicyinwaysindiscerniblewithoutintensive
manualinspection.Asimplemodificationcouldallowonemore
useraccesstoaresourceoritcouldallowonethousandmoreusers
access to a resource; in either case, the modified policy is more
permissivebutclearlydiffersinmagnitude.Synthesizingpolicies
throughmutationisoneapproachformodelingsuchscenarios.
Weuseideasfrommutationtestingtosynthesizepolicies[ 53,65].
Mutationtestingisawidelyusedsoftwaretestingtechniquefor
measuringtestsuitestrength.Thetechniqueappliesmutationsto
aprogramundertesttogeneratevariationsoftheprogram,and
evaluatesthemagainstatestsuite.Afaultyprogram,ormutant,is
killedifatleastonetestinthesuitefails.Themoremutantskilled,
thehighertheconfidenceinthetestsuite.
We synthesize mutants of a policy with mutations intended
toalterthepermissivenessofapolicy,whichweusetoevaluate
theeffectivenessofourapproach.Weimplementthreetypesof
mutationswhichmimicrealisticscenariosandgenerallyyieldmore
permissivemutants:
(1)Ifastatementâ€™s EffectisDeny,changeitto Allowandnegate
thestatementâ€™s ActionandResourcekeystoNotActionand
NotResource orviceversa.
(2)Ifastatementâ€™s ActionorResourcevaluesarelists,change
themtoasinglestringcontainingawildcard.Forexample,
anActionlistcontainings3:ListBucketands3:GetObject
ischangedtoasinglestrings3:*.
(3) Ifastatementcontainsany Conditions,removethem.
Foreachstatementofagivenpolicy,wecreateasetofapplicable
mutationtypes.Forexample,considerastatementwithan Allow
effect,alistof Actionvalues,anda Condition.Thesetofapplicable
mutationsis{ type2,type3 }becausethetype1mutationdoesnot
1812Quantifying Permissiveness of Access Control Policies ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Table 1: Times for each AWS service, with and without the
constraint transformation heuristic. Times are in seconds.
WithoutTransformation WithTransformation
Min Max Avg Min Max Avg
ec22.08 880.18 128.98 0.50 33.41 10.11
iam0.26 8.65 1.50 0.16 0.71 0.27
s30.06 29.60 3.64 0.05 7.37 0.77
Table 2: Results for each AWS service, with and without
type constraints. Permissiveness is the number of requests
allowed. AM is Arithmetic Mean, GM is Geometric Mean.
Avgexectime(s) ğ‘™ğ‘œğ‘”2(AM) ğ‘™ğ‘œğ‘”2(GM)
NoType Type NoType Type NoType Type
ec20.6510.111,705.651,579.70 1,308.86 918.49
iam0.050.271,598.601,321.92 827.41669.75
s30.520.772,494.852,344.58 1,499.671,432.77
apply to the Alloweffect. The power set of applicable mutation
typesrepresentscombinationsofmutationsthatcanbeappliedto
thatstatement.Thus,wecreatesuchapowersetforeachstatement.
Bychoosingonesetfromeachpowersetandapplyingthemutation
typesinthatsettoitsrespectivestatement,weoutputamutated
policy. From 9 original ec2 policies, we generated 240 mutants.
From6originaliampolicies,wegenerated26mutants.From14
originals3policies,wegenerated280mutants.Intotal,from29
originalpolicies,wegenerated546mutants.
ObtainingAzure Policiesfrom MicrosoftDocs. Asof2021,Azure
comprisesmorethan200servicesand120built-inroles.Weare
unawareofanyforumswhereuserspostcustomroledefinitions,so
wesearchedMicrosoftDocsforbuilt-inroledefinitions.Wefocused
onAzureVMsandBlobStoragebecausetheyareanalogoustoec2
ands3.Weobtained2policiesfromVMsand3fromBlobStorage
forourproofofconcept.
8.2 qacky Benchmarking
Thegoaloftheseexperimentsistoevaluateqackyâ€™sperformance
andidentifywhichfactorsinfluencetheeffectoftheanalysis(in
termsofcountsandtimetaken).Weevaluatetheperformanceand
effectivenessof qackyon41policiestakenfromAWSforums.
Firstweevaluatetheeffectivenessoftheconstrainttransformation
heuristicfromSection5byanalyzingeachpolicy,withtypecon-
straints,twice,bothwithouttheheuristicandwiththeheuristic
enabled.Then,weanalyzeeachpolicytwice,oncewithouttype
constraintsandoncewithtypeconstraints.
EffectivenessofConstraintTransformation. Theresults,separated
byAWSservice,areshowninTable1.Thedecreaseinminimum
timeswiththeconstrainttransformationheuristicwasbetween
16%fors3to76%forec2.Themaximumtimesdecreasedbetween
75%fors3to96%forec2.Theresultsforaveragetimesweresimilar,
withadecreaseofbetween78%fors3to92%forec2.Theheuristicreducedtheminimum,maximum,andaveragetimesbyaboutan
orderofmagnitudeforec2,butnotasmuchforiamands3.This
maybebecauseec2hasmoreactions(311asofwriting)thanboth
iam(183)ands3(223),andthusitmayreapmorebenefitsfrom
rangeconstraintsasopposedtoequalityconstraints.
Impact of Type Constraints. TheresultsforeachAWSservice
areshowninTable2.Outofthe41policies,1policyallowedno
requestbothwithandwithouttypeconstraints;1policyallowed
requestswithouttypeconstraintsbutallowednonewhentypecon-
straintswerepresent.Withouttypeconstraints,qackyanalyzed
eachpolicyinunderasecond.Typeconstraintsslowtheanaly-
sisconsiderablybutdrasticallyeffectpermissiveness,decreasing
thenumberofallowedrequestsbyhundredsofordersofmagni-
tude.Thisisduetotypeconstraintsrestrictingthesetofpossible
actionsandconstrainingactionstoonlyactonspecificresource
types.Typeconstraintsrepresentallpossibleactionandresource
typerestrictionsandmustbeexplicitlyenumeratedwithinthecon-
straint,slowingdowntheanalysis.Foreverypolicy,thepresenceof
typeconstraintsresultedinamorepreciseanalysis.Withouttype
constraintstomodelthesemanticsofthepolicylanguage,qacky
givesanoverapproximation ofthepermissivenessforapolicy.
8.3 Relative Permissiveness Quantification
Thegoalofthisexperimentistoevaluatehoweffectiveqacky
isatreasoningabouttherelativepermissivenessofaccesscontrol
policies,andtoshowcasetheeffectivenessofquantifyingrelative
permissivenessingeneral.Weevaluatetheeffectivenessof qacky
in quantifying relative permissiveness between a policy and its
synthesizedmutants.Werecordtheaveragetimesanddifferences
inpermissivenessbetweenthemutantsandtheoriginalpolicy.
Eachpolicy Piscomparedagainsteveryoneofitsmutants Pğ‘š
twice:oncetoquantifythenumberofrequestsallowedby Pbut
notPğ‘šandoncetoquantifythenumberofrequestsallowedby Pğ‘š
butnot P.Weusedtypeconstraints,constrainttransformation,and
atimeoutof10minutesforeachpairofcomparisons.Theresults
areshowninTable3.Thethirdcolumnshowstheaveragetime
acrossallpairsofcomparisons.
Columns3-6ofTable3showthedistributionofpermissiveness
between each policy and its mutants. The majority of mutants
wereeitherlesspermissive,morepermissive,orequivalenttothe
originalpolicy.Columns7-10showtheresultsofquantifyingthe
differenceinpermissivenesswheneverapolicyanditsmutantwere
notequivalentanddidnotsubsumeeachother.Foreachpolicy
anditssetofmutants,columns7and8reportthearithmeticand
geometricmeansforthenumberofrequestsallowedby Pbutnotby
Pğ‘š.Conversely,columns9and10reportthemeansforthenumber
ofrequestsallowedby Pğ‘šbutnotby P.
8.4 Comparison with Enumerative Model
Counting
SAT/SMT solvers have been used in prior access control policy
analysistechniquestoresolvequeriesaboutpolicybehavior(e.g.,
Zelkova,Margrave[ 11,33,51]).Thisofteninvolvesenumeratingthe
setofsolutionstothequery,throughrepeatedcallstoaconstraint
solver.Ineachcall,theconstraintsarerevisedbyappendingthe
negationofallpriorsolutions.Ourapproachdiffersfundamentally
1813ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin Prince, and Tevfik Bultan
Table3:ResultsforAWSpoliciescomparedwiththeirmutants.Arithmetic/GeometricMean(AM/GM)fornumberofrequests
allowed(log-scale, âŠ¥usedwhenthecountis 0)arereportedwhenthemutantislessormorepermissivethanitsoriginalpolicy.
PolicyAvgexec # Pğ‘šLess # Pğ‘šMore#Equivalent#Neither Pğ‘šLesspermissive Pğ‘šMorepermissive
time(s) permissive permissive subsumes log2(AM)log2(GM)log2(AM)log2(GM)
[ec2]P1 30.23 0(0%) 60(93.8%) 4(6.3%) 0(0%) âŠ¥ âŠ¥1823.2 1614.7
[ec2]P2 85.18 0(0%) 28(87.5%) 4(12.5%) 0(0%) âŠ¥ âŠ¥1361.5 1162.8
[ec2]P3 57.79 0(0%) 6(75%) 2(25%) 0(0%) âŠ¥ âŠ¥1331.8 993.2
[ec2]P4 71.64 0(0%) 12(75%) 4(25%) 0(0%) âŠ¥ âŠ¥ 461.8 431.6
[ec2]P5 24.48 0(0%) 12(37.5%) 4(12.5%) 16(50%) âŠ¥ âŠ¥1197.7 788.9
[ec2]P6 45.68 4(25%) 8(50%) 0(0%) 4(25%) 461.4 292.7 123.1 123.1
[ec2]P7 47.29 0(0%) 28(87.5%) 4(12.5%) 0(0%) âŠ¥ âŠ¥1361.5 1008.3
[ec2]P8 170.28 8(25%) 0(0%) 24(75%) 0(0%) 154.1 154.1 âŠ¥ âŠ¥
[ec2]P9 3.11 0(0%) 0(0%) 8(100%) 0(0%) âŠ¥ âŠ¥ âŠ¥ âŠ¥
[iam]P10 1.38 0(0%) 2(50%) 2(50%) 0(0%) âŠ¥ âŠ¥ 486.7 486.7
[iam]P11 4.71 0(0%) 6(75%) 2(25%) 0(0%) âŠ¥ âŠ¥1385.0 1288.9
[iam]P12 1.05 0(0%) 2(50%) 2(50%) 0(0%) âŠ¥ âŠ¥ 486.6 486.6
[iam]P13 6.13 0(0%) 0(0%) 2(100%) 0(0%) âŠ¥ âŠ¥ âŠ¥ âŠ¥
[iam]P14 0.92 0(0%) 2(50%) 2(50%) 0(0%) âŠ¥ âŠ¥ 5.6 5.6
[iam]P15 3.60 0(0%) 2(50%) 2(50%) 0(0%) âŠ¥ âŠ¥2124.9 2124.9
[s3]P16 2.286(37.5%) 4(25%) 4(25%) 2(12.5%) 628.9 628.9 684.7 684.7
[s3]P17 1.37 0(0%) 6(75%) 2(25%) 0(0%) âŠ¥ âŠ¥2287.3 1953.9
[s3]P18 1.02 0(0%) 6(75%) 2(25%) 0(0%) âŠ¥ âŠ¥ 800.4 536.2
[s3]P19 10.22 2(25%) 4(50%) 2(25%) 0(0%) 1484.7 1484.7 1276.9 1276.9
[s3]P20 3.46 0(0%) 0(0%) 16(100%) 0(0%) âŠ¥ âŠ¥ âŠ¥ âŠ¥
[s3]P21 1.38 0(0%) 12(75%) 4(25%) 0(0%) âŠ¥ âŠ¥ 684.7 684.7
[s3]P22 10.56 16(25%) 40(62.5%) 8(12.5%) 0(0%) 2192.0 2192.0 2294.7 2268.8
[s3]P23 2.51 0(0%) 8(50%) 8(50%) 0(0%) âŠ¥ âŠ¥ 5.6 5.6
[s3]P24 2.83 0(0%) 0(0%) 4(100%) 0(0%) âŠ¥ âŠ¥ âŠ¥ âŠ¥
[s3]P25 2.06 0(0%) 4(50%) 4(50%) 0(0%) âŠ¥ âŠ¥2144.0 2144.0
[s3]P26 0.67 0(0%) 10(62.5%) 6(37.5%) 0(0%) âŠ¥ âŠ¥1479.1 1435.1
[s3]P27 5.066(18.8%) 20(62.5%) 4(12.5%) 2(6.3%) 2056.0 2056.0 2378.8 2273.9
[s3]P28 2.57 0(0%) 2(50%) 2(50%) 0(0%) âŠ¥ âŠ¥ 684.7 684.7
[s3]P29 76.08 8(12.5%) 24(37.5%) 24(37.5%) 8(12.5%) 2076.9 2076.9 2268.9 2268.9
0 5 10 15 201Â·10âˆ’22Â·10âˆ’23Â·10âˆ’2%of qackyâ€™s0 5 10 15 204Â·10âˆ’58Â·10âˆ’51.2Â·10âˆ’4
Figure 3: Counts for the enumerative approach as percent-
age of the count from qacky on a simple policy over a 20
minute period, for bounds 18 (left) and 19 (right).
aswedonotrelyonenumeratingsolutionsbyrepeatedlycallinga
constraintsolver,butratherweuseamodelcountingconstraint
solver(ABC)thatcancountallsolutionsinasinglecall.
Intheseexperimentswecompareourapproachtoanenumer-
ativeapproachusingtheZ3SMTconstraintsolver[ 27,49].First,
weanalyzeasimplepolicyallowing2s3actionson2resources:
arn:aws:s3:::foo*andarn:aws:s3:::bar.Wevariedthestringbound
from16to21toletthewildcardmatch0to5characters(resp.),and
weseta20minutetimeout.Forbounds16and17,bothapproaches
finishedcounting4and516modelsin0.15and16.77seconds(resp.)Table 4: Average model counting rates for the enumerative
approach and qacky, with type constraints. The formerâ€™s
averagemodelcountingratesinthefirsthalf(0-5min.)and
secondhalf(5-10min.)ofthe10minutetimeoutintervalare
reported.
Averagemodelscountedpersecond
Enum.(0-5min.) Enum.(5-10min.) qacky
ec2 2.33 1.32 10474.53
iam 4.02 2.30 10398.54
s3 0.94 0.76 10705.92
fortheenumerativeapproachandin0.03and0.03seconds(resp.)
forqacky.Forbounds18to21,theenumerativeapproachtimed
outaftercounting3446,3217,3340,3125models(resp.),whereas
qackyfinishedcounting1 .3Ã—105,3.4Ã—107,8.6Ã—109,2.2Ã—1012
models(resp.)withinonesecond.Theresultsforbounds18and19
areshowninFig.3.
Wealsoanalyzethe41AWSpoliciesusingbothapproaches.The
resultsareshowninTable4.Foreachnamespace,qackyyielded
1814Quantifying Permissiveness of Access Control Policies ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Table5:ResultsforAzureVMandBlobStoragepolicies,with
andwithouttypeconstraints.Permissivenessisthenumber
of requests allowed and is reported in log-scale (base 2)
Time(s) Permissiveness
NoType Type NoType Type
[VM]LoginUser 0.73 8.73 3096.01 1046.57
[VM]LoginAdmin 0.79 8.79 3096.01 1047.57
[BS]DataReader 0.36 1.43 1409.59 806.57
[BS]DataContributor 0.63 2.04 1411.18 808.89
[BS]DataOwner 0.37 3.76 2944.01 810.03
anastronomicallygreateraveragemodelcountingratethanthe
enumerativeapproach.Moreover,theaveragerateoftheenumera-
tiveapproachdecreasedbetweenthefirstandsecondhalvesofthe
10minutetimeoutinterval.Theseresultsshowthatquantifying
permissivenessusinganenumerativeapproachforpolicyanalysis
(suchas[51])basedonanoff-the-shelfSMTorSATsolverisnota
viableoptionforquantitativepermissivenessanalysis.
8.5 Microsoft Azure Policies
Thegoalofthisexperimentistodemonstratethatourapproachcan
beusedtoanalyzeAzurepolicies.LikewedidforAWS,weevaluate
theperformanceandeffectivenessofqackyonthe5policiestaken
fromMicrosoftDocs.Weanalyzeeachpolicytwice,oncewithout
type constraints and once with type constraints. Because many
stringvariablesinAzurepoliciesaremorethan100characterslong,
weassumethattheyareatmost250characterslong.
The results are shown in Table 5. Like previous experiments,
thereisatradeoffbetweentimeandpermissiveness.Withouttype
constraints,thetwoVMpoliciesseemtohavethesamepermis-
sivenessinlogscale(base2),butwithtypeconstraints,itisclear
thatmoredistinctrequestsareallowedbyLoginAdminthanby
LoginUser. The Blob Storage DataReader, DataContributor, and
DataOwnerpoliciesareincreasinglypermissive.Withouttypecon-
straints,DataOwnerseemsmuchmorepermissivethanDataReader
andDataContributor.Withtypeconstraints,weseethat2810.03dis-
tinctrequestsareallowedbyDataOwner,whereas2806.57,2808.89
distinctrequestsareallowedbyDataReader,DataContributor(resp.).
8.6 Threats to Validity
ThepoliciesextractedfromAWSforums/Azuredocumentationare
basedonasmallsampleandmaynotberepresentativeenough.We
mitigatethisthreatbyexpandingthedatasetthroughmutations,
creating a larger benchmark, and publicly releasing this bench-
mark.Ourcurrentexperimentalevaluationfocusesonasubsetof
AWS/Azureservices(s3,ec2,iamforAWSandVM,BSforAzure).
Althoughourtechniquesareextensible,extensionsofourapproach
tomoreservicesrequiresfurtherexperimentalevaluation.
9 RELATED WORK
Accesscontrolhasbeenthesubjectofextensiveresearch[ 59â€“61],
manyaccesspolicylanguageshavebeenproposed[ 1,41â€“43],andtheproblemwithaccesspoliciesbecominglargeanddifficultto
reasonabouthasbeennotedinthepast[36].
Therehasbeenearlierworkonverificationofaccesscontrol
policies [29,39], as well as on assisting policy creation [ 30,32].
Someearlierworkanalyzerolebasedaccesscontrolschemasusing
theAlloyanalyzer[62,66].
TheworkmostcloselyrelatedtoourworkisthatofZelkova[ 11].
Zelkovaisaclosed-sourcetoolforanalyzingpropertiesofAWS
policieswhichcanautomaticallycomparetwoAWSpoliciesand
determinewhetheroneismorepermissivethantheother.Thetwo
crucialdistinctionsbetweenZelkovaandourworkisthat(1)we
provideageneralpolicyframeworkforanalyzingaccesscontrol
policieswhichcanbeappliedtootherpolicylanguages,and(2)
weintroduceanovelapproachforquantifyingthepermissiveness
ofaccesscontrolpolicies(ratherthanabinaryyes/noanswerin
Zelkova).BothourworkandZelkovabuildfromideasfromtheSAT-
basedcheckingofXACML[ 37].Intheirapproach,Hughesetaluse
aboundedapproachtoanalyzepropertiesofXACMLpolicieswith
SATsolvers.RecentworkhasbuiltuponZelkova[ 21]butdoesnot
providequantitativeassessmentsofpermissiveness.Margrave[ 34]
isatoolthatanalyzesXACMLpoliciesusingamulti-terminaldeci-
siondiagrams.Margravegoesbeyondbinary/ternarydifferential
analysis, allowing a user to write general-purpose queries over
changes to a policy. In a later work [ 51], Margrave uses a SAT
solvertoenumerativelyproducesetsofsolutionstoqueries.Our
experimentsshowthatthistypeofenumerativeanalysisapproach
isnotnearlyscalableenoughformeaningfulquantitativeanalysis.
Verificationtechniquesforanalyzingaccesscontrolpoliciesem-
beddedinprogramshavebeenstudied[ 17,26,50].Derailerisinter-
activetoolthatletthedevelopertraversethetreeofalldataexposed
byanapplicationandinteractivelygenerateadesiredpolicy[ 50].
RubyX[26]isatoolforsymbolicexecutionforRailsthatcanbe
usedtofindaccesscontrolbugs.CanCheck[ 17]isanautomated
verificationtoolthatusesfirstorderlogicencodingandtheorem
provingforfindingaccesscontrolbugsinRailsapplications.
Differentialanalysistechniqueshavealsobeeninvestigatedin
thepast[3â€“5,15,16,44â€“46,54].Forexample,in[ 54]differential
symbolic execution is used to find differences between original
and refactored code by summarizing procedures into symbolic
constraintsandthencomparingdifferentsummariesusinganSMT
solver.SYMDIFF[ 44]computesthesemanticdifferencebetween
twofunctionsusingtheZ3SMTsolver[ 27,49].However,weare
notawareofanypriorworkonquantitativedifferentialanalysis.
10 CONCLUSIONS
Errors in access control policies used for controlling access to
datasourcesavailableoncloudserverscanhavedisastrousconse-
quences.Inthispaperwepresentedanewapproachformodeling
andquantifyingpermissivenessofaccesscontrolpolicies.Ourap-
proachreliesonmodelcountingconstraintsolverstoassessthe
permissivenessofagivenpolicy.Weimplementedthisapproach
for AWS policies and experimentally evaluated its effectiveness
onAWSpolicieswecollectedfromdiscussionforums.Ourresults
demonstratethatourquantitativepermissivenessanalysisapproach
isapplicableinpractice.Infuturework,weaimtoinvestigatehow
quantitative analysis techniques can be applied to other policy
analysisproblems,suchaspolicyrepair.
1815ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA William Eiers, Ganesh Sankaran, Albert Li, Emily Oâ€™Mahony, Benjamin Prince, and Tevfik Bultan
REFERENCES
[1]JoseL.Abad-Peiro,HervÃ©Debar,ThomasSchweinberger,andPeterTrommler.
1999.PLASâ€”PolicyLanguageforAuthorizations . TechnicalReportRZ3126.IBM
ResearchDivision. http://citeseer.nj.nec.com/abad-peiro99plas.html
[2]aleak [n.d.]. Another misconfigured Amazon S3 server leaks data of 50,000
Australians. https://www.scmagazineuk.com/another-misconfigured-amazon\-
s3-server-leaks-data-of-50000-australians/article/705125/.
[3]MuathAlkhalaf,AbdulbakiAydin,andTevfikBultan.2014. SemanticDifferential
RepairforInputValidationandSanitization.In Proceedings of the ACM SIGSOFT
International Symposium on Software Testing and Analysis (ISSTAâ€™14) .
[4]Muath Alkhalaf, Tevfik Bultan, and Jose L. Gallegos. 2012. Verifying Client-
sideInputValidationFunctionsUsingStringAnalysis.In Proceedings of the 34th
International Conference on Software Engineering (ICSE) .947â€“957.
[5]MuathAlkhalaf,ShauvikRoyChoudhary,MattiaFazzini,TevfikBultan,Alessan-
droOrso,andChristopherKruegel.2012.ViewPoints:DifferentialStringAnalysis
forDiscoveringClientandServer-SideInputValidationInconsistencies.In Pro-
ceedingsoftheACMSIGSOFTInternationalSymposiumonSoftwareTestingand
Analysis (ISSTAâ€™12) .
[6]awssupportleak [n.d.]. AWSSupportServiceRolePolicy Informational Update.
https://aws.amazon.com/security/security-bulletins/AWS-2021-007/.
[7]awssupportleakgh[n.d.]. Updatedetected. https://github.com/z0ph/MAMIP/
commit/9d72709.
[8]AbdulbakiAydin,LucasBang,andTevfikBultan.2015. Automata-BasedModel
CountingforStringConstraints.In ComputerAidedVerification-27thInterna-
tional Conference, CAV 2015, San Francisco, CA, USA, Proceedings, Part I .255â€“272.
https://doi.org/10.1007/978-3-319-21690-4_15
[9]AbdulbakiAydin,WilliamEiers,LucasBang,TeganBrennan,MiroslavGavrilov,
TevfikBultan,andFangYu.2018. Parameterizedmodelcountingforstringand
numericconstraints.In Proceedingsofthe2018ACMJointMeetingonEuropean
SoftwareEngineeringConferenceandSymposiumontheFoundationsofSoftware
Engineering, ESEC/SIGSOFT FSE 2018, Lake Buena Vista, FL, USA, November 04-09,
2018.400â€“410.
[10]azureflaw [n.d.]. Microsoft Azure cloud vulnerability is the
â€˜worst you can imagineâ€™. https://www.theverge.com/2021/8/27/
22644161/microsoft-azure-database-vulnerabilty-chaosdb?fbclid=
IwAR2nKV8uslH4EGDslnogYT4ulQRGz7NsD0xuIb3lgK2sP1-WG_O1tJbR-eE.
[11]JohnBackes,PaulineBolignano,ByronCook,CatherineDodge,AndrewGacek,
Kasper Luckow, Neha Rungta, Oksana Tkachu, and Carsten Varming. 2018.
Semantic-basedAutomatedReasoningforAWSAccessPoliciesusingSMT.In
Proceedings of the 18th Conference on Formal Methods in Computer-Aided Design
(FMCAD 2018), Austin, Texas, USA, October 30 - November 2, 2018 .1â€“9.
[12]MichaelBackes,BorisKÃ¶pf,andAndreyRybalchenko.2009.AutomaticDiscovery
andQuantificationofInformationLeaks.In 30th IEEE Symposium on Security
and Privacy (S&P 2009), 17-20 May 2009, Oakland, California, USA .141â€“153.
[13]LucasBang,AbdulbakiAydin,Quoc-SangPhan,CorinaS.Pasareanu,andTevfik
Bultan. 2016. String Analysis for Side Channels with Segmented Oracles. In
Proceedingsofthe24thACMSIGSOFTInternationalSymposiumontheFoundations
of Software Engineering .
[14]LucasBang,NicolÃ¡sRosner,andTevfikBultan.2018.OnlineSynthesisofAdaptive
Side-Channel Attacks Based On Noisy Observations. In 2018 IEEE European
SymposiumonSecurityandPrivacy,EuroS&P2018,London,UnitedKingdom,April
24-26, 2018.307â€“322.
[15]PrithviBisht,TimothyHinrichs,NazariSkrupsky,RadoslawBobrowicz,andV.N.
Venkatakrishnan.2010. NoTamper:AutomaticBlackboxDetectionofParameter
TamperingOpportunitiesinWebApplications.In Proceedingsofthe17thACM
ConferenceonComputerandCommunicationsSecurity (Chicago,Illinois,USA)
(CCS â€™10).ACM,NewYork,NY,USA,607â€“618. https://doi.org/10.1145/1866307.
1866375
[16]PrithviBisht,TimothyHinrichs,NazariSkrupsky,andV.N.Venkatakrishnan.
2011. WAPTEC:WhiteboxAnalysisofWebApplicationsforParameterTamper-
ingExploitConstruction.In Proceedingsofthe18thACMConferenceonComputer
and CommunicationsSecurity (Chicago,Illinois,USA) (CCS â€™11).ACM,NewYork,
NY,USA,575â€“586. https://doi.org/10.1145/2046707.2046774
[17]IvanBocicandTevfikBultan.2016. FindingAccessControlBugsinWebAp-
plications with CanCheck. In Proceedings of the 31st IEEE/ACM International
Conference on Automated Software Engineering (ASE 2016) .
[18]MateusBorges,AntonioFilieri,Marcelodâ€™Amorim,andCorinaS.Pasareanu.2015.
Iterativedistribution-awaresamplingforprobabilisticsymbolicexecution.In
Proceedings of the 2015 10th Joint Meeting on Foundations of Software Engineering,
ESEC/FSE 2015, Bergamo, Italy, August 30 - September 4, 2015 .866â€“877.
[19]MateusBorges,Quoc-SangPhan,AntonioFilieri,andCorinaS.Pasareanu.2017.
Model-CountingApproachesforNonlinearNumericalConstraints.In Proceedings
of the 9th International NASA Formal Methods Symposium .131â€“138.
[20]Malik Bouchet, Byron Cook, Bryant Cutler, Anna Druzkina, Andrew Gacek,
LianaHadarean,RanjitJhala,BradMarshall,DanPeebles,NehaRungta,Cole
Schlesinger,ChrissStephens,CarstenVarming,andAndyWarfield.2020. Block
PublicAccess:TrustSafetyVerificationofAccessControlPolicies.In Proceedingsof the 28th ACM Joint Meeting on European Software Engineering Conference
and Symposium on the Foundations of Software Engineering (VirtualEvent,USA)
(ESEC/FSE 2020) .AssociationforComputingMachinery,NewYork,NY,USA,
281â€“291. https://doi.org/10.1145/3368089.3409728
[21]Malik Bouchet, Byron Cook, Bryant Cutler, Anna Druzkina, Andrew Gacek,
LianaHadarean,RanjitJhala,BradMarshall,DanPeebles,NehaRungta,Cole
Schlesinger,ChrissStephens,CarstenVarming,andAndyWarfield.2020. Block
PublicAccess:TrustSafetyVerificationofAccessControlPolicies.In ESEC/SIG-
SOFTFSE2020,Sacramento,California,UnitedStatesofAmerica,November8-13,
2020.
[22] cancan2015. ryanb/cancanâ€¢GitHub. https://github.com/ryanb/cancan.
[23]CapitalOneDataBreachAnalysis2019. ATechnicalAnalysisoftheCapitalOne
Hack. https://blog.cloudsploit.com/a-technical-analysis-of-the-capital-one-
hack-a9b43d7c8aea.
[24]SupratikChakraborty,DanielJ.Fremont,KuldeepS.Meel,SanjitA.Seshia,and
MosheY.Vardi.2014. Distribution-AwareSamplingandWeightedModelCount-
ingforSAT.In ProceedingsoftheTwenty-EighthAAAIConferenceonArtificial
Intelligence.1722â€“1730.
[25]SupratikChakraborty,KuldeepS.Meel,RakeshMistry,andMosheY.Vardi.2016.
ApproximateProbabilisticInferenceviaWord-LevelCounting.In Proceedings of
the Thirtieth AAAI Conference on Artificial Intelligence .3218â€“3224.
[26]AvikChaudhuriandJeffreyS.Foster.2010. Symbolicsecurityanalysisofruby-
on-railswebapplications.In Proceedingsofthe17thACMConferenceonComputer
and Communications Security, CCS 2010, Chicago, Illinois, USA, October 4-8, 2010 .
585â€“594. https://doi.org/10.1145/1866307.1866373
[27]LeonardoMendonÃ§adeMouraandNikolajBjÃ¸rner.2008. Z3:AnEfficientSMT
Solver. In Tools and Algorithms for the Construction and Analysis of Systems,
14th International Conference, TACAS 2008, Held as Part of the Joint European
Conferences on Theory and Practiceof Software, ETAPS 2008,Budapest, Hungary,
March 29-April 6, 2008. Proceedings .337â€“340. https://doi.org/10.1007/978-3-540-
78800-3_24
[28]djleak[n.d.]. CloudLeak:WSJParentCompanyDowJonesExposedCustomer
Data. https://www.upguard.com/breaches/cloud-leak-dow-jones.
[29]DanielJ.Dougherty,KathiFisler,andShriramKrishnamurthi.2006. Specifying
andReasoningAboutDynamicAccess-ControlPolicies.In AutomatedReasoning,
Third International Joint Conference, IJCAR 2006, Seattle, WA, USA, August 17-20,
2006,Proceedings(LectureNotesinComputerScience,Vol.4130) ,UlrichFurbachand
NatarajanShankar(Eds.).Springer,632â€“646. https://doi.org/10.1007/11814771_
51
[30]SergeEgelman,AndrewOates,andShriramKrishnamurthi.2011. Oops,IDidIt
Again:MitigatingRepeatedAccessControlErrorsonFacebook.In Proceedings
oftheSIGCHIConferenceonHumanFactorsinComputingSystems (Vancouver,
BC,Canada) (CHIâ€™11).ACM,NewYork,NY,USA,2295â€“2304. https://doi.org/10.
1145/1978942.1979280
[31]AntonioFilieri,CorinaS.Pasareanu,andWillemVisser.2013. Reliabilityanalysis
insymbolicpathfinder.In 35th International Conference on Software Engineering,
ICSE â€™13, San Francisco, CA, USA, May 18-26, 2013 .622â€“631.
[32]Kathi Fisler and Shriram Krishnamurthi. 2010. A model of triangulating en-
vironments for policy authoring. In SACMAT 2010, 15th ACM Symposium on
Access Control Models and Technologies, Pittsburgh, Pennsylvania, USA, June 9-11,
2010, Proceedings ,JamesB.D.JoshiandBarbaraCarminati(Eds.).ACM,3â€“12.
https://doi.org/10.1145/1809842.1809847
[33]K.Fisler,S.Krishnamurthi,L.A.Meyerovich,andM.C.Tschantz.2005. Verifica-
tionandChange-ImpactAnalysisofAccess-ControlPolicies.In Proceedingsof
the 27th International Conference on Software Engineering (ICSE 05) .196â€“205.
[34]K.Fisler,S.Krishnamurthi,L.A.Meyerovich,andM.C.Tschantz.2005. Verifi-
cationandChange-ImpactAnalysisofAccess-ControlPolicies.In Proceedings
ofthe27thInternationalConferenceonSoftwareEngineering .St.Louis,Missouri,
196â€“205.
[35]Jaco Geldenhuys, Matthew B. Dwyer, and Willem Visser. 2012. Probabilistic
symbolicexecution.In InternationalSymposiumonSoftwareTestingandAnalysis,
ISSTA 2012, Minneapolis, MN, USA, July 15-20, 2012 .166â€“176.
[36]MarkHeckmanandKarlN.Levitt.1998. ApplyingtheCompositionPrincipleto
VerifyaHierarchyofSecurityServers.In HICSS(3).338â€“347. http://citeseer.nj.
nec.com/134822.html
[37]Graham Hughes and Tevfik Bultan. 2007. Interface Grammars for Modular
Software Model Checking. In Proceedings of the International Symposium on
SoftwareTestingandAnalysis(ISSTAâ€™07) .39â€“49. x-yojimbo-item://CC3D1214-
37E5-4BFA-9D7F-D22F43161CEC
[38]Graham Hughes and Tevfik Bultan. 2008. Automated Verification of Access
ControlPoliciesUsingaSATSolver. ,18pages. https://doi.org/10.1007/s10009-
008-0087-9
[39]GrahamHughesandTevfikBultan.2008.Automatedverificationofaccesscontrol
policiesusingaSATsolver. STTT10,6(2008),503â€“520. https://doi.org/10.1007/
s10009-008-0087-9
[40]iam[n.d.]. AWSIAMPolicyLanguage. http://docs.aws.amazon.com/IAM/latest/
UserGuide/access_policies.html.
1816Quantifying Permissiveness of Access Control Policies ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
[41]SushilJajodia,PierangelaSamarati,MariaLuisaSapino,andV.S.Subrahmanian.
2001. Flexiblesupportformultipleaccesscontrolpolicies. ACM Transactions on
DatabaseSystems 26,2(2001),214â€“260. http://doi.acm.org/10.1145/383891.383894
[42]S.Jajodia,P.Samarati,andV.S.Subrahmanian.1997. Alogicallanguagefor
expressingauthorizations.In Proceedings of the 1997 IEEE Symposium on Security
andPrivacy .IEEEPress,Oakland,CA,USA,31â€“42. http://citeseer.nj.nec.com/
jajodia97logical.html
[43]SushilJajodia,PierangelaSamarati,V.S.Subrahmanian,andElizaBertino.1997.
Aunifiedframeworkforenforcingmultipleaccesscontrolpolicies.In SIGMODâ€™97 .
Tucson,AZ,474â€“485. http://citeseer.nj.nec.com/jajodia97unified.html
[44]ShuvenduK.Lahiri,ChrisHawblitzel,MingKawaguchi,andHenriqueRebÃªlo.
2012.SYMDIFF:ALanguage-agnosticSemanticDiffToolforImperativePrograms.
InProceedingsofthe24thInternationalConferenceonComputerAidedVerification
(Berkeley,CA) (CAVâ€™12).Springer-Verlag,Berlin,Heidelberg,712â€“717. https:
//doi.org/10.1007/978-3-642-31424-7_54
[45]ShuvenduK.Lahiri,KennethL.McMillan,RahulSharma,andChrisHawblitzel.
2013.DifferentialAssertionChecking.In Proceedingsofthe20139thJointMeeting
onFoundationsofSoftwareEngineering (SaintPetersburg,Russia) (ESEC/FSE2013) .
ACM,NewYork,NY,USA,345â€“355. https://doi.org/10.1145/2491411.2491452
[46]ShuvenduK.Lahiri,KapilVaswani,andCA.R.Hoare.2010. DifferentialStatic
Analysis: Opportunities, Applications, and Challenges. In Proceedings of the
FSE/SDP Workshop on Future of Software Engineering Research (SantaFe,New
Mexico,USA) (FoSER â€™10).ACM,NewYork,NY,USA,201â€“204. https://doi.org/
10.1145/1882362.1882405
[47]JesÃºsA.DeLoera,RaymondHemmecke,JeremiahTauzer,andRurikoYoshida.
2004. Effectivelatticepointcountinginrationalconvexpolytopes. Journal of
Symbolic Computation 38,4(2004),1273â€“1302. https://doi.org/10.1016/j.jsc.
2003.04.003
[48]Loi Luu, Shweta Shinde, Prateek Saxena, and Brian Demsky. 2014. A model
counterforconstraintsoverunboundedstrings.In ProceedingsoftheACMSIG-
PLAN Conference on Programming Language Design and Implementation (PLDI) .
57.
[49] MicrosoftInc.[n.d.]. Z3SMTSolver. https://github.com/Z3Prover/z3.
[50]JosephP.NearandDanielJackson.2014.Derailer:interactivesecurityanalysisfor
webapplications.In ACM/IEEEInternationalConferenceonAutomatedSoftware
Engineering,ASEâ€™14,Vasteras,Sweden-September15-19,2014 ,IvicaCrnkovic,
MarshaChechik,andPaulGrÃ¼nbacher(Eds.).ACM,587â€“598. https://doi.org/10.
1145/2642937.2643012
[51]Timothy Nelson, Christopher Barratt, Daniel J. Dougherty, Kathi Fisler, and
Shriram Krishnamurthi. 2010. The Margrave Tool for Firewall Analysis. In
Proceedings of the 24th International Conference on Large Installation System
Administration (SanJose,CA) (LISAâ€™10).USENIXAssociation,USA,1â€“8.
[52]PaigeThompsonIndictment2019. UnitedStatesofAmericavsPaigeA.Thomp-
son. https://www.justice.gov/usao-wdwa/press-release/file/1188626/download.
[53]MikePapadakis,MarinosKintis,J.Zhang,YueJia,Y.L.Traon,andM.Harman.
2019. ChapterSix-MutationTestingAdvances:AnAnalysisandSurvey. Adv.
Comput.112(2019),275â€“378.
[54]Suzette J. Person. 2009. Differential Symbolic Execution . Ph.D. Dissertation.
UniversityofNebraskaatLincoln,Lincoln,NB,USA.Advisor(s)Dwyer,Matthew
B. AAI3365729.
[55]Quoc-Sang Phan, Lucas Bang, Corina S. Pasareanu, Pasquale Malacaria, and
TevfikBultan.2017. SynthesisofAdaptiveSide-ChannelAttacks.In 30thIEEE
Computer SecurityFoundations Symposium,CSF 2017,Santa Barbara, CA,USA,
August 21-25, 2017 .328â€“342.
[56]Quoc-Sang Phan, Pasquale Malacaria, Corina S. Pasareanu, and Marcelo
dâ€™Amorim. 2014. Quantifying information leaks using reliability analysis. In
Proceedings oftheInternational Symposiumon ModelChecking ofSoftware, SPIN
2014, San Jose, CA, USA .105â€“108.
[57]Quoc-SangPhan,PasqualeMalacaria,OksanaTkachuk,andCorinaS.Pasareanu.
2012.Symbolicquantitativeinformationflow. ACMSIGSOFTSoftwareEngineering
Notes37,6(2012),1â€“5.
[58]pundit2016. GitHub-elabs/pundit:MinimalauthorizationthroughtOOdesign
andpureRubyclasses. https://github.com/elabs/pundit.
[59]PierangelaSamaratiandSabrinaDeCapitanidiVimercati.2001. Foundations of
Security Analysis and Design . SpringerVerlag,Chapter3,137â€“196.
[60]RaviSandhuandPierangelaSamarati.1996. Authentication,accesscontrol,and
audit.Comput. Surveys 28,1(1996),241â€“243. http://doi.acm.org/10.1145/234313.
234412
[61]RaviS.SandhuandPierangelaSamarati.1994. AccessControl:Principlesand
Practice.IEEECommunicationsMagazine 32,9(19941994),40â€“48. http://citeseer.
nj.nec.com/article/sandhu94access.html
[62]AndreasSchaadandJonathanMoffet.2002. ALightweightApproachtoSpec-
ification and Analysis of Role-based Access Control Extensions. In 7th ACM
Symposium on Access Control Models and Technologies (SACMAT 2002) .
[63]verizonleak[n.d.].14MEEELLIONVerizonsubscribersâ€™detailsleakfromcrappily
configuredAWSS3datastore. https://www.theregister.co.uk/2017/07/12/14m_
verizon_customers_details_out/.[64]XACML2003. eXtensibleAccessControlMarkupLanguage(XACML)Version
1.0. OASISStandard. http://www.oasis-open.org/committees/tc_home.php?
wg_abbrev=xacml http://www.oasis-open.org/committees/tc_home.php?wg_
abbrev=xacml.
[65]DianxiangXu,RoshanShrestha,andNingShen.2020. AutomatedStrongMuta-
tionTestingofXACMLPolicies (SACMATâ€™20) .AssociationforComputingMa-
chinery,NewYork,NY,USA,105â€“116. https://doi.org/10.1145/3381991.3395599
[66]JohnZao,HoetechWee,JonathanChu,andDanielJackson.2003. RBACSchema
VerificationUsingLightweightFormalModelandConstraintAnalysis.In Pro-
ceedingsoftheeighthACMsymposiumonAccessControlModelsandTechnologies .
1817