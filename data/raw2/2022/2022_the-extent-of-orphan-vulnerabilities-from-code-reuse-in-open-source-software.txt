The Extent of Orphan Vulnerabilities from Code Reuse in Open
Source Software
David Reid
University of Tennessee
Knoxville, TN, USA
dreid6@vols.utk.eduMahmoud Jahanshahi
University of Tennessee
Knoxville, TN, USA
mjahansh@vols.utk.eduAudris Mockus
University of Tennessee
Knoxville, TN, USA
audris@utk.edu
ABSTRACT
Motivation: A key premise of open source software is the ability to
copy code to other open source projects (white-box reuse). Such
copyingacceleratesdevelopmentofnewprojects,butthecodeflaws
in the original projects, such as vulnerabilities, may also spread
even if fixed in the projects from where the code was appropriated.
The extent of the spread of vulnerabilities through code reuse, the
potentialimpactofsuchspread,oravenuesformitigatingriskof
these secondary vulnerabilities has not been studied in the context
of a nearly complete collection of open source code.
Aim:Weaimtofindwaystodetectthewhite-boxreuseinduced
vulnerabilities,determinehowprevalenttheyare,andexplorehow
they may be addressed.
Method: We rely on World of Code infrastructure that provides
a curated and cross-referenced collection of nearly all open source
softwaretoconductacasestudyofafewknownvulnerabilities.To
conduct our case study we develop a tool, VDiOS, to help identify
and fix white-box-reuse-induced vulnerabilities that have been
already patched in the original projects (orphan vulnerabilities).
Results:Wefindnumerousinstancesoforphanvulnerabilities
even in currently active and in highly popular projects (over 1K
stars). Even apparently inactive projects are still publicly available
for others to use and spread the vulnerability further. The often
longdelayinfixingorphanvulnerabilitieseveninhighlypopular
projects increasesthe chancesof itspreading tonew projects. We
provided patches to a number of project maintainers and found
that only a small percentage accepted and applied the patch. We
hope that VDiOS will lead to further study and mitigation of risks
from orphan vulnerabilities and other orphan code flaws.
CCS CONCEPTS
•Software and its engineering →Software configuration man-
agement and version control systems .
KEYWORDS
code reuse, CVE, security vulnerabilities, git
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthe firstpage.Copyrights forcomponentsof thisworkowned byothersthan the
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/or a fee. Request permissions from permissions@acm.org.
ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA
© 2022 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-9221-1/22/05...$15.00
https://doi.org/10.1145/3510003.3510216ACM Reference Format:
DavidReid,MahmoudJahanshahi,andAudrisMockus.2022.TheExtent
of Orphan Vulnerabilities from Code Reuse in Open Source Software. In44th International Conference on Software Engineering (ICSE’22), May 21–29, 2022, Pittsburgh, PA, USA. ACM, New York, NY, USA, 12 pages. https:
//doi.org/10.1145/3510003.3510216
1 INTRODUCTION
Therapidgrowthofhighqualityopensourcesoftware(OSS)has
significantly increased the different kinds of software that can
be built upon, thus potentially enhancing developer productiv-ity[
29],increasingcodequality[ 12],andimprovingsoftwarese-
curity [15][17]. A key feature of open source code is that it may
becopiedintonewprojects1,butsuchcopyingmaybringvulner-
abilities or other issues [ 15]. We define “orphan vulnerabilities”
as vulnerabilities in copied code that still exist in a project after
theyarediscoveredandfixedinanotherproject.Insomecases,the
copying is a result of forking, and the link to the original code is
readilyavailable.Inothercases,especiallywhenthecopyingisa
resultofmanyiterations,thelinktotheoriginalcodemaynotexist.Eitherway,thevulnerablecodeispubliclyexposeduntiltheorphan
vulnerabilityisfixedorthevulnerablecodeisremoved.Theaimof
thisstudyistodetermineiftheabilitytocopyOSScodeactually
results in widespread orphan vulnerabilities. Orphan vulnerabil-ities present significant risk for several reasons. First, an exploit
for such vulnerabilities may be widely known, making it easier to
attacksoftwarewithknownvulnerabilities[ 6].Second,thecode
insuch repositoriesmay becopiedto otherprojects thatmaynot
be aware of the vulnerability. Third, code in such repositories may
be built into applications and run by unsuspecting users. Fourth, if
asubstantialnumberofOSSprojectscontainknownandunfixed
vulnerabilities,OSSmaysufferreputationaldamageasadumpof
lowqualitycodewhereitmaybehardtofindhigh-qualityprojects.
To better understand and address the problem of copied and
unpatched code, we first would like to create a tool that, given a
vulnerability fix in one project, identifies all other projects that
containeitherstillvulnerableorfixedcode.Suchatool,ifwidely
deployed,wouldhaveatleasttwopositiveimpacts:informmain-
tainersand usersofstillvulnerable projectsabouttherisks ofthe
vulnerabilityintheircodeandwarnusersthatcontemplatereusing
such code about the unpatched vulnerabilities.
Second, we want to determine if and how the still vulnerable
projects may differ from the patched ones. For example, we expect
thatthemoreactiveprojectsaremorelikelytofixknownvulnerabil-
ities than the less active projects. This would suggest that the risks
posed by unpatched projects may be attenuated by, presumably,
morenarrowdeployment.Linus’sLawstatesthat“givenenough
1Subject to licensing terms of the original and target project.
21042022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA David Reid, Mahmoud Jahanshahi, and Audris Mockus
eyeballs,allbugsareshallow”[ 33].Thiswouldsuggestthatprojects
with more developers are less likely to contain vulnerabilities. But
little empirical evidence exists to support this [ 11]. We want to see
if our results support Linus’s Law.
Third, we would like to understand how quickly patches to
known vulnerabilities propagate to unpatched projects. We expect
that older vulnerabilities are more likely to be fixed in a project
than the more recent ones as it takes time and effort for project
maintainers to patch their project. Presence of such a trend would
suggest that convenient tools supporting such patching may speed
up the deployment of patches.
Fourth,wewanttodetermineifthetoolweintroduceddetects
vulnerabilitiesofadifferentkindthanoneofthemostwidelyknown
tools,dependabot[ 9],todetermineiftheapproachusedinourtool
ispracticallyrelevantorifdevelopersmaysafelyrelyondepend-
abot.
Fifth,we wouldliketo identifyhowmany oftheprojectsthat
contain orphan vulnerabilities are not just forked from the original
project where the vulnerability was fixed. Since many forks are
done simply to contribute a patch, not to start a new development,
it would not be surprising if such forks are not updated and do not
patch their code. For any developer, it would be easy to look up
the origin of the fork to get the most authoritative code. However,
itmaybehardertodowithclonedprojects.If,ontheotherhand,
many of the projects are not forks, it would be much more difficult
for potential users to identify such authoritative versions.
Sixth,wewouldliketounderstandtowhatextentthestillvul-
nerableprojectsarewillingtoacceptpatchesofthevulnerability
offeredtothem.Forexample,whiledependabotcreateswarnings
and provides patches, not all projects are willing to accept them as
the patches may break functionality.
Toproducethetool,VDiOS,webuildontopofWorldofCode
(WoC) [25] infrastructure that attempts to approximate the source
code in public git version control systems and provides cross-
referencesamongversionsofthecode,projects,andchangestothe
code.
To answer our research questions, we employ a mixed meth-
ods approach where we analyze large volumes of data to selectcandidates for a case study. Such an approach is suitable for our
investigationbecauseononehandwehaveaverylargeandcom-plexdatasource representingalmostallopen sourcecode,andwe
need computational approaches to select meaningful examples for
our case study. The case study approach is needed because we
havelimitedunderstandingoftheproblems,andacasestudyap-
proachprovides“anin-depth,multi-facetedexplorationofcomplexissuesintheirreal-lifesettings”[
36].Wecarefullypickthesubjects
(vulnerabilities)toshedlightonalloftheaboveresearchquestions.
Itisimportanttonotethathereweareexclusivelyfocusedonthe
so-called white box reuse where the source code is copied instead
of employed as library/system call. Furthermore, we only consider
matching any exact version of the vulnerable code, though theapproach can be straightforwardly extended to cases where the
copied code has been modified and does not match exactly any of
the known fixed or vulnerable versions.WesucceededinbuildingVDiOS,atoolthatidentifiesprojects
with orphan vulnerabilities, and applied it in four cases investi-
gatingfourvulnerabilitiesinPNGlibrary,OpenSSL,andxzcom-
pression (written in Go language). None of the vulnerabilities were
reported by dependabot in thousands of vulnerable projects that
are not forks of the original projects. Only a fairly small fraction of
projectsacceptedthepullrequestfixingtheknownvulnerability.
On the positive side, we found older vulnerabilities to be more
likely to be fixed, and the still-vulnerable projects tended to be less
active than the patched ones.
In summary, our work makes the following contributions:
•We provide a working approach to find file-level exact code
reuse in any language across all open source repositories.
•We provide a tool to implement our approach.
•Weconductacasestudywithfourcasestoanswerourre-search questions regarding vulnerabilities that are spread
via file-level code reuse.
Our primary objective is to reduce security vulnerabilities in
software by identifying cases where a known vulnerability has
beenfixed,butcopiesofversionsthatarestillvulnerablearestill
inuseinotherprojects.Thisisawell-knownsecurityriskinthe
softwaresupplychain.TheOpenWebApplicationSecurityProject
(OWASP) lists “Using Components with Known Vulnerabilities” in
itsTop10WebApplicationSecurityRisks(OWASPTop10)[ 32].The
software supply chain is a significant source of data breaches [ 23],
with one estimate suggesting 80% of such breaches come from
supply chain vulnerabilities [ 28]. Finding file-level duplication and
locating where a file originated helps identify vulnerable or buggy
code.
In the rest of the paper we start from the general background
on the data used in the study in Section 2, discuss our research
methodologyinSection3,presentourVDiOStoolinSection4,and
the results from our case study in Section 5. We then discuss these
results in Section 6. Finally we present limitations in Section 7,
related work in Section 8, and conclude in Section 9.
2 BACKGROUND
2.1 Software Reuse
Softwarereuseisthepracticeofusingexistingsoftwarecomponents
whenbuildingnewsoftwaresystems[ 22].Therearetwotypesof
software reuse, often referred to as black-box and white-box reuse.
Black-box reuse refers to external code that is used by a project
but generally not committed into the project’s repository. Thismay include, for example, linkable libraries. Black-box reuse is
code that is not modified by the developer. White-box reuse refers
to the case where source code is reused by copying the originalcode and committing the duplicate code into a new repository.
White-boxreusecodemaybemodifiedbythedeveloper.White-box
reuse results in multiple copies of the source code across multiple
repositories.Thesecopiesmaybechanged,andtherefore,theremay
bemultipledifferentversionsofthecode.Thispaperspecifically
looksatwhite-boxreuse.Welookatcodereuseontheindividual
file level, not at the function or method level.
White-boxreusepresentsseveralchallenges.Vulnerabilitiesand
otherbugsmaybefoundandfixedinacopyofthecodethatexists
in one project, but the fixes may not get propagated to all projects
2105
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. The Extent of Orphan Vulnerabilities from Code Reuse in Open Source Software ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA
that use the file. Similarly, useful enhancements may have been
added to different versions of the code. The result is that fixes to
known vulnerabilities as well as other bug fixes and enhancementsmayexistinoneprojectbutnotinotherprojects.Also,licenseterms
may not be properly propagated from the original code, causing
licenseviolationsfordeveloperswhodonotknowtheoriginsofthecode.Forqualityandsecurityreasons,itisimportanttounderstand
where the reused code came from, who has worked on it, and if
betterversionsofitexistinotherrepositories.Knowingwhereelse
the code exists can help identify if there are known vulnerabilities
inthecodebyseeingknownvulnerabilitiesinotherprojectswhere
the same code exists.
2.2 World of Code
Due to the vast quantity of open source software available from
manydifferentpublicsourcecode repositoryhostingplatforms,it
hastraditionallybeentoocomputationallyintensivetofindoriginsofaduplicatedpieceofcodeandallrevisionsofthatcodeacrossall
opensourceprojects.Therefore,previousresearchoncodereuse
has typically looked at a relatively small subset of open source
software. However, a new inno vation,WorldofCode(WoC)[ 25],
opens up new research possibilities in this area. WoC provides an
infrastructure that makes it possible to efficiently find all versions
of reused source code files across all of the major source code
repository hostingplatforms. We build onthe WoC infrastructure
to find file-level code duplication in any language from a WoC’s
expansive collection of open source software. Additional tools that
build on WoC, suchas Developer Reputation Estimator(DRE) [ 2],
can be used to help identify the best of several versions of a file.
The tool described in this paper, VDiOS, uses the World of Code
infrastructure to find duplicate code across many public source
codehostingplatforms.WoCisanearlyexhaustiveandcontinually
updated collection of open source software along with tools to effi-
cientlyextractandanalyzetheextremelylargesetofcode.WithouttheinfrastructureprovidedbyWoC,itwouldnotbepossibletofind
suchacompletecollectionofcodecopied(andpossiblymodified)
acrosssuchalargecollectionofcodeinmanyrepositoriesacross
many hosting platforms.
Since most open source software today is stored in git reposi-
tories, WoCuses similar constructs tostore the data.For example,
blobs, trees, and commits in WoC are identical to the same objects
in git and are referenced with a sha1 hash just like git.
Black-box reuse can be detected with static analysis techniques
that look for dependencies. These dependencies can be checked
against public sources like libraries.io. But white-box reuse, which
isthesubjectofthispaper,requiresaccesstothesourcecodefor
all projects from which code may be reused. WoC provides not
only the near complete collection of open source software, but also
organizes its databases for efficient searching.
WoC provides a number of mappings that allow us to efficiently
extract the information that we need. WoC maintains a database ofseveralobjectsincludingblobs,files,commits,projects,andauthors,
allowing for efficient mappings. For example, given the contents
ofafile,wecomputetheSHA-1hash(usingthesamemechanism
that git uses) that identifies the blob. We then use WoC’s blob to
commitmappingtogettheSHA-1hashofthecommit.Thecommitto project and commit to time author mappings give us the project
name(fromwhichwecanidentifythegitrepofromwhichitcame)
and the author and time of commit (which helps us identify where
the file originally came from). We also use the blob to old blob
mapping to find old versions of the source code of a particular file.
In order to better understand the entirety of open source in our
context,weneedtogetahandleonthesetofdistinctprojects.Easy
creation of clones in version control systems result in numerous
repositoriesthatarealmostentirelybasedonsomeparentreposi-
tory.Therehavebeenvariousattemptstodetectcommunitiesin
this ecosystem to address this issue, some using visual models [ 24]
and some community detection algorithms [ 27]. We use the latter,
utilizing WoC mappings that maps each repository to a central
repositoryinadetectedsetofrepositorieswhichpresumablyrep-
resent the same project. This mapping is called project to deforked
project (p2P) in WoC.
3 RESEARCH METHODOLOGY
Weconductedanexploratorycasestudytobetterunderstandissues
surrounding the spread of software security vulnerabilities caused
by copying open source software. We chose to use an exploratory
case study because we are in the early stages of understanding
theproblemandpossiblesolutions.Wehopetogenerateideasto
mitigate these types of security vulnerabilities and spur additional
academic research. The case study approach allowed us to look
atasmallnumberofwidely-reusedprojectsin-depthandwithin
their real-life context. This in depth examination allowed us to
increaseourunderstandingandgaininsightsthatwouldotherwise
be difficult to obtain.
Consistent with best practices conducting case studies, we in-
vestigated a small number of cases in depth and in their context
usingmultipledatasourcesandemphasizingqualitativedataand
analysis while also collecting significant quantitative data. The
subjectofeachcaseisaknownvulnerability(asdescribedbythe
CommonVulnerabilitiesandExposures(CVE)database[ 41]hosted
atMITRE)andtheopensourceprojectcontainingthevulnerable
code as described by the CVE entry.
We examined in detail four specific cases of known software
securityvulnerabilitiesthathavebeenfixedintheiroriginalprojectrepository.Weusedmultiplecasestoincreasetheconfidenceofthe
results and increase generalization of the results. We avoid making
broadgeneralizationclaimsbasedonjustfourcases,althoughwe
believe that our results provide insights that are applicable to a
broaderrangethanjustourfourspecificcases.Wecarefullyselected
these four cases by searching for vulnerabilities in popular open
sourceprojectsthathavebeenwidelycopied.WeusedVDiOSto
screenoutcasesofknownvulnerabilitiesincodethatisnotwidely
copied. We specifically selected common cases, not unique or edge
cases.Weselectedavulnerabilityinlibpng2thatwasinthecodefor
alongtime,allowingformanycopiesoverthattime.Weselecteda
new and an old vulnerability in OpenSSL3to highlight differences
in the age of the vulnerability. OpenSSL was chosen in part be-
cause it is critical to Internet security. We selected the xz package4
2http://www.libpng.org/
3https://www.openssl.org/
4https://github.com/ulikunitz/xz
2106
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA David Reid, Mahmoud Jahanshahi, and Audris Mockus
written in the Go language to contrast with the other projects that
were all C language projects. We selected cases that we believe are
representative of the broader group of known vulnerabilities in
opensourcesoftware.Ourcasesrepresentbothliteralreplication
(because they are representative of the broader group of known
vulnerabilities) and theoretical replication (because we compare
an old vs new vulnerability in the same project and projects in
different programming languages).
Weexaminedthesefourcasesincontextbylookingatspecific
opensourceprojectsthatreusevulnerablecodeandthatarehosted
onpublichostingplatformsincludingGitHub,Bitbucket,Source-
Forge, and others. By looking at the cases in context, we see a
realisticpictureofvulnerablecodereuseintherealworldrather
thancontrivedresultswemightgetinatraditionallab-basedstudy.
Multipledatacollectiontechniquesprovidedcorroboratingev-
idence. We used artifacts, observations, and direct contact withproject maintainers (through pull requests and issues), allowing
us to gather more insights than using just one method. Looking at
artifacts (the code actually committed in real world repositories)
providesaconcreteviewofactualpracticewithoutanybiases.Ourobservationsallowforsomequalitativeanalysis.Contactingprojectmaintainersprovidesmoreinsightintotheirwillingnesstoaddress
issues once they are aware of the vulnerabilities.
Case studies tend to focus more on qualitative data than quanti-
tativedata.Ourstudycontainsboth.VDiOSproducessignificant
quantitative data, which we report in detail. We also attempt to
describe behavior based on our observations and interactions with
project maintainers. Our results are also being used to craft survey
questions for future research to collect more qualitative data to
explain the behavior of project maintainers.
Our primary data source is World of Code. We also collect some
datadirectlyfromthesourcecodehostingplatformslikeGitHub,
Bitbucket,SourceForge,andothers.DatacollectionisaccomplishedusingtheVDiOStoolthatwedevelopedspecificallyforthisresearch
project. VDiOS is described in detail in section 4.
We started by selecting a sample of known vulnerabilities, iden-
tifyingallaffected(andfixed)versionsofthesourcecodefilesin
theprimaryrepositoriesandusingWoCtoidentifyallotherOSS
projects thathave versionsof thecode that eitherprecede (inver-
sion history) the affected version or is modified past it withoutapplying the patch. We codified this algorithm as a tool that can
be usedfor any vulnerabilityor any othertype of defect. Wethen
obtained and analyzed the numbers, activity states, and properties
of the affected, patched, and potentially patched projects. Further-
more, we manually investigated many instances of cases where
the code is still vulnerable to identify if the project is still active, if
thedefecthasbeenfixed,andifnot,whetherthemaintainersare
willing to accept the patch.
4 THE VDiOS TOOL
InthissectionwedescribeVDiOS(VulnerabilityDetectioninOpen
Source), our tool for finding file level code reuse across all opensource repositories and tracing the version of a single file acrossall repositories and version history. We build on the WoC infras-
tructure to find duplicate files at a scale that has traditionally been
computational infeasible.VDiOStakesthecontentsofafileandfindsallduplicateversions
of that file or any revision of that file across all of the open source
softwareavailableinWoC.Thesevulnerablefilesarethentraced
backtotheopensourceprojectinwhichtheyarecontained.Theseprojects may be hosted on many different source code hosting plat-
forms such as GitHub, Bitbucket, SourceForge, etc. VDiOS displays
a URL link to the project and the affected file or files within the
given project.
Our approach looks for file-level reuse, that is, exact copies of
entire files. We include all files in the version control history when
looking for duplicate files. This allows us to find files that were
duplicated and then modified.
WhenlookingforSecurityVulnerabilities,VDiOShastheability
toseparaterevisionsoffilesintotwolists:revisionsthatcontain
thevulnerabilityandrevisionsthatdonotcontainthevulnerability.
This allows VDiOS to identify projects that are still vulnerable,
projectsthatusedtobevulnerablebuthavenowbeenfixed,andprojects that used to be vulnerable and have changed but we do
not know if the change fixed the vulnerability.
Figure 1: VDiOS Architecture Diagram
4.1 Architecture
VDiOSisimplementedasalayerontopoftheWorldofCode(WoC)
shell APIs [ 26] as shown in figure 1. The WoC shell APIs provide a
convenient way to access the WoC data. Specifically, VDiOS needs
accesstoWoC’sdatamapsaswellasinformationabouttheobjects.
WoC stores data maps in a way that allows VDiOS to efficiently
look up information. The specific information we need pertains to
blobs, commits, projects, files, authors, and times.
TherearetwoprimaryWoCshellAPIsusedbyVDiOS:getValues
and showCnt. showCnt is used to show the content of the basic git
objects blob, tree and commit. getValues is used to access the WoC
data maps to get the following information:
•blob to commit (b2c) finds all commits of the specified blob.
•commit to project (c2p) finds all projects containing the
specified commit.
•committoProject(c2P)islikec2pexceptitfindsdeforked[ 27]
projects.
2107
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. The Extent of Orphan Vulnerabilities from Code Reuse in Open Source Software ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA
•committoparentcommit(c2pc)andcommittochildcommit
(c2cc) finds the parent and child commit respectively from a
given commit.
•commit to time author (c2ta) finds the time of the commit
and the author of the commit.
•blob to old blob (b2ob) finds the predecessor of the given
blob. old blob to blob (ob2b) is the inverse of b2ob.
VDiOS also retrieves a small amount of data directly from the
source code hosting platform (GitHub, Bitbucket, GitLab, etc). A
systemindependentinterfaceallowsVDiOStouseasinglecallto
getdata,hidingtheplatformspecificdetails.Asystemdependent
layer,whichcallstheappropriateAPI(forexample,theGitHubAPI),
provides a "glue layer" to connect to the popular hosting platforms
toretrievethedata.Thesystemdependentlayercanbeextended
to support additional hosting platforms as needed.
The VDiOS output is a set of reports generated in HTML format
for viewing in a web browser.
4.2 Algorithm
VDiOS is divided into four phases, each of which is described in
this section.
The first phase identifies all of the blobs that contain the vul-
nerability and all the blobs that contain the fix. Starting with a
commit that fixes a vulnerability, VDiOS finds the relevant blob or
blobs in that commit. When looking for a security vulnerability, it
islikelythatnotonlyistherevisionbeforethefixvulnerable,but
the predecessors of that revision are also likely to be vulnerable.
VDiOSusesWoC’sblobtooldblobmappingorcommittoparent
commit mapping recursively to find all predecessor blobs. If we
knowthecommitthatintroducedthevulnerability,VDiOSlooksat
only blobs between the breaking commit and the fixing commit. It
is highly likely that all of those blobs will contain the vulnerability.
VDiOS next finds the descendent blobs using WoC’s old blob to
blobmappingorcommittochildcommitmapping.Theseblobsare
highlylikelytocontainthefix.Manualinspectionoftheselistscan
be done at this point to confirm that the blobs in the first list are
vulnerable and the blobs in the second list are fixed. At the end of
phase one, we have two lists of blobs. The first list contains one or
more blobs that contain the vulnerability. The second list contains
zero or more blobs that are fixed.
The second phase searches for all projects in WoC that contain
aduplicateofanyofthevulnerableblobsidentifiedinphaseone
by using WoC’s blob to commit mapping and commit to projectmapping. Note that VDiOS looks for duplicates in any revision
within a project. That is, it will find all projects that have ever
contained the vulnerable blob even if it has been fixed or removed
in the most current version. At the end of phase two, we have a
listofallprojectsthathaveevercontainedoneofthepotentially
vulnerable versions of the file.
The third phase checks if the blob(s) in question are in the most
current revision of the project. In this phase, VDiOS looks through
the projects found in the second phase. Those are projects thathave at some point in time contained a known vulnerable blob.
Wenowwanttofindoutiftheprojectstillcontainsavulnerable
blob. Using the hosting platform’s API, we find the most current
revisionofthefile.Nowwelooktoseeifthatrevisionmatchesanyofthevulnerableblobs.Ifso,weknowtheprojectstillcontainsthe
vulnerable code. Next, we look to see if that revision matches any
of the known good blobs. If so, we know that the vulnerable file
has been fixed. If we do not find a potentially vulnerable or known
goodfile,thenweknowthattheprojecthascontainedavulnerable
file,thatfilehasbeenchanged,butwedonotknowifthechange
fixed the vulnerability.
The final phase generates the reports in HTML format for view-
ing in a browser. The first page of the report shows the committhat fixed the vulnerability (if applicable). Next, it has a link to a
list of blobs and filenames where the vulnerability was fixed, a link
to a list of ancestors of those blobs (which presumably contain the
vulnerability), and a link to the descendants of those blobs (which
presumablyallcontainthefix).Finally,ithaslinkstolistsofvul-nerable projects, not vulnerable projects, and projects where the
vulnerablefilehasbeenchangedbutwedonotknowifitisfixedor
if it is still vulnerable. For each of the three categories (vulnerable,
not vulnerable, and unknown), a report provides more detailed
information.
5 RESULTS
Inthissection,wepresenttheresultsofourcasestudyinvolving
fourcases thatdemonstrate someof thesecurityproblems caused
byorphanvulnerabilities.Thefourcasesarefourknownsecurity
vulnerabilities that have now been fixed in popular open source
projects. Our case study looks at projects that copied vulnerable
filesbeforethefileswerefixedin theoriginalprojectfromwhere
they were copied. We look at two vulnerabilities within the widely
used cryptography library OpenSSL. The first vulnerability is very
recent and the second, heartbleed, is relatively old. We look at
onerecentvulnerabilityinaGolanguagepackagesupportingxz
compression.Welookatonevulnerabilitythatwasfixedmorethan
three years ago in the mature and proven open source PNG [ 5]
graphics library libpng, which is very widely copied. Our case
study looks at code written in different languages to show that our
approach is language agnostic. It works the same regardless of the
language.
Wefindtensofthousandsofopensourceprojectsthatcontain
files with known vulnerabilities even though the vulnerabilities
havebeenfixedintheoriginalprojectfromwherethevulnerablefile
was copied. Many of the vulnerable projects appear to be inactive,
but some are clearly still active. In some cases the fix is recent
and project maintainershave not had much time toapply patches.
In other cases the fix is several years old, and yet many projectsstill contain the vulnerable code. Patches we provided were only
accepted by a small percentage of project maintainers.
5.1 Case 1: CVE-2021-3449 in OpenSSL
OpenSSLisaverywidelyusedopensourcecryptographylibrary
implementingSecureSocketLayer(SSL)andTransportLayerSe-
curity (TLS) [ 34]. Projects that incorporate OpenSSL play a vital
role in Internet security. This was made clearly evident with the
discoveryin 2014of thesecurity vulnerabilityinOpenSSL known
as heartbleed [ 7]. OpenSSL is the leading cryptography library
used for email and website encryption and for software securityinmanyotheropensourcesoftwarepackages.Inthiscasestudy,
2108
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA David Reid, Mahmoud Jahanshahi, and Audris Mockus
we look at two vulnerabilities in OpenSSL. First, we look at the
most recent (as of this writing) known vulnerability in OpenSSL.
This vulnerability, described in CVE-2021-3449 [ 43], allows a mali-
ciouslycraftedrenegotiationClientHellomessagetocrashaTLS
server. OpenSSL considers this a high severity vulnerability [ 31].
ItwasfixedinMarch2021.Sinceitwasonlyrecentlydiscovered
and fixed, we might expect to find a number of projects that still
contain the vulnerable code. The second OpenSSL vulnerability we
look at, heartbleed, is discussed in the next section, 5.2.
The firstOpenSSL vulnerability we look at, CVE-2021-3449, was
introducedinthefilessl/statem/extensions.cincommitc589c34e61
in January 2018 and fixed in commit 02b1636fe3 in March 2021.
AccordingtotheOpenSSLvulnerabilitieslist5"AllOpenSSL1.1.1
versionsareaffectedbythisissue.Usersoftheseversionsshould
upgrade to OpenSSL 1.1.1k." Since the vulnerability only existed
inafewversions ofOpenSSL,weexpecttofindarelativelysmall
number of projects that use one of the vulnerable versions.
Following the algorithm described in section 4.2, VDiOS finds
56 revisions of extensions.c that contain the vulnerability. That
is,thereare56revisionsbetweenthecommitthatintroducedthe
vulnerability andthe commit thatfixed thevulnerability.VDiOS
finds three revisions of the file that contain the fix and are thus
known to be not vulnerable to this specific issue. Additionally,
VDiOS finds the following:
•1,614projectscontainoneoftheknownvulnerablerevisionsofssl/statem/extensions.cinthemostcurrentrevisionofthe
project.
•11 projects contain one of the known fixed revisions of
ssl/statem/extensions.c in the mostcurrentrevision, mean-
ing it used to be vulnerable but now it is fixed.
•1,079projectscontainarevisionofssl/statem/extensions.c
that is not in either the list of vulnerable blobs or the list of
fixedblobs,meaningthattheprojectcontainedapotentially
vulnerableblobinthepast,theblobhasbeenmodifiedinthe
mostcurrentversion,butwedonotknowifthemodification
fixed the vulnerability.
•253 projectsused to containa vulnerable version ofthe filebut the file has since been removed.
For further investigation of these projects, we used WoC p2P
mappings [ 27] to see how many of these projects are forked. De-
forking1614vulnerableprojectsresultedinto132projects.Tosee
if they are active projects or not, we looked to see if they have any
commitinthepast6and18months.Wefoundthat23ofthemhave
at least one commit in the past 6 months, and 64 have at least onecommit in the past 18 months. To have an idea about their impact
intheOSScommunity,welookedatthenumberofstars[ 4]each
oftheseprojectshave.Weobservedthatfouroftheseprojectshave
more than 10,000 stars and 10 have more than a thousand stars,
implying their wide impact in the OSS community.
5.2 Case 2: CVE-2014-0160 in OpenSSL
We next look at the OpenSSL heartbleed vulnerability. Heartbleed,
describedinCVE-2014-0160[ 39],isaveryseriousvulnerability[ 45]
thatwasfixedin2014.DuetoaboundscheckerrorintheTLSheart-beatextension,thebugallowsdisclosureofinformationthatshould
5https://www.openssl.org/news/vulnerabilities.htmlbeprotected.Sincethiswasahighprofileseriousvulnerabilitythat
wasfixedsevenyearsago,weexpectnottofindmany,ifany,active
projectsstillusing codevulnerabletoheartbleed.We useVDiOSto
testthishypothesisandtheninvestigatetheprojectswefindthat
still contain the heartbleed vulnerability.
Heartbleedwasintroducedbycommit4817504d06onDecember
31,2011,inthefilesssl/t1_lib.candssl/dl_both.c.ThefirstreleaseofOpenSSLwiththisvulnerabilitywasrelease1.0.1onMarch14,2012.
The vulnerability was fixed two years later by commit 731f431497f
made on April 7, 2014, and released in release 1.0.1g on April 7,
2014.VDiOSfirstfindsallrevisionsofthefilessl/t1_lib.cbetween
theDecember2011committhatintroducedthevulnerabilityand
thecommitinApril2014thatfixedthevulnerability.Itfinds90vul-
nerable revisions of ssl/t1_lib.c. Following the procedure described
in section 4.2 above to find projects containing the vulnerability,
we discover the following results:
•121 projects contain one of the known vulnerable revisions
of ssl/t1_lib.c in the most current revision of the project.
•3,156 projects contain one of the known fixed revisions of
ssl/t1_lib.cinthemostcurrentrevision,meaningitusedto
be vulnerable but now it is fixed.
•211 projects contain revisions of ssl/t1_lib.c that is not ineither the list of vulnerable blobs or the list of fixed blobs,
meaning that the project contained a potentially vulnerable
blob in the past, the blob has been modified in the mostcurrent version, but we do not know if the modification
fixed the vulnerability.
Becauseoftheveryseriousnatureofheartbleed[ 10],webelieve
it is important to investigate all 121 projects that contain a known
vulnerableversionofssl/t1_lib.c.Wefindthefollowinginformation
about these 121 projects:
•110 of the projects are forks that were all forked between
whenthevulnerabilitywasreleasedin2012andwhenitwas
fixed in 2014 and that have had no activity on the project
since before the vulnerability was fixed in 2014.
•Threeoftheprojectsareclonesthatwereallclonedbetween
whenthevulnerabilitywasreleasedin2012andwhenitwas
fixed in 2014 and that have had no activity on the project
since before the vulnerability was fixed in 2014.
•Theremainingeightprojectshavehadsomeactivity(com-
mitsorissues)dated2017orlater,wellafterthevulnerability
was fixed. These projects are a potential concern, and there-
fore, we investigated these eight in more depth.
The113projectswithnoactivitylaterthan2014appeartobein-
active projects. Of course any publicly available project containing
heartbleed has the potential to be copied and reused, even if the
projectisnotactive.Wefindtheremainingeightprojects,theones
with activity dated 2017 or later, to be more concerning since they
have been active since the vulnerability was fixed, yet they do not
containthefix. Welookedintothose eightprojectsinmoredetail
and found the following information:
•Oneprojecthasseveralcommitsthisyear(2021).Thisclearly
indicates that it is an active project and potentially concern-
ing since it contains the heartbleed code. Upon further in-
vestigation,wefindthatthisprojectcontainstoolsforthe
2109
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. The Extent of Orphan Vulnerabilities from Code Reuse in Open Source Software ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA
purposeofanempiricalstudyofbugsinrealworldCsoft-
ware.OpenSSLisincludedasoneofthesubjectsofthestudy
ratherthanbeinglinkedintothisproject’ssoftware.Thus,
this project is not vulnerable to heartbleed.
•TworelatedprojectsonGitHubhavecommitsin2018and
2019, which would seem to indicate that they are still active.
OneofthemaddedaWhiteSourceBolt6configurationfile
in 2019. The other is a fork of that project and updated
itsConfigurescript7andTravisCI8filesin2018.Noother
changes have been made to either project since 2013, well
before heartbleed was discovered and fixed.
•Two related projects on GitHub have activity more recentthan the 2014 fix. One of the projects has two open issues
from November 2018 where someone asks questions that in-
dicatetheyareactivelyusingtheproject.Thequestionswere
never answered, and there are no recent commits, which in-
dicatesthattheprojectisnotactive.Butthisdoesshowthat
people could be using projects that have been inactive for
manyyears.Anotherprojectisaforkofaforkofthisproject
andhasonecommitin2018.Thecommitisonlyachangein whitespace in a README. There are no other commits
since 2013.
•Two related projects on GitLab have changes in 2018 thatonly affect whitespace in a README. One is a fork of theother. No substantive changes have been made to either
project since the 2014 fix of heartbleed.
•Oneproject,whichisnotafork,hasanumberofcommitsin
2017, indicating that it has been active much more recently
thantheheartbleedfix.ThisGitHubprojecthaszerostars,
zero forks, and only 27 commits.
Based on the above information, we conclude that heartbleed
isvirtuallyeliminated,althoughnotcompletelyeliminated,from
activeopensourcesoftwareprojects.However,anumberofinac-
tiveprojectsthatarestillvulnerabletoheartbleedarestillreadily
available online and thus could still be reused.
5.3 Case 3: CVE-2021-29482 in Package xz
Our next case looks at a vulnerability in a popular Go language
package. Most of our work to date has studied C language projects.
VDiOSiscompletelyindependentofthelanguage.Wewantedto
look at a Go project to demonstrate the language independence of
VDiOS and WoC. The project at github.com/ulikunitz/xz is a Go
languagepackagesupportingxzcompression.Theproject,which
is still under development, is subject to the vulnerability described
byCVE-2021-29482[ 42],whichisidentifiedashighseveritybythe
NationalVulnerabilityDatabase. Thevulnerabilitywasfixedinthe
file bits.go by commit 69c6093c7b on August 19, 2020, and released
in release v0.5.8.
VDiOS found 11 versions of the file that are potentially vulnera-
ble and twoversionsthat are fixed. Usingthese two lists, VDiOSfound 7,105 projects that are known to contain a vulnerable ver-sion of bits.go in the most current revision and 185 projects that
areknowntocontainafixedversioninthemostcurrentrevision.
6https://www.whitesourcesoftware.com/free-developer-tools/bolt/
7https://www.gnu.org/software/autoconf/autoconf.html
8https://travis-ci.com/Sincethisisaverynew(atthetimeofourstudy)vulnerability,itis
notsurprisingthatthereareonly185projectscontainingafixed
version. Only one project was found that contained the vulnerable
fileinthepastbutdoesnotcurrentlycontainanyoftheknownvul-
nerable or known fixed versions. We looked into this one case and
found that the only difference was that it used the DOS/Windows
format with carriage return and line feed ("\r\n") at the end of each
line instead of the Unix format with only line feed ("\n"). There
were2,037projectsfoundthatusedtocontainthevulnerablefile
but that no longer contain the file at all.
Toexamineprojectsfurther,weusedWoCprojecttodeforked
project(p2P)mappings[ 27]tofindouthowmanyoftheprojects
arenotforked.Outof7,105vulnerableprojects,thisresultedin758
uniqueprojectsthatarenotforkedandcontainthisvulnerability.
Thenumbersfornotvulnerableprojectsare185and82respectively.Toseehowmanyofthesedeforkedprojectsareactivelymaintained,
we looked for those that have at least one commit in the past 6
and past 18 months (at the time of our study). We found that in
vulnerable projects, 271 have at least one commit in the past 6
months, and472 have acommit in the past18 months. Inthe case
ofnot vulnerableprojects, thesenumbers are68 for6months and
82for18months.Aswecansee,thepercentageofactiveprojectsin
vulnerable projects (36% & 62%) are significantly lower than in not
vulnerable projects (83% & 100%), which was intuitively expected.
Nevertheless, not having a commit in a certain period of time does
notmeanthattheotherprojectsarenotbeingused,andsoitisstill
important to address the vulnerability issue. This already shows
the significance of the vulnerability being widely spread.
Toinvestigatetheimpactofthisvulnerabilityfromadifferent
standpoint, welookedat the number ofstars each ofthese projects
has been given as a measure of their popularity in OSS [ 4]. The
results show that in vulnerable projects, at least 443 projects have
more than one star, 273 more than 10, 101 more than one hundred,
31 more than one thousand, and 10 projects have more than 10
thousand stars.In notvulnerable projects,the numbersare 71,44,
23, 10 and 4 respectively.
Table 1: Case 3 - number of projects and their percentage
from deforked projects
As we can see in Table 1, the number of stars in projects that
fixed the vulnerability is relatively higher than vulnerable projects,
which again is what we would intuitively expect. We have also
2110
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA David Reid, Mahmoud Jahanshahi, and Audris Mockus
looked at the number of contributing authors in each project using
WoCprojecttoauthormappings(P2A)whichmapsthedeforked
projectstoaliasedauthorIDs[ 13].Lookingatthepercentages,it
seems that vulnerable projects have relatively fewer developers
involved.
5.4 Case 4: CVE-2017-12652 in libpng
Libpng [35] is a very popular open source graphics library for ma-
nipulatingPNG(PortableNetworkGraphics)imagefiles.Itisanold
library,datingbackto1995,andisstillactivelymaintained.Because
of its popularityand its very longhistory, we expectto find many
copiesinotheropensourceprojects,makingitastrongcaseforour
study.Thelibpngsourcecode[ 44]ishostedonSourceForge[ 37]
and mirrored on GitHub [16].
Libpng was the first case that we studied. Lessons learned from
thiscasewereappliedtoourstudyoftheothercases.Improvements
to VDiOS, as described later in this section, were applied based on
those lessons learned.
Thiscasespecificallylooksatthelibpngfilepngpread.c.Thatfile
isthesubjectofthevulnerabilitydescribedbyCVE-2017-12652[ 40],
which is labeled as a critical vulnerability in the National Vulnera-
bility Database (NVD) [30]. The vulnerability was fixed in August
of 2017 in release 1.6.32. This fix is in commit 347538e and the blob
for pngpread.c at that revision is 45b23a7.
UsingWoC’sblobtooldblob(b2ob)mappingrecursively,VDiOS
finds951oldversionsofthefilepngpread.c.Theoldversionsare
thepotentiallyvulnerableversions.UsingWoC’soldblobtoblob
(ob2b) mapping, VDiOS finds 964 new versions of that file. The
new versions presumably all contain the fix. Next, VDiOS looks at
each potentially vulnerable blob and uses WoC’s blob to commit
mappingtofindthecommits.Onceithasthecommits,itusesWoC’s
commit to project mapping to find all of the projects containing
thediscoveredcommits.Thisgivesusalistofallprojectsthathave
ever contained one of the potentially vulnerable versions of thefile pngpread.c. Finally, VDiOS looks at the head commit of each
projecttoseeifitcontainsaversionofthefilefromthepotentially
vulnerable list, the presumably fixed list, or neither.
The results are as follows:
•63,441 projects contain one of the potentially vulnerable
blobs in the most current revision, even though it was fixed
in the original file more than three years ago.
•458 projects contain one of the presumably fixed blobs in
the most current revision, meaning it used to be vulnerable
but now it is no longer vulnerable.
•20,274projectsdonotcontainblobsfromeitherofthetwo
previouslists,meaningthattheprojectcontainedapoten-
tiallyvulnerableblobinthepast,theblobhasbeenmodifiedinthemostcurrentversion,butwedonotknowifthemodi-
ficationfixedthevulnerability.Wemanuallyinspectedthe
first 10 of those projects and found that two out of the 10projects still contain the vulnerability. In those two cases,
the file was modified, but the specific vulnerability was not
fixed. In the remaining eight cases, the vulnerability was
fixed.
•28,376projectsusedtocontainavulnerableversionofthe
file, but the file has since been removed.We see that over sixty thousand projects contain a vulnerable
versionofthefile.Weselectedasubsetofthoseprojectstoanalyze
inmoredetail.Toselectthesubset,wefirstselectedprojectsthat
have a commit within the last 18 months to eliminate long dor-
mantprojects.Next,weselectednon-forkedprojectstogetalistof
independentprojects.Finally,whenonecommitwenttomultiple
projects,weselectedthefirstonethatVDiOSfoundandeliminatedtheremainingduplicates.Thisprocessofeliminationleavesuswith
1,457 projects. From those 1,457 projects, we randomly selected 88
projectsto analyzeinmoredetail. Inlookingatthese projects,we
findthattheycopytheentirecontentsoflibpng,notjustselected
files.
Our first step is to verify that the 88 projects do indeed contain
the vulnerable code. We manually inspected all of the projects and
found six false positives. There were four projects that had deleted
thevulnerablefileandtwoprojectsthathadfixedthevulnerable
file.Weremovedthosesixprojectsfromfurtheranalysis,leaving
82 projects. We investigated these six cases to understand why
VDiOS produced false positives. In all six cases the reason was
timing. We ran VDiOS to produce the results in early February2021 and analyzed the results over the next two months. WoC is
continuously updated, but will always be a little bit behind what is
liveonthesourcecoderepositoryhostingplatforms.WeranVDiOSon version S of WoC which was updated in August 2020. We foundinthosesixcasesthatthevulnerablefileshadbeenfixedorremoved
after the WoC version that VDiOS used to produce the reports and
beforeweverifiedtheresultsinApril2021.WeconcludethatVDiOS
producedthecorrectoutput,butthecontinuouslychangingopen
source projects will be different from our reports to the extent that
changes are made after the most recent WoC update. As a result of
thisdiscovery,wemodifiedVDiOStousetheAPIsofthehosting
platforms to get the most current revision of the file. The results
presentedinthiscasearebasedontheoriginalversionofVDiOS;
this new enhancement to VDiOS is used for the rest of the cases.
For projects hosted on GitHub, we also verified that GitHub’s
dependabot [ 9] did not find the vulnerability. While dependabot
has similar goals to VDiOS in finding vulnerable dependenciesin the software supply chain, it uses a very different mechanism.Dependabot requires that a repository define dependencies in a
supportedpackageecosystemwhileVDiOSlooksforfilelevelcode
duplication. As expected, none of the projects we found with a
vulnerableversionoflibpngwereidentifiedbydependabot.Several
oftheprojectshadotherissuesidentifiedbydependabot,butnot
the libpng issue we are investigating. This shows that dependabot
isenabled forthese projects.Clearly VDiOSfinds differentsupply
chain dependency vulnerabilities than GitHub’s dependabot.
Finally, we wanted to find out if the maintainers of the projects
that contain known vulnerable files are willing to accept a patch to
fix the vulnerability. For the 82 vulnerable projects, we produced a
patchandsentamessagetothemaintainersthroughapullrequest,
an issue, or an email. We waited up to two weeks for responses.
Sevenprojectmaintainersacceptedourpullrequestwiththepatch.
One project maintainer updated to a newer version of libpng be-
causeofourcontact.Twoprojectmaintainersrespondedandsaid
they would continue using the existing (vulnerable) code. We re-
ceived no responses about the remaining projects.
2111
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. The Extent of Orphan Vulnerabilities from Code Reuse in Open Source Software ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA
Asidefromwhatwefoundthroughthese82projects,wewanted
to have some overall statistics on activity and popularity measures
of vulnerable and not vulnerable projects as we had in previous
cases. Following the same procedures, we found that the 63,441
vulnerableprojectsreduceto9,680deforkedprojectsfromwhich
660 have at least one commit in the past 6 months and 2095 in
thepast18months.Otherthanthat,thereareatleast25projects
with more than 10 thousand stars and 131 projects with more than
1,000 stars which attest the importance of such vulnerabilities. The
detailed numbers are presented in Table 2.
Table 2: Case 4 - number of projects and their percentage
from deforked projects
6 DISCUSSION
Our research is motivated by the orphan security vulnerabilitiescaused by code reuse in open source software. Our primary goalis to better understand orphan security vulnerabilities, and howthey may be mitigated. In this work, we explore the scope of the
problem on a small sample of vulnerabilities and the willingness of
project maintainers to fix issues.
The vast quantity of open source projects distributed over dif-
ferent hosting platforms complicates our task. By exploiting the
World of Code infrastructure, we build a tool, VDiOS, that collects
code reuse data with the coverage and scale that had previously
been impractical. VDiOS is targeting orphan vulnerabilities unlike
theNationalVulnerabilityDatabasethatidentifiesavulnerability
in a single project.
First,usingVDiOS,wefindaverylargenumberofprojectswith
orphan vulnerabilities based on the four vulnerabilities in our case
study. As hypothesized, the probability of an orphan vulnerability
islowerformoreactiveprojects.Also,supportingLinus’sLaw[ 33],
theprobabilityofanorphanvulnerabilityislowerforprojectswith
more developers. Orphan vulnerabilities appear to concentrate in
inactiveornolongermaintainedprojects,buttheyarealsopresent
in very popular (over 10K stars) and very active projects as well.
Orphanvulnerabilities,eveniftheyareinunmaintainedorinactive
projects, still pose risks. First, a developer might copy code from
such projects as, for example, they may have a unique feature that
fixed projects lack. Second, code from inactive projects may still
berunninginexistingsystems,forexampleinembeddeddevices.
We, in fact, found a case where someone asked a question abouta project that appeared to be inactive, indicating that they wereusing it. By looking both at relatively old orphan vulnerabilities
andveryneworphanvulnerabilities,weobserverelativelyfewer
oldorphanvulnerabilities,suggestingthatoftenorphanvulnera-
bilities are eventually fixed or removed. The time to fix appearsto be substantial, providing opportunity for the orphan vulnera-bility to propagate further. Even very well known and very old
vulnerabilities still persist in the orphan form.
Our attempts to gauge willingness of the project maintainers to
fixorphanvulnerabilitiesyieldedmixedresults,withonlyasmall
fraction applying the patch.
Our case study suggests that orphan vulnerabilities are wide-
spread, they take a very long time to be fixed, or they persist. They
exist not only in forks or abandoned projects but also in highlyactiveandpopularprojectsaswell.Evenonceanorphanvulner-ability is identified and the fix provided to a maintainer, only a
small fraction act upon the suggested fix. We conclude that orphan
vulnerabilitiesposeanongoingproblemthatneedstobeaddressed
not just by identifying and providing fixes to the projects, but also
byprovidingscreeningtoolstoprojectsreusingsourcecodeand
by educating the open source development community.
7 LIMITATIONS
Our internal validation relates to the way the tool operates and the
coverage of WoC data. Specifically, VDiOS looks for exact matches
atthefilelevelforthesetofcodeversionsbetweentheversionsthat
introduced and fixed the reference code. Code fragments copied
fromwithinafilemaynotbedetected.First,thisprovidesonlya
conservative estimate of vulnerable files, as minor modifications to
vulnerable(orfixed)filesmaynotbedetected.Second,itisfairly
straightforward to enhance VDiOS to look for snippets, patches,
ormoreabstractrepresentationsofthevulnerability.Itwasnota
priority for our case study but is important to cast a wider net for
capturing more orphan vulnerabilities.
VDiOStakestherevisionofafilethatfixesavulnerabilityand
then uses WoC’s blob to old blob (b2ob) and old blob to blob (ob2b)
mappings recursivelyto find olderand newer revisionsof the file.
Alternatively, it can use WoC’s commit to parent commit (c2pc)
and commit to child commit (c2cc) to find older revisions (up tothe revision that introduced the vulnerability, if we know that)
andnewerrevisions.Theolderrevisionsarelikelytocontainthe
vulnerability,andthenewerrevisionsarelikelytocontainthefix.
However,thatisnotguaranteedtobethecase.Inextremelyrare
cases projects revert back to vulnerable code even after fixing it.
VDiOS allows a manual inspection and modification of the lists
of old and new blobs to see if they are actually vulnerable and
fixedrespectivelybeforemovingontothenextphase.Thismanual
interventionsolvestheproblem,buttoscalethesolutionVDiOS
will need to be enhanced.
If a developer copies a file and makes a small change before
committingforthefirsttime,VDiOSwillnotfindthematch.Addinganewcopyrightnotice,makingformattingchangestomatchastyleguide,orchangingtheCR/LFformatattheendoflinesareexamples
of inconsequential changes that would affect the ability to find a
match.Itwillonlyfindthematchiftheinitialcommitisidentical
tothecopiedfileorapreviousrevisionofthecopiedfile.VDiOS
2112
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA David Reid, Mahmoud Jahanshahi, and Audris Mockus
can be enhanced to catch such and other modifications, and it is
the subject of future work.
WoC contains a relatively complete collection of open source
software, but the collection is not complete, with some projects
missingandaseveralmonthdelaybetweentheversionsofWoC
whennewprojectswithvulnerabilitiesmaybecreated.VDiOSwill
missanycodethatisnotincludedinWoC.Onlyincreasingopen
source coverage for WoC would address this limitation.
It is important to note that some vulnerabilities are never dis-
coveredorfixed,ornotreportedinpublicvulnerabilitydatabases.
In all of these cases VDiOS would not help.
Ourfindings aboutthescope andage oforphanvulnerabilities
is limited by the relatively small sample of vulnerabilities explored.
We hope that by highlighting the scope and seriousness of the
problem with our case study and by building VDiOS, we will spur
improvements to VDiOS and wider studies of vulnerabilities in the
future.
8 RELATED WORK
Significant amount of research in the area of code reuse is domi-natedbystudiesofblack-boxreuse.Researchonwhite-boxcode
reuse, where code is reused by copying the original code and com-
mitting the duplicate code into a new repository, is limited due
tothedifficultyofsearchingtheentiretyofopensourcesoftware
looking for duplicates. Using World of Code (WoC) [ 25] infrastruc-
ture opens new research possibilities in the area of white-box code
reuse as described in section 2.2. We use WoC to find cases of code
reuse across open source projects.
Gharehyazie et al. [ 14] looked at the prevalence of cross-project
codereuseandreportlargeamountsofcodeclonedacrossmultiple
projects. They find that most cloned code comes from projects in a
similardomain.GitHubwasthe onlyrepositoryhostingplatform
thattheylookedatandJavawastheonlylanguage.Inourwork,
we look at code in many different languages and from many dif-
ferent repository hosting platforms including GitHub, Bitbucket,
SourceForge, GitLab, and more.
Xiaetal.[ 47]performedanempiricalstudytofindtheproportion
of out-of-date third-party code reused by C language OSS projects.
UsingOpenCCFinder[ 46],whichusedexternalcodesearchengines
GooglecodesearchandSPARS[ 19],theyfound123projectsthat
reusedoutdatedcodecopiedfromthreeoriginalprojects.Similar
toourfindings,theydeterminedthatasignificant numberofOSS
projectsreusedout-of-datecodethatcontainsecurityvulnerabil-
ities. They report that OpenCCFinder only returns "a very small
subset"ofopensourceprojects.ByusingourVDiOStoollayered
ontopofWoC’snearlycompletecollectionofOSSinanylanguage,
we are able to find a significantly larger number of projects that
reuse vulnerable code.
Decanetal.[ 8],throughempiricalstudyusingJavaprojectsthat
use Maven [ 38], show that it is common practice to use third-party
software components that have known security vulnerabilities,suggestingthatwhatwefoundforCandGolanguagesinwhite-box also applies to black-box reuse in Java. Alqahtani et al. [
1]
link the NVD9with Maven to identify known vulnerabilities in
Mavenprojects.Weexpandonthatbyincludingwhite-boxreuse
9National Vulnerability Database: https://nvd.nist.govand by looking at projects in any language that may not use or
have management tools like Maven.
Kawamitsu et al. [ 21] studied code reuse across repositories,
but only lookedat reuse between pairs of repositoriesrather than
acrossthefullspectrumofopensourcerepositories.Theyintroduce
a method to detect code reuse across 2 repositories.
Ishioetal.[ 20]proposedamethodtofindtheoriginalversion
ofclonedsourcecodefiles.Theirmethodfindsfilesthataresimilar,
not just files that are exact copies. We only look for exact copies of
any revision of the file. Their method may find additional matches
that ourmethod would miss dueto minor changes ina cloned file
beforeitiscommittedthefirsttime.Ourmethodmayfindmatches
that theirs miss because we run it over a much larger dataset of
code repositories.
Inoue et al. [ 18] use code search engines such as Google Code
Search and Koders to find reused code fragments. They presenta tool which takes code fragments and finds cloned fragments
using the public code search engines. It is unclear what coverage is
provided by these third-party tools.
GitHub’sdependabot[ 9]createspullrequestsforprojectsthat
relyonvulnerablelibrariesbutonlyworksforGitHubprojectsandonlywhendependenciesaredefinedinasupportedpackageecosys-tem.VDiOS,ontheotherhand,looksforfilelevelcodeduplication
anddoesnotrelyonsupportedpackageecosystems.VDiOSalso
works with projects across all repository hosting platforms, not
just GitHub.
SZZ unleashed [ 3] finds information about when bugs were in-
troduced.Currently,VDiOSreliesontheusertospecifythecommit
that introduced a vulnerability, but if it is not available, all previ-
ous revisions of a file are considered vulnerable. Using SZZ might
reduce that set.
9 CONCLUSION
Code reuse through code duplication (white-box reuse) is a com-
mon practice in software development. While it has benefits, such
as faster development time, lower cost, and improved quality, it
alsohasinherentrisksasthereusedcodemaycontainsecurityvul-
nerabilities or other problems. In some cases, those vulnerabilities
or bugs may be orphan (known and fixed in other repositories).
In this paper, we describe a case study with four different cases
that show the extent of security vulnerabilities in open source
softwarecausedbycodereuse.Wealsopresentatool,VDiOS,to
findfile-levelcodereuseinanylanguageacrosstheentiretyofopen
source software by leveraging the World of Code infrastructure.
UsingVDiOS,wefindveryextensivewhite-boxreuseofvulnerable
codewithalargenumberofprojectsthatdonotappeartofixthe
upstreamvulnerability.Thesearecaseswherereusedcodecontains
known vulnerabilities or other bugs that persist in open source
projects even though they have been fixed in other projects.
Overall, we mayconclude that extensive code copying inOSS
results in an extensive spread of vulnerable code that may take
yearstofixandthataffectsnotonlyinactive,butalsohighlyactive
and popular projects. We also found that many of the projects may
notbewillingtopatchthevulnerabilitiesevenafterbeingprovided
a fix.
2113
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. The Extent of Orphan Vulnerabilities from Code Reuse in Open Source Software ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA
Thesefindingssuggestthataddressingunfixedvulnerabilities
in OSS requires at least three types of support. On one hand, if a
patchisprovided,someoftheprojectsarewillingtoapplyit.On
the other hand, for projects that do not fix vulnerable code, we
needtoprovideinformationtopotentialusersofthecodethattheir
applicationstillcontainsunfixedvulnerability.Finally,developers
who are contemplating reusing the code in a project that contains
unfixed vulnerabilities need to be informed about the risks and
provided withsuggestions onhow topatch or withpatches fixing
the existing vulnerabilities.
ACKNOWLEDGMENTS
ThisworkwaspartiallysupportedbyNSFawards1633437,1901102,
1925615, and 2120429.
REFERENCES
[1]SultanS.Alqahtani,EllisE.Eghan,andJuergenRilling.2016. SV-AF—ASecurity
VulnerabilityAnalysisFramework.In 2016IEEE27thInternationalSymposiumon
Software Reliability Engineering (ISSRE). 219–229. https://doi.org/10.1109/ISSRE.
2016.12
[2]S. Amreen, A. Karnauch, and A. Mockus. 2019. Developer Reputation Estimator
(DRE).In 201934thIEEE/ACMInternationalConferenceonAutomatedSoftware
Engineering (ASE). 1082–1085.
[3]Markus Borg, Oscar Svensson, Kristian Berg, and Daniel Hansson. 2019. SZZ
Unleashed: An Open Implementation of the SZZ Algorithm - Featuring Example
Usage in a Study of Just-in-Time Bug Prediction for the Jenkins Project. In
Proceedingsofthe3rdACMSIGSOFTInternationalWorkshoponMachineLearning
Techniques for Software Quality Evaluation (Tallinn, Estonia) (MaLTeSQuE 2019).
AssociationforComputingMachinery,NewYork,NY,USA,7–12. https://doi.
org/10.1145/3340482.3342742
[4]HudsonBorgesandMarcoTulioValente.2018. What’sinagithubstar?under-
standing repository starring practices in a social coding platform. Journal of
Systems and Software 146 (2018), 112–129.
[5]Thomas Boutell. 1997. PNG (Portable Network Graphics) Specification Version
1.0. RFC 2083. https://doi.org/10.17487/RFC2083
[6]MirceaCadariu,EricBouwers,JoostVisser,andArievanDeursen.2015. Tracking
known security vulnerabilities in proprietary software systems. In 2015 IEEE
22nd International Conference on Software Analysis, Evolution, and Reengineering
(SANER). 516–519. https://doi.org/10.1109/SANER.2015.7081868
[7]MarcoCarvalho,JaredDeMott,RichardFord,andDavidA.Wheeler.2014. Heart-
bleed101. IEEESecurityPrivacy 12,4(2014),63–67. https://doi.org/10.1109/MSP.
2014.66
[8]AlexandreDecan,TomMens,andEleniConstantinou.2018. OntheImpactof
SecurityVulnerabilitiesintheNpmPackageDependencyNetwork.In Proceedings
of the 15th International Conference on Mining Software Repositories (Gothenburg,
Sweden)(MSR ’18). Association for Computing Machinery, New York, NY, USA,
181–191. https://doi.org/10.1145/3196398.3196401
[9] Dependabot. 2021. Github Dependabot. https://github.com/dependabot
[10]Zakir Durumeric, Frank Li, James Kasten, Johanna Amann, Jethro Beekman,
Mathias Payer, Nicolas Weaver, David Adrian, Vern Paxson, Michael Bailey, and
J. Alex Halderman. 2014. The Matter of Heartbleed (IMC ’14). Association for
ComputingMachinery,NewYork,NY,USA,475–488. https://doi.org/10.1145/
2663716.2663755
[11]Danilo Favato, Daniel Ishitani, Johnatan Oliveira, and Eduardo Figueiredo. 2019.
Linus’sLaw:MoreEyes FewerFlawsinOpenSourceProjects.In Proceedingsof
theXVIIIBrazilianSymposiumonSoftwareQuality (Fortaleza,Brazil) (SBQS’19).
Association for ComputingMachinery, New York,NY, USA, 69–78. https://doi.
org/10.1145/3364641.3364650
[12]W.B.FrakesandKyoKang.2005. Softwarereuseresearch:statusandfuture. IEEE
Transactions on Software Engineering 31, 7 (2005), 529–536. https://doi.org/10.
1109/TSE.2005.85
[13]Tanner Fry, Tapajit Dey, Andrey Karnauch, and Audris Mockus. 2020. A dataset
andanapproachforidentityresolutionof38millionauthoridsextractedfrom2bgitcommits.In Proceedingsofthe17thinternationalconferenceonminingsoftware
repositories. 518–522.
[14]M. Gharehyazie, B. Ray, and V. Filkov. 2017. Some from Here, Some from There:
Cross-Project Code Reuse in GitHub. In 2017 IEEE/ACM 14th International Con-
ference on Mining Software Repositories (MSR). 291–301.
[15]Antonios Gkortzis, Daniel Feitosa, and Diomidis Spinellis. 2021. Softwarereuse cuts both ways: An empirical analysis of its relationship with security
vulnerabilities. Journal of Systems and Software 172 (2021), 110653. https://doi.org/10.1016/j.jss.2020.110653
[16]Glenn Randers-Pehrson. 2020. glennrp/libpng . https://github.com/glennrp/
libpng
[17]Jaap-Henk Hoepman and Bart Jacobs. 2007. Increased Security through Open
Source.Commun. ACM 50, 1 (Jan. 2007), 79–83. https://doi.org/10.1145/1188913.
1188921
[18]K.Inoue,Y.Sasaki,P.Xia,andY.Manabe.2012. Wheredoesthiscodecomefromandwheredoesitgo?—Integratedcodehistorytrackerforopensourcesystems.
In2012 34th International Conference on Software Engineering (ICSE). 331–341.
[19]K. Inoue, R. Yokomori, T. Yamamoto, M. Matsushita, and S. Kusumoto. 2005.Ranking significance of software components based on use relations. IEEE
Transactions on Software Engineering 31, 3 (2005), 213–225. https://doi.org/10.
1109/TSE.2005.38
[20]T. Ishio, Y. Sakaguchi, K. Ito, and K. Inoue. 2017. Source File Set Search for
Clone-and-Own Reuse Analysis. In 2017 IEEE/ACM 14th International Conference
on Mining Software Repositories (MSR). 257–268.
[21]N.Kawamitsu,T.Ishio,T.Kanda,R.G.Kula,C.DeRoover,andK.Inoue.2014.
IdentifyingSourceCodeReuseacrossRepositoriesUsingLCS-BasedSourceCode
Similarity. In 2014 IEEE 14th International Working Conference on Source Code
Analysis and Manipulation. 305–314.
[22]Charles W. Krueger. 1992. Software Reuse. ACM Comput. Surv. 24, 2 (June 1992),
131–183. https://doi.org/10.1145/130844.130856
[23]Nir Kshetri and Jeffrey Voas. 2019. Supply Chain Trust. IT Professional 21, 2
(2019), 6–10. https://doi.org/10.1109/MITP.2019.2895423
[24]Elena Lyulina and Mahmoud Jahanshahi. 2021. Building the Collaboration
Graph of Open-Source Software Ecosystem. In 2021 IEEE/ACM 18th International
ConferenceonMiningSoftwareRepositories(MSR).618–620. https://doi.org/10.
1109/MSR52588.2021.00086
[25]Y.Ma,C.Bogart,S.Amreen,R.Zaretzki,andA.Mockus.2019. WorldofCode:
An Infrastructure for Mining the Universe of Open Source VCS Data. In 2019
IEEE/ACM16thInternationalConferenceonMiningSoftwareRepositories(MSR).
143–154.
[26]YuxingMa,TapajitDey,ChrisBogart,SadikaAmreen,MaratValiev,AdamTutko,
David Kennard, Russell Zaretzki, and Audris Mockus. 2021. World of code:enabling a research workflow for mining and analyzing the universe of open
sourceVCSdata. EmpiricalSoftwareEngineering 26(2021). https://doi.org/10.
1007/s10664-020-09905-9
[27]Audris Mockus, Diomidis Spinellis, Zoe Kotti, and Gabriel John Dusing. 2020.
A complete set of related git repositories identified via community detection
approaches based on shared commits. In Proceedings of the 17th International
Conference on Mining Software Repositories. 513–517.
[28]Paul Myerson. 2017. Can’t Turn Back Time: Cybersecurity Must Be Dealt
With. https://www.industryweek.com/supply-chain/article/22006116/cant-turn-
back-time-cybersecurity-must-be-dealt-with
[29]FrankNagle.2019. OpenSourceSoftwareandFirmProductivity. Management
Science65, 3 (2019), 1191–1215. https://doi.org/10.1287/mnsc.2017.2977
[30]National Institute of Standards and Technology. 2021. National Vulnerability
Database. http://nvd.nist.gov
[31]OpenSSL. 2021. News/Vulnerabilities. https://www.openssl.org/news/
vulnerabilities.html
[32]OWASP. 2017. The Open Web Application Security Project OWASP Top 10. https:
//owasp.org/www-project-top-ten
[33]EricRaymond.1999. Thecathedralandthebazaar. Knowledge,Technologyand
Policy12 (1999), 23–49. https://doi.org/10.1007/s12130-999-1026-0
[34]Eric Rescorla. 2018. The Transport Layer Security (TLS) Protocol Version 1.3.
RFC 8446. https://doi.org/10.17487/RFC8446
[35]GregRoelofs.2006. libpng.org . RetrievedAugust4,2020fromhttp://www.libpng.
org
[36]Crowe S, Cresswell K, Robertson A, Huby G, Avery A, and Sheikh A. 2011.
The case study approach. BMC Medical Research Methodology (2011). https:
//doi.org/10.1186/1471-2288-11-100
[37] Slashdot Media. 2020. SourceForge. https://sourceforge.net
[38]TheApacheSoftwareFoundation.2021. ApacheMavenProject. https://maven.
apache.org/
[39]The MITRE Corporation. 2014. CVE-2014-0160. https://cve.mitre.org/cgi-bin/
cvename.cgi?name=CVE-2014-0160
[40]TheMITRECorporation.2017. CVE-2017-12652. https://cve.mitre.org/cgi-bin/
cvename.cgi?name=CVE-2017-12652
[41]The MITRE Corporation. 2021. Common Vulnerabilities and Exposures (CVE).
https://cve.mitre.org/
[42]TheMITRECorporation.2021. CVE-2021-29482. https://cve.mitre.org/cgi-bin/
cvename.cgi?name=CVE-2021-29482
[43]The MITRE Corporation. 2021. CVE-2021-3449. https://cve.mitre.org/cgi-bin/
cvename.cgi?name=CVE-2021-3449
[44]Cosmin Truta and Glenn Randers-Pehrson. 2020. LIBPNG: PNG reference library.
https://sourceforge.net/projects/libpng
[45]Jun Wang, Mingyi Zhao, Qiang Zeng, Dinghao Wu, and Peng Liu. 2015. Risk
AssessmentofBuffer"Heartbleed"Over-ReadVulnerabilities.In 201545thAnnual
2114
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. ICSE ’22, May 21–29, 2022, Pittsburgh, PA, USA David Reid, Mahmoud Jahanshahi, and Audris Mockus
IEEE/IFIP International Conference on Dependable Systems and Networks. 555–562.
https://doi.org/10.1109/DSN.2015.59
[46]Pei Xia, Yuki Manabe, Norihiro Yoshida, and Katsuro Inoue. 2012. Development
of a Code Clone Search Tool for Open Source Repositories. Information andMedia Technologies 7, 4 (2012), 1370–1376. https://doi.org/10.11185/imt.7.1370
[47]PeiXia,MakotoMatsushita,NorihiroYoshida,andKatsuroInoue.2014. Studying
Reuse of Out-dated Third-party Code in Open Source Projects. Information and
Media Technologies 9, 2 (2014), 155–161. https://doi.org/10.11185/imt.9.155
2115
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:54:36 UTC from IEEE Xplore.  Restrictions apply. 