Demystifying the Composition and Code Reuse in Solidity Smart
Contracts
KairanSun
NanyangTechnologicalUniversity
Singapore, Singapore
sunk0013@e.ntu.edu.sgZhengziXu∗
NanyangTechnologicalUniversity
Singapore, Singapore
zhengzi.xu@ntu.edu.sgChengweiLiu
NanyangTechnologicalUniversity
Singapore, Singapore
chengwei001@e.ntu.edu.sg
KaixuanLi
EastChina NormalUniversity
Shanghai, China
kaixuanli@stu.ecnu.edu.cnYang Liu
NanyangTechnologicalUniversity
Singapore, Singapore
yangliu@ntu.edu.sg
ABSTRACT
As the development of Solidity smart contracts has increased in
popularity, the reliance on external sources such as third-party
packages increases to reduce development costs. However, despite
the use of external sources bringing /f_lexibility and eﬃciency to the
development, they could also complicate the process of assuring
the security of downstream applications due to the lack of package
managers for standardized ways and sources. While previous stud-
ies have only focused on code clones without considering how the
externalcomponentsareintroduced,thecompositionsofasmart
contract andtheircharacteristics stillremain puzzling.
To /f_ill these gaps, we conducted an empirical study with over
350,000Soliditysmartcontractstouncovertheircompositions,con-
ductcode reuseanalysis,and identifyprevalentdevelopment pat-
terns. Our/f_indings indicate thata typicalsmartcontractcomprises
approximately 10 subcontracts, with over 80% of these originating
fromexternalsources,re/f_lectingthesigni/f_icantrelianceonthird-
party packages. For self-developedsubcontracts, around50% ofthe
subcontracts have less than 10% unique functions, suggesting that
code reuse at the level of functions is also common. For external
subcontracts, though around35% of the subcontracts are interfaces
toprovidetemplatesforstandardsorprotocols,aninconsistencyin
theuseofsubcontracttypesisalsoidenti/f_ied.Lastly,weextracted61
frequently reused development patterns, oﬀering valuable insights
forsecure andeﬃcient smart contract development.
CCSCONCEPTS
•General and reference →Empirical studies ;•Software and
its engineering →Software libraries and repositories .
KEYWORDS
smart contract composition,code reuse,development pattern
∗ZhengziXuis thecorresponding author
ESEC/FSE ’23,December 3–9, 2023, SanFrancisco, CA, USA
©2023 Copyright held bytheowner/author(s).
ACM ISBN979-8-4007-0327-0/23/12.
https://doi.org/10.1145/3611643.3616270ACM ReferenceFormat:
Kairan Sun, Zhengzi Xu, Chengwei Liu, Kaixuan Li, and Yang Liu. 2023.
Demystifying the Composition and Code Reuse in Solidity Smart Contracts
.InProceedingsofthe31stACMJointEuropeanSoftwareEngineeringConfer-
ence and Symposium on the Foundations of Software Engineering (ESEC/FSE
’23), December 3–9, 2023, San Francisco, CA, USA. ACM, New York, NY, USA,
12pages.https://doi.org/10.1145/3611643.3616270
1 INTRODUCTION
Smart contracts are a special type of program built on top of
blockchain technology to automate, verify, and enforce the ne-
gotiationofagreementsbetweenparties.Thedevelopmentofsmart
contractshasgainedsigni/f_icanttractioninrecentyearsasithasthe
potential to revolutionize a wide range of industries such as /f_inan-
cialservices,supplychainmanagement,andtheInternetofThings
(IoT) [23]. To lighten the development of smart contracts, Solid-
ity[1]hasbeenproposedandwidelyusedastheprimarylanguage
inmainstreamblockchainplatforms.Forinstance,Ethereum[ 18],as
oneofthemostpopularopen-sourceblockchainplatforms,hasem-
bracedthediverseecosystemofdecentralizedapplications(DApps)
by usingSolidity smart contracts.
However,asthecomplexityofDAppsgrows,thedevelopmentof
smartcontracts(i.e.,smart contractsinthispaperhere andbelow
refer to Solidity smart contracts) is increasingly relying on well-
established subcontracts (i.e., contract-level code blocks as detailed
inSection 2)from thirdpartiestoavoidre-inventingwheelsand
reduce development eﬀorts. While the reuse of third-party subcon-
tracts also poses a new threat that, like supply chain attacks in
traditionalWeb2ecosystems,vulnerabilitiesand/f_lawsfromthird-
party contracts could further collapse downstream applications,
especially in the context of early-staged smart contract develop-
ment that lacks mature dependency management solutions. As
reportedinFeb 2022 [ 14], twocriticalvulnerabilitiesin the subcon-
tracts provided by Multichain [ 11] aﬀected 7,962 user addresses,
and a total of over 3 million dollars were exploited. In this case,
disclosing the potential security risks hidden in reused third-party
subcontracts in time is vitaltothe assurance ofWeb3Security.
Nevertheless, the diverse and /f_lexible third-party subcontract
reuse makes it non-trivial to precisely manage third-party subcon-
tracts introduced during smart contract development. Although
mostcommonlyusedthird-partysubcontractsarereleasedinthe
format of NPM packages, and they can be introduced by NPM
This work is licensed under a Creative Commons Attribution-
NonCommercial 4.0 InternationalLicense.
796
ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA KairanSun,ZhengziXu,ChengweiLiu, KaixuanLi, andYang Liu
dependencies,therearestillvariouswaysandpracticestoreuseex-
isting third-party subcontracts (i.e., simply declaring dependencies
by URLs from Github [ 2] Repos, IPFS gateways [ 3], Swarm gate-
way[4],etc.).Despitetheconvenience,suchdiversityand/f_lexibility
also complicate the security assurance of downstream applications
since the URLs could be untrustworthy. Moreover, though NPM of-
fersversionmanagementofdependencies,itischallengingtotrace
theversionsoftheimportedsubcontracts,especiallyafteron-chain.
Thismakesitdiﬃculttoderivestandardizedsolutionstoidentify,
manage and remediate known vulnerabilities existing in depen-
dencieslikewhatSoftwareCompositionAnalysistools[ 48]doto
Web2applications.Inadditiontoexternalimports,manydevelop-
ersalsotendtodirectlyclonetheexistingsubcontractsintotheir
contractsforconvenience.AsrevealedbyPierroetal[ 41],79.1%of
smart contracts contain duplicated code. Such code clones further
challenge the managementofreusedthird-partysubcontracts.
Tounveilthemysteriesinthedevelopmentofsmartcontracts,
variousexploratorystudieshavebeenconducted.Someresearchers
investigated the characteristics of existing smart contracts such as
thedesignpatterns[ 25]andsourcecodecomplexity[ 40]ofdiﬀerent
kindsofsmartcontracts,whilesomeresearchers[ 34,35]studied
the code reuse of smart contracts at diﬀerent granularity includ-
ing contracts, subcontracts, and functions. However, most existing
works only focused on a single granularity of smart contracts such
as subcontracts or functions, neglecting how these elements are
introduced during development. This may limit the understanding
ofsmartcontractsandleadtoincompleteorinaccurateconclusions
aboutsmartcontracts.Thelackofexplorationinsuchcompositions
alsocompromisesthederivedguidanceonfurthermanagementand
governanceofthereuseofsmartcontractsacrosstheecosystem.
To/f_illthesegaps,weconductedanempiricalstudytoinvestigate
thereuseofthesubcontractsfromtheperspectiveofcontractde-
composition onthe Ethereumblockchains.
TheoverallframeworkofthisstudyisillustratedinFigure 1.We
/f_irst collected over 350,000 smart contracts deployed between Janu-
ary2021andJanuary2023fromEtherscan[ 7],aleadingblockchain
explorerandanalyticplatformforEthereum.Additionally,toen-
hanceourunderstandingoftheexistingthird-partypackagesfor
smart contract development and expand our dataset further for
subsequentcodereuseanalysis,alistof353third-partypackages
fromNPM[ 9]andGitHub[ 2]Reposwascompiledfromtheimport
statementsofthecollectedcontracts.Toensuretherobustnessof
oursubsequentcodereuseanalysis,we/f_irstvalidatedthecontracts
and parsed them into JSON /f_iles with ANTLR-4 [ 6]. We then ex-
amined and /f_iltered out contracts with no or slight modi/f_ication
by conducting a contract-level code clone detection. After this pro-
cess, 296,236 distinct contracts are sorted out for further studies.
Our empirical study oﬀers a comprehensive view of contract com-
position and code reuse practices considering the regulations to
introduce external components. Speci/f_ically, we /f_irst decompose
contracts into various subcontracts based on their origins and how
they were introduced into the contracts. This allows us to separate
self-developedandexternalsubcontractsforin-depthcodereuse
analysis. For self-developed subcontracts, we examine function-
level code reuse, summarizing the commonly reused functions and
functions required to be self-de/f_ined. For external subcontracts,
westudytheusageoffrequentlyreusedsubcontractsandclones
Source code
Data Sources
 Data Preparation
Imports
GitHubNPM
Identify 
similar contracts
Extract 
patterns
RQ4: 
Development 
PatternsDetect code clones
Reuse analysisRQ2: Analysis of 
self-developed 
subcontracts
RQ3: Analysis of 
external 
subcontracts
Decompose 
contracts
Identify
sourceRQ1: Contract 
decomposition
Code
Processing
Figure 1:Frameworkofthe study
acrossthird-partypackages.Lastly,basedonthiscomprehension,
weextractandanalyzethefrequentlyreuseddevelopmentpatterns.
Throughout the empirical study, we concluded some /f_indings
asfollows. Forexample, ①More than80%of thesubcontractsare
from external sources. The largest identi/f_ied external source is
NPM,accountingforover72%ofthetotalexternalsubcontracts. ②
Despite the fact that Solidity allows to include NPM dependencies
byspecifyingtherequiredsubcontractwiththepackagenamein
importstatements,over56%oftheclonedsubcontractsaresourced
fromNPMpackages,indicatingamessindependencymanagement.
③The code reuse of functions is common since around 50% of self-
developedsubcontractshavelessthan10%uniquefunctions.Asthe
number of functions increases in a self-developed subcontract, the
percentageofuniquefunctionstendstodecrease.Thishighlights
thetendencyofdeveloperstorelyonpre-existingcodeblockswhen
developing smart contracts. ④Though around 35% of the external
subcontracts are interfaces, commonly usedas protocol templates,
weidenti/f_iedaninconsistencyintheuseofsubcontracttypeswhich
presents challenges in contract management. ⑤We identi/f_ied 61
prevalent development patterns, 68.75% of which are for token
creations.Whilethesepatternscouldgreatly reducedevelopment
costs, it would be risky if a vulnerability or security exploit was
found in the patterns. Hence, management in such patterns to
continuously monitor andassesstheir security isimportant.
Inconclusion,themaincontributionsofthisstudyareasfollows.
•We provide a thorough analysis of common approaches to
introducing subcontracts in smart contracts, with a further
code reuse analysis to identify the most frequently reused
code blocksandtheir purpose.
•We conduct a comprehensive study of 353 identi/f_ied third-
party packages for smart contract development, analyzing
theirusage frequency andfunctional properties.
•We summarize and assess 61 frequently used development
patterns for smart contracts, which could be potentially used
inlow-code development.
•Based on our results and /f_indings, we provide an in-depth
discussion regarding the challenges in managing external
componentsanddevelopmentpatterns for smart contracts.
2 BACKGROUND
In this section, we provide explanations and de/f_initions of termi-
nologiesthat have been usedinthis study.
797Demystifyingthe CompositionandCode Reuse in SoliditySmartContracts ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA
✦SmartContractandSubcontract. Inthisstudy,asmartcon-
tract refers to code blocks sharing the same address while a sub-
contract refers to a contract-level code block. According to Solidity
documentation [ 12],four typesof subcontracts have been de/f_ined
basedonthe waythey are used:
•interface : subcontracts to de/f_ine a standard or protocol with-
outmethodsimplementations.
•abstract:subcontracts tode/f_ine abasic structurewith some
methodsimplementations.
•contract: complete andexecutablesubcontracts.
•library: subcontracts to provide reusable code blocks for
common operations withoutstorage.
Toclarifythisfurther,inourstudy,subcontractreferstointer-
faces, abstract contracts, contracts, and libraries as detailed above.
Thisservestodistinguishbetweenmodularizedcontract-levelcode
blocks (subcontracts) and the composite code eventually deployed
on the blockchain (contract). Essentially, these subcontracts can be
combinedto form acomplete contract ready for deployment.
✦Ethereum[ 18]andEtherscan[ 7].Ethereumisanopen-source
blockchainplatformsupportingdecentralizedapplicationsthrough
smart contracts. For our study,we selectedtwonetworks:
•EthereumMainnet :themainblockchainnetworkforEthereum
blockchaininvolving real transactions.
•GoerliTestnet :atestingnetworkforEthereumblockchain
to be usedfor smart contract testinganddeveloping.
Etherscan is a blockchain explorer for the Ethereum blockchain
toprovidedetailedinformationonblocksincludingtransactions,
addresses,andthe sourcecode ofsmart contracts if available.
✦EIPs.EIPs (Ethereum Improvement Proposals) [ 8] are formal
proposals for the Ethereum network that help to document the
standardized protocols with possible implementations in a well-
organized format. As EIPs are audited and expected to be safe to
reuse,weincludedEIPsasabasicapproachtoevaluatingthesafety
ofsmartcontracts,third-partypackages,anddevelopmentpatterns.
✦CloneTypes. Fourclonetypescategorizecodeclonesinsoft-
ware systems[ 42].In our study, we focus on type-2 clones, which
are syntactically identical codes with diﬀerent identi/f_iers or lit-
erals, and use type-1 clones, exact code copies diﬀering only in
whitespace or comments, for validation. We exclude type-3 and
type-4,whichconcentrateonmajorchangesandsemanticparal-
lels.Whilesmartcontractsarerelativelysimpleandstandardized,
type-3 and type-4 clones may introduce a signi/f_icant amount of
false similarities, aﬀecting the overallaccuracyofthe result.
3 EMPIRICALSTUDY
3.1 Research Questions
The structure of our research questions is presented in Figure 2. To
explore contract compositions and common development practices
with considerations of dependency introduction, we /f_irst decom-
posecontractsintosubcontracts,identifyingtheiroriginsandintro-
ductionmethods.Wethenconductin-depthcodereuseanalyseson
subcontractsfromvarioussourcesseparately(i.e.,self-developed
or external), providing insights into their individual characteristics.
Lastly,withabetterunderstandingofthecompositionsofcontracts
andcodereuse,weextractedfrequentlyuseddevelopmentpatterns.
……Solidity smart contracts
External 
sourcesSelf-
developed
Subcontracts
Code reuse analysis 
Development Patterns (RQ4)
RQ3 RQ2Decomposition (RQ1)
Figure 2:Relation between research questions
3.1.1 ContractCloneDecomposition(RQ1):Whatarethecommon
approachestointroducingsubcontractsintosmartcontractsandtheir
sources?Identifying contract compositions and quantifying the
use of various approaches to introducing subcontracts. The results
obtained from the exploration serve as the fundamental for the
subsequent analysis.
3.1.2 Analysis of Self-Developed Subcontracts (RQ2): What are the
characteristics of self-developed subcontracts? Understanding the
characteristicsandextentofcodereuseinself-developedsubcon-
tracts can highlight common areas of customization, thereby in-
formingtailoreddevelopmentpractices andtooling.
3.1.3 AnalysisofExternalSubcontracts(RQ3):Whatarethechar-
acteristicsofexternalsubcontracts? Analyzingthecharacteristics
andcommonapplicationsoftopreusedexternalsubcontractsand
third-partypackagestoaidinbettercontractdevelopmentguidance
andthird-partypackage management.
3.1.4 Development Pa/t_terns (RQ4): What are the commonly used
developmentpa/t_ternsinsmartcontractdevelopment? Extractingand
analyzingfrequentlyreuseddevelopmentpatternsinsmartcontract
development which re/f_lects common usage and safety practices,
thusinformingbestpracticesandpotentiallyin/f_luencingthedesign
ofsafer smart contract developmentframeworks.
3.2 DatasetPreparation
AnoverviewofourdatapreparationprocessispresentedinFigure 3.
WecollectsmartcontractsourcecodefromEtherscan[ 18],NPM[9],
andGitHubRepos[ 2].Tonormalizeandtransferthecollectedcode
into a suitable format for the subsequent analysis, we also conduct
aseries ofdata preprocessing before our analysis.
3.2.1 Contract Collection. For our empirical study, we /f_irst col-
lectedthesourcecodeof221,309deployedsmartcontractsonthe
EthereumMainnetand131,207contractsontheGoerliTestnet[ 15]
from Etherscan [ 7]. To extend our dataset and better trace sub-
contractorigins,wethencollectedthesourcecodeofthird-party
packages for smart contract development, the list of which was
compiled by performing a syntax-based extraction to the import
statements from the primary dataset. In the end, we managed to
identifytheuseof337NPMpackagesand33GitHubrepositories
that are usedinsmart contract development.
3.2.2 ContractPreprocessing. Aftercollectingthesourcecodeof
smart contracts, the following three steps are taken in sequence to
processthe contracts for the subsequent experiments.
798ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA KairanSun,ZhengziXu,ChengweiLiu, KaixuanLi, andYang Liu
Source Code 
Validation
Imports
Contract Collection
Contract Data 
ExtractionDuplicated Data 
Removal
Contract Preprocessing
Tokenize
Normalize
MD5 Hash
Figure 3:Overview ofdata preparation
Source Code Validation. As our primary contract collection is
fromEtherscan[ 7],anopenplatformwhereuserscanuploadsource
code,weconducted atwo-stagevalidationtoensure theintegrity
andcompletenessofthedataset.First,wecon/f_irmthecontractsare
stored in a single /f_ile with all required meta details (i.e., address,
contactname,andcreationdate).Second,weverifyeachcontract
is non-empty by inspecting the content within the outermost curly
bracketsofeachsubcontract.Afterthevalidation,approximately
3%ofthecontractsare/f_ilteredout,comprisingaround6,241onthe
EthereumMainnetand2,240 onthe GoerliTestnet.
ContractDataExtraction. Toensureanaccessiblerepresentation
of contract data for further analysis, we developed a parser for So-
lidity smart contracts using ANTLR4 [ 6]. Theparser /f_irst converts
smartcontractsintotokenstreams,extractingtwotypesofinfor-
mation for each token: its original text and its token type identi/f_ier.
We then extract code blocks such as subcontracts and functions
from thecontract andcomputethe MD5hashfor eachblockafter
type-2normalization(i.e.,removewhitespacesandcomments,and
renamevariables)tofacilitatefurtheranalysis.Afterthis,eachcon-
tractwillbesavedasaJSON/f_ilecontainingalltheextractedand
computedinformationasdepictedinFigure 3.Anexampleofthe
complete output/f_ile can be foundonour website [ 17].
Duplicated Contract Removal. The aim of this study is to deter-
minethe commonpracticesinsmartcontractdevelopment.How-
ever, having multiplecopiesoftheduplicatedcontractswithonly
minorchangesornochangesmayskewtheresults.Toaddressthis,
we grouped contracts based on their contract-level MD5 hashes
aftertype-2normalization.This ensures that contracts withinthe
samegroupcanonlyhaveminordiﬀerencessuchasvariablenames.
As a result, 7,617 groups were identi/f_ied to have more than one
contract. We then conducted a manual inspection for the groups
andcon/f_irmedthat90.17%arecreatedbythesameteamsasdetailed
in Section 3.3. Hence, to avoid the overrepresentation of similar
contracts and enhance the diversity of our datasets, we decided to
retain only the earliestversionofeachcontract group.
Intheend,wekept189,229distinctcontractentriesforEthereum
Mainnet and 107,034 entries for Goerli Testnet. The processed data
were savedto adatabasefor use inlatercode reuse analysis.
3.3 Contract CloneDecomposition (RQ1)
3.3.1 ExperimentsSetup. Togaininsightsintothecompositionsof
contractsandcommonpracticesindevelopment,wecommenced
our study by assessing contract-level code clones and quantifying
the various approachesto introducing subcontractsinto contracts.
This lays the foundationfor the subsequent analysis.Initially, for the contract-level clone analysis,we examined the
duplicated contract groups identi/f_ied during data preprocessing as
detailed inSection 3.2.2. Ateam of three smart contract auditors
conducted a manual inspection on a randomly selected sample
with 366 groups. The sample size was determined by Cochran’s
equation[ 29]togetherwithapopulationcorrection[ 36].During
the inspection, each auditor independently evaluated the reason
behindduplication.Collective discussions were thenheld untilan
agreement wasreachedincaseswhere initialopinionsvaried.
Upon obtaining a comprehensive understanding of contract
clones, we directed our focus toward compositions of contracts.
RecognizingthatEtherscan[ 7]includesexternallyimportedsub-
contractsin thepublishedcontractsource code,weintegratedthe
approaches to introducingexternal subcontractsinto our analysis.
Upon identifying subcontract clones based on the pre-computed
MD5hashes,wecategorizedthembytheirintroductionapproaches,
quanti/f_ied the prevalences of these approaches, and traced the ori-
ginsofexternally introducedsubcontracts.
3.3.2 Results and Discussion. Our /f_indings for contract and sub-
contractclonesaredetailedseparatelyinthefollowingsubsections.
AnalysisofContractClones. ThecontractcloneratioinEthereum
Mainnet and Goerli Testnet accounts for 14.50% and 18.42% respec-
tively. Out of these, a total of 7,617 contract groups in Ethereum
Mainnetwereidenti/f_iedasduplicatesduringthedatapreprocessing
stage(i.e.,contractswithineachgrouphavethesameMD5hash).
Upon conducting a manual inspection of the sample groups, we
discovered that about 89.16% of these groups are caused by version
iterations while 3.31% are linked to the use of generators. The rest
groupsalsoseemtofollowprede/f_inedtemplates,however,theexact
reasonbehindthisstillremainsunclearduetothelackofexplicit
statementsoravailableonlinedocumentation.Ontheotherhand,
90.17% of the groups consist of contracts deployed by the same
teamorindividuals.Thiswasveri/f_iedbyinvestigatingtherecord
of the author in the source code and the details of the contract
creatoronEtherscan[ 7].Asaresultoftheinspections,wecould
con/f_irmthattheidenti/f_iedgroupsdonotcontributetothediversity
ofcontractdevelopment,hence,itisacceptabletobeexcludedfrom
our analysisto avoid an overrepresentation of similar contracts.
To gain more insights into the patterns and characteristics of
contract cloning, we analyzed the distribution of group size. De-
spitethehighvolumeofidenti/f_iedgroups,only2groupscontain
over 1,000 contracts, with mere 40 groups exceeding 100 contracts.
This indicates that high-volume duplications are uncommon in the
dataset. In fact, such extensive duplications are mostly linked to
theuseoftokengenerators.Forinstance,the2groupswithmore
than1,000contractsareboththeproductsoftokengenerators.The
largestgroupwithasizeof2,849isgeneratedbytheERC1155to-
kencreatorpublishedbymanifoldxyz[ 20]whilethesecondlargest
group with a size of 1,105 is due to the use of the ERC20 token
generatorpublishedby[ 30].Apartfromthat,wenoticedtheexis-
tence of a type of contract that is created and executed on demand
with only minor changes. An example of this contract type is lock-
EtherPay, which is a token lock thatonly changes the address of
the bene/f_iciary per deployment, which is discussed by Kondo et
al.[35].Ontheotherendofthespectrum,weobservedthatgroups
dueto versioniterations usually have fewer than5contracts.
799Demystifyingthe CompositionandCode Reuse in SoliditySmartContracts ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA
Table 1: Average percentage of subcontracts that in intro-
duced usingvarious approaches
Self-Developed Imported Cloned
EthereumMainnet 16.43% 22.62% 60.95%
Goerli Testnet 17.68% 39.82% 42.51%
Moreover,wealsoquanti/f_iedthepurposeofthegroupsofcon-
tracts during the inspection. Over 80% of the groups are for tokens
withvariousfunctionalities.Speci/f_ically,66.10%ofthegroupsare
for ERC20 tokens and 22.38% of the groups are for ERC721 tokens.
Finding1: Among the7,617groups ofduplicated contracts,
over 80% of the groups are related to tokens, with ERC20
tokens making up 66.10% of the groups. Large-scale contract
duplicationsusuallycomefromusinggenerators.Additionally,
90.17%consist ofcontracts createdbythe same team.
AnalysisofSubcontractClones. Asmartcontractincludesaround
10 subcontracts on average. These subcontracts can be classi/f_ied
into three categories based on how they are introduced to a con-
tract: ①Imported subcontract. A subcontract that is introduced
byanimportstatementreferringtoanexternalsourcesuchasan
NPM package or a URL. ②Cloned subcontract. A subcontract
that is copied from another external source including earlier de-
ployedsmartcontractsandthird-partypackageswithoutanimport
statement referring to the source. ③Self-developed subcontract.
A subcontract that is neither imported nor cloned from external
sources including earlier deployed smart contracts and third-party
packages. Among the three categories, ①and②are considered
externalsubcontracts.Inourcase,we/f_irstcon/f_irmedimportedsub-
contracts in each contract by checking its import statements. Next,
weconductedasubcontract-levelcodeclonedetectiontoidentify
clonedsubcontracts.Intheend,weclassi/f_iedthosenotimported
orclonedas self-developedsubcontracts.
To better understand the compositions of contracts, we then de-
terminedtheaveragedistributionoftheaforementionedthreetypes
of subcontracts within smart contracts for both Ethereum Mainnet
andGoerliTestnet,asshowninTable 1.Theresultindicatesthat
cloningisthemostprevalentapproachtointroducesubcontractsin
smart contract development, especially for contracts on Ethereum
Mainnet,where60.95%ofthesubcontractsarecloned.Additionally,
fewer than 20% of the subcontracts are classi/f_ied as self-developed,
which suggests that the current development of smart contracts
heavily relies on external solutions. Though the use of external so-
lutionshelpstoreducedevelopmentcostsandimprovecodequality,
it may also introduce potential security risks and make it harder to
maintain the code inthe longrun.
Furthermore,we managed to tracethe origins of some external
subcontracts introduced via diﬀerent approaches. For imported
subcontracts, we focused on the two types of import statements to
introducesubcontractsfromexternalsourcesasdocumentedin[ 5]:
①Import from NPM packages using import statement followed by
thenameoftheNPMpackage; ②ImportfromURLsusingimport
statement followed by a URL such as Github [ 2], IPFS gateway [ 3],
and Swarm gateway [ 4]. In our dataset, we only discovered the
useofURLsreferringtoGitHubReposwhichaccountsfor0.13%Imported 
Subcontracts
(~31.22%)Deployed Smart 
ContractsCloned 
Subcontracts
(~51.73%)
Self-Developed 
Subcontracts
(~17.06%)From Unknown 
Sources
Third-Party 
PackagesNPM
GitHub...Based on how introducedIdentified 
from on-chain 
contracts
Third-party 
subcontracts 
( >60%)
Figure 4:Decomposition ofdeployed smart contracts
of imported subcontracts, indicating an imbalance in the use of
the two types of import statements in smart contract development.
Infact,about51%oftheidenti/f_iedGitHubReposhavepublished
NPMpackages.ThissuggeststhatNPMactsasthepackageman-
ager for most third-party packages in smart contract development.
However,NPM isnot optimizedfor managingSoliditylibrariesor
dependencies.For example, ①Lackofversioninganddeployment
management. NPM does not help with the versioning of subcon-
tracts and deployment of smart contracts in various environments.
Importantinformationsuchastheversionofimportedsubcontracts
may be lost after the contract is published online as the log /f_ile
generatedbyNPMtorecordsuchinformationwillnotbepublished
together. ②Lackofsecurity.NPMdoesnotprovidenecessaryse-
curity measures for managing Solidity libraries, which is crucial
for smart contracts to ensure the reliability of on-chain informa-
tionsuchasthe integrityof DAppsand the protectionof valuable
assets. ③Lackofcompatibility.NPMwasoriginallydesignedfor
managing libraries, andas a result, it does not directly compatible
withEthereum.TouseNPMpackagesinSoliditysmartcontracts,
extra steps are needed, such as specifying the path of the imported
subcontract within the NPM package inthe import statement.
Whileforclonedsubcontracts,wediscoveredthatover56%of
theclonedsubcontractsaresourcedfromthird-partypackagesin
bothEthereumMainnetandGoerliTestnet.Thisindicatesacom-
mon practice of reusing subcontracts from third-party packages by
cloning instead of using import statements. In the view of develop-
ers,somepossiblereasonsforthiscouldbe: ①Lackofawareness.
Developers may lack awareness or familiarity withavailable pack-
age management tools. ②Lack of trust. Developers may lack trust
in existing package management tools for smart contract develop-
ment, hence prefer to copy and paste directly from their reliable
sources. ②User-unfriendly.Developersmay/f_inditdiﬃculttoiden-
tifythepathofasubcontractwithinathird-partypackagewhich
is needed by the import statements in Solidity. ③Need for cus-
tomization. Developers may want to make modi/f_ications to the
subcontract, whichisnot allowedbyusing import statements.
Finding 2: We summarized the composition of smart con-
tracts in Figure 4. Smart contracts often consist of three types
of subcontracts: cloned (51.73%), imported (31.22%),and self-
developed (17.06%). However, over 56% of the cloned subcon-
tractscanbeimportedfromthird-partypackages.Additionally,
we found that NPM contains most third-party packages for
smart contract development,though its use isnot optimized.
800ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA KairanSun,ZhengziXu,ChengweiLiu, KaixuanLi, andYang Liu
Table 2:Topreused externalsubcontracts
Known Source Unknown Source
EthereumMainnet Goerli Testnet EthereumMainnet Goerli Testnet Rank
Name Kind % Name Kind % Name Kind % Name Kind %
1 IERC20 interface 39.66% Context abstract 25.75% IUniswapV2Factory interface 25.79% ERC721Creator contract 5.30%
2 Context abstract 34.44% IERC165 interface 22.36% SafeMath library 22.20% VRFCoordinatorV2Interface interface 1.26%
3 IERC165 interface 28.47% IERC721Receiver interface 16.70% Context abstract 21.76% ERC721Creator contract 1.03%
4IERC721Receiver interface 25.04% ERC165 abstract 15.12% IUniswapV2Router02 interface 12.58% IFactory interface 0.97%
5 ERC165 abstract 21.90% Address library 14.11% Ownable contract 12.39% SafeMath library 0.64%
6IERC721Metadata interface 20.51% IERC721Metadata interface 12.63% ERC721Creator contract 10.51% Context abstract 0.58%
7 Strings library 20.39% Ownable abstract 11.28% IUniswapV2Router02 interface 8.70% ERC1155Creator contract 0.48%
8 IERC721 interface 17.32% IERC20 interface 10.55% Ownable contract 7.19% IERC20 interface 0.40%
9 Address library 17.08% IERC721 interface 10.30% SafeMathUint library 4.28% ContextMixin abstract 0.36%
10 Ownable abstract 16.27% Strings library 9.19% SafeMathInt library 4.20% PriceConverter library 0.35%
(1) The% in the tablerepresentsthe proportionofuse ofthe subcontract out oftotalcontracts.
3.4 Analysis ofSelf-Developed Subcontracts
(RQ2)
3.4.1 Experiments Setup. To assess code reuse in self-developed
subcontracts,weimplementedatwo-stepanalysis.First,wecon-
ductedafunction-levelclonedetectionwithinthesubcontractto
determinetheextentofcodereuseincontractdevelopment.Second,
wequanti/f_iedthepercentageofuniquefunctionsineachsubcon-
tract,providinginsightstounderstanddevelopers’behaviorofcode
reuse inrelation to the complexityofthe contract.
Additionally, to comprehend the common usage of the reused
functions, we quanti/f_ied these functions based on their function-
ality by identifying keywords in function names (e.g., mint and
transfer), the origins of functions if identi/f_iable, and function types
(i.e.,function,modi/f_ier,event,andconstructor ).Wealsoconducted
casestudiesfor the mostfrequentlyreusedfunctionsto betterun-
derstand the trends offunction-level code reuse.
3.4.2 Results and Discussion. The result for function reuses in
self-developedsubcontracts ispresentedin Figure 5andFigure 6.
Analysis of Function Clones. The result reveals consistent func-
tionreusepatternsforself-developedsubcontractsacrossEthereum
MainnetandGoerliTestnetassuggestedinFigure 5.Approximately
50% of the identi/f_ied self-developed subcontracts contain less than
10%uniquefunctions,denotingthatthereuseofcodeatthelevelof
functionsisalsoacommonpracticeinsmartcontractdevelopment.
Despitethis,whilecatalogingfunctionusagefrequencywithinself-
developedsubcontracts,wefoundthatonly27.10%and28.05%of
functions were reused for Ethereum Mainnet and Goerli Testnet
respectively. This indicates that the commonly reused functions
tendto be concentratedonasmall setoffunctions.
Furthermore,inexploringthecorrelationbetweenthenumber
ofuniquefunctions and thetotalfunctioncount inself-developed
subcontracts, we found self-developed subcontracts with fewer
functionshaveahigherratioofuniquefunctions,asdepictedinFig-
ure6. Particularly, self-developed subcontracts with less than 10
functions showed the highest unique function ratio (40.53%). 72
self-developed subcontracts are identi/f_ied to have 100% unique
functions, 56.94% of which only have one function. However, as
more functions are required in self-developed subcontracts, the
percentage of unique functions drops. This indicates that develop-
ers tend to reuse more code blocks from external sources during
development rather than writing everything from scratch when
therequired functionality becomes more complicated.While such
Figure 5: Unique functions in self-developed subcontracts
forbothEthereum Mainnetand Goerli Testnet
Figure 6: Average percentage of unique functions with re-
spect to the total functions in self-developed subcontracts in
smart contracts
codereuseisusuallytomitigatepotentialvulnerabilities,thesafety
of external functions may not be guaranteed since only around 8%
are from well-established packages. Additionally, integrating these
functionswithinthesubcontractcouldbechallenging,especially
when interactionsbetween functionsneedto be considered.
Finding 3: Code reuse is a common practice at the function
level, especially when the required functionality is compli-
cated. Additionally, we noticed consistent reuse of a small
set of functions across subcontracts, re/f_lecting common func-
tionalrequirements duringdevelopment.
AnalysisofFunctionUsage. Themajorityofuniquefunctions
and reused functions are standard functions. A substantial por-
tionofuniquefunctionsisconstructors,takingaround21.56%in
EthereumMainnetand13.64%inGoerliTestnet.Constructorsare
a special type of function that is called during contract creation to
initialize the contract and set the initial state. This implies that the
801Demystifyingthe CompositionandCode Reuse in SoliditySmartContracts ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA
contractinitializationprocessoftenrequiredspeci/f_iccustomization
to cater to the particularneedsofindividualsmart contracts.
On the other hand, reused functions often represent commonly
needed functionalities.We foundthat over 20% of these functions
aregettersandsetters,whicharewidelyusedtoaccessandmodify
the currentstate ofthe contract.Functions relatedto mintingand
transferringalso makeupa signi/f_icantportion ofbothreused and
unique functions, accounting for more than10%intotal.
In fact, the balance between unique and reused functions in
smart contracts appears to be a blend of custom-tailored opera-
tionsandwidelyusedstandardfunctionalities.Assmartcontract
development continues to evolve, understanding the interplay and
appropriateapplicationoftheseuniqueandreusedfunctionswill
be crucial inoptimizing contract eﬃciency andeﬀectiveness.
Finding4: Bothuniqueandreusedfunctionsareprimarily
standardfunctions,withconstructorsconstitutinganotable
portionofuniquefunctions,indicatingfrequentcustomization
requirements duringcontract initialization.
3.5 Analysis ofExternal Subcontracts (RQ3)
3.5.1 Experiments Setup. To comprehend the signi/f_icance and im-
plicationsofexternalsubcontracts,whichaccountfor80%ofthe
total,weconductedexperimentsfromthreeaspects. ①Analysis
ofsubcontracttype. Tounderstandcommonusagesofexternal
subcontracts,wequanti/f_iedtheuseofthefourtypesofsubcontract
thatarede/f_inedforvarioususage(i.e., contract,abstract,interface,
andlibrary).Furthermore,weexaminedtheinconsistencyinthe
useofsubcontracttypes. ②Analysisofsubcontractusagefre-
quency. To gain insights into the trends of external subcontract
utilization, we ranked the subcontracts based on their frequency
across ourdataset and thenconductedcasestudieswith themost
reusedcontractexamples. ③Overviewofthird-partypackage.
To comprehend the usage of existing third-party packages, we ana-
lyzedpackageusagefrequencyanduncoveredpotentialcodeclones
across packages by conducting a subcontract-level clone detection
onallrecognizedthird-partypackages.
3.5.2 ResultsandDiscussion. Wepresentour/f_indingsforthethree
stagesinthe three subsections belowseparately.
AnalysisofSubcontractType. Theusagefrequencyofthesefour
typesofsubcontractsisdetailedinTable 3.Amongthefourtypesof
subcontracts, interfacetakesthemostpercentageinbothEthereum
Mainnet (36.59%) and Goerli Testnet (34.85%). This is reasonable
sinceinterfaceisusuallyusedasthetemplateofwell-established
standards (e.g., EIPs) and protocols (e.g. Uniswap [ 19]). Hence, the
useofinterfaceoftenindicatesreusingestablishedstandardsand
protocols to reduce development costs while ensuring consistency
andinteroperability between contracts.
Whileexaminingexternalsubcontractswiththetypeof contract,
whichaccountforover30%ofthetotalsubcontractsinbothnet-
works, we observed an inconsistent use of subcontract types. One
case study we provide in this paper is regarding SafeMath, a utility
libraryforcommonsafemathoperations.Inthecontextofsmart
contract development, libraryrefers to a reusable code block for
multiplecontractstoperformcommontaskswithoutstoragewhile
contractisaself-containedunitoflogictoexecuteitsownfunctionsTable3:Percentageofexternalsubcontractsforvarioustypes
Interface Contract Abstract Library
EthereumMainnet 36.59% 34.86% 16.11% 12.45%
Goerli Testnet 34.85% 34.28% 16.99% 13.88%
withstorage.Hence, SafeMathisexpectedtobe de/f_inedas library
here. However, it was incorrectly de/f_ined as contractin 10% of the
over 26,000 de/f_initions. We manually checked the subcontracts de-
/f_ined ascontractand noticed the declarations that SafemMath is
a library in code comments. Similarly, IERC20 is meant to be an
interfaceto provide the de/f_inition of EIP20 [ 13] but was de/f_ined as
contractwithoutfunctionimplementationsinsomecontracts.In
fact, over 93%ofthe identi/f_iedcasesinvolve the type of contract.
Theseinconsistenciescouldstemfromdeveloperconfusionre-
garding the usage of subcontract types, potentially leading to com-
patibility issues, diﬃculties in maintenance, and increased vulnera-
bilityrisks.The/f_lexibleusageof contracttypemaycontributeto
this confusion since it can mimic the functionalities of interface,
abstract,andlibrary.Infact,over93%oftheidenti/f_iedcasesinvolve
thetypeof contract.Thoughvarioustypesofsubcontractsareex-
pectedtohelpdeveloperstoorganizecodemoreeﬃcientlywhile
improvingthemaintainabilityandreadabilityofcodeblocks,thein-
consistency in the use of subcontract types brings more challenges
to smart contract management.
Finding5: Whilethe35%ofexternalsubcontractstobe in-
terfaceindicates a good practice to follow well-established
standardsandprotocols,theusageofsubcontractswiththe
typeofcontract,accountingforanother35%ofthetotalsub-
contracts, reveals the inconsistency in the use of subcontract
types,whichbringschallengestosmartcontractmanagement.
Analysis of Subcontract Usage Frequency. The result of top-
reused external subcontracts is presented in Table 2. Here, by sub-
contractswithknownsources,werefertoimportedsubcontracts
and cloned subcontracts sourced from our collected third-party
packages. While subcontracts with unknown sources are cloned
subcontracts with their origins not con/f_irmed yet. Due to the page
limit, we only provide the top 10 reused subcontracts in this paper
whilethe restwillbe available onour website [ 17].
The result suggests that third-party subcontracts are used more
frequentlycomparedto those from unknown sources,particularly
in Goerli Testnet where the most frequently reused subcontract
from unknown sources only appears in 5.3% contracts, which is
lowerthanthe10thmostfrequentlyreusedthird-partysubcontract.
Moreover,thefrequentuseofIERC20andIERC721inthird-party
subcontractshighlightsthatoneofthemostpopularapplications
in smart contractdevelopment is thecreation of tokens including
both fungible (ERC20) andnon-fungible(ERC721) tokens.
Inaddition,thoughsubcontractswiththetypeof contracttake
around 35% in external subcontracts as shown in Table 3, most
of them are not frequently reused subcontracts. In the top 1,000
reused external subcontracts, subcontracts with the types of ab-
stractandlibrarymake up 50% of the total while interface takes
another 32%. This suggests a good practice in smart contract de-
velopment since subcontracts with the types of interface,library,
802ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA KairanSun,ZhengziXu,ChengweiLiu, KaixuanLi, andYang Liu
Table 4:Topreused third-partypackages
Import Clone Total
EthereumMainnet@openzeppelin/contracts 29.59% @openzeppelin/contracts 43.90% @openzeppelin/contracts 73.46%
@openzeppelin/contracts-upgradeable 4.25% @aragon/apps-vault 3.52% @openzeppelin/contracts-upgradeable 4.50%
erc721a 2.83% @pancakeswap/pancake-swap-lib 1.52% erc721a 3.72%
hardhat 1.15% @pooltogether/pooltogether-contracts 0.97% @aragon/apps-vault 3.52%
@uniswap/v2-periphery 0.55% erc721a 0.89% @pancakeswap/pancake-swap-lib 1.52%
Goerli Testnet@openzeppelin/contracts 47.97% @openzeppelin/contracts 0.10% @openzeppelin/contracts 48.07%
@openzeppelin/contracts-upgradeable 10.40% @/f_lair-sdk/contracts 0.04% @openzeppelin/contracts-upgradeable 10.42%
hardhat 5.78% synthetix 0.04% hardhat 5.78%
erc721a 3.54% @thirdweb-dev/contracts 0.04% erc721a 3.54%
@uniswap/v3-core 1.05% @connext/nxtp-contracts 0.03% @uniswap/v3-core 1.05%
andabstractare expected to be reused code blocks. It is hoped that
more such reusablecode blocks can be extractedor created in the
futureforsafesmartcontractdevelopment.Furthermore,itisob-
served that some subcontracts often appear together. For instance,
wenoticedthatIERC721andIERC165alwayscomeinpairs.This
is because IERC721 is an interfacefor standard non-fungible token
development, which inherits from IERC165 to make sure compati-
bility between interfaces. This suggests the potential to discover
developmentpatterns for smart contracts.
Finding6: Subcontractsfromwell-establishedthirdparties
are usedmore frequentlythanthosefrom unknownsources.
The most frequently reused subcontracts are well-de/f_ined
reusable subcontracts with types of interface,library, andab-
stract,makingup82%inthe top 1,000 reusedsubcontracts.
Overview of Third-Party Packages. The usage frequency of the
third-party packages is summarized in Table 4. The result high-
lights the wide use of OpenZeppelin [ 10], the packages for secure
smart contract development. On Ethereum Mainnet, over 73% of
contractsintroducedsubcontractsfromOpenZeppelinpackages.In
fact, the top 10 reused third-party subcontracts in Table 2for both
networks are all from OpenZeppelin packages. Apart from that,
weidenti/f_iedthefrequentuseoferc721a,apackagethatexplores
gas optimization in batch-minting NFTs for ERC721 tokens. The
rest of the frequently reused third-party packages are either for
testing(i.e., Hardhat [ 16])ortoken exchange (i.e., Uniswap [ 19]).
Additionally,sinceathird-partysubcontractcanbeeitherimported
orclonedtoasmartcontract,wealsoquanti/f_iedtheuseofthird-
party packages introduced via diﬀerent approaches, from where
wenoticed thatcontractsinEthereumMainnet tendtoclonesub-
contracts from OpenZeppelin packages instead of using import
statements.Apartfromthat,theuseofsomeotherpackageswas
highlighted. @aragon/apps-vault and@thirdweb-dev/contracts are
forwebapplicationswhile @pancakeswap/pancake-swap-lib isan
extensionofUniswapfocusing onsafetyandgas eﬃciency.
During the examination of third-party packages, the follow-
ing three types of packages were summarized: ①Packages follow-
ingEIPsfor safesmart contractdevelopment(e.g.OpenZeppelin);
②Packages to de/f_ine or to be used under speci/f_ic protocols (e.g.
Uniswap); ③Packages for utility and testing (e.g. Hardhat [ 16]).
In our identi/f_ied third-party packages, 25% of packages follow EIP,
the standards suggesting potential new features or processes for
Ethereum [ 8]. The rest packages are either used under speci/f_ic
protocols (65.31%)orfor testingandutility(9.69%).Moreover, to have a better idea regarding the extent of clones in
third-party packages, we also performed a subcontract-level clone
detection for all identi/f_ied third-party subcontracts, through which
we found 139 subcontracts that appear in more than 10 libraries,
38.85% of which are interface. Apart from that, about 90% of the
reusedsubcontractsaresourcedfromOpenZeppelin.Infact,around
36%ofourcollectedpackagesareextensionsofOpenZeppelin.This
alsosuggeststhegreatin/f_luenceofOpenZeppelininsmartcontract
development. While examining the rest 10% reused subcontracts
notrelatedtoOpenZeppelin,wediscoveredanothergroupofthird-
party packages that focus on the decentralized cryptocurrency
exchange,whichisnot coveredbyOpenZeppelin.
As smart contract development heavily relies on OpenZeppelin
packages,itincreasestheriskofasinglepointoffailureifOpenZep-
pelin’scodeorsystemswerecompromised.Infact,weidenti/f_ied
an existing dependency management problem regarding OpenZep-
pelin. While examining OpenZeppelin packages, we noticed an
iteration in the name of the packages from openzeppelin-solidity to
@openzeppelin/contracts .Bothpackagenamesarestillinuseincur-
rentdevelopment,thoughtheylinktothesamepackage.Moreover,
while@openzeppelin/contracts is the current oﬃcial name and has
been widely used, the name appearing in the package-lock.json /f_ile
generated byNPM is still openzeppelin-solidity . This may result in
amissinvulnerabilitydetectionsifthevulnerabilitydetectionis
conducted based on the package-lock.json /f_ile. Apart from that, the
prevalenceofOpenZeppelinindicatestheneedforwell-established
subcontracts to buildsecure andreliable smart contracts.
Finding7: OpenZeppelin [ 10] hasa greatin/f_luence onthird-
party subcontracts in smart contract development. Around
90%oftheimportedthird-partysubcontractsaresourcedfrom
OpenZeppelin,andaround36%ofouridenti/f_iedthird-party
packagesareextensionsofOpenZeppelin.Thiscouldberisky
if an OpenZeppelin-relatedvulnerabilityisreported.
3.6 DevelopmentPatterns (RQ4)
3.6.1 ExperimentsSetup. Inspiredbythe/f_indingsofcommonprac-
tices in smart contract development, we further examined the exis-
tenceofdevelopmentpatternsinourdatasetwithfrequentitem-
set(FP)mining[ 31],awell-establishedtechniqueindatamining.
Speci/f_ically,eachcontractisrepresentedbythepre-computedMD5
hashesofitssubcontracts,servingasFPmininginputtoidentify
subcontract setsthat frequently appear together.
Tovalidatetheobtainedsubcontractsets,amanualinspection
is conducted with three smart contract auditors. Each auditor /f_irst
803Demystifyingthe CompositionandCode Reuse in SoliditySmartContracts ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA
Table 5:Extracted development patterns
Rank PatternDetails Protocols Context Problem Solution FrequencyDay
Range
1IERC721Metadata, ERC165, IERC721Receiver, IERC721,
Strings,Address, ContextEIP721,
EIP165Token creationStandard token tobeowned and
tradedUsethe ERC721standard with the Metadataand
Receiver interfacesforrich metadataand secure
receivingfunctionality63,316
(13.72%)698 days
2IUniswapV2Router02, IUniswapV2Factory,IERC20,
Context, OwnableEIP20,
UniswapToken swap Need tocontrolownershipsUseUniswap V2’sinterfaceswith the Ownable
contract forpermissions62,855
(21.34%)699 days
3IERC721Enumerable,IERC721Metadata, ERC165,
IERC721Receiver,IERC721,Strings,Address, ContextEIP721,
EIP165Token creationNeed toenumerateall owned
tokensUsethe ERC721Enumerable extension toallowfor
token enumeration53,679
(8.84%)698 days
4IUniswapV2Pair,IUniswapV2Router02,
IUniswapV2Factory,IERC20,Context, OwnableEIP20,
UniswapToken swapNeedtointeractwithaspeci/f_icpair
of tokenswithownershipcontrolsUse Uniswap V2’s Pair and Factory interfaces with the
Ownable contract forpermissions14,869
(7.86%)694 days
5Address, SafeMath, IERC20,Context, Ownable EIP20 Token creationNeed forsafemath operationsand
ownershipcontrolsUse the SafeMath library for safe arithmetic operations
and the Ownable contract forpermissions14,012
(7.40%)699 days
6StorageSlot, Proxy,Address EIP1967 ProxycontractNeed toupgrade contracts with
storingthe currentstateUsethe Proxypatternalongwith StorageSlot for
preservingthe contract’s state during upgrades13,873
(7.33%)604 days
7ERC721Creator,StorageSlot, Proxy,Address EIP721 ProxycontractNeed toupgrade ERC721token
withstoringthe currentstateUseERC721Creatorforcreating tokensand the Proxy
patternwithStorageSlot forupgradability12,532
(6.62%)388 days
8ReentrancyGuard, IERC721Metadata, ERC165,
IERC721Receiver,IERC721,Strings,Address, ContextEIP721,
EIP165Token creation PreventreentrancyattackUsethe ReentrancyGuard contract toprevent
reentrancyattack8,579
(4.53%)684 days
9MerkleProof, IERC721Metadata, ERC165,
IERC721Receiver,IERC721,Address, ContextEIP721,
EIP165Token creation Need tocreate and validateproofsUsethe MerkleProof contract tocreate and validate
proofs4,806
(2.54%)645 days
independentlyevaluatesifthesesubcontractsetscanbeconsidered
as patterns. Disagreements are revisited via group discussion, and
auditors can alter their decision once post-discussion. We then
collate the results, identifying development patterns following the
rulethatthemajoritywins.Wefurthervalidatethepatternswith
frequencyanddaterange.Frequencyquanti/f_ies theappearanceof
apatternwhiledaterangerepresentsthetimespanfromthe/f_irst
to the last appearance of a pattern. These provide insights into the
prevalence andlongevity ofpatterns incontract development.
3.6.2 ResultsandDiscussion. We/f_inallyidenti/f_ied61development
patterns, 6ofwhichappeared over10,000 timesand anadditional
13 appeared more than 1,000 times in our dataset. The top 9 de-
velopment patterns are presented in Table 5while the full list of
identi/f_iedpatterns isavailable onour website [ 17].
Among the identi/f_ied patterns, over 63% are related to standard
tokencreation, speci/f_ically, 74%involvingERC721 tokens.For ex-
ample, the 3rd pattern is to create enumerable tokens, the 8th is to
preventreentrancyattacks[ 37],oneofthemostcommonattacksfor
smart contracts, and the 9th is to create and validate proofs. Other
patternsarerelatedtoproxycontractsandtokenswaps,accounting
for20.31%and10.94%respectively.Theappearanceofpatternssug-
gests that the creation of tokens, token swaps, and proxy contracts
havebeenhighlystandardized,re/f_lectingthecommonfunctional
requirements andarchitectural paradigmindevelopment.
Examples of contract addresses for each pattern can be found
on our website [ 17] to help understand the application of patterns
inreal-worlddevelopment.Forexample,thesecondpatternisto
facilitate theERC20 token swap via theUniswap V2 protocol[ 19].
Toutilizethispattern,anadditionalcustomizedsubcontractisoften
requiredtode/f_inetokendetails.AnexampleisshowninListing 1,in
which the token name, symbol, and other relevant information are
de/f_ined.Infact,thiscanbehandledbylow-codedevelopmenteasily.
Sincethiscustomizedsubcontractusuallyfollowsasimilarpattern,
user-extractedinformationcanbeintegratedintoatemplateand
mergedtogetherwiththe pre-de/f_inedpattern.
Additionally, we also conducted the same analysis in smart con-
tracts from Goerli Testnet. Apart from the already identi/f_ied de-
velopmentpatternsinEthereumMainnet,GoerliTestnetcontains
developmentpatternssourcedfromonlinetutorials.Forexample,[21] is a template for simple storage provided by an online course,
which appears over 800 times in our dataset. While using patterns
can improve code quality andmitigate potential vulnerabilities, it
iscrucial to ensure the safetyof the patterns.
1pragma solidity ^0.8.0;
2contract ThePathless isContext, IERC20, Ownable {
3 usingSafeMath foruint256;
4 string private constant _name = "The Pathless" ;
5 string private constant _symbol = "Pathless" ;
6 ......
7 constructor() {
8 _rOwned[_msgSender()] = _rTotal;
9 IUniswapV2Router02 _uniswapV2Router =
IUniswapV2Router02(0
x7a250d5630B4cF539739dF2C5dAcb4c659F2488D);
10 uniswapV2Router = _uniswapV2Router;
11 uniswapV2Pair = IUniswapV2Factory(_uniswapV2Router.
factory()).createPair( address (this),
_uniswapV2Router.WETH());
12 _isExcludedFromFee[owner()] = true;
13 _isExcludedFromFee[ address (this)] = true;
14 _isExcludedFromFee[_developmentAddress] = true;
15 _isExcludedFromFee[_marketingAddress] = true;
16 emitTransfer( address (0), _msgSender(), _tTotal);
17 }// main body
18}
Listing 1: An application example for Rank 2 pattern
inTable 5
During our inspections, the patterns we identi/f_ied are gener-
allysecuredsincemostsubcontractsarefromauditedthird-party
packages such as Openzeppelin [ 10] and Uniswap [ 19]. In addition,
most identi/f_ied patterns follow EIPs, which helpsto enhance their
security, interoperability, and compliance with community stan-
dards. However, the requirement of customization for many of the
patterns could potentiallyintroduce risksif not properly handled.
Finding 8: We identi/f_ied 61 development patterns. Speci/f_i-
cally, token creation, proxy contracts, and token swaps make
up 68.75%, 20.31%, and 10.34% of the identi/f_ied patterns, signi-
fyinghigh standardizationintheseareas.
4 IMPLICATIONSAND LESSONS
4.1 Result Summary
Unlikeexistingworksignoringthecommonpracticesofreusingex-
ternalsubcontracts,inthisstudy,weinvestigatecodereuseinsmart
contracts with considerations of dependency management. First,
804ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA KairanSun,ZhengziXu,ChengweiLiu, KaixuanLi, andYang Liu
we statistically con/f_irmed the high ratio of reusing external sub-
contracts(82.94%),aligningwithpreviousworks[ 33,35].However,
after investigating their introduction approaches, we notice that
31.22%ofsubcontracts were introducedby importsinstead ofsim-
ple code clones. Next, we divided subcontracts into self-developed
(17.06%)andexternalonesforfurthercodereuseanalysis.Forin-
stance,weobservetherelianceonfunctionreuseincreaseswhen
thenumberoffunctionsinself-developedsubcontractsgrows.In
addition,over35%oftheexternalsubcontractsare interface,indicat-
ingatrendtowardadheringtoestablishedstandardsandprotocols.
Yet,subcontracttypesaresometimesmisused,posingchallengesin
codemanagement.Moreover,OpenZeppelinin/f_luencesaround90%
oftheimportedexternalsubcontracts,highlightingitsprominent
role in contract development. Lastly, we identi/f_ied 61 development
patterns fortoken creation (68.75%), proxycontracts(20.31%), and
token swaps(10.34%), re/f_lecting areas withhigh standardization.
4.2 LessonsLearned
Inthissection,wesummarizethediscoveredchallengesinsmart
contract developmentandproposedpossible solutions.
ForContractDevelopers. ①Thoughvariousapproachesareavail-
able to introduce external subcontracts as discussed in Section 3.3,
we suggest avoiding usingURLs to import externalsubcontracts
unless the URL has been thoroughly veri/f_ied and audited for se-
curity development. This is to avoid introducing untrustworthy
codeblocks intocontracts due to maliciousURLs or compromised
subcontracts. ②As discussed in Section 3.3, over 80% subcontracts
are introduced externally in smart contracts. However, the docu-
mentation of such usage often misses, especially after on chains.
This brings challenges in the management of external subcontracts
andmorecritically,intheidenti/f_icationandmitigationofvulner-
abilities in external subcontracts. Hence, we would recommend
includingbasicinformationabouteachsubcontractsuchastheir
origins and versions if available in the published source code. This
practice would help with code maintenance and management of
dependency downstream. ③The inconsistent use of subcontract
types pointed out in Section 3.5may further complicate code orga-
nization and management instead, indicating a need for enhanced
standardizationincontract development.
For Third-party Auditors. ①Considering the high code reuse
ratio(82.94%)highlightedinSection 3.3,itmayhelptoboostthe
eﬃciencyofauditsbyestablishingastandardizedknowledge-based
vulnerabilitydatabase thatcan be accessed and contributed byev-
ery auditor, especially for frequently reused components. Once the
database is established,the relevant information for external com-
ponentscanbeidenti/f_iedbycodeclonedetection,avoidingrepeated
audits on the same components. ②Given the heavy reliance on
external subcontracts, especially those from well-established third
partiesasmentionedinSection 3.5,itisimportanttoregularlyaudit
thepackagestoensuretheirsecurityandreliability.Moreover,third-
party packages are not used as a whole in contract development,
instead, developers only import required subcontracts. Hence, it is
important to link identi/f_ied vulnerabilities to speci/f_ic subcontracts
or functions instead of packages. ③Though there are auditions
done with the published packages with speci/f_ic smart contract ap-
plications, we do not see any auditions with the frequently useddevelopment patterns as identi/f_ied in Section 3.6. However, it is
importanttocontinuouslymonitorandmanagesuchpatternsto
make sure safety,maintainability,andreliability.
FortheCommunity. Whilemostthird-partypackages areman-
agedunderNPMasdetailedinSection 3.3,itwouldbegoodtohave
aspecialized packagemanager forsmart contractdevelopment to
bettermanage the dependenciesofsmartcontractsduring develop-
ment and after deployment. Asa specialized package manager for
Soliditysmartcontracts,itwouldbegoodtohave: ①Automated
security analysis. The package manager should continuously ac-
cessthesecurityanduseofthethird-partypackages. ②Package
versioning. The package manager should have a robust versioning
system to keep track of the updates and changes in smart contract
packages. ③Easyintegration.Thepackagemanagershouldbeeasy
to integrate with popular development tools and environments to
make smart contract development smoother. ④Package deploy-
ment.Thepackagemanagerisexpectedtocontinuouslymonitor
andmanagetheusedthird-partysubcontractsevenafterdeploy-
ment.Additionally,consideringthedominanceofOpenZeppelin
packages identi/f_ied in Section 3.5, it would be bene/f_icial to encour-
ageandsupportthedevelopmentofalternativeandsecurepackages
to providemore optionsfor smart contract developers.
4.3 FutureResearch Directions
Our /f_indings suggest several directions for future research. First,
theprevalentcodereuseinsmartcontractsnecessitatesstudying
vulnerabilityspreadacrosschainsandtheeﬃciencyofcountermea-
sures. There is potential in developing detectors for clone-based
vulnerabilitiestoauto-patchriskyandemployingbinarycodeclone
detectiontoimprovevulnerabilityidenti/f_ication.Second,extending
our analysis to include type-3 clones could provide deeper insights
intodiverseimplementationsofidenticalfunctionalities.Theusage
scenarios for various implementations could be further studied.
In addition, our analysis can be extended by including multiple
blockchain networks (e.g., BNB Chain [ 24] and Polygon [ 22]). This
will enhance our understanding of contract characteristics and
cross-chain interactions, enriching our grasp on the broader smart
contractecosystem.Lastly,withthedevelopmentpatternsprovided
in Section 3.6, their eﬀects on contract robustness and risks and
theevolutionofthepatternscouldbefurtherinvestigated.More-
over,investigatingfunctional-levelpatternscouldoﬀerinsightsinto
subcontract versionsandboost low-code development/f_lexibility.
4.4 Threatsto Validity
4.4.1 Internal Validity. The choice of type-2 clones may lead to
falsesimilaritiesinclonedetection.Inthisstudy,wechosetofocus
on type-2 clones because they oﬀer a balance between the rigor of
detection andtherichness ofinsight.For example,our duplicated
contractanalysisinSection 3.3canbeeﬀectivelydonewithtype-
2 clones, but unattainable with type-1 clones. However, we also
acknowledgetheriskofidentifyingfalsesimilaritieswithtype-2
clones due to the renaming of variable names. To mitigate this, we
have reconducted experiments with type-1 clone detection as a
baselineandthe result proves that our initial/f_indingsstillhold.
4.4.2 External Validity. A potential threat is related to the rep-
resentativeness of the dataset. Collecting the source code of all
805Demystifyingthe CompositionandCode Reuse in SoliditySmartContracts ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA
deployedcontractsischallengingduetothefrequentlackofpublic
releaseandthenumerousexistingblockchainnetworks.Tomiti-
gatethis,weexpandourdatasetbycollectingcontractsfromtwo
diﬀerentEthereum networks(i.e., theMainnet and Goerli Testnet)
andidenti/f_iedthird-partypackages.
4.4.3 Construct Validity. The identi/f_ied patterns in Section 3.6
might be in/f_luenced by our subjective interpretations. We miti-
gate this with a rigorous inspection process involving three smart
contract auditors andgroup discussionsfor cross-veri/f_ication. We
then revalidate the results using frequency and date rangeto mea-
suretheprevalenceandlongevityofidenti/f_iedpatterns.Through
these veri/f_ications, we ensure that these development patterns are
prevalent and can be applied in real-world applications. Similar
inspections are also conducted during duplicated contract analysis
inSection 3.3. The result is further veri/f_iedwith the informationof
creators from source code and Etherscan [ 7]. The records for both
manual inspections are available onour website [ 17].
5 RELATED WORK
EmpiricalStudiesonSmart Contracts. Severalempiricalstud-
ies on code reuse in smart contracts have been done in the past
few years with focuses on the characteristics [ 33,35] and im-
pacts [28,41] of clones. Kondo et al. [ 35] reported that 79.2% of
the subcontracts are type-1 and type-2 clones in Ethereum with
atree-basedclonedetectorcalledDeckard[ 32].WhileKhan[ 33]
further extended Kondo’s study to the granularity of functions and
type-3 clones. Their result indicated a 30.13% overall clone ratio at
the function level, out of which about 90% belong to type-1 clones.
Chenetal.[ 28]studiedtheimpactsofcodereuseinsmartcontracts
andidenti/f_iedthecommonrevisionstoreuseexternalsubcontracts.
Pierroetal.[ 41]classi/f_iedtheclonesinsmartcontractdevelopment
and proposed some possible explanations for trends of clones in
the view of smart contract developers. While previous studies con-
cludedahighcloneratioinsmartcontracts,theyoverlookedthat
many external subcontracts are directly imported but published
together with the source code. In contrast, we take the introduc-
tion approaches into consideration during analysis. This allows
us to better comprehend the existing regulations to use external
components and uncover that over 20% of the clones are imported.
Additionally,thereareafewstudiesdiscussingthecurrentsmart
contract development from various aspects. Zou et al. [ 51] summa-
rizedthemajorchallengesfordevelopersinsmartcontractdevelop-
mentanddiscussedthepossibledirectionstoimprovethequality
of current smart contract development. Chen et al. [ 27] studied
the maintenance-related concerns for deployed smart contracts
and discussed how to maintain smart contract-based projects from
developers’ views. Several studies have been to discuss the con-
cernsinsmartcontractdevelopmentsuchassecurity[ 26,43,45],
and maintenance [ 44]. However, these studies only focused on a
singlegranularity(i.e.,eithersubcontractsorfunctions),thereby
leaving the composition of smart contracts under-explored. Our
study bridges this gap by providing a detailed understanding of
smartcontractcompositionandconductingcodereuseformultiple
granularities (i.e. contract, subcontract, and function). For each
levelofgranularity,wemanagetodiscoversomecommonpractices
incode reuse andfunctional requirements.DevelopmentPatternsinSmartContractDevelopment. Afew
studiesrelatedtotheexistingdevelopmentpatternshavebeendone
in recent years. Marino and Juels [ 38] proposed design patterns for
alteringandundoingsmartcontracts.BartolettiandPompianu[ 25]
manuallycheckedthesourcecodeof811veri/f_iedsmartcontracts
from Etherescan, through which they summarized the purposes
ofsmartcontracts(e.g./f_inancial,wallet,etc.)andexistingdesign
patterns including token,authorization,andoracle. Similar design
patternswerealsodiscussedinWorley’swork[ 47].Olivaetal.[ 40]
investigated the activity level of contracts and summarized the
mainusageofsmartcontracts.Wohreretal.[ 46]elaboratedseveral
common security patternsand describedsolutions to typical attack
scenarios. Zheng et al. [ 49] summarized the whole life cycle of
smartcontractdevelopment,includingcontractcreation,deploy-
ment,execution,andcompletion.Moreover,theyalsodiscussedthe
challenges in the current development cycle and the diﬀerence be-
tweensmartcontractplatformsincludingEthereum.Anotherwork
from Zheng [ 50] described the architecture of blockchain and con-
sensus algorithms and introduced the development of applications
based on blockchain. Mohanta et al. [ 39] summarized seven use
cases for smart contracts, including IoT, supply chain management,
and healthcare systems. Despite these contributions, previous stud-
ies failed to provide concrete development patterns but focused on
the general steps for various functional requirements. In our study,
we extract development patterns as sets of subcontracts that could
bepotentiallyusedforlow-codedevelopments.Thisalsore/f_lects
the areas with high standardization in smart contract development.
6 CONCLUSION
This study discusses code reuse in Solidity smart contracts from
theviewofcontractdecompositiononEthereumblockchains.To
understand the compositions of contracts, we /f_irst quanti/f_ied three
common approaches to introduce subcontracts, through which we
alsocompiledalistofcommonlyusedthird-partypackagesinsmart
contract development. We then conducted separate code reuse
analysesforself-developedandexternalsubcontractstodissectthe
most frequently reused code blocks and their functional properties.
Togaininsightsintocommonpracticesincontractdevelopment,
wealsoextracted61frequentlyreuseddevelopmentpatterns.Lastly,
wediscussedthecurrentchallengesinmanagingsmartcontracts
andproposedpossible solutions.
7 DATA AVAILABILITY
The detailed analysis results that support the /f_indings of this study
are available in[ 17].
ACKNOWLEDGEMENT
This research is supported by the National Research Foundation,
Singapore,andtheCyberSecurityAgencyunderitsNationalCyber-
securityR&DProgramme(NCRP25-P04-TAICeN).Anyopinions,
/f_indings,andconclusions,orrecommendationsexpressedinthis
materialarethoseoftheauthor(s)anddonotre/f_lecttheviewsof
theNationalResearchFoundation,SingaporeandCyberSecurity
Agency ofSingapore.
806ESEC/FSE ’23, December3–9, 2023,San Francisco, CA, USA KairanSun,ZhengziXu,ChengweiLiu, KaixuanLi, andYang Liu
REFERENCES
[1] 2022. https://github.com/ethereum/solidity .
[2] 2022. https://github.com/ .
[3] 2022. https://docs.ipfs.tech/concepts/ipfs-gateway/ .
[4] 2022. https://gateway.ethswarm.org/ .
[5] 2022. https://remix-ide.readthedocs.io/en/latest/import.html .
[6]2022. ANTLR v4. https://github.com/antlr/antlr4 original-date: 2010-02-
04T01:36:28Z.
[7] 2022. Ethereum(ETH)BlockchainExplorer. http://etherscan.io/ .
[8]2022. EthereumImprovementProposals(EIPs). https://github.com/ethereum/
EIPsoriginal-date:2015-10-26T13:57:23Z.
[9] 2022. npm. https://www.npmjs.com/
[10]2022. OpenZeppelin/openzeppelin-contracts. https://github.com/OpenZeppelin/
openzeppelin-contracts original-date:2016-08-01T20:54:54Z.
[11]2023. anyswap/multichain-smart-contracts:multichainsmartcontracts. https:
//github.com/anyswap/multichain-smart-contracts . (Accessed on01/23/2023).
[12]2023. Contracts—Solidity0.8.17documentation. https://docs.soliditylang.org/
en/v0.8.17/contracts.html . (Accessed on01/29/2023).
[13]2023. EIPs/eip-20.mdatmaster ·ethereum/EIPs. https://github.com/ethereum/
EIPs/blob/master/EIPS/eip-20.md . (Accessed on01/31/2023).
[14]2023. EXPLAINED:THEMULTICHAINHACK(JANUARY2022). https://halborn.
com/explained-the-multichain-hack-january-2022/ . (Accessed on01/23/2023).
[15]2023. goerli.etherscan.io. https://goerli.etherscan.io/ . (Accessed on01/23/2023).
[16]2023. Hardhat | Ethereum development environment for professionals by Nomic
Foundation. https://hardhat.org/ . (Accessed on01/27/2023).
[17]2023. Home. https://sites.google.com/view/solidity-contract-analysis/home .
(Accessed on02/02/2023).
[18]2023. Home | ethereum.org. https://ethereum.org/en/ . (Accessed on 01/20/2023).
[19]2023. Home | Uniswap Protocol. https://uniswap.org/ . (Accessed on 01/27/2023).
[20]2023. manifoldxyz/creator-core-solidity. https://github.com/manifoldxyz/creator-
core-solidity . (Accessed on06/11/2023).
[21]2023. PatrickAlphaC/storage-factory-fcc. https://github.com/PatrickAlphaC/
storage-factory-fcc . (Accessed on02/01/2023).
[22]2023. polygon.technology. https://polygon.technology/ . (Accessed on
06/25/2023).
[23]2023. Smart contract - Wikipedia. https://en.wikipedia.org/wiki/Smart_contract .
(Accessed on01/24/2023).
[24]2023. www.bnbchain.org. https://www.bnbchain.org/ . (Accessed on 06/25/2023).
[25]MassimoBartolettiandLivioPompianu.2017. AnEmpiricalAnalysisofSmart
Contracts:Platforms,Applications,andDesignPatterns. LectureNotesinCom-
puterScience (03 2017). https://doi.org/10.1007/978-3-319-70278-0_31
[26]LexiBrent,NevilleGrech,Si/f_isLagouvardos,BernhardScholz,andYannisSmarag-
dakis.2020. Ethainter:asmartcontractsecurityanalyzerforcompositevulner-
abilities. In Proceedings of the 41st ACM SIGPLAN Conference on Programming
Language Designand Implementation . 454–469.
[27]Jiachi Chen, Xin Xia, David Lo, John Grundy, and Xiaohu Yang. 2021.
Maintenance-related concerns for post-deployed Ethereum smart contract devel-
opment:issues,techniques,andfuturechallenges. EmpiricalSoftwareEngineering
26,6 (2021), 1–44.
[28]XiangpingChen,PeiyongLiao,YixinZhang,YuanHuang,andZibinZheng.2021.
UnderstandingCodeReuseinSmartContracts.470–479. https://doi.org/10.1109/
SANER50967.2021.00050
[29]W. G. Cochran. 1934. The distribution of quadratic forms in a normal system,
with applicationsto the analysis of covariance. MathematicalProceedings of the
CambridgePhilosophicalSociety 30,2(1934),178–191. https://doi.org/10.1017/
S0305004100016595
[30]TokenGenerator.2023. TokenGenerator|CreateERC20orBEP20Token|Smart-
Contracts Tools. https://www.smartcontracts.tools/token-generator/ . (Accessed
on02/03/2023).
[31]Jiawei Han, Hong Cheng, Dong Xin, and Xifeng Yan. 2007. Frequent pattern
mining:currentstatusandfuturedirections. Dataminingandknowledgediscovery
15,1 (2007), 55–86.
[32]LingxiaoJiang,GhassanMisherghi,ZhendongSu,andStephaneGlondu.2007.
Deckard: Scalable and accurate tree-based detection of code clones. In 29th
International Conference on Software Engineering(ICSE’07) . IEEE, 96–105. https:
//doi.org/10.1109/ICSE.2007.30
[33]Faizan Khan, Istvan David, Daniel Varro, and Shane McIntosh. 2022. Code
Cloning in Smart Contracts on the Ethereum Platform: An Extended ReplicationStudy.IEEE Transactions on Software Engineering (2022), 1–13. https://doi.org/
10.1109/TSE.2022.3207428 Conference Name: IEEE Transactions on Software
Engineering.
[34]Shafaq Naheed Khan, Faiza Loukil, Chirine Ghedira-Guegan, Elhadj Benkhelifa,
andAnoudBani-Hani.2021.Blockchainsmartcontracts:Applications,challenges,
andfuturetrends. Peer-to-peerNetworkingandApplications 14,5(2021),2901–
2925.
[35]MasanariKondo,GustavoA.Oliva,ZhenMing(Jack)Jiang,AhmedE.Hassan,and
Osamu Mizuno. 2020. Code cloning in smart contracts: a case study on veri/f_ied
contractsfromtheEthereumblockchainplatform. EmpiricalSoftwareEngineering
25,6 (Nov. 2020),4617–4675. https://doi.org/10.1007/s10664-020-09852-5
[36]Paul Levy. 2014. Finite Population Correction .https://doi.org/10.1002/
9781118445112.stat05700
[37]ChaoLiu,HanLiu,ZhaoCao,ZhongChen,BangdaoChen,andBillRoscoe.2018.
ReGuard: Finding Reentrancy Bugs in Smart Contracts. In Proceedings of the
40thInternationalConferenceonSoftwareEngineering:CompanionProceeedings
(Gothenburg,Sweden) (ICSE’18) .AssociationforComputingMachinery,New
York, NY, USA,65–68. https://doi.org/10.1145/3183440.3183495
[38]BillMarinoandAriJuels.2016. SettingStandardsforAlteringandUndoingSmart
Contracts, Vol. 9718.151–166. https://doi.org/10.1007/978-3-319-42019-6_10
[39]Bhabendu Kumar Mohanta, Soumyashree S Panda, and Debasish Jena. 2018.
An Overview of Smart Contract and Use Cases in Blockchain Technology. In
2018 9th International Conference on Computing, Communication and Networking
Technologies(ICCCNT) . 1–4.https://doi.org/10.1109/ICCCNT.2018.8494045
[40]GustavoA.Oliva,AhmedE.Hassan,andZhenMing(Jack)Jiang.2020. Anex-
ploratorystudyofsmartcontractsintheEthereumblockchainplatform. Empirical
SoftwareEngineering 25,3(May2020),1864–1904. https://doi.org/10.1007/s10664-
019-09796-5 Company:SpringerDistributor:SpringerInstitution:SpringerLabel:
SpringerNumber:3 Publisher: SpringerUS.
[41]Giuseppe Antonio Pierro and Roberto Tonelli. 2021. Analysis of Source Code
Duplication in Ethreum Smart Contracts. 701–707. https://doi.org/10.1109/
SANER50967.2021.00089
[42]ChanchalRoyandJamesCordy.2007. ASurveyonSoftwareCloneDetection
Research. SchoolofComputingTR 2007-541 (Jan. 2007).
[43]AmritrajSingh,RezaMeimandiParizi,QiZhang,Kim-KwangRaymondChoo,
and Ali Dehghantanha. 2020. Blockchain smart contracts formalization: Ap-
proaches and challengesto address vulnerabilities. Comput. Secur. 88(2020).
[44]AnnaVacca,AndreaDiSorbo,CorradoAVisaggio,andGerardoCanfora.2021.
Asystematic literaturereviewofblockchainandsmart contractdevelopment:
Techniques, tools, and open challenges. Journal of Systems and Software 174
(2021), 110891.
[45]ZhiyuanWan,XinXia,DavidLo,JiachiChen,XiapuLuo,andXiaohuYang.2021.
Smart contract security: A practitioners’ perspective. In 2021 IEEE/ACM 43rd
InternationalConference onSoftwareEngineering (ICSE) . IEEE,1410–1422.
[46]MaximilianWohrerandUweZdun.2018.Smartcontracts:securitypatternsinthe
ethereumecosystemandsolidity.In 2018InternationalWorkshoponBlockchain
OrientedSoftwareEngineering (IWBOSE) . IEEE,2–8.
[47]Carl R. Worley and Anthony Skjellum. 2018. Opportunities, Challenges, and
FutureExtensionsforSmart-ContractDesignPatterns.In BusinessInformation
Systems.
[48]JiahuiWu,ZhengziXu,WeiTang,LyuyeZhang,YuemingWu,ChengyueLiu,
KairanSun,LidaZhao,andYangLiu.2023. OSSFP:PreciseandScalableC/C++
Third-PartyLibraryDetectionusingFingerprintingFunctions.In 2023IEEE/ACM
45th International Conference on Software Engineering (ICSE) . 270–282. https:
//doi.org/10.1109/ICSE48619.2023.00034
[49]Zibin Zheng, Shaoan Xie, Hong-Ning Dai, Weili Chen, Xiangping Chen, Jian
Weng,andMuhammadImran.2020. Anoverviewonsmartcontracts:Challenges,
advancesandplatforms. FutureGenerationComputerSystems 105(2020),475–491.
[50]Zibin Zheng, Shaoan Xie, Hong-Ning Dai, Xiangping Chen, and Huaimin Wang.
2018. Blockchainchallengesandopportunities:Asurvey. InternationalJournal
ofWebandGridServices 14(102018),352. https://doi.org/10.1504/IJWGS.2018.
095647
[51]Weiqin Zou, David Lo, Pavneet Singh Kochhar, Xuan-Bach Dinh Le, Xin Xia,
YangFeng,ZhenyuChen,andBaowenXu.2019. Smartcontractdevelopment:
Challengesand opportunities. IEEETransactions onSoftwareEngineering 47,10
(2019), 2084–2106.
Received 2023-02-02; accepted 2023-07-27
807