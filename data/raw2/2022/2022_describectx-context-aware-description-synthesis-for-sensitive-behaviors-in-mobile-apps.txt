DescribeCtx: Context-Aware Description Synthesis for Sensitive
Behaviors in Mobile Apps
Shao Yang1Yuehan Wang2Yuan Yao3Haoyu Wang4Yanfang (Fanny) Ye5Xusheng Xiao1
1Case Western Reserve University,2University of Illinois at Urbana-Champaign
3State Key Laboratory for Novel Software Technology, Nanjing University
4Beijing University of Posts and Telecommunications,5University of Notre Dame
1{sxy599,xusheng.xiao}@case.edu,2yuehanw2@illinois.edu,3y.yao@nju.edu.cn,4haoyuwang@bupt.edu.cn,5yye7@nd.edu
ABSTRACT
While mobile applications (i.e., apps) are becoming capable of han-
dling various needs from users, their increasing access to sensitive
data raises privacy concerns. To inform such sensitive behaviors
tousers,existingtechniquesproposetoautomaticallyidentifyex-
planatorysentencesfromappdescriptions;however,manysensitive
behaviors are not explained in the corresponding app descriptions.
Therealsoexistgeneraltechniquesthattranslatecodetosentences.
However, these techniques lack the vocabulary to explain the uses
of sensitive data and fail to consider the context (i.e., the app func-
tionalities) of the sensitive behaviors. To address these limitations,
weproposeDescribeCtx,acontext-awaredescriptionsynthesis
approach that trains a neural machine translation model using a
largesetofpopularapps,andgeneratesapp-specificdescriptions
for sensitive behaviors. Specifically, DescribeCtx encodes three
heterogeneous sources as input, i.e., vocabularies provided by pri-
vacypolicies,behaviorsummaryprovidedbythe callgraphs incode,
and contextual information provided by GUI texts. Our evaluations
on1,262Androidappsshowthat,comparedwithexistingbaselines,
DescribeCtxproducesmoreaccuratedescriptions(24 .96inğµğ¿ğ¸ğ‘ˆ)
and achieves higher user ratings with respect to the reference sen-
tences manually identified in the app descriptions.
CCS CONCEPTS
â€¢Theoryofcomputation â†’Programanalysis ;â€¢Securityand
privacyâ†’Software security engineering.
KEYWORDS
mobile apps; description synthesis; static analysis; deep learning
ACM Reference Format:
Shao Yang, Yuehan Wang, Yuan Yao, Haoyu Wang, Yanfang (Fanny) Ye,
XushengXiao.2022.DescribeCtx:Context-AwareDescriptionSynthesisfor
SensitiveBehaviors inMobileApps. In Proceedingsofthe 44thIEEE/ACM
International Conference onSoftware Engineering (ICSEâ€™22), May 22â€“27, 2022,
Pittsburgh,USA. ACM,NewYork,NY,USA,13pages.https://doi.org/10.1145/-
3510003.3510058
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACMmustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSE â€™22, May 22â€“27, 2022, Pittsburgh, PA, USA
Â© 2022 Association for Computing Machinery.
ACM ISBN 978-1-4503-9221-1/22/05...$15.00
https://doi.org/10.1145/3510003.3510058
(a) GIF camera
 (b) Auto SMS
Figure 1: Example appsâ€™ GUIs: (a) permission request; (b)
GUI context for SMS and microphone permissions.
1 INTRODUCTION
Mobileapplications(i.e.,apps)arebecomingcapableofhandling
nearlyallkindsofneedsfromusers[ 63].However,certainbehaviors
ofappsare lessdesirableoreven harmful[ 28,35,44,60,86],such
as disclosing usersâ€™ location in the background [ 22,44,61,86].
Mainstreamsmartphoneplatforms(i.e.,AndroidandiOS)require
users to grant permissions for permission requests at run time [ 36,
55] (Figure 1(a)). However, as shown in research studies [ 23,45,74,
75],mostappsprovideonlyinformationabout whatpermissions
theyrequest,ratherthan howandwhy theywillusethepermission-
protected data, causing users to make uninformed decisions on
their privacy.
Recognizingtheselimitations,existingresearchefforts[ 56,59]
havebeenmadetoprovidedescriptionsbyidentifyingsentences
in app descriptions. App descriptions describe appsâ€™ functionalities
and features, and may include sentences that provide justifications
for certain permissions. However, as most app descriptions or pri-
vacy policies do not explain everysensitive behavior of the app,
these methods can only provide descriptions for a small subset
of sensitivebehaviors.Our empiricalstudy on1,292 popularapps
from Google Play [ 27] shows that only 37 .37% permission uses are
explainedinappdescriptions.Forexample,â€œWishâ€isanuprising
shoppingappwithmorethan500Mdownloads.Itrequestsmulti-
pledangerouspermissions(suchas LOCATION,STORAGE,CONTACTS,and
6852022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. CAMERA) without providing any information regarding how these
dangerous permissions will be used in the app description.
Alternatively, there exist techniques [ 33,40,46,62,82] that gen-
erate comments for code, or translate permission-protected API
callsbasedonapre-defineddescriptionmodel.Unfortunately,these
techniquesmainlygeneratefunctionalitydescriptionsbyutilizing
the words in comments and identifiers, and lack the vocabulary to
explain the uses of sensitive data. More importantly, these tech-
niquesfailtoconsiderthe contextofsensitivebehaviors,i.e.,what
functionality justify the appsâ€™ sensitive behaviors (e.g., car navi-
gation justifying the use of gps locations), making the generated
sentences less accurate and informative.
In this paper, we propose a context-aware description syn-
thesis approach, DescribeCtx, to generate app-specific de-scriptionsforsensitivebehaviors
.Specifically,inspiredbythe
recent advances of neural machine translation [ 12,16,50,66], De-
scribeCtxtrainsasequence-to-sequence(seq2seq)modelbyusingtheappsâ€™codeandcontextualfeaturesextractedfromalargesetofpopularapps. Thesynthesizeddescriptionscanbeusedtodirectlyim-
prove the descriptions shown in permission requests (e.g., the promptsforrequestingpermissions),orassistdevelopersinwritingcustomized
messages for explaining the permission requests, helping promote
better security practices in mobile apps.
Due to the unique characteristics of mobile apps, there are three
majorchallengestotrainDescribeCtx: xidentifyingtherepresen-
tative features for the sensitive behaviors in the code and the appsâ€™
contextualinformation, ybuildingthevocabularyfordescribing
thesensitivebehaviors,and zextractingthereferencesentences
tosupervisethemodellearning.Toaddressthesechallenges,De-
scribeCtx is built upon the following key insights:
â€¢Representation of sensitive behaviors : sensitive behaviors are trig-
gered by permission-protected API calls. Call graphs that lead to
permission-protectedAPIcalls,referredtoas permission-protected-
API call graph (PACG), have been shown to be effective in rep-
resenting the contexts of sensitive behaviors for detecting un-
desired behaviors [ 20,78,82,83]. Thus, the PACG of a sensitive
behavior provides a representative summary of the sensitive
behaviorâ€™s context in the code.
â€¢Representationofcontextualinformation :anappâ€™sGUIincludes
thecontextualinformationthatdescribestheappâ€™sfunctional-
ity and justifies the uses of certain permissions. As shown in
Figure1(b),theGUIprovidesthecontextualinformationofthe
appsâ€™functionalityforsendingSMSs,andwecaninferthatthe
intention of the â€œAuto Replyâ€ button is to reply SMSs. Thus, the
text in the GUI where a sensitive behavior is triggered providesthe contextual information for the sensitive behavior.
â€¢
Vocabularies for sensitive behaviors : as shown in existing stud-
ies[14,59,69],privacypoliciescontaininformationsuchaswhat
kind of data will be collected and what permissions are required
inthisapp.Thus,privacypoliciescanprovidethevocabularyfor
the appsâ€™ sensitive behaviors.
â€¢Referencesentencesforsensitivebehaviors :inordertoassessthe
quality of the synthesized descriptions during both training and
testing stages, we need high-quality reference sentences thatdescribe sensitive behaviors in apps. As indicated by recent stud-
ies [56,59], app descriptions contain sentences that explain per-
mission uses. Since these descriptions are provided by the app
developers who own the appsâ€™ code and are mainly used to pro-
motetheapps,theyaremoreconciseandeasyfortheusersto
understand.Thus,thesentencesthatdescribesensitivedatauses
in app descriptions can be used as the reference sentences for
sensitive behaviors.
Based on these key insights, DescribeCtx represents the fea-
turesofappsâ€™PACGs,GUItexts,andprivacypoliciesasthesources
and the reference sentences in app descriptions as the targets, and
learns the conversionfrom the sources to thetarget. Furthermore,
appsmaylackpermissiondescriptionsforsensitivebehaviorsin
theirprivacypolicies.Asshowninexistingwork[ 13,23,68]and
our empirical results in Section 5.2, most apps use permissions
forsimilarpurposes,andthusDescribeCtxborrowstherelevant
permission descriptions from the training apps for these apps.
WeevaluateDescribeCtxusingpopularAndroidappsdown-
loadedfromGooglePlay.1Withinouraffordableeffort,weexamine
8,814appsintotal,andthencurateanevaluationdatasetconsistingof1,292popularAndroidappsamongthem(20
.86ğºğµ,16.93ğ‘€ğµon
average). All of these apps contain permission descriptions in pri-
vacy policies and reference sentences of sensitive behaviors in app
descriptions, so that DescribeCtx can use the permission descrip-
tions to train the seq2seq model and use the reference sentences to
evaluateDescribeCtx.Wemeasuretheperformanceusingboth
standardmetricsinmachinetranslation( ğµğ¿ğ¸ğ‘ˆ[57]andğ‘…ğ‘‚ğ‘ˆğºğ¸-
ğ¿[42]) and user studies.
The results show that DescribeCtx achieves ğµğ¿ğ¸ğ‘ˆscore 24.47
whenappsâ€™ownprivacypoliciesaremissingand ğµğ¿ğ¸ğ‘ˆscore25.75
when they are available, which is at least 15 .31% better than the
state-of-the-art description synthesis approaches: Code2Vec [ 4,5]
andDescribeMe[ 82].Furthermore,theuserstudyresultsshowthat
onaverage,DescribeCtxachieveshigherratingsforsyntactical
correctnessandsemanticclosenessthanthebaselines,withrelative
improvements over 5 .13% and 9.91%, respectively. These results in-
dicatethatasmostpermissionsareusedforsimilarpurposes,evenifappsdonotprovidedescriptionsinprivacypolicies,
theguidance
ofbehaviorrepresentation,GUIcontextualtext,andtherel-evant permission descriptions of other appsâ€™ privacy poli-cies can be leveraged to synthesize accurate descriptions.
Insummary,thepapermakesthefollowingmajorcontributions:
â€¢A novel approach, DescribeCtx, that synthesizes natural lan-
guage descriptions for sensitive behaviors in apps.
â€¢AnovelsetoftechniquesthatextractfeaturesfromGUIs,privacy
policies, and PACGs of apps and a novel model that combines
these features to synthesize descriptions for sensitive behaviors.
â€¢An evaluation on 1,292 apps that demonstrates the effectiveness
of DescribeCtx and the improvement over the state-of-the-art.
â€¢A prototype implementation of DescribeCtx and the results
that are both publicly available [2].
1We focus on Android apps due to its market dominance [ 63] and open source ecosys-
tem, but the general idea is applicable to other smartphone platforms such as iOS.
686
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. onCreate()
setContentView()
getLastKnownLocation()getBestProvider() ......
...
PACG
Permission DescriptionGUI Layout Files
... we may use GPS to
determine your location ...Sensitive Behavior
Description
SynthesisReference Sentence
find your current location  to
get weather based on
your location  and gps...
<TextViewn1:text_size="18.0sp"...n1:text="@string/weather_wait_for_location" />
...
This clock weather app displays
weather temperature based on
your current location
Figure 2: Motivating example of DescribeCtx.
2 BACKGROUND
2.1 App Descriptions and Privacy Policies
An app description is a short summary that describes the appâ€™s
functionality,justifyingthesensitivedataitwillneed.Forexample,
the â€œFacebookâ€ app declares that its functionality include â€œshare
photos,videos,andyourfavoritememories,findlocalsocialevents,
andmakeplanstomeetupwithfriendsâ€,andâ€œbackupphotosby
savingtheminalbumsâ€.Thisimpliesthatusershavetoprovidethe
app with the corresponding permissions to access the camera, the
location data, and the storage. A privacy policy is legally required
by Google Play. In mostcases, a privacy policy should specify the
data being collected and the user rights. Additionally, if the app
usesanypermissioninthefollowingdangerouspermissiongroups,
i.e.CALENDAR,CONTACTS,LOCATION,CAMERA,SMS,STORAGE,PHONE,MICROPHONE ,
thedevelopershavetodisclosetheuseofthepermissionbecause
these permission groups collect personal sensitive data from the
app users.
2.2 Attentive Seq2seq Model
Fromaprobabilisticperspective,translationfromagivensourcesentence
ğ‘¥=(ğ‘¥1,...ğ‘¥ ğ‘›)to a target sentence ğ‘¦=(ğ‘¦1,...ğ‘¦ğ‘›),i s
equivalent to finding the maximum conditional probability, i.e.
ğ‘ğ‘Ÿğ‘”ğ‘šğ‘ğ‘¥ ğ‘¦ğ‘(ğ‘¦|ğ‘¥). In neural machine translation, a parameterized
model, such as seq2seq [ 64], is trained to maximize the conditional
probabilityofsentencepairs.Atypicalseq2seqmodelhastwore-
currentneuralnetworks(RNNs)[ 25].OneRNN(encoder)isused
to transform source natural language sequences into vector rep-resentations. The other RNN (decoder) is used to transform the
vectorrepresentationstothetargetnaturallanguagesequences.As
thelengthofinputsequencegrows,Choetal.[ 15]showthatthe
performanceoftraditionalseq2seqarchitecturedeterioratesdras-
tically. In order to address this issue, Bahdanau et al. [ 12] extend
the typical seq2seq model with attention mechanism, where the
attentive seq2seq adaptively learns the weights of each input word
at the decoding stage.3 MOTIVATION EXAMPLE
Figure 2 shows how DescribeCtx extracts features and synthe-sizes the description for the sensitive behavior triggered by the
permission-protected API getLastKnownLocation , whichrequires the
permission ACCESS_COARSE_LOCATION . This example is simplified from
theappâ€œmobi.infolife.ezweather.widget.liveweather_forcastâ€. De-
scribeCtxextractsthreetypesoffeaturesfromtheapp.Thefirst
feature is the text in the GUIs, referred to as GUI contextual text,
which provides rich information to inform users about the appsâ€™
purposes and expected functionalities [ 7,34,51,76]. The second
feature is the text in the PACG, which is a call graph that leads
to the permission-protected API getLastKnownLocation , and contains
not only direct method calls, but also edges representing Inter-
ComponentCommunications(ICC)[ 41,53,54,85],lifecyclemethod
calls[9,70],andmultithreadingmethodcalls[ 81].Thethirdfeature
isthepermissiondescriptionof LOCATIONinitsprivacypolicy(i.e.,
â€œ...we may use GPS to determine your location ...â€).
Thesethreetypesoffeaturesformthreeheterogeneousinputse-
quences,andarefedintoDescribeCtxâ€™ssynthesismodel,whichistrainedusingpopularappsinGooglePlay.AsshowninFigure2,the
synthesizeddescriptionisquitesimilartothereferencesentence,
achievinga ğµğ¿ğ¸ğ‘ˆscoreof46 .06.Thecoloredlinesshowhowthe
threetypes offeatures contributeto thewords inthesynthesized
description. If DescribeCtx discards GUI contextual text from the
modelandretrainsthemodel,thesynthesizeddescription(i.e.,â€œthe
app can use your location and gpsâ€) will lose some important app-
specificinformation(i.e.,weather).Infact,wehaveconductedan
empiricalstudyon1,262appstomeasurethe worduniqueness ofthe
GUI contextual text, and the results show that GUI contextual text
can provide 10 .46% unique words for the synthesized descriptions.
Furthermore, if DescribeCtx further discards both GUI contex-tual text and PACG from the model, the synthesized descriptionbecomes very short and general (i.e., â€œaccess location and gpsâ€).
Thisdemonstratestheimportantrolesplayedbyprivacypolices,
GUI contextual texts, and PACGs in DescribeCtx.
4 APPROACH
4.1 Overview
Figure3showstheoverviewof DescribeCtx.DescribeCtxcon-
sists of two phases: training phase and prediction phase. The train-
ing phase has two major steps: (1) feature extraction and (2) sensi-
tivebehavior-descriptionlearning.Inthefeatureextractionstep,
DescribeCtx acceptsthe APKfiles andprivacypolicies oftrain-ing apps as input, and extracts three text sequences (i.e., PACGs,GUI contextual texts, and privacy policies) from each app. In the
sensitivebehavior-descriptionlearningstep,DescribeCtxtrains
a description synthesis model based on the three inputs and thereference sentences in app descriptions. In the prediction phase,
givenanappwithsensitivebehaviors,DescribeCtxextractsthe
PACGs and the GUI contextual texts from the appâ€™s APK file. Then,
the permission description selection module checks whether the
appâ€™sprivacypolicyprovidesdescriptionsforthepermissionsused
by the sensitive behaviors. If the privacy policy contains related
permission descriptions, it directly extracts such descriptions; oth-
erwise, it usesthe most relevant permissiondescriptions from the
687
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. Feature ExtractionCall Graph
Construction
Description  
Synthesis  
ModelApp to 
Predict
Sensitive  Behavior  
Description  
Synthesis
Sensitive Behavior  
DescriptionGUIAnalysis
Permission
Description
ExtractionText  
EmbeddingSeq2seq  
LearningTraining Prediction
PACGGUI Contextual  
Text
Sensitive Behavior-
Description LearningPermission  
Description  
Selection
Permission  
Description
Training
AppsAPK
Privacy  
PolicyPACG
GUI 
Contextual 
Text
Permission
Description
Figure 3: Overview of DescribeCtx.
privacy policies of the training apps. Using the PACG, theGUI con-
textual text, and the permission description as input, DescribeCtx
synthesizes a description for each sensitive behavior of the app.
4.2 Feature Extraction
DescribeCtxappliesstaticanalysisandtextualanalysistechniques
toextractthreetypesoffeatures:PACG,GUIcontextualtext,and
privacy policy.
4.2.1 Permission-Protected-API Call Graph (PACG). In Android
apps, building a call graph for a sensitive behavior needs to con-
sider the unique characteristics of Android runtime. Android apps
arecomponent-basedandevent-drivenapplications,whereappsâ€™
code is developed as components (e.g., activities for defining the
GUIsandservicesforperformingbackgroundjobs)andexecuted
when user events (e.g., clicking buttons) or system events (e.g.,
receiving a phone call) occur [ 24,29,78]. In particular, the commu-
nications between components (i.e., Inter-Component Communica-
tions (ICC) [ 41,53,54,85]), lifecycle methods triggered when appsâ€™
executionstateschange(e.g.,openorclose)[ 9,70],andmultithread-
ing methods used to run worker threads cause appsâ€™ executions to
split into different components or threads [ 81], forming implicit
calling relationships among the methods in the appsâ€™ code.
TobuildaPACGforapermission-protectedAPIcallinanapp,
DescribeCtxfirstconstructsanInter-ComponentCallGraph(ICCG)
for the app, and then identifies the PACG based on the ICCG for
thesensitivebehavior.BasedontheidentifiedPACG,DescribeCtx
extractsthetextsofthenodesinthePACGastherepresentation
for the sensitive behavior. We next formally define an ICCG and a
PACG, and describe how to build them in detail.
Definition 1. An Inter-Component Call Graph (ICCG) is a di-
rectedcallgraphofanappthatcontainsboththeedgesthatrepresent
calling statements and the edges that represent implicit calling re-lationships, including multi-threading methods, Android lifecycle
methods, event-driven methods, and ICC methods.
To build an ICCG, DescribeCtx first leverages existing static
call graph techniques [ 9,70] to build a call graph based on call-
ing statements and lifecycle methods. It then expands the static
callgraphwiththeedgesrepresentingmoreimplicitcallingrela-
tionships. In particular, our analysis includes three types of im-
plicitcallingrelationshipsthataremostcommonlyusedinAndroidapps,includingmulti-threading,event-drivenmethod,andinter-
componentcommunication(ICC).Representativecallersandcallees
include setOnClickListener and onClick,Thread.start and Thread.run ,
AsyncTask.execute and doInBackground ,sendMessage and handleMessage ,
etc.Additionally,DescribeCtxintegratesICCmethodsusingan
existing tool IC3 [ 53]. Based on ICCGs, we next formally define
PACGs:
Definition 2. A Permission-Protected-API Call Graph (PACG) is
a subgraph of an ICCG, which is formed by the union of the paths
fromthedummyentrynodeoftheICCGtothenodethatrepresentsa
given sensitive API call.
To identify a PACG for a sensitive API call in an ICCG, De-
scribeCtx performsBreadth-First-Search (BFS)fromthis APIcall
to find all the paths leading to the dummy entry node of the ICCG,
and then uses all the nodes and edges found in these paths to con-
structthePACG.Ifnopathsarefound,thePACGcontainsonlythe
sensitive API call. In our evaluation dataset (Section 5), each ICCG
contains34,897nodesand83,949edgesonaverage,andeachPACG
contains only 66 nodes and 71 edges on average. Note that oneapp can have multiple PACGs because it may use multiple sensi-
tive API calls when requiring one certain permission. For example,
anappthatrequires CAMERApermissioncaninvoke takePicture and
MediaRecorder.start to take pictures and record videos.
Representation for Sensitive Behaviors . DescribeCtx gener-
ates the representation of a sensitive behavior by extracting the
textfromthenodesofitsPACG.Notethatamethodcallcontains
thetextthatrepresentstheclassname,thereturntype,themethod
name, and the parameters. As method names often present useful
and relatively unique information while class names, return types,
andparametersmaybesharedbymanymethods,DescribeCtxex-tractswordsfromonlythemethodnames.AsAndroidappsmainly
followthecamelcaseconventionindefiningmethodnames,De-
scribeCtxsplitseachmethodnameintoasetofwordsbasedon
theconvention.Forexample, getLastKnownLocation issplitinto ğ‘”ğ‘’ğ‘¡,
ğ‘™ğ‘ğ‘ ğ‘¡,ğ‘˜ğ‘›ğ‘œğ‘¤ğ‘›, andğ‘™ğ‘œğ‘ğ‘ğ‘¡ğ‘–ğ‘œğ‘›.
One particular challenge for extracting texts from a PACG is
code obfuscation, which is widely used in Android apps. The ob-fuscated words (e.g.,
ğ‘§ğ‘§ğ‘ğ‘) will make the extracted texts contain
lots of noises. To address this challenge, DescribeCtx removesthe obfuscated methods by leveraging two English dictionaries:NLTK [
47] and WordNet [ 21]. Specifically, DescribeCtx looks
688
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. up each extracted word in both dictionaries to filter out the non-
Englishwords.DescribeCtxadoptstwodictionariestoexpandthe
scopeoftheacceptablewords.Forexample,â€œappâ€isnotlistedas
an English word in NLTKâ€™s word list, but it is listed in WordNet. In
addition, DescribeCtx directly removes those method names that
use a single character such as ğ‘orğ‘.
4.2.2 GUIContextualText. ToextractGUIcontextualtextsfrom
anapp,wefirstapplyApktool[ 65]todecompileanappandextract
its XML layout files. To extract GUI information that is relevant
to a sensitive behavior, DescribeCtx performs a static analysis
toassociatelayoutfilestosensitivebehaviors.First,basedonthe
PACG of a sensitive behavior, DescribeCtx identifies the activ-ities that invoke the sensitive API calls. In Android apps, layout
filesaremostlyloadedinactivitiesusingmethods setContentView or
onCreateView with their unique layout ids. Our static analysis identi-
fiesthesemethodsandassociatesthelayoutidstotheactivitiesandfragments,andfurtherassociatestheactivitiestothecorresponding
layout files using the layout-id mapping.
The GUI contextual text mainly consists of two types: (1) string
valuesofanyGUIwidgetwith textattributefromtheGUIâ€™sXML
layout files, and (2) names of images and icons used in the app.Both types of text can be found in the resource folder
/ğ‘Ÿğ‘’ğ‘ /of a
decompiled APK file. For the textual GUI widgets, such as TextView
and Button,weextracttheir textattributes.Fortheimage-basedGUI
widgets,suchas ImageView and ImageButton ,weextracttheir idand
srcattributes,wherethe idattributeslinktheGUIwidgetsinthe
layoutfilestothevariablesinthesourcecode,andthe srcattributes
provide the names of the resource files (i.e., images and icons). We
mainly use the text from the textand srcattributes. If they are not
available, we use the idattributes of the GUI widgets.
SensitiveBehaviorswithoutGUIContextualTexts .Notethat
forcertainsensitivebehaviorsthathavenorelevantGUIcontextual
text, we apply a text-similarity based approach to borrow GUI con-
textual text from another app. Specifically, DescribeCtx computesthe text similarity based on TF-IDF [
11] between the extracted text
ofthesensitivebehaviorâ€™scallgraphandtheGUIcontextualtext
of other apps that use the same permission. Then, DescribeCtx
choosestheGUIcontextualtextwiththehighestsimilarityscore
for the sensitive behavior.
4.2.3 Privacy Policy. In addition to permission descriptions, pri-
vacypoliciesalsoincludetheinformationunrelatedtothesensitive
behaviorsoftheapp,suchaslegalinformationanduseragreements.
Toeffectivelyextractpermissiondescriptionsfromappsâ€™privacy
policies,DescribeCtxincorporatesBERT[ 17],whichhasachieved
dominatingperformanceinnaturallanguageprocessing(NLP)taskssuchasquestionanswering(QA)andtextclassification.Specifically,
DescribeCtx issues permission-related questions (e.g., â€œwhy does
ituse SMSpermission?â€)totheQAmoduleofBERT[ 73],andtheQA
modulereturnsananswer(i.e.,ansentence)fromtheprivacypolicy
with the highest confidence. As apps may use the same permission
toperformdifferentsensitivebehaviorsandthepermissiondescrip-
tionsoftenincludemultiplesentences,DescribeCtxappliesthis
extraction process for ğ‘˜times: each time DescribeCtx gets a sen-
tence, DescribeCtx removes the sentence from the privacy policy
and issues the same question to the QA module. To ensure the pre-cision of the extracted permission descriptions, DescribeCtx onlyaccepts the answers whose confidence are greater than a threshold
ğ‘ . Based on our empirical evaluations (Section 5), we set ğ‘˜to 3
andğ‘ to 0.2. Finally, to take into consideration the contexts for the
sentences, DescribeCtx also extracts the previous and the next
sentences of each returned sentence.
4.3 Sensitive Behavior-Description Learning
Inthisstep,DescribeCtxlearnsaneuralmachinetranslationmodelusingtheextractedfeaturesfromthetrainingappsandthereference
sentences identified from the corresponding app descriptions.
4.3.1 Model Overview. The overview of our behavior-description
learningmodelisshowninFigure4.Themodeladaptsaseq2seq
architecture but accepts three heterogeneous input sequences (i.e.,
word sequences from PACGs, GUI contextual texts, and privacy
policies). Each input sequence is transformed by a text embed-
ding modeland passed to abidirectional LSTM (Long-Short Term
Memory) layer. Next, before combining three representations into
a single vector, we apply the co-attention mechanism [ 48,66]t o
combine the representations of the GUI contextual text and PACG.
The main reason for using co-attention is that a PACG usually
contains many irrelevant words for a specific sensitive behavior,
and the GUI contextual text helps identify the words that are most
relevanttothesensitivebehavior.Then,theconcatenatedvector
representation is used as input of the decoder. When decoding,
DescribeCtx applies another attention layer, which computes the
relative weights of the three input sequences as well as the relative
weights of each word in terms of generating each target word to
form the description.
4.3.2 Modeling Input Sequences. We adopt similar modeling for
all the three input sequences. In the following, we take the GUIcontextual text as an example. We denote the embeddings of the
wordsintheGUIcontextualtextas [ğ‘¥1,ğ‘¥2,Â·Â·Â·,ğ‘¥ğ‘],whereğ‘¥ğ‘–âˆˆRğ‘™
istheembeddingofthe ğ‘–-th word,ğ‘™istheembeddingdimension,
andğ‘is themaximumlength ofthe inputsequence. Toobtain ğ‘¥ğ‘–,
we adopt Glove [ 58], which is a pre-trained and widely-used word
embeddingmodelinmachinetranslation,asourtextembedding
model.Then, tocapturethe sequentialorderofwords, weusethe
widely-used bidirectional LSTM [ 25,32]. Each LSTM neuron takes
thewordembedding ğ‘¥ğ‘–andtheoutputof theprevious neuron â„ğ‘–âˆ’1
as input, and outputs â„ğ‘–for the current word,
â„ğ‘–=ğµğ‘–-ğ¿ğ‘†ğ‘‡ğ‘€(ğ‘¥ğ‘–,â„ğ‘–âˆ’1) (1)
whereâ„ğ‘–âˆˆRğ‘‘of sizeğ‘‘is the hidden state of the current LSTM
neuron,anditalsostandsfortheupdatedfeaturevectorforthe ğ‘–-th
word. The output of the bidirectional LSTM contains the feature
vectors for each input word, i.e., ğ‘“ğºğ‘ˆğ¼=[â„1,â„2,Â·Â·Â·,â„ğ‘]where
ğ‘“ğºğ‘ˆğ¼âˆˆRğ‘‘Ã—ğ‘.Notethattheembeddingsofallthewordsincluding
those in PACGs, GUI contextual texts, and permission descriptions,
are maintained in the same lookup table.
4.3.3 FeatureCombination. Toeliminatetheirrelevantinforma-
tioninaPACG,weadopttheparallelco-attentionmechanismtosimultaneouslyupdatethePACGfeatureandtheGUIcontextual
textfeaturewiththeguidanceofeachother.Inthefollowing,we
showhowtoupdatethePACGfeaturesbasedontheGUIcontex-
tual text features, and the opposite direction can be analogously
689
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. â€œâ€¦ we may 
use GPS to 
determine ...â€
â€œâ€¦ weather 
wait for 
location â€¦â€
â€œâ€¦ get last 
known 
location â€¦â€Text 
Embedding
Text
Embedding
Text 
EmbeddingBi-
LSTM
Bi-
LSTM
Bi-
LSTMCo-Attention Layer
C
Encoder Decoder
...
<START> Find yourFind your location ...
... gps<END>
GUI 
contextual 
text
PACGPermission 
description
Attention Layer
Figure 4: Overview of the behavior-description learning model.
obtained. Here, the attention improves the PACG feature vector
by highlighting the words that are relevant to GUI contextual text.
Specifically,weuse ğ‘“ğºğ‘ˆğ¼âˆˆRğ‘‘Ã—ğ‘andğ‘“ğ¶ğºâˆˆRğ‘‘Ã—ğ‘€todenotethe
featurevectors ofthe inputPACGand GUIcontextualtext, where
ğ‘andğ‘€arethemaximumlengthsoftheinputGUIcontextualtext
andPACG,respectively.Wethencomputethecorrelationmatrix
ğ¶âˆˆRğ‘Ã—ğ‘€as follows,
ğ¶=ğ‘¡ğ‘ğ‘›â„(ğ‘“ğ‘‡
ğºğ‘ˆğ¼ğ‘Šğ‘ğ‘“ğ¶ğº) (2)
whereğ‘Šğ‘âˆˆRğ‘‘Ã—ğ‘‘istheparametertolearn.Notethatthereare ğ‘
andğ‘€featurevectorsfortheGUIcontextualtextandthePACG,
and thisğ¶matrix contains the similarities/correlations between
theseğ‘Ã—ğ‘€pairs of feature vectors.
Based on the above correlation matrix, we can correlate ğ‘“ğºğ‘ˆğ¼
andğ‘“ğ¶ğºbytransferringthefeaturesforeachother.Inparticular,
we update ğ‘“ğ¶ğºwith the guidance of ğ‘“ğºğ‘ˆğ¼,
ğ»ğ¶ğº =ğ‘¡ğ‘ğ‘›â„(ğ‘Šğ¶ğºğ‘“ğ¶ğº+(ğ‘Šğºğ‘ˆğ¼ğ‘“ğºğ‘ˆğ¼)ğ¶)
ğ‘ğ¶ğº =ğ‘ ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘Šâ„ğ»ğ¶ğº)
Ëœğ‘“ğ¶ğº =ğ‘€/summationdisplay.1
ğ‘–=1(ğ‘(ğ‘–)
ğ¶ğºğ‘“(ğ‘–)
ğ¶ğº) (3)
whereËœğ‘“ğ¶ğºâˆˆRğ‘‘indicates the final attentive feature vector for the
PACG, and ğ‘Šğºğ‘ˆğ¼,ğ‘Šğ¶ğºâˆˆRğ‘ŸÃ—ğ‘‘,ğ‘Šâ„âˆˆR1Ã—ğ‘Ÿare learnable param-
eters.ğ‘ğ¶ğºstands for the attention/importance for each word to
the final PACG feature vector. Similarly, we can obtain the feature
vector Ëœğ‘“ğºğ‘ˆğ¼fromğ‘“ğºğ‘ˆğ¼. In practice, we update ğ‘“ğºğ‘ˆğ¼andğ‘“ğ¶ğºin
parallel. For the permission description from the privacy policy,
since it usually contains human-written, high-quality sentences,
we directly use the output of the lastLSTM neuron as its feature
vector. We denote it by ğ‘“ğ‘ƒğ‘’ğ‘Ÿğ‘š, and obtain the final output vector
ğ‘“=[ğ‘“ğ‘ƒğ‘’ğ‘Ÿğ‘š;Ëœğ‘“ğ¶ğº;Ëœğ‘“ğºğ‘ˆğ¼]of the encoder.
4.3.4 AttentiveDecoder. Whengeneratingthetargetsequence,the
relativeimportance/weightsofthethreeinputsequencesarenot
necessarilyequal.Forexample,theprivacypolicyismoreimportant
whengeneratingwordsrelatedtothedescriptionofpermissions,
and the GUI context and call graph explain more on the specificbehaviors. Therefore, DescribeCtx applies an attentive decoderto learn the relative importance of three input sequences whengenerating each word of the target sequence. In particular, we
alsouseLSTMtogeneratethebehaviordescription.SupposethehiddenstateoftheLSTMneuronis ğ‘ ğ‘¡âˆˆRğ‘‘attimestep ğ‘¡(i.e.,when
generatingthe ğ‘¡-thword).Theattentiondistributionofthethree
input sequences is then calculated as follows,
ğ‘’ğ‘¡
ğ‘–=ğ‘£ğ‘‡ğ‘¡ğ‘ğ‘›â„(ğ‘Šğ‘“ğ‘“ğ‘–+ğ‘Šğ‘ ğ‘ ğ‘¡)
ğ‘ğ‘¡
ğ‘–=ğ‘ ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘’ğ‘¡
ğ‘–) (4)
whereğ‘“1=ğ‘“ğ‘ƒğ‘’ğ‘Ÿğ‘š,ğ‘“2=Ëœğ‘“ğ¶ğº,ğ‘“3=Ëœğ‘“ğºğ‘ˆğ¼,andğ‘Šğ‘“,ğ‘Šğ‘ âˆˆRğ‘ŸÃ—ğ‘‘,ğ‘£âˆˆRğ‘Ÿ
areparameters tolearn.The normalized ğ‘ğ‘¡
ğ‘–determineshow much
attentionshouldbegiventothe ğ‘–-thinputsequencewhengener-
ating theğ‘¡-th word in the description. Then, we can produce the
overall representation ğ‘ğ‘¡=/summationtext.13
ğ‘–=1ğ‘ğ‘¡
ğ‘–ğ‘“ğ‘–of thethree inputsequences
when generating the ğ‘¡-th word.
4.4 Sensitive Behavior Description Synthesis
Basedonthetrainedmodel,givenanappthatcontainssensitive
behaviors, DescribeCtx applies the feature extraction techniques
to extract the features from the app, and feeds the features intothe model to synthesize descriptions for each sensitive behavior.Given the fact that the privacy policy of an app does not neces-sarily contain all related permission descriptions, the permission
descriptionselectionmoduleinDescribeCtxisusedtochooserelevant
permission descriptions from the training apps when the related per-
missiondescriptionsaremissing.ItcomputestheTF-IDFsimilarity
betweentheGUIcontextualtextandthepermissiondescriptions
ofthetrainingapps,andchoosesthetop- ğ‘˜similarsentencesasthe
permission description.
5 EVALUATION
We evaluate the effectiveness of DescribeCtx on real world apps.
Specifically, we aim to answer the following research questions:
â€¢RQ1:HoweffectiveisDescribeCtxingeneratingdescriptions
for sensitive behaviors, with and without app-specific privacy
policies?
â€¢RQ2: How does DescribeCtx compare with the existing work?
â€¢RQ3: How do different techniques in extracting features affect
the effectiveness of DescribeCtx?
â€¢RQ4:HoweffectiveisDescribeCtxingeneratingdescriptions
for sensitive behaviors, from usersâ€™ perspectives?
690
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. Table1:Effectivenessresultsof DescribeCtxandexistingwork.DescribeCtxperformssignificantlybetterthantheexisting
work. DescribeCtx ğ‘can further improve DescribeCtx when the app-specific privacy policies are available.
Approach Metric CALENDAR CAMERA CONTACT LOCATION MICROPHONE SMS STORAGE Average
DescribeCtxBLEU 24.27Â±1.90 24.91 Â±2.77 24.10 Â±2.56 26.79 Â±3.45 24.03 Â±3.35 24.55 Â±2.92 24.01 Â±3.3324.47Â±3.02
ROUGE-L 22.76Â±1.37 23.16 Â±1.90 25.78 Â±1.48 23.64 Â±1.80 19.53 Â±1.70 26.45 Â±1.60 22.84 Â±2.3522.88Â±2.00
DescribeCtx ğ‘BLEU 26.94Â±3.48 26.12 Â±2.74 24.71 Â±3.50 27.85 Â±3.44 25.60 Â±2.90 24.55 Â±2.92 24.29 Â±3.2025.75Â±3.10
ROUGE-L 23.44Â±1.47 23.39 Â±1.91 26.14 Â±1.65 23.82 Â±2.00 21.88 Â±2.01 26.45 Â±1.60 23.10 Â±2.4423.47Â±2.20
Code2Vec [5]BLEU 9.19Â±1.50 8.12 Â±0.56 2.27 Â±0.21 10.87 Â±1.39 11.21 Â±1.06 3.71 Â±1.03 8.44 Â±1.008.49Â±0.97
ROUGE-L 13.35Â±1.44 6.28 Â±0.38 11.93 Â±0.72 16.00 Â±1.13 9.38 Â±0.51 16.20 Â±3.93 17.38 Â±1.4113.01Â±0.98
Code2Vec+ğ‘ğ‘[5]BLEU 15.22Â±1.85 13.42 Â±1.55 17.89 Â±2.15 15.54 Â±1.68 15.19 Â±1.92 12.11 Â±1.40 12.74 Â±1.7214.36Â±1.76
ROUGE-L 18.96Â±1.28 15.64 Â±1.65 24.76 Â±1.72 19.15 Â±1.18 16.80 Â±1.34 21.88 Â±1.83 17.73 Â±1.7618.19Â±1.59
DescribeMe [82]BLEU - - 20.90 Â±1.40 - 14.16 Â±1.24 4.88 Â±0.30 --
ROUGE-L - - 9.31 Â±0.25 - 17.31 Â±0.90 8.17 Â±0.62 --
DescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥BLEU 17.78Â±2.47 16.45 Â±2.01 23.22 Â±2.63 19.30 Â±2.55 18.48 Â±2.48 16.63 Â±2.22 17.74 Â±3.2018.38Â±2.62
ROUGE-L 20.06Â±1.52 13.73 Â±1.14 23.21 Â±1.86 19.47 Â±1.39 14.38 Â±1.41 24.66 Â±2.58 18.56 Â±2.4017.74Â±1.79
DescribeCtxâˆ’
ğºğ‘ˆğ¼BLEU 17.78Â±2.47 16.91 Â±2.09 23.31 Â±2.65 21.17 Â±2.94 19.03 Â±2.51 16.63 Â±2.22 18.61 Â±3.2018.79Â±2.48
ROUGE-L 20.06Â±1.52 14.52 Â±1.20 23.77 Â±1.90 19.88 Â±1.45 17.91 Â±1.90 24.66 Â±2.58 18.70 Â±2.3518.76Â±2.17
DescribeCtxâˆ’ğ‘ğ‘BLEU 6.94Â±0.44 4.13 Â±0.23 11.64 Â±2.18 5.67 Â±0.49 4.89 Â±0.40 1.62 Â±0.04 2.60 Â±0.284.83Â±0.05
ROUGE-L 9.27Â±0.90 7.04 Â±0.67 19.88 Â±1.45 9.64 Â±1.07 8.87 Â±0.88 4.79 Â±0.46 7.94 Â±0.619.27Â±0.10
DescribeCtx ğ‘ğ‘BLEU 22.46Â±2.28 23.37 Â±2.90 24.10 Â±2.56 25.88 Â±3.28 22.90 Â±2.87 24.55 Â±2.92 22.75 Â±3.2523.70Â±3.00
ROUGE-L 22.37Â±1.45 21.57 Â±1.89 25.78 Â±1.48 23.50 Â±1.80 19.04 Â±1.65 26.45 Â±1.60 21.99 Â±2.4922.19Â±2.08
5.1 Evaluation Subjects and Setup
Wecollectedreal-worldappsofdifferentcategoriesfromGoogle
Play [27] as our evaluation subjects, which are then grouped based
ontheirpermissiongroups[ 18,26].Notethatallpermissionsare
protecting user understandable sensitive data [ 7,56,59,71,72].
Thus,wefocuson12dangerouspermissionsin7groups,whichare
the representative permissions that protect user understandable
sensitive data. Since we need to use the permission descriptions
in privacy policies for training and the explanations of permission
usesinappdescriptionsforassessingthequalityofthesynthesizeddescriptions, we choose apps that use at least one of the dangerous
permissions and satisfy the following two requirements:
â€¢PermissionDescriptionsinPrivacyPolicy :foreachapp,ifitpro-
vides a link for a privacy policy, we apply relevant keyword
searchtocheckwhethertheprivacypolicycontainssentences
to explain the permission.
â€¢PermissionExplanationinAppDescription :foreachchosenper-
mission, we apply relevant keyword search to check whether
their app descriptions contain sentences that may explain the
usesofthepermission.Wethenmanuallyinspectthesesentences
to determine whether they can be used as reference sentences.
Intotal,weexamine8,814apps,anduse1,262qualifiedapps(20 .86ğºğµ,
16.93ğ‘€ğµonaverage).Thedetailednumberofappsineachpermis-
sion group can be found in Table 2. Note that we exclude the PHONE
permission group because its permissions (i.e., READ_PHONE_STATE ,
CALL_PHONE ,READ\WRITE_CALL_LOG ) are barely explained in appsâ€™ de-
scriptions (only 3 apps). We compile a list of permission-protected
APIs (from API level 21 to level 29) from the Android Developer
website.Wealsomanuallyinspectthepermission-APImappings
providedbyPScout[ 10]andaddmoreAPIsiftheAPIsaccesssensi-
tivedataandarenotdeprecatedafterAPIlevel20.Intotal,weobtain
171 unique permission-protected APIs. For each app, DescribeCtx
is applied to build an ICCG and extract PACGs from the ICCG
for each permission-protected API call. On average, DescribeCtx
extracts 4.6 PACGs from each app.
Training and Prediction .Foreachpermission-protectedAPIin
an app, we extract its PACGs, GUI contextual text, and permissiondescriptionasaninputtriple,andusethereferencesentenceasthe
output. In total, we obtain 1,556 data samples from the 1,262 apps.
To evaluate the effectiveness of our model, we perform ten-fold
crossvalidation.Fortheparameters,wesetthewordembedding
sizeğ‘™=100andtheLSTMstatesize ğ‘‘=256.Themaximumlengths
ofthetextsequencesextractedfromGUIcontextualtext,PACGs,
and privacy policy are all set to 50. Based on our empirical results
(Section 5.4), DescribeCtx uses top-3 relevant permission descrip-
tionsfromthetrainingappswhenanappâ€™sownprivacypolicydoes
notproviderelatedpermissiondescriptions.Themodelistrained
using stochastic gradient descent with the Adam optimizer.Evaluation Metrics
. We measure the effective of DescribeCtx
using two widely-used metrics for machine translation: ğµğ¿ğ¸ğ‘ˆ[57]
andğ‘…ğ‘‚ğ‘ˆğºğ¸[42].ğµğ¿ğ¸ğ‘ˆ-ğ‘›(ğ‘›from1to4)score âˆˆ[0,100]represents
the percentage of the ğ‘›-grams from the synthesized description
thatalsoco-occurinthereferencesentence,wherescore100means
a perfect match. The ğµğ¿ğ¸ğ‘ˆmetric used in our evaluations is the
average of ğµğ¿ğ¸ğ‘ˆ-ğ‘›(ğ‘›from 1 to 4). For ğ‘…ğ‘‚ğ‘ˆğºğ¸,w eu s eğ‘…ğ‘‚ğ‘ˆğºğ¸-
ğ¿, which takes the longest common subsequences in reference
sentences and synthesized descriptions into account. Similar to
ğµğ¿ğ¸ğ‘ˆ,ğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿score/percentageisalsointherangeof [0,100]
with 100 indicating a perfect match.
User Study .A sğµğ¿ğ¸ğ‘ˆandğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿do not fully consider seman-
ticmeaningsandgrammaticalstructures,wefurtherconducttwo
userstudiestoevaluatewhetherthesynthesizeddescriptionsare
similar to the reference sentences. The first study recruits students
with Android usage experiences in their daily lives and Android
development experiences, and the second study leverages Amazon
Mechanical Turk (MTurk) [ 6] to recruit users with more diverse
backgrounds. MTurk is a crowdsourcing marketplace which en-
ables researchers to easily harness the collective insights from the
survey participants with different backgrounds and experiences.
Havingtwodifferentgroupswithparticipantsfromvariousback-
grounds is more representative and bias-resistant. For both user
studies, we compare the synthesized descriptions generated by De-
scribeCtxwiththebaselinesDescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥andCode2Vec+ğ‘ğ‘.
691
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. Table 2: Permission groups and reference sentences.
Permission Group # Apps # Refs Coverage
STORAGE 1,126 462 41 .11%
LOCATION 586 336 57 .34%
MICROPHONE 558 217 39 .25%
CAMERA 877 328 36 .94%
CONTACT 356 138 38 .76%
SMS 107 24 22 .43%
CALENDAR 202 51 25 .74%
Average â€“â€“ 3 7 .37%
DescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥uses the features of permission and privacy poli-
cies(sothatitcanbuildthevocabulariesforsensitivebehaviors),
but does not use PACGs and GUI contextual text to represent sen-
sitivebehaviors.Code2Vec+ğ‘ğ‘usescode2vec[ 4,5]tomodelcode
and generate sentence, and extends it by incorporating the pri-
vacypolicyasinput.Wealsoprovideanintroductiontohelpthe
participants better understand the purpose of the survey.
For the first user study, we recruited 8 graduate students and
4 undergraduate students. The participants are provided with a
referencesentenceandthreesynthesizeddescriptions,andaskedto
provide ratings on whether each synthesized description is similar
to the reference sentence from two aspects: syntactical correctness
and semantic closeness. For each aspect, the students rate each
synthesized description using a 5-point scale: Very Bad (1), Bad (2),
So-so (3), Good (4), and Very Good (5). To reduce the bias of the
userstudy,werandomlyshufflethethreesentencesproducedby
the three approaches. In total, each student is given a survey of
778 quadruples of one reference sentence and three synthesized
sentences, and each synthesized sentence is rated by 6 students.
Fortheseconduserstudy,weresorttoMTurkforanopensurvey.
Wedivide1,556data samplesinto50splits (eachcontaining31or
32 samples), and send out 300 splits (i.e., 6 for each split). Each
sampleconsistsofareferencesentenceasthequestionandthree
synthesizedsentencesfromthethreeapproachesastheanswers.
Theorderofthethreeanswersisrandomlyshuffled.Ratingthesyn-
thesizedsentencescanbetime-consuming,andMTurkparticipants
areperhapsmoreimpatient.Thus,insteadofratingthesynthesized
sentences, for each question, MTurk participants are asked to pick
one or more answers that look like the reference sentence in terms
of semantic closeness. To ensure the quality of the collected an-swers, we constrain that each sample is displayed for at least 10
secondsbeforeitcanbemovedtothenextsample.Foreachdata
split,wealsointentionallypluginanadditionaldatasamplewith
oneobviousanswerandtwoirrelevantanswers.Iftheuserchose
the irrelevant answers, we consider all his/her answers invalid and
removethemall.Thereare275uniqueusersparticipatinginour
study, and 174 out of them are considered valid.
The example survey, the consent form, the detailed statistics
oftherecruitedstudents,andmoredetailsoftheuserstudiesare
available at our project website [2].5.2 RQ1: Overall Effectiveness
Table 1 shows the effectiveness results of our approach. We first
compare DescribeCtx, which uses relevant permission descrip-
tionsfromtheprivacypoliciesoftrainingapps,withDescribeCtx ğ‘,
whichusesthepermissiondescriptionsfromtheappsâ€™ownprivacy
policies.Onaverage,DescribeCtxachieves24 .47ğµğ¿ğ¸ğ‘ˆscorewith
a standard deviation of 3 .02, and achieves 22 .88ğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿score
with a standard deviation of 2 .00. DescribeCtx ğ‘achieves slightly
higherğµğ¿ğ¸ğ‘ˆ(25.75withastandarddeviationof3 .10)andğ‘…ğ‘‚ğ‘ˆğºğ¸-
ğ¿scores (23 .47 with a standard deviation of 2 .20). These results
indicate that most popular apps use permissions for similar
purposes, and thus with the guidance of behavior represen-tation and GUI contextual text, the relevant permission de-scriptionsofotherappsâ€™privacypoliciescanbeleveragedtosynthesize accurate descriptions.
Ingeneral,DescribeCtxperformswellinallpermissiongroups
(ğµğ¿ğ¸ğ‘ˆ> 24), even in the CALENDARand SMSgroups where we have
a limited number of training samples (only 24 and 51 as shownin Table 2). The possible reason is that the permissions in thesegroups are used for similar purposes (e.g., â€œsend SMSâ€ or â€œsend
text messageâ€ for SEND_SMS, and â€œadd eventâ€ for WRITE_CALENDAR ). The
lowestğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scoreisfromthe MICROPHONE group.Onepossible
reasonisthatthoseappsusemicrophonesforquitediversepurposes
includingdetectingsurroundingnoise,recordingspeech,having
audio or video chat, or even playing games.Case Study
.WeprovidesomeexamplesinTable3.Thefirsttwo
examplesarefromthe CAMERAgroup.Wecanobservealthoughthese
two appsuse camerasfor different purposes(take photosvs. scan
QR code), DescribeCtx is able to synthesize non-trivial and high-
quality descriptions for both of them. This is due to the fact that
we take app-specific contextual information as input. For example,
DescribeCtxextractsâ€œphotoâ€andâ€œgalleryâ€fromtheGUIofthe
firstappandextractsâ€œScantheQRcodeâ€fromtheGUIofthesecondapp.Additionally,thesecondappâ€™sprivacypolicydoesnotprovide
any permission description for this behavior, and DescribeCtx
addressesthisproblembyextractingthepermissiondescriptions
fromthemost similar appsinourtrainingset(e.g.,â€œOurappuses
camera permission for scanning purposeâ€) and connecting them
with the GUI contextual text. Two more examples from the STORAGE
and LOCATIONgroups are shown in the table, where unique words
areextractedfromappsâ€™GUIstosynthesizethedescriptions.The
lastexampleisfromtheappâ€œcom.lily.times.tweenshusky.allâ€whichusesthemicrophonetorecorduserâ€™sspeechandrep eatsitusingthe
voice of husky dog. DescribeCtx precisely identifies the sensitive
behavioroftheapp(i.e.,usingthemicrophonetorecordyourvoice).
However, app-specific words such as â€œhuskyâ€ and â€œfunny voiceâ€
from the appâ€™s GUI contextual text are ignored given the fact that
theyareveryrareinthetrainingdata.Insummary,theseexamplesshowthat
appsâ€™GUIcontextualtextsandrelevantpermission
descriptions in privacy policies can provide app-specific in-formation to improve the synthesized descriptions.
5.3 RQ2: Comparison with Existing Work
Next, we compare DescribeCtx with the following three linesof the state-of-the-art approaches. (1) Approach that identifiessentences in app descriptions to explain sensitive behaviors [
56,
692
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. Table3:Synthesizedexamplesfromdifferentpermissiongroups.Theboldwordsrepresenttheuniquewordsthatareextracted
from appsâ€™ GUIs and used by DescribeCtx to synthesize the descriptions.
App Permission Group Reference Sentence DescribeCtx BLEU
app.tocus.photoframe.
missyouphotoframeCAMERATake your photos from your gallery
or from the cameraTake photos from your gallery or take fromthe camera62.31
com.citylife .cachier CAMERAScan the QR code of the cards andquickly receive the informationYou canscan the qr code with phone camera 35 .04
nl.fotoview.shatter STORAGESave and share your imagein JPG or PNG formatYou cansave image to your phone and share
with social media on social31.17
com.cedarfair.
canadaswonderlandLOCATIONThe app uses your location to keepyou up to date with offers, eventsand activities relevant to your locationThis app will read your location informationyou cansearchlocation and nearby service25.35
com.lily.times.
tweenshusky.allMICROPHONETalk to husky dog and he will repeateverything you say with a funny voiceThe app uses microphone to record your voice 12 .73
59]. (2) Two closest related approaches Code2Vec [ 4,5] and De-
scribeMe [ 82]. Code2Vec leverages only the source code of the
app, constructs abstract syntax tree (AST) of each method, and
usesattentiveseq2seqmodeltogeneratesummaryforthesource
code. DescribeMe leverages both GUI contexts and call graphsof the app, and uses pre-defined templates to generate sensitivepermission descriptions. (3) Traditional comment generation ap-proach that does not consider app contexts (i.e., GUI contextualtext and call graph) or app-specific vocabulary (i.e., privacy pol-icy), or uses code context (i.e., call graphs) solely [
33,40,46,62].
Specifically,thesemethodscanbeseenasvariantsof DescribeCtx:DescribeCtx
âˆ’
ğ‘ğ‘¡ğ‘¥thatusesonlyprivacypoliciesoftheappsasinput,
DescribeCtxâˆ’
ğºğ‘ˆğ¼that uses both privacy policies and PACGs as
inputs, and DescribeCtxâˆ’ğ‘ğ‘that uses app contexts as inputs.
Comparison with Sentence Identification . In this comparison,
wemeasurethenumberofdangerouspermissionsrequestedbythe
apps (8,814 apps) and the number of reference sentences provided
to explain them, as shown in Table 2. As we can see, each app
requests 3 .3 dangerous permissions on average, and the reference
sentences cover only 1 .2 permissions, which results in the average
coveragebeingonly37 .37%.Thisshowsthatappdescriptionsdo
not always have the descriptions for all the dangerous permissions
requested by the apps. In contrast, DescribeCtx can synthesize
descriptions for all permissions.Comparison with Code2Vec and DescribeMe
.Thecompar-
ison results of these two approaches are shown in Table 1. We can
seethatDescribeCtxoutperformsCode2Vecforallpermission
groupsintermsof ğµğ¿ğ¸ğ‘ˆandğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scores(atleast43%better).
AsCode2Veclacksthevocabularyfromprivacypolicies,wealso
feedtheprivacypoliciesintoCode2Vecâ€™slearningmodel,resultinginavariantof Code2Vec:theCode2Vec
+ğ‘ğ‘approach.Code2Vec+ğ‘ğ‘
is much better than Code2Vec, achieving a ğµğ¿ğ¸ğ‘ˆscore of 14 .36
and ağ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿score of 18 .19. Nonetheless, DescribeCtx still
outperforms Code2Vec+ğ‘ğ‘by 41.3% for the ğµğ¿ğ¸ğ‘ˆscore and20 .5%
for theğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿score. These results indicate that GUI contextual
textsandPACGsoftheappscontributemoreonsynthesizingac-
curatesensitivebehaviordescriptionsthanusingthesourcecode
representationalonewithCode2Vec.ForDescribeMe,wecompare
only three permission groups (i.e., SMS,STORAGE, and CONTACT) sincewecanonlyfindthesethreetemplatesfromtheirpaper2.Wecan
seethatDescribeCtxsignificantlyoutperformsDescribeMeon
bothğµğ¿ğ¸ğ‘ˆandğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scoresinthesethreepermissiongroups,
especially the SMSgroup (ğµğ¿ğ¸ğ‘ˆscores: 24.55 versus 4 .88).
ComparisonwithTraditionalCommentGeneration .Asshown
in Table 1, DescribeCtx outperforms the three competitors for all
permissiongroups.DescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥onlyachievesa ğµğ¿ğ¸ğ‘ˆscoreof
18.38andağ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scoreof17 .74onaverage.Thisissignificantly
lowerthanDescribeCtx(droppingrelativelyby24 .88%and22 .47%,
respectively).DescribeCtxâˆ’
ğºğ‘ˆğ¼achievesa ğµğ¿ğ¸ğ‘ˆscoreof18 .79and
ağ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿score of 18 .76 on average. These scores are slightly
higher than those of DescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥, indicating the effectiveness
ofusingPACGsinsteadofthepermissionnames.Still,DescribeCtxachievesmuchhigher
ğµğ¿ğ¸ğ‘ˆandğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scoresin6outof7per-
mission groups (i.e., CALENDAR,CAMERA,LOCATION,MICROPHONE ,SMS, and
STORAGE), indicating that GUI contextual text plays an important
roleforDescribeCtxtogenerateapp-specificdescriptionsinthese
sixpermissiongroups.ForDescribeCtxâˆ’ğ‘ğ‘,itperformsrelatively
poor, indicating the importance of incorporating the vocabulary of
privacy policies.
Overall, these results demonstrate that DescribeCtx outper-
forms the state-of-the-art techniques in terms of ğµğ¿ğ¸ğ‘ˆand
ğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scores.
5.4 RQ3: Impact of Feature Extractions
We next evaluate the impacts of different design choices in the
feature extraction.ImpactofPACGs
.WefirstdesignDescribeCtx ğ‘ğ‘thatusesacall
path instead of a PACG as its features for behavior representation.
AsshowninTable1,DescribeCtxoutperformsDescribeCtx ğ‘ğ‘
by 3.15% and 3 .02% on average in terms of ğµğ¿ğ¸ğ‘ˆandğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿
scores. For the permission groups SMSand CONTACTS, the scores of
both methods are almost identical, as the GUI contextual text in
thesetwopermissiongroupsalreadycontainssufficientinforma-
tion for explaining sensitive behaviors (e.g., â€œsend smsâ€ or â€œopen
contactâ€).Overall,thisexperimentindicatesthatcomparedtocall
2We have contacted the authors but they were not able to provide the complete set of
the templates used in their study.
693
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. (a) User study A (b) User study B
Figure 5: User ratings for the synthesized descriptions of
different approaches. The proposed DescribeCtx is betterthan the two competitors in both user studies.
paths,ourPACGscontainmoreusefulinformationthatcanbeused
to synthesize sensitive behavior descriptions.Impact of Permission Descriptions Extraction
. Existing work
provides various techniques that can be used to extract permission
descriptions from appsâ€™ privacy policies [ 14,39,56,73]. We com-
pareDescribeCtxâ€™spermissiondescriptionextractiontechnique
with a keyword-based search approach and two text classification
techniques using BERT [ 73] and CNN [ 39]. We manually label the
sentencesthatdescribepermissionusesintheprivacypoliciesas
the ground truths, and compute the precision, recall, and F 1values
ofeachtechnique.TheresultsshowthatDescribeCtxachievesthe
best F1score (0.86) among all the compared approaches, while the
keyword-based search technique achieves the worst F 1score (0.65).
Theseresultsclearlydemonstratethesuperiorityof DescribeCtxâ€™s
permissiondescriptionextractiontechniqueovertheexistingones.
Impact of Top- ğ‘˜Relevant Permission Descriptions . In this
experiment,wecomparetheresultsof DescribeCtxusingdifferent
ğ‘˜values, ranging from 1 to 6. The results show that, DescribeCtx
achieves the best results when ğ‘˜is 2 or 3. To mitigate the over-
fitting issue, ğ‘˜=3 is used in our evaluations. The ğµğ¿ğ¸ğ‘ˆscores
achieved by DescribeCtx drop sharply when ğ‘˜â‰¥4. The probable
reasonis thatwhen ğ‘˜becomeslarger, morenoisesare introduced
and it becomes more difficult to synthesize accurate descriptions.
5.5 RQ4: User Study
Figure 5 shows the results of our two user studies, where we com-
pare DescribeCtx with DescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥and Code2Vec+ğ‘ğ‘. Fig-
ure5(a)showstheaverageratingsfromtherecruitedstudentsof
differentapproaches.WecanseethatDescribeCtxachieveshigherratingsforbothsyntacticalcorrectnessandsemanticclosenessthanthetwocompetitors.Forexample,comparedwithDescribeCtx
âˆ’
ğ‘ğ‘¡ğ‘¥,
therelativeimprovementsof DescribeCtxare5 .13%(4.30versus
4.09)and9.91%(3.55versus3 .23),respectively.Figure5(b)shows
the results from MTurk workers. Here, we collect the pick ratios of
differentapproaches,i.e.,thepercentageofsentencesselectedas
themostsemantically similaronetothereference sentences.The
resultsshowthatusersaremoreinclinedtochoosethesynthesized
sentences from DescribeCtx. Compared with DescribeCtxâˆ’
ğ‘ğ‘¡ğ‘¥,
DescribeCtx improves it by 19 .97% (57.06% versus 47 .56%).
We also observe some inconsistencies between user ratings and
ğµğ¿ğ¸ğ‘ˆ/ğ‘…ğ‘‚ğ‘ˆğºğ¸scores. We show two examples in Table 4. The first
example uses the CALENDARpermission, and its ğµğ¿ğ¸ğ‘ˆscore is 21 .56,
whichismuchlowerthantheaverage.However,theuserratingsindicatethatthisisanaccuratedescriptionasitssemanticratingis
much higher than the average (i.e., 4 .33 versus 3 .55). The reason
isthatğµğ¿ğ¸ğ‘ˆ/ğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scoresmeasuretheword-levelsimilarity
between the synthesized description and the reference sentence,
whereas user ratings could better cover the semantics. For the
second example, although the ğµğ¿ğ¸ğ‘ˆscore of the synthesized de-
scriptionismuchhigherthantheaverage,thesemanticratingis
only2.83asthekeywordâ€œusbâ€ismissing.Theseexamplesillustrate
the necessity of conducting the user study.
Overall,thesetwouserstudiesshowthat thesynthesized de-
scriptions of DescribeCtx are better than the existing ap-proaches from usersâ€™ perspectives.
6 THREAT TO VALIDITY
Themaininternalthreatcomesfrommistakenlylabellingtheref-
erencesentencesforthesensitivebehaviors.Tomitigatethethreat,
each sentence is verified by at least two authors, and we further
check the GUIs and the code when we are not sure whether a sen-
tenceisprovidingjustificationtoapermission.Anotherinherent
limitation is that DescribeCtx does not consider dynamic-loading
GUI texts in the feature extraction phase. This would cause De-
scribeCtx miss some GUI contextual texts of the sensitive behav-
iors.WemitigatethisissuebyusingsimilarGUIcontextualtexts
from other training samples.
The main external threat comes from the representativesness of
our evaluation dataset. We have used 12 dangerous permissionsin 7 groups that protect user understandable sensitive data, andchose 1,262 apps that contain both reference sentences and pri-
vacypoliciesasweneedtousetheappsâ€™referencesentencesand
privacy policies to assess the effectiveness of DescribeCtx. Tomitigate the threat for generalizing sentences for the apps that
do not contain privacy policies describing their requested permis-
sions,DescribeCtxleveragesthetrainingappsâ€™privacypolicies
tocomplementthemissingprivacypoliciesfortheapps.Wealso
exclude the PHONEpermission group due to lack of training data.
Thesethreatscanbefurthermitigatedbycontactingthedevelopers
of the apps to provide the accurate descriptions.
7 DISCUSSION
Application of DescribeCtx . The synthesized descriptions of
DescribeCtxcanhelpusersunderstandthefunctionalitiesofapps
when the original app descriptions are incomplete or absent. Also,
the synthesized descriptions can be used to check whether an app
provides only low-qualify general descriptions for permission uses
bycomparingthesynthesizeddescriptionswiththeprovidedde-
scriptions [ 45], and serve as the basis for developers to provide
customized permission descriptions.Sensitive Behaviors
. DescribeCtx focuses on the sensitive be-
haviors resulted by invoking sensitive APIs. However, apps may
usesensitivedatainAndroidâ€™s ğ‘–ğ‘›ğ‘¡ğ‘’ğ‘›ğ‘¡andğ‘¢ğ‘Ÿğ‘–messages,orthrough
the inputs from GUIs [ 7,34,51]. Such issues can be mitigated by
integratingexisting static/dynamicanalysis techniquesto expand
the scope of the sensitive behaviors.CodeObfuscationandThird-partyLibraries
.Inourevaluation
subjects, we observe that at least 78 .53% of the apps (991 out of
1262) apply obfuscation techniques on their code. As demonstrated
694
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. Table 4: Example synthesized descriptions with contradictory ğµğ¿ğ¸ğ‘ˆscores and user ratings.
BLEURating
(Semantics/Syntax)Reference Sentence DescribeCtx
21.56 4.33/4.17 You can view all schedules in calendar, or create a schedule You can read calendar and add event to calendar
32.97 2.83/4.00 Download recordings to a usb storage Download files to your phone storage
in Section 5.2, while DescribeCtx discards obfuscated names in
callgraphs,DescribeCtxisstillabletoeffectivelysynthesizede-
scriptions with the help of the contextual information provided by
GUI text. Also, Section 5.4 shows that DescribeCtx ğ‘ğ‘that uses
call paths instead of call graphs are more sensitive to obfuscations
due to the limited nodes in the call paths. Currently, DescribeCtx
does not consider third-party libraries as apps generally do not
explainthe usesoflibraries tousers.These issuescanbeaddressed
by requesting developers of third-party libraries to provide their
own descriptions on the permission uses.
Malicious Apps .DescribeCtx isdesignedto synthesizedescrip-
tions for sensitive behaviors, but not to detect malicious behaviors
thatdeliberatelyevadedetection[ 19,67,70,86].Formaliciousapps
thataimtomanipulatepermission-protecteddata,DescribeCtxcan still synthesize descriptions for them by training a model on
maliciousappswithreferencesentences(e.g.,malwarefamilyde-
scription)thatexplainthemaliciousbehaviors.Formaliciousbe-
haviorsthatdonotconcernaboutthesensitivedataprotectedby
permissions,suchasrootphonesandC&C(CommandandControl),
we can adopt the advanced detection techniques [ 49,76,78,79],
which is out of the scope of DescribeCtx.
ReferenceSentences . We consider the app descriptions provided
bytheappdevelopersasthemostreliableandeasy-to-accesssource
forreferencesentences.Tomitigatetheriskthatdevelopersmay
lieaboutthepermissionuses,wechooseonlyhigh-qualitypopular
apps and manually inspect the chosen appsâ€™ functionality to verify
that the provided app descriptions can be used. Crowd-sourcingapproaches may also be adopted to collect reference sentences
especially for the apps that lack such sentences in the app descrip-
tions. However, obtaining anaccurate referencesentence requires
deployingappsandinspectingcode,whichisanon-trivialeffort.
Nonetheless, we conductsuch an evaluation byfirst randomly se-
lecting 125 apps that are not included in our evaluation dataset.
Then, two authors spent over 70 hours to verify the apps and write
thebehaviordescriptions,bydeployingtheminAndroid8 .0virtual
machine and inspecting the source code via JADX [ 1]. In total, we
obtain64sensitivebehaviorsfromtheseappsbyexcludingthose
requiring login, leading to failures, or triggering sensitive behavior
inthebackground.Amongthem, 53(83%)author-writtendescrip-
tions are semantically consistent with the synthesized sentences
by DescribeCtx. This result shows that DescribeCtx synthesizes
sentencesthatcanwelldescribethesensitivebehaviorsthemselves.
8 RELATED WORK
Extracting Descriptions for Sensitive Behavior . There exists
a line of work [ 56,59] that adapts NLP techniques and machine
learning techniques to extract sentences in app descriptions for
explaining thepermission uses. However, thesesentences usually
cannot cover all the permissions requested by the apps. Unlikethese approaches, DescribeCtx incorporates app descriptions and
privacy policies into the neural machine translation model to syn-
thesize descriptions for sensitive behaviors. Recent work [ 82] gen-
erates descriptions using behavior description model for the call
graphs of sensitive APIs. Unlike DescribeCtx, this approach uses
only words from the code, failing to consider app-specific func-
tionality described inprivacy policies and GUIs.In addition, some
work [8,14] identifies sentences that describe what types of infor-
mationhave beenused inthe apps,while DescribeCtx identifies
the permission descriptions for the sensitive behaviors.Code Comment Generation
.Earliercodecommentgeneration
workadoptstemplate-basedorheuristic-basedtechniquestogen-
erate comments for source code [ 31,62]. However, these propos-
als have been shown to be less effective and flexible comparedto data-driven techniques. Later, deep learning techniques such
asconvolutionalneuralnetworksandrecurrentneuralnetworks
have been adopted to translate a small piece of the source code
into comments [ 3,33,37,40,46]. However, these proposals do not
consider the context of sensitive behaviors and are not as effective
as DescribeCtx, as shown in Section 5.3 and Section 5.4.Seq2seq and Attention Mechanism
. Seq2seq learning and the
attention mechanism [ 12,64,66] have become the de facto stan-
dard in many applications including neural machine translation,
text summarization, and question answering. As a promising deep
learning model, seq2seq model has also been used in addressingplenty of other software engineering tasks, such as commit mes-sage generation [
38,77], comment generation [ 33,40,46], API
migration [ 30,52], and program synthesis [ 43,80]. In this work,
we also adopt the attentive seq2seq model for synthesizing natural
language descriptions. Different from existing work, we encodethree-way information in our seq2seq model, and pay special at-
tention to learning the context of sensitive behaviors via applying
co-attention [48, 84] on the call graph and GUI words.
9 CONCLUSION
We have presented a context-aware neural machine translation
approach, DescribeCtx, that trains a seq2seq model using a large
number of apps, and generates descriptions for sensitive behav-
iorsintheappsbasedonapp-specificcontextualinformation.De-
scribeCtx provides static analysis techniques and text analysistechniquestoextractfeaturesfromappsâ€™callgraphs,GUIlayout
files,andprivacypolicies,formingthreeheterogeneousinputse-
quences for training the model. Our evaluations on 1,292 real apps
showthatDescribeCtxachieveshigh ğµğ¿ğ¸ğ‘ˆ/ğ‘…ğ‘‚ğ‘ˆğºğ¸-ğ¿scoreswith
respect to the reference sentences in the app descriptions. Usersalso provide relatively high ratings for DescribeCtx in terms of
syntactic and semantic aspects of the synthesized descriptions.
695
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. ACKNOWLEDGMENTS
XushengXiaoâ€™sworkispartiallysupportedbytheNationalScience
Foundation under the grants CCF-2046953 and CNS-2028748. Yuan
YaoispartiallysupportedbytheCollaborativeInnovationCenter
ofNovelSoftwareTechnologyandIndustrialization.Theworkwas
done when the second author was at Nanjing University. Xusheng
Xiao and Yuan Yao are the corresponding authors.
REFERENCES
[1] Jadx: Dex to java decompiler, 2020. https://github.com/skylot/jadx/releases.
[2]Describectxprojectwebsite,2021.https://github.com/DescribeCTX/DescribeCTX.
[3]MiltiadisAllamanis,HaoPeng,andCharlesSutton. Aconvolutionalattention
networkforextremesummarizationofsourcecode. In ProceedingsoftheInter-
national Conference on Machine Learning (ICML), pages 2091â€“2100, 2016.
[4]Uri Alon, Shaked Brody, Omer Levy, and Eran Yahav. Code2seq: Generating
sequences from structured representations of code. In Proceedings of the Interna-
tional Conference on Learning Representations (ICLR), 2019.
[5]UriAlon,MeitalZilberstein,OmerLevy,andEranYahav. Code2Vec:Learning
distributed representations of code. Proceedings of the ACM on Programming
Languages (POPL), 3:40:1â€“40:29, 2019.
[6] Amazon. Amazon mechanic turk, 2021. https://www.mturk.com/.[7]
Benjamin Andow, Akhil Acharya, Dengfeng Li, William Enck, Kapil Singh, and
Tao Xie. UiRef: Analysis of sensitive user inputs in android applications. In
ProceedingsoftheACMConferenceonSecurityandPrivacyinWirelessandMobile
Networks (WiSec), pages 23â€“34, 2017.
[8]BenjaminAndow,SaminYaseerMahmud,JustinWhitaker,WilliamEnck,BradleyReaves,KapilSingh,andSergeEgelman. Actionsspeaklouderthanwords:Entity-
sensitive privacy policy and data flow analysis with policheck. In Proceedings of
the USENIX Security Symposium, 2020.
[9]Steven Arzt, Siegfried Rasthofer, Christian Fritz, Eric Bodden, Alexandre Bartel,
JacquesKlein, YvesLe Traon,Damien Octeau,and PatrickMcDaniel. FlowDroid:
Precise context, flow, field, object-sensitive and lifecycle-aware taint analysis for
androidapps. In ProceedingsoftheACMSIGPLANConferenceonProgramming
Language Design and Implementation (PLDI), page 259â€“269, 2014.
[10]KathyWainYeeAu,YiFanZhou,ZhenHuang,andDavidLie. PScout:Analyzing
the android permission specification. In Proceedings of ACM Conference on
Computer and Communications Security (CCS), pages 217â€“228, 2012.
[11]Ricardo A. Baeza-Yates and Berthier Ribeiro-Neto. Modern Information Retrieval.
Addison-Wesley Longman Publishing Co., Inc., USA, 1999.
[12]Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio. Neural machine trans-
lationbyjointlylearningtoalignandtranslate. In ProceedingsoftheInternational
Conference on Learning Representations (ICLR), 2015.
[13]DavidBarrera,H.GÃ¼neÅŸKayacik,PaulC.vanOorschot,andAnilSomayaji. A
methodology for empirical analysis of permission-based security models andits application to android. In Proceedings of ACM Conference on Computer and
Communications Security (CCS), pages 73â€“84, 2010.
[14]Andow Benjamin, Mahmud Samin, Yaseer, Wang Wenyu, Whitaker Justin, Enck
William, Reaves Bradley, Singh Kapil, and Xie Tao. PolicyLint: Investigating
internal privacy policy contradictions on google play. In Proceedings of the
USENIX Security Symposium, pages 585â€“602, 2019.
[15]Kyunghyun Cho, Bart van MerriÃ«nboer, Dzmitry Bahdanau, and Yoshua Bengio.
Onthepropertiesofneuralmachinetranslation:Encoderâ€“decoderapproaches.
InProceedingsoftheWorkshoponSyntax,SemanticsandStructureinStatistical
Translation (SSST), pages 103â€“111, 2014.
[16]Kyunghyun Cho, Bart van Merrienboer, Ã‡aglar GÃ¼lÃ§ehre, Dzmitry Bahdanau,Fethi Bougares, Holger Schwenk, and Yoshua Bengio. Learning phrase repre-sentations using RNN encoder-decoder for statistical machine translation. In
ProceedingsoftheConferenceonEmpiricalMethodsinNaturalLanguageProcessing
(EMNLP), pages 1724â€“1734, 2014.
[17]Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. BERT:
pre-trainingofdeepbidirectionaltransformersforlanguageunderstanding. In
Proceedings of the Annual Conference of the North American Chapter of the Associ-ationforComputationalLinguistics:HumanLanguageTechnologies(NAACL-HLT),
pages 4171â€“4186, 2019.
[18] Android Official Documentation. App permissions: Permissions overview.[19]
WilliamEnck,DamienOcteau,PatrickMcDaniel,andSwaratChaudhuri. Astudyofandroidapplicationsecurity. In ProceedingsoftheUSENIXSecuritySymposium,
pages 21â€“21, 2011.
[20]Ming Fan, Xiapu Luo,Jun Liu, Meng Wang, Chunyin Nong, QinghuaZheng, and
Ting Liu. Graph embedding based familial analysis of android malware using
unsupervised learning. In Proceedings of the International Conference on Software
Engineering (ICSE), pages 771â€“782, 2019.
[21]ChristianeFellbaum,editor. WordNetAnElectronicLexicalDatabase . TheMIT
Press, 1998.[22]Adrienne Porter Felt, Matthew Finifter, Erika Chin, Steve Hanna, and David
Wagner. Asurveyofmobilemalwareinthewild. In ProceedingsoftheAnnual
ACM CCS Workshop on Security and Privacy in Smartphones and Mobile Devices
(SPSM), pages 3â€“14, 2011.
[23]Adrienne Porter Felt, Elizabeth Ha, Serge Egelman, Ariel Haney, Erika Chin,
andDavidWagner. Androidpermissions:Userattention,comprehension,and
behavior. In ProceedingsoftheSymposiumonUsablePrivacyandSecurity(SOUPS),
pages 1â€“14, 2012.
[24]Dominik Franke, Corinna Elsemann, Stefan Kowalewski, and Carsten Weise.
Reverseengineeringofmobileapplicationlifecycles.In ProceedingsoftheWorking
Conference on Reverse Engineering (WCRE), pages 283â€“292, 2011.
[25]Ian J. Goodfellow, Yoshua Bengio, and Aaron C. Courville. Deep Learning. Adap-
tive computation and machine learning. MIT Press, 2016.
[26]Google. Android permission groups, 2020.
https://developer.android.com/reference/android/Manifest.permission_group.
[27] Google. Google Play Store, 2020. https://play.google.com/store?hl=en.[28]
Google. Potentially harmful applications (phas), 2020.
https://developers.google.com/android/play-protect/potentially-harmful-
applications.
[29]Google. Application Fundamentals, 2021.
https://developer.android.com/guide/components/fundamentals.
[30]Xiaodong Gu, Hongyu Zhang, Dongmei Zhang, and Sunghun Kim. DeepAM:
migrate apis with multi-modal sequence to sequence learning. In Proceedings of
theInternationalJointConferenceonArtificialIntelligence(IJCAI),pages3675â€“
3681, 2017.
[31]Sonia Haiduc, Jairo Aponte, and Andrian Marcus. Supporting program com-
prehension with source code summarization. In Proceedings of the international
conference on software engineering (ICSE), pages 223â€“226, 2010.
[32]Sepp Hochreiter and JÃ¼rgen Schmidhuber. Long short-term memory. Neural
Computation, 9(8):1735â€“1780, 1997.
[33]Xing Hu, Ge Li, Xin Xia, David Lo, and Zhi Jin. Deep code comment generation.
InProceedings of the International Conference on Program Comprehension (ICPC),
pages 200â€“210, 2018.
[34]Jianjun Huang, Zhichun Li, Xusheng Xiao, Zhenyu Wu, Kangjie Lu, XiangyuZhang, and Guofei Jiang. SUPOR: Precise and scalable sensitive user inputdetection for android apps. In Proceedings of the USENIX Security Symposium,
pages 977â€“992, 2015.
[35]AV-TEST Institute. Malware statistics, 2020. https://www.av-
test.org/en/statistics/malware/.
[36]iOSOfficialDocumentation. Humaninterfaceguideilnes:Requestingpermission.
[37]Srinivasan Iyer, Ioannis Konstas, Alvin Cheung, and Luke Zettlemoyer. Summa-
rizing source code using a neural attention model. In Proceedings of the Annual
Meeting of the Association for Computational Linguistics (ACL), pages 2073â€“2083,
2016.
[38]Siyuan Jiang, Ameer Armaly, and Collin McMillan. Automatically generating
commit messages from diffs using neural machine translation. In Proceedings of
the IEEE/ACM International Conference on Automated Software Engineering (ASE),
page 135â€“146, 2017.
[39]Yoon Kim. Convolutional neural networks for sentence classification. In Pro-
ceedings of the Conference on Empirical Methods in Natural Language Processing
(EMNLP), 2014.
[40]Alexander LeClair, Siyuan Jiang, and Collin McMillan. A neural model for
generating natural language summaries of program subroutines. In Proceedings
oftheACM/IEEEInternationalConferenceonSoftwareEngineering(ICSE),pages
795â€“806, 2019.
[41]LiLi,AlexandreBartel,TegawendÃ©F.BissyandÃ©,JacquesKlein,YvesLeTraon,
StevenArzt,SiegfriedRasthofer,EricBodden,DamienOcteau,andPatrickMc-
Daniel. IccTA: Detecting inter-component privacy leaks in android apps. In
Proceedings of the International Conference on Software Engineering (ICSE) , pages
280â€“291, 2015.
[42]Chin-Yew Lin. ROUGE: A package for automatic evaluation of summaries. In
ProceedingsoftheAssociationforComputationalLinguistics(ACL),pages74â€“81,
2004.
[43]Xi Victoria Lin, Chenglong Wang, Deric Pang, Kevin Vu, Luke Zettlemoyer, and
Michael D. Ernst. Program synthesis from natural language using recurrent
neural networks. Technical Report UW-CSE-17-03-01, University of Washington
Department of Computer Science and Engineering, 2017.
[44]BinLiu,HongxiaJin,andRameshGovindan. Medusa:Aprogrammingframe-
work for crowd-sensing applications. In Proceedings of the Annual International
ConferenceonMobileSystems,Applications,andServices(MobiSys),pages337â€“350,
2015.
[45]Xueqing Liu, Yue Leng, Wei Yang, Wenyu Wang, Chengxiang Zhai, and Tao Xie.
Alarge-scaleempiricalstudyonandroidruntime-permissionrationalemessages.
InProceedingsoftheIEEESymposiumonVisualLanguagesandHuman-Centric
Computing (VL/HCC), pages 137â€“146, 2018.
[46]Zhongxin Liu, Xin Xia, Ahmed E Hassan, David Lo, Zhenchang Xing, and Xinyu
Wang. Neural-machine-translation-basedcommitmessagegeneration:howfar
arewe? In ProceedingsoftheACM/IEEEInternationalConferenceonAutomated
696
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. Software Engineering (ASE), pages 373â€“384, 2018.
[47]Edward Loper and Steven Bird. NLTK: The natural language toolkit. In Pro-
ceedings of the ACL Interactive Poster and Demonstration Sessions, pages 214â€“217,
2004.
[48]JiasenLu,JianweiYang,DhruvBatra,andDeviParikh. Hierarchicalquestion-
imageco-attentionforvisualquestionanswering. In ProceedingsoftheInterna-
tionalConferenceonNeuralInformationProcessingSystems(NIPS),pages289â€“297,
2016.
[49]LongLu,ZhichunLi,ZhenyuWu,WenkeLee,andGuofeiJiang. CHEX:Statically
vetting android apps for component hijacking vulnerabilities. In Proceedings
oftheACMConferenceonComputerandCommunicationsSecurity(CCS),pages
229â€“240, 2012.
[50]Thang Luong, Hieu Pham, and Christopher D. Manning. Effective approaches to
attention-basedneuralmachine translation. In Proceedingsofthe Conferenceon
Empirical Methods in Natural Language Processing (EMNLP), pages 1412â€“1421,
2015.
[51]Yuhong Nan, Min Yang, Zhemin Yang, Shunfan Zhou, Guofei Gu, and Xiaofeng
Wang. UIPicker: User-input privacy identification in mobile applications. In
Proceedings of the USENIX Security Symposium, pages 993â€“1008, 2015.
[52]TrongDucNguyen,AnhTuanNguyen,HungDangPhan,andTienNNguyen.
Exploring API embedding for API usages and applications. In Proceedings of the
International Conference on Software Engineering (ICSE), pages 438â€“449, 2017.
[53]Damien Octeau, Daniel Luchaup, Matthew Dering, Somesh Jha, and Patrick Mc-
Daniel.Compositeconstantpropagation:Applicationtoandroidinter-component
communicationanalysis. In ProceedingsoftheInternationalConferenceonSoft-
ware Engineering (ICSE), pages 77â€“88, 2015.
[54]DamienOcteau,PatrickMcDaniel,SomeshJha,AlexandreBartel,EricBodden,
JacquesKlein,andYvesLeTraon.Effectiveinter-componentcommunicationmap-
ping inandroid withEpicc: Anessential steptowards holisticsecurity analysis.
InProceedings of the USENIX Conference on Security, page 543â€“558, 2013.
[55]Jason D. Oâ€™GRADY. New privacy enhancements coming to ios 8 in the fall.,
2014. http://www.zdnet.com/new-privacy-enhancements-coming-to-ios-8-in-
the-fall-7000030903/.
[56]Rahul Pandita, Xusheng Xiao, Wei Yang, William Enck, and Tao Xie. WHYPER:
towards automating risk assessment of mobile applications. In Proceedings of the
USENIX Security Symposium, page 527â€“542, 2013.
[57]KishorePapineni,SalimRoukos,ToddWard,andWei-JingZhu. BLEU:amethod
for automatic evaluation of machine translation. In Proceedings of the Annual
MeetingoftheAssociationforComputationalLinguistics(ACL),pages311â€“318,
2002.
[58]Jeffrey Pennington, Richard Socher, and Christopher D. Manning. GloVe: Global
vectors for word representation. In Proceedings of Empirical Methods in Natural
Language Processing (EMNLP), pages 1532â€“1543, 2014.
[59]Zhengyang Qu, Vaibhav Rastogi, Xinyi Zhang, Yan Chen, Tiantian Zhu, andZhong Chen. AutoCog: Measuring the description-to-permission fidelity inandroid applications. In Proceedings of the ACM Conference on Computer and
Communications Security (CCS), pages 1354â€“1365, 2014.
[60]Vaibhav Rastogi, Yan Chen, and William Enck. AppsPlayground: Automatic
security analysis of smartphone applications. In Proceedings of ACM Conference
on Data and Application Security and Privacy (CODASPY), page 209â€“220, 2013.
[61]Sanae Rosen, Zhiyun Qian, and Z. Morely Mao. AppProfiler: A flexible method
of exposing privacy-related behavior in android applications to end users. In
Proceedings of the ACM Conference on Data and Application Security and Privacy
(CODASPY), page 221â€“232, 2013.
[62]Giriprasad Sridhara, Emily Hill, Divya Muppaneni, Lori Pollock, and K Vijay-
Shanker.Towardsautomaticallygeneratingsummarycommentsforjavamethods.
InProceedingsoftheACM/IEEE InternationalConferenceonAutomatedSoftware
Engineering (ASE), pages 43â€“52, 2010.
[63]Statista. Global mobile os market share, 2020.
https://www.statista.com/statistics/266136/global-market-share-held-by-
smartphone-operating-systems/.
[64]IlyaSutskever,OriolVinyals,andQuocV.Le. Sequencetosequencelearningwith
neural networks. In Proceedings of the Annual Conference on Neural Information
Processing Systems (NIPS), pages 3104â€“3112, 2014.
[65]Connor Tumbleson and Ryszard Wisniewski. Apktool, 2017. https://ibotpeaches.
github.io/Apktool/.
[66]Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
AidanN.Gomez,LukaszKaiser,andIlliaPolosukhin. Attentionisallyouneed.
InProceedings of Annual Conference on Neural Information Processing Systems
(NIPS), pages 5998â€“6008, 2017.
[67] VirusShare. VirusShare, 2021. http://virusshare.com/.[68]
Haoyu Wang, Jason Hong, and Yao Guo. Using text mining to infer the purpose
of permissionuse in mobileapps. In Proceedings ofthe ACM InternationalJoint
Conference on Pervasive and Ubiquitous Computing (UbiComp), pages 1107â€“1118,2015.
[69]Xiaoyin Wang, Xue Qin, Mitra Bokaei Hosseini, Rocky Slavin, Travis D. Breaux,
and Jianwei Niu. GUILeak: Tracing privacy policy claims on user input data for
android applications. In Proceedingsof theInternational Conferenceon Software
Engineering (ICSE), pages 37â€“47, 2018.
[70]Fengguo Wei, Sankardas Roy, Xinming Ou, and Robby. Amandroid: A preciseand general inter-component data flow analysis framework for security vet-ting of android apps. In Proceedings of the ACM Conference on Computer and
Communications Security (CCS), page 1329â€“1341, 2014.
[71]Primal Wijesekera, Arjun Baokar, Lynn Tsai, Joel Reardon, Serge Egelman,David A. Wagner, and Konstantin Beznosov. The feasibility of dynamicallygranted permissions: Aligning mobile privacy with user preferences. In Pro-
ceedings of the IEEE Symposium on Security and Privacy (S&P), pages 1077â€“1093,
2017.
[72]PrimalWijesekera,JoelReardon,IrwinReyes,LynnTsai,Jung-WeiChen,NathanGood,DavidWagner,KonstantinBeznosov,andSergeEgelman. Contextualizingprivacydecisionsforbetterprediction(andprotection). In ProceedingsoftheCHI
Conference on Human Factors in Computing Systems (CHI), pages 1â€“13, 2018.
[73]Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement De-
langue,AnthonyMoi,PierricCistac,TimRault,RÃ©miLouf,MorganFuntowicz,
JoeDavison,SamShleifer,PatrickvonPlaten,ClaraMa,YacineJernite,JulienPlu,
CanwenXu,TevenLeScao,SylvainGugger,MariamaDrame,QuentinLhoest,
andAlexanderM.Rush. Transformers:State-of-the-artnaturallanguageprocess-
ing. InProceedingsoftheConferenceonEmpiricalMethodsinNaturalLanguage
Processing: System Demonstrations (EMNLP), pages 38â€“45, 2020.
[74]XushengXiao,NikolaiTillmann,ManuelFahndrich,JonathanDeHalleux,and
MichalMoskal. User-awareprivacycontrolviaextendedstatic-information-flow
analysis. In ProceedingsoftheInternationalConferenceonAutomatedSoftware
Engineering (ASE), pages 80â€“89, 2012.
[75]XushengXiao,NikolaiTillmann,ManuelFahndrich,JonathanDeHalleux,and
MichalMoskal. User-awareprivacycontrolviaextendedstatic-information-flow
analysis. Automated Software Engineering Journal (ASEJ), 22(3):333â€“366, 2015.
[76]Ke Xu, Yingjiu Li, Robert H. Deng, and Kai Chen. DeepRefiner: Multi-layer
androidmalwaredetectionsystemapplyingdeepneuralnetworks. In Proceedings
oftheIEEEEuropeanSymposiumonSecurityandPrivacy(EuroS&P),pages473â€“
487, 2018.
[77]Shengbin Xu, Yuan Yao, Feng Xu, Tianxiao Gu, Hanghang Tong, and Jian Lu.Commit message generation for source code changes. In Proceedings of the
International Joint Conferences on Artificial Intelligence (IJCAI), pages 3975â€“3981,
2019.
[78]Wei Yang, Xusheng Xiao, Benjamin Andow, Sihan Li, Tao Xie, and William Enck.
AppContext:Differentiatingmaliciousandbenignmobileappbehaviorsusing
context. In ProceedingsoftheInternationalConferenceonSoftwareEngineering
(ICSE), pages 303â€“313, 2015.
[79]Zhemin Yang, Min Yang, Yuan Zhang, Guofei Gu, Peng Ning, and X. Sean Wang.
AppIntent: analyzing sensitive data transmission in android for privacy leakage
detection. In Proceedings of the ACM conference on Computer & communications
security (CCS), pages 1043â€“1054, 2013.
[80]Pengcheng Yin and Graham Neubig. A syntactic neural model for general-
purpose code generation. In Proceedings of the Annual Meeting of the Association
for Computational Linguistics (ACL), pages 440â€“450, 2017.
[81]YujieYuan,LihuaXu,XushengXiao,AndyPodgurski,andHuibiaoZhu. Run-
Droid: recovering execution call graphs for android applications. In Proceedings
oftheACMJointEuropeanSoftwareEngineeringConferenceandSymposiumon
the Foundations of Software Engineering (ESEC/FSE), pages 949â€“953, 2017.
[82]Mu Zhang, Yue Duan, Qian Feng, and Heng Yin. Towards automatic generation
of security-centric descriptions for android apps. In Proceedings of the ACM
Conference on Computer and Communications Security (CCS), pages 518â€“529,
2015.
[83]Mu Zhang, Yue Duan, Heng Yin, and Zhiruo Zhao. Semantics-aware androidmalware classification using weighted contextual API dependency graphs. InProceedings of the ACM Conference on Computer and Communications Security
(CCS), pages 1105â€“1116, 2014.
[84]Suwei Zhang, Yuan Yao, Fent Xu, Hanghang Tong, Xiaohui Yan, and Jian Lu.
Hashtag recommendation for photo sharing services. In Proceedings of the AAAI
Conference on Artificial Intelligence (AAAI), pages 5805â€“5812, 2019.
[85]Jinman Zhao, Aws Albarghouthi, Vaibhav Rastogi, Somesh Jha, and DamienOcteau. Neural-augmented static analysis of android communication. In Pro-
ceedings ofthe ACMJoint Meetingon European SoftwareEngineering Conference
and Symposium on the Foundations of Software Engineering (ESEC/FSE), pages
342â€“353, 2018.
[86]Yajin Zhou and Xuxian Jiang. Dissecting android malware: Characterization and
evolution. In Proceedings of the IEEE Symposium on Security and Privacy (S & P),
pages 95â€“109, 2012.
697
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:06:21 UTC from IEEE Xplore.  Restrictions apply. 