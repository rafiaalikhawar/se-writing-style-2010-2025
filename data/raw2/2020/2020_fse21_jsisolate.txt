JSISOLATE:Lightweight In-Browser JavaScriptIsolation
Mingxue Zhang
Chinese Universityof Hong Kong
Hong Kong SAR,China
mxzhang@cse.cuhk.edu.hkWei Meng
Chinese Universityof Hong Kong
Hong Kong SAR,China
wei@cse.cuhk.edu.hk
ABSTRACT
Modern web applications commonly include third-party scripts
from external hosts. While enabling code reuse and enhancing the
functionalities,the reliability of client-side JavaScript code can be
impairedbytheinclusionofotherscripts.Sinceallscriptsrunin
the sameexecution environmentinthebrowser,executingthem
all together may cause unexpected effects. For example, global
variables with the same name might be defined by multiple scripts,
causing the actual valueto be unpredictable.
Inthispaper,wedesignalightweightbrowser-basedframework,
JSIsolate ,thatprovidesanisolatedandreliableJavaScriptexecu-
tionenvironment. JSIsolate injectsscriptsintodifferentisolated
environments based on their dependency relationship. In this way,
itexecutesscriptswithindependentfunctionalitiesindifferentcon-
texts, effectively preventing them from interfering with each other.
We further evaluated the compatibility and performance overhead
ofJSIsolate on Alexa top 1K websites, and showed that it can
efficiently isolate scripts whilepreservingthe functionalities.
CCS CONCEPTS
·Software and its engineering →Software organization and
properties ;Software reliability .
KEYWORDS
JavaScript; Scriptisolation; Webbrowser
ACMReference Format:
Mingxue Zhang and Wei Meng. 2021. JSISOLATE: Lightweight In-Browser
JavaScript Isolation. In Proceedings of the 29th ACM Joint European Software
Engineering Conference and Symposium on the Foundations of Software Engi-
neering (ESEC/FSE ’21), August 23ś28, 2021, Athens, Greece. ACM, New York,
NY, USA, 12pages.https://doi.org/10.1145/3468264.3468577
1 INTRODUCTION
Itis acommonpracticein developingwebapplicationsto include
scriptsfromdifferenthosts.ArecentstudyofAlexatop75Kweb-
sites shows that external scripts are prevalent, with a median num-
berof9andthemaximumnumberof202persite[ 15].Over90%of
thewebsitesincludeatleastoneexternalscript.Includingscripts
Permissionto make digitalor hard copies of allorpart ofthis work for personalor
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ESEC/FSE ’21, August 23ś28,2021, Athens,Greece
©2021 Associationfor Computing Machinery.
ACM ISBN 978-1-4503-8562-6/21/08...$15.00
https://doi.org/10.1145/3468264.3468577fromthird-partyhostsallowsadevelopertoreusethecodeinthird-
partylibraries.Forexample,adevelopercanincludeathird-party
jQuery script to facilitate DOMtraversingandmanipulation.
Unfortunately, including multiple external scripts together may
causeundesiredeffects.Inthebrowser,allthescriptsinthesame
frame (e.g., the main frame) run in a shared environment. This
meansanyscriptcaninterferewiththeexecutionofotherscripts
inthesameframe.Existingworkshaverevealedthatnameconflicts
couldexistbetweenJavaScriptlibrariesandanynormalscripts,and
areprevalentontheweb[ 24,44,45].Builtinmethodsandproperties
couldalsobeoverridenandaffectthedefaultbehaviorsofallscripts
[2].Meanwhile,somesensitivedatacouldbestoredattheclientside
andcanbeaccessedandmodifiedbyanyincludedscript.Executing
scriptsfromdifferentpartiesinthesamecontextcouldsignificantly
affectthe functionalities hence the reliabilityof webapplications.
PriorworkshaveinvestigatedtheproblemofprotectingJavaScript
codeintegritybyisolatingthenamespace, i.e.,executionenviron-
ment, of scripts. In [ 10,13,19,33,42], the authors sandboxed un-
trustedthird-party scripts iniframes,preventingthemfromaccess-
ingobjectsinthemainframe.However,astheiframesuseaseparate
DOM from the embedding page, special care must be taken to han-
dletherenderingofcontentsgeneratedbythesandboxedscripts.
Also, the events from the embedding page must be specifically for-
warded to the iframes. They therefore introduced a high latency
in page rendering. Another branch of research works emulated
an isolated execution environment by restricting the accesses to
objects defined by first-party scripts from untrusted scripts [ 3,23].
Theyrely on aruntimeaccess monitor, which incurs asignificant
overheadonthe basic operations like function invocation.
Inthispaper,weaimtodesignalightweightmechanismthatpro-
vides an isolated JavaScript execution environment in the browser,
topreventfunctionalityinterferenceinmashups.Wefacethefol-
lowing challenges. First, scripts included on the same page may be
functionally dependent. We need to carefully determine the execu-
tionenvironmentforeachscripttomaintainthefunctionalities.Sec-
ond,JavaScript codecan be dynamically included invarious ways,
forexample,throughJavaScriptURLs, eval(),orasynchronously
invoked as event listeners. The event listeners and JavaScript URLs
canbedefinedasattributesofDOMelements,whichcanalsobe
dynamicallymodifiedbyJavaScript.Itisnon-trivialtocaptureall
thedynamicallyincludedscriptsandisolatetheminanappropriate
environment. Finally, in order to make our scheme deployable and
practical,weneedtominimizetheperformanceoverheadandthe
requiredmodificationto applications,whichischallenging.
Toovercometheabovechallenges,wedevelop JSIsolate ,alight-
weight browser-based isolated JavaScript execution framework for
improving script reliabilities. It operates in two modes: a dynamic
script-dependencyanalysis mode,anda policyenforcementmode
193ESEC/FSE ’21, August 23–28, 2021,Athens,Greece Mingxue Zhang andWeiMeng
that separatesJavaScriptin isolated executionenvironments(con-
texts) to providehigher reliability.
Inthefirstmode, JSIsolate analyzesthedependencyrelation-
shipbetweenscripts.Itfirstusesanopen-sourcedomainrelation-
shiplistasthegroundtruthofscriptdependencies.Itthendynami-
callymediatesallscriptaccessestoJavaScriptobjectstoinferthe
dependency between scripts not on the list. Based on the depen-
dency analysis, it automatically generates policies that specify the
execution context for each statically included third-party script.It
alsogeneratesauxiliaryinformationtohelpthedevelopersvalidate
theisolationpolicies. JSIsolate cangeneratetwotypesofisolation
policies:domain-levelpolicies,wherescriptsofthesamedomain
areassignedthesamecontextforeasymanagement;andURL-level
policies,whereeachscriptidentifiedbyitsURLisassignedacontext
for fine-grainedisolation.
Inthesecondmode,foreachgroupoffunctionality-dependent
scripts,JSIsolate spawns an isolated execution environmentÐthe
isolated world , which has been used to confine content scripts
of browser extensions. It also tracks the dynamic inclusion of
JavaScript code toidentify the initiator scriptof each dynamically
includedscript, which would be executed in the same context as
theinitiatorscript.Thisprevents anisolatedscriptfromescaping
its execution environment by dynamically injecting new scripts.
The isolation is seamlessly and securely performed without the
overheadofinterceptingeachJSobjectaccess.
Weimplementedaprototypeof JSIsolate basedontheChromium
browserversion71,andtesteditonAlexatop1Kwebsites.Wewill
release the prototype as an open-source software. We demonstrate
withrealworldandsyntheticexamplesthat JSIsolate isabletosep-
arate functionality-independent JavaScript code. We further show
JSIsolate canisolatescriptswhilepreservingtheintendedfunction-
alities of real world websitesśusing URL-level (resp. domain-level)
policies, script isolation caused exceptions on 1 (resp. 0) out of the
top 100 websites. JSIsolate also introduces limited performance
overhead.UsingURL-levelpolicies,weobserveda1.91%average
increaseinmemoryconsumptionanda7.95%averageslowdownon
page loading. When using domain-level policies, the average mem-
oryandpageloadingoverheadis1.34%and6.66%,respectively.The
results show that JSIsolate caneffectively andefficiently provide a
reliable executionenvironment for client-sideJavaScript.
In summary,we make the following contributions.
•We design and develop JSIsolate , a light-weight isolated
JavaScriptexecutionframeworkforimprovingthereliability
ofclient-sideJavaScript.
•We systematicallyanalyzethe dependency relationshipbe-
tween scripts on the Alexa top 1K websites. The analysis
results show the feasibility of isolating scripts in separate
executionenvironments.
•We evaluatetheeffectiveness,compatibilityand theperfor-
mance overhead of JSIsolate on real world websites, and
demonstratethe practicalityofour design.
2 OVERVIEW
Inthissection,wefirstintroducethebackgroundknowledge( ğ2.1),
we then describe the motivating examples of our design ( ğ2.2), and
finally discuss the researchchallenges ( ğ2.3).
Main Frame
postMessage
 Script A
DOM #1
Script B
Context #3Context #1
 Context #2
Script C Script D
DOM #2Figure 1:Asimplified browser architecture.
2.1 Background
JavaScript Execution Environment in the Browser. The high-
levelarchitectureofawebbrowserisdepictedin Figure1.Inmodern
webbrowsers,abrowsingcontextiscreatedforeachopenedtab,
andcanbenestedusingiframes[ 39].Eachframe(themainframeor
an iframe) has its own window object, and the cross-window com-
municationisusuallyaccomplishedviathe postMessage interface.
The browsing context encloses theweb content to be displayed to
theusers.ItalsoincludesaJavaScriptexecutionenvironment,in
whichJavaScriptcodeis interpretedandexecutedonaJavaScript
engine.Scriptsincludedinthesameframeruninasingleexecution
context.Asa result, a script can accessany globalobject defined
byanotherscript that resides inthe same frame.
Security Policies in the Browser. The Same-origin Policy (SOP)
[40]specifiesthataframeinoneoriginshouldnotbeallowedto
access the resources in a different origin, which is recognized as a
tuple of scheme ( e.g.,https:// ), host name ( e.g.,xyz.com) and port
number ( e.g.,443). It prevents cross-frame script access, but still
permits intra-frame script access or interference. The Cross-origin
resourcesharing(CORS)relaxestheSOPbyallowingarestricted
setofresourcesfromoneorigintobeaccessedbyanotherorigin
[38].Itenablesthedeveloperstoembedcross-originresources, e.g.,
imagesandvideos,inamore flexibleway.
TheContentSecurityPolicy(CSP) allowsdeveloperstospecify
theoriginsofresourcesthatarepermittedtobeloadedonawebsite
[37]. It is designed to mitigate the cross-site scripting (XSS) attacks
and other content injection attacks. However, it has suffered from
misconfiguration of developers and its static nature, and therefore
receivesonlyalowadoptionrateontheweb[ 5,6].Comparedwith
CSP, scriptisolation provides a more flexible approach tolimiting
privilegesofscripts to interfere witheachother.
TheSubresourceIntegrity(SRI)[ 41]wasintroducedasaW3C
recommendationtoprotectdataintegrityduringthenetworktrans-
mission. Adevelopercan specifyan integrity attribute,which
is a cryptographic hash value, with an external resource such as
ascriptorastylesheet.Thebrowser,uponfetchingtheresource,
wouldthenvalidate thehash valueto ensure theresourcehasnot
been tampered with. However, the SRI cannot protect JavaScript
objects from being overwritten by other scripts already running in
the same frame.
2.2 Motivating Examples
Global Identifier Conflicts. The use of a shared namespace
grantsscripts the privilegeto redefine globalobjects ( i.e., functions
orvariables)definedbyotherscripts.Suchanoverwritecouldresult
194JSISOLATE:LightweightIn-Browser JavaScript Isolation ESEC/FSE ’21, August 23–28, 2021,Athens,Greece
1/* ocanvas.js */
2(function(a,b,c) {a.logs= []; //array })(window, document);
3
4/* aframe.js */
5window.logs=function(e) {...}; // function
6
7/* client.js */
8logs.push('log'); // runtime TypeError
Listing 1: An example of conflicting variable definitions
between JavaScript libraries.
1/* a.js */
2RegExp.prototype.test=function() {returntrue; }
3
4/* client.js */
5if((/https?:/i).test(...)) { // security check evaded }
Listing2:PollutingJavaScriptprototypetobypasssecurity
checks.
indisruptivebehaviors,consequentlyimpairingthereliabilityof
web applications. One such case is discussed in [ 24], where two
JavaScript libraries define window.logs with values of different
types.Asshownin Listing1,whentheselibrariesareincludedin
aspecificorder,aruntimeexceptionwouldbethrownbecauseof
inconsistent types. Similar examples are also presented in [ 44],e.g.,
theglobalfunction addHTML() isdefineddifferentlybytwoscripts,
whichcauses differentHTMLcontentsto be injected.
Prototype Poisoning Attacks. Each JavaScript object has an
associated prototype object, from which it inherits its properties
andmethods.JavaScriptprototypeallowsdeveloperstoeasilyde-
fine properties and methods on all the objects initiated from the
same constructor. However, it can also be overwritten and cause
undesired effects. One such vulnerability was reported on MyVi-
doop, which is a bookmarklet-based password manager [ 2]. As
shown in Listing 2, MyVidoop uses a simple regular expression
/https?:/i tocheckifaURLstartswith‘http’or‘https’.However,
the regular expression is evaluated at the client side, and therefore
is subject to prototype poisoning attacks. Once the native function
RegExp.prototype.test() isoverridenasshown,thesecurity
checkwould bebypassedand makethe bookmarkletsusceptible
to XSS attacks. This demonstrates the unexpected interference
between first-party and third-party code makes it hard for web
applicationsto reliably perform the intendedfunctionalities.
Therootcauseoftheaboveproblemsistheuseofasinglecontext
(i.e., namespace) in the browser. Any (not necessarily malicious)
scriptcanpotentiallyinterferewiththeexecutionofallotherscripts
executedinthesamecontext.Thisindicatestheneedofanisolation
mechanism that runs scripts with independent functionalities in
separatecontexts,suchthatscriptscannotinterferewiththeobjects
andcode inthe otherexecutionenvironments.
2.3 Research Challenges
We face the following challenges inisolating client-sidescripts.
Context Assignment. Scripts included in the same frame usually
depend on each other to accomplish their tasks. For example, a
script may call jQuery methods to facilitate DOM manipulation
and event handling. It is non-trivial to determine the context in
whichascriptshouldbeexecuted.Separatingscriptsdependingon
eachotherwouldbreakthefunctionalityofawebsite.Inparticular,
some scripts, e.g., library scripts, might be required for multiple
https://www.example.com
https://www.example.comDependency
Analysis
Script A: write, foo
Script B: read, bar
<script> foo = 1; </script>
<script> if (bar) ... </script>Global Context
<script> 
foo = 1; 
</script>Context #1
Script A: context #1
Script B: context #2
Domain
Relationship
List
Context #2
<script>
 if(bar) ...
</script>
Figure 2:Overview ofJSIsolate.
functionalities.We need a way toprecisely assignscriptstoappro-
priatecontexts.Further,JavaScriptcodecanbedynamicallyloaded.
Itisinsufficientto staticallydeterminethe contextfor eachscript.
Coverage. There are many ways to execute JavaScript code in
the browser. Except for the inline and external scripts included
via<script> tags, JavaScript code can also be loaded through
JavaScript URLs, inline event handlers and the eval()function,
etc.For example, when a user clicks on an anchor element <a
src=’javascript:alert("clicked")’>,themethod window.alert() will
be invoked. In order to capture and isolate all the code executed
inthebrowser,weneedtocoveralltheabovecases,whichisdif-
ficult.JavaScriptURLscanbedefinedwithvarioustypesofDOM
elements,whichcould alsobedynamicallycreatedbyotherscripts.
Similarly, the inline event handlers can be registered and modi-
fiedbymultiplescripts.Therefore,weneedtopreciselytrackthe
creation andmodificationof any JavaScript code.
Deployability. Many existing works ( e.g., [19,33,42]) sandbox
scripts in iframes to provide an isolated execution environment.
Thesemechanismsrequiremanymodificationstotheoriginalpage,
andextraeffortsmustbemadetohandlethecross-frameinteraction,
especiallyoneventforwardingandcontentrendering.Weaimto
developa system that requiresminimal changeson theweb pages
and minimizes the performance overhead to lower the deployment
difficulty,whichischallenging.
3 DESIGN AND METHODOLOGY
In this section, we present JSIsolate , a browser-based framework
that isolates scripts in separate execution contexts. We consider in
our design two execution contexts: a first-party context for scripts
serving first-party functionalities, and a third-party context for
scriptsprovidingotherindependentfunctionalities.Nevertheless,
morecontextscanbecreatedforprovidingafiner-grainedisolation
mechanismwhenfeasible.Weassumethatscriptsfromdifferent
entities are not related and shall be separated. The overview of
JSIsolate isdepictedin Figure 2.
JSIsolate determines the execution contexts of scripts based
ontheirdependencyrelationship. Adomainrelationshiplist that
groupsdomainsbelongingtothesameentity,isusedastheground
195ESEC/FSE ’21, August 23–28, 2021,Athens,Greece Mingxue Zhang andWeiMeng
truth. It is maintained by Disconnect [ 25], which is a tracker block-
ingapplication.For instance, facebook.com andfb.meare bothin
group łFacebookž. JSIsolate considers two situations when han-
dling context assignment for a script. First, both the script domain
andthewebsitedomainareonthislist.Ifthescriptandthewebsite
are in the same group, it is executed in the first-party context; else
if it is statically included, it is isolated in the third-party context to
prevent cross-entity interference; otherwise, it is assigned to the
context of its initiator script. Second, the website/script domain
is not on the list, i.e., the ground truth is unavailable. JSIsolate
analyzes the object dependency between a statically included third-
party script with the first-party scripts and assigns the context
accordingly;andexecutesa dynamicallyincluded third-partyscript
in the same context as the initiator script. With such a strategy,
JSIsolate allows the dependent scripts (including the dynamically
loaded ones) to function correctly, while prohibiting cross-context
interference throughdynamicscript inclusion.
In the following, we describe our design using the Chromium
browserasanexample.Specifically,weshowhow JSIsolate records
JavaScriptobjectaccessestoanalyzedependency( ğ3.1),andhow
it tracksthe dynamic inclusion ofa script( ğ3.2). We then describe
ourmethodologytogeneratetheisolationpolicies( ğ3.3).Finally,
wedemonstratehow JSIsolate createsseparateexecutioncontexts
basedonthe policies ( ğ3.4).
3.1 Recording JavaScriptObject Accesses
Readingandwritingobjects( i.e.,functionsandvariables)defined
in each otheris the most explicit evidence of the dependency rela-
tionship between scripts. For instance, a script relying on a cookie-
managementlibrary scripttoadd/removecookies wouldusually
call (i.e., read) cookie-related functions defined in the library script.
JSIsolate aimstorecordanyaccesstotheobjectsdefinedbyany
script to determinethe dependency relationship.
IntheChromiumV8JavaScriptengine,everyJavaScriptobject
is represented as an instance of the Objectclass, which could have
multiple properties. For instance, a global function foois repre-
sented aswindow.foo , which is a property of the windowobject.
Therefore,tointerceptall theaccessestoobjects, JSIsolate moni-
torsthegetterandsettermethodsofthe ObjectpropertiesinV8,
fromwhich itcan get the names of objects and properties being ac-
cessed.However,variablesofnon-primitivetypearecopied/passed
byreferenceinJavaScript,thusscriptsdonotnecessarilyneedto
accessanobjectusingthesamename.Forexample, objY = objX
makes variableobjYan alias of object objX, and any script can
thereafteraccess objXviaobjY.In particular,the keyword thisin
JavaScript points to different objects when used in different scopes.
Forexample,whenaccessedinanobjectmethod, thisreferstothe
owner object, and when used in a normal function scope, it points
to the global object window.JSIsolate uses the memory address of
the accessed object in V8 to uniquely identify an object. As long as
an identifier points to the same object, the memory address will be
the same,regardless ofthe variable name being used.
For each write operation to an object property, which is accom-
plishedbyinvokingthesettermethod, JSIsolate alsorecordsthe
value to be assigned to the property. Once an access to an object
isintercepted,itfurtherinspectsthecurrentJavaScriptcallstackto locate the bottom script as the script that initiates the access.
JSIsolate recordsthescriptID ofascriptasitsuniqueidentifier.
Note that the declaration of a global function or variable is also
representedasawriteoperationtotheglobalobject window.There-
fore,JSIsolate is able to capture all the declarations and write
operations to the objects that might be referenced by other scripts.
Forread operations,however, JSIsolate recordsthe readtoob-
jects but not the read to their named properties. We make this
design choice to mitigate the prototype poisoning attacks. If a
script overwrites a prototype object, e.g., by adding new properties
oroverwritingbuiltinmethodsthatarelateraccessedbyanother
script,JSIsolate does not record the read to the overwritten prop-
erties/methods;otherwise,thetwoscriptswouldbeconsideredas
dependent, allowing the prototype to be poisoned. For example,
whenowner.property isbeingreadbyscript A,JSIsolate onlylogs
a read toowner. This does not affect our ability in capturing object
dependenciesbetweenscripts.Wewilldemonstratethedetailswith
our dependency analysisin ğ3.3.
3.2 TrackingDynamicScriptInclusion
TherearemanywaystoincludeJavaScriptcodeinawebpage.First,
ascriptcanbeloadedvia <script> tags,eitherasaninline(embed-
dedaspartoftheHTMLcode)oranexternal(loadedfromanexter-
nalJavaScriptfile)script.The <script> tagscanalsobedynamically
created by other scripts via document.createElement("script") ,
etc.Second,JavaScriptcodecanbedefinedasanattributeofaDOM
element,e.g.,asaJavaScriptURLoraneventhandler.Inbothcases,
theattributecanbemodifiedbyJavaScriptaftercreation.Inaddi-
tion, by callingeval(), a string will be executed as JavaScript code.
WeneedtohandleallthepossiblecasesthatJavaScriptcodecan
be loadedinawebpage.
3.2.1 HTML Script Elements. A script can create new <script>
elements by calling APIs like document.createElement("script")
anddocument.write("<script src=...></script>") , or directly
setting theouterHTML attribute of an existing element to replace
it witha scriptelement. Alternatively,a script canalso injectnew
scripttagsviainnerHTML ,e.g.,byreplacingtheinnercontentofa
<div>element with "<script>...</script>" .
JSIsolate monitorsalltheaboveAPIsinthebrowsertofindthe
scriptthatcreatesascriptelement.EachtimesuchanAPIiscalled,
JSIsolate locatesthescriptthatinitiatestheAPIcallatthebottom
JavaScriptcallstackframe,andrecordsthecorresponding scriptID
as its unique identifier. JSIsolate also intercepts any access to the
outerHTML andinnerHTML attributestotrackthereplacementofex-
istingelements.The parentScriptID attributeÐthatisinitializedas
nullÐofadynamicallycreatedscriptelementissetasthe scriptID
of the initiator script. In this way, it can attribute the dynamic cre-
ation ofany<script> element to a specificscript. Thisallows us
todifferentiatebetweenscriptelementscreateddynamicallyand
thoseinsertedstaticallybydevelopers.
3.2.2 JavaScript URLs. In the browser,JavaScript URLs could be
definedwithmultipletypesofDOMelements.Welistthetagnames
andthecorrespondingattributesin Table1.Theseattributescan
bestaticallydefinedbythewebdevelopers,ordynamicallydefined
and modified by scripts. For example, a script can modify the href
196JSISOLATE:LightweightIn-Browser JavaScript Isolation ESEC/FSE ’21, August 23–28, 2021,Athens,Greece
1// #1: modifying on-event attribute
2a.onclick=function() {console.log('clicked'); }
3
4// #2: calling addEventListener()
5a.addEventListener ('click',function() {console.log('clicked')
;})
6
7// #3: creating elements with an inline event listener
8document.write('<a onclick=function(){...}></a> ');
Listing 3:3 waysto register eventlisteners on an element.
attributeofananchorelementinvariousways.Firstly,ascriptsets
thehrefattribute of an anchor element ato a JavaScript URL by
callinga.setAttribute(‘href’, ‘javascript:url’) .Ascriptcan
also assign a newvalue to hrefthrougha.href=‘javascript:url’
ora.attributes[‘href’]=‘javascript:url’ . Moreover, a script
candirectlycreateanewanchorelementwitha hrefattributein
the same wayas itcreates script elements.
JSIsolate hooks all the DOM APIs that could be used to modify
theattributesin Table1.Specifically,itassignsan nidattributeasa
uniqueIDtoeachDOMelement.Everytimeaninvocationtothese
APIsisintercepted,itchecksiftheattributevalueisaJavaScript
URL. If so, it identifies the scriptID of the accessing script, and
updates a map from nidtoscriptID to keep track of the script
thatlastmodifiesthecorrespondingattributeofaDOMelement.
The dynamiccreation ofelements in Table 1are monitoredinthe
same way as described in ğ3.2.1.JSIsolate specifically records the
scriptID astheinitiator attributeoftheseDOMelements.When
any of these elements is created, JSIsolate records thenidand
initiator inthe mapif the attribute isaJavaScript URL.
3.2.3eval().InJavaScript,eval()isacommonlyusedfunction
that evaluates the argument string as JavaScript code. The code
generated byeval()is granted the same privilege as the caller
function, thus can also overwrite other scripts. Fortunately, the
code generated by eval()is intrinsically executed in the same
context as the caller script. Therefore, a script cannot escape the
contextassignedto itbygeneratingnewcode via eval().
3.2.4 JavaScriptEventListeners. Insteadofcalling eval()andcreat-
ing/modifying<script> tagsandJavaScriptURLs,ascriptcanalso
registeraneventlisteneronanHTMLelementtointroducenew
JavaScriptcode. Theeventlistener isa JavaScriptcodesnippetthat
willbeexecutedwhenthecorrespondingeventisfired.Specifically,
ascriptcanregisteraneventlistenerby:1)modifyingtheon-event
attributes of a DOM element; 2) calling the addEventListener()
APItoaddanewevent listener;or3)directly creatingan element
with an inline event listener (see Listing 3). Fortunately, JSIsolate
does not need to monitor JavaScript event listeners specifically,
becausetheyare registered in thesameJavaScriptexecution envi-
ronment as the scripts registertheminChromium.
3.3 Generating IsolationPolicies
In this section, we describe our method to determine the object
dependency between scripts and generate script isolation policies
according to the objectdependency.
3.3.1 ObjectDependency. JSIsolate identifiesdependentscripts
based on the JavaScript object access logs. There are four possibili-
ties that twoscripts can read orwritethe same object.•Readafterwrite(RAW) :onescriptwritesanobjectandanother
script reads itafterwards.
•Readafter read (RAR) : one script reads an objectand another
script alsoreads itafterwards.
•Writeafterwrite(WAW) :one script writesanobject and after
that, anotherscript alsowritesit.
•Write after read (WAR) : one script reads an object and after
that, anotherscript writesit.
We consider a script depends on another if we detect a RAW
condition. The RARandWARconditions, however,do not neces-
sarily suggest direct object dependency, although the scripts are
alsoaccessingthesameobject.Forexample,supposescriptAreads
an object after script B reads it. In this case, both scripts directly
depend on another script C that defines or declares that object.
Further,the WAWconditionindicatesaconflictingwritethatcould
impairthecodereliability. JSIsolate reportsanydetectedconflicts
to the developers to help them adjust the generated script isolation
policies when necessary.
Recallthat JSIsolate doesnotrecordreadstonamedobjectprop-
erties, which still allows it to capture all dependencies. First, when
thereisa RAWonanobject, JSIsolate cancapturethedependency
asitrecordsallthereadsandwritestoobjects.Second,whenthere
isaRAWonanamedproperty ( e.g.,Areadsapropertywritten by
B),bothAandBhavetofirstlygetareferencetotheownerobject.
If the owner object is defined by B, there is a RAWon the owner
object whereAreadsB; if the owner object is defined by another
scriptC, bothAandBwill be considered as dependent on Cas they
bothreadanobjectdefinedby C.Inaprototypepoisoningattack,
however,theprototypeobjectisnotexplicitlydefinedbyanyscript
thus no dependency will be captured. Therefore, the attack can be
mitigatedas the poisonedprototype can be isolated.
3.3.2 Context Assignment. To determine the context of a script,
we first classify scripts into three categories based onhow they are
loadedinawebpage:
•First-partyscripts :scriptsthatareincludedfromthefirst-party
domain,includinginline scripts written bythe developer;
•Static third-party scripts : scripts that are statically included
from athird-partydomain;
•Dynamicthird-partyscripts :third-partyscriptsthataredy-
namically includedbyanotherscript.
We assume that the first-party scripts serve the first-party func-
tionalities.Wedeterminethecontextofa staticthird-partyscript
based on the ground truth domain relationship list and whether its
functionalityrelatestofirst-partyfunctionalities.The staticthird-
party scripts can be further divided into three classes: 1) scripts
loaded from domains belonging to the first-party entity; 2) scripts
thatreadorarereadby first-partyscripts ;3)scriptsthatdonothave
objectdependencywith first-partyscripts .Scriptsofthefirsttwo
classes are functionality-dependent with first-party scripts and are
putinthefirst-partycontext.Thedependencyis transitive ,there-
fore, a third-class script that has dependency with a script in the
first two classes is also executed in the first-party context. The rest
staticallyincludedscriptsshallbeexecutedinaseparatecontext,
as theirfunctionalities are independent from the first-partyones.
A static third-party script could intentionally read objects de-
finedbyafirst-partyscripttogetitswayintothefirst-partycontext.
197ESEC/FSE ’21, August 23–28, 2021,Athens,Greece Mingxue Zhang andWeiMeng
Table 1:DOM attributes that could include JavaScript URLs.
Tagname Attribute Example InvokeCondition
anchor href <a href=’javascript:alert("anchor clicked")’></a> Click
area href <area shape="rect" coords="0,0,82,126" href=’javascript:alert("area clicked")’> Click
button formaction <button formaction=’javascript:alert("button clicked")’>Click</button> Click
form action <form action=’javascript:alert("form submitted")’ method=’get’> Submit
iframe src <iframe src=’javascript:alert("iframe loaded")’></iframe> Load
input formaction <input type=’submit’ formaction=’javascript:alert("input clicked")’/> Click
Consequently, not only the static script itself but also any dynamic
scriptit includes would be capableto make arbitrary accessto the
first-partyobjects.Nevertheless,itisverydifficult,ifpossible,to
exclude these intentional accesses without the knowledge of the
intendedfunctionalitiesofeachscript.Therefore,werelyonthede-
veloperstovalidateandadjustthecontextassignedtostaticscripts.
Todothat,wealsosummarizethecross-scriptreadsthatleadtothe
context assignments. This helps the developers with the validation,
which is described at length in ğ3.3.3. We will demonstrate in ğ5.3
that the number of scripts that need a manual inspection is limited,
and they make a moderate number of cross-script reads. Therefore,
it is practical for the developers to validate the isolation policies to
prevent such scripts from being executed in the first-party context.
In ordertoprevent scriptsfrom escaping itscontextby dynam-
icallyinjectingotherscripts,weexecutethe dynamicthird-party
scriptsinthesamecontextasthescriptthatcreatesthem,unless
thedynamicscriptsareloadedfromadomainthatbelongstothe
first-party entity. In particular, JavaScript URLs are executed in the
contextwhere the scripts that last setthemare executed.
JSIsolate maintainsacontextid attributewitheveryscriptina
webpage,whichisauniqueIDofthecontextassignedtothescript.
Bydefault,thescriptsaredividedintotwogroups,witha contextid
of ł1ž for scripts implementing first-party functionalities and ł3ž
for the other scripts. In the following, a context with contextid of
ł1ž and ł3ž are called a first-party context andthird-party context ,
respectively. One special case is library scripts, e.g., jQuery, which
might define objects that are read by scriptsinboth contexts. In or-
dertopreservethefunctionalitiesofsuchlibraryscripts, JSIsolate
in particular sets the contextid attribute of them as łbothž. It then
loads a copy of these scripts in both the first-party and third-party
contexts. Note that the developers can also configure the isolation
policies to separate scripts inafiner-grainedmanner.
Anexample. Consider the HTML page in Listing4,which con-
tainsananchorelementandthreestaticallyincludedscripts.Inthe
following, we call the scripts A (L4), B (L5) and C (L6), respectively.
Script B depends on script A, as B calls function myFuncdefined by
A in line 11. Therefore, A shall be executed in the same context as
B, which is a first-party script. Script A also creates another script
Dinline12,whichwillbeexecutedinthesamecontextasA.Script
BandCbothmodifythe hrefattributeoftheanchorelementby
assigningdifferentJavaScriptURLstoit.AsscriptCistheonethat
lastmodifiesthe attribute,the JavaScript URLshall be executedin
the same context as C. Similarly, the click event listener registered
by script C in line 22 shall be executed in the same context as C. In
summary,the contextassignedto eachscript isas follows.
•First-partycontext: script A,BandD.
•Third-partycontext:scriptC,JavaScriptURLinline20andevent
listenerinline22.1<html>
2<body>
3<a id="anchor1">Click Me</a>
4<script src='https://www.lib-1.com/a.js '></script>
5<script src='https://www.example.com/b.js '></script>
6<script src='https://www.lib-2.com/c.js '></script>
7</body>
8</html>
9
10/* a.js */
11function myFunc () {return{}; }
12document.write("<script>alert(\"new script\");<\/script>" );
13
14/* b.js */
15var myObj=myFunc();
16document.getElementById ("anchor1").href='javascript:alert("
second script") ';
17
18/* c.js */
19var myAnchor =document.getElementById ("anchor1");
20myAnchor.href='javascript:alert("third script") ';
21myAnchor.click();
22myAnchor.onclick=function() {alert('event listener ')};
23myAnchor.click();
Listing 4:HTML page https://www.example.com.
NotethatwedonotgeneratepoliciesforscriptD,theJavaScript
URLandtheeventlistenerintheaboveexample,astheyaregener-
ated on-the-fly by script Aand C.Rather, thedynamic creation of
thesescript code are trackedby JSIsolate ,which will determine
the contextfor themaccording to the initiator scripts.
3.3.3 Isolation Policies. JSIsolate creates an isolation policy for a
webpagebasedonthepreviousdependencyanalysis.Oncefinal-
ized,thepolicy canbe sentwiththepagesource HTMLcode( e.g.,
liketheCSPheader)toinstructthebrowsertoenforcethepolicy.
Inadditiontothecontextassignedtoeachscript, JSIsolate alsoin-
cludes in the policies necessary auxiliary information, which helps
the developers understand and adjust the policies. In the following,
we describe the auxiliary information we report inthe policies.
Tofacilitatetheinterpretationandenforcementofisolationpoli-
cies, for each statically included third-party script, JSIsolate re-
ports in the policy its script source URL and the corresponding
contextid .Atenforcementtime, JSIsolate willthendeterminethe
context for each third-party script by matching the URL. However,
the script sourceURL mightcontain random strings, whichcould
change frequently. For example, website https://chaturbate.com in-
cludes multiple scripts from ssl-ccstatic.highwebmedia.com , which
have almost the same URLs except for a random suffix. In order to
fixthis,JSIsolate alsoperformsanapproximatematchonscript
URLs,whichwedescribein ğ4.Meanwhile,asstaticallyincluded
inline scripts are all by default considered as first-party scripts,
JSIsolate does not include them in the isolation policies but di-
rectlyexecutestheminthefirst-partycontext.Notethatawebpage
maycontainmultipleframes, i.e.,amainframeandmultipleiframes.
Ascriptmightbeincludedinboththemainframeandiframes,and
could be assigned different contexts in different frames. In order
198JSISOLATE:LightweightIn-Browser JavaScript Isolation ESEC/FSE ’21, August 23–28, 2021,Athens,Greece
1{
2"https://www.example.com" : [
3{
4"match":"https://www.lib-1.com/a.js" ,
5"context":"1",
6"read": [],
7"read by": [["myFunc","B"]],
8"ID":"A"
9},
10{
11"match":"https://www.example.com/b.js" ,
12"context":"1",
13"read": [],
14"read by": [],
15"ID":"B"
16},
17{
18"match":"https://www.lib-2.com/c.js" ,
19"context":"3",
20"read": [],
21"read by": [],
22"ID":"C"
23}
24]
25}
Listing 5:Isolationpolicy ofhttps://www.example.com.
to distinguish the scripts included in different frames, JSIsolate
furthergroupsthe policiesbasedonthe URLof the frameinwhich
thescriptsareincluded.Wealsoperformanapproximatematchon
frame URLs, as they may contain random strings. Details are in ğ4.
To help the developers understand and adjust the isolation poli-
cies,JSIsolate furtherincludesalistofreadoperationsthatleadto
thedecision ofthecontextforstatic third-partyscripts.Each read
operationisrepresentedasareadtargetandtheuniqueIDofthe
script that definesthe read target.
Listing 5 presents the isolation policy generated for scripts A,
BandCin Listing4.WeincludescriptBheretodemonstratethe
auxiliaryinformationgeneratedforwebdevelopers.Inpractice,we
do not generate policies forstatic first-party scripts as they are all
executedinthe first-partycontext.
3.4 CreatingIsolationEnvironments
JSIsolate leveragesthe isolatedworld sintheChromiumbrowser
to isolate JavaScript in separate contexts. In order to isolate con-
tent scripts from browser extensions, Chromium executes content
scriptsfromeachextension inan isolated world ,while thenormal
scriptsfetchedfromthewebareexecutedinthe mainworld .The
isolated world is a concept in V8 binding and is used to isolate
theglobalvariablescopesandDOMwrappersforeachextension.
Scriptsinanisolatedworlduseaseparatevariablescopeandpro-
totype chain. Meanwhile, each isolated world has its own DOM
wrapper while sharing the same underlying C++ DOM object. The
eventlistenersregisteredbyscriptsinoneisolatedworldwillbe
executedinthe contextofthat specific world.
JSIsolate is inspired by the idea of confining content scripts
in isolated worlds. It creates an isolated world for each context
using thecontextid specified intheisolation policies,andinjects
the corresponding JavaScript code in the world. As the interaction
betweendifferentworldsisprohibitedbythebrowser,thescriptsin
oneworldcannotinterferewithscriptsinanotherworld.Also,they
cannot escape their worldsbyinjectingotherJavaScript code, e.g.,
byregisteringeventlisteners,becausescriptsindifferentworlds
work ondifferentDOMwrappers.4 IMPLEMENTATION
Weimplementedaprototypeof JSIsolate intheChromiumbrowser
(version 71.0.3578.98)using around2K lines ofC++code.We plan
to open sourceour prototype implementation.
We implemented an IsolationInjectionHost object to inject
scripts in different isolated worlds. We added several custom at-
tributes ( e.g.,nid,initiator ,parentScriptID andcontextid ) in
the Blink rendering engine to recordthe creation relationship and
theexecutioncontextassignedtoeachscript.Thecustomattributes
are not exposed toV8, therefore cannot be modified byJavaScript.
We used the gremlins.js1library to perform a monkey testing
after a full page loading. The library emulates real user visits by
performingrandominputs,scrollsandclicksonapage.Thisallowed
us to trigger as much JavaScript code as possible and consequently
capture more dependencies inan automatedyetscalablefashion.
ParsingandEnforcingIsolationPolicies. Ourprototypeparses
ascriptisolation policyfilewhenitstartstoloadapage.Weplan
to implement a new HTTP header to enclose the isolation policies
inourfuturework.WhenparsingandrenderingtheHTMLpage,
itloads ascript inan isolatedworld according to the policy.
JSIsolate generatesscriptisolationpoliciesattwogranularities:
domain-level and URL-level. Whenusing the domain-level policies,
itmatchesscriptsusingonlythedomainname.Ifanyscriptfrom
onedomainisassignedtothefirst-partycontext, JSIsolate loads
all scripts from that domain in the first-party context. We adopt
suchanapproachbecausescriptsfromthesamedomainareusually
writtento cooperatebythe samedeveloper.As scriptURLsmight
containrandomstrings,thisalsohelpstoeliminatethemismatches.
WhenconfiguredtousetheURL-levelpolicies, JSIsolate matches
eachstaticscriptagainstthepolicyusingthewholeURL.Specifi-
cally, to tacklewiththe random script URLs, JSIsolate matches a
script/frame in two modes, i.e., the strict and loose matching mode.
Inthestrictmatchingmode,amatchisfoundiftheURL(excluding
thefragment)ofanexternalscript/frameispresentinthepolicy.
Whennomatchisfound, JSIsolate switchestotheloosematching
mode, where itperforms a character-by-character comparison un-
der the constraint that the domain names should be the same. The
upperboundofdifferent character ratioinscript/frameURLswas
selected as 0.15, whichwas determined based on our experiments
onreal-worldwebsites.Nevertheless,thedevelopersoruserscan
configure adifferentthreshold.
Developerscouldconfigure JSIsolate toenforcepoliciesinei-
ther level according to their preferences. We will discuss in ğ5how
differentpolicygranularities affectthe compatibilityof JSIsolate .
Notethat if there is no exactor approximate matchfor a script,
JSIsolate assignsafallbackcontextforit.In ğ5.3,wewilldemon-
strate how different choices of fallback context affect the compati-
bilityofJSIsolate onreal-worldwebsites.Insomecases, JSIsolate
mayfailtofindamatchfortheembeddingframeURLandtherefore
cannotlocatetheisolationpolicies. JSIsolate executesallscriptsin
thatframeinthefirst-partycontextforcompatibilityconcerns.Ina
realdeployment,thepolicieswillbeincludedinanHTTPresponse
header (see ğ6), which would avoid the mismatches on embedding
frameURLs.Toaccuratelymeasuretheoverheadandcompatibility
in our current evaluation, we disabled script isolation in iframes.
1https://github.com/marmelab/gremlins.js
199ESEC/FSE ’21, August 23–28, 2021,Athens,Greece Mingxue Zhang andWeiMeng
Table2:Contextassignmentresults(#scripts/#websites)of
static third-partyscripts.
w/groundtruth w/ogroundtruth
URL-level 12,516/ 960
3rd-party context 2,437/ 544 2,696/ 568
1st-party context 10,009 / 889 9,742/ 888
Bothcontexts 70/ 56 78/ 62
Domain-level 12,516/ 960
3rd-party context 1,600/ 464 1,621/ 469
1st-party context 10,879 / 889 10,858 / 888
Bothcontexts 37/ 33 37/ 33
Nonetheless, the developers can easily deploy JSIsolate to isolate
scripts inallframes.
5 EVALUATION
In this section, we first describe our analysis on script dependency
relationshipofpopularwebsites( ğ5.1).Wethenpresenttheeval-
uation,answeringthefollowingquestions:1)Whether JSIsolate
can improve client-side JavaScript reliability ( ğ5.2); 2) Whether
JSIsolate is compatible with real-world websites ( ğ5.3); and 3)
Whatthe performance overheadof JSIsolate is(ğ5.4).
5.1 Dependency Analysis
AmongtheAlexatop1Kwebsitedomains,142arepresentonthe
domain relationship list. On these websites, if the script domain is
alsoonthelist, JSIsolate determinesexecutioncontextforitbased
onthedomaindependenciesinthelist.Fortheotherscriptswhose
domainsarenotonthelist, JSIsolate analyzesscriptdependencies
as described in ğ3.3. For instance, domain yimg.com belongs to the
same entity Yahoo! as yahoo.com , butgstatic.com does not. There-
fore,script https://s.yimg.com/.../tdv2-wafer-featurebar.js wasas-
signedtothefirst-partycontextonwebsite https://www.yahoo.com ,
whilescript https://www.gstatic.com/.../firebase.js wasisolatedin
the third-partycontext.
We also used JSIsolate to collect the JavaScript object access
logs on Alexa top 1K websites for analyzing the script dependency.
Excluding inaccessibleand timeoutedwebsites, we gatheredvalid
log files on 978 websites. The logs and the automatically generated
isolationpoliciesareavailableat https://zenodo.org/record/4892853 .
Intotal,weobserved12,516staticthird-partyscriptson960web-
sites. We analyzed the access logs and generated URL and domain-
level isolation policies. We also compared the results with and
withoutthedomainrelationshiplist,andfoundthelisthelpedto
identify more scripts that belong to the first-party organization on
72 (resp. 11) websites in the URL-level (resp. domain-level) policies.
For example, on website https://vimeo.com , a static script from
vimeocdn.com wouldbeassignedtothefirst-partycontextwiththe
list as ground truth. We list the context assignment results of static
third-party scripts in Table 2. All static scripts from the first-party
domainare executedinthe first-partycontext.
InFigure3,wevisualizethedependencyrelationshipbetweenall
staticallyincludedscriptsonthewebsite https://www.rakuten.co.jp .
Numbersingreycirclesarethe scriptID ofstaticfirst-partyscripts,
whichareexecutedinthefirst-partycontext.Thewhitecirclesrep-
resentotherscriptsstaticallyincludedfromathird-partydomain.
Figure 3: Script dependency relationship on
https://www.rakuten.co.jp.
An arrow from A to B indicates some object(s) defined by B is
readbyA.Asshown,script 48definedaglobalobject googletag ,
which was read by script 74viagoogletag.fifWin . Specifically,
script74and48werestaticallyincludedfromathird-partydomain
googletagservices.com and the first-party domain rakuten.co.jp , re-
spectively.Inthiscase,script 74and48wereapparentlydependent.
Therefore, we assigned 74to the first-party context. In contrast,
scripts17and154were put inthe third-party context because they
didnothavedependencywithanyscriptsinthefirst-partycontext.
Note that a jQuery script 25read objects defined by script 79,
168and183. We believe script 25is a customized jQuery script
that reliedonotherscripts to achieve its functionalities. As itwas
alsoreadbyfirst-partyscripts, JSIsolate loadeditinthefirst-party
context.Asaresult,scripts 79,80and168werealsoexecutedinthe
first-party context, as they all called the jQueryfunction defined
by25. Script183was read by both 25and the first-party script 149.
Thus itwasalsoexecutedinthe first-partycontext.
Wealso detectedonwebsite https://www.tribunnews.com one
staticscript https://www.gstatic.com/firebasejs/5.5.6/firebase-app.
jsthatwasreadbyanotherstaticscript Afromcdn-3.tstatic.net .As
scriptAreadmultipleobjectsdefinedinascriptfromthefirst-party
domain,weclassified Aasafirst-partycontextscript.Meanwhile,
scriptfirebase-app.js was also read by multiple scripts that did
not have any functional dependency with first-party scripts. We
therefore treated these scripts as third-party scripts. Since firebase-
app.jsdid not read any script and was read by both first-party and
third-partyscripts, we assigneda contextid of łbothž to it.
5.2 Reliability Improvement
Weevaluatetheeffectivenessof JSIsolate inmitigatingthereliabil-
ity problems describedin ğ2using several webmashupexamples.
Avoiding Global Object Overwrites. For the global identifier
conflict in Listing 1, as the libraries are not expected to interact
witheachother, JSIsolate naturallyrunthemindifferentcontexts.
Althoughclient.js will be automatically recognized as depen-
dentonaframe.js ,JSIsolate willreporttheconflictingwritesto
developers,whohavesufficientknowledgetodeterminewhether
aframe.js shallbe allowedto overwrite ocanvas.js .
Further consider the example in Listing 6, where two scripts as-
signvaluesofdifferenttypestothesameglobalidentifier dropdown .
As the external script redefined dropdown as a boolean value, a
200JSISOLATE:LightweightIn-Browser JavaScript Isolation ESEC/FSE ’21, August 23–28, 2021,Athens,Greece
1function dropdown () {...} // a.js
2
3var dropdown =false; // b.js
4
5if(dropdown()) {...} // client.js: Runtime TypeError
Listing 6:Anexample ofconflictingvariable definitions.
calltoitwouldcauseruntimeexceptionsandmayleadtoDenial-
of-Service (DoS). Similarly, givenknowledge of detected conflicts,
developers may decide whether b.jsshould run in a separate exe-
cutioncontext. Therefore, JSIsolate effectively avoids conflicting
definitionsofglobalobjectsacrossdifferentscripts,andisableto
improve the reliability. However, a script can intentionally read
first-party objects to build fake dependencies. We mitigate the risk
throughdevelopervalidationoftheisolationpolicies.Specifically,
JSIsolate reports each cross-script read operation that leads to
the context assignment of third-party scripts in the policies. The
developersthuscanidentifyanyunexpectedreadsandadjustthe
contextid s.Accordingtoourobservation,inthedomain-level(resp.
URL-level) policies, each page contains on average 8.07 (resp. 7.96)
staticthird-partyscriptsthathavedependencyrelationshipwith
first-partyscriptsandareinvolvedinreadoperations;eachsuch
script is involved in on average 3.80 (resp. 3.83) read operations.
Therefore,itispracticalforwebdeveloperstovalidatetheisolation
policies as itisaone-timecost.
MitigatingPrototypePoisoningAttacks. Considertheproto-
typepoisoningattackin Listing2,wherea.jsreadsRegExp.prototype
andthenwritesRegExp.prototype.test .Afterthat,client.js calls
(i.e., reads) method testfromRegExp.prototype .JSIsolate does
notrecordthereadtoobjectpropertiestoavoidrecognizing a.js
andclient.js as dependent. Therefore, JSIsolate can prevent the
attackbyisolating a.jsinthethird-partycontext,sothattheproto-
typeaccessedbythefirst-partyscriptswouldnotbeaffected.Inthis
way, we mitigate the unexpected interference and provide a higher
level of reliability. Again, a script can deceive JSIsolate by forging
thedependencieswithfirst-partyscripts.Wereportanyconflicting
write and read operations in each static third-party script to the
developers, whowoulddecidewhether to adjust the policies.
Similar vulnerabilities have also beendiscovered on other pass-
word managers, e.g.,PassPack and MashedLife [ 2], and have been
discussedin[ 17]. They could be mitigatedinasimilar way.
5.3 Compatibility
The concernon thecompatibilityof JSIsolate liesintwo folds:1)
Whether JSIsolate iscompatiblewithwebsitesthatdonotenforce
script isolation; and 2) Whether JSIsolate breaks the functionality
ofwebsitesafterscriptisolation.Theanswertothefirstquestion
isobviously yes,because JSIsolate bydefaultexecutesallscripts
inthesamemainworldwhennopolicyisexplicitlyspecified.To
measure the compatibility with real-world websites after script
isolation, we used a Vanilla Chromium browser and our prototype
tovisitAlexatop1Kwebsites,andrecordedtheruntimeexceptions
separately.Weenforcedthedefaultpoliciesautomaticallygenerated
fromthescriptdependencylogs.Westudyhowdifferentchoicesof
fallback contextin JSIsolate can affectthe website compatibility.
To make the evaluation scalable, we opted for an automatic test-
ingapproachthatperformsbasicinteractionsuchaspagescrolling
after loading. We did not use monkey testing in the experiment asitcanrandomlytriggerdifferentcode(hencedifferentexceptions)
indifferentruns,whichmakesitdifficulttomakeafaircomparison.
We acknowledge that some exceptions might not be observed due
toincompletecodecoverage.Aswediscussin ğ6,thiscanbesolved
byintegratingthedependencyanalysisandcompatibilitytestsin
theapplicationregressiontestingprocess.Wedidmanuallyinspect
the exceptions on top 1002websites and identified the websites on
whichwe observednewexceptions after isolating scripts.
First-party Context as Fallback for URL-level Policies. We
firstly assigned a fallback contextid of ł1ž to unmatched scripts.
Outofthetop100websites,weobservedon1websitenewJavaScript
exceptions.Withourmanualanalyses,theexceptionsdidnotbreak
any critical functionality and all the compatibility issues could
be resolved. Specifically, website https://www.pornhub.com gener-
atedexceptionsbecausescriptsdynamicallygeneratedimplicitly
depended on scripts in a different context. This shows a current
limitation of JSIsolate as it did not consider inline event listeners
and the dynamic scripts in the dependency analysis, which we will
discussin ğ6.Theexceptionscouldbemitigatedbychangingthe
contextid ofthethird-partyscriptfrom “3”to“1”or“both”.We
leave this as an option to the developer, who has sufficient infor-
mation to decide the context of scripts. The problem can also be
fixed by allowing developers to specify the related origins using
First-PartySets[ 11]. More details are discussedin ğ6.
Third-partyContextasFallbackforURL-levelPolicies. We
further tested JSIsolate by assigning acontextid of ł3ž to un-
matched scripts. Except for the above website, we observed 4 more
websites that threw exceptions after script isolation. The excep-
tions were generated because a long random string is contained
in the URL of an external script from a third-party domain, or in
the URL of the embedding iframe of the script. Although these
scriptswereexplicitlydependentonfirst-partyscripts,theywere
mistakenlyclassifiedasthird-partyscripts.Forinstance,theURLof
scripthttps://static.xx.fbcdn.net/rsrc.php/v3/yg/r/..._nc_x=... con-
tainedarandomquerystringthatwas11characterslong,which
made our URL match fail because the query string was updated
periodically. We could not exclude the query strings during the
matching, as a frame may include multiple scripts whose URLs
only differ in the query strings. As a result, the script from the
third-partyCDNdomainwasmisclassifiedasathird-partyscript
on website https://www.facebook.com , although it was read by
first-party scripts. Nevertheless, the exceptions did not affect other
scripts,andnocriticalfunctionalitywasbroken.Theseproblems
canbefixedbyrecollectingthelogsandgeneratingthelatestiso-
lationpolicies.Alternatively,wecouldleveragemechanismslike
SRItomatchthecontentofascript(bycomputingahashvalue)in-
steadofonlyitsURL.Wecouldalsoperformanapproximatematch
on external script source code in the browser to tackle with the
randomstrings.Inaddition,asthosescriptsareincludedbytheweb-
site developers, they could permanently set the script contextid
attributes justonceregardless of the URLs that willbe used.
Domain-levelPolicies. WhenJSIsolate isdeployedtoenforce
domain-levelisolationpolicies,wedidnotfindanyofthetop100
website throw more exceptions. Note that the choice of fallback
2Exceptfor http://www.17ok.com thatisinaccessible,wegatheredvaliddataon99
websites.
201ESEC/FSE ’21, August 23–28, 2021,Athens,Greece Mingxue Zhang andWeiMeng
Table 3:Average logcollection overheadon page loading.
Round Vanilla (s) JSIsolate (s) %Inc (%)
1 5.74 7.73 34.67
2 6.14 7.93 29.15
3 6.69 8.35 24.81
Table 4:Average logcollection memory overhead.
Round Vanilla (MB) JSIsolate (MB) %Inc (%)
1 67.72 80.24 18.49
2 67.48 79.26 17.46
3 67.90 79.89 17.66
contextdoesnotaffecttheresults,asthemismatchescanonlybe
causedbyscriptsfromnewdomainsabsentfromthepolicies,which
we didnot encounteronthe top 100websites.
Summary. Our evaluation shows that JSIsolate entails very few
andfixable compatibilityissuesandworks wellwithpopularreal
world webapplicationsingeneral.
5.4 Performance
Tomeasuretheperformanceoverheadof JSIsolate ,weusedthe
selenium chromedriver to run a Vanilla Chromium browser and
JSIsolate to visit the Alexa top 1K websites. We set a timeout of
160secondsandforwebsitesthattimeoutedafterseveralretries,we
enlargedthetimeoutto360seconds.Werecordedtheaveragepage
loading time based on the window.performance.timing interface,
andcomputedthe averagememory consumption in3runs.
5.4.1 LogCollectionOverhead. WeranJSIsolate inthelogcollec-
tion mode to measure the overhead when collecting the JavaScript
objectaccesslogsandscriptinitiatorrecords.Wesuccessfullygath-
ered valid data on 994, 994 and 995 websites in the 3 runs. The
results are presentedin Table3andTable4.
Inthelogcollectionmode,theslowdownonpageloadingvaries
from 24.81% to 34.67% and is averaged at 29.54%. The memory
overhead ranges from 17.46% to 18.49%, with an average of 17.87%.
Wefurthertested JSIsolate onindustry-standardbenchmarks,
and the evaluation results are listed in Table 5. As shown, the most
significant overhead was observed on the SunSpider benchmark,
which tests the core JavaScript language features like hashing and
matrix processing, etc.Overall,45scriptswere staticallyincluded
on the test page, and JSIsolate recorded over 230K read/write
operations.On theother two benchmarks, however,theoverhead
wascomparable withwhat we observedonreal world websites.
Note that a developer would need to recollect the logs only if
she/he changes the included scripts, or a script changes its inter-
actionwithotherscriptssignificantly.Anyruntimeerrorscaused
bythechangescanbereportedtohelpthedevelopersquicklyset
a new isolation policy and/or easily identify a suspicious script.
Therefore, the overhead is acceptable as the log collection needs
not to be performedfrequently.
5.4.2 Script Isolation Overhead. We ranJSIsolate in policy en-
forcementmodetoevaluatetheperformanceoverheadincurredfor
isolatingscripts. JSIsolate readstheisolationpoliciesfromlocal
3Allthe testcases areavailable at: https://github.com/jeresig/dromaeoTable 5: Log collection overhead on industry-standard
JavaScript benchmarks. The test results represent the geo-
metricmean ofrun/sec foreachindividual test.
Benchmark3Vanilla JSIsolate %Dec(%)
Dromaeo 1,957.18 1,736.79 11.26
SunSpider 2,855.82 2,024.38 29.11
V8 Test Suite 1,804.71 1,759.29 2.52
Table6:Slowdownonaveragepageloadingtimeduringscript
isolation(URL-levelpolicies).
Round Vanilla (s) JSIsolate (s) %Inc (%)
1 5.67 5.99 5.64
2 6.14 6.71 9.38
3 5.67 6.17 8.82
Table7:Increaseofaveragememoryconsumptioninscript
isolation(URL-levelpolicies).
Round Vanilla (MB) JSIsolate (MB) %Inc (%)
1 66.19 67.49 1.96
2 67.43 69.00 2.33
3 67.75 68.73 1.45
Table8:Slowdownonaveragepageloadingtimeduringscript
isolation(domain-level policies).
Round Vanilla (s) JSIsolate (s) %Inc (%)
1 4.90 5.19 5.92
2 5.29 5.57 5.29
3 4.68 5.09 8.76
filesandassigns contextid toscriptsaccordingtothestrategyin
ğ3. We successfully collected performance data for all 978 websites.
Specifically,wemeasuredtheoverheadusingboththeURL-level
and domain-level policies. The experiment results are presented in
Table6,Table7,Table8andTable9.
When using URL-level policies, the average slowdown is 7.95%,
andon47.51%websitesthepageloadingtimeincreasedbynomore
than 1%. For domain-level policies, the average slowdown is 6.66%.
This demonstrates that JSIsolate incurs small overhead on page
loading. Using URL-level policies, the average memory overhead is
1.91%,andtheoverheadisnogreaterthan1%on48.88%websites.
Fordomain-levelpolicies,theaveragememoryoverheadis1.34%.
As shown,the memory overheadisalsonegligible.
Summary. Theexperimentsshowthat JSIsolate canefficiently
isolate scripts withvery limitedoverhead.
6 DISCUSSION AND FUTUREWORK
We discuss our work’scurrentlimitationsandour future work.
Policy Deployment. JSIsolate reads the isolation policies from
local files in our current prototype. In the future, we plan to enable
developers to use a new HTTP response header for the policies.
Alternatively,thepoliciescanbeembeddedintheHTMLpage,like
internalCSS.Moreover,thepoliciescanbeintegratedwithexisting
websitesthroughminimalchanges, e.g.,byasimpleupdateofthe
template usedinwebdevelopmentframeworks ( e.g.,Angular).
202JSISOLATE:LightweightIn-Browser JavaScript Isolation ESEC/FSE ’21, August 23–28, 2021,Athens,Greece
Table9:Increaseofaveragememoryconsumption inscript
isolation(domain-levelpolicies).
Round Vanilla (MB) JSIsolate (MB) %Inc (%)
1 66.39 67.68 1.94
2 66.72 67.32 0.90
3 67.42 68.22 1.19
DependencyAnalysis. JSIsolate excludes dynamicscriptsand
event listeners from the dependency analysis, which may cause ex-
ceptions after script isolation. We adopt this design for preventing
cross-contextinterferencethroughdynamicscriptinclusion,and
eventlistenersareintrinsicallyisolatedindifferentDOMwrappers,
as explained in ğ3. Nevertheless, to mitigate theexceptions, devel-
opers can adjust the policies with limited manual efforts (see ğ5.2).
We leave it as a future work to investigate other possible solutions.
CodeCoverage. JSIsolate performsmonkeytestingtocapture
and analyze script dependencies in a scalable way. The monkey
testing, however, does not promise a full code coverage. Therefore,
thedependencyanalysismightbeincompleteandcausesomeex-
ceptions after script isolation. However, the automatic dependency
analysis can be integrated with the current website regression test-
ingprocess,whichthoroughlyteststheapplication.Thisintroduces
verylimitedoverheadinthedevelopmentcycleandcouldhelpiden-
tify possible compatibilityissuesandimprove code reliability.
ClassificationofScripts. JSIsolate reliesonthedomainrelation-
shiplistfromDisconnecttoidentifyscriptsfromdomainsrelatedto
the first-party domain. As shown in ğ5.1, only 142 of the evaluated
domainswerepresentonthelist.However,weexpectthatwiththe
contribution of the community, the list would be more comprehen-
siveinthefuture.Meanwhile,GooglehasproposedFirst-PartySets
[11], that allows developers to explicitly specify related domains
ina.jsonfile,andwillbeimplementedintheChromiumbrowser
in the near future. We believe the First-Party Sets would further
improve our abilityto precisely classifyscripts.
Applicability in Other Browsers. In addition to the Chromium
browser,otherfull-fledgedbrowsersalsoprovideJavaScriptcode
isolation mechanisms. For instance, the Safari browser also exe-
cutesscriptsinjectedbyAppExtensionsinisolatedworlds.Mozilla
Firefox supports the Xray vision feature [21], that uses separate
contextsforcontentscriptsandnormalscripts.Therefore,thede-
signofJSIsolate canbeeasilyextendedtootherpopularbrowsers.
7 RELATED WORK
JavaScript Isolation. [23,27] confined malicious JavaScript code
using a reference monitor, and [ 26] restricted the interaction be-
tween Adobe ActionScript and JavaScript code. Magazinius et al.
fixed several design flaws of [ 27] in [16]. Agtenet al.sandboxed
sensitive DOM objectsto isolate third-party scripts, with the page
loading overhead of over 30% [ 3]. Treehouse [ 12] and SafeJS [ 7]
usedwebworkerstorunscriptsinseparatethreads.However,they
requiredthedeveloperstospecifythepermittedoperationsofeach
isolated script, which is non-trivial for normal web developers.
Some other works isolated scripts using iframes [ 10,13,19,33,42].
TheyneedtointerposetheinteractionbetweenscriptsandDOM
of the original page. In contrast, JSIsolate utilizes isolated worlds
to separate functionally independent scripts, which does not affectthe way that scripts are executed. Further, it is able to generate
isolation policies automatically, which ismore efficient andeasier
todeploy.Adam etal.proposedtoisolatecontentscriptsofbrowser
extensionsusing isolatedworld inFirefoxbrowser[ 4],whichhas
adifferenttargetfrom JSIsolate .BREAKAPPconfinesJavaScript
modulesinprotectedcompartments[ 36].JSIsolate canalsoisolate
normal webscripts andany JavaScript code createddynamically.
LimitingJavaScriptPrivileges. ESCUDOorganizedJavaScript
principalsandresourcesinringswithdifferentprivileges[ 14].Itpre-
ventsprincipalswithlowerprivilegesfromaccessingresourceswith
higherprivileges.Meyerovich etal.registeredadviceforsecurity-
sensitivefunctionslike evaltorestrictthecallstothem[ 18].Web-
Jailusesdeepadvicetoenforceleast-privilegeintegrationofscripts
[35].Snyder etal.developedanextensiontoblockunsafeJavaScript
featuresbasedonpre-definedpolicies[ 31].FlowfoxinterceptsDOM
APIcallsthrough secure multi-execution to protect dataconfiden-
tiality [9]. COWL enforces label-based access control to prevent
scripts from exfiltrating sensitive data [ 32]. Chudnov et al.im-
plemented an inlined information flow control (IFC) monitor to
protectdataconfidentialityandintegrity[ 8].BrowserShield[ 29]
and JaTE [ 34] rewrite HTML pages and scripts to safe equivalents.
Theseworkshaveadifferenttargetfrom JSIsolate ,whichseparates
scripts withdifferentfunctionalities to providehigher reliability.
Isolation in the Browser. Prior works have proposed to ren-
deruntrusted webcontent inlowerprivilegedrendererprocesses
[1,28,43]. They limited the capability of attackers that compro-
misetherenderer.However,thebrowserstillloadscontentfrom
different websites in the same renderer process, thus attackers can
accesscross-sitedata.ArecentworkofGooglerendersuntrusted
content fromdifferentwebsites inseparate processes[ 30].Fission
[20] further enforces the isolation at the granularity of origins.
Narayan etal.sandboxedvulnerableC/C++librariesusedbythe
rendererinlightweightWebAssemblysandboxes[ 22].Theseworks
are orthogonalto JSIsolate ,whichassumesatrustedbrowser.
8 CONCLUSION
Third-partyscriptsareprevalentlyusedonwebapplicationtoen-
hancethefunctionalities.However,thecurrentbrowserarchitec-
ture allows all scripts to access a shared context, causing unex-
pectedeffects.Inthispaper,wepresent JSIsolate ,abrowser-based
frameworkthatimprovesJavaScriptcodereliabilitybyexecuting
scriptsinisolatedexecutioncontexts. JSIsolate analyzesthedepen-
dencyrelationshipbetweenscriptsonawebpage,andidentifiesthe
scriptsfromthird-partydomainthatarenotfunctionallydependent
onfirst-partyscripts.Itthenexecutesthescriptsinaseparateiso-
latedenvironmenttopreventthemfrominterferingwithfirst-party
scripts.Wedemonstratewithrealworldexamplesthat JSIsolate
offersapracticalapproachtoenhancingJavaScriptreliabilityand
separating functionality-independent code. Our experiments on
Alexa top 1K websites further prove that JSIsolate is backward
compatible,andintroduces limitedperformance overhead.
ACKNOWLEDGMENT
The work described in this paper was partially supported by a
grant from the Research Grants Council of the Hong Kong Special
Administrative Region,China (ProjectNo.: CUHK24209418).
203ESEC/FSE ’21, August 23–28, 2021,Athens,Greece Mingxue Zhang andWeiMeng
REFERENCES
[1] [n.d.]. WebKit2. https://trac.webkit.org/wiki/WebKit2.
[2]BenAdida,AdamBarth,andCollinJackson.2009. Rootkitsforjavascriptenvi-
ronments. In 3rdUSENIXWorkshop onOffensiveTechnologies(WOOT’09) .
[3]PieterAgten,StevenVanAcker,YoranBrondsema,PhuHPhung,LievenDesmet,
and Frank Piessens. 2012. JSand: complete client-side sandboxing of third-party
JavaScript without browser modifications. In Proceedings of the 28th Annual
Computer SecurityApplicationsConference (ACSAC) .
[4]AdamBarth,AdriennePorterFelt,PrateekSaxena,andAaronBoodman.2010.
Protecting browsers from extension vulnerabilities. In Proceedings of the 17th
Annual Networkand Distributed System SecuritySymposium(NDSS) . San Diego,
CA.
[5]StefanoCalzavara,AlviseRabitti,andMicheleBugliesi.2016. Contentsecurity
problems? evaluating the effectiveness of content security policy in the wild.
InProceedings of the 23rd ACM Conference on Computer and Communications
Security(CCS) . Vienna, Austria.
[6]StefanoCalzavara,AlviseRabitti,andMicheleBugliesi.2018. Semantics-based
analysisofcontentsecuritypolicydeployment. ACMTransactionsontheWeb 12,
2 (2018), 1ś36.
[7]DamienCassou,StéphaneDucasse,andNicolasPetton.2013. Safejs:Hermetic
sandboxingfor javascript. arXiv preprint arXiv:1309.3914 (2013).
[8]AndreyChudnovandDavidANaumann.2015. Inlinedinformationflowmon-
itoringforJavaScript.In Proceedingsofthe22ndACMConferenceonComputer
and Communications Security(CCS) . Denver, Colorado.
[9]Willem De Groef, Dominique Devriese, Nick Nikiforakis, and Frank Piessens.
2012. FlowFox:awebbrowserwithflexibleandpreciseinformationflowcontrol.
InProceedings of the 19th ACM Conference on Computer and Communications
Security(CCS) . Raleigh,NC.
[10]Frederik De Keukelaere, Sumeer Bhola, Michael Steiner, Suresh Chari, and
Sachiko Yoshihama. 2008. Smash: secure component model for cross-domain
mashups on unmodified browsers. In Proceedings of the 17th International World
WideWeb Conference (WWW) . Beijing, China.
[11] Google. [n.d.]. First-PartySets. https://github.com/privacycg/first-party-sets .
[12]Lon Ingram and Michael Walfish. 2012. TreeHouse: JavaScript sandboxes to
helpWeb developers help themselves. In Proceedings of the 2012 USENIX Annual
TechnicalConference (ATC) . Boston, MA.
[13]Collin Jackson and Helen J Wang. 2007. Subspace: secure cross-domain commu-
nication for web mashups. In Proceedings of the 16th International World Wide
Web Conference (WWW) . Banff, Alberta, Canada.
[14]KarthickJayaraman,WenliangDu,BalamuruganRajagopalan,andSteveJChapin.
2010. Escudo: A fine-grained protection model for web browsers. In Proceedings
ofthe 30thInternationalConference onDistributedComputingSystems(ICDCS) .
[15]TobiasLauinger,AbdelberiChaabane,SajjadArshad,WilliamRobertson,Christo
Wilson,andEnginKirda.2017. ThouShaltNotDependonMe:AnalysingtheUse
ofOutdatedJavaScriptLibrariesontheWeb.In Proceedingsofthe2017Annual
Network and DistributedSystemSecuritySymposium(NDSS) . San Diego, CA.
[16]JonasMagazinius,PhuHPhung,andDavidSands.2010. Safewrappersandsane
policies for self protecting JavaScript. In Nordic Conference on Secure IT Systems .
Springer, 239ś255.
[17]Leo A Meyerovich, Adrienne Porter Felt, and Mark S Miller. 2010. Object views:
Fine-grainedsharinginbrowsers.In Proceedingsofthe19thInternationalWorld
WideWeb Conference (WWW) . Raleigh,NC.
[18]LeoAMeyerovichandBenjaminLivshits.2010. ConScript:Specifyinganden-
forcingfine-grainedsecuritypoliciesforJavascriptinthebrowser.In Proceedings
ofthe 31thIEEE SymposiumonSecurityand Privacy (Oakland) . Oakland, CA.
[19]James Mickens. 2014. Pivot: Fast, synchronous mashup isolation using gener-
atorchains.In Proceedingsofthe35thIEEESymposiumonSecurityandPrivacy
(Oakland) . San Jose, CA.
[20] Mozilla.[n.d.]. Project Fission. https://wiki.mozilla.org/Project_Fission .
[21]Mozilla.[n.d.]. Xrayvision. https://developer.mozilla.org/en-US/docs/Mozilla/
Tech/Xray_vision .
[22]Shravan Narayan, Craig Disselkoen, Tal Garfinkel, Nathan Froyd, Eric Rahm,
SorinLerner,HovavShacham,andDeianStefan.2019. RetrofittingFineGrain
Isolation in the Firefox Renderer. In Proceedings of the 29th USENIX Security
Symposium(Security) . Boston, MA.[23]Kailas Patil, Xinshu Dong, Xiaolei Li, Zhenkai Liang, and Xuxian Jiang. 2011.
Towards fine-grained accesscontrol in javascriptcontexts.In Proceedingsofthe
31st InternationalConference onDistributedComputingSystems(ICDCS) .
[24]Jibesh Patra, Pooja N Dixit, and Michael Pradel. 2018. Conflictjs: finding and
understandingconflictsbetweenjavascriptlibraries.In Proceedingsofthe40th
InternationalConference onSoftwareEngineering (ICSE) . Gothenburg,Sweden.
[25]Jackson Patrick, Mills Codi, Oppenheim Casey, and Toyens Victor. [n.d.]. Dis-
connect. https://disconnect.me .
[26]Phu H Phung, Maliheh Monshizadeh, Meera Sridhar, Kevin W Hamlen, et al .
2014. Betweenworlds:Securingmixedjavascript/actionscriptmulti-partyweb
content. IEEE Transactions on Dependable and Secure Computing 12, 4 (2014),
443ś457.
[27]Phu H Phung, David Sands, and Andrey Chudnov. 2009. Lightweight self-
protecting JavaScript. In Proceedings of the 4th International Symposium on Infor-
mation, Computer,and Communications Security . 47ś60.
[28]Charles Reis, Adam Barth, and Carlos Pizano. 2009. Browser security: lessons
from google chrome. Queue7,5 (2009), 3ś8.
[29]Charles Reis, John Dunagan, Helen J Wang, Opher Dubrovsky, and Saher Esmeir.
2007. BrowserShield: Vulnerability-driven filtering of dynamic HTML. ACM
Transactions onthe Web 1,3 (2007), 11śes.
[30]CharlesReis,AlexanderMoshchuk,andNaskoOskov.2019.Siteisolation:Process
separationforwebsiteswithinthebrowser.In Proceedingsofthe28thUSENIX
SecuritySymposium(Security) . SantaClara, CA.
[31]Peter Snyder, Cynthia Taylor, and Chris Kanich. 2017. Most websites don’t need
tovibrate:Acost-benefitapproachtoimprovingbrowsersecurity.In Proceedings
of the 24th ACM Conference on Computer and Communications Security (CCS) .
Dallas,TX.
[32]Deian Stefan, EdwardZ Yang, Petr Marchenko, Alejandro Russo, Dave Herman,
Brad Karp, and David Mazières. 2014. Protecting Users by Confining JavaScript
with COWL. In Proceedings of the 11th USENIX Symposium on Operating Systems
Designand Implementation(OSDI) . Broomfield,Colorado.
[33]Mike Ter Louw, Karthik Thotta Ganesh, and VN Venkatakrishnan. 2010. Ad-
Jail: Practical Enforcement of Confidentiality and Integrity Policies on Web
Advertisements.In Proceedings ofthe19th USENIXSecurity Symposium(Security) .
Washington, DC.
[34]TungTran,RiccardoPelizzi,andRSekar.2015. Jate:Transparentandefficient
javascript confinement. In Proceedings of the 31st Annual Computer Security
ApplicationsConference (ACSAC) .
[35]StevenVanAcker,PhilippeDeRyck,LievenDesmet,FrankPiessens,andWouter
Joosen.2011. WebJail:least-privilegeintegrationofthird-partycomponentsin
web mashups.In Proceedingsof the27thAnnualComputerSecurityApplications
Conference (ACSAC) .
[36]NikosVasilakis,BenKarel,NickRoessler,NathanDautenhahn,AndréDeHon,
and JonathanM Smith. 2018. BreakApp:Automated,FlexibleApplicationCom-
partmentalization. In Proceedings of the 2018 Annual Network and Distributed
SystemSecuritySymposium(NDSS) . San Diego, CA.
[37] W3C. [n.d.]. Content SecurityPolicyLevel 3. https://www.w3.org/TR/CSP3/ .
[38]W3C.[n.d.]. Cross-originresourcesharing(CORS). https://www.w3.org/wiki/
CORS.
[39]W3C. [n.d.]. HTML5. https://www.w3.org/TR/2009/WD-html5-20090423/
browsers.html .
[40]W3C. [n.d.]. Same-origin Policy. https://www.w3.org/Security/wiki/Same_
Origin_Policy .
[41] W3C. [n.d.]. Subresource Integrity(SRI). https://www.w3.org/TR/SRI/ .
[42]SamanZarandioon,DanfengYao,andVinodGanapathy.2008. Omos:Aframe-
work for secure communication in mashup applications. In Proceedings of the
24thAnnual Computer SecurityApplicationsConference (ACSAC) .
[43]Andy Zeigler. [n.d.]. IE8 and Loosely-Coupled IE (LCIE).
https://docs.microsoft.com/en-gb/archive/blogs/ie/ie8-and-loosely-coupled-ie-
lcie.
[44]MingxueZhangandWeiMeng.2020. DetectingandunderstandingJavaScript
global identifier conflicts on the web. In Proceedings of the 28th ACM Joint Eu-
ropean Software Engineering Conference and Symposium on the Foundations of
SoftwareEngineering (ESEC/FSE) . Sacramento, CA.
[45]MingxueZhang,WeiMeng,andYiWang.2019. Poster:FindingJavaScriptName
Conflicts on the Web. In Proceedings of the 26th ACM Conference on Computer
and Communications Security(CCS) . London,UK.
204