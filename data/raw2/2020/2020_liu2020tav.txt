Towards Automated VerificationofSmartContract Fairness
Ye Liu
li0003ye@ntu.edu.sg
Nanyang TechnologicalUniversity
SingaporeYiLi
yi_li@ntu.edu.sg
Nanyang TechnologicalUniversity
Singapore
Shang-Wei Lin
shang-wei.lin@ntu.edu.sg
Nanyang TechnologicalUniversity
SingaporeRongZhao
rong.zhao@ntu.edu.sg
Nanyang TechnologicalUniversity
Singapore
ABSTRACT
Smart contracts are computer programs allowing users to define
and execute transactions automatically on top of the blockchain
platform. Many of such smart contracts can be viewed as games. A
game-likecontractacceptsinputsfrommultipleparticipants,and
upon ending, automatically derives an outcome while distributing
assets according to some predefined rules. Without clear under-
standingofthegamerules,participantsmaysufferfromfraudulent
advertisements and financial losses. In this paper, we present a
framework to perform (semi-)automated verification of smart con-
tract fairness, whose results can be used to refute false claims with
concreteexamplesorcertifycontractimplementationswithrespect
to desired fairness properties. We implement FairCon, which is
able tocheck fairnesspropertiesincludingtruthfulness,efficiency,
optimality, and collusion-freeness for Ethereum smart contracts.
Weevaluate FairCon onasetofreal-worldbenchmarksandthe
experimentresultindicatesthat FairCon iseffectiveindetecting
property violations and able to prove fairness for common types of
contracts.
CCS CONCEPTS
·Softwareanditsengineering →Softwareverification ;Soft-
ware verification andvalidation .
KEYWORDS
Smartcontract, fairness,mechanismdesign.
ACMReference Format:
Ye Liu, Yi Li, Shang-Wei Lin, and Rong Zhao. 2020. Towards Automated
VerificationofSmartContractFairness.In Proceedingsofthe28thACMJoint
EuropeanSoftwareEngineeringConferenceandSymposiumontheFounda-
tionsofSoftwareEngineering(ESEC/FSE’20),November8ś13,2020,Virtual
Event, USA. ACM, New York, NY, USA, 12pages.https://doi.org/10.1145/
3368089.3409740
Permissionto make digitalor hard copies of allorpart ofthis work for personalor
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ESEC/FSE ’20, November 8ś13, 2020, Virtual Event, USA
©2020 Associationfor Computing Machinery.
ACM ISBN 978-1-4503-7043-1/20/11...$15.00
https://doi.org/10.1145/3368089.34097401 INTRODUCTION
Theblockchaintechnologyhasbeendevelopedrapidlyinrecent
years, since the introduction of Bitcoin [ 42] by Nakamoto in 2008.
Thedistributedandtamper-resistantnatureofblockchainhasmade
it the perfect platform for hosting smart contracts. Smart con-
tractsarecomputerprogramsrunningatopblockchainplatforms
to manage large sums of money, carry out transactions of assets,
andgovernthetransferofdigitalrightsbetweenmultipleparties.
Ethereum[ 60]andEOS[ 28]areamongthemostpopularblockchain
platforms which support smart contracts and have them applied in
many areas. As of February 2020, there are over one million smart
contracts deployed on Ethereum, which is a 100 fold increase since
just two years ago. These smart contracts have enabled about 2.7K
decentralized applications(DApps) [ 3] serving 20K daily users on
finance,health, governance,gambling, games,etc.
The security of smart contracts has been at the center of at-
tention, ever since their adoption in the management of massive
monetary transactions. One of the most notorious cases is the
DAOattack[ 49]onEthereum,whichresultedinalossof$60mil-
lionworth,duetothe reentrancyvulnerability beingexploitedby
malicious attackers. Several gambling games on EOS, including
EOS.WIN andEOSPlay, were recently hacked using a technique
calledthe transactioncongestionattack [47]andledtosignificant
asset loss. What these incidents share in common is that certain
security vulnerabilities neglected during contract development are
exploited by malicious parties, causing a loss for the contract own-
ers(andpossiblyotherhonestparticipants).Thesevulnerabilities
areprogrammingerrors,indicatingamismatchbetweenthecon-
tractdevelopers’expectationsandhowthecontractcodeactually
works. They areeasy to detect oncethe vulnerabilitypatterns are
recognized.Infact,muchresearchhasbeendedicatedtopreventing,
discovering,andmitigating such attacks.
In contrast, the fairnessissues of smart contracts have not yet
attractedmuchattention.Asmartcontractisunfairtocertainpartic-
ipantsifthereisamismatchbetweentheparticipants’expectations
and the actual implementation of the game rules. It is possible that
amalicious partymay gainan advantageoverothersthroughthe
exploitationofsecurityvulnerabilities,e.g.,examiningotherpartici-
pants’actionsinasealedgame.Inthispaper,wewouldliketofocus
more on the fairness issues introduced by the logical design of the
contracts instead, which are orthogonaltothe security issues. For
example, smart contracts may well be advertised as łsocial gamesž
with apromised 20% return for any investment,but turn out to be
łPonzischemesž[ 11].Inthiscase,thepossibilitythatthegamemay
666ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA Ye Liu, YiLi, Shang-WeiLin, andRong Zhao
eventually slowdownandnever payback isintentionallyleft out.
Similarly, many auction DApps claim to be safe and fair, yet it is
stillpossibleforbidderstocolludeamongthemselvesorwiththe
auctioneer to make aprofit at the expenses of the others[ 61]. The
fairness issues mostly reside in contract logic: some of them are
unfairbydesign,whiletherestarecarelessmistakes.Thismakes
thedetectionofsuchissuesparticularlychallenging,becauseevery
case can be different and there is no hope in identifying predefined
patterns. Sinceitisoften notthecontractcreators’ interestatrisk
(or even worse when they gain at the expenses of participants),
thereislittleincentiveforthemtoallocateresourcesinensuring
thefairnessoftheircontracts.Ontheotherhand,itisratherdiffi-
cult, for inexperienced users, to tell whether a contract works as
advertised,even withthe sourcecode available.
Inthispaper,wepresent FairCon,aframeworkforverifyingfair-
ness properties of smart contracts. Since general fairness is largely
asubjectiveconceptdeterminedbypersonalpreferences,thereis
no universal truth when considering only a single participant. We
view a smart contract as a game (or mechanism [ 29,45]), which
accepts inputs from multiple participants, and after a period of
timedecidestheoutcomeaccordingtosomepredefinedrules.Upon
game ending, each participant receives certain utility depending
on the game outcome. With such a mechanism model, we can then
verifyawiderangeofwell-studiedfairnessproperties,including
truthfulness ,efficiency,optimality ,andcollusion-freeness .Itisalso
possible to definecustomizedpropertiesbasedonspecific needs.
Therealchallengeinbuildingthefairnessverificationframework
is onhow to translatearbitrary smart contract code into standard
mechanism models. Our solution to this is to have an intermediate
representationforeachtypeofgames,whichhasdirectsemantic
translationtotheunderlyingmechanismmodel.Forinstance,the
keycomponentsinanauctionaredefinedbythesetofbidders,their
bids, and the allocation and clear price rules of the goods in sale.
To synthesize the intermediate mechanism model for an auction
smartcontract,wefirstmanuallyinstrumentthecontractcodewith
customized labels highlighting the relevant components. Then we
perform automated symbolic execution [35] on the instrumented
contracttoobtainsymbolicrepresentationsforauctionoutcomes
in terms of the actions from a bounded number of bidders. This
is finally mapped to standard mechanism models where fairness
properties can be checked. We either find property violations with
concretecounterexamplesorareabletoshowsatisfactionwithin
theboundedmodel.Forpropertiesofwhichwedonotfindviolation,
weattempttoprovethemforunboundednumberofparticipants
on the original contract code, with program invariants observed
from the boundedcases.
By introducing the intermediate representations, we could keep
theunderlyingmechanismmodelandpropertycheckingenginesta-
ble.Wedefinedanintermediatelanguagefortwotypesofgame-like
contracts popular on Ethereum, i.e., auction and voting. We imple-
mentedFairCon toworkonEthereumsmartcontractsandapplied
it on 17 real auction and voting contracts from Etherscan [5]. The
effortofmanuallabelingisreasonablylow,consideringthestruc-
turalsimilarityofsuchcontracts.Theexperimentalresultsshow
thattherearemanysmartcontractsviolatingfairnesspropertyand
FairCon is effective to verify fairness property and meanwhile
achieves relativelyhigh efficiency.Contributions. Our main contributions are summarized as fol-
lows.
•Weproposedageneralfairnessverificationframework, FairCon,
to check fairness properties of smart contracts. In particular, we
demonstrated FairCon on two types of contracts and four types
offairnessproperties.
•We defined intermediate representations for auction andvoting
contracts,anddesigneda(semi-)automatedapproachtotranslate
contractsourcecodeintomathematicalmechanismmodelswhich
enable fairnessproperty checking.
•In addition to discovering propertyviolations forbounded mod-
els,weapplyformalverificationtoprovesatisfactionofproper-
ties for the unboundedcasesas well.
•We implemented FairCon and evaluated it on 17 real-world
Ethereum smart contracts. The results show that FairCon is
abletoeffectivelydetectfairnessviolationsandprovefairness
propertiesforcommontypesofgame-likecontracts.Thedataset,
rawresults,andprototypeused areavailableonline: https://doi.
org/10.21979/N9/0BEVRT .
Organizations. The rest of the paper is organized as follows. Sec-
tion2illustratestheworkflowof FairCon withanexample.Sec-
tion3presentsa general mechanismanalysis model and definesa
modeling language customized for auction and voting contracts,
serving as an intermediate representation between the contract
source code and the underlying mechanism model. We then de-
scribe the model construction and fairness checking as well as
verification techniques in Sect. 4. Section5gives details on the im-
plementation and presents the evaluation results. Sections 6and7
compare FairCon withtherelatedworkandconcludethepaper,
respectively.
2 FAIRCONBY EXAMPLE
In this section, we use an auction contract to illustrate how our
approachworksinconstructingtheintermediatemechanismmodel
andverifying fairnessproperties.
Example2.1. Figure1showsasimplifiedEthereumsmartcon-
tract, named CryptoRomeAuction , written in Solidity [ 53], taken
fromEtherscan .1The contract implements a variant of open Eng-
lishauctionforablockchain-basedstrategygame,whereplayers
areallowedtobuyvirtuallandswithcryptocurrencies.Theauction
isgivenapredefinedlifecycleparameterizedbystartandendtimes.
A participant can place a bid by sending a message to this contract
indicatingthevalueofthebid.Theaddressoftheparticipantand
thebidamountarestoredinvariables msg.sender andmsg.value ,
respectively. The address of the current highest bidder is recorded
inhighestBidder (Line9),andamapping refunds isusedtokeep
thecontributionsofeachparticipant(Line10)forpossiblerefunding
later. The bid()function (Lines 11ś21) is triggered upon receiving
the message.The bid isrejected if thebid amount isno more than
thesumofthecurrenthighestbidandtheminimalincrementvalue
duration (Lines13ś15).Otherwise,theprevious highestBidder
getsa refund(Lines16ś18), and the highestBidder (Line19)and
highestBid (Line 20) are updatedaccordingly.
1https://etherscan.io/address/0x760898e1e75dd7752db30bafa92d5f7d9e329a81
667TowardsAutomatedVerification of SmartContract Fairness ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA
1contract CryptoRomeAuction {
2/** FairCon Annocations
3@individual(msg.sender, msg.value, VALUE)
4@allocate(highestBidder)
5@price(highestBid)
6@outcome(bid())
7*/
8uint256 publichighestBid = 0;
9address payable publichighestBidder;
10mapping(address=>uint) refunds;
11function bid()public payable {
12uintduration = 1;
13if(msg.value <(highestBid +duration)){
14 revert();
15}
16if(highestBid != 0) {
17 refunds[highestBidder] +=highestBid;
18}
19highestBidder =msg.sender ;
20highestBid =msg.value ;
21}
22}
Figure 1:The CryptoRomeAuction Soliditysource code.
Table 1:Example instancesofCryptoRomeAuction.
Truthful Untruthful Collusion
Bidder p1p2p3p1p2p3p1p2p3
Valuation 3 4 6 3 4 6 3 4 6
Bid 3 4 6 3 4 5 3 0 4
Allocation ✗ ✗ ✓ ✗ ✗ ✓ ✗ ✗ ✓
Price 0 0 6 0 0 5 0 0 4
Utility 0 0 0 0 0 1 0 1 1
ThreatstoContractFairness. Onewaythat CryptoRomeAuction
can become unfair to the participants is through the so called shill
bidding[30]Ðashilltriestoescalatethepricewithoutanyintention
of buying the item. This can be induced by either the auctioneer or
adversarialparticipants,andotherbiddersmayneedtopaymoreas
a result. Occasionally,theshill wins theauction ifnootherhigher
bid comes before auction ends. The item may then be sold again at
alatertime.
Apartfromshillbidding,thereareanumberofotherwell-studied
properties from the game theory and mechanism design literature,
which can be used to evaluate the fairness of an auction. We use
theexampleinstancesshowninTable 1todemonstrate.Suppose
there are three bidders, p1,p2, andp3, participating in the auc-
tion.Each ofthemhas avaluation of the item,i.e., the item worth
three, four, and six units of utility for p1,p2, andp3, respectively.
TheColumnsłTruthfulž,łUntruthfulž,andłCollusionžinTable 1
show the three example scenarios, where the players act truth-
fully, untruthfully, and collude among themselves. The Rows łBidž,
łAllocationž, łPricež, and łUtilityž show the bids placed, the final
allocation oftheitem,theclear price, and theutilitiesobtained by
the bidders, respectively.
Same as other first-price auction schemes, CryptoRomeAuction
is nottruthful, i.e., bidding truthfully according to one’s own valu-
ation of the item is not a dominant strategy. In the ideal truthful
scenario, all bidders bid according to their valuations, and p3wins
thebidwithautilityofzero,becausethepaymentequalstohis/herCryptoRomeAuction :=(msдsender 1,msдvalue 1,_)
(msдsender 2,msдvalue 2,_)
(msдsender 3,msдvalue 3,_)
assume:(not(msдvalue 2<msдvalue 1+1))and
(not(msдvalue 3<msдvalue 2+1))
allocate :argmax(msдvalue 1,msдvalue 2,msдvalue 3)
price:max(msдvalue 1,msдvalue 2,msдvalue 3)
Figure 2: The mechanism model of CryptoRomeAuction
with three bidders.
valuationoftheitem.Inanotherscenario,where p3bidsfive(un-
truthfully), his/her utility would increase by one because of the
lower clear price. This is called bid shading , which only affects the
revenue from the auction in this example, but may affect other
participants’ utilities insomeothercases.
In the third scenario, p2andp3collude in order to gain extra
profits.Withfullknowledgeofeachother’svaluations, p2andp3
maydecidetoformacartelandperformbidshading.Onepossibility
istohave p2forfeithis/herchanceand p3bidsfour,andtheydivide
theprofitequallyamongthemselves.Eachofthemgainsoneunit
ofutilityas aresult.
Checking Fairness Properties. Given a mechanism model ab-
stracting the auction settings, the set of fairness properties are
well-definedandcanbeformallyspecifiedbasedonthemodel.The
mainchallengeremainsonhowtoextracttheunderlyingmecha-
nismmodelfromthesmartcontractsourcecode.Nowweillustrate
how this is done for CryptoRomeAuction inFairCon and outline
the process of automated property checking as well as verification.
Albeitvariations inimplementations, all auction contractsshare
somecommoncomponents,suchasthebidders’identifiers,their
bids, and the allocation as well as clear price rules. We rely on
users to provide annotations for these components directly on the
source code, which are demonstrated on Lines 2ś7 in Fig. 1. Specif-
ically,theannotationsspecifythebidders’informationasatuple,
ł@individual(msg.sender,msg.value) ž,indicatingthevariables
usedtostoretheidentifierandthebidvalue,respectively.Similarly,
ł@allocation(highestBidder) ž and ł@price(highestBid) ž in-
dicate that the allocation result and the clear price are stored in
highestBidder andhighestBid ,respectively.Finally,ł @outcome ž
isusedto label the function defining the auctionallocation logic.
With these labels, we perform symbolic execution [ 35] on the
bid()function treating the participants’ inputsÐ msg.value Ðas
symbolicvariables .Theresultofthiswouldbetwosymbolicexpres-
sions for both highestBidder andhighestBid , which symboli-
callyrepresenttheallocationandclearpricefunctions,respectively.
Wecanthenusetheseinformationtosynthesizeanintermediate
mechanism model, shown in Fig. 2. The model is specified in a cus-
tomizedlanguagedesignedforauctionandvotingcontracts.Details
ofthelanguagesyntaxandsemanticscanbefoundinSect. 3.Atthe
highlevel,themodelspecifiesinformationoftheparticipatingin-
dividuals and the auction rules: we consider a bounded model with
onlythreebidders(i.e., msдsender 1,msдsender 2,andmsдsender 3),
their bids have to satisfy the constraint specified in the assume
clause, the allocation function is given as ł argmax(msдvalue 1,
668ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA Ye Liu, YiLi, Shang-WeiLin, andRong Zhao
msдvalue 2,msдvalue 3)ž, and the clear price function is given as
łmax(msдvalue 1,msдvalue 2,msдvalue 3)ž.
The intermediate mechanism model in Fig. 2has well-defined
mathematical semantics, which can be used to check the desired
fairness properties. We encode both the model and the property
withanSMTformulasuchthatacounterexampleexistsifandonly
if the formula is satisfiable. More details on the encoding can be
foundinSect. 4.2.Iftheformulaisunsatisfiable,weareconfident
that the property holds for the bounded case with three bidders.
Wethenattempttoprovethepropertybyinstrumentingthecon-
tract program with program invariants encoding the allocation and
clear price clauses synthesized previously, but parameterized by
an unbounded number of bidders. The instrumented program and
thepropertyarethenpassedtoaprogramverificationtool,suchas
Dafny[38], to perform the automatedverification.
3 THE ANALYSISFRAMEWORKFORSMART
CONTRACTFAIRNESS
Inthissection,wefirstprovidenecessarybackgroundanddefini-
tions on mechanism models and fairness properties well studied
inthemechanismdesignliterature[ 29,45].Thenwegivetheab-
stract syntax and semantics of our mechanism modeling language
to support automatedmodelconstruction andproperty checking.
3.1 SmartContractsas Mechanism Models
Mechanismdesignisusedtodesigneconomicmechanismsorincen-
tivesto helpattain thegoalsofdifferentstakeholders whopartici-
pate in the designated activity. The goals are mainly related to the
outcomethatcouldbedescribedbyparticipants’payoffandtheir
returnintheactivity.Wemodelthelogicbehindsmartcontracts
withamathematical objectknownas the mechanism.
Inamechanismmodel ,wehaveafinitenumberofindividuals,
denoted by N={1,2,...,n}. Each individual iholds a piece of
privateinformationrepresentedbya type,denoted θi∈Θi.Letthe
types of all individuals be θ=(θ1,...,θn), and the space be Θ=
×iΘi. The individuals report, possibly dishonestly, a type (strategy)
profileˆθ∈Θ. Based on everyone’s report, the mechanism model
decides an outcome which is specified by an allocation function
d:Θ/mapsto→O, and atransfer function t:Θ/mapsto→Rn, whereO={oi∈
{0,1}n|Σioi=1}isthe setofpossible outcomes.
The preferences of an individual over the outcomes are repre-
sentedusinga valuationfunction vi:O×Θi/mapsto→R.Thus,vi(o,θi)
denotes the benefit that individual iof typeθireceives from an
outcome o∈O, andvi(o,θi)>vi(o′,θi)indicates that individual
iprefersotoo′. The individual i’s utility under strategy profile
ˆθis calculated by subtracting the payment to be made from the
valuation ofacertainoutcome: ui(ˆθ)=vi(ˆθ,θi)−ti(ˆθ).
3.2 FairnessProperties
Thefairnessofsmartcontractsisusuallysubjecttotheunderstand-
ings and preferences of the participating partiesÐa contract fair to
someone may be unfair to the others. In particular, fairness can be
consideredfromboththeparticipants’andthecontractcreators’
points of view. To capture such nuances, individual parties have to
be modeled separately before such subjective fairness properties
can be specifiedagainst the model.Generally speaking, all properties which can be expressed in
termsofthemechanismmodeldefinedinSect. 3.1aresupported
byourreasoningframework.Tokeepthepresentationsimple,in
this paper, we focus on analyzing a set of generic fairness prop-
ertiesbasedonthemechanismmodels.Werestrictthediscussion
to four types of well-studied properties in the literature, namely,
truthfulness, optimality,efficiency,andcollusion-freeness.
Toformallydefinetheproperties,wefirstintroduceanimportant
conceptÐ dominant strategy . We use ˆθ−ito denote the strategy
profile of the individuals other than i, i.e.,(ˆθ1,...,ˆθi−1,ˆθi+1,...,
ˆθn).Therefore,(ˆθ′
i,ˆθ−i)isusedtodenotethestrategyprofilewhich
differsfrom ˆθonly onˆθi.
Definition 3.1 (Dominant Strategy). A strategy ˆθi∈Θiis a domi-
nantstrategyfor i,if∀ˆθ−i∀ˆθ′
i∈Θi·ui(ˆθi,ˆθ−i)≥ui(ˆθ′
i,ˆθ−i).When
equalityholds,the strategy isaweakdominant strategy.
We say that a mechanism model is truthful if and only if for
anyindividualandstrategyprofile,reportingone’srealtype(truth-
telling, i.e., ∀i∈N·ˆθi=θi) isadominant strategy.
Definition3.2(Truthfulness). Formally,amechanismistruthful
if andonly if, ∀θ−i∀ˆθi∈Θi·ui(θi,θ−i)≥ui(ˆθi,θ−i).
Givenan auction smart contract with manybidderscompeting
forasingleindivisiblegood,theaccountwhichcreatesthecontract
istheauctioneer andtheaccountswhichjointheauctionarethe
bidders. If the auction prevents bidders from benefiting more by
bidding less, it is truthful. When bidding untruthfully is not a good
strategy, the auction can generally attract more honest bidders and
the auctioneer can gethigher revenue for the goodonsale.
Definition3.3(Efficiency). Wesayamechanismisefficientifand
only if its allocation function achieves maximum total value, i.e.,
∀ˆθ∈Θ∀d′·/summationtext.1
ivi(d(ˆθ),θi)≥/summationtext.1
ivi(d′(ˆθ),θi).
Suppose no bidder can affect any other bidder’s valuation. If the
onlywinneristhebidderwhovaluesthegoodthemost,theauction
isefficient.
Definition 3.4 (Optimality). We say a mechanism is optimal if
and only if its transfer function achieves maximum total net profit,
i.e.,∀ˆθ∈Θ∀t′·/summationtext.1
iti(ˆθ)≥/summationtext.1
it′
i(ˆθ).
Similarly, if the winner is the one who bids the highest, the
auction is optimal. In this case, the auctioneer receives the highest
revenue.
We useˆθ−ijto denote the strategy profile of individuals other
thaniandj,i.e.,{ˆθ1,...,ˆθi−1,ˆθi+1,...,ˆθj−1,ˆθj+1,...,ˆθn}.
Definition3.5(2-CollusionFree). Wesayamechanismis2-collusion
free if there does not exist a cartel of individuals iandj, whose
untruthfulstrategiesincreasethegrouputility,formally, ui(ˆθi,ˆθj,
θ−ij)+uj(ˆθi,ˆθj,θ−ij)≥ui(θi,θj,θ−ij)+uj(θi,θj,θ−ij).
Collusion is a big concern in auction and other multi-player
games.Thebasic2-collusionfreenesspropertyinanauctionmeans
thatany twobidders’ collusion cannothelp them achieve higher
gain.Thispreventsbidpricemanipulationtoacertainextent,which
helps guarantee fair chance for allbidders andmaintain goodrev-
enue for the auctioneer. A more general version, i.e., n-collusion
freeness,can be definedinasimilar way.
669TowardsAutomatedVerification of SmartContract Fairness ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA
<individual> :=(id:S,bid:N,val:N)
<func>:=max|argmax
<exp>:=<individual> .id|<individual> .bid
|N|<exp> [+-] <exp> |<func>(<exp>*)
<bool>:=<exp> == <exp>|<exp> < <exp>
|not<bool>|<bool>and<bool>
<assumption> :=assume:<bool>
<outcome> :=allocate :<exp>
|price:<exp>;allocate :<exp>
<property> :=<bool>|forall:<bool>
<mechanism> :=<individual>* ;<assumption> ;<outcome> ;
<property>
Figure 3:Syntax oftheauction/voting mechanismmodel.
(id1,bid1,val1),...,(idn,bidn,valn)[Indiv]
N←{1,...,n}ˆθ←{bid1,...,bidn}
{vi(oi,θi)}←{vali}
assume:assumption allocate :allocation[Alloc]
d(ˆθ)←eval(assumption∧allocation)
assume:assumption price:clearprice[Price]
t(ˆθ)←eval(assumption∧clearprice)
Figure 4:Semanticrulesoftheauction/voting model.
3.3 Mechanism Modeling Language
We nowpropose a domain-specificlanguage to facilitate the auto-
matedtranslation from smart contracts to mechanismmodels.
We define an abstract syntax of the mechanism modeling lan-
guage, which is applicable to both auction and voting. Figure 3
shows the context-free grammar of the language. A mechanism
model comprises one or more individuals , anassumption , anout-
come, and apropertyto be verified. An individual is defined as a
triplecontainingtheidentifierł idž,bidamountł bidž,andvaluation
łvalž.AnassumptionisaBooleanconstraintwhichshouldbesatis-
fied upon the entry of the contract. The outcome of the contract is
specified by the allocation and the clear price functions, which are
expressionsover idandbid.Votingcontracttypicallydoesnothave
aclearpricefunction.Weallowpropertiestobespecifiedusinga
Boolean expressionoptionallyprecededbyałforallžquantifier.
LanguageSemantics. The semanticmappingfromthemodeling
language to the underlying mechanism model is summarized in
Fig.4. The łIndivž rule maps the individuals and their reported
types as well as valuations. More specifically, the individuals’ bids
are mapped to their reported types ˆθ, and an individual of type
θi’s valuation of the item vi(oi,θi)isvali, whereoidenoted the
outcomewheretheitemisallocatedto i.ThełAllocžruleconjuncts
theBooleanexpression assumption fromthełassumežclauseand
thesymbolicexpression allocation intermsofindividuals’strate-
gies from the łallocatež clause, which is evaluated as the allocation
function.Similarly,thetransferfunctionistheconjunctionofthe
assumption andtheclearprice expressions.Therearesomediffer-
encesbetweenauctionandvoting:clearpriceisabsentfromvoting,where allocation is done by comparing the number of ballots (bids)
bytheparticipatingindividuals;whereasinauction,theindividuals
whobidnoless thanthe clear price can be allocatedthe item.
Thislanguageworksforthemostcommonlyseenauctionand
voting contracts with fairness concerns. For example, Ethereum
smartcontractsmeetingtheERC-1202(voting)[ 4]andERC-1815
(blind auctions, under review) [ 6] standards all follow the same
interfaceandstructure,thereforecanbeautomaticallytranslated
intoourmodelinglanguage.Similarlanguagescanalsobedesigned
for other types of contracts (e.g., social games). The proposed mod-
elinglanguagecanbemodifiedandextendedtoestablishsuitable
mappingsfromnewcontracttypestotheclassicmechanismmodel.
Withthenewmodelinglanguage,themodelextractionandprop-
erty checking algorithms can be directlyreused.
4 THE FAIRCONFRAMEWORK
In this section, we present the FairCon verification framework for
smart contract fairness. Figure 5shows the overall workflow of
FairCon.Theframeworkconsistsofthreemodules,namely, model
extraction ,propertychecking ,andfairness verification .
The smart contract source code is first automatically instru-
mented accordingto user-provided annotations.At thisstage,we
consider a k-player bounded model, and the instrumented contract
code contains a harness which orchestrates the interactions be-
tween the players and the target contract. The extraction of the
mechanismmodelispoweredbysymbolicexecutionoftheharness
program, and an intermediate mechanism model issynthesized as
aresult.
Inordertoperformpropertychecking,theintermediatemech-
anismmodel,alongwiththedesiredproperty,areencodedasan
SMTformula,suchthattheformulaisunsatisfiableifandonlyif
thepropertyholdswithrespecttothemodel.WeuseanSMTsolver
to check and may declare the property holds when the number
ofparticipantsareboundedby k;otherwise,acounterexampleis
generatedwhichdisputesthe property.
If we fail to find a counterexample in the bounded case, we may
proceedtothefairnessverificationofthepropertiesforunbounded
number of participants. To do that, we modify the harness to ac-
countforanunlimitednumberofplayers,instrumentitwithpro-
gram invariant as well as the desired properties as post-conditions,
andrelyonprogramverificationtoolstodischargetheproofobli-
gations.Thiseithertellsusthatthepropertyissuccessfullyproved,
orthevalidityofthepropertyisstillunknown,inwhichcasewe
are only confident aboutthe fairnessfor the boundedcase.
4.1 Mechanism Model Extraction
To extract a mechanism model out of the smart contract source
code,wefirstinstrumentthecontractcodewithaharnessprogram
MechanismHarness showninFig. 6.Theharnessprogramorches-
trates the interactions of kplayers with the target contract. This is
achieved by declaring symbolic variables to represent the possible
bid and valuation of each player, stored in the arrays ł BIDž (Line 3)
and łVALUEž (Line4), respectively.Thena for-loop (Lines5ś19)is
usedtosimulatetheactionsperformedbythe kplayers.Insmart
contract,allplayershavetomovesequentiallysinceparallelization
670ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA Ye Liu, YiLi, Shang-WeiLin, andRong Zhao
Instrument
contract ( k-player)
Smart Contract +
Fairness Property pGenerate 
symbolic pathsSynthesize 
mechanism modelTranslate to SMT 
encoding
k-player 
bounded model
Example -guided invariant 
generationProve fairness 
property PVerification 
conditionsCheck fairness 
property P Fairness Proof
Model Extraction Property Checking
Counter -examples
Examples
Predefined invariant 
templatesfailure
success
failuresuccessUnfair
Fair
UnknownInstrumented 
harness programLegend
Input
Process
Data
Result
Figure 5:Workflow ofthe FairCon framework.
1contract MechanismHarness {
2// k-player bounded model
3uintBID[k];// symbolic values
4uintVALUE[k];// symbolic values
5for(uinti=0; i<k; i++) {
6// Example: msg.sender = i
7require(@individual.id ==toStr(i));
8// Example: msg.value = BID[i]
9require(@individual.bid ==BID[i]);
10// Example: bid() function inlined
11@outcome;
12// Example: ALLOCATE = highestBidder
13ALLOCATE =@allocate;
14// Example: PRICE = highestBid
15PRICE=@price;
16// Check loop invariant
17// PRICE = max(BID[0..i] )∧ALLOCATE = argmax( BID[0..i] )
18assert( <invariant> );
19}
20// Check post condition
21assert( <property> );
22}
Figure6:Theharnessprogramformechanismmodelorches-
tration.
is not allowed. The ordering is not important, becausethe players
are symmetric.
We rely on the annotations provided by users (e.g., Fig. 1) to
constructtheloopbody,whichtriggersamovefromoneparticular
player. The variables controlling the player’s identifier and bid
value are assigned the corresponding symbolic values (Lines 7 and
9). In the case of Example 2.1, these variables are msg.sender and
msg.value ,respectively.Thentheallocationfunction(e.g., bid()
in Example 2.1) is inlined, and the resulting variables annotated by
@allocate and@pricearestoredassymbolicexpressions(Lines
13 and 15). There are also two placeholders at Lines 18 and 21,
for assertions of loop invariant and post conditions, which will be
describedinSect. 4.3.
We then run symbolic execution on the harness program to
collect a set of feasible symbolic paths. Each symbolic path is
representedintheformofł Condition∧Effectž,whereł Condition ž
and łEffectž are Boolean expressions in terms of the symbolic vari-
ables defined earlier (e.g., BID[i]andVALUE[i] in Fig.6). Here,łCondition ž represents the path condition which enablesthe execu-
tion of a particular program path; ł Effectž represents the values
oftheresultingvariables(e.g., ALLOCATE andPRICEinFig.6).We
take all path conditions Condition j, where the effect is successfully
computed (i.e., not running into errors or reverts), and use the
disjunction of them as the assumption of the model (i.e., ł assume/logicalortext.1
jCondition jž). Similarly, we use the effects as the corresponding
allocationandclearpricefunctions.Forexample,inthemechanism
model,wehaveł allocate/logicalortext.1
j(Condition j∧Effectj[ALLOCATE])ž
andłprice/logicalortext.1
j(Condition j∧Effectj[PRICE])ž.
4.2 Bounded Property Checking
Forpropertychecking,givenamechanismmodel Mandaproperty
p,ourgoalistoconstructaformula ϕsuchthat ϕisunsatisfiableif
andonlyif M|=p.WiththesemanticrulesdefinedinSect. 3.3,it
is straightforward to obtain a formula encoding the allocation and
clear price functions, i.e., φM=d(θ)∧t(θ).
Weillustratetheencodingofpropertiesusingthetruthfulness
as an example. Definition 3.2states that a model Mis truthful if
andonlyifthetruth-tellingstrategyperformsnoworsethanany
other strategies. Therefore, the high-level idea is to first encode
the truthful and untruthful strategies separately for an arbitrary
player, and then asserting that the utility of the player is higher
when he/she acts untruthfully. The encoding of the truthfulness
property pisshownas follows,
∃i·∀j·(i/nequalj)=⇒
(φM∧(bidi=vali)∧(bidj=valj)) (Truthful)
∧(φM[bidi/bid′
i,ui/u′
i]∧(bid′
i/nequalvali))(Untruthful)
∧(ui<u′
i), (Utility)
whereiis ageneric playerwithutility ui.Thetruthful scenariois
when all players (including i) bid the same amount as their valu-
ations, i.e., bidi=valiandbidj=valj. The untruthful model is
constructedbysubstitutingthebidandutilityvariablesof iwith
newcopies bid′
iandu′
i,andasserting bid′
i/nequalvali.Finally,weassert
thatui<u′
i. Ifpis satisfiable, we find a counterexample where
anuntruthfulstrategyperformsbetterthanthetruthfulstrategy.
671TowardsAutomatedVerification of SmartContract Fairness ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA
Otherwise,thetruthfulstrategyisadominantstrategyfor i.The
encodings ofotherpropertiesare similar.
4.3 Formal ProofforUnbounded Model
ConsidertheharnessprograminFig. 6.Theloopiterates ktimes
to model kplayers joining in each iteration. We use induction
to prove that the smart contract satisfies the fairness property
forarbitrarynumberofplayers.Followingthestandardapproach
to proving program correctness, an invariant for the for-loop is
required,i.e., <invariant> inFig.6.Normally,theloopinvariant
hastobederivedmanually.Fortunately,smartcontractsareusually
written in a more standard way than arbitrary programs, which
makes it easier to generalize invariants for the same type of smart
contracts,e.g.,auctionsconsideredinthiswork.Asetofpredefined
invariant templates(accordingtospecifictypes ofcontracts)have
to be providedto the framework as inputs(Fig. 5). The followings
are three common types ofinvariantsrequiredfor auctions.
ALLOCATE=argmax(BID) (TopBidder)
PRICE=max(BID) (1st-Price)
PRICE=max(BID\{BID[argmax(BID)]})(2nd-Price)
ThełTopBidderžinvariantrequiresthatthebidderwiththehighest
bid becomes the winner. The ł1st-Pricež invariant requires that
the highest bid is the clear price, while the ł2nd-Pricež invariant
requires that the secondhighestbidisthe clear price.
However,theinvarianthastosatisfytwoconditionstoconclude
that the smart contract satisfies the fairness property. To elaborate
ontheconditions,wedefinethefollowingnotations.Lettheharness
program inFig. 6be abstractedas
for(Cond){S;assert(Q)}assert(P),
whereCondis the loop condition, QandPare the<invariant>
and<property> ,respectively,and Srepresentsthestatementsin
theloopbodybeforetheassertionoftheinvariant.Wealsoneed
thestrongestpostcondition [20]operatorfordiscussion.Thenota-
tionsp(Pre,Stmt)represents the strongest postcondition after the
programstatement Stmtisexecuted,providedtheprecondition Pre
before the execution. For example, sp(x=2,‘‘x:=x+1’’)would
bex=3.
Wenowformallydefinethevalidityforinvariants.Theinvariant
has to satisfy the following twoconditions:
(1)the invariant is inductive, i.e., sp(Cond∧Q,S)=⇒Q. Intu-
itively,itmeansthatnomatterhowmanyiterationstheloop
performs, the invariantalwaysholds.
(2)theinvariantisstrongenoughtoguaranteethefairnessprop-
erty,i.e.,Q=⇒P.
If the conditions are satisfied, we can conclude that the smart
contract is fair for arbitrary number of players. The validity of the
conditionscanbecheckedbyanyprogramverificationtools,and
we use Dafny[ 38]inthis work.
Noticethat,inthesearchforvalidinvariant,wegiveupthose
violatingthetwovalidityconditionswhenanalyzingmechanism
models for bounded number of players (c.f. Sect. 4.1). That is, only
those invariants that are valid for the bounded models are con-
sideredinprovingforarbitrarynumberofplayers.Morefairness
propertiesmaybeprovedwhencustomizedinvariantsareprovided.5 IMPLEMENTATION AND EVALUATION
We implement the proposed approach in our tool FairCon, which
takes an annotated smart contract source code with the fairness
property to be checked as input, extracts its mechanism model for
a finite number of players (c.f. Sect. 4.1), and then automatically
performsymbolicpathanalysisonthemodel(c.f.Sect. 4.2).Ifthe
fairness property is violated in one symbolic path, FairCon gener-
atesacounterexamplerelatedtothatpath.Allthesymbolicpath
analysisisachievedbasedontheZ3SMTsolver.Ifnocounterex-
ample is founded within a finite number of players, FairCon then
tries to prove that the smart contract satisfies the fairness property
basedoninductionwiththesetofpredefinedinvariants.Duringthe
process, Dafny [ 38] is used to check the two validity conditions of
invariants (c.f. Sect. 4.3) to establish the fairness proof. To explore
thecapabilityofourproposedapproachinthispaper,weevaluated
FairCon to answer the research questionsbelow.
•RQ1: How accurately does FairCon check fairness properties
onsmart contracts?
•RQ2: How efficient could FairCon be for mechanism model
extractionandfairnessproperty checking?
•RQ3: What are the common patterns for unfair smart contracts?
5.1 Experiment Setup
Many Ethereum smart contracts are token-based and derived from
standard templates (e.g., there are 259,131 ERC-20 contracts on
Etherscan), but such contracts have little fairness concerns. We
collected 47,037 verified2smart contracts running on Ethereum
from the Etherscan website,among which we found 129 contracts
whose name or code contains keyword łauctionž. After code re-
view for these smart contracts, we selected 20 typical auction con-
tracts. The contracts that are not selected are either the presale
contractsforauctionortheauctioncontractsthatendimmediately
after getting one bid, which are not within the scope of our fair-
ness analysis in this paper. These selected contracts are actively in
use,impactingmanyrealusers.Forexample, CryptoRomeAuction ,
hotPotatoAuction , andDeedare used to support popular DApps,
andDeedhas more than 1,469,061 transactions. In fact, the number
ofDAppsonEthereumissmall(2.7K),comparedwiththetotalnum-
ber of contract instances. Among the 20 selected auction contracts,
we found that four auctions completely have the same structure.
Finally,afterremovingduplicateorsimilarcontracts,weselected12
distinct auction contracts for our experiments. Apart from auction
contracts,wealsoselectedfivevotingsmartcontracts.Sototallywe
have17publicsmartcontracts(12forauctionandfiveforvoting)
for our experiments.
To find counterexamples, we set some configurations on mecha-
nismmodelstobechecked.Fortheauctionmechanismmodel,there
arethreebidders,andthebidpriceandthevaluationofbiddersare
arbitrary while allocation will be for one winner only. Similarly,
forthevotingmechanismmodel,weassumethatfivevotersvote
for twoproposals asthebasic configuration.Votervotes toany of
proposalsrandomly,andhisballotcouldbereflectedintothebid
in our mechanism model. Voter has his own valuation for different
proposals, and the winning proposal means the allocation. The
2A contract is labeled łverifiedž on Etherscan if its source code matches with the
deployed version onEthereum.
672ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA Ye Liu, YiLi, Shang-WeiLin, andRong Zhao
Table 2:Fairnesscheckingon auction contracts.
ContractsProperties Time(seconds)
T C O E tmodeltcheck
Auction1 ✗ ✗ ✗ ✗ 7.96 0 .11
Auction2 ✗ ✗ ✗ ✗ 6.04 0 .08
Auction3 ✗ ✗ ✗ ✗ 2.34 0 .08
AuctionItem ✗ ✗ ✓ ✗ 1.29 0 .08
AuctionManager ✗ ✗ ✗ ✗ 1.61 0 .10
AuctionMultipleGuaranteed ✗ ✗ ✗ ✗ 7.48 0 .11
AuctionPotato ✗ ✗ ✗ ✗ 2.45 0 .07
BetterAuction ✗ ✗ ✓ ✗ 1.58 0 .08
CryptoRomeAuction ✗ ✗ ✗ ✗ 7.94 0 .08
Deed ✓ ✓ ✗ ✓ 14.25 0 .07
EtherAuction ✓ ✓ ✗ ✗ 8.43 0 .08
hotPotatoAuction ✗ ✗ ✗ ✗ 5.48 0 .09
Table3:FairnessprovingonfairauctioncontractsinTable 2.
Contracts Allocation Inv. Price Inv. Proved Property
AuctionItem TopBidder 1st-Price O
Deed TopBidder 2nd-Price T, C,E
EtherAuction N/A N/A ś
BetterAuction TopBidder 1st-Price O
actual valuation of winning proposal or failing proposal is the sum
ofvoters’valuationtothatproposal.OnEthereumvotingcontracts
are open to users, we assume voter cannot get any utility if the
voter’ssupportingproposalisnotthewinningproposal.Andthe
valuation of voter to proposal could be measured in two way. The
firstisthatthevaluationismappedtorealnumber.Forinstance,
voter may prefer proposal A much more than any other voters
preferA.Thatisthesituationwherevotersareheterogeneous.The
second setting assigns 0 or 1 to valuation of voter to proposal. For
instance, voter wants proposal A rather than proposal B. This sim-
plifiedversioncouldbeappliedtothesituationwherethevoters
arehomogeneous.Underthesesettings, FairCon checksthefour
fairnesspropertiesatagivennumberofparticipantsaimingtofind
counterexamples.
With the configurationsfor mechanism models, we spent6 hu-
manhourstomanuallyannotatemechanismcomponentsandin-
strumenttheharnessinthesesmartcontracts.Ourexperimentsare
conductedonUbuntu18 .04.3LTSdesktopequippedwithIntelCore
i7 16-core and 32GB memory. We discuss the experiment results
in the following subsections. The raw results and the replication
package are available at: https://doi.org/10.21979/N9/0BEVRT .
5.2 Experiment Results
We nowdiscuss the experiment findingsindetails.
Results for RQ1. ToanswerRQ1,weevaluated FairCon bythe
selected17smartcontractswiththeconfigurationsmentionedin
Sect.5.1. Tables2and4show the results for fairness checking
onauctionandvotingcontracts,respectively.InTable 2,thefirst
column shows the names of the contracts, and the middle four
columnsshowtheresultforthefourfairnessproperties:truthful-
ness(T),collusion-freeness(C),optimality(O),andefficiency(E),Table 4:Fairnesscheckingon voting contracts.
ContractsValuation:R Valuation:{0,1}tmodel
T C E tcheck T C E tcheck
Association ✗ ✗ ✗ 0.35 ✓ ✓ ✓ 0.3764.96
Ballot ✗ ✗ ✗ 0.45 ✓ ✓ ✓ 0.8169.73
Ballot-doc ✗ ✗ ✗ 0.48 ✓ ✓ ✓ 0.56126.14
HIDERA ✗ ✗ ✗ 0.12 ✓ ✓ ✓ 0.1552.23
SBIBank ✗ ✗ ✗ 0.27 ✓ ✓ ✓ 0.6956.59
respectively.Therightmostcolumnindicatesthetimeformecha-
nism model extraction ( tmodel) and for fairness property checking
(tcheck).Amongtheselected12contracts,fourofthemarefoundto
be fair on at least one fairness property, while the remaining eight
contractsarenotfairforallthefourfairnessproperties(withcoun-
terexamplesgenerated).Wehadmanuallycheckedthegenerated
counterexamples and confirmed that they are not false positives.
Regarding the execution time, in our three-bidders experiments,
modelextractiontimevariedfrom1.61to14.25secondsbecausedif-
ferentcontracts have differentmechanismmodelstobe extracted.
Property checking is much faster than model extraction, which
took around 0.1 secondsfor eachcontract.
Table3shows the result of proving fairness properties for the 4
auctioncontracts that are fair onat leastone fairnessproperty,as
showninTable 2.Thefirstcolumnshowsnameofcontract.Thesec-
ond and third columns show the invariant templates that are valid
for proving fairness properties. The last column indicates which
fairnesspropertycanbeproved(Tfortruthfulness,Cforcollusion-
freeness, O for optimality, and E for efficiency). The AuctionItem
andBetterAuction contractscanbeprovedtosatisfytheoptimal-
ity property using the allocation invariant łTopBidderž together
withthe priceinvariant ł1st-Pricež,whichalso confirmsthat they
are first price auctions. The Deedcontract satisfies the łTopBidderž
and ł2nd-Pricež invariants, based on which, FairCon can prove
three properties for Deed, namely, truthfulness, collusion-freeness,
and efficiency.It also confirms that Deedis a second price auction.
TheEtherAuction contract is shown in Fig. 7, which is an vari-
ant of second price auction for a designated bid price only. Line
13 requires a fixed new higher bid price to update the four vari-
ablesSecondHighestBid ,SecondHighestBiddder ,HighestBid ,
andHighestBiddder in Lines 15ś18, respectively. It turned out
thatnoneofourpredefinedinvariantsarevalidtoproveanyfair-
nessproperty.Thisisbecause EtherAuction adoptsthestrategy
of fixed bid price for each round, which makes it similar to (but
actually not)typicalsecondprice auctions.
Table4shows the result of property checking for the selected
five voting smart contracts, each of which is for five voters and
two proposals. The first column shows the names of contracts.
Thelastcolumn, tmodel,showsthemodelextractiontime(insec-
onds).Themiddletwolargecolumnsshowtheaverageproperty
checkingtime(inseconds)forthethreeproperties:truthfulness(T),
collusion-freeness (C)andefficiency (E).We have twosettings for
the valuation component in our mechanism model. One is ranging
over real numbers R, while the other is ranging over {0,1}. The
reason of having two settings is that no contract was found fair
regarding any property, as shows in the second large column of
673TowardsAutomatedVerification of SmartContract Fairness ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA
1contract EtherAuction {
2//Anyone can bid by calling this function and supplying the
corresponding eth֒→
3function bid()public payable {
4require(auctionStarted);
5require(now<auctionEndTime);
6require(msg.sender !=auctioneer);
7// If sender is already the highest bidder, reject it.
8require(highestBidder !=msg.sender );
9address _newBidder =msg.sender ;
10uintpreviousBid =balances[_newBidder];
11uint_newBid =msg.value +previousBid;
12// Each bid has to be 0.05 eth higher
13if(_newBid ==highestBid +(5 * 10 ** 16 ))return;
14// The highest bidder is now the second highest bidder
15secondHighestBid =highestBid;
16secondHighestBidder =highestBidder;
17highestBid =_newBid;
18highestBidder =_newBidder;
19latestBidTime =now;
20// Update the bidder's balance so they can later withdraw
any pending balance֒→
21balances[_newBidder] =_newBid;
22}
23}
Figure 7:The EtherAuction Soliditysource code.
Table4, because the diverse Rvaluation of proposals brings the
incentive for voters to lie and to conspire with others. In the {0,1}
valuation setting, as shows in third large column of Table 4, all
the five contracts are truthful, collusion-free, and efficient. This
is because, if a voter lies, he/she gets at most zero worth utility,
and thus has no incentive to lie. Based on Table 4, we can observe
thatfairnessproperty maydepend ontheconfigurationofmecha-
nismmodels.Differentconfigurationsmayhavedifferentresults
onfairnessproperty checking.
ThecheckingtimefortheoptimalitypropertyisnotlistedinTa-
ble4becausesmartcontractsforvotingdonothavethecomponent
of transfer functions in our mechanism model so that optimality
cannotbedefined(c.f.Sect. 3.2).Inaddition,noneofthepredefined
invariants are valid to prove that the five selected voting contracts
arefair.Weneedtoconstructothervalidinvariantsmanually,which
isone ofour future works.
Answer to RQ1 : Since there is a lack of ground truth, we
manuallyinvestigatedthecasesandtheresultsof FairCon
were confirmed.
Results for RQ2. The time costs studied in RQ2 can be divided
into two parts: model extraction and property checking. Overall,
the model extraction takes much longer time and the property
checking is efficient (taking less than one second for each case), as
showninTables 2and4.
To explore the efficiency of FairCon further, we selected the
CryptoRomeAuction contract to make performance experiments
onFairCon.Figures8and9showtheexecutiontimeformecha-
nism model extraction and fairness property checking when the
numberofbiddersincreases,respectively.InFig. 8,thex-axisshows
thenumberofbidders,whilethey-axisshowsthemechanismmodel
extractiontimeinseconds.Wecanobserve thatmodelextraction
timeisnearlyexponentialtothenumberofbiddersinvolved,which
is reasonable because every participant is independent. When the
number of bidders is under six, the model extraction time is less3 4 5 6 7 802,0004,0006,000
8.1
29.59
106.34
378.1
1,262.29
4,301.52Model extraction time (s)
Figure 8: Model extraction time with increasing number of
bidders.
3 4 5 6 7 800.511.5
0.08
0.1
0.12
0.2
0.43
1.160.08
0.1
0.13
0.21
0.43
1.010.08
0.1
0.12
0.15
0.25
0.520.08
0.09
0.11
0.13
0.19
0.34Property checking time (s)
Truthfulness
Collusion-freeness
Optimality
Eﬃciency
Figure9:Propertycheckingtimewithincreasingnumberof
bidders.
than 10 minutes, which is tolerable. Once the number of bidders
goes beyondsix,the time increasesexponentially.
Figure9shows the property checking time, where the x-axis
indicatesthenumber ofbidders, andthey-axisindicatestheprop-
ertycheckingtimeinseconds.Wecanobservethesametrendas
that in Fig. 8, i.e., the execution time isexponentialto the number
of bidders involved. However, property checking is much faster
than model extraction since model extraction requires symbolic
execution, which is heavy in computation. Mostly the checking
timeislessthanonesecond.Wecanalsoobservethatthechecking
time for truthfulness or collusion-freeness is at least doubled than
that foroptimality andefficiency. Thisis because truthfulness and
collusion-freeness properties need to consider the strategy as well
astheoutcomespaces,whileoptimalityandefficiencyproperties
only have to considerthe outcome space.
Running FairCon onalargenumber(i.e., k,whichistheoreti-
cally unbounded) ofplayers is impracticalfor symbolicexecution.
Theresultsindicatethat FairCon canfindscounterexample(s)with
smallk(e.g.,threetofive),ifthecontractisindeedunfair(e.g., k=3
in Table2andk=5 in Table 4). Otherwise, as shown in Table 3,
FairCon could use invariants observed during the small kruns in
anattempttoprovethatthefairnesspropertyholdsforarbitrary
valuesof k.
674ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA Ye Liu, YiLi, Shang-WeiLin, andRong Zhao
AnswertoRQ2 :Althoughmodelextractionisthebottleneck
ofFairCon,itisaone-timetaskandneednotbeperformedfor
a largek.FairCon is efficient for fairness property checking.
ResultsforRQ3. Fairnessissuesinsmartcontractsarereal.Forex-
ample,EtherAuction (asshowsinFig. 7)wasreportedasascam,3
where bidders compete for one Ether by gradually increasing their
bids. Our results confirmed its unfairness: although truthfulness
andcollusion-freenessholdsforabounded k,optimalityandeffi-
ciencyareviolated.Basedonourreviewofthesubjectcontracts,
we summarize somepatterns below.
(1)Contractsimplementingthefirstpriceauctionandtheirvari-
antsdonotsatisfythetruthfulnessproperty.Forexample,the
aforementioned BetterAuction isimplementingatypicalopen
first price auction, where the top bidder has the incentive to
lower his/herbidprice but stillremainthe winner.
(2)Contracts implementing the first price auction and variants
do not prevent against collusion. For example, BetterAuction
doesnotsatisfy thecollusion-freenessproperty,sincetwo bid-
ders have the chance to lower the clear price and to be the
winner,increasing theirgroup utility.
(3)Contracts implementing the second price auction and their
variants do not satisfy the optimality property. For example,
Deedis one of the contracts implementing the second price
auction. Since the clear price is the second highest bid, the
contractmaynotbe optimalwithapotentialdecreasein total
revenue.
(4)Contractsimplementingthefirstpriceauctionandtheirvari-
ants are not efficient. This is because first price auctions are
untruthful, and the winner may not be the one who has the
highestvaluation ofthe item.
Weenvisionthatfairnesscheckingbeincludedasapartofthe
common-practice validation processtoimprove users’ confidence
towards DApps powered by smart contracts. We hope the fairness
issuesinsmartcontractscanbemitigatedbyalertingdevelopers
andusersthesecommon patterns.
5.3 Threatsto Validity
Our evaluation results are subjectto common threatsto validity.
Lackofgroundtruth. It lacks ground truth for the contracts and
properties we studied. Two of the authors manually inspected the
subjects and our results independently, which took around half an
hour for each contract. We confirmed that the counterexamples
providedbyour toolare valid.
External validity. The types of contracts and properties consid-
eredinthisworkarelimited.Ourfindingsmaynotbegeneralizedto
other cases. The DApps implemented with smart contracts usually
follow typical patterns, mainly due to thelimitations onlanguage
syntax and considerations on gas consumption. We believe that
othertypes ofgame-likecontracts wouldbehave similarly.
3https://hackernoon.com/take-your-chances-at-the-ether-auction-game-
30f9df1ec80b6 RELATED WORK
Our work is closely related to the following research areas: (1) the
functional correctness and security analysis of smart contracts,
(2) the verification of fairness properties in traditional software
systems,(3) andmechanismdesignas well as game theory.
6.1 SmartContract Analysis andVerification
Since smart contract applications are often used to manage a large
sumoffunds,detectionofsecurityflawsinsmartcontractsreceived
a lot of attention. The violation of important security properties
leadstomanywell-knownsmartcontractvulnerabilities[ 54].For
example, a smart contract which fails to check the return value
of a (possibly failed) external call operation, has the unchecked
callvulnerability[ 25,48].Theexecutionlogicofasmartcontract
that is not independent of environmental variables, e.g., the block
timestamp, is prone to dependence manipulation [59], including the
timestamp dependency vulnerability [ 39]. If the business logic of a
smart contract depends on its mutable state parameters, such as
balanceandstorage,thenithasthe transaction-orderingdependence
problem. A smart contract is reentrant, if provided with enough
gas, an external callee can repeatedly call back into it within a
single transaction. Missing permission checks for the execution of
atransfer or aselfdestruct operation make a smart contract
prodigalandsuicidal,respectively[ 44].Absenceofproperchecks
forarithmeticcorrectnessmakeEthereumcontractsproneto integer
and batch overflow/underflow [22,51]. Furthermore, the progress
of a smart contract can be compromised by gas-exhaustive code
patterns [ 16,24].
To address these security issues, Ellul et al. developed a runtime
verificationtechnique,ContractLarva[ 21],toruleoutcertainunsafe
behaviorsduringtheexecutionofsmartcontracts.Oyente[ 2,39]
is one of the first to detect smart contract vulnerabilities using
symbolic execution. ContractFuzzer [ 31] is among the early fuzz
testing tools and Mythril [ 1] is a well-known security analysis tool
which combines symbolic execution and taint analysis to detect
nearly 30 classes of vulnerabilities. There are many other tools [ 14,
34,50,52,55,57,58]designedfor the similar purpose.
Another popular direction is using formal techniques to ensure
thefunctionalcorrectnessofsmartcontracts.Bhargavanetal.de-
visedafunctionalprogramminglanguage,named F∗[12],tofacil-
itate the formal verification of Ethereum smart contracts. Based
onF∗, Grishchenko et al. presented the first complete small-step
semantics of EVM bytecode [ 25]. Hildenbrandt et al. presented an
executable formal semantics for the Ethereum platform, named
KEVM [27], based on which, Park et al. [ 46] presented a deduc-
tive verification tool, capable of verifying various high-profile and
safety-criticalcontracts. Jiaoetal. developedthe operational for-
mal semantics for the Solidity programming language, named K-
Solidity [ 32,33]. Abdellatif et al. [ 7] formalized blockchain and
users’ behaviors to verify properties about their interactions using
statisticalmodelchecking.Nehaietal.[ 43]appliedmodelchecking
to verifysmart contracts from the energy marketfield.
Mostofthesmartcontractanalysesmentionedabovefocuson
findingbugsorsecurityvulnerabilities,whichhighlightmismatches
betweencontractdevelopers’expectationsandhowthecontract
code work; whereas the fairness issues considered in our paper
675TowardsAutomatedVerification of SmartContract Fairness ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA
highlightmismatchesbetweenthecontractusers’expectationsand
the actual implementationofthe game rules.
6.2 FairnessChecking in SoftwareSystems
We believe that fairness should be considered a software quality
attributeÐamongfunctionalcorrectness,security,privacy,etc.Ðone
needs to consider throughout the software development process.
Smart contract is an emerging type of software application with
oftenmultipleinteractingparticipants,wherefairnessbecomesa
lot more relevant.
The problem of algorithmic fairness is considered in manymod-
ern decision-making programs [ 8,19,62], either learned from data
orcreatedbyexperts.Thetermłfairnessžcanbesubjectivedepend-
ingontheactualcontexts.VermaandRubin[ 56]collecteddefini-
tions of fairness from different software domains and explained
therationales behindthesedefinitions. Fromthesoftware specifi-
cationandverificationperspective,Albarghouthietal.[ 8]treated
decision-makingalgorithmsasprobabilisticprogramsandproposed
toverifyformallydefinedfairnesspropertiesonawideclassofpro-
grams. D’Antoni et al. [ 9] introduced the concept of fairness-aware
programming andpresentedaspecificationlanguageandruntime
monitoringtechniquewhichallowprogrammerstospecifyfairness
propertiesintheircodeandenforcethepropertiesduringexecu-
tions. In general, the fairness definition in such decision-making
programsisthattheprogramshowsnobiastowardscertaingroups
ofusers.Thereislittleconsiderationintermsoftheinteractions,
interests, and conflicts between users and programs, or between
usersandusers.
Withregardtosmartcontracts,Bartolettietal.[ 10]foundthrough
asurvey thatnearly0 .05%ofthe transactionsonEthereumcould
beowingtoPonzischemes.Chenetal.[ 17]identifiedpatternsin
contractapplicationsimplementingPonzischemes,andbuiltaclas-
sifier to detect suspicious schemes using data mining and machine
learning. Such contracts can be considered violating fairness prop-
erties,inthesensethatnotallparticipantshavethesamechance
ofgainingprofits.Inthiswork,weexpandthenotionoffairnessin
smartcontractstoincludeanypropertiesexpressibleinmechanism
models.
6.3 Mechanism Design andGameTheory
Mechanismdesignhasbeenwellstudiedintheeconomicdomain[ 29,
36,37,40]. These works offer the theoretical foundation for our
modelextractionandfairnessverification.Manyfairnessproperties
weusedinthispaperarealsoinspiredbythem.Maskin[ 40]articu-
latedsomeimportantconcepts,suchas outcomes andsocialgoals ,
in implementation theory, which is a part of mechanism design.
Heofferedawell-definedexampletoshowhowtoachievesocial
goals. Jackson [ 29] presented mechanism theory in a full view and
provided formal definitions to many concepts belonging to this
domain, while Klemperer [ 36] introduced the most fundamental
concepts for auction and carried out a thorough analysis of op-
timal auctions, the equivalence theorem, and marginal revenues.
Lehmann [ 37] revealed how to exploit truth revelation in realizing
approximatelyefficientcombinationauctionwhichemphasizedthe
co-exist problem of optimalauctionand efficientauction.Mechanism design and game theory were also applied on the
smart contract design. Hahn et al. [ 26] implemented a Vickrey
second price auction on a smart contract to setup and operate a
marketofenergyexchanges.Similarly,Chenetal.[ 18]providedan
e-auctionmechanismbasedonblockchaintoensureconfidentiality,
non-repudiation,andunchangeabilityof theelectronicsealed bid.
CReams [ 61] implemented a collusion-resistant k-Vickery auction.
Galal and Youssef [ 23] presented a smart contract protocol for a
succinctlyverifiablesealed-bidauctionontheEthereumblockchain
to protect bidders’ privacy. Mccorry et al. [ 41] proposed the first
implementation of a decentralized and self-tallying internet voting
protocol using smart contract to guarantee secure e-voting. Bigi et
al.[13]combinedgametheoryandformalmodelstoanalyzeand
validate a decentralized smart contract protocol, named DSCP, and
used game theory to analyze users’ behavior. Chatterjee et al. [ 15]
studied two-player zero-sums games and performed a quantitative
analysisofplayers’worstcaseutilities.Theseworksemploycer-
tain levels of fairness analyses, mostly manual, on some one-off
applications. In contrast, we provide a more general framework
withmaximal automation support.
7 CONCLUSION AND FUTUREWORK
In this paper, we proposed an approach to analyze fairness proper-
ties of smart contracts. We implemented FairCon to automatically
extractmechanismmodelsfromsmartcontractswithuser-provided
annotations, and experimentally evaluated it on 17 real-world auc-
tion and voting contracts. The experiment results indicate that
FairCon is effective in detecting property violations and able to
prove fairnessfor common types of contracts.
In the future, we would like to apply FairCon to other types of
smart contracts beyond auction and voting. It can also be extended
to check for other types of fairness properties that are critical in
maintainingthe integrityof blockchainapplications.
ACKNOWLEDGMENTS
This research is partly supported by the Ministry of Education,
Singapore, under its Academic Research Fund Tier 2 (MOE2018-
T2-1-068)andtheNationalResearchFoundation,PrimeMinisters
OfficeSingaporeunderitsNationalCybersecurityR&DProgram
(NRF2018NCR-NCR005-0001).
REFERENCES
[1]2019. Mythril. https://github.com/ConsenSys/mythril . A Security Analysis Tool
for EVMBytecode.
[2]2019. Oyente. https://github.com/melonproject/oyente . An Analysis Tool for
SmartContracts.
[3] 2020. DAppStatistics. https://www.stateofthedapps.com/stats .
[4] 2020. EIP-1202:Voting Standard. https://eips.ethereum.org/EIPS/eip-1202 .
[5] 2020. Etherscan. https://etherscan.io .
[6]2020. Interface for Blind Auctions (Draft). https://github.com/ethereum/EIPs/
pull/1815 .
[7]TesnimAbdellatifandKei-LéoBrousmiche.2018. FormalVerificationofSmart
Contracts Based on Users and Blockchain Behaviors Models. In 2018 9th IFIP
InternationalConferenceonNewTechnologies,MobilityandSecurity(NTMS) .IEEE,
1ś5.
[8]Aws Albarghouthi, Loris D’Antoni, Samuel Drews, and Aditya V. Nori. 2017.
FairSquare: Probabilistic Verification of Program Fairness. Proceedings of the
ACMonProgrammingLanguages 1 (2017), 80:1ś80:30.
[9]Aws Albarghouthi and Samuel Vinitsky. 2019. Fairness-Aware Programming.
InProceedings of the Conference on Fairness, Accountability, and Transparency .
211ś219.
676ESEC/FSE ’20, November8–13,2020,VirtualEvent, USA Ye Liu, YiLi, Shang-WeiLin, andRong Zhao
[10]Massimo Bartoletti, Salvatore Carta, Tiziana Cimoli, and Roberto Saia. 2019.
Dissecting Ponzi Schemes on Ethereum: Identification, Analysis, and Impact.
FutureGeneration Computer Systems (2019).
[11]Massimo Bartoletti, Salvatore Carta, Tiziana Cimoli, and Roberto Saia. 2020.
Dissecting Ponzi Schemes on Ethereum: Identification, Analysis, and Impact.
Future Generation Computer Systems 102 (2020), 259 ś 277. https://doi.org/10.
1016/j.future.2019.08.014
[12]Karthikeyan Bhargavan,AntoineDelignat-Lavaud, CédricFournet, AnithaGol-
lamudi, Georges Gonthier, Nadim Kobeissi, Natalia Kulatova, Aseem Rastogi,
Thomas Sibut-Pinote, Nikhil Swamy, et al .2016. Formal Verification of Smart
Contracts:ShortPaper.In Proceedingsofthe2016ACMWorkshoponProgramming
Languages and Analysisfor Security . ACM,91ś96.
[13]Giancarlo Bigi, Andrea Bracciali, Giovanni Meacci, and Emilio Tuosto. 2015.
ValidationofDecentralisedSmartContractsthroughGameTheoryandFormal
Methods. In ProgrammingLanguageswithApplicationstoBiologyandSecurity .
Springer, 142ś161.
[14]JialiangChang,BoGao,HaoXiao,JunSun,andZijiangYang.2018. sCompile:
Critical Path Identification and Analysis for Smart Contracts. arXiv preprint
arXiv:1808.00624 (2018).
[15]Krishnendu Chatterjee, Amir Kafshdar Goharshady, and Yaron Velner. 2018.
QuantitativeAnalysisofSmartContracts. In European SymposiumonProgram-
ming. Springer, Cham,739ś767.
[16]Ting Chen,Xiaoqi Li,Xiapu Luo,andXiaosongZhang. 2017. Under-Optimized
SmartContracts DevourYour Money. In Proceedingsof the 2017 IEEE 24th Inter-
national Conference onSoftwareAnalysis, Evolution and Reengineering .442ś446.
https://doi.org/10.1109/SANER.2017.7884650
[17]WeiliChen, Zibin Zheng,Jiahui Cui,Edith Ngai, PeilinZheng, andYuren Zhou.
2018. Detecting Ponzi Schemes on Ethereum: Towards Healthier Blockchain
Technology. In Proceedings of the 2018 World Wide Web Conference . International
WorldWideWeb Conferences Steering Committee, 1409ś1418.
[18]Yi-Hui Chen, Shih-Hsin Chen, and Iuon-Chang Lin. 2018. Blockchain Based
Smart Contract for Bidding System. In 2018 IEEE International Conference on
AppliedSystemInvention(ICASI) . IEEE,208ś211.
[19]AnupamDatta,ShayakSen, andYairZick.2016. Algorithmic Transparencyvia
QuantitativeInputInfluence:TheoryandExperimentswithLearningSystems.
In2016IEEE SymposiumonSecurityand Privacy (SP) . IEEE,598ś617.
[20]Edsger W. Dijkstra and Carel S. Scholten. 1990. Predicate Calculus and Program
Semantics. Textsand Monographs inComputer Science (1990).
[21]JoshuaEllulandGordonJPace.2018. RuntimeVerificationofEthereumSmart
Contracts.In 201814thEuropeanDependableComputingConference(EDCC) .IEEE,
158ś163.
[22]YuFeng,EminaTorlak,andRastislavBodik.2019. PreciseAttackSynthesisfor
SmartContracts. arXiv preprint arXiv:1902.06067 (2019).
[23]Hisham S Galal and Amr M Youssef. 2018. Succinctly Verifiable Sealed-Bid
Auction Smart Contract. In Data Privacy Management, Cryptocurrencies and
Blockchain Technology . Springer, 3ś19.
[24]Neville Grech, Michael Kong, Anton Jurisevic, Lexi Brent, Bernhard Scholz,
and Yannis Smaragdakis. 2018. MadMax: Surviving Out-of-Gas Conditions in
EthereumSmartContracts. ProceedingsoftheACMonProgrammingLanguages
(2018), 116.
[25]Ilya Grishchenko, Matteo Maffei, and Clara Schneidewind. 2018. A Semantic
FrameworkfortheSecurityAnalysisofEthereumSmartContracts.In Interna-
tional Conference onPrinciples ofSecurityand Trust . Springer, 243ś269.
[26]Adam Hahn, Rajveer Singh, Chen-Ching Liu, and Sijie Chen. 2017. Smart
Contract-Based Campus Demonstration of Decentralized Transactive Energy
Auctions.In 2017IEEEPower&EnergySocietyInnovativeSmartGridTechnologies
Conference (ISGT) . IEEE,1ś5.
[27]EverettHildenbrandt,ManasviSaxena, XiaoranZhu, NishantRodrigues, Philip
Daian,DwightGuth,andGrigoreRosu.2017. KEVM:ACompleteSemanticsof
the EthereumVirtual Machine . Technical Report.
[28]EOS IO. 2017. EOS. IO Technical White Paper. EOS. IO (accessed 18 December
2017) https://github. com/EOSIO/Documentation (2017).
[29]MatthewOJackson.2014. MechanismTheory. AvailableatSSRN2542983 (2014).
[30]MamataJenamani,YuhuiZhong,andBharatBhargava.2007. CheatinginOn-
line AuctionśTowardsExplainingthePopularityofEnglishAuction. Electronic
CommerceResearch and Applications 6,1 (2007), 53ś62.
[31]Bo Jiang, Ye Liu, and WK Chan. 2018. ContractFuzzer: Fuzzing Smart Contracts
for Vulnerability Detection. In Proceedings of the 33rd ACM/IEEE International
Conference onAutomatedSoftwareEngineering . ACM,259ś269.
[32]Jiao Jiao, Shuanglong Kan, Shang-Wei Lin, David Sanán, Yang Liu, and Jun
Sun. 2020. SemanticUnderstanding of Smart Contracts: ExecutableOperational
Semantics of Solidity. In 2020 IEEE Symposium on Security and Privacy (SP) . IEEE,
1695ś1712.
[33]Jiao Jiao, Shang-Wei Lin, and Jun Sun. 2020. A Generalized Formal Semantic
FrameworkforSmartContracts.In 2020InternationalConferenceonFundamental
Approaches toSoftwareEngineering (FASE) . 75ś96.
[34]Sukrit Kalra, Seep Goel, Mohan Dhawan, and Subodh Sharma. 2018. ZEUS:
Analyzing Safety of Smart Contracts. In The Network and Distributed SystemSecuritySymposium .
[35]JamesCKing.1976. SymbolicExecutionandProgramTesting. Commun.ACM
19,7 (1976), 385ś394.
[36]Paul Klemperer. 1999. Auction Theory: A Guide to the Literature. Journal of
EconomicSurveys 13,3 (1999), 227ś286.
[37]DanielLehmann,LiadanItaOćallaghan,andYoavShoham.2002.TruthRevelation
in Approximately Efficient Combinatorial Auctions. Journal of the ACM (JACM)
49,5 (2002), 577ś602.
[38]K. Rustan M. Leino. 2010. Dafny: An Automatic Program Verifier for Functional
Correctness. In Proceedings of the 16th International Conference on Logic for
Programming,ArtificialIntelligence,andReasoning (Dakar,Senegal) (LPAR’10) .
Springer-Verlag, Berlin, Heidelberg, 348ś370.
[39]Loi Luu, Duc-Hiep Chu, Hrishi Olickel, Prateek Saxena, and Aquinas Hobor.
2016. Making SmartContracts Smarter. In Proceedings ofthe 2016 ACM SIGSAC
Conference onComputer and Communications Security . ACM,254ś269.
[40]EricSMaskin.2008. MechanismDesign:HowtoImplementSocialGoals. Ameri-
canEconomicReview 98,3 (2008), 567ś76.
[41]PatrickMcCorry,SiamakFShahandashti,andFengHao.2017. ASmartContract
for Boardroom Voting with Maximum Voter Privacy. In International Conference
onFinancialCryptographyand Data Security . Springer, 357ś375.
[42]SatoshiNakamotoetal .2008. Bitcoin:APeer-to-PeerElectronicCashSystem.
(2008).
[43]ZeinabNehai, Pierre-Yves Piriou,andFrederic Daumas. 2018. Model-Checking
ofSmartContracts.In 2018IEEEInternationalConferenceonInternetofThings
(iThings) and IEEE Green Computing and Communications (GreenCom) and IEEE
Cyber,PhysicalandSocialComputing(CPSCom)andIEEESmartData(SmartData) .
IEEE,980ś987.
[44]IvicaNikolić,AashishKolluri,IlyaSergey, PrateekSaxena,and AquinasHobor.
2018. FindingtheGreedy,Prodigal,andSuicidalContractsatScale.In Proceedings
ofthe 34thAnnual Computer SecurityApplicationsConference . ACM,653ś663.
[45]NoamNisanandAmirRonen.2001. AlgorithmicMechanismDesign. Gamesand
Economicbehavior 35,1-2 (2001), 166ś196.
[46]DaejunPark,YiZhang,ManasviSaxena,PhilipDaian,andGrigoreRoşu.2018.
A Formal Verification Tool for Ethereum VM Bytecode. In Proceedings of the
201826thACMJointMeetingonEuropeanSoftwareEngineeringConferenceand
Symposiumonthe FoundationsofSoftwareEngineering . ACM,912ś915.
[47]PeckShield. 2019. EOS: Transaction Congestion Attack .https:
//medium.com/@peckshield/eos-transaction-congestion-attack-attackers-
could-paralyze-eos-network-with-minimal-cost-9adfb4d16c82
[48]Daniel Perezand Benjamin Livshits. 2019. SmartContractVulnerabilities:Does
Anyone Care? (feb 2019). arXiv: 1902.06710 http://arxiv.org/abs/1902.06710
[49]David Siegel. 2016. Understanding the DAO Attack .https://www.coindesk.com/
understanding-dao-hack-journalists
[50] SmartDec2019. SmartCheck . SmartDec. https://tool.smartdec.net
[51]SunbeomSo,MyunghoLee,JisuPark,HeejoLee,andHakjooOh.2020. VeriSmart:
A Highly Precise Safety Verifier for Ethereum Smart Contracts. In 2020 IEEE
SymposiumonSecurityand Privacy (SP) . IEEE Computer Society, 825ś841.
[52]Sofware Reliability Lab 2019. Securify. Sofware Reliability Lab. https://securify.
ch/
[53] Solidity 2018. Solidity. https://solidity.readthedocs.io/en/v0.5.1/ .
[54]PalinaTolmach,YiLi,Shang-WeiLin,YangLiu,andZengxiangLi.2020. ASurvey
ofSmartContractFormalSpecificationandVerification. arXiv: 2008.02712 [cs.SE]
[55]Petar Tsankov, Andrei Dan, Dana Drachsler-Cohen, Arthur Gervais, Florian
Buenzli, and Martin Vechev. 2018. Securify: Practical Security Analysis of Smart
Contracts.In Proceedingsof the2018ACMSIGSACConference onComputerand
Communications Security . ACM,67ś82.
[56]Sahil Verma and Julia Rubin. 2018. Fairness Definitions Explained. In IEEE/ACM
InternationalWorkshoponSoftwareFairness(FairWare) .1ś7.https://doi.org/10.
1145/3194770.3194776
[57]Haijun Wang, Yi Li, Shang-Wei Lin, Cyrille Artho, Lei Ma, and Yang Liu.
2019. Oracle-Supported Dynamic Exploit Generation for Smart Contracts.
arXiv:1909.06605 [cs.CR]
[58]HaijunWang,YiLi,Shang-WeiLin,LeiMa,andYangLiu.2019. Vultron:Catching
VulnerableSmartContractsOnceandforAll.In Proceedingsofthe41stInterna-
tional Conference on Software Engineering: New Ideas and Emerging Results . IEEE
Press,1ś4.
[59]Shuai Wang, Chengyu Zhang, and Zhendong Su. 2019. Detecting Nondetermin-
isticPaymentBugsinEthereumSmartContracts. Proc.ACMProgram.Lang. 3,
OOPSLA, Article189(Oct.2019),29pages. https://doi.org/10.1145/3360615
[60]Gavin Wood. 2014. Ethereum: A Secure DecentralisedGeneralisedTransaction
Ledger.EthereumProject YellowPaper 151(2014), 1ś32.
[61]ShuangkeWu,YanjiaoChen,QianWang,MinghuiLi,CongWang,andXiangyang
Luo. 2018. CReam: A Smart Contract Enabled Collusion-Resistant E-auction.
IEEE Transactions on Information Forensics andSecurity 14,7(2018), 1687ś1701.
[62]Rich Zemel, Yu Wu, Kevin Swersky, Toni Pitassi, and Cynthia Dwork. 2013.
LearningFair Representations.In InternationalConference onMachineLearning .
325ś333.
677