Algebraic-DatatypeTaintTracking, with Applications to
Understanding Android IdentifierLeaks
SydurRahaman
New Jersey Institute of Technology
New Jersey, USA
sr939@njit .eduIulianNeamtiu
New Jersey Institute of Technology
New Jersey, USA
ineamtiu@njit .eduXin Yin
New Jersey Institute of Technology
New Jersey, USA
xy258@njit .edu
ABSTRACT
Current taint analyses track flow from sources to sinks, and report
theresultssimplyassource â†’sinkpairs,orflows.Thisisimprecise
andineffectiveinmanyreal-worldscenarios;examplesincludetaint
sources that are mutually exclusive, or flows that combine sources
(e.g.,IMEIandMACAddressareconcatenated,hashed,leakedvs.
IMEIandMACAddresshashedseparatelyandleakedseparately).
TheseshortcomingsareparticularlyacuteinthecontextofAndroid,
wheresensitiveidentifierscanbecombined,processed,andthen
leaked, in complicated ways. To address these issues, we introduce
a novel,algebraic-datatype taint analysis that generates rich yet
concise taint signatures involving AND, XOR, hashing Å› akin to
algebraic, product andsum, types. We implemented our approach
as a static analysis for Android that derives app leak signatures
Å› an algebraic representation of how, and where, hardware/soft-
ware identifiers are manipulated before being exfiltrated to the
network. We perform six empirical studies of algebraic-datatype
taint tracking on 1,000 top apps from Google Play and their em-
bedded libraries, including: discerning between Å‚rawÅ¾ and hashed
flows which eliminates a source of imprecision in current analyses;
finding apps and libraries that go against Google Playâ€™s guidelines
by(ab)usinghardwareidentifiers;showingthatthird-partycode,
rather than app code, is the predominant source of leaks; exposing
potentialde-anonymizationpractices;andquantifyinghowapps
have become more privacy-friendly over the pasttwoyears.
CCS CONCEPTS
Â·Security and privacy â†’Information flow control ;Mobile
platformsecurity ;Softwaresecurityengineering ;Â·Software
andits engineering â†’Automated static analysis .
KEYWORDS
android, mobile security, static analysis, taint analysis, fingerprint-
ing, identifier leak
ACMReference Format:
Sydur Rahaman, Iulian Neamtiu, and Xin Yin. 2021. Algebraic-Datatype
Taint Tracking, with Applications to Understanding Android Identifier
Leaks.In Proceedingsofthe 29th ACM JointEuropean SoftwareEngineering
Permissionto make digitalor hard copies of allorpart ofthis work for personalor
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ESEC/FSE â€™21, August 23Å›28,2021, Athens,Greece
Â©2021 Associationfor Computing Machinery.
ACM ISBN 978-1-4503-8562-6/21/08...$15.00
https://doi .org/10.1145/3468264 .3468550ConferenceandSymposium on the Foundationsof SoftwareEngineering(ES-
EC/FSE â€™21), August 23Å›28, 2021, Athens, Greece. ACM, New York, NY, USA,
13pages.https://doi .org/10.1145/3468264 .3468550
1 INTRODUCTION
Currenttaint analyses(forAndroid,thisincludes FlowDroid[ 35],
TaintDroid[ 41],Amandroid[ 58])trackwhetherdatafromaprivacy-
sensitive sourceflows toan insecure sink. The analysis resultfor a
sink(e.g.,aleaktothenetwork)isalistofsources(optionally,flows)
thatreachthatsink.First,thisisineffective:thesameleakreportcan
be too alarmist, or not alarmist enough, depending on the context.
Second, this is inadequate as it does not capture the relationship
betweensources,e.g.,mutuallyexclusivesources;neitherdoesit
capturesource processingortheseverityoftheleak,e.g.,hashing
canbeappliedtoeachsourceinturnorhashingcanbeappliedtoa
concatenationofsources.Finally,rich,convolutedÅ‚leaksignaturesÅ¾
are ubiquitous in Android apps, but cannot be exposed by existing
Android taint trackers. Our approach produces expressive leak
signatures;ratherthansimply enumerating sources,e.g.,
ğ¼ğ‘€ğ¸ğ¼,ğ‘€ğ´ğ¶ğ´ğ‘‘ğ‘‘ğ‘Ÿğ‘’ğ‘ ğ‘ ,ğ´ğ‘›ğ‘‘ğ‘Ÿğ‘œğ‘–ğ‘‘ğ¼ğ·
as in current taint trackers, our approach uses formulas indicating
relations between, andoperations on,sources,e.g.,
ğ¼ğ‘€ğ¸ğ¼âŠ• (â„ğ‘ğ‘ â„(ğ´ğ‘›ğ‘‘ğ‘Ÿğ‘œğ‘–ğ‘‘ğ¼ğ· ) âˆ§â„ğ‘ğ‘ â„(ğ‘€ğ´ğ¶ğ´ğ‘‘ğ‘Ÿğ‘’ğ‘ ğ‘ ğ‘  ))
Considerforinstancethe com.appsee mobileanalyticslibrary,which
leaks the hashed phone identifier IMEI onto the network vs. the
io.fabriclibrarywhichleakstherawIMEIontothenetwork.Whilea
conventionaltaintanalysiswouldconsidertheseleaksasequivalent,
theyarenot:therawIMEIleakisdangerous,asitallowstheserver
toidentifythemanufacturerandphonemodel;thehashedleakis
less dangerous since the phone information cannot be identified
(atleastnotdirectly).Ouranalysisdistinguishesthesetwoflows,
encoding the former as ğ‘’,1and the latter as â„(ğ‘’), capturing the
difference.Infact,ourstudyontopAndroidappsshowsthat23%
ofidentifier leaksare hashedleaks,not raw leaks.
As another example, consider the Likes + Followers Instagram app
that leaks the hashed IMEI and AndroidID (signature: â„(ğ‘’) âˆ§â„(ğ‘)),
whichisdifferentfromapp JCPenney thatleakstherawIMEIand
AndroidID(signature: ğ‘’âˆ§ğ‘),whichisdifferentfromapp AARPNow
thatleakseithertheIMEIortheAndroidID,butnotboth(signature:
ğ‘’âŠ•ğ‘);andfinallyapp MoonCalendar withsignature â„(ğ‘’âˆ§ğ‘),notethe
crucialdifferencefrom â„(ğ‘’)âˆ§â„(ğ‘),especiallyrelevantinthecontext
of homomorphic encryption. Current flow analyses would conflate
all these cases declaring Å‚IMEI and AndroidID are leakedÅ¾. Our
study (Section 6.2)quantifies this conflationon1,000 topGoogle
1For conciseness, we use shorthands for Android unique identifiers: ğ‘’for the IMEI, ğ‘
for the AndroidID, ğ‘”for GUID, etc;Section 3.1defines the full list.
70
ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece SydurRahaman, Iulian Neamtiu, XinYin
Play apps: a conventional analysis would conflate 100 apps, whose
signatureis â„(ğ‘)âˆ§ğ‘”,with70appswhosesignatureis ğ‘âˆ§ğ‘”,simply
declaringthat all170apps leakthe AndroidID andthe GUID.
Our taint analysis produces a leak signature that corresponds
to an algebraic, finite (non-recursive) datatype: our logical AND
(â€˜âˆ§â€™) and XOR (â€˜ âŠ•â€™) connectives encode product and sum types,
respectively.This algebraic-datatype encoding allowsusto define
subsumption Å›whatitmeansforanapptoleaklessthananother
app Å›rigorously,viasubsetsemantics.
In Androidapps, leak patterns such as: Å‚leak [a hardware ID]if
available, otherwise, leak [a software ID]Å¾ abound; we capture this
viaXOR.Considerthe CBSNews appwhichleakseithertheIMEI,or
theAndroidID,butnotboth.Traditionalanalyseswouldreportthis
appâ€™s signature as ğ‘’âˆ§ğ‘, i.e., both identifiers are leaked, which is
imprecise.Ouranalysisconstructstheprecisesignature ğ‘’âŠ•ğ‘.More
generally,usingourapproach,developerscancheckpropertiessuch
as: Å‚the app only leaks the IMEI on a real device, otherwise it leaks
the AndroidIDÅ¾. Precisely capturing taint as logically-connected
raworhashedidentifiersiscrucial:ourstudyshowsthattwo-thirds
of leaks are due to leaking identifier combinations (65% of flows
leak combinations of IDs, and only 35% of flows leak individual
IDs). Our algebraic representation isdefinedinSection 3.
Section4presents the design of our static analysis. We use a
noveldataflow-centriccallgraphtoproduceanover-approximation
of app flows, followed by two refinement phases Å› separating raw
leaksfromhashedleaks,andappâ€™sownflowsfromthird-partyflows
Å› finally yielding an algebraic leak representation aka signature.
While we focus on hardware identifiers in this work, our imple-
mentation is generic Å› other privacy-sensitive sources, e.g., GPS
location,canbetrackedbysimplyindicatingtherelevantsource
methodsinour sourcedefinitionfile.
In Section 5we evaluate our approach. The main dataset con-
sistedof1,000topappsfromGooglePlay,chosenfrom19categories,
andthe821librariestheseappsembed.Wefoundthattheapproach
is effective. First, when compared to the state-of-the-art FlowDroid
staticanalyzer,ourapproachdiscovers2.1xasmanyleaks,while
sheddinglightonthenatureandlocationoftheleak.Second,when
compared with ground truth, our approach attains 72.6% preci-
sion and 100% recall. The approach is also efficient, with a median
analysistime per app of347seconds.
InSection 6,weconductaseriesofempiricalstudiestoexamine
(a)thelandscapeandevolutionofthe1,000topGooglePlayapps
interms of privacy leaks involvingnon-resettable Å‚hardwareÅ¾ and
resettableÅ‚softwareÅ¾ IDs, and (b) their embedded libraries, with a
focusontop-20 libraries (financial, advertising,analytics).
An analysis of worst-case leaks, i.e., hardware identifiers sent
raw, has found that 57% of the apps leak at least one of the raw
hardware IDs (IMEI, IMSI, Serial#, MAC Address), which is at odds
with Googleâ€™s ID usage guidelines. In fact, 7 out of the top-10 most
common signatures involve hardware IDs.
Wefoundthatoutoftop-25leakiestapps,13appsleakhardware
IDswithnofinancial justification;among top-20leakiestlibraries,
only3arefinancial(whereGoogleguidelinespermithardwareIDs).
Certain identifiers, e.g., IMEI, tend to be leaked by libraries,
whereasothers,e.g.,MACAddress,byowncode.Overall,59%of
leaks are due to third-party libraries and 41% leaks are due to appsâ€™
own code. This has important implications because leaks due tothird-partycodecangetanappremovedfromGooglePlay,even
though the developer (appâ€™s own code) has followed the guidelines.
Finally,bycomparingappsâ€™ versionsfrom2018withtheir2020
counterparts we found a decrease in the use of raw/hardware iden-
tifiers, indicating that apps have become more privacy-friendly.
Our work makesseveral contributions:
â€¢A novel, algebraic-datatype taint representation, enabling
expressive yetconcise leaksignatures andleakanalysis.
â€¢An implementation of algebraic taint tracking as a static
analysisfor Android.
â€¢A six-part empiricalstudy, characterizing identifier (ab)use
intopAndroidappsandlibraries.Thestudydemonstrates
the flexibilityandprecision of our algebraic representation.
Our implementation, along with the signatures found for the
apps usedinthe evaluation, are available as open source.2
2 MOTIVATION AND DESIGN CHOICES
Taint analyses determine whether data from a privacy-sensitive
source(e.g.,MACAddress)flowstoaninsecuresink(e.g.,Internet).
Currentanalysesâ€™imprecision affectstheir usability.For example,
applyingastandardAndroidtaintanalysisproducesthesameresult
(IMEIâ†’Internet), inthree differentscenarios:
(1)theappexfiltratestheIMEItoathird-partyserver(e.g., Blink
HealthRX [10]);thispracticeisdiscouragedorforbiddenby
Google Play guidelines, depending on the nature of the app.
(2)the app (e.g., CareZone [1]) links with a financial library that
uses the IMEI for payment fraud prevention; this is allowed
bythe guidelines.
(3)theapp(e.g., SpectrumTV [29])concatenatestheIMEIwith
another identifier, e.g., AndroidID, hashes the result, and
uses this hash value for customer identification. Since the
actualIMEIcannotbereverse-engineered,theprivacyloss
islower comparedto the firstandsecondscenarios.
Conflating these three use cases is problematic, as they are very
differentintermsofguidelinescomplianceandprivacyimplications.
We combine a precise static analysis with an algebraic representa-
tionthat can distinguishbetween these,andother,scenarios.
Android identifiers. Our analysis considers the seven popular
Android IDs described in Table 1. The first four are Å‚hardwareÅ¾
identifiers, i.e., tied to the specific phone hardware, and cannot
be reset/changed in software; the remaining three are resettable
identifiers.Google/Androiddeveloperguidelineshavespecificpoli-
ciesdesignedtoprotectuserprivacy[ 8]bydiscouraging,oreven
forbidding, access to hardware identifiers, such as:
â€¢Å‚Avoid using hardware identifiersÅ¾
â€¢Å‚Onlyuse an AdvertisingID for userprofiling oradsÅ¾
â€¢Å‚Use an Instance ID or GUID whenever possible for all other
use cases, except for payment fraud prevention and telephonyÅ¾
â€¢Å‚Byits nature,fraudprevention requires proprietary signalsÅ¾
To sum up, the only acceptable use of hardware identifiers is
financial/fraud detection; all other scenarios, e.g., advertising or
analytics,requiretheuseofresettableidentifiers.Manyappsviolate
theseguidelines;tocounterthisabuse,asshowninTable 1â€™sÅ‚MAC
2https://github .com/sujon335/AlgebraicDatatypeTaintTracker
71Algebraic-Datatype Taint Tracking, withApplicationsto UnderstandingAndroid Identifier Leaks ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece
APKIdentifier APIData -flow & Control -flow Analysis
IMEI IMSIâ€¦.AndroidID
Dataflow -
centric 
Call
GraphAmandroidSHA
MD5
nameUUIDFromBytesHashed LeakRaw Leak Third -party 
(Library) Code
Own CodeHash Analysis Signature Output
IMEI
IMSI 
h(IMEI)
h(AndroidID)âŠ•h(IMEI)âŠ•
h(AndroidID)IMEI âˆ§IMSIThird -party vs. Own Analysis
Hashing Methods. . .
Network APIâˆ§ âŠ•âˆ§
CFG
Algebraic Taint
Figure 1:Overview.
Table 1:Identifiersconsidered andtheir semantics.
ID SemanticsHardwareIMEI/MEID 15-digit; identifies mobilephone
IMSI 15-digit; identifies SIM/network subscriber
MAC 48-bit; identifies the network card
Address -actualvaluereportedbyAndroid <6
-Å‚02:00:00:00:00:00Å¾ reported by Android 6 âˆ’9
-randomized valuereported byAndroid â‰¥10
Serial# Manufacturer-assigned;identifies deviceResettableAndroidID Android â‰¥8:unique for an app orapp group
Android<8:uniqueuser&devicecombination
GUID identifies app instance
AdvertisingID identifies userfor adtrackingpurposes
AddressÅ¾ line, the Android platformâ€™s recent versions took increas-
inglystringentmeasures, firstreportingaconstant MACAddress,
and then a randomized one. Android version 10 (used by 8.2% of
Android devices as of February 25th, 2021, per Android Studio)
restrictsaccesstohardwareidentifierstoprivileged(e.g.,system,
vendor) apps; this does not affectthe generalityofour approach.
3 ALGEBRAIC-DATATYPE
REPRESENTATION FORSIGNATURES
In type theory, a product type is the type of an n-ary tuple, e.g.,
in OCaml the tuple (1,3.14,"foo") has type int * float * string . A sum
typeis thetypeofaunion,e.g.,inC, unionu{inti;floatf;} orthe
OCaml[49]variant typenumber=Intofint |Floatoffloat have
producttype intâŠ•float(eitheran intorafloat,butnotboth,inhabit
the variant). Our core insight is an algebraic-datatype definition
of taint: identifiers are base types and leak signatures are finite
(non-recursive)algebraic types over basetypes.
3.1 Definitions
We define these shorthands for the Android identifiers: ğ‘’for the
IMEI,ğ‘ fortheIMSI, ğ‘fortheAndroidID, ğ‘ŸforSerial, ğ‘šforMAC
Address,ğ‘£for AdvertisingID, ğ‘”for GUID.
Signatures can be identifiers; hashes; or combinations thereof
introduced via AND or XOR. We use ğ‘†andğ‘‡as metavariablesfor
signatures. Henceour signature grammarisdefinedsimply as:
ğ¼ğ‘‘ğ‘’ğ‘›ğ‘¡ğ‘–ğ‘“ğ‘–ğ‘’ğ‘Ÿ ğ‘– ::=ğ‘’|ğ‘ |ğ‘|ğ‘Ÿ|ğ‘š|ğ‘£|ğ‘”
ğ‘†ğ‘–ğ‘”ğ‘›ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ ğ‘† ::=ğ‘–|â„(ğ‘†) |ğ‘†âŠ•ğ‘†|ğ‘†âˆ§ğ‘†AND,denoted ğ‘†âˆ§ğ‘‡,indicatesthat bothğ‘†andğ‘‡(whichcanbe
identifiersorsignatures),areused.Thiscorrespondstoaproduct
type in type theory, and Cartesian product in set theory. Note that
we deliberately use â€˜ âˆ§â€™ instead of the standard type theory symbol
â€˜Ã—â€™as itismore suggestive inour context.
XOR, denoted ğ‘†âŠ•ğ‘‡, indicates that either ğ‘†orğ‘‡is used, but not
both. This corresponds to a sum type in type theory,3and disjoint
set union in set theory. We use â€˜ âŠ•â€™ instead of the standard â€˜ +â€™ from
type theory as itismore suggestive inour context.
Hash. The hash, denoted â„(ğ‘†), indicates that an identifierâ€™s hash
(orthehashofanidentifiercombination)isleaked,nottheactual
Å‚rawÅ¾identifier(s);e.g., â„(ğ‘’)couldbecomputedviahashingmethods
nameUUIDFromBytes(IMEI.getBytes()) ormd.digest(IMEI.getBytes()) .
3.2 Properties
Defining formally what it means for a program to leak lessthan
anotherprogramiskey.Forthispurposeweintroducethe subsump-
tionrelation,â€˜ <:â€™,inducedbysubsetsemantics.Informally,app ğ´
leaks less than app ğµ, akağµsubsumes ğ´, if the set of all possible
valuesleakedby ğ´isasubsetofthesetofallpossiblevaluesleaked
byğµ. We now define subsumption for the algebraic representation.
Subsumption(AND). Anappwhosesignatureis ğ‘†leakslessthan
anappwhosesignatureis ğ‘†âˆ§ğ‘‡;thisisdenoted ğ‘†<:ğ‘†âˆ§ğ‘‡.Similarly,
anappwhosesignatureis ğ‘‡leakslessthananappwhosesignature
isğ‘†âˆ§ğ‘‡; this isdenoted ğ‘‡<:ğ‘†âˆ§ğ‘‡.
Subsumption (XOR). An app with signature ğ‘†âŠ•ğ‘‡leaks less than
an app whose signature is ğ‘†âˆ§ğ‘‡.
Subsumption(hash). Anappwithsignature â„(ğ‘†)leaksless4than
an app withsignature ğ‘†; this isdenoted â„(ğ‘†)<:ğ‘†.
First,notehowsubsumptionintroducesapartialorder(incertain
cases, a total order) on appsâ€™ leaking properties: its power becomes
apparent in Section 6when we use it to check whether a signature
subsumesanother(i.e.,anappleaksmorethananotherapp,ormore
than a different version of the same app). Second, the algebraic
representation naturally induces equivalence classes : apps with the
same signature will leak the same identifiers (and semantically, the
identifiers are manipulatedinthe same way,e.g.,hashed).
3Technically, inthe Curry-Howard isomorphism [ 45],sum typescorrespond to OR
in logic, not to XOR. However OR is not our intended semantics, since ğ‘=ğ‘‡ğ‘…ğ‘ˆğ¸
inğ‘âˆ¨ğ‘=ğ‘‡ğ‘…ğ‘ˆğ¸does not force ğ‘to beğ¹ğ´ğ¿ğ‘†ğ¸whereas in our semantics it does
(mutualexclusion);alongerexplanationisavailablehere[ 52].Oursemanticsisreadily
apparent in the Church Boolean [ 39] function XOR, i.e., ğœ†ğ‘.ğœ†ğ‘.ğ‘(ğ‘›ğ‘œğ‘¡ ğ‘)ğ‘, where if
ğ‘reduces to TRUE, (ğ‘›ğ‘œğ‘¡ ğ‘)mustreduce to FALSEfor the XOR to reduce to TRUE.
4Å‚Leaks lessÅ¾ in aprivacy/cryptographic sense, ratherthan strictly â„(ğ‘†) âŠ†ğ‘†.
72ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece SydurRahaman, Iulian Neamtiu, XinYin
1String getTelephonyDeviceId(Context context) {
2 String deviceIMEI = ((TelephonyManager)
context.getSystemService( "phone")).getDeviceId() ;
3 returndeviceIMEI; }
4String getAndroidId(Context context) {
5 String androidId = Secure.getString(context.getContentResolver(),
"android_id" );
6 returnandroidId; }
7String getWifiMacAddress(Contextcontext) {...
8 String mac=wifiManager.getConnectionInfo().getMacAddress();
9 returnmac; }
10String getUniqueDeviceID(Contextcontext) {
11 returngenerateDeviceId(getTelephonyDeviceId(context),
getWifiMacAddress(context), getAndroidId(context));
12}
13String generateDeviceId(String str, String str2, String str3) {
14 if(! TextUtils .isEmpty(str)) { // str3â†’{a}
15 str3=str; // str3â†’{e}
16 }
17 else if(! TextUtils .isEmpty(str2) &&!TextUtils .isEmpty(str3)) { //
str3â†’{a}
18 str3 =newUUID((long) str3.hashCode(), ( long)
str2.hashCode()).toString () ; // str3â†’{h(m)âˆ§h(a)}
19 }else if( TextUtils .isEmpty(str3)) { // str3â†’{a}
20 str3=UUID.randomUUID().toString(); // str3â†’{g}
21 }
22 returnstr3;// str3â†’{eâŠ•aâŠ•h(m)âˆ§h(a)âŠ•g }
23voidSendDeviceinfo() {...
24 httpParaMap.put( "deviceID" , getUniqueDeviceID(context).toString ());
25 ...}
Figure 2:UUIDgenerationinthe Audiobooks.com app.
4 APPROACH
The architecture ofour systemis shown inFigure 1. GivenanAn-
droidapp(APKfile),weperformachainofanalysestoconstruct
the appâ€™s leak signature: control- and data-flow analyses that com-
puteandpropagate algebraictaint;asecondaryanalysis todetect
hashing;andathird-partyvs.ownanalysis.Theinitialcontrol-flow
graphisproducedbytheAmandroidstaticanalyzer[ 58](shown
ingray; not acontributionofthis work).
Our approach operates from generic sources/sinks: any variable
or API method can be used as source; similarly for sinks. These are
specifiedinasourceinputfileandsinkinputfile,respectively,asis
common for flowtrackers.
4.1 Motivating Example
Weillustrateourapproach,andcontrastitwithpriortaintanalyses,
ontheAudiobooks.com [7]app.Therelevantsourcecodeisshown
inFigure 2.TheappattemptstoleakanuniquedeviceID,akaUUID
onto the network via SendDeviceInfo() (lines 23Å›25). The UUID is: the
IMEI,ifavailable(retrievedonlines1Å›3);ifnotavailable,thehashes
ofMACAddressandAndroidIDiftheyareavailable(lines4Å›12);
otherwisetheGUID,ifavailable(line20);finally,ifnoneofthese
conditions are met, AndroidID isthe UUID.
Traditionaltaintanalyzers,e.g.,FlowDroidorAmandroid,per-
formtaintanalysisofeachsourceseparatelyandreporttheleaks
separately. For the aforementioned code snippet, such tools per-
formfourtaintedpathscalculationsforfourdifferentsources(IMEI,
MACAddress,AndroidID,andGUID),asillustratedinFigure 3(top).
Eventually they produce a report stating that all four identifiers
areleaked.This,however,isimprecisefortworeasons.First,theidentifiersâ€™ hashedvalues are leaked, which isless dangerousthan
rawleaks. Second, the tools fail to report the aggregation: actually
MACaddressandAndroidIDareused together,exclusiveofIMEI
andGUIDÅ›i.e.,asignature,whereasthetoolsreportseparateleaks.
In contrast, our analysis produces the correct signature. The
high-levelviewisshowninFigure 3(bottom);lower-leveldataflow
analysis will be discussed shortly. Instead of simple taint propa-
gation, we propagate algebraic taint. For the example shown in
the figure, instead of four different leaks, we report one precise
signature,the leakactually present here,that is:
ğ‘’âŠ• (â„(ğ‘š) âˆ§â„(ğ‘)) âŠ•ğ‘”âŠ•ğ‘
4.2 Dataflow-Centric CallGraphConstruction
andAnalysis
While other static taint analyzers [ 35,58] perform interprocedural
control- and data-flow analyses (as we do), their taint facts and
propagationarebothimpreciseandinsufficientforourpurposes.
We address this via a series of analyses, the first of which is call
graphextraction ,as explainednext.
4.2.1 Call Graph Extraction. We start our analysis from the
Amandroid-generated control-flow graph, and soundly5extract
thesub-graphwherethealgebraictaint-relevantdatapropagates.
We illustrate our approach in Figure 4: the top shows the source
codewhilethebottomshowsourdataflow-centriccallgraph(the
greyedges/verticesdepict thepartsofthecontrolflowgraphthat
can be soundly abstracted away). In the source code, the IMEI
is obtained via the Android API on lines 6 and 7, and stored in
hardwareDeviceId . On line 8, the IMEI flows into the putUUID()method
asaparameter;theIMEIissavedintoa JSONObject online11.Our
graph capturesthis dataflow.We can see a dataflow edgebetween
thehardwareDeviceID andjsonObjectvariables where the IMEI data is
savedaskey-valueJSONdata.Next,ifwefollowthedataflowofthe
jsonObjectcurrentlyholdingtheIMEIdata,thedataissavedintoa
newvariable uuidonline14inthe getPersistentUUID() method.Thisis
captured by the edge between jsonObject anduuid. Finally, on line 21,
thehashMapcreates an entry (key-value pair) with deviceIDas key
andIMEIasvalue,resultinginanedgefrom uuidtohashMapinthe
graph. Next, our dataflow analysis (forward/may Å› a variant of
reachingdefinitions[ 34])propagatesalgebraictaintontopofthe
graph.
4.2.2 Dataflow Analysis. We illustrate our dataflow analy-
sis on the program in Figure 2, method generateDeviceID . A
simplified-for-legibility version of the ğ‘‚ğ‘¢ğ‘¡(ğ‘ )sets limited to vari-
ablestr3areshownascommentsontherightsideofthecode.At
the beginning the set contains the value {a}, i.e., AndroidID. At
line 15, str3is assigned a new value which contains the IMEI, {e}.
Theğ‘‚ğ‘¢ğ‘¡(ğ‘ )setforthestatementatline18containsthecombined
hash value signature, (h(m)âˆ§h(a));str3is then assigned {g}, GUID,
at line 20. For each statement, the union of the ğ‘‚ğ‘¢ğ‘¡(ğ‘ â€²)of all the
predecessors ğ‘ â€²ofğ‘ givesthe ğ¼ğ‘›(ğ‘ )value[34,47].Inourexample,
line22â€™spredecessorsetislines{14,15,18,20}(ofcourse,intheac-
tualanalysis,conditionalstatementsaremorefine-grainedhence
5Technically soundy[50] Å› our approach is sound up to native code (because we
leverage Amandroid, which is sound up to native code) which is par for the course for
Java/Android analyses.
73Algebraic-Datatype Taint Tracking, withApplicationsto UnderstandingAndroid Identifier Leaks ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece
h(a)
h(m) âˆ§h(a)deviceIMEImac
Source
(AndroidID )
Source
(IMEI)androidIdSource
(Mac 
Address)
getUniqueDeviceID ()generateDeviceId ()str2
generateDeviceId ()
generateDeviceId ()str3
strreturn 
registerSink
(SendDeviceinfo ())Source
(GUID)Prior Analyses m
a
eg
str3
deviceIMEImac
Source
(AndroidID )
Source
(IMEI)androidIdSource
(Mac 
Address)
getUniqueDeviceID ()generateDeviceId ()str2
generateDeviceId ()
generateDeviceId ()str3
strreturn 
register
Sink
(SendDeviceinfo ())Source
(GUID) m
a
eg
str31. Leak of m
2. Leak of a
3. Leak of e
4. Leak of g
hashing
Conditional 
Block (âŠ•)Concatenation
(âˆ§)h(m)
e âŠ•(h(m) âˆ§h(a)) âŠ•g âŠ•a  e âŠ•(h(m) âˆ§h(a)) âŠ•g âŠ•a Our Analysis
Figure 3:Prior taintapproaches(top) vs.our approach(bottom).
1public class PersistentUUID {
2JSONObjectjsonObject= newJSONObject();
3private static final String UUID_KEY= "nr_uuid" ;
4...
5 private void generateUniqueID(Contextcontext) {...
6 TelephonyManager tm = (TelephonyManager)
context.getSystemService( "phone");
7 hardwareDeviceId= tm.getDeviceId() ;
8 putUUID(hardwareDeviceId);...
9 }
10 protected void putUUID(Stringuuid) {...
11 jsonObject.put(UUID_KEY, uuid); ...
12 }
13 publicString getPersistentUUID() {...
14 uuid = jsonObject.getString(UUID_KEY);...
15 returnuuid;
16 }
17}
18public class AndroidAgentImpl{
19 public void sendDeviceInformation() {...
20 hashMap.put( "Model",Build.MODEL);
21 hashMap.put( "deviceID" ,persistentUUID.getPersistentUUID()) ;...
tm
(generateUniqueID )IMEIAPI
â€¦.Dataflow -centric Call Graph
hardwareDeviceID
(generateUniqueID )
jsonObject
(putUUID)
uuid
(getPersistentUUID )
hashMap
(sendDeviceInformation )â€¦.
Figure 4:Source codeandits dataflow-centriccallgraph.
we typicallyperforms two-way joins ratherthanafour-way join).
Hence at program joint point (line 22), the Inset, in this case iden-
tical to the Outset,whichrepresents the UUIDsignature,is:
ğ‘’âŠ• (â„(ğ‘š) âˆ§â„(ğ‘)) âŠ•ğ‘”âŠ•ğ‘Akeyfactor thatinformedouranalysisdesign,andhelpskeep
the analysis precise, was our observation (drawn from manual
taint analysis, Section 5.1.2) that appsâ€™ code for constructing the
signature, such as the code discussed above, tends to lack back
edges, whichhelpscontain dataflowsetssize.
4.3 Hash Analysis
As illustrated in Figure 1, hashed leaks are leaks that flow through
hashing methods, e.g., MD5. We detect such flows by setting up
another flow analysis as follows. First, we set the entry of hash
methodsas sinks.Next,wesetthereturnofhashmethodsas sources
and network API methods as sinks.As a result, we separate the un-
derlyingidentifiersleaksinto rawleaks andhashedleaks .Notethat
ouranalysistakesaÅ‚HashingMethodsÅ¾listasinput;weconstructed
this list based on an exhaustive analysis of hashing functions/prac-
tices available in Java and practices used by manually-analyzed
Android apps. For example, some common hashing Java API meth-
odsinclude MD5,SHAandnameUUIDFromBytes() ,orJavaclassessuch
asMessageDigest .Thislistisuser-configurablehenceeasilyextended.
4.4 Third-Party vs. Own CodeAnalysis
To separate own leaks from third-party leaks we used a predefined
list of common third-party libraries as reference,6along with flow
partitioning. Specifically, if an identifierâ€™s entire flow involves only
third-party library methods, we tag that leak as third-party leak;
otherwisewetagitas owncodeleak.Wehavenotfoundanycross-
flowbetweenthird-partycodeandowncodeinourexaminedapps.
4.5 Example
In Figure 5, we show an example that illustrates both hashing
andthird-partyvs.ownanalysis,fromapp CGTN.TheIMEIisbe-
ing hashed by the cryptographic hashing method MessageDigest(SHA)
(lines4,7and8).Theleakhappensinsidetheappâ€™sownpackage,
sowe categorize itas â€˜ownâ€™.The leaksignature is, therefore :
â„(ğ‘’)[own]
6The same library can appear under different names in different apps due to obfus-
cation; we mapped obfuscated librariesâ€™ names to a unique name, common across all
apps, for that library.
74ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece SydurRahaman, Iulian Neamtiu, XinYin
1public static String getDeviceId(Context me) {
2 TelephonyManager telephonyManager = (TelephonyManager)
me.getSystemService( "phone");
3 String IMEI = telephonyManager.getDeviceId();
4 MessageDigestmd = MessageDigest.getInstance( "SHA");
5 byte[] dat = null;
6 if(IMEI== null)return"";
7 md.update(IMEI.getBytes());
8 returnhashByte2String(md.digest());
9}
Figure 5:Cryptographichashingin
5 EVALUATION
Weevaluatedourapproach,andperformedsixstudies,on1,000top
apps from Google Play. The 1,000 apps span 19 popular categories
from Google Play. The distribution Å› number of apps per category
Å› is shown in Table 2. The number of apps varied slightly across
categoriesaswefavoredpopularapps.Fortheevolutionstudyonly
(Section6.6),wecomparedappsâ€™year2018versionswiththeiryear
2020 counterparts,i.e.,2,000 APKs.
5.1 Effectiveness
Wefirstevaluatetheeffectivenessofourapproachbycomparing,on
the1,000 apps, with state-of-the-artFlowDroid; next, we compare
withgroundtruthon64appswhereflowsweretrackedmanually.
5.1.1 ComparisonwithFlowDroid. WerantheJuly2020version
of FlowDroid from its official GitHub page [ 2] on our 1,000-app
dataset.We configuredFlowDroidto match our configuration: we
enabled implicit flow analysis and context sensitivity. Dataflow
analysis, callback collection during call graph construction, and
resultcollectiontimelimitsweresetto1000seconds,1000seconds,
and 500 seconds respectively. As a point of reference, our analysisâ€™
mediantimeperappwas347seconds(Section 5.2),sowebelievethe
aforementioned time limits are reasonable. We directed FlowDroid
to use sources and sinks that match ours. As sources, we used
the API methods responsible for retrieving the 7 identifiers we
track (Table 1). For sinks, we used the SuSi list [ 3], i.e., all possible
sinks under NETWORK_INFORMATION category, as we are only
interestedinexfiltrationtothenetwork.NotethattheAPImethods
that read the â€˜Serialâ€™ and â€˜AdvertisingIDâ€™ cannot be expressed in
FlowDroidâ€™staint sourceformat, sowe markedthoseas â€˜n/sâ€™.
We show the results in Table 3: the number of apps where leaks
werefound,byFlowDroidandourapproach,respectively.Wemake
threeobservations.First,FlowDroidmissesasubstantialnumberof
leaks,asitreports46%oftheleakswereport,1083vs.2335(forthose
fiveIDswecouldrunFlowDroidon);priorworksuggeststhatfalse
negativesâ€™ root causes in FlowDroid/SuSi include inter-component
communication (ICC) and imprecise sink/source lists [ 56]. Our
approachhandlesICCbydefault(viaAmandroid).Evenwiththe
generoustimelimitsweset,FlowDroidtimedoutandcouldnotfind
alltheleaks.Second,FlowDroidcannotdistinguishbetweenraw
andhashedleaks,asourapproachdoes(thirdandfourthrowsshow
theraw/hashedsplit).Third,ourapproachhassomefalsenegatives
compared to FlowDroid (i.e., we miss leaks that FlowDroid does
notmiss),asdepictedinthelastrow.Wefoundthatfalsenegatives
originateintheCFGprovidedbyAmandroidÅ›whenAmandroidmissed some control-flow edges, our approach missed those edges
as well.
5.1.2 Comparison with Ground Truth. We measured the False Pos-
itives (FP) and False Negatives (FN) by comparing the results of
our static analysis with ground truth Å› known flows found in prior
workviaamanualanalysison64apps;7theseÅ‚groundtruthflowsÅ¾
are not acontributionofthis work. The confusionmatrixis:
True Positives : 186False Positives : 70
FalseNegatives : 0True Negatives : 512
Thesefigures,a72%precisionand100%recall,areparforthecourse
for astaticanalysis,indicating that our approach iseffective.
We also show a comparison of our approach with FlowDroid on
these64groundtruthappsinTable 4.Ourapproachfoundmore
leaksthanFlowDroid ontheseapps as well.
5.2 Efficiency
WeconductedtheexperimentsonaMacBookPro(3.5GHzdual-
core Intel Core i7 with 16GB RAM), running Mac OS X 10.14.6. We
show statistics (computed across the entire app dataset) of analysis
runningtime,alongwithappbytecodesize,inTable 5.Atypicalapp
took about 6 minutes to analyze Å› median 347 seconds, geometric
mean 411 seconds Å› which is efficient for a static analysis; the
longestanalysistimewas13hours,whichwebelievecanbereduced
substantially with more engineering. The app bytecode statistics Å›
median16.6MB,geometricmean 15MB,maximum103MBÅ›show
that our approach iscapableof analyzing large apps.
6 APPLICATIONS
We now present six studies that provide evidence for the expres-
siveness andeffectiveness of algebraic-datatype taint tracking.
6.1 WhatIDs AreLeaked,andin WhatForm?
We first studied the frequency and nature of identifier leaks. In
Table6we show the percentage of apps that leak that identifier,
andtheformoftheleak.Threecriticalidentifiers,IMEI/Serial/MAC
Address,areleakedby40Å›51%oftheapps,whichisthefirstreason
forconcern.Thesecondreasonforconcernisthatidentifiersare
leakedrawby75Å›88%oftheappsthatleakthem;23Å›46%ofapps
leak these IDs hashed Å› in lieu of, or in addition to, the raw leak.
On a more positive note, the IMSI is leaked to a lesser extent, only
21%ofthe apps, andmostly hashed(74%).
For the remaining three, resettable identifiers, we found that
theAndroidIDandGUIDareleakedroutinely:by91%and92%of
the apps, respectively. The Advertising ID is seeing a reduced leak
rate (58% of the apps). Raw leaks are the norm for these identifiers:
96Å›100% ofthe leaksare inraw form.
We observed that certain apps leak boththe raw and hashed ID
(lastrowofTable 6).NotethatforIMEI,IMSI,Serial,andAndroidID,
thisfigureisquitehigh,12Å›37%oftheapps.Webelievethispractice
to be particularly pernicious, because such apps essentially have
theâ„(ğ¼ğ·) â†’ğ¼ğ·mapping.Iftheseappscommunicatethemapping
7Themanualflowanalysiswasexhaustive,e.g.,wentsofarascapturingandrewriting
networkpackets.
75Algebraic-Datatype Taint Tracking, withApplicationsto UnderstandingAndroid Identifier Leaks ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece
Table 2:App distribution across categories.
Category FinanceBooksEducation Entâ€™ment.EventFoodHealthHomeLifestyleMapsMedicalMusicNewsShoppingSocialSportsToolsTravelWeather
#Apps 52 60 55 55 42 60 54 53 53 54 55 53 50 49 50 47 58 54 54
Table 3: The number of top Google Play apps where Flow-
Droid,andour approachrespectively,foundleaks.
IMEIIMSISerialMACAnd.IDAdvIDGUIDFlowDroid 104 23 n/s 101 336 n/s 519
Our Approach
Total 405 108 316 372 722 455 728
Raw 334 43 235 324 695 455 728
Hashed 145 79 142 83 297 0 0
FalseNegatives 3 0 n/a 7 0 n/a 11
Table4:ThenumberofgroundtruthappswhereFlowDroid,
andour approachrespectively,foundleaks.
IMEIIMSISerialMACAnd.IDAdvIDGUIDFlowDroid 11 9 n/s 5 24 n/s 53
Our Approach 21 9 18 15 44 32 56
Table 5:Efficiency results.
Analysistime(seconds) Bytecodesize (MB)
min max median mean min max median mean
140 47,651 347 411 0.04 103.4 16.6 15
Table 6:Identifiersstats.
IMEIIMSISerialMACAnd.IDAdvIDGUIDApps (%) 51 21 40 47 91 58 92
Raw(%) 83 38 75 88 96 100 100
Hashed(%) 37 74 46 23 41 0 0
Raw & Hashed (%) 20 12 21 11 37 0 0
to other apps that only have â„(ğ¼ğ·), then the raw ID value, unique
to the device, canbede-anonymized .
6.2 Multiple-Identifier Leaks
We now study cases where multiple identifiers are leaked by a
single app. We present the most frequent signatures in Table 7.
On a positive note, 3 out of top-10 most common signatures are
â„(ğ‘)âˆ§ğ‘”,ğ‘âˆ§ğ‘”,andğ‘âˆ§ğ‘£,thatis,resettableidentifiers(10%,7%,andTable 7:Most commonmulti-ID leaks;R=raw,H=hashed.
IMEIIMSISerialMACAnd.IDADvID
GUID
#AppsR H R H R H R H R H R R
âœ“ âœ“ 100
âœ“ âœ“ 70
âœ“ âœ“ âœ“ âœ“ 55
âœ“ âœ“ 41
âœ“ âœ“ 40
âœ“ âœ“ 33
âœ“ âœ“ 31
âœ“ âœ“ 28
âœ“ âœ“ 27
âœ“ âœ“ âœ“ 26
âœ“ âœ“ âœ“ âœ“ âœ“ 24
âœ“ âœ“ âœ“ 24
âœ“ âœ“ âœ“ 17
âœ“ âœ“ âœ“ 14
âœ“ âœ“ âœ“ 13
âœ“ âœ“13
âœ“ âœ“ 11
âœ“ âœ“ 11
âœ“ âœ“ 10
3.1%,respectively).Theflipsideisthattheother7outoftop-10use
hardwareidentifiers:wehave â„(ğ‘’)âˆ§â„(ğ‘Ÿ)âˆ§â„(ğ‘),thenâ„(ğ‘š)âˆ§â„(ğ‘),
thenğ‘’âˆ§ğ‘, at4% and above. We have â„(ğ‘Ÿ) âˆ§â„(ğ‘), thenâ„(ğ‘’) âˆ§â„(ğ‘ ),
thenâ„(ğ‘’) âˆ§â„(ğ‘š),thenâ„(ğ‘’) âˆ§â„(ğ‘) âˆ§ğ‘”,at 2.6%andabove.
Notehowthesefindingsunderlinetheeffectivenessofourap-
proach.Astandardtaintanalysiswouldconflatethe100appswhose
signatureis â„(ğ‘)âˆ§ğ‘”withthe70appswhosesignatureis ğ‘âˆ§ğ‘”;and
would conflate the 24 apps using â„(ğ‘’) âˆ§â„(ğ‘ ) âˆ§â„(ğ‘Ÿ) âˆ§â„(ğ‘š) âˆ§â„(ğ‘)
withthe 4apps using ğ‘’âˆ§ğ‘ âˆ§ğ‘Ÿâˆ§ğ‘šâˆ§ğ‘.
Examples: complex yet common signatures. Our prior work on
manual taint analysis (Section 5.1.2) has revealed groups of apps
withcommonsignaturesÅ› appsusethesamemechanismforcon-
structing a unique Å‚DeviceIDÅ¾. Our analysis can group apps into
equivalence classes induced by app signatures; this has a variety
ofapplications,fromfindinggroupsofappswithcommonbehav-
ior [43]to groupsofapps with commondevelopers,etc. We show
twosuchexamplesinFigure 6.Theleftside(firststage)ofthefigure
listsall theidentifiersinvolvedin signatureconstruction. Thesec-
ondstage shows how those identifiers are combinedor processed
to generateahashedunique DeviceID,whichisthen exfiltrated.
76ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece SydurRahaman, Iulian Neamtiu, XinYin
String deviceID = new 
UUID( 
imei.toString ().hashCode (), 
(imsi.hashCode () | 
androidID .hashCode ()))
.toString ();String androidID = 
Secure.getString (...ANDROID_ID)String imsi = telephonyManager . 
getSubscriberId ()
String imei = 
telephonyManager.getDeviceId ();Signature 1: h(e)âˆ§h(s)âˆ§h(a)
Identifier Read Identifier ProcessingExfiltration
(to the network)String deviceID = imei or 
new 
UUID( androidID .hashCode (), 
macAddress .hashCode ()).to
String () or androidID or 
macAddress or GUIDString androidID = 
Secure.getString (...ANDROID_ID)String imei = 
telephonyManager.getDeviceId ();
String macAddress = WifiInfo . 
getMacAddress ();Signature 2: eâŠ•(h(a)âˆ§h(m))âŠ•aâŠ•mâŠ•g
String GUID = 
UUID.randomUUID ().toString ();
Figure 6:DeviceIDsignatures.
Table8:Third-partyvs.Owncodestatistics:numberandper-
centageofleaks (T=third-party,O=owncode).
IMEI IMSI Serial MAC And.ID
T O T O T O T O T O
R183 208 28 16 128 120 223 145 586 418
H97 63 56 25 120 33 61 23 198 144
R(%)33 38 22 13 32 30 49 32 44 30
H(%)18 11 45 20 30 8 14 5 15 11
Signature1(app: TexasRoadhouseMobile [30])createsaDeviceID
from the combination of IMEI, IMSI, and AndroidID. Since all iden-
tifiersare used,the signature uses ANDs:
â„(ğ‘’) âˆ§â„(ğ‘ ) âˆ§â„(ğ‘)
Signature2(library io.intercom )isquitecomplex,astheDeviceID
is exactly one of: either the IMEI, or the AndroidID, or the MAC
Address,ortheGUID,ortheANDofhashedAndroidIDandhashed
MAC Address. Our representation captures this effectively:
ğ‘’âŠ• (â„(ğ‘) âˆ§â„(ğ‘š)) âŠ•ğ‘âŠ•ğ‘šâŠ•ğ‘”
6.3 LibraryLeaks vs. Appâ€™sOwn Leaks
We motivate this analysis via two scenarios. In the first scenario, a
developer submits an app for publishing onto Google Play, and the
app isrejectedforviolatingguidelines,e.g.,a rawhardwareleakin
anon-financialapp.EventhoughthedeveloperhasusednoIDs,the
appislinkedwithaÅ‚leakyÅ¾advertisinglibrarythatcausestheID
leak.Thedevelopershouldbeabletoextractthelibraryâ€™ssignature
and the appâ€™ssignatureto determine the leakâ€™s causeand courseof
action.Inthesecondscenario,theGooglePlaymarketplaceitself
tries to determine whether a raw hardware leak is allowable or
not, prior to publishing an app. If the app uses a payments services
library, the leak would be allowed in the name of fraud prevention.
Hence itisessential to find whethera leakis causedbya libraryor1// JCPenney app
2staticString g(Context context) {...
3 hashMap.put( "di",(telephonyManager.getDeviceId()).digest ());
4 ...
5 jSONObject.put( "di", hashMap.get( "di")) ;...
6}
7
8// Dunkinapp
9finalHttpParameterMap getRiskBodyParameterMap(){...
10 httpParameterMap.add( "imei", (TelephonyManager)
context.getSystemService( "phone")).getDeviceId() , true) ;...
11 returnhttpParameterMap;
12}
Figure7:Hashedleak(top)vs.rawleak(bottom)inthesame,
com.threatmetrix library.
the app itself. Our analysis isolates the source of the leak (Figure 1)
andattributes itto either third-party (library) code or owncode.
In Table8we present the results of leak attribution in our ex-
aminedapps.ForeachID,weshowthenumberofthird-party(T)
vs. own (O) leaks, whether the leak is raw or hashed, as well as the
percentage distribution.All the hardware identifiers Å› IMEI, IMSI,
Serial, and MAC Address Å› as well as the AndroidID, are leaked
more by libraries thanown code (51%, 67%, 62%, 63%,59%, respec-
tively).ForidentifiersAdvertisingIDandGUID(omittedfromthe
tableforspace),leaksweresubstantialbutbalanced:297third-party
vs. 291ownfor AdvertisingID and639vs. 631for GUID.
This finding Å› hardware ID leaks are attributable more to third-
party code than own code Å› is important, because it shows that
apps could unwittingly be the source of problematic leaks, e.g., due
to Å‚leakyÅ¾ libraries, and could be unfairly blamed for leaks that
appsâ€™own developersdid not introduce, orwere notevenawareof.
6.4 Leakiest Libraries
As mentioned previously, libraries are a significant source of leaks.
Summarizing leaks in libraries is non-trivial, however, because
ofcontext-sensitivity :aleakwouldmaterialize(ornot)depending
on how an app invokes the library. We illustrate this in Figure 7,
onlibrary com.threatmetrix .Whenthelibraryisinvokedfromthe
JCPenney app (top), the IMEI is leaked hashed: on line 3 the IMEI
isreadanditshash(digest)addedto hashMap.However,whenthe
library is invoked from the Dunkinapp (bottom), the IMEI is leaked
raw:on line10the IMEIisread andadded,raw, to httpParameterMap .
Therefore,inTable 9wepresenttheresultsofourlibraryanal-
ysis; of the 821 libraries used in our apps, we show the top-20
Å‚leakiestÅ¾; for each library and each ID, we show the number of
library methods that leak the raw ID and the number of library
methodsthatleakthehashedID.Forexample,library com.paypal
has 35 methods that leak the hashed IMEI, 8 methods that leak the
raw IMEI, 35 methodsthat leakthe hashedIMSI,etc.
Foreachlibrary,wealsopresentthelibraryâ€™spurpose,asindi-
catedonthe libraryâ€™swebsiteorGitHubpage.Note thatonlythree
libraries are financial: com.paypal ,com.tune,com.adjust ; hardware ID
leaks are expected, and allowed, in these libraries. However, the
analysis shows that most leaks are in non-financial libraries, the
overwhelming majority of whichare advertisingandanalytics.
77Algebraic-Datatype Taint Tracking, withApplicationsto UnderstandingAndroid Identifier Leaks ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece
Table 9: Third party libraries: the number of methods leaking each ID, and the form of the leak (H=hashed, R=raw). Raw
hardware leaks innon-financiallibrariesshowninred.
Library IMEI IMSI Serial MAC AndroidID AdvID GUID Purpose
H R H R H R H R H R R R
com.paypal 35 8 35 4 35 4 35 6 35 4 30 142 finance
io.fabric 0 380 0 0 300350543 0 285 analytics
net.hockey.app 0 0 0 0 0 0 0 0 114 69 0 266 analytics
com.apps.flyer 0 20 0 0 0 0 2791 95 106 ads
com.kochava 0 30 0 0 0 0 3036 34 33 ads
com.threat.metrix 2 24063320 0 2 12 0 37 analytics
com.google 0 0 0 0 0 0 0 0 3 22164 16 ads
io.intercom 0 90 0 0 0 0 809 0 106 analytics
io.branch 0 0 0 0 0 0 0 0 0 65 0 66 analytics
com.appsee 15 0 15 0 0 150 0 0 0 0 60 analytics
bo.app 0 0 0 0 0 70 0 0 0 0 60 analytics
com.tune 0 0 0 0 0 0 0 0 0 12 0 107 finance
com.segment 0 240 0 0 240 0 0 24 3 76 analytics
com.adjust 0 0 0 0 0 0 0 55 0 55 0 57 finance
com.leanplum 0 0 0 0 0 0 12 0 1 11 0 11 analytics
com.nielsen 0 0 0 0 0 401026 6 4 analytics
com.iovation 0 9080 0 0 909 0 7 analytics
com.startapp 0 0 0 0 0 0 0 0 0 32 32 99 ads
com.newrelic 34 0 0 0 34 0 0 0 34 0 0 174 analytics
com.mobvista 0 220 0 0 0 0 222722 22 65 analytics
Table9paintsagrimpictureoftheAndroidlibrarylandscape
when it comes to privacy: advertising and analytics libraries make
heavyuseofhardwareIDs,butthisuseappearsaimedatidentifying
users and devices rather than preventing fraud. Ironically, finan-
ciallibraries com.tuneandcom.adjust areamongthemostprivacy-
friendly libraries (leastintensive usersofhardware IDs).
6.5 Leakiest Apps
WeexaminedtheÅ‚leakiestÅ¾appsinlightoftheGoogleguidelines
for acceptable use of hardware IDs. We focus on the top-25 apps
thatmanagetoleak allhardwareidentifiers,raw .Moreover,manyof
theseappsalsoleakhashedversionsofhardwareidentifiers;leaking
bothrawandhashedversionsisaconcernforde-anonymization.
WeshowtheresultsinTable 10.Foreachappweshowthepopular-
ity (the floor of the number of installs, as indicated on Google Play
onFebruary 25th,2021),the app category,andthe listofleaks.
We identified those apps that have a legitimate financial reason
tousehardwareIDsasfollows:appsthatareintheFinancecategory,
orappsthatlinkwithafinanciallibrary,andtheleaksareduetothe
library(third-party)coderatherthantheappcode.Theappsthat
didnotmeettheseconditions,showninredinthetable,potentially
violateIDusageguidelines.Ourapproachdistinguishesbetween
raw and hashed, and between third-party vs. own leaks, helping
spotpotentialviolations.Incontrast,anapproachthatmissesthese
nuances might flag a substantial number of benign, policy-abiding
apps as problematic (i.e.,ahigh rateoffalse positives).
Altogether,ourdatasethad190appsthateitheruseafinancial
library,ortheappitselfisintheFinancecategory.Theseappsmight
needhardwareidentifierinformationforfraud&abusecheckingpurposes,soleaksfromtheseappscanbeaccepted.However,47
outofthese190apps leakat leastone raw hardware IDviaanon-
financialthird-partylibrary,whichisaconcern.
6.6 Longitudinal Study: 2018vs. 2020
To investigate whether apps are becoming more guidelines-
compliant and privacy-friendly, we conducted a longitudinal study,
comparingthe2018versionsof1,000-appdatasetwiththeir2020
counterparts.
6.6.1 Identifier-Centric Study. We first investigate how the preva-
lence/use of a certain identifier has changed over two years. We
tabulatethefindingsinTable 11.ForeachID,eachcodelocation
(third-party(TP)orown(O)),andeachleaktype(hashedorraw)we
showthenumberofappsthataddedthatIDleakwith â€˜+â€™andthe
numberofappsthatremovedthatIDleakwith â€˜-â€™.Forexample,for
raw IMEI we have: in third-party code, 8 apps have added this leak
and45appshaveremovedthisleak,yieldinganetchangeof -37;
whereasinowncode,19appshaveaddedthisleakand59appshave
removedthisleak,yieldinganetchangeof -40.Theresultsreveal
several trends. First, the use of raw IDs has decreased across the
board:noticethenegativenetfiguresforIMEI,Serial,MACAddress,
AndroidID.Twogroupssawanincrease:AdvertisingIDandGUID,8
especially in own code, as well as hashed own code (AndroidID,
Serial,MAC).Theseresults,alsocorroboratedbytheapp-centric
study in Section 6.6.2, indicate (1) a move away from hardware
8We keep the â€˜0â€™ values for AdvertisingID and GUID in the table for uniformity; since
these IDswerenot used in the hashed form to beginwith, therewas nochange.
78ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece SydurRahaman, Iulian Neamtiu, XinYin
Table 10:Å‚LeakiestÅ¾apps. Non-financial appswith no financial librariesshowninred; R=raw,H=hashed.
App #Installs Category IMEI IMSI Serial MAC AndrID AdvID GUID
(million) R H R H R H R H R H R R
SpectrumTV [29] 10 Entertainment âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
CGTN[13] 5 News&Magazines âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
GPS Navigation System [20] 10 Maps&Navigation âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
WiFiMap [19] 50 Productivity âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Bitcoin, CryptoNews[ 9] 1 Finance âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
CheapOair [14] 1 Travel &Local âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
GreyhoundLines [21] 1 Travel &Local âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
JCPenney [23] 5 Shopping âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
CBSNews [12] 1 News&Magazines âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Wendyâ€™s [ 31] 5 Food&Drink âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Zipcar[33] 1 Maps&Navigation âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Lyft Rideshare [ 25] 10 Maps&Navigation âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Western Union [ 32] 5 Finance âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
NJ TRANSIT[ 26] 1 Maps&Navigation âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Curb The TaxiApp [ 15] 1 Maps&Navigation âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Apartments.com [4] 5 House &Home âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
CareZone[ 1] 1 Medical âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
BURGER KING [ 11] 10 Food&Drinks âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Fox Now[ 18] 10 Entertainment âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
One Dollar [ 27] 0.5 Shopping âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Samâ€™s Club [28] 1 Shopping âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Aaptiv [5] 1 Health &Fitness âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Letgo[24] 100 Shopping âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Amber Weather [6] 1 Weather âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
BlinkHealth Rx [ 10] 0.1 Medical âœ“ âœ“ âœ“ âœ“ âœ“ âœ“
Table 11:Identifier-centric studyresults: 2018 â†’2020 changesinidentifier use.
IMEI IMSI Serial MAC AndroidID AdvID GUID
TP O TP O TP O TP O TP O TP O TP O
Raw +8 +19 +1 +8 +14 +23 +8 +10 +41 +44 +24 +44 +47 +52
-45 -59 -8 -2 -28 -25 -48 -28 -75 -52 -48 -23 -45 -27
Net -37 -40 -7 +6 -14 -2 -40 -18 -34 -8 -24 +21 +2 +25
Hashed +12 +8 +5 +5 +15 +10 +5 +5 +33 +26 0 0 0 0
-19 -16 -10 -8 -21 -5 -12 -2 -34 -18 0 0 0 0
Net -7 -8 -5 -3 -6 +5 -7 +3 -1 +8 0 0 0 0
identifiersandtoward resettableidentifiers,and(2)replacingraw
withhashedvalues,whichisencouraging.
6.6.2 App-Centric Study. The second part of our study is app-
centric. Assuming the signature of an app in 2018 was ğ‘†2018while
in2020thesignatureis ğ‘†2020,wecheckwhether ğ‘†2020<:ğ‘†2018.We
showhowournotionofsubsumptionallowsforflexibledefinitions,
hencewecangauge,alongseveraldimensions,whethertheapps
have become more privacy-friendly.
WeshowtheresultsinTable 12.Westartwith ANDsubsumption ,
e.g.,ğ‘’âˆ§ğ‘ <:ğ‘’âˆ§ğ‘ âˆ§ğ‘Ÿindicates a reduction in hardware identifiers;
wefoundthat108appsexhibitthiscondition,whichisencouraging
asitmeansdroppingtheuseofoneormorehardwareidentifiers.
When relaxing the subsumption notion to allow for increases insoftwareIDs,wefoundafurther11appsthatexhibitthiscondition,
which is still positive, as the use of software IDs is preferred to the
useofhardwareIDs.Wealsoshowthenumberofappsthatdrop
eachID;IMEIandMACAddressarethemost-droppedhardware
identifiers (87 and 71 apps, respectively), while AndroidID was
droppedby107apps.
Hash subsumption , e.g.,ğ‘’âˆ§â„(ğ¼ğ·)<:ğ‘’âˆ§ğ¼ğ·, indicates that the
apphasswitchedfromleakingtherawIDtoleakingthehashedID.
Whilefewapps exhibitthissubsumption(26 forhardwareIDs, 20
for AndroidID), itisneverthelessaprivacy gain.
Reverse subsumption. Finally, 35 apps were in the undesirable
Å‚reverse subsumptionÅ¾ situation: at least one hardware ID leak was
addedinthe2020version.Weshowthesefindingsinthelastfive
rows of Table 12. Of the 35 apps thatwent from a hashed to a raw
79Algebraic-Datatype Taint Tracking, withApplicationsto UnderstandingAndroid Identifier Leaks ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece
Table 12: App-centric study results: subsumption kind, in-
formal definition,and# ofappsexhibiting subsumption.
Kind SubsumptionDefinition #Apps
ANDhardware ID leaksdecreased 108
hardware ID leaksdecreased,software 11
ID leaksincreased
raw IMEI leakremoved 87
raw MAC Addressleakremoved 71
raw Serial leakremoved 49
raw IMSIleakremoved 12
raw AndroidID leakremoved 107Hashraw hardware ID leak â†’hashedhw.ID leak 26
raw IMEI â†’hashedIMEI 14
raw IMSI â†’hashedIMSI 3
raw MAC Address â†’hashedMAC Address 6
raw Serial â†’hashedSerial 3
raw AndroidID â†’hashedAndroidID 20Reversehashedhardware ID leak â†’raw hw.ID leak 35
hashedIMEI â†’raw IMEI 20
hashedIMSI â†’raw IMSI 3
hashedMAC Address â†’raw MAC Address 7
hashedSerial â†’raw Serial 5
leak,themajoritydidsofortheIMEI(20apps),whilefewerapps
didsofor the IMSI,MAC Address, andSerial, respectively.
Toconclude,thelongitudinalanalysisrevealsanoverallmove
awayfromusage/leaksofhardwareIDs,towardresettableIDs;and
to smallerextent,amove towardhashedhardware IDs.
7 RELATED WORK
ManystaticflowanalyzersforAndroidhavebeendeveloped,includ-
ing Amandroid [ 58], DIALDroid [ 16], DidFail [ 17], DroidSafe [ 42],
FlowDroid [ 35] and IccTA [ 22]. A prior study [ 56] found that a
typicalanalyzertakesonaverage6minutesperapp,onparwith
ourapproach.Mostofthesetoolsusethepredefinedsourcesand
sinkslistfromSusi[ 3],withthebinarygoalofdecidingwhether
a source flows to a sink; this renders the results quite imprecise,
limitingtoolsâ€™ usability.
OtherstaticflowanalyzersforAndroid(whosegoalisstillde-
ciding whether a source flows to a sink) improve precision over
the aforementioned analyzers, at the expense of running time. For
example, P/Taint [ 44] is a Datalog-based static information flow
analyzer. Their evaluation, like ours, include popular Android apps
(such as Facebook Messenger or Google Chrome). Thanks to ad-
ditional features such as taint transfer and sanitization, P/Taint
achieves higher precision andrecall.
Horndroid[ 37]focusedonimprovingtheprecisionofexisting
staticanalysesbydeterminingwhetherasinkwillbereachedby
taintedflows,andrefiningbranchconditionstoavoidfalsepositives.
However,Horndroiddoesnotallownamingsources(aswedowith
thesevenIDs),sotheirapproachisnotdirectlycomparabletoours.
DroidInfer[ 46]usesacontext-sensitiveinformationflowtype
systemtoimprovestaticanalysisprecisionandscalability,andsup-
ports analysis oflibraries; their focus is on sensitive data leaks (tonetworkor logs). EvaluationontopGooglePlayapps (144)shows
highprecision(FP=15%).DroidInferâ€™sgoalisintuitivesource â†’sink
trackingratherthanalgebraic signatures andID (ab)usestudies.
MyersandLiskovâ€™slabelmodel(Jif/DLM)[ 54]describesÅ‚unionsÅ¾
of labels: set union, i.e., AND in our model. Our XORs, not sup-
ported in Jif, would be set disjoint union. While we do not support
labelpolymorphismasJifdoes, polymorphismwouldonlyhelpif
therewascrossfirst-partytothird-partyflowwhichwedidnotfind
(Section4.4). Stefanetal.â€™s disjunctioncategorylabels [ 57] are de-
fined as conjunctions and disjunctions on principals; Å‚can-flowÅ¾ as
logical implication governs safe information flow. They implement
dclabel-static , a prototype information flow control in Haskell,
but no evaluation is provided. Montagu et al. [ 53] introduced label
algebrasÅ›asetoflabelsthatformapre-lattice,i.e.,withapre-order
(the term Å‚algebraicÅ¾ in our work, from algebraic data types, refers
to the product and sum operations on types). The focus of these
approacheswastheformalism/flow model.Incontrast,forus,the
algebraic taint representation is a conduit to implementing a static
analysis forAndroidand conductingsixstudies on 1,000top apps.
MAPS [59] distinguishes between first-party and third-party ID
leaks by the call site of sensitive API methods but does not per-
formtainttrackingorstaticanalysisÅ›understandableforthescale
(1,035,853 apps). This is prone to false positives, e.g., ID-retrieving
calls indeadcode,orIDs whichare read but not used/leaked.
TheTaintdroid[ 41]dynamictainttrackerhasexposedthatlo-
cationandphoneinformationareroutinelyleakedtoadvertising
and content servers. Taintdroidâ€™s focus is on efficiently tracking
taintwithinanappandtheAndroidOS,whereasweperformstatic
tracking,and within the confines of theapp only. TaintDroid does
not distinguishbetween raw andhashedleaks.
Dynamic taint analysis [ 40,41,48] has different goals compared
to us: reduce false positives or track which servers packets go to
(which is impossible with our approach). Our static approach aims
to reduce false negatives and allows analysis at scale. Dynamic
analysis, in general, needs to overcome two issues (1) low cover-
age[36,38,51,55],and(2)signing-insuccessfullyÅ›thisisproblem-
atic in cases such as the Western Union banking app, which requires
aWestern Union customer account (as do otherapps inTable 10).
8 CONCLUSIONS
We introduce an algebraic taint representation that solves a key
problemwithexistingtaint analyses:distinguishingbetweenpro-
grams that leak data in ways that are similar on the surface, but
verydifferentunderneath.Weimplementedalgebraictainttracking
asastaticanalysisforAndroid,anddemonstrateitseffectiveness
throughsixstudiesonidentifier(ab)useintopAndroidappsand
libraries. We found that being able to capture subtle yet critical dif-
ferencesiskeyforunderstandingappbehaviorw.r.t.userprivacyor
abidingbydeveloperguidelines.Ourlongitudinalstudyshowsthat
over the pasttwoyears, apps have become more privacy-friendly.
ACKNOWLEDGMENTS
Wethanktheanonymousreviewersfortheirfeedback.Thismaterial
is based upon work supported by the National Science Foundation
underGrantNo.CNS-1617584.
80ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece SydurRahaman, Iulian Neamtiu, XinYin
REFERENCES
[1] 2020. CareZone. https://carezone .com/.
[2] 2020. FlowDroid. https://github .com/secure-software-engineering/FlowDroid .
[3] 2020. SuSi. https://github .com/secure-software-engineering/SuSi .
[4]2021. Apartments.com Rental Search. https://play .google.com/store/apps/
details?id=com.apartments .mobile.android.
[5]2021. Aaptiv: 1 Audio Fitness App. https://play .google.com/store/apps/
details?id=com.aaptiv.android.
[6]2021. AmberWeatherRadarFree. https://play .google.com/store/apps/details?id =
com.amber.weather.
[7]2021. Audiobooks.com. https://play .google.com/store/apps/details?id =
com.audiobooks .androidapp&hl =en_US&gl =US.
[8]2021. Best practices for unique identifiers. https://developer .android.com/
training/articles/user-data-ids#java . Accessed:2021-02-25.
[9]2021. Bitcoin, Ethereum, IOTA Ripple Price,Crypto News. https://
play.google.com/store/apps/details?id =com.crypto.currency.
[10]2021. BlinkHealthRx-BestDiscountPharmacyPrices. https://play .google.com/
store/apps/details?id =com.blinkhealth .blinkandroid .
[11]2021. BURGER KING. https://play .google.com/store/apps/details?id =
com.emn8.mobilem8 .nativeapp .bk.
[12]2021. CBS News - Live Breaking News. https://play .google.com/store/apps/
details?id=com.treemolabs .apps.cbsnews.
[13]2021. CGTNÅ› China GlobalTVNetwork. https://play .google.com/store/apps/
details?id=com.imib.cctv.
[14]2021. CheapOair: Cheap Flights, Cheap Hotels Booking App. https:
//play.google.com/store/apps/details?id =com.fp.cheapoair .
[15]2021. Curb - The Taxi App. https://play .google.com/store/apps/details?id =
com.ridecharge .android.taximagic .
[16] 2021. DIALDroid. https://github .com/dialdroid-android/DIALDroid .
[17]2021. DidFail. https://resources .sei.cmu.edu/library/asset-view .cfm?assetID =
508078.
[18]2021. FOX NOW: Watch Live On Demand TV Stream Sports. https:
//play.google.com/store/apps/details?id =com.fox.now.
[19]2021.FreeWiFiPasswords InternetHotspot-WiFiMap. https://play .google.com/
store/apps/details?id =io.wifimap.wifimap.
[20]2021. GPS Navigation System, Traffic Maps by Karta. https://play .google.com/
store/apps/details?id =com.kartatech.karta.gps.
[21]2021. Greyhound Lines. https://play .google.com/store/apps/details?id =
com.greyhound .mobile.consumer .
[22] 2021. IccTA. https://sites .google.com/site/icctawebpage/source-and-usage .
[23]2021. JCPenney Å› Shopping Deals. https://play .google.com/store/apps/
details?id=com.jcp.
[24]2021. letgo: Buy Sell Used Stuff, Cars, Furniture. https://play .google.com/store/
apps/details?id =com.abtnprojects .ambatana .
[25]2021. Lyft-Rideshare,Bikes,Scooters Transit. https://play .google.com/store/
apps/details?id =me.lyft.android.
[26]2021. NJ TRANSIT Mobile App. https://play .google.com/store/apps/details?id =
com.njtransit.njtapp.
[27]2021. One Dollar - Tap To Win. https://apk .support/app/com .giinger.onedollar .
[28]2021. Samâ€™sClub Scan Go: Wholesale Shopping Savings. https://apk .support/
app/com.samsclub.sng.
[29]2021. Spectrum TV. https://play .google.com/store/apps/details?id =
com.TWCableTV .
[30]2021. Texas Roadhouse Mobile. https://play .google.com/store/apps/details?id =
com.relevantmobile .texasroadhouse .
[31]2021. Wendyâ€™s Å› Earn Rewards, Order Food Score Offers. https://
play.google.com/store/apps/details?id =com.wendys.nutritiontool .
[32]2021. Western Union International: Send Money Trans-
fer. https://play .google.com/store/apps/details?id =
com.westernunion .moneytransferr3app .eu.
[33] 2021. Zipcar. https://play .google.com/store/apps/details?id =com.zc.android.
[34]AlfredV.Aho,MonicaS.Lam,RaviSethi,andJeffreyD.Ullman.2006. Compil-
ers: Principles, Techniques, and Tools (2Nd Edition) . Addison-Wesley Longman
Publishing Co., Inc.,Boston, MA,USA.
[35]Steven Arzt, Siegfried Rasthofer, Christian Fritz, Eric Bodden, Alexandre Bar-
tel,JacquesKlein,YvesLeTraon,DamienOcteau,andPatrickMcDaniel.2014.
FlowDroid:PreciseContext,Flow,Field,Object-SensitiveandLifecycle-Aware
Taint Analysis for Android Apps. SIGPLAN Not. 49, 6 (June 2014), 259Å›269.
https://doi .org/10.1145/2666356 .2594299
[36]TanzirulAzimandIulianNeamtiu.2013.TargetedandDepth-FirstExplorationfor
SystematicTestingofAndroidApps.In Proceedingsofthe2013ACMSIGPLANIn-
ternationalConferenceonObjectOrientedProgrammingSystemsLanguages Appli-
cations(Indianapolis,Indiana,USA) (OOPSLAâ€™13) .AssociationforComputingMa-
chinery, New York, NY, USA, 641Å›660. https://doi .org/10.1145/2509136 .2509549
[37]S. Calzavara, I. Grishchenko, and M. Maffei. 2016. HornDroid: Practical and
Sound Static Analysis of Android Applications by SMT Solving. In 2016 IEEE
European SymposiumonSecurityand Privacy (EuroS P) . 47Å›62.[38]Shauvik Roy Choudhary, Alessandra Gorla, and Alessandro Orso. 2015. Auto-
mated Test Input Generation for Android: Are We There Yet? (E). In Proceedings
of the 2015 30th IEEE/ACM International Conference on Automated Software Engi-
neering (ASE) (ASE â€™15) . IEEE Computer Society, Washington, DC, USA, 429Å›440.
https://doi .org/10.1109/ASE .2015.89
[39]ALONZO CHURCH. 1941. The Calculi of Lambda Conversion. (AM-6) . Princeton
UniversityPress. http://www .jstor.org/stable/j .ctt1b9x12d
[40]LandonP.Cox,PeterGilbert,GeoffreyLawler,ValentinPistol,AliRazeen,BiWu,
andSaiCheemalapati.2014. SpanDex:SecurePasswordTrackingforAndroid.
In23rd USENIX Security Symposium (USENIXSecurity 14) . USENIX Association,
San Diego, CA, 481Å›494. https://www .usenix.org/conference/usenixsecurity14/
technical-sessions/presentation/cox
[41]William Enck, Peter Gilbert, Byung-Gon Chun, Landon P. Cox, Jaeyeon Jung,
PatrickMcDaniel,andAnmolN.Sheth.2010. TaintDroid:AnInformation-flow
TrackingSystemforRealtimePrivacyMonitoringonSmartphones.In Proceedings
ofthe9thUSENIXConferenceonOperatingSystemsDesignandImplementation
(Vancouver, BC, Canada) (OSDIâ€™10) . USENIX Association, Berkeley, CA, USA,
393Å›407. http://dl.acm.org/citation .cfm?id=1924943.1924971
[42]MichaelGordon,Kimdeokhwan,JeffPerkins,LimeiGilham,NguyenNguyen,
and Martin Rinard. 2015. Information-Flow Analysis of Android Applications in
DroidSafe. https://doi .org/10.14722/ndss .2015.23089
[43]Alessandra Gorla, Ilaria Tavecchia, Florian Gross, and Andreas Zeller. 2014.
Checking App Behavior against App Descriptions. In Proceedings of the 36th
International Conference on Software Engineering (Hyderabad, India) (ICSE 2014) .
AssociationforComputingMachinery,NewYork,NY,USA,1025Å›1035. https:
//doi.org/10.1145/2568225 .2568276
[44]NevilleGrechandYannisSmaragdakis.2017. P/Taint:UnifiedPoints-toandTaint
Analysis. Proc.ACMProgram.Lang. 1,OOPSLA,Article102(Oct.2017),28pages.
https://doi .org/10.1145/3133926
[45]William A Howard. 1980. The formulae-as-types notion of construction. To
HBCurry:essayson combinatorylogic,lambdacalculusandformalism 44(1980),
479Å›490.
[46]WeiHuang,YaoDong,AnaMilanova,andJulianDolby.2015.ScalableandPrecise
TaintAnalysisforAndroid.In Proceedingsofthe2015InternationalSymposium
on Software Testing and Analysis . Association for Computing Machinery, New
York, NY, USA,106Å›117. https://doi .org/10.1145/2771783 .2771803
[47]GaryA.Kildall.1973. AUnifiedApproachtoGlobalProgramOptimization.In
Proceedings of the 1st Annual ACM SIGACT-SIGPLAN Symposium on Principles
of Programming Languages (Boston, Massachusetts) (POPL â€™73) . Association for
Computing Machinery,NewYork,NY,USA,194Å›206. https://doi .org/10.1145/
512927.512945
[48]H. Kuzuno and S. Tonami. 2013. Signature generation for sensitive informa-
tion leakage inandroid applications. In 2013 IEEE 29thInternational Conference
on Data Engineering Workshops (ICDEW) . 112Å›119. https://doi .org/10.1109/
ICDEW.2013.6547438
[49]Xavier Leroy, Damien Doligez, Alain Frisch, Jacques Garrigue, Didier RÃ©my, and
JÃ©rÃ´meVouillon.2020. TheOCamlsystemrelease4.11Documentationanduserâ€™s
manual. http://caml .inria.fr/pub/docs/manual-ocaml/index .html
[50]Benjamin Livshits, Dimitrios Vardoulakis, Manu Sridharan, Yannis Smaragdakis,
OndÅ™ej LhotÃ¡k, JosÃ© Amaral, Bor-Yuh Chang, Samuel Guyer, Uday Khedker, and
Anders MÃ¹ller. 2015. In Defense of Soundiness: A Manifesto. Commun. ACM 58
(01 2015),44Å›46. https://doi .org/10.1145/2644805
[51]Aravind Machiry, Rohan Tahiliani, and Mayur Naik. 2013. Dynodroid: An Input
GenerationSystemforAndroidApps.In Proceedingsofthe20139thJointMeeting
on Foundations of Software Engineering (Saint Petersburg, Russia) (ESEC/FSE
2013). Association for Computing Machinery, New York, NY, USA, 224Å›234.
https://doi .org/10.1145/2491411 .2491450
[52]BartoszMilewskietal .2020. IfEithercanbeeitherLeftorRightbutnotboth,
then why does it correspond to OR instead of XOR in Curry-Howard correspon-
dence?https://stackoverflow .com/questions/64394487/if-either-can-be-either-
left-or-right-but-not-both-then-why-does-it-correspond
[53] BenoÃ®tMontagu,B.Pierce,andR.Pollack.2013. ATheoryofInformation-Flow
Labels.2013IEEE 26thComputer SecurityFoundationsSymposium (2013), 3Å›17.
[54]AndrewC.MyersandBarbaraLiskov.2000. ProtectingPrivacyUsingtheDecen-
tralized Label Model. ACM Trans. Softw. Eng. Methodol. 9, 4 (Oct. 2000), 410Å›442.
https://doi .org/10.1145/363516 .363526
[55]PriyamPatel,GokulSrinivasan, SydurRahaman,and IulianNeamtiu. 2018. On
the Effectiveness of Random Testing for Android: Or How i Learned to Stop
WorryingandLovetheMonkey.In Proceedingsofthe13thInternationalWorkshop
on Automation of Software Test (Gothenburg, Sweden) (AST â€™18). Association for
Computing Machinery, New York, NY, USA, 34Å›37. https://doi .org/10.1145/
3194733.3194742
[56]FelixPauck,EricBodden,andHeikeWehrheim.2018. DoAndroidTaintAnalysis
ToolsKeepTheirPromises?.In Proceedingsofthe201826thACMJointMeetingon
EuropeanSoftware Engineering Conference and Symposium onthe Foundations of
SoftwareEngineering (LakeBuenaVista,FL,USA) (ESEC/FSE2018) .Association
forComputingMachinery,NewYork,NY,USA,331Å›341. https://doi .org/10.1145/
3236024.3236029
81Algebraic-Datatype Taint Tracking, withApplicationsto UnderstandingAndroid Identifier Leaks ESEC/FSE â€™21, August 23Å›28, 2021,Athens,Greece
[57]Deian Stefan, Alejandro Russo, David MaziÃ¨res,and JohnC Mitchell.2011. Dis-
junction category labels. In Nordic conference on secure IT systems . Springer,
223Å›239.
[58]Fengguo Wei, Sankardas Roy, Xinming Ou, and Robby. 2014. Amandroid: A
Precise and General Inter-Component Data Flow Analysis Framework for Se-
curity Vetting of Android Apps. In Proceedings of the 2014 ACM SIGSAC Con-
ference on Computer and Communications Security (Scottsdale, Arizona, USA)(CCSâ€™14).AssociationforComputingMachinery,NewYork,NY,USA,1329Å›1341.
https://doi .org/10.1145/2660267 .2660357
[59]SebastianZimmeck,PeterStory,DanielSmullen,AbhilashaRavichander,Ziqi
Wang, Joel Reidenberg, N. Russell, and Norman Sadeh. 2019. MAPS: Scaling
PrivacyComplianceAnalysistoaMillionApps. ProceedingsonPrivacyEnhancing
Technologies 2019 (07 2019),66Å›86. https://doi .org/10.2478/popets-2019-0037
82