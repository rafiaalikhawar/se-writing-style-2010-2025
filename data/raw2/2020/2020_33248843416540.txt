Automated Implementation of Windows-related
Security-Configuration Guides
Patrick Stöckle
patrick.stoeckle@tum.de
Technical University of Munich
Munich, GermanyBernd Grobauer
bernd.grobauer@siemens.com
Siemens AG
Munich, GermanyAlexander Pretschner
alexander.pretschner@tum.de
Technical University of Munich
Munich, Germany
ABSTRACT
HardeningistheprocessofconfiguringITsystemstoensurethe
securityofthesystems’componentsanddatatheyprocessorstore.
The complexity of contemporary IT infrastructures, however, ren-
ders manual security hardening and maintenance a daunting task.
In many organizations, security-configuration guides expressed
intheSCAP(SecurityContent Automation Protocol)areusedas
abasisforhardening,buttheseguidesbythemselvesprovideno
means for automatically implementing the required configurations.
Inthispaper,weproposeanapproachtoautomaticallyextract
the relevant information from publicly available security-config-
urationguidesforWindowsoperatingsystemsusingnaturallan-
guage processing. In a second step, the extracted information is
verified using the information of available settings stored in the
Windows Administrative Template files, in which the majority of
Windows configuration settings is defined.
We showthat ourimplementationof thisapproach canextract
andimplement83%oftheruleswithoutanymanualeffortand96%
withminimalmanualeffort.Furthermore,weconductastudywith
12state-of-the-artguidesconsistingof2014ruleswithautomatic
checks and show that our tooling can implement at least 97% of
them correctly. We have thus significantly reduced the effort of
securing systems based on existing security-configuration guides.
CCS CONCEPTS
•Securityandprivacy →Softwaresecurityengineering ;Us-
ability in security and privacy ;•Software and its engineer-
ing→Softwareconfigurationmanagementandversioncon-
trol systems.
ACM Reference Format:
Patrick Stöckle, Bernd Grobauer, and Alexander Pretschner. 2020. Auto-
mated Implementation of Windows-related Security-Configuration Guides.
In35thIEEE/ACMInternationalConferenceonAutomatedSoftwareEngineer-
ing (ASE ’20), September 21–25, 2020, Virtual Event, Australia. ACM, New
York, NY, USA, 13 pages. https://doi.org/10.1145/3324884.3416540
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACMmustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ASE ’20, September 21–25, 2020, Virtual Event, Australia
© 2020 Association for Computing Machinery.
ACM ISBN 978-1-4503-6768-4/20/09...$15.00
https://doi.org/10.1145/3324884.34165401 INTRODUCTION
Misconfigurationsreducethesecurityofasystembyintroducing
vulnerabilitiesthatareoftendifficulttotrace.Arecentstudy[ 6]has
demonstrated that from the perspective of the operators there is
one major factor for security misconfigurations: lack of knowledge.
Oneattempttodealwiththelackofknowledgeistouseexist-
ingsecurity-configurationguides.Theseguidesconsistofseveral
rules for a specific software system such as Windows 10 or Red
HatEnterpriseLinux.Eachruleexplainswhichsettingshouldbe
set to which value to make the system more secure and why we
shouldapplyit(e.g.,Listing1).Knownpublishersofsuchguidesare
theCenterforInternetSecurity(CIS)ortheDefenseInformation
SystemsAgency(DISA).OrganizationsandcompanieslikeSiemens
can use these guides to harden their systems.
One may be tempted to argue that we do not need security con-
figurationbecausecompanieslikeMicrosoftmakeastrongeffort
to configure their systems securely by default. These companies
investalotinsecurity,ofcourse,butsecurityisjustoneconcern,
in addition to others, including usability. Assume that there was
a handy setting for most customers, but it poses a small security
risk. The companies may be tempted to decide to have it activated
by default, whereas security-aware customers would deactivate
it.Similarly,wecouldargueforthedatacollectionsettings.They
bring knowledgeto the companiesto improve their products,and
all customers can profit from this. Thus, the companies may be
tempted to activatedata collection settings bydefault. In contrast,
customers with high-security requirements would deactivate them
to reduce the risk that sensitive information is accidentally leaked
via the data collection. Thus, security-configuration guides from
independent organizations can help security-concerned customers
in making their systems more secure.
##/rule
The number of allowed bad logon attempts must be configured to three
or less. /arrowhookleft→
##/description
The account lockout feature, when enabled, prevents brute-force
password attacks on the system. The higher this value is, the
less effective the account lockout feature will be in protectingthe local system. The number of bad logon attempts must bereasonably small to minimize the possibility of a successfulpassword attack while allowing for honest errors made duringnormal user logon./arrowhookleft→
/arrowhookleft→
/arrowhookleft→
/arrowhookleft→
/arrowhookleft→
/arrowhookleft→
##/implementations/0/description
Configure the policy value for Computer Configuration >> Windows
Settings >> Security Settings >> Account Policies >> AccountLockout Policy >> "Account lockout threshold" to "3" or fewerinvalid logon attempts (excluding "0", which is unacceptable)./arrowhookleft→
/arrowhookleft→
/arrowhookleft→
Listing 1: Example of a rule in a Windows-related security-
configuration guide.
5982020 35th IEEE/ACM International Conference on Automated Software Engineering (ASE)
Thepublisherspublishtheirrecommendationsonhowtocon-
figure a software system in formats like PDF and in the Extensible
Configuration Checklist Description Format (XCCDF), which is
part of the Security Content Automation Protocol (SCAP). In some
cases, these implementations are combined with machine-readable
andautomatable checks.Thesechecksarecreatedmanuallyaccord-
ing to the specification written down in the security-configuration
guides. Although XCCDF is designed as a machine-readable for-
mat,instructionsforimplementingthesecuritysettingsareonly
contained in human-readable form in almost all cases. The notable
exceptionistheOpenSCAPproject’s[ 16,22]guidesforLinuxoper-
ating systems and applications, which for many rules contain shell
scriptsandpartsofAnsibleplaybooks.Therefore,existingguides
solvethelack-of-knowledgeproblem,butyieldanotherproblem:
Automatic implementations (orremediation)arenotspecifiedinthe
SCAPstandard.Incontrast,thespecificationofautomated checking
is very detailed.
Publishers sometimes deal with this problem by providing ad-
ditional artifacts, such as scripts or – in the case of Windows –
configurationbackupfiles.Theproblemhereisthreefold.Firstly,
suchartifactsdonotexistforallguides.Secondly,theguidesfre-
quentlygetupdated:IfwetakeWindows10asanexample,there
willbeatleastonenewguideeveryyearpublishedtodealwiththe
updatedsettings,e.g.,introducedbytheversion1909update;minor
versionupdatesdealwithproblemsorchangedrequirements.As
aresult,DISA,forexample,isnowatversion18foritsWindows
10 guide.Therefore, creating/maintaininga mechanism(even ifit
can be based on some artifact provided by the publisher or) will
be a recurring, manual task. Thirdly, with stand-alone artifacts for
implementation,customizationofguides,afeaturewhichiscentral
toSCAP,becomescumbersomeanderror-prone,becausethisre-
quiresamanualefforttokeepthecustomizedguideinsyncwiththe
separately-maintained implementation mechanism. However, easycustomization is essential: Experience shows that there is virtually
no use case in which a publicly available security-configuration
guide can be implemented without at least some changes.
The authoring process is depicted in Figure 1. The publisher
creates the guide in the XCCDF format and the corresponding
checksintheOpenVulnerabilityandAssessmentLanguage(OVAL)format.Thisisamanualprocess,asthepublishersincorporatetheir
knowledge about the system and its architecture into the guide. In
thenextstep,an administrator usestheautomatedcheckstoassess
thestateoftheirsystems.Theresultisalistoftherulestowhich
thesystemisnotcompliant;ourevaluationin§3ofover2000rules
onsystemsusingthedefaultconfigurationshowsthattherateof
satisfiedrulesvariesbetween0%and27%,withanaverageof17.7%.
Thus, for most of the rules, the (typically: default) configuration of
the system to be hardened has to be adjusted.
If the publisher has not provided a mechanism for automated
implementation,foreveryruleofthislist,theadministratormust
read the implementation/remediation section of the rule in the XC-
CDForPDFformoftheguideandimplementthestepsdescribed
there. If a mechanism is provided, in most cases only a complete
implementationofallconfigurationsettingsispossible.Thiscreates
significant manual effort for customization, especially if the imple-
mentation breaks functionality, but it is unclear which setting(s)
have caused the observed problems.In sum, we address one main problem: There are existing guides
to configure systems securely, but we cannot implement the re-
quiredconfigurationsettings(takingintoaccountnecessarycus-
tomization and changes due to updates of the guides) without sig-nificant manual effort.
Oursolutionto this problem, realized for Windows operating
systems and applications, consists of three major steps. First, we
processthefileswhichdefinetheWindowssecuritypolicysettings
thatexistonaWindows-basedsystem.Windowssecuritypolicy
settingsarerulesthatadministratorsconfigureonacomputeror
multipledevicesforthepurposeofprotectingresourcesonadevice
or network. [ 13] We can configure a policy setting with a policy
pathandavalue.Theso-calledAdministrativeTemplate(ADMX/L)filesdefinethemajorityofpolicysettings.Theycontaininformation
about valid policy paths, possible values for each policy setting,
andtheunderlyingimplementationofapolicysettingwithinthe
Windowsregistry.Thus,weextractthisknowledgeinthefirststep
and store it in a machine-readable format to access it during the
remediation.Second,weusenaturallanguageprocessingtoextract
thesettingsandtheintendedvaluesfromtheguides.Weusetheinformation of the first step to verify that the extracted setting
existsandthattheextractedvalueisavalidinputforthissetting
andcan,therefore,reducetheriskofwronglyextractedvaluesto
a minimum. Third, we translate the settings and values to their
real implementation using the information from the first step. Our
tools can use this information to implement as well as check the
configuration settings automatically.
Our contributions are:
•an approach to how existing Windows-related security-configuration guides can be automatically implemented;
•a proof-of-concept implementation of our approach;
•
a step-by-step documentation of our approach using the
DISAWindowsServer2016guide[ 26]andanupdatedver-
sion using the DISA Windows Server 2019 [28];
•an evaluation of our approach using existing guides from
DISA and CIS with over 2000 rules [27].
In §2, we explain the general idea of our automatic implementa-
tion,andinthesubchapters,wepresentthetechnicaldetailsofourproof-of-conceptimplementation.In§3,weusetheDISAWindows
Server 2016 guide and 12 CIS guides to demonstrate the feasibility
of our approach. In §4, we discuss challenges and first experiences
ingeneralizingourapproachtonon-Windowssystemsaswellas
additional future work. §5 treats related work and §6 concludes.
2 WINDOWS-RELATED SECURITY
CONFIGURATION
Generic Approach. The generic approach is depicted in Figure 2.
It shows the different stages of the envisioned process for auto-
maticallyimplementingWindows-relatedsecurity-configuration
guides. More specifically, the separate steps are defined as follows.
Extraction: Usenaturallanguageprocessing(NLP)foreachruleto
automatically extract the information needed to implement
this rule.
Verification: Check with an automated mechanism that checks
whether the derived information is valid:
–Does the extracted policy path indeed exist?
599Automatic
ChecksImplement rulesSecurity-
conﬁguraiton
guide
AdministratorPublishercreates
Systems
under
TestAutomatic
Manuallycheck rules
Legend
Figure 1: Current State of Implementation of Windows-
related Security-Configuration Guides
–Hastheextractedvaluetherequiredtypeforthatsetting?
–Does the extracted value meet the requirements of that
setting?Isitinthelistofpossiblevaluesorintherange
of allowed values?
Ifthepathorthevalueisincorrect,themechanismprovides
useful feedback about possible paths or values.
Transformation to low-level: Transform Windows policy set-
tingsintoarepresentationofoneoftheunderlying low-level
implementationmechanisms.Thisstepisnecessarybecausealmostnoneofthemostpopularconfiguration-management
frameworks can directly process the Windows policy set-
tings,butrequirethespecificationofanunderlyingimple-
mentation mechanism:–Registry settings
–Secedit policy file entries
–Audit file entries.
Transformation to code:
Transformtheselow-levelimplemen-
tation mechanisms into code for carrying out the implemen-
tation of each setting.
Implementation: Executecodeonthesystemwewanttoharden
to implement the rules.
We emphasize that especially steps one and two are novel because
– to our best knowledge – there is no approach published that uses
NLP to extract policy settings from SCAP guides, nor is there an
approachthatverifiesextractedvaluesusingdefinitionfiles.Forthe
evaluationofourapproach,weassumedthatanevaluationofthe
completesystemsprovidesmoreevidencefortheusefulnessand
feasibility of the presented approach than an evaluation of the first
two steps alone. Consequently, we had to design and implementthe remaining steps for our PoC implementation. In the end, weachieved the first published system that reads Windows-related
security-configuration guides in the SCAP format and implements
them automatically.
The approach in detail. We discuss the details of our approach
and demonstrateits feasibilityusing aproof-of-concept (PoC)im-
plementation.1system: org.scapolite.implementation.win_gpo
2ui_path: <String containing a valid Windows policy path, using
3 backslashes as separators>
4value: <A YAML representation of a valid value for the
5 specified path>
6verification_status: (Checked. | Unchecked.)
.
Listing 2: Syntax of the Windows policy automation
Thestepsofouractualimplementation,whichweuseasaproof
of concept, are depicted in Figure 3. We describe them shortly here
and more in detail in the rest of this section.
The input of our PoC consists of guides in the SCAP format.
In the first step, we extract the necessary data for every rule to
automatetheimplementationofthisruleusingnaturallanguage
processing.Theresultisasetofrulesenrichedwiththeconfigu-
ration settings in a machine-readable format. These configuration
settings are then passed to the verification process: it has to be ver-
ifiedthattheextracteddata(aWindowspolicypathandrequired
policyvalues)isvalid.Ourimplementationusestheinformationof
manuallycreated verificationrulesfor whatessentially arelegacy
configuration settings combined with information extracted from
theWindowsadministrativetemplatefilestoverifytheextracted
values. To make the verification process as fast as possible, we pro-
cess the latter files a priori and store the information we need in a
database format.
If theverification is successful, the low-level automation needed
to implement the rule is generated and also stored within the rule.
Depending on the chosen implementation mechanism, these areused to create (1) either a group policy backup, which then canbe imported on a Domain Controller to secure all systems in an
Active Directory or (2) a JSON file used by a PowerShell script for
implementing the settings. Additionally, our tooling can check the
rules using the JSON files, but as SCAP already covers this aspect,
we will not look deeper into this facet of our PoC.
InourPoCimplementation,onlythesecondandthirdstepsre-
quireaminimumofmanualinteraction;theotherstepsareentirelyautomated.Thedottedlinebetweenthe Verification andtheConfig-
urationSettings inFigure3indicatesthatthepersonautomatingthe
security-configurationguidemayhavetoexecutetheverification
more than once and adjust the values until every rule is marked as
checkedby the verification mechanism.
In the following, we describe each of these steps. Tooling has
been carried out in Python, except for a PowerShell framework
for implementing and checking Windows security configurations
using the output of Step 4. As a real-life example, we use the DISA
WindowsServer2016SecurityTechnicalImplementationGuide[ 7].
WecreatedaGitHubrepository[ 26],whereweconductedallthe
steps,andcreatedacommitandatagaftereverystepandreference
them by their tags.1
1ForrepresentingtheguidewihinGithub,weusetheYAML/Markdown-based Scapolite
format developedwithin Siemens, which isbettersuited than SCAPfor authoring and
maintenance. The approach, though, is independent of the format.
600Guide 1. Extraction 2. Veriﬁcation3. Transformation
to low-level4. Transformation
to code5. Implemenation
on the system
Phases Input Result
Figure 2: Overview of the abstract hardening approach.
2.1 Natural-language-processing-based
extraction of Windows Policy Automations
The first step of our PoC implementation is the extraction of the
needed values using NLP. Before we can extract the information
needed to implement a Windows-related rule automatically, wehad to define the structure of the machine-readable constructs,
Step 1¬Extract
conﬁgurations/
values
with NLPConﬁguration
Settings
createsusesStep 2 & 3
Veriﬁcation
Low-level
Automations
AutomaticallyExtractedknowledge
creates
Knowledge
extractionManually
extracted
knowledge
Step 4
JSON
ExportSCAP -
XCCDF
inputADMX
ADML
Legend
InputManually
AddedOutput Fully
AutomaticallySemi
AutomaticallyStep 4
GPO
Export
Step 5
Implement
RuleJSON with all information
to apply or check the rules
Step 5
Check
Rule
On the system under testCheck
ResultsGPO
Backups
Scapolite
ObjectsAuxiliaryOutput
Figure 3: Overview of the steps of our actual implementa-tion.
IN q0 .* q1 VBN, VBD, VB q3 IN q4
.*q5
.*
VBN, VBD q6 IN q7 NN, NNP q8 . q9TO q2
.*
NN, NNP
q10
Figure 4: Example of an extraction rule as a nondeterminis-tic finite automaton.1id: SV-88407
2rule: <see below>
3implementations:
4 -description: <see below>
5 automations:
6 -system: org.scapolite.implementation.win_gpo
7 ui_path: 'Computer Configuration\Policies\Windows
Settings\Security Settings\Local Policies\User Rights
Assignment\Back up files and directories'/arrowhookleft→
/arrowhookleft→
8 value:
9 -Administrators
10---
11
12 ##/rule
13The Backup files and directories user right must only be assigned to
the Administrators group. /arrowhookleft→
14 ##/implementations/0/description
15Configure the policy value for Computer Configuration >> Windows
Settings >> Security Settings >> Local Policies >> User Rights
Assignment >> "Back up files and directories" to include only
the following accounts or groups:/arrowhookleft→
/arrowhookleft→
/arrowhookleft→
16 -Administrators
Listing3:ExampleruleoftheDISAWindowsServer2016in
YAML/Markdownform,incl.aWindowspolicyautomation
starting in line 6 (blue).
how they are integrated into the rule structure, and what has to be
extracted to implement a rule.
For specifying Windows policy settings, the structure must pro-
vide information about the policy path and the required value. The
typeofthevalue(string,list,integer,etcetera)dependsonthepath;
hence the specification of the automation syntax must refer to the
setofvalidWindowspolicysettingsasshowninListing2.Listing3
shows the usage of a policy automation in the rule SV-88407 of the
Windows Server 2016 guide. In an ideal scenario, the rule already
containsthe machine-readableautomationobjects,but thisisnot
the case for guides published in the SCAP. Thus, we needed to
extract the information about required policy settings from the
human-readable description in the guide. To this end, we used the
Natural Language Toolkit (NLTK) [ 1]. Due to the highly schematic
structure of the guides under consideration, only eleven extraction
ruleshadtobedefinedtoprocessmostoftherules.Oneoftherules
ispresentedhereinListing4andFigure4.Thelistingshowsthe
definition of such an extraction rule as part of a grammar in NLTK.
IN,TO, etc. refer to the corr esponding part-of-speech (POS) tags.
Aswehavetenrules,ourgrammartoextractthevaluesconsists
oftenruledefinitions.Tomaketheideamoreprecise,Figure4is
SENTENCE_WITH_ENABLED_WITH_X_SELECTED_FOR_Y:
{<IN> <.*>+ <TO>< VBN|VBD|VB>< IN> <.*>+ <VBN|VBD>< IN><NN|NNP>+
<.>} /arrowhookleft→
Listing 4: Example of an extraction rule with POS tags.
601id: controlpaneldisplay__cpl_personalization_nolockscreencamera
registry:
name: NoLockScreenCamerapath: Software\Policies\Microsoft\Windows\Personalizationhive: HKEY_LOCAL_MACHINEtype: REG_DWORDenabled_value: 1disabled_value: 0
Listing 5: Example of a relationship between the id and the
definition of the registry to set.
presentingthesameruleasanondeterministicfiniteautomaton;
q0marks the start state and q11the end state.
WeuseNLTKtolabelthetextofthedescriptionofarulewith
POS tags. Afterward, the tagged sentences are passed to the gram-
mar. If a sentence or a part of a sentence matches an extractionrule, then we know that here we can extract information for the
automaticimplementation.Weusethissentencefromrule SV-92831
as an example: “Configure the policy value for Computer Configu-
ration »Administrative Templates» MSSecurity Guide» Configure
SMBv1clientdrivertoEnabledwithDisabledriver(recommended)se-lectedforConfigureMrxSmb10driver.” Now,weuseNLTKtogetthe
POS tags: (’Configure’, ’VB’), (’the’, ’DT’), ..., (’for’, ’IN’), (’Computer’,
’NNP’),...,(’driver’,’NN’),(’to’,’TO’),(’Enabled’,’VB’),(’with’,’IN’),
(’Disable’,’JJ’),...,(’)’,’)’),(’selected’,’VBN’),(’for’,’IN’),(’Configure’,
’NNP’),...,(’driver’,’NN’),(’.’,’.’) Thesegmentstartingat formatches
the pattern defined in the extraction rule, and we would reach the
endstateofFigure4.Usingourdefinitionoftheextractionrule,we
know that we have the policy path in the part within the POS tags
INandTO, the first value between TOandIN, the second value
betweenINandVBN, IN, and the name of the option for which the
second value has to be set between VBN, IN, and ’.’.
Asalreadymentioned,weneedonlyelevenextractionrulesto
extract information for most of the DISA Windows Server 2016
guide;foracomparableCISguide,wedefinedtenrules.PleasenotethattheextractionusingNLPisassimpleasthisonlybecauseDISA
and CIS write their guides in a highly schematic way.
If the automatic extraction process could not obtain any or only
ambiguous information for a setting to set, the respective rules
are marked in this step of the process. For these rules, automation
objects have to be created manually using the hints from the auto-
matic extraction. For the analysis of the degree of automation, we
referto§3.1.Listing3istheresultofasuccessfulextractioncarried
out by our tool.2
2.2 Verification of Windows policy
automations
As already mentioned in §2.1, the set of available policy settings
determine the syntax (and semantics) of the Windows policy au-
tomations.Thesetofavailablepolicysettingsvariesbetweendiffer-entversionsofoperatingsystemsandpolicy-managedapplications.
Thus, we can determine the validity of a policy automation for a
specificversion ofOSor anapplication. Asmentionedbefore, the
ADMX/L files define the majority of Windows policy settings. The
Windows OSs use these files to display the GUI for configuring
policy settings via point-and-click and keep the policy content and
2Tag: step-3-extract-configurations-values-with-nlpthe actual implementation of the settings in the registry in sync.
Microsoft regularly issues updates of the ADMX/L files.
To make this more visual, we provide another example: From
theControlPanelDisplay.admx and theControlPanelDisplay.adml
files located under policies on Windows Server 2016 instances, our
exporter can get the information that the setting with the policypathComputer Configuration \ ... Control Panel \ Personalization
\ Prevent enabling lock screen camera has the id CPL_ Personal-
ization_NoLockScreenCamera.Westorethisrelationshipandthe
information to which registry this id belongs in our export; this is
presented in Listing 5. Here, we can get the information on which
hive,path, andregistrynameareaffected. Furthermore,weknow
that only EnabledandDisabled are valid options for this setting
and that we can translate them to 1 and 0, respectively.
Thereare,however,alsoWindowspolicysettingsthatarenot
defined via ADMX/L files. These other settings are represented
throughentriesineitheraspecialconfigurationfile( GptTmpl.INF )
oraCSVfile( audit.CSV )whencreatingafile-basedrepresentation
of policy settings on a Windows OS through the lgpo.exe [12]
tool provided by Microsoft. Unfortunately, there exists – to our
bestknowledge–nomachine-readablerepresentationthatspeci-
fies thesepolicysettings. Luckily, wecould extractmany ofthese
specifications for configuration definitions from the SaltStack [ 23]
implementationofthe win_lgpo moduleformanagingWindows
configurationsettings. (Fromthe 196settings configurablevia the
INF file, we could obtain 139 from SaltStack’s implementation; the
remainingspecifications,whichweencounteredinthecourseof
our work on several Windows OS versions, were added manually.)
Furthermore, we could extract the specifications for all settingshandled via
audit.CSV via parsing a given audit.CSV file. Thus,
themanualeffortrequiredfordealingwiththesenon-ADMX/Lset-tingswasnegligiblewhencomparedtotheover4000configuration
specifications we could extract automatically.
Withtheinformationof theknowledgeextraction,theverifica-
tion process can now determine for each configuration setting ifthe policy path is valid and, if so, whether the provided value is
admissible for that particular policy path.
WehaveimplementedourtoolingsuchthattheWindowspolicy
automationsinagivenguideareparsedandverified.Ifthepolicy
path exists and the given value is acceptable, the automation is
markedaschecked.Ifnot,theautomationisenrichedwithasmuch
information as possible:
•Ifthepolicypathdoesnotexist,informationaboutsimilar
policy pathsis supplied, using theLevenshtein distance [ 11]
oncharacterandwordbasisoverthesetofvalidpolicypaths.
This set is a byproduct of our import step. To have the set
of valid policy paths accessible is one reason to create those
filesapriori.Listing6a)providesanexampleoftheresult
of the verification step.
•Ifthevalueisnotadmissibleforthegivenpolicypath,infor-mationaboutadmissiblevaluesisaddedtotheautomation–
see Listing 6b) and c).
Weproceedasfollowstoverifyandcorrectthepolicyautomations:
(1) The verification mechanism is run a first time.3
(2) The user reviews the reported errors and corrects them.
3Tag: step-4-verification-1
6021ui_path: ... \ Control Panel \ Personalization \ Prevent
2 enabling lock screen
3value: Enabled
4error_class: NOT_FOUND policy name "preventenablinglockscreen"
5error_hint: " The given path was not found, but there were 3 similar
policies. If the UI path you were looking for is in the array,
please replace the original UI path with the new UI path."/arrowhookleft→
/arrowhookleft→
6candidates:
7- Control Panel\Personalization\Prevent enabling lock screen camera
8- ... \ Prevent enabling lock screen slide show
9- ... \ Prevent changing the color scheme
10 ---
11ui_path: '... \ Network security: LAN Manager authentication level'
12value: Send NTLMv2 response
13error_class: CONFIGURE
14error_hint: "To apply this rule, please choose a setting value for
each sub-setting in candidates. Next, replace the content of the'value' attribute with the content of candidates." /arrowhookleft→
/arrowhookleft→
15candidates:
16- Send LM & TLM responses - use NTLMv2 session security if negotiated
17- Send NTLMv2 response only. Refuse LM & NTLM
18- Send NTLM response only
19 ...
20 ---
21ui_path: ... \ Configure Windows Defender SmartScreen
22value: Enabled
23candidates:
24 main_setting:
25 - Disabled
26 - Enabled
27 Pick one of the following settings:
28 - Warn
29 - Disabled
30 - Warn and prevent bypass
Listing 6: Failed verifications: a) Policy path does not exist;
informationabout3possibleoptions.b)Specifiedvaluedoesnotexist;admissiblevaluesprovided.c)Policysettingunder-specified; request for additional value.
(3)
Verificationisre-runeitheronarule-by-rulebasisorforthe
complete guide.4
(4)Onceall errorshave been corrected,anexport pairingthe
human-readabledescriptionandthepolicyautomationfor
each rule is created, allowing the user to verify very quickly
that the automation indeed faithfully reflects the human-
readable specification.5
This verification seems simple, but studies have shown that 42%
oftheconfigurationerrorsthatcausedhigh-impactincidentsare
obvious errors (e.g., typos) [ 31] and that a significant number of
configuration errors are due to compatibility issues[ 40]. Our verifi-
cation is able to catch such problems at the earliest possible stage.
2.3 Generation of low-level implementation
mechanisms
Windows policy settings are implemented through registry set-
tings,INFpolicy file entries, and audit file entries. To represent
these mechanisms within a guide, we introduce automation exten-
sions for these three mechanisms. Using the information gathered
as described in §2.2, we implemented a transformation from thepolicy automation into the corresponding low-level automation
extension.6
4Tag: step-4c-fix
5Tag: step-5-create-xlsx-report-for-the-current-guide
6Tag:step-6-enrich-scapolite-with-low-level-automations,atablewithallthelow-level
automations can be found under xlsx/report_with_low_level_automations.xlsx.1ui_path: ...\Apply UAC restrictions to local accounts on network
logons /arrowhookleft→
2value: Enabled
3verification_status: Checked.
4- system: org.scapolite.implementation.windows_registry
5config: Computer
6registry_key:
SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /arrowhookleft→
7value_name: LocalAccountTokenFilterPolicy
8action: DWORD:0
Listing7:ExampleofaWindowspolicyautomationandtheresulting Windows registry automation.
Listing 7 provides an example: according to the Windows pol-
icy automation (line 1 to 4), the value Enabledhas to be set for
thepolicysettingwithpath ...\ApplyUACrestrictionstolocalac-
counts on network logons. Using information extracted from the
ADMX/L files, we can generate the Windows registry automa-
tion: the registry key under the path SOFTWARE \ Microsoft \ Win-
dows\CurrentVersion\Policies\System withthevaluename LocalAccount-
TokenFilterPolicy has to be set to a DWORDwith the value 0.
2.4 Transformation into code
Themainideabetweentheseparationofthisstepandtheactual
implementationwasthatwecouldexecutealltheprevioussteps
on one machine, export the information, and do only the actual
implementation on the system under test. Thus, a central instance
can be used for storing and processing relevant guides; systems
undertestcanfetchtherequireddataforimplementing(andtesting)securityconfigurationsfromthatcentralserver.Tofurtherfacilitate
this approach, we implemented an export from a guide containing
low-level automation for Windows into a JSON document that
contains all data relevant for implementing each rule with the
associated automation(s).
Inordertosupportimplementationsviapolicies(eithervialocal
group policies or via the Active Directory capabilities), we can
also automatically generate policy backups based on the extracted
information.Wehaveimplementedthisstepaspartofacontinuous-
integration where changes to automation in a guide lead to an
automated re-generation of both scripts and policy backups.7
2.5 Implementation of the rules on the system
using PowerShell
When choosing a target language framework to use to implement
the rules using the information of the tow-level automation de-scribed in §§2.2 and 2.3, we decided to use PowerShell for the
following reasons:
•Common configuration management frameworks like Ansi-
ble,Puppet,Chef,andSaltStackcannothandletheWindows
policy settings or use PowerShell to implement them. Thus,
wedecidedtousePowerShellwithoutaconfigurationframe-
work as a wrapper to implement the rules.
•Microsoft’s effortsto allow code/script-based configuration
management of Windows rather than the GUI-based mecha-nismcenteringonthepolicyeditorarebasedonPowerShell.
7Tag: step-8-export, policy backup folder for each profile under lgpo_backups.
603Table 1: Extracted, verified, and automated rules.
Categories # % % of OVAL
Rules 274 100
Configurations Extracted with NLP 198 72.3 95.6
Rules without extracted values 76 27.7 36.7
First-Time Verified 173 63.1 83.6
Not verified the first time 25 9.1 12.1
Non-automatable but extracted 2 0.7 1.0Automatable but not extracted 4 1.5 1.9
Verified after manual correction 27 9.9 13.0Automated Rules 200 73.0 96.6
•PowerShellisinstalledbydefaultonallWindowsOSsthat
are still in mainstream support by Microsoft.
•To fully leverage the ability to generate mechanisms for
rule-by-rule implementationrather than the bulkimplemen-
tation offered, e.g., in the form of policy backups, we looked
forrobustroll-backfunctionalitythatallowedustoreseta
configuration reliably to its previous value.
Thus, we have created a PowerShell library that, based on the
JSON file, applies, checks, and reverts single as well as several
or all rules. As mentioned before, our tooling uses the extracted
information to check whether the system is compliant to a rule au-
tomatically.ThisfunctionalityisalreadycoveredwithinSCAP,and
there are many SCAP-compliant scanners. Therefore, the checking
functionality is not in the focus of this paper.
Our PowerShell library uses Windows tools that assure that the
configurationchangesarereflectedinthelocalpolicy: secedit,au-
ditpol, and LGPO.exe [12]. In the end, we can implement a security-
configuration guide by running one PowerShell command.
3 EVALUATION
Todemonstratethepresentedapproach’spotential,weusethereal-
lifeexampleofrealizingautomaticrule-by-ruleimplementationsforthe DISA Microsoft Windows Server 2016 guide Benchmark [
7] for
anevaluation.8Thebenchmarkconsistsof207ruleswithautomatic
checks and 67 rules without automatic checks.
The results of all steps shown below are available for review
[26]. Every step is denoted as a commit and marked with a tag.
Thus, a diff view between a commit and its predecessor reveals the
constructsadded,removed,orchangedinthisstep.Inthisarticle,
wewillconcentrateonthisrepository.Additionally,wecreateda
newrepositorywiththeDISAWindowsServer2019guide[ 28]and
executedthesamestepstodemonstratethatourapproachworks
on recent SCAP documents as well. Thus, the fact that we used
Windows Server 2016 should not be a threat to our evaluation’s
validity.
We seek to answer the following Research Questions:
8WechooseDISA’sguidebecausetheirSCAPcontentispublic.OnlyCISmembers
can access CIS’s SCAP content, whereas their PDFs are publicly available.RQ1Forhowmanyrulescanweautomaticallyderiveanim-
plementation from the text in natural language? How high
is their percentage?
RQ2How many of the extracted rules are automatable, and
how many automatable rules were not extracted?
RQ3After correcting wrongly extracted automations: How
manyrulescanweimplementautomaticallyforthecomplete
guide?
RQ4How much time does our approach require to extract the
information, verify it, and implement the rule?
RQ5Howmanyrulesareimplementedcorrectlyinaccordance
with the automated checks?
We will use the DISA Windows Server 2016 guide to answer
RQ1-4and several CIS guides to answer RQ5. ForRQ5,w eu s e
CIS guides because, for them, we have the automatic checks and
can assess a given system using their CIS-CAT tool.
3.1 Degree of automation
Toanswer RQ1,RQ2,andRQ3,weexaminethestepsregarding
theextractionofWindowspolicyautomationusingNLPandthe
verification of the found policy paths and values. The results are
depictedinTable1.Fromthe274rulesintheWindowsServer2016
guide, we can extract for 198 rules a possible policy setting withpossible values. Afterward, from the 198 possible configuration
path/value pairs, 173 can be directly verified as valid configuration
settings by the first verification step. These 198 rules mean that for
63%oftherules,wecanextractboththepolicypathandtherequired
valueandverifythatthisvalueisvalidfortheparticularpolicypath
without any manual effort. Thus, we could answer RQ1.F r o mt h e
remaining25rules,fortworules,potentialconfigurationsettings
and values have been extracted erroneously: with our automation
mechanisms, we could not automate these two rules. We removed
theerroneouslycreatedautomationsforthesestworulesmanually.9
Conversely,forfourrulesthatwecouldautomate,neitherthepolicy
pathnortherequiredvaluewasextracted.Inthiscase,weadded
the automation manually.10Thus, the ratio of rules not added to
the set of rules to automate, although they are automatable, lies
at1.5%,whereastheratioofruleswhicharenotautomatableand
stillextractedis0.7%regardingallrules.Fortheremaining23rules
that were extracted but could not be verified in the first round, we
created the correct automation based on the extracted information
enriched with the verification process’s hints.11
If one sees the NLP based extraction process as a classifier with
the classes automatable andnon-automatable, the false-positive
rateofthisclassifierisat2.7%andthefalse-negativerateat2.0%.
We had to adjust 27 rules manually. Thus, for 90.1% of all rules,
respectively,87%oftheautomatablerules,nomanualactionwas
neededthroughouttheprocess.Insummary,thesenumbersanswer
RQ2andgivestrongevidencefortheimportanceofourverification
step because otherwise, these rules might be applied wrongly or
not at all.
After the execution of the extraction and the verification step
and the manual adjustments, we now have 200 rules which can be
9Tag: step-4a-fix-rules-which-have-been-imported-but-are-not-automatable
10Tag: step-4b-fix-rules-which-have-not-been-imported-but-are-automatable
11Tag: step-4c-fix
604Table2:Timeneededtoexecutethesinglestepswithall200
automatable rules of the DISA Windows Server 2016 guide.
Step Time (s)
Knowledge Extraction from ADMX/L 81.59
Import into Scapolite 8.02
NLP extraction of policy automations 16.93Verification of policy automations 23.48
Export automations in JSON 13.90
Export automations in XLSX 14.03
Export policy backups from JSON 1.65
Check all rules for compliance 13.96
Implement automatable rules one-by-one 73.35
Σ 245.91
automatedandhavevaluesthatareverifiedtobevalidforthegivenconfigurationdecisions.Therefore,thegradeofautomationwecanachieve on the set of the 274 rules is at 73.0%, respectively, at 96.6%
if we are only considering the 207 automatable rules (classifiedas automatable by DISA). This number answers
RQ3. Thus, our
approachreducesthenumberofruleswhichhavetobecheckedor
set manually on the system under test significantly.
3.2 Time
Table2showstimevaluesforeachoftheautomatedsteps.12The
short execution time per rule enables an application in CI ap-
proaches, which answers RQ4partially.
If we want to calculate the overall time, we also have to in-
clude the time it takes to correct the wrongly extracted automa-
tions.AccordingtoTable1,25ruleswerenotverifiedthefirsttime.
Because of the feedback included in the rule, we assume that ittakes 10s to correct such a rule. For the remaining four plus tworules, we assume that it takes at most 2min per rule to correct it.
These assumptions are also backed by the feedback of the users
ofourtoolsatSiemens.Therefore,weendupwithatotaltimeof
245 .91s+25∗10s+6∗120s=1215 .91s≈20minfor all rules or 6 s
per rule. Thus, RQ4could be answered, too.
3.3 Correct Application
In the last step of our evaluation, we want to answer whether our
approachisapplyingthesecurity-configurationguidescorrectly.
IncorrectlyimplementedrulescanresultfromfaultsintheADMX/L
importer, the verification process, or the PowerShell library. Here,
our idea was that after applying a security-configuration guideto a system, the system should be configured as specified in the
guide.Forthisexperiment,weusethestandardizedOVALchecks
as ground truth. Thus, we used guides which are Windows-related
andforwhichwehaveautomatedchecks.Therefore,weusedinthisstep 12 different security-configuration guides from the CIS, which
12Allthestepsareconductedbyrunningdifferentcommandsfromthecommand-line.
We ran every command 50 times and averaged the elapsed time to evaluate the speed
of the single steps. Configuration: 3.1 GHz Intel Core i7 with 16 GB RAM, Python
3.7.4. The only steps implemented in PowerShell are the application viz. the check for
compliancestepastheseweredesignedtobeexecutedonthesystemundertest,inour
case,aWindows-basedsystem,withoutinstallinganyadditionalsoftware.PowerShell
Version 5.1.14393 was used.are listed in Table 3, totaling over 2000 rules: Four Windows-based
OS’s, six components of the Office package, and two browsers.
We conducted the evaluation as follows: First, every security-
configurationguidewasautomatedthroughthesameprocess,as
explained in §2. Next, we set up a clean environment for every
system.13Additionally, we installed a SCAP-compliant scanner
onthemachines,i.e.,theCIS-CATtool[ 4].Next,weexecutedthe
checksinthe cleanenvironmenttocomparethecleanstatewiththe
hardenedstatetoshowthattheimplementationofguidesmakes
thesystemmoresecure.Afterwards,theguidesareimplemented
usingtheautomationgeneratedasdescribedin§2.Nowthechecks
are rerun to test whether the implementation was correct. The
resultsaredepictedinTable3. Wealsopublished thecheckreports
beforeandaftertheimplementationonGitHub[ 27].Withinthis
repository, one can find for every checked guide a before.html and
after.html containingtheresultoftheautomaticcheckcreatedusing
the CIS-CAT tool.
NotethatweonlyconsidertheruleswhichhaveOVALchecksfor
thecalculationofthepercentages.WeseethatfortheOSsbetween
16.9and26.3%oftherulesarealreadysetupinacompliantway,
whereas nearly no rule is pre-configured securely for the other
components.Nevertheless,even26.3%ofalreadyfulfilledrulesof
the OSs imply that the majority of the settings are configured inan insecure way on a clean system. After applying the rules, the
percentageofcompliantrulesisbetween95and100%forallguides.
That we do not reach 100% compliance relative to the results of
the CIS-CAT checker tool is due to errors in the guides, some of
them in the automated check, others in the descriptive text. For ex-
ample,somechecksareoverspecified,i.e.,theyexpectmorechanges
than actually occur when implementing the corresponding con-
figurationsetting:therule 18.5.9.1oftheWindows10benchmark
changesonlyasingleregistryentry,butthecorrespondingcheck
refers to three different entries. Also, some rules have automatic
checks which test for wrong values. For example, the check for the
rule1.8.7.4oftheWordguideexpectsadifferentvalue(namely0)
than the value, which is set if the rule is implemented manually
followingthesecurity-configurationguide.Thus,wehaveinthis
rule precisely the difference of implementation and check we want
to overcome with our approach. Finally, there were some errorsregarding the description of the implementation provided in the
guides. For example, rule 1.8.7.2.7of the Word guide specifies that
thesettingshouldbeenabled,althoughtitleanddescriptionsuggest
disablingthesetting.Anothererrorinaguideactuallyisduetoa
misspellingoftheADMX/LtemplatefileprovidedbyMicrosoft.For
example, rule 1.13.2.1.5 of the Outlook guide specifies the value to
be implement as When online always retrieve the CRL, but our tool
couldnotvalidatethisvalueforthissettingbecauseofamisspellinginatemplatefile.There,thevalueiswrittenas Whenonlinealways
retreive the CRL.
All in all, we achieved compliance for 1965 rules (i.e., 97.6%)
after implementing the guides. For the OSs, we have the highest
absolutegainofcompliantrules(between237and404rules),but
in relative numbers, we are only gaining between 71% and 80%,
13For the OS’s, we have set up every system in a new VM by installing the OS
directlyfromthelatestISOdown-loadablefromMicrosoft.AsaVMprovider,weused
VirtualBox. For the other components, e.g., Chrome or PowerPoint, they were directly
installed on a clean Windows 10 instance.
605Table3:#rulesperguidecomplianttothegivenguidebeforeandafterimplementingguideautomatically.Highestvalueofa
column: dark gray, lowest: light gray.
Guide # of Rules OVAL Before % After % ΔΔ%
Google Chrome for Windows 20 20 001 9 95.0 19 95.0
Internet Explorer 11 156 136 1 0.7 132 97.1 131 96.3
Microsoft Office 53 53 2 3.8 52 98.1 50 94.3
Microsoft Access 99 009100 9100
Microsoft Excel 34 34 003 4 100 34 100
Microsoft Outlook 75 73 3 4.1 72 98.6 69 94.5
Microsoft PowerPoint 18 18 1 5.6 18 100 17 94.4
Microsoft Word 24 24 00 23 95.8 23 95.8
Windows 7 390 386 87 22.5 377 97.7 290 75.1
Windows 8.1 429 425 90 21.2 415 97.6 325 76.5
Windows 10 505502 85 16.9 489 97.4 404 80.5
Windows Server 2016 371 334 88 26.3 325 97.3 237 71.0
Σ 2084 2014 357 17.7 1965 97.6 1608 79,8
whereasfortherest,wehaveagainofover90%.Pleasenotethat
our approach can also implement the settings which were already
compliant on a clean instance, but we have chosen this scenario
becauseitseemedmorerelevantandnatural.Thealternativewould
havebeentocreateaninstanceinwhicheverysettingisconfigured
to a non-compliant value.
Discussion. InRQ1, we asked for the percentage of rules for
which we can automatically extract the implementation. If our
approach extracted the implementation only for a small fractionof rules, it would be useless in real-world applications. Since weextracted for 63% of all rules and 96% of automatable rules an
implementation, we can rule out this concern.
InRQ2,welookedforthepercentageoffalsenegativeandfalse
positives of our extraction process. If these numbers were too high,
the administrators would spend much time identifying them so
that our approach would become pointless. With 1% and 2% of the
automatable rules wrongly classified, this is not the case.
InRQ3, we searched for the percentage of rules that we can
automate after correcting the extraction process’s errors. If this
numberweretoolow,administratorswouldspendthesameamount
of time for implementing the remaining rules, and the gains of our
approachwouldbesmall.Ourresultsshowthatwecanautomate
97%oftheautomatableruleswithourapproachanddramatically
reduce manual implementation.
InRQ4, we asked for the time taken to execute our approach. If
thestepsweretootime-consuming,itwouldbemoreefficienttodo
itmanually,andourtoolingwouldbeunnecessary.With245.91s
##/implementations/0/description
Follow the below steps to disable `Location Services`:
1.Tap`Settings` Gear Icon.
2.Tap`Security & Location`.
3.Scroll to the `Privacy` section.
4.Tap`Location`.
5.Toggle to the `OFF`position.
Listing8:Exampleofanimplementationaspartofaruleinan Android security-configuration guide.for the tools themselves and 1215.91s for the complete process, our
approach is more efficient than the manual approach.
InRQ5,wesearchedforthepercentageofruleswhicharecor-
rectly implemented according to the automatic checks. If our ap-
proachimplementedtheruleswrongly,itwouldbeuseless.With
over97%ofcorrectlyimplementedrules,ourapproachimplements
almost all rules correctly.
Insummary,ourevaluationshowedthatourapproachisfeasible
and effective.
4 GENERALIZATION AND FURTHER WORK
Themainlimitationofourextractionstepisthefactthatthisex-
traction is only possible because of the highly schematic structure
ofthedescriptionswrittenbyCISandDISA.Iftheymodifytheir
template for these descriptions, we will have to adjust this stepentirely. Thus, we hope that future guides will have the neededinformation in a machine-readable form. A limitation of our im-
plementation of Windows-related guides is the dependency on the
LGPO.exe. If Microsoft decided to remove this tool for changing
Windowssystem settings,wewould havetoreplace coreparts of
the presented approach.
We admit that our approach is only an intermediate solution. In-
steadofconvertingguidestoexecutablesbyusersorthirdparties,it
wouldbemorepracticalforpublisherstoattachmachine-executable
codesorlinkstothemtotherulesastheyaredoingitforautomatic
checking. Nevertheless, as long as the publishers do not distribute
the guides so that we can quickly and automatically implement
them, we need tools like those we presented in this paper.
ui_name: Location
namespace: securename: location_providers_allowedvalue:
ON: +network,+gpsOFF: -network,-gps
Listing9:ExampleofadefinitionforanAndroid-relatedset-
ting.
606##/implementations/0/description
Set the following parameters in `/etc/sysctl.conf` or a
`/etc/sysctl.d/*` file:
```
net.ipv6.conf.all.accept_ra = 0net.ipv6.conf.default.accept_ra = 0```Run the following commands to set the active kernel parameters:```# sysctl -w net.ipv6.conf.all.accept_ra=0# sysctl -w net.ipv6.conf.default.accept_ra=0# sysctl -w net.ipv6.route.flush=1```
Listing 10: Example of an implementation in an Ubuntu
Linux security-configuration guide.
Our approach is tailored to Windows and its policies. Thus, the
approachcannotbeportedtootherplatformswithoutsignificant
adjustments.Nevertheless,wearedevelopingsimilarapproaches
for Linux OSs and Android in particular and try to achieve similar
results there as well.
In Listing 8, one can see the implementation of an Android-
related rule. It describes highly schematically the actions to imple-
ment. Thus, the difficulty of the extraction process as described in
Figure 1 is comparable to that for the Windows-related guides.
Theverification step is more difficult, because we do not have
asimilardefinitionofpotentialsettingsandthesetofvaluesthey
can have. In Windows, we can extract this information from the
ADMX/Lfiles,butinAndroid,thereare–toourbestknowledge
–nocomparablefilesavailable.ToportourapproachtoAndroid,
we created such definition files for several settings. For the setting
Location,onewouldfindanentryinthisdefinitionfileaspresentedinListing9.Withthisinformation,wecanverifythat OFFisavalid
valueforthissetting.Furthermore,wecanusetheinformationthat
we can translate OFFto-network,-gps for thetransformation to a
low-levelautomation.Finally,wecanimplementtheruleonagiven
AndroiddeviceviatheAndroidDebugBridgeandthetranslated
value.
Our work on Android just started, and there are many open
questions:HowcouldbethesyntaxofanAndroiddefinitionfile?
How can we automatically create such a definition file? Which
settingscanweautomaticallyset,e.g.,viatheDebugBridge,and
which settings cannot be set or only if we have rooted the device?
HowcanwehandledifferentAndroidversionsandthefactthatwe
canautomaticallyconfigureasettingin oneversion,e.g., viathe
Debug Bridge, and in another version, it is no longer possible?
For the automated implementation of general Linux guides,
please have a look at Listing 10; here, we have the implementation
of a rule of a Ubuntu guide. We can see that there is still a schema
of how the implementation is described. Nevertheless, it is morecomplicated. In this example, there are two different steps, oneconcerning the modification of a file, the other the execution of
shellcommands.Hence,inadditiontoextractingthecode-snippets,
wehavetoderivethesemanticsof setfilecontentto andrunaswell.
Ifwewantedto verifythatthecodesnippetsarevalid,wewould
havetoknowthesyntaxofthespecificconfigurationfileandthe
semantics,e.g.,if net.ipv6.conf.all.accept_ra=0 isacorrectlinein
thisfile.Furthermore,wewouldhavetoknowthelegalparameters
of the program called in the second snippet.Inourfutureresearch,wewilltrytoextractthisinformation,e.g.,
from the source code, the documentation, or sample configuration
filetocreatedefinitionfilesforthemostcommoncommandsand
configuration files. In summary, we think that our approach canbe ported from Windows to Linux-based systems, but whether a
comparably high percentage of rules from which automations can
be extracted can be reached remains to be seen.
In the future, work is necessary to provide the foundations that
make security automation easier. The main factor that made our
approachpossiblewasthatMicrosoftprovidesmachine-readable
information about configuration options for their systems in the
form of ADMX/L files. It follows that vendors should support secu-
rity automation by providing machine-readable information about
security-configuration options and their implementation.
5 RELATED WORK
Many studies have been conducted in the field of misconfiguration,
e.g. [5,6,8,31,38]. Especially the study of Dietrich et al. [ 6]i s
relevant for our research. Their study provides strong evidencethat security misconfigurations are more common than usually
assumed. This emphasizes how important and yet underestimated
thisfieldofresearchcurrentlyis.Furthermore,theyhaveidentified
thelackofknowledgeandexperienceascorefactorsforsecurity
misconfiguration and arguethat we need moreautomation in the
whole process to make systems more secure. By using security-
configuration guides, we want to tackle the first problem, with our
automated implementation the second.
Additionally, many researchers explored how to detect and how
to avoid misconfigurations[ 10,21,24,29]. Rahman etal. [ 21] ana-
lyzed thousands of Infrastructure-as-a-Code (IaaC) scripts to iden-
tifyinsecureconfigurationsandsecuritysmells.Theyusedthese
smellstocreatealinterforcreatingmoresecureIaaCscripts.Al-
though their linter is comparable to the hints we give to the ad-
ministrators,wearetargetingdifferentproblems.Wheretheyare
extractingknowledgefromtheIaaCscriptsonhowtoconfiguresys-
tems securely, we already have this information and have to apply
it. Furthermore, as discussed before, we think that IaaC scripts are
notsufficienttospecifysecurity-configurationguides.Similarwork
was done by Santolucito et al. [ 24]. Their framework ConfigVaims
atsimilarproblemsasourverificationstep.Incontrasttothem,we
cannot learn secure configurations. Instead, these are defined in
theguides,andtheconstraintsdonothavetobelearnedbutcan
be extracted from the ADMX/L files. Similarly, SPEX, developed by
Xu et al. [ 37] is not applicable in our case, as we do not have the
source code of the programs we want to configure.
Raabetal.[ 17–19]createdthe Elektraframeworktovalidatethe
accesstoconfigurationvaluestodetectmisconfigurationsassoonaspossible.Wetriedtoachievethesamewithoura-prioriverification
process. In their study [ 19], they investigated how free/libre and
open-source software (FLOSS) can be configured and the problem
of validating configurations for it. One finding is that presently,
configuration validation is encoded in a way unusable for external
validationorintrospectiontools.AlthoughWindowsisnotaFLOSS,
weencounteredthesameproblem.Thisiswhywehadtoimplement
ourverificationmechanisminsteadofsimplyusinganexistingtool.Furthermore,Elektraistailoredtowardsdeveloperswhocreatenew
607software, not for administrators of existing software and it cannot
handle the Windows policy settings we have to change according
to the guides. Thus, we could not apply Elektra.
A similar approach to Elektra was developed by Xu et al. [ 36]
withthesameproblemssowecouldalsonotuse itinourcase.In
their study [ 35], they have shown how thegrowing complexity of
theconfigurationofsystemsisoverwhelmingusersandsystems
administrators. They did not investigate Windows systems, yet
manyoftheirfindingsapplytoourdomain,too.Forinstance,users
havetremendousdifficultiesbecausetheydonotknowwhichpa-
rameterstosetandthatthisinducesupto50%oftheconfiguration
errors.Thissupportstheclaimthatweneedsecurity-configuration
guides created by experts, to be used by system administrators.
Wang et al. [ 33] present an approach at automatic reverse engi-
neeringofanapplication’saccess-controlconfigurations.Althoughtheapplicationdomainissimilartoourcontext,wecouldnotapply
theirworkforourneedaswedonothavethesourcecodeofthe
programs we want to configure securely.
Therealsoisalotofresearchinthefieldofextractingimportant
parameters or configuration values from human-readable docu-ments [
9,15,20,25,30,34,39,41]. Yang et al. [ 39] present an
approach to automatically extract web API specifications from the
documentationofasoftwaresimilartotheextractionofourconfig-urationvaluesfromthesecurity-configurationguidelines.However,
the fact that our documents do not contain as many links made
thisapproachunfeasibleinourcase.UsingNLP,Wongetal.[ 34]
developedanapproachatextractinginformationfromprogramdoc-umentationtoimproveautomatedtesting.Theyusegrammarrulestoidentifyrelevantcommentsandextractconstraintsfromthem.In
our case, the security-configuration guides describe concepts from
ahigherlevelthenprogramdocumentation.Furthermore,wedo
not need to extract the constraints from the security-configuration
guide. Thus, this approach was also not applicable in our context.
Closest to our work regarding our aims of providing rule-by-
rule implementation is the OpenScap project [ 16,22]. OpenScap
maintainsits security-configurationguides forvarious Linuxsys-
tems in a git repository, where each rule is represented by one file;
usually,thefileholdsreferencestootherfilescontainingartifacts
for automated implementation and check. However, we cannot use
OpenScap. First, OpenScap cannot implement the rules from the
Windows-basedguides.Second,ifOpenScapcouldimplementthem,
we would first have to add the scripts manually to the guides of
CIS or DISA. We think that the guides in the context of OpenScap
areonestepaheadofWindowsguidespublishedbyCISorDISA
becauseoftheconnectionbetweenimplementationandchecking.
Inthefuture,wehopethatthepublishersdistributetheirWindows
guides similarly to OpenScap in a form that is as easily imple-
mentable as checkable. We consider our approach an intermediate
solution to bring the automatic implementation of Windows-based
guides to a comparable level as long as this is not the case.
Ongoing activities regarding further improvements of automat-
ing security as carried out by the IETF SACM (Security Automation
andContinuousMonitoring )workgroup[ 2,3,14]aswellasafirstin-
dicationofthedirectionworktowardsSCAPversion2asoutlinedinatransitiondocument[
32],haveaclearfocusoncheckingsecurity-
configuration settings and disregard their implementation—which
is precisely the gap we want to close in this work.Tosumuptherelatedwork:someapproachesuseNLPtoextract
settingsfromthe documentation orthesourcecodeofa program,
but to our best knowledge, no approach extracted the settings
fromsecurity-configurationguides.Furthermore,someapproaches
like Elektra help to improve the configuration of newly developed
software, but we cannot use them to configure existing and closed-
source Windows systems. We can automatically implement the
guidesofsomeLinuxvariantswiththeOpenScapapproachifthe
publishers distribute them with the scripts necessary for Open-Scap. However, we cannot use OpenScap to implement existing
Windows-based guides automatically. Thus, we tackled these gaps
in the literature and put the developed components together to
demonstrate that our proposed approach and our PoC implementa-
tion are achieving promising results.
6 CONCLUSION
Thecomplexityofcontemporarysystemsrenderstheirconfigura-
tionincreasinglydifficult.Thisleadstovulnerabilitiesattackerscanexploittoattackthesystems.Forasingleorganization,itisimpossi-ble to know all the configurations to make a specific system secure.
Many organizations use public security-configuration guides to
overcomethelackofknowledge;whilemanyoftheseguidessup-
port automated compliance checking, they do not provide support
for automated implementation.
Inthispaper,wedemonstratedanapproachthatcanautomati-
cally implement Windows security-configuration guides with min-
imal manual effort. Our contribution further encompasses a proof-
of-conceptimplementation,astep-by-stepdocumentationofthe
process, and the evaluation of our approach using existing guides.
Ourevaluationhasshownthatwecanautomate83%oftherules
without any manual effort using our NLP extraction. Furthermore,
our extensive benchmark with 12 different guides and over 2014rules with automatic checks showed that the implementation of
our approach can implement at least 97% of the rules correctly.
Withourapproach andtheresultsofits evaluation,webelieve
we can furthermore contribute as follows: Firstly, we have demon-
strated howorganizations thatrely onpublicly availablesecurity-
configuration guides can be aided in reducing effort as well asreducing errors in the implementation of these guides. Secondly,
we have shown how machine-readable information supporting au-
tomated implementation for Windows systems can be represented
and included in SCAP guides. We hope that our results encourage
publishersofsecurityguidestosupportbettertheautomatedimple-mentationoftheirguidesbyenrichingthemwithsuchinformation,
for Windows as well for other target systems. The design of SCAP
v2 has already started [ 32]: Our work offers timely and relevant
input for the further development of SCAP towards a standard
thatmeetstherequirementsofbothpublishersandconsumersof
machine-readable security-configuration guides.
Thirdly, our research underlines the need for machine-readable
specificationsof(security)configurationsettings:standardization
and support of a format for this purpose by vendors would sig-nificantly aide in all tasks concerned with configuring systems
securely.
We plan to release substantial parts of our Python code-base.
608REFERENCES
[1]StevenBird,EwanKlein,andEdwardLoper.2009. Naturallanguageprocessing
withPython:analyzingtextwiththenaturallanguagetoolkit. "O’ReillyMedia,
Inc.".
[2]Henk Birkholz, Jarrett Lu, John Strassner, Nancy Cam-Winget, and Adam W.
Montville. 2018. Security Automation and Continuous Monitoring (SACM) Ter-
minology. Internet-Draftdraft-ietf-sacm-terminology-16.InternetEngineering
TaskForce. https://datatracker.ietf.org/doc/html/draft-ietf-sacm-terminology-16
Work in Progress.
[3]NancyCam-WingetandLisaLorenzin.2017. SecurityAutomationandContin-
uous Monitoring (SACM) Requirements. RFC 8248. https://doi.org/10.17487/
RFC8248
[4]CIS. 2019. CIS-CAT Pro. https://www.cisecurity.org/cybersecurity-tools/cis-cat-
pro/
[5]AndreaContinella,MarioPolino,MarcelloPogliani,andStefanoZanero.2018.
There’s a Hole in That Bucket!: A Large-scale Analysis of Misconfigured S3
Buckets.In Proceedingsofthe34thAnnualComputerSecurityApplicationsCon-
ference(San Juan, PR, USA) (ACSAC ’18). ACM, New York, NY, USA, 702–711.
https://doi.org/10.1145/3274694.3274736
[6]Constanze Dietrich, Katharina Krombholz, Kevin Borgolte, and Tobias Fiebig.
2018. InvestigatingSystemOperators’PerspectiveonSecurityMisconfigurations.InProceedingsofthe2018ACMSIGSACConferenceonComputerandCommunica-
tionsSecurity (Toronto,Canada) (CCS’18).ACM,NewYork,NY,USA,1272–1289.
https://doi.org/10.1145/3243734.3243794
[7]DISA.2019. DISAMicrosoftWindowsServer2016STIGBenchmark. Available
from https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_MS_Windows_
Server_2016_V1R13_STIG_SCAP_1-2_Benchmark.zip. Accessed: 2019-01-22, we
used the version 7, current version is 13.
[8]A. K. Jha, S. Lee, and W. J. Lee. 2017. Developer Mistakes in Writing Android
Manifests:AnEmpiricalStudyofConfigurationErrors.In 2017IEEE/ACM14th
International Conference on Mining Software Repositories (MSR). 25–36. https:
//doi.org/10.1109/MSR.2017.41
[9]Dongpu Jin, Myra B. Cohen, Xiao Qu, and Brian Robinson. 2014. PrefFinder:
GettingtheRightPreferenceinConfigurableSoftwareSystems.In Proceedingsof
the 29thACM/IEEE InternationalConference onAutomated SoftwareEngineering
(Vasteras,Sweden) (ASE’14).ACM,NewYork,NY,USA,151–162. https://doi.
org/10.1145/2642937.2643009
[10]L. Keller, P. Upadhyaya, and G. Candea. 2008. ConfErr: A tool for assessing
resiliencetohumanconfigurationerrors.In 2008IEEEInternationalConference
on Dependable Systems and Networks With FTCS and DCC (DSN). 157–166. https:
//doi.org/10.1109/DSN.2008.4630084
[11]Vladimir I Levenshtein. 1966. Binary codes capable of correcting deletions,
insertions, and reversals. In Soviet physics doklady, Vol. 10. 707–710.
[12]Microsoft Corporation. 2016. Local Group Policy Object Utility. https://www.
microsoft.com/en-us/download/details.aspx?id=55319 Accessed: 2019-01-18.
[13]Microsoft Corporation. 2017. Security policy settings. https:
//docs.microsoft.com/en-us/windows/security/threat-protection/security-
policy-settings/security-policy-settings
[14]Adam W. Montville and Bill Munyan. 2018. Security Automation and Continuous
Monitoring (SACM) Architecture. Internet-Draft draft-ietf-sacm-arch-00. Internet
EngineeringTaskForce. https://datatracker.ietf.org/doc/html/draft-ietf-sacm-
arch-00 Work in Progress.
[15]Rahul Pandita, Xusheng Xiao, Hao Zhong, Tao Xie, Stephen Oney, and AmitParadkar. 2012. Inferring Method Specifications from Natural Language APIDescriptions. In Proceedings of the 34th International Conference on Software
Engineering (Zurich, Switzerland) (ICSE ’12). IEEE Press, Piscataway, NJ, USA,
815–825. http://dl.acm.org/citation.cfm?id=2337223.2337319
[16]Martin Preisler and Marek Haicman. 2018. Security Automation for Contain-ers and VMs with OpenSCAP. In USENIX LISA . Washington. Available from
https://martin.preisler.me/...
[17]Markus Raab. 2015. Safe Management of Software Configuration. In Proceedings
of the CAiSE’2015 Doctoral Consortium at the 27th International Conference on
AdvancedInformationSystemsEngineering(CAiSE2015),Stockholm,Sweden,June
11-12, 2015. 74–82. http://ceur-ws.org/Vol-1415/CAISE2015DC09.pdf
[18]Markus Raab. 2016. Improving system integration using a modular configu-ration specification language. In Companion Proceedings of the 15th Interna-
tional Conference on Modularity, Málaga, Spain, March 14 - 18, 2016. 152–157.
https://doi.org/10.1145/2892664.2892691
[19]MarkusRaabandGergöBarany.2017. ChallengesinValidatingFLOSSConfig-
uration. In Open Source Systems: Towards Robust Practices - 13th IFIP WG 2.13
International Conference, OSS 2017, Buenos Aires, Argentina, May 22-23, 2017,
Proceedings. 101–114. https://doi.org/10.1007/978-3-319-57735-7_11
[20]A. Rabkin and R. Katz. 2011. Static extraction of program configuration options.
In2011 33rd International Conference on Software Engineering (ICSE). 131–140.
https://doi.org/10.1145/1985793.1985812
[21]AkondRahman,ChrisParnin,andLaurieWilliams.2019.TheSevenSins:Security
Smells in Infrastructure As Code Scripts. In Proceedings of the 41st InternationalConference on Software Engineering (Montreal, Quebec, Canada) (ICSE ’19). IEEE
Press, Piscataway, NJ, USA, 164–175. https://doi.org/10.1109/ICSE.2019.00033
[22]Red Hat, Inc. 2010. OpenSCAP. https://www.open-scap.org. Accessed: 2018-12-
18.
[23]SaltStack, Inc. 2011. SaltStack. https://github.com/saltstack/salt Accessed:
2019-01-07.
[24]MarkSantolucito,EnnanZhai,RahulDhodapkar,AaronShim,andRuzicaPiskac.
2017. Synthesizing Configuration File Specifications with Association Rule
Learning. Proc. ACM Program. Lang. 1, OOPSLA, Article 64 (Oct. 2017), 20 pages.
https://doi.org/10.1145/3133888
[25]M. Sayagh and A. E. Hassan. 2020. ConfigMiner: Identifying the AppropriateConfiguration Options for Config-related User Questions by Mining Online
Forums.IEEE Transactions on Software Engineering (2020), 1–1. https://doi.org/
10.1109/TSE.2020.2973997
[26]Patrick Stöckle, Bernd Grobauer, and Alexander Pretschner. 2020.Repository to demonstrate the steps of the automated hardeningprocess. https://github.com/tum-i22/disa-windows-server-2016
swh:1:dir:c3803619f51702199b19405547e2be2f2f55bdd2.
[27]Patrick Stöckle, Bernd Grobauer, and Alexander Pretschner. 2020. Repos-
itory with the check results for CIS guides before and after implement-ing the guides. https://github.com/tum-i22/CIS-Benchmark-Evaluation
swh:1:dir:b5c15f48b2c288f58533c9354bea3703ffbbb0dd.
[28]Patrick Stöckle, Bernd Grobauer, and Alexander Pretschner. 2020.Updated version of the step repository with Windows Server2019. https://github.com/tum-i22/disa-windows-server-2019
swh:1:dir:13ffd9d2566c64afdedd414336a95a35605392d7.
[29]Ya-Yunn Su, Mona Attariyan, and Jason Flinn. 2007. AutoBash: Improving Con-
figurationManagementwithOperatingSystemCausalityAnalysis. SIGOPSOper.
Syst. Rev. 41, 6 (Oct. 2007), 237–250. https://doi.org/10.1145/1323293.1294284
[30]Lin Tan, Ding Yuan, Gopal Krishna, and Yuanyuan Zhou. 2007. /*Icomment:Bugs or Bad Comments?*/. SIGOPS Oper. Syst. Rev. 41, 6 (Oct. 2007), 145–158.
https://doi.org/10.1145/1323293.1294276
[31]Chunqiang Tang, Thawan Kooburat, Pradeep Venkatachalam, Akshay Chander,
ZheWen,AravindNarayanan,PatrickDowell,andRobertKarl.2015. Holistic
ConfigurationManagementatFacebook.In Proceedingsofthe25thSymposium
on Operating Systems Principles (Monterey, California) (SOSP ’15). ACM, New
York, NY, USA, 328–343. https://doi.org/10.1145/2815400.2815401
[32]David Waltermire and Jessica Fitzgerald-McKay. 2018. Transitioning to the Se-
curity Content Automation Protocol (SCAP) Version 2. Technical Report. NIST.
Available from https://csrc.nist.gov/publications/detail/white-paper/2018/09/10/
transitioning-to-scap-version-2/final.
[33]Rui Wang, XiaoFeng Wang, Kehuan Zhang, and Zhuowei Li. 2008. Towards
Automatic Reverse Engineering of Software Security Configurations. In Pro-
ceedings of the 15th ACM Conference on Computer and Communications Secu-
rity(Alexandria,Virginia,USA) (CCS’08).ACM,NewYork,NY,USA,245–256.
https://doi.org/10.1145/1455770.1455802
[34]Edmund Wong, Lei Zhang, Song Wang, Taiyue Liu, and Lin Tan. 2015. DASE:
Document-assisted Symbolic Execution for Improving Automated Software Test-
ing. InProceedings of the 37th International Conference on Software Engineering -
Volume1 (Florence,Italy) (ICSE’15).IEEEPress,Piscataway,NJ,USA,620–631.
http://dl.acm.org/citation.cfm?id=2818754.2818831
[35]TianyinXu,LongJin,XuepengFan,YuanyuanZhou,ShankarPasupathy,and
Rukma Talwadker. 2015. Hey, You Have Given Me Too Many Knobs!: Under-standing and Dealing with Over-designed Configuration in System Software.InProceedings of the 2015 10th Joint Meeting on Foundations of Software Engi-
neering(Bergamo, Italy) (ESEC/FSE 2015). ACM, New York, NY, USA, 307–319.
https://doi.org/10.1145/2786805.2786852
[36]Tianyin Xu, Xinxin Jin, Peng Huang, Yuanyuan Zhou, Shan Lu, Long Jin, andShankar Pasupathy. 2016. Early Detection of Configuration Errors to ReduceFailure Damage. In 12th USENIX Symposium on Operating Systems Design and
Implementation (OSDI 16). USENIX Association, Savannah, GA, 619–634. https:
//www.usenix.org/conference/osdi16/technical-sessions/presentation/xu
[37]TianyinXu,JiaqiZhang,PengHuang,JingZheng,TianweiSheng,DingYuan,
Yuanyuan Zhou, and Shankar Pasupathy. 2013. Do Not Blame Users for Miscon-
figurations.In ProceedingsoftheTwenty-FourthACMSymposiumonOperating
SystemsPrinciples (Farminton,Pennsylvania) (SOSP’13).ACM,NewYork,NY,
USA, 244–259. https://doi.org/10.1145/2517349.2522727
[38]TianyinXuandYuanyuanZhou.2015. SystemsApproachestoTacklingConfigu-rationErrors:ASurvey. ACMComput.Surv. 47,4,Article70(July2015),41pages.
https://doi.org/10.1145/2791577
[39]J. Yang, E. Wittern, A. T. T. Ying, J. Dolby, and L. Tan. 2018. Towards Extracting
WebAPISpecificationsfromDocumentation.In 2018IEEE/ACM15thInternational
Conference on Mining Software Repositories (MSR). 454–464.
[40]ZuoningYin,XiaoMa,JingZheng,YuanyuanZhou,LakshmiN.Bairavasundaram,
andShankarPasupathy.2011. AnEmpiricalStudyonConfigurationErrorsin
Commercial and Open Source Systems. In Proceedings of the Twenty-Third ACM
Symposium on Operating Systems Principles (Cascais, Portugal) (SOSP ’11). ACM,
New York, NY, USA, 159–172. https://doi.org/10.1145/2043556.2043572
609[41]Hao Zhong, Lu Zhang, Tao Xie, and Hong Mei. 2011. Inferring specifications
for resources from natural language API documentation. Automated Software
Engineering 18,3(01Dec2011),227–261. https://doi.org/10.1007/s10515-011-
0082-3
610