Rotten Apples Spoil the Bunch: An Anatomy of Google Play
Malware
Michael Cao‚àó
Univ. of British Columbia, Canada
michaelcao@ece.ubc.caKhaled Ahmed‚àó
Univ. of British Columbia, Canada
khaledea@ece.ubc.caJulia Rubin
Univ. of British Columbia, Canada
mjulia@ece.ubc.ca
ABSTRACT
This paper provides an in-depth analysis of Android malware that
bypassedthestrictestdefensesoftheGooglePlayapplicationstore
and penetratedthe official Android marketbetween January 2016
and July 2021. We systematically identified 1,238 such malicious
applications, grouped them into 134 families, and manually ana-
lyzedoneapplicationfrom105distinctfamilies.Duringourmanual
analysis, we identified malicious payloads the applications exe-
cute,conditionsguardingexecutionofthepayloads,hidingtech-
niques applications employ to evade detection by the user, and
other implementation-level properties relevant for automated mal-
waredetection.Asmostapplicationsinourdatasetcontainmultiple
payloads,eachtriggeredviaitsowncomplexactivationlogic,we
alsocontributeagraph-basedrepresentationshowingactivation
pathsforallapplicationpayloadsinformofacontrol-anddata-flowgraph.Furthermore,wediscussthecapabilitiesofexistingmalware
detectiontools,putthemincontextofthepropertiesobservedin
the analyzed malware, and identify gaps and future research direc-
tions.Webelievethatourdetailedanalysisoftherecent,evasive
malware will be of interest to researchers and practitioners and
will help further improve malware detection tools.
CCS CONCEPTS
‚Ä¢Softwareanditsengineering ‚ÜíSoftwaretestinganddebug-
ging;‚Ä¢Security and privacy ‚ÜíSoftware reverse engineering;
Software security engineering.
KEYWORDS
Android, malware, dataset, malware detection, manual analysis
ACM Reference Format:
MichaelCao,KhaledAhmed,andJuliaRubin.2022.RottenApplesSpoilthe
Bunch: An Anatomy of Google Play Malware. In 44th International Confer-
enceonSoftwareEngineering(ICSE‚Äô22),May21‚Äì29,2022,Pittsburgh,PA,USA.
ACM,NewYork,NY,USA,13pages.https://doi.org/10.1145/3510003.3510161
1 INTRODUCTION
The popularity of mobile phones has increased rapidly in the past
decade.Togetherwiththeincreasedpopularity,theirwideadoption
‚àóEqual contribution
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthe firstpage.Copyrights forcomponentsof thisworkowned byothersthan the
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/or a fee. Request permissions from permissions@acm.org.
ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
¬© 2022 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-9221-1/22/05...$15.00
https://doi.org/10.1145/3510003.3510161greatlystimulatedthegrowthofmobilemalware.Understanding
thecharacteristicsofsuchmalwareisanimportantsteptowards
building effective malware detection tools.
While a number of Android malware datasets were collected in
recentyears,e.g.,[ 30,32,36,61,65,93,97,108],onlyafewauthors
performedadetailedmanualanalysistoidentifyanddescribethe
mechanisms employed by malicious applications (a.k.a. apps). The
mostprominentoftheseworksaretheMalwareGenome[ 108]and
AMD [97] projects. In the former, the authors collected and manu-
allyanalyzed1,260Androidmalwareappsfromofficialandalterna-
tive markets, focusing on identifying payloads, installation mecha-
nisms, and activation conditions for malicious behavior. Later, the
authors of AMD performed a similar manual analysis on 405 apps
from 135 distinct malware families. These two annotated datasets,
collectively,coverthetimeperiodbetween2010and2016.Yet,to
thebestofourknowledge,nosuchdetailedanalysiswasconducted
since then for newer malware apps.
To address this gap, we collect and manually analyze a set of
difficult to detect malware apps that penetrated the official An-
droid Google Play store between January2016 and July 2021.The
GooglePlaystorearguablyhasthemostadvanceddefensesforAn-droidapps,consideringthelowamountofmalwarethatitcontains
compared with alternative markets [ 24,109]. We thus believe that
analyzing the mechanisms which allowed this malware to avoid
detectionbythestoreisavaluabledirectionwhichwillhelpfurther
improve both academic and industrial malware detection tools.
Tocollectmalwareapps,wesystematicallyanalyzedthreatre-
ports of the 19 most prominent mobile security companies accord-
ingtoGartner[ 53],identifyingreportsthatdescribemalwarewhich
penetratedtheGooglePlayappstoreduringourtargetdates.We
identified1,238apps,groupedtheminto134families,andanalyzedoneappperfamilyfrom105distinctfamilies;wecouldnotanalyze
appsfromtheremainingfamiliesduetoobfuscation,encryption,
etc. We refer to the collected dataset as Google Play (GP) malware.
Our malware analysis focused on collecting detailed informa-
tion aboutmalware implementationstrategies andmechanisms it
uses to avoid detection. In addition, as malware often has multiple
payloads,eachtriggeredunder(potentiallymultiple)complexac-
tivation conditions, e.g., that rely on combination of sensor data
andrandomevents,wedefineda flow-basedmalwaresignature :a
graph-based representation showing activation paths and payloads
for an app in a form of a control- and data-flow graph. We thenmanuallygeneratedflow-basedsignaturesfortheanalyzedapps.
We believe such signatures are useful to gain a proper understand-
ing of malicious behaviors, which is required for building effective
detectiontools,e.g.,thosebasedondynamicanalysis[ 75,90,98]
or static execution-path exploration [101, 102].
Topresentourfindings,weorganizemalwareanalysisresults
around two main research questions:
19192022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA Michael Cao, Khaled Ahmed, and Julia Rubin
RQ1 (Malware Characteristics): What are the characteristics of
the GP malware and how does it compare with prior findings?
RQ2(MalwareFlowBehaviors):Howcomplexarethecontrol-
and data-flow behaviors implemented by the GP malware?
We then discuss our malware analysis results w.r.t. the capabili-
ties of existing malware detection tools and identify possible gaps
and future research directions.
Ouranalysisidentifiesnewpayloadsnotdiscussedinpriorwork,
such asclipboard hijacking and cryptomining.Interestingly, some
ofthesepayloadsdonotrelyonanyplatform-specificAPIs,typi-
cally used as an ‚Äúanchor‚Äù by many malware detection approaches.
Forexample,cryptominingcanbeperformedbyusingsimplemath-
ematical operations only. We also identify new malware activation
conditions,e.g.,checkingfordevicetemperature(todecidewhenit
isappropriatetominecryptocurrency),andsophisticatedcombi-
nations of multiple events and conditions required for a payload
to execute, e.g., sensitive information is retrieved when a phone
callisreceived,storedinafile,andthenreleasedonacompletely
different event, e.g., when another app is installed. Triggering asubset of these events, or even all events but in a different order,
willpreventdynamicanalysistoolsfromdetectingthemalicious
behavior. Finally, our analysis shows that some payloads spawn
bytecode,JavaScript,andnativecode,e.g.,obtaindatainaWebView
while leaking it via an Android Java API. Existing tools need to be
augmented to track such cross-technology patterns.
Contributions. Our work identifies characteristics and precise
flow-based signatures of contemporary malware. It can be usedto inform software engineering and security communities who
develop efficient malware detection tools and also as a benchmarkfor evaluating such tools. More specifically, this paper contributes:
1. A systematically collected set of 1,238 Android malware apps
from 134 distinct malware families, which bypassed GooglePlaydefenses between January 2016 and July 2021. To the best of our
knowledge, this is the first confirmed dataset of such malware.
2.Detailedreportsfromthemanualanalysisofonesamplefrom
each of the 105 distinct families, as well as aggregated findings and
a comparison of malware characteristics with those from earlier
years [97, 108], to identify new and obsolete practices (Section 3).
3. Flow-based signatures for each analyzed malware sample,
whichinclude per-flowconditionsthat guard eachpayloadand the
location/language of each flow element (Section 4).
4.Acategorizationandanalysisofexistingmalwaredetection
toolcapabilities,andadiscussionongapsandfutureresearchdi-
rections in context of our collected malware dataset (Section 5).
Data Availability. We responsibly share the collected dataset and
our analysis results in an online appendix [ 35]; the latest citable
release can also be found online [34].
2 METHODOLOGY
In this section, we describe our methods for building the dataset
and analyzing the malicious samples.
2.1 Building the Dataset
Typically,malwareappsarecollectedbyeitherbrowsingblogsof
securitycompanies [97,108]or byscreeningapps foundinpublic
repositories [ 93]. Such screening relies on antivirus scanners, e.g.,6,112 security blog posts
Post Categories #
Google Play Malware 314
Alternative Markets Malware 356
Non -Android Malware 1,304
Technology/News/Promotions 4,138Posts w. Malware 
Indicators#
2016 29
2017 66
2018 41
2019 38
2020 16
2021 27
Total 217
Identified
Families#
2016 27
2017 59
2018 41
2019 34
2020 16
2021 7
Total 184Identified
Apps (Families)#
2016 89 (20)
2017 636 (47)
2018 301 (28)
2019 166 (21)
2020 35 (13)
2021 11 (5)
Total 1238 (134)Manually
Analyzed Samples#
2016 13
2017 34
2018 27
2019 17
2020 11
2021 3
Total 105Google Play 
Malware Posts#
2016 56
2017 96
2018 51
2019 48
2020 24
2021 39
Total 314
AV‚â•5
Figure 1: Malware collection process
from the VirusTotal [ 92] online service, which offers more than
70differentscanners. Inourwork,we chosetheformerapproach,
because blogs of security companies already provide useful (albeit
partial)informationaboutmalwarecharacteristics,whichcanassist
our manual analysis and help ensure the results are accurate.
Westartedfromalistof21securitycompaniesreportedonGart-
ner‚Äôs Magic Quadrant for Best Endpoint Security Platforms [ 53],
identifying, for each company, blog sites related to cyber-threatintelligence; we found such sites for 19 companies. For each site,
weextractedblogpostsdescribingAndroidGooglePlaymalware
using the following search terms: (‚ÄúAndroid‚Äù | ‚ÄúGoogle‚Äù | ‚ÄúPlay-
store‚Äù|‚ÄúPlay‚Äù|‚ÄúStore‚Äù)and(‚Äúmalware‚Äù|‚Äúmalicious‚Äù|‚Äúmalice‚Äù).We
limit our search to the time period between January 2016 and July
2021, as we are interested in augmenting the body of knowledge
collected in prior studies, which looked at earlier periods. To make
our search approach repeatable and reproducible, we implemented
anautomatedwebcrawler,whichisavailableonline,togetherwith
the full list of companies and their blogs sites [35].
RunningourcrawlerinJuly2021resultedin6,377blogposts,out
of which we discarded 265 where the main part of the text was not
writteninEnglish.Twoauthorsofthepaperthenindependently
read the remaining 6,112 posts and classified each post based onits content. We arrived at four categories of posts: Google PlayMalware, Alternative Markets Malware, Non-Android Malware,
andTechnology/News/Promotions.Thecategorizationlistswere
cross-validated and all disagreements (on 68 posts, 1.07%) wereresolved through a discussion with all authors of this paper. The
number of blog posts for each category is shown in our schematic
representation of the data collection process in Figure 1.
We further focused only on posts from the first category: 314
posts describing malware from the Google Play store. The distri-bution of Google Play malware blog posts per year is describedin Figure 1. For each post, we looked for indicators of apps de-
scribedinthepost:(1)filehash(SHA-1/SHA-256/MD5),whichis
auniqueidentifierofanapp,(2)apppackagename,whichisthename identifier of an application, and (3) author and app name,
whichistheinformationpresentedtotheusers.Wediscarded97
posts containing none of these indicators.
1920
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
Analyzing the remaining 217 posts, we observed that a post can
describe apps from one or more malware families, e.g., an ESET
post[42]describesthreefamilies:appsthatminecryptocurrency
afterapresetperiodoftime,appsthatphishforcryptocurrencycre-
dentials,andappsthatfakecryptocurrencyminingfunctionalityto
aggressively push ads onto the user. It is also possible that families
described by two different posts refer to malware from the same
family,i.e.,bypostsreferencingeachotherdirectlyordescribing
indicators pointing to the same apps. We identified 235 malware
familiesintotal,outofwhich51wereduplicates,resultingin184
uniquefamilies.Blogpostsprovidedthenamesforfamiliesinama-jorityofcases(95%).Fortheremainingcases,weusedAVClass[
79]
andassignednamesbasedonAVClasslabels.Thedistributionofposts with malware indicators and malware families per year is
given in Figure 1.
Next, we collected apps for each of the identified families by
scanning the VirusTotal Academic [ 92], Virus Share [ 81], and Con-
tagio [70] malware repositories, Android alternative markets, such
asAPKMonk[ 28]andAPKPure[ 29],andAndroZoo[ 24]‚Äìapop-
ular repository with over 9.5 million Android apps from various
markets. Our assumption was that these repositories may still con-
tain the app even though it was already removed from the official
store. We prioritized apps found directly by the file hash. If we
couldnotfindsuchapps,wesearchedusingtheapppackagename,
app name, and author names, and prioritized apps having a file
hash identical to the one reported by the blog post. For cases when
thepostdidnotprovidethehash,weuploadedtheidentifiedapp
to VirusTotal and ensured the app was flagged as malicious by the
same antivirus company that published the blog post and in the
same family as reported in the post. If we could not verify the app,
we marked it as not found.
Attheendofthisprocess,wecollectedatotalof1294identifiable
appsfrom180blogposts.Wefurtherexcludeappsmarkedbyfewerthan5antivirustools,toensureourcollecteddatasetisreliable[
32].
This eliminated 56 apps (4%), resulting in a dataset of 1,238 from
134uniquefamilies.Thedistributionofretrievedappsperyearis
also given in Figure 1.
2.2 Analyzing Malware Samples
We first selected 20 malware families and one sample app per fam-
ily at random; two authors of this paper manually analyzed the
selected samples to arrive at a common, reliable, and reproducible
analysismethodology.Theanalysisreportswerediscussedandaug-
mentedbyallauthorsofthepaperinanumberofjointmeetings.
The remaining families were analyzed by the two authors individu-
ally while regularly validating each other‚Äôs findings. The summary
reports were discussed with all the authors and augmented, when
needed.
Similar to Wei et al. [ 97], we used both focused and exploratory
analysis of sample apps. In focused analysis, we read the blog post
toobtainahigh-leveldescriptionofthemalwareinplainhuman
language, noticing all malicious behaviors described in the post.
We then decompiled the app using JADX [ 83] to collect decoded
resources, Javasource code, and nativebinaries, and attemptedto
map the described behavior to Android implementation mecha-
nisms. For example, if the post stated that the malware ‚Äúsubscribesto premium numbers‚Äù, we looked for Android API calls to an-
droid.telephony.SmsManager::sendTextMessage() .Oncewelocated
the API in the app, we performed manual backwards reachabil-ity analysis to identify paths leading to the payload; we further
analyzed all components found along the execution path.
We complemented focused analysis with an exploratory anal-
ysistounderstandtheoverallworkflowoftheapplicationandto
find additional unexpected behaviors. We observed that malicious
payloadsareoftentriggeredinresponsetosystemevents,e.g.,boot
completed or phone unlocked, likely because malware developers
attempt to avoid detection by moving the payload execution away
from the app main execution path while still ensuring the payload
istriggered.Wethusthoroughlyexploredcodetriggeredbysystem
and user events, in addition to the app main launch activity.
Some malware apps utilize native code, web assets, and/or byte-
codeexecutablesfoundinapplicationresources.Wetreatedthese
files as an extension of the application code, analyzing them to-gether with the main code of the app. We used IDA disassem-
bler[76]toreverseengineernativebinariesandconvertmachine
codeto human-readableassembly code.We usedIntelliJ IDE[ 54],
which supports multiple programming languages, to perform addi-
tional analysis tasks, such as class hierarchy analysis.
Dealingwithanti-analysistechniques. Surprisingly,onlyless
than half of the malware in our dataset used renaming as an ob-
fuscation technique (i.e., producing package, method, and variable
names like a.aanda.b). While APIs of the Android framework
methods,suchasregisteringforaneventoropeninganHTTPcon-
nection,cannotbeobfuscated,obfuscationofapplication-specific
code complicates analysis. We used JADX‚Äôs built-in deobfuscation
functionality to map obfuscated names to more readable unique
identifiers, which simplified the analysis of the code.
Some of the malware apps used off-the-shelf and custom mecha-
nismstoencodeandlaterdecodeStringscomprisingreflectivecalls
and network addresses. We followed the logic implemented in the
source code of the apps and re-implemented the routine to decrypt
thedataoutsideoftheapplication.Inafewcases wherewecould
notfullyunderstandtheparticularroutine,weinstrumentedthe
application to print out the decrypted Strings.
Inaddition,severalappsusedAndroidpackers,whichencrypt
DEX files using ELF binaries [ 64] and decrypt them at runtime, to
increase the difficulty of reverse engineering the application [ 107].
In cases where malware apps used commercial packers, e.g., Ji-agu [
55] and Bangcle [ 99], we were able to decrypt DEX files of
these apps using Android Unpacker [85] and DrizzleDumper [38].
Furthermore, some apps used encryption/decryption mecha-
nisms toobfuscate Strings,asset files, andcode filesloaded fromlocal storage. In the majority of the cases, we could identify the
decryption key, which was simply stored in the APK file.
Dependence on external code/data. Several apps hide malicious
functionalityincodedownloadedfromexternalsources,e.g.,the
developer‚Äôsbackendservers.Oncethemalwareisdiscovered,Inter-
netServiceProvidersshutdownitsbackendserverpermanently.
As we could not access these servers and analyze the malicious
behavior of the downloaded code, we borrowed the descriptionof its payloads from the corresponding blog post. We explicitly
marked(with /star_empty)suchpayloads,todifferentiatethemfromthosewe
1921
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA Michael Cao, Khaled Ahmed, and Julia Rubin
System
User
SchedulingEvent Conditions (EC)
Device
Environment
ApplicationCheck Conditions (CC)
Hiding Techniques (H)
Payloads (P)
Code Properties (CP)Location
LanguageMalware 
CharacterizationExternal Server
Figure 2: Malware characterization schema
haveobservedindependently.For16apps,thedescriptionofallapp
payloads relied on the blog posts; in 24 additional cases, part of the
payloads wasobserved independentlyand partwas inferred from
posts.Foranother16cases,noadequatedescriptionofapayload
was given in the post and we marked it as unknown.
Analysis Report. Overall, we were able to successfully analyze
atleastoneappfrom105distinctmalwarefamilies.Weexcluded
fourfamilieswherewecouldnotidentifythemaliciousbehavior
described in the blog post, nine families whose apps used a com-
mercialpackerwecouldnotunpack,ninefamilieswhoseappswere
heavily obfuscated and we could not reliably analyze, five families
whoseappsreliedonreflectivecallswecouldnottrack,andtwo
familieswhoseappscontainedstrings thatwereencryptedwitha
customencryptionkeythatwasdynamicallydownloadedfromtheappbackendserverandwasnolongerfunctionalatthetimeofouranalysis. The detailed breakdown of the apps we analyzed per year
is given in Figure 1.
Attheendoftheanalysis,weproducedadetailedreportforeach
app,describing(a)appmeta-information,includingthefilehash,
blog URL, and a brief description of the malware‚Äôs behavior, (b)
therelevantsourcecoderelatedtotheexecutionpath(s) required
to activate the payload(s), (c) a tabular-form characterization ofthe malware app, as described in Section 3, and (d) a flow-based
signatureoftheapp,asdescribedinSection4.
3 MALWARE CHARACTERIZATION
We augment and refine malware categorization schemas used in
previouswork[ 97,108],proposingthecategorizationinFigure2.
In what follows, we first describe our schema using the example in
Figure3forillustrationpurposes.Wethenusethecategorization
to discuss the malware in our dataset.
3.1 Malware Characterization Schema
Figure 3 shows a simplified version of a malware app from the
SpyBankerHUfamily[ 41].Inanutshell,thismalwareintercepts
SMSmessagesandstealstheuser‚Äôsbankingcredentials.Itisacti-
vatedwhentheuserunlocksthephoneorreceivesanSMSmessage.
Both events are handled by the onReceive(...) method of the Un-
lockSMSRecver component (lines 3-32 in Figure 3). Using the Intent
parameter, the method checks whether an SMS was received (lines
4-22). If so, the method checks if the field stealSMS (the name that
wegavetothisvariableforillustrationpurposes)issetto true,to
determine whether the SMS stealing functionality is activated (line1class UnlockSMSRecver extends BroadcastReceiver {
2static boolean stealSms = false;
3void onReceive(Context ctx, Intent in) {
4if(in.getAction().contains("SMS_RECEIVED")){
5if(stealSms){
6ContentResolver cr = ctx.getContentResolver();
7SmsMessage sms = SmsMessage.createFromPdu(
8 in.getExtra().get("pdus")[0]);
9Cursor c = cr.query(Uri.parse("content://sms"),
10 new String[]{"_id", "body"});
11 while (c.moveToNext()) {
12 int id = c.getInt(0);
13 String body = c.getString(1);
14 if(body.equals(sms.getMessageBody())) {
15 cr.delete(Uri.parse("content://sms/"+id));
16 }
17 }
18 String device = context.getDeviceId();
19 Connection con = new URL("leaksms.com/?u="+
device).open();
20 con.write(sms);
21}
22}
23String device = context.getDeviceId();
24Connection con = new URL("commands.com/?u="+
device).open();
25String commands = con.read();
26if(commands.contains("steal_sms")){
27 stealSms = true;
28}
29String running = getRunningProcesses();
30if(running.contains("com.garanti.cepbank")) {
31 WebView.loadUrl("fakebank.com");
32}
33}}Figure 3: SpyBankerHU malware
5).ThemethodthenretrievesallSMSmessagesonthedevice(lines6-10)anditeratesoverthemtoidentifyanddeletethereceivedSMS
(lines 11-17). It further leaks the SMS content to the developer‚Äôs
server, together with the device id (lines 18-20). This is most likely
done to steal the one-time access passcode the bank might send to
the userand to hidefrom the usermessages which couldindicate
thatsomeoneelse(i.e.,themaliciousparty)ismanipulatingtheir
bank account.
Inanyevent‚ÄìwhetheranSMSisreceivedortheuserunlocks
theirphone,theappalsoattemptstocommunicatewiththecom-
mand and control server and to steal banking credentials (lines23-33). Specifically, the app retrieves the device id (line 23) and
contacts its server to retrieve a set of commands (lines 24-25). If it
receivesthe‚Äústeal_sms‚Äùcommand,theappsetsthefield stealSMS
totrue(lines 26-28), indicating that the user is going to be attacked
andenablingtheSMSleakingbehaviordescribedabove.Theapp
further checks if a process associated with the cepbank banking
application is running (lines 29-30) and, if so, loads an HTML page
that impersonates the login screen of the banking app (line 31). An
unsuspecting user will enter their banking login credentials on the
fake overlay, which sends the credentials to the malicious server.
Insummary,theappcontainsthreedifferentpayloads:itleaks
the device id when an SMS is received or the phone is unlocked
(lines18-20and23-24);itleaksthecontentanddeletesSMSmes-
sages when instructed by the server (lines 14-20); and it steals
banking credential when the cepbank application is running (lines
29-32). Each of the payloads is triggered under different conditions
1922
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
andactivation events,partof whichwe omittedforthe simplicity
of the presentation. We also omitted yet another payload: ad abuse,
as well as additional events that the app intercepts to trigger the
malicious behaviors, e.g., power change.
Toaccuratelydescribethebehaviorofsuchmalware,weusefive
categories specified in Figure 2:
1.EventConditions(EC) areeventsthatanappinterceptsandthat
triggertheactivationofamaliciouspath.Wefurtherdividethem
intoSystemevents,whicharetriggeredbytheAndroidsystemwhen
thedeviceisbooted,anSMSisreceived,etc.; Userevents,whichare
triggered by the app user, when logging in into the app, pressing a
particular button, copying text, etc.; and Scheduling events, which
are triggered at specific time intervals. Our SpyBankerHU sample
in Figure 3 intercepts SMS- and phone unlocking system events.
2.CheckConditions(CC) areconditionsthatneedtobesatisfied
for the malicious behavior to fire. These conditions can depend on
anExternalserver,e.g.,whenthemaliciouspayloadisexecutedonly
when a particular command is received from the app backend, like
in the SpyBankerHU sample in Figure 3. Further, check conditions
canbeDevice-dependent,i.e.,relyonacertainhardwareorsoftware
specification; Environment -dependent,e.g.,beexecutedatacertain
time or location; and Application -dependent, e.g., rely on a certain
permission granted to the application or on a certain data format.
3.HidingTechniques(H) areusedbytheapptohideitsmalicious
actions from the user. These include removing the app icon, so the
usercannotidentifyanduninstalltheapp,andblockinginformation,
such as deleting SMS messages in the SpyBankerHU sample.
4.Payloads(P) describethemainmaliciousfunctionalityoftheapp
itself. We identified a variety of payloads, including stealing of per-
sonal, device, and banking information, like in the SpyBankerHU
sample in Figure 3.
5.Code Properties (CP) are the code-level details describing how
these behaviors are implemented. We consider the Locationof the
code, e.g., being in the application directly, hidden in resources, or
downloadedfromaremoteserverandthe Language inwhichthe
maliciouscodeisimplemented,e.g.,bytecode,nativecode,oraweb-
based language(HTML/JavaScript). For the SpyBankerHU app in
Figure 3, the UnlockSMSRecver class is implemented directly in
bytecode,whilethefakeloginoverlayisimplementedinJavaScript
and is loaded from a remote server.
Next, we outline, for each of the categories, the implementation
strategiesthatmalwareinourdatasetemploys.Section4furtherde-
scribes our malware signature, which accurately relates the events,
conditions,hidingtechniques,andpayloadstoeachother,inaform
of a control- and data-flow graph.
3.2 Malware Characteristics
Figure 4 shows the specific behaviors we observed for each of the
categories in our schema. We mark with an arrow ( /arrow_right) categories
thatwereintroducedbasedoninformationobservedinourdataset,comparedwithpriorwork[
97,108].Wealsoprovidethenumberof
analyzed sample apps exhibiting each of the behaviors. As one app
can contain multiple (or no) event and check conditions, payloads,
etc.,itcanbecountedinmultiplecategories;thus,thenumberof
appsinacategorydoesnotsumupto105.Adetaileddescriptionof
each analyzed sampleapp is availablein our online appendix[ 35].Event conditions #% Hidingtechniques #%
System 8076.2 Richfunctionality 6561.9
Boot status 4441.9 Iconmanipulation 3432.4
Device status 3028.6 Device admin 1514.3
Network status 2624.8 Information blocking 1211.4
/arrow_rightDeveloper-defined 2624.8 /arrow_rightSelf-uninstallation 65.7
Packagechanges 2221.0 /arrow_rightAutomated gesture input 54.8
/arrow_rightService bind 1110.5 Screen locking 32.9
SMSdelivery 1110.5 (c)
Battery status 98.6
Callstatus 87.6 Payloads #%
USBstatus 11.0 Information stealing 6965.7
User 9590.5 Ad abuse 5451.4
Application launch 9287.6 Premium charges 109.5
/arrow_rightButtonclick 4643.8 /arrow_rightCryptomining 54.8
/arrow_rightSensitive input 2826.7 Root exploit 43.8
/arrow_rightPermissions 2523.8 /arrow_rightClipboard hijacking 32.9
/arrow_rightAppinstall 1514.3 /arrow_rightPortforwarding 32.9
/arrow_rightClipboard text 11.0 Ransom 11.0
Scheduling 5855.2 Unknown 1615.2
Scheduling 5855.2 (d)
(a)
Check conditions #% Code properties #%
Externalserver 7975.2 Location
Internet 7874.3 Direct 9792.4
SMS 21.9 /arrow_rightDownloaded (Remote) 6057.1
Device 8278.1 /arrow_rightHidden(Resources) 2523.8
Softwarespecs 6259.0 Language
Network 4341.0 Bytecode 10297.1
/arrow_rightHardware specs 2826.7 /arrow_rightWeb 2927.6
/arrow_rightSensors 43.8 Native 1110.5
Environment 4139.0 (e)
Time 3836.2
Location 65.7
Application 4240.0
Permissions 3129.5
Dataformat 109.5
/arrow_rightProbability 87.6 /arrow_rightindicates categories identified in our work
Version 11.0 compared with prior studies [97, 108]
(b)
Figure 4: Characteristics of Google Play malware
1.Event Conditions (Figure 4a) have three sub-categories:
System Events. Themajorityof theanalyzedsamplesaretriggered
by at least one Systemevent, most commonly when the phone
is booted or when the device status changes, e.g., from lockedtounlocked.Similarsystemeventsincludenetwork,battery,call
status,and SMSdelivery events.Webelieve malwareuses system
eventstoavoidexecutingthemaliciouspayloadonthe(easierto
trigger) main application launch while still ensuring the malicious
functionality is eventually triggered. Interestingly, most system
events we observed are less likely to happen on the emulator, e.g.,
lockstatuschange,whichfurthercomplicatesthedetectionofthese
apps at testing time.
Weobservedtwonewtypesofsystemeventsnotdiscussedin
earlier reports: Developer-defined are custom events not defined by
the Android platform. For example, Solid (ID: 94) is activated by
the reception of a Firebase message [ 50]. Considering such custom
event types could challenge dynamic-analysis-based tools. Service
bindevents, which allow the app to communicate with bound
services (e.g., accessibility), were described in the literature [ 47],
but we believe we are the first to observe them in practice. Forexample, SpyBankerAJZ (ID: 98) abuses the accessibility service,
whichhasaccesstouserinteractionswithotherapps,toactivate
itself when the user interacts with a banking app and overlays a
phishing browser to steal banking credentials.
User Events. While almost 90% of the samples activate a payload
oncetheuserlaunchestheapp,weidentifiedadditionaluserevents
1923
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA Michael Cao, Khaled Ahmed, and Julia Rubin
triggering malicious behavior, such as inputting specific data or
copying text(see Figure4a for details).For example,ClipperC(ID:
28) triggers when the user copies text and checks if the text is
formatted as a wallet address. If so, the app executes its payload.
Scheduling Events. Around half of the samples periodically repeat
themaliciousbehavior.Forexample,HidenAd(ID:67)schedules
analarmthatdisplaysfull-screenadsevery15minutes,evenwhile
the user is interacting with other apps.Comparison with earlier reports.
Ouranalysisidentifiedtwotypes
ofsystemevents,developer-definedandservicebind,notdiscussed
in earlier reports [ 97,108]. We also provided a more detailed char-
acterization of user events according to their types.
2.Check Conditions (Figure 4b) have four sub-categories:
External Server. Three quarters of the analyzed sample apps exe-
cute malicious payloads on receiving particular data from an ex-
ternal server ‚Äì either through the Internet or by an SMS (a.k.a.
command and control or C&C malware). Most frequently, the com-
mandsareretrievedovertheInternet.Intwocases,theappsreceive
anSMScommandtoenableinterceptingandleakingSMSmessages
and calling premium numbers, e.g., AceCard (ID: 1).
Device.Threequartersofthesamplesalsoconditionpayloadson
softwarespecsoftheunderlyingAndroidsystem,suchassystem
version and whichapps are installed. We identified several checks
notdescribedinearlierreports: hardwarespecifications,i.e.,CPU
and network operator, and sensordata, i.e., battery, temperature,
and motion. For example, Aladdin (ID: 8) checks that the device
contains more than 3 CPU cores before generating ad traffic to an
invisiblewebpage;Vilny(ID:108)checksthephonetemperature
and battery level before mining cryptocurrency, presumably to not
alarm the user by a sharp change of these parameters.Environment.
These checks, commonly known as time and logic
bombs, activate malicious payloads only at a certain timeand/or
location. For example, PletorD (ID: 80) checks the user‚Äôs location to
ensurethattheuserisnotfromRussiaorUkraine,beforelocking
the phone in silent mode and asking for a ransom.Application.
Application-specificchecksinclude permissions, data
format, and app version. For example, SMSAndroidOSWesp (ID: 91)
usesregularexpressionstocheckthatthereceivedSMScontains
a PIN, before leaking it to the malware developer‚Äôs server. More-
over, we identified a number of samples that decide whether to
activate the malicious payload probabilistically. For example, Hid-
denAdHRXH (ID: 64) uses the java.util.Random library to roll a
numberbetweenoneand100andautomaticallyclickonadsonly
if the obtained value is less than 25.
Comparison with earlier reports. Previous work reported condi-
tions based on commands retrieved from an external server, in-
stalled apps, time, and location. Our detailed categorization reveals
newchecks:hardwarespecifications,sensors,andrandomnumbers.
3.Hiding Techniques (Figure 4c). The most prominent technique
in our dataset is the inclusion of rich benign functionality, which is
employedbymorethanhalfofoursamples.Thisisdonetoconvince
the user that the app is legitimate, e.g., by presenting a weather
forecast(ID:99)orprovidingaYouTube-likevideointerface(ID:2).Unlikerepackaging,theseareuniqueappsandwearenotawareof
other reports that explicitly identified such behavior.Another frequent hiding technique is icon manipulation. In addi-
tiontothepreviouslyobservedcaseofhidingtheappicon,samples
inourdatasetalsochangetheicon,pretendingtobeanotherapp.
For example, Reputation1 (ID: 86) changes the icon and name to
resembleGoogleMaps.Moreover,whentheuserclicksontheicon,theapplicationredirectstoGoogleMaps.Meanwhile,itperiodically
pushes full-screen ads to the user without the user being aware of
the origin of these ads.
Obtaining device admin privileges can make the malware harder
toinstall.Itcanalsoallowthemalwaretoperformprivilegedop-
erations, such as changing the lock-screen password or locking
thescreen,tofurtherincreasethedifficultyofuninstallation.For
example, SpyBankerHU (ID: 99) locks the screen when the user
attempts to disable its admin privileges. Samples also employ infor-
mationblocking,i.e.,hidinginformationproducedbythepayload
from the user, and screen locking, to prevent the user from noticing
suspicious behaviors on the device.
We also observed a new hiding approach via self-uninstallation.
Forexample,BanBraA(ID:19)canreceivecommandsfromthemal-
waredeveloper‚Äôsservertouninstallitself.Thisconfusestheuser
aboutwhichappperformedthemaliciousbehaviorandreducesthe
chancesoftheappreceivingabadreview.Yetanothernewtech-
niqueisabusingaccessibilityservicestoperform automatedgesture
inputtopreventthe userfromperformingcertainactions.For ex-
ample,SpyBankerAJZ(ID:98)pressesthebackbuttonwhenever
the user opens an antivirus.Comparison with earlier reports.
Similar to Malware Genome and
AMD,weobservediconhiding,informationblocking,deviceadmin
privileges, and device screen locking hiding techniques. We also
observednewtrends:implementinglegitimatebenignfunctionality,
changing the app icon, self-uninstalling, and automated gesturing.
In addition, the AMD report described techniques which did not
occurinourdataset:cleaningsystemlogs,killingantiviruses,re-
moving the app from the device administrator list, and preventing
uninstallation of the app.
4.Payloads (Figure 4d) are divided into nine sub-categories:
Information Stealing. The most frequent payload in our dataset
isinformation stealing, e.g., of SMS, accounts, phone numbers,
contacts,andstoredfiles.Somemalwarealsoexplicitlytricksthe
user into entering sensitive information. For example, Reputation1
(ID: 86) presents a web page claiming that the user won a prize.
To‚Äúredeem‚Äùtheprize,thewebpageprovidesasurveythatsteals
sensitive information from the user.
Ad Abuse. Sampleswith adabusearealsofrequentinourdataset.
Weidentifiedthreeadabusepatterns:(a)Aggressiveadvertisement
forcesadvertisementswhentheuserperformsacertainactionor
periodically.Forexample,FraudApp(ID:51)actsasafakecryptocur-
rency miner while pushing full-screen ads. (b) Hidden ads loads
webpagesthatcontainadstogainadditionalrevenue.Forexample,
Aladdin (ID: 8) opens an invisible WebView to increase the number
ofvisitsto themaliciousdeveloper‚Äôswebsitethat containsads.(c)
Ad-clickfraudautomateclicksonads.Forexample,AdClickerBN
(ID: 2) retrieves a list of targeted websites and a JavaScript payload
from a C&C server and performs ad clicks.Premium Charge.
Appsalsoimpose premiumcharges ontheuser
bysubscribingthemtopremiumserviceswithoutuserconsent,e.g.,
1924
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
SMSAndroidOSWesp (ID: 90) and Sonyvpay (ID: 94). To perform
the subscription, the malicious app obtains up-to-date information
about the service, such as its subscription number, subscription
message,andsubscriptionaccount.Itthensendsarequesttothe
service over SMS, call, or internet. A confirmation message is sent
backtothedeviceoverSMSandisinterceptedandconfirmedby
the malware.
Cryptomining. Severalsamplescommence cryptocurrencymining
withouttheuser‚Äôsconsent,e.g.,CoinMinerQ(ID:30)andCPUMiner
(ID: 31).To performcryptomining, aminer receivesa hashpuzzle
and its result; they need to find the puzzle input value that leads
to the given result. The first miner to do so is rewarded with cryp-
tocurrency.Toincreasethechancesofgettingthemonetaryreward,
maliciousdevelopersleveragemobiledevicesofmanyunsuspectingusers,synchronizingbetweentheusersviaaconfigurationobtainedfromaremoteserver.Interestingly,whileminingcryptocurrencyis
a popular monetization tactic, earlier studies did not identify such
apps. This could be because of the sharp rise in bitcoin prices in
2017 [9], which falls outside of the date range of earlier reports.
Root Exploit. Malware exploits vulnerabilities in the Android op-
erating system togrant the app unrestricted access to the device‚Äôs
memoryspace.Rootexploitsaretypicallyperformedinnativecode,
as bytecode runs in a virtual machine that is isolated from the op-
erating system. To perform root exploits, the malware retrieves
native binaries stored locally or over the internet. It then executes
the binaries and performs unauthorized actions, such as silently
installingothermaliciousapps.Forexample,Godless(ID:53)exe-
cutesrootexploitsthendownloadsandinstallsanappwithsystem
privileges to perform additional payloads.Clipboard Hijacking.
Yet another technique not reported in pre-
vious studies is a clipboard hijacking attack, when the malware
changes the text clipboard so that the user pastes unintended text.
Forexample,theClipperCmalwaredescribedearlier(ID:28)uses
this mechanism to replace a wallet address copied by the user with
the malware developer‚Äôs wallet address.Port Forwarding.
Our samples also perform port forwarding, a spe-
cial form of information stealing where malware attempts to steal
data from the user‚Äôs internal network. To this end, malware cre-
atesanoutboundconnectiontothemaliciousdeveloper‚Äôsserver,
retrieves a target address and network command, forwards the net-
workcommand totheinternal networktocollect data,andrelays
the response back to the developer‚Äôs server. For example, Milky-
Door(ID:77)tunnelsusingSSHintotheuser‚Äôsinternalnetworkto
steal enterprise data.Ransom.
For monetization, some apps ask for a ransom, where
the malware encrypts data or disables device functionalities to
coercethevictimintopayingafee,e.g.,usingabitcointransaction,
to release device functionalities that are being held captive. For
example, PletorD (ID: 80) locks the device into silent mode and
opens aWebView to ask for a ransom to unlock it.
Unknown Payload. There are 16 samples in our dataset that down-
load code dynamically from a remote server. Such code might con-
tainmaliciousbehavior,addingtootherpayloadsweobservedin
these apps. As we could not confirm the malicious behavior of the
downloaded code, we mark these payloads with unknown.Comparison with earlier reports. Prior work did not report on the
cryptocurrencymining,clipboardhijacking,andportforwarding
payloads, which were observed in our datasets. The AMD studyreported the ad abuse payload, but did not elaborate on the dif-ferent types of ad abuse that we found in our study: aggressive
advertisement, hidden ads, and ad-click fraud.
5.CodeProperties (Figure4e)aredividedintotwosub-categories:
Location. Checkconditions,hidingtechniques,andpayloadscan
beimplemented directlyinthe APK.dexfile, downloaded(remote)
from a server, or hidden (resource), where the code is packed in the
app‚Äôsresources.Forexample,HiddadBZ(ID:61)hidesitspayloadina text font file, which is converted to APK and executed at runtime.
Interestingly,aroundhalfoftheanalyzedsamplesdownloadcode
fromathird-partyserver.Thesamplestypicallyuse DexClassLoader
to load the downloaded bytecode and invoke it via reflection. Two
samples, DroidPlugin (ID: 34) and AsiaHitGroup (ID: 15), abuse the
virtualinstallationtechnology[ 67],originallydesignedtoinstall
multiplecopiesofthesameapp,tosilentlyinstallmaliciousapps.
Other samples attempt to install the downloaded APKs directly,
using social engineering to convince the user to allow installation.
For example, AnubisDropper (ID: 12) claims that the system is out
of date and the user should install a secondary app to ‚Äúupdate‚Äù it.
Language. Checkconditions,hidingtechniques,andpayloadcan
also be implemented in different languages: Java bytecode, Web
(JavaScript),orin nativecode(C/C++).Wefoundthatwhilemostof
theanalyzedsamplesimplementthemaliciousfunctionalityinJava
bytecode,somemaliciousbehaviors,mostlyrelatedtoadabuse,are
implemented in JavaScript code loaded into WebViews . Finally, a
few samples also employ native code.
Comparison with earlier reports. Theanalysisperformedinearlier
work was more coarse-grained and only considered the location of
thepayload.Instead,ourworkmapseachofthemaliciousactivi-
ties‚Äìcheckconditions,hidingtechniques,andpayloads‚Äìbasedon
theircode/location.Thedetailedmapisinouronlineappendix[ 35].
To answer RQ1, we observed that a high fraction of the analyzed
samples implement information stealing and ad abuse. We alsoidentified new payloads: cryptomining, clipboard hijacking, and
portforwarding.Malwareshiftsitspayloadsoffthemainexecution
path and hides them under a number of difficult-to-trigger checks,
complicating the detection of these samples. Furthermore, samples
alsosplittheirmaliciouspathsacrossmultiplelanguages.Finally,
weobservedthatmalwareemploysnewhidingtechniques,suchas
self-uninstallation and automated gesturing.
4 FLOW-BASED MALWARE SIGNATURE
ThemalwarecategorizationinSection3providesinformationabout
event and check conditions, hiding mechanisms, and payloads em-
ployedbycurrentmalware;understandinghowtheseactionsare
combined together is an essential step towards building efficient
tools for detecting such malware. For the SpyBankerHU sample in
Figure3,presentingweb-basedcontentina WebView is,byitself,
alegitimateapplicationbehavior,common tomanybenignapps.However, this behavior is executed only when a certain app, i.e.,
cepbank, isinstalled on thedevice (lines29-32). Discovering such
contextualinformationcanhelpatechniquedeemthissamplemali-cious.Likewise,understandingtheinterplaybetweendeletingSMS
1925
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA Michael Cao, Khaled Ahmed, and Julia Rubin
	)#$ &")
	($" #"&"$"$
 "$   

 "$  #$
&
	)#$& #$$%#
&
 "$  #$
$"$
 $'" #!#
 $'" #!#
	#"#$& !%$
#$& !%$
 "$  #$)$ "$
 ' 
 !" !"$)" 
$ 
$"$"&
 $"  '
$ '"%
#
"%





	







 #"
Figure 5: Flow-based malware signature of SpyBankerHU
messagesandtheconditionreceivedfromtheserverwhichenables
thisbehavior(lines25-28and5-17)canhelpdistinguishbetween
benign apps that manage users‚Äô SMS messages and apps that have
amaliciousintent.Understandingthepreciseorderofeventsand
conditions that activate a malicious payload, as well as implemen-
tationmechanisms,suchasinformationflowsbetweenbytecode
and JavaScript code in WebViews, and code-level obfuscation tech-
niques, such as String manipulations and app- and phone-specific
contentmanagementcode(lines5-17inFigure3)isalsoessential
to build efficient techniques that can detect realistic malware.
To capture such contextual and path-level information, we man-
ually created a flow-based malware signature graph for each of the
analyzedsamples.Thesesignaturesgobeyondthecategorizationin
Section 3; they rather capture control- and data-flow dependencies
for paths related to each malicious behavior. They also capture
information about how each malicious component is implemented,
including implementation location and code language.
Figure5showsanexampleofsuchagraphfor SpyBankerHU.
The nodes of the graph are the four actions from the malware
categorization schema in Figure 2: Event Conditions (EC), Check
Conditions(CC), HidingTechniques(H),and Payload(P).Thesenodes
are shown as rectangles with the corresponding event type in their
names. We add one additional type of node, which we call data
retrieval (DR) ; it is shown as an ellipse in Figure 5. Each such node
corresponds to the action of retrieving data, e.g., from an SMS
message, the Internet, or user-sensitive input. The retrieved data is
used either in evaluating the check condition or in a payload.
Thegraphcontainstwotypesofedges:control-flow(dottedlines)
anddata-flow(solidlines).Similartothecontrol-anddata-flowcon-
ceptsfromtheprogramanalysisdomain[ 45],control-flowedgesin
ourgraphdescribetheorderinwhicheventsareexecuted;data-flow
edges describe the flow of information from data retrieval to either
check condition or payload nodes. For the example in Figure 5, the
P:Information stealing node (node #6 in the figure) is executed after
DR:SMS(node #3), H:Information blocking (node #4), and DR:Device
(node #5); the data-flow edges show that the P:Information stealing
node leaks SMS and device-related information.Another important detail captured by the graph is that the info
stealing payload is triggered only after an SMS is received (node
#1)andonlyifthecondition CC:Externalserver:Internet (node#2)
evaluates to True. The condition itself is dependent on the informa-
tionobtainedfromtheInternet(node#10),whichisretrievedwhen
the user unlocks the phone: EC:System:Device status (node #7).
Finally,wegroupnodes into regionscapturingthecodeproper-
tiesofthenodes‚Äìlocationandlanguage.Theregionsareindicated
by dashed lines in Figure 5. In this example, there are two regions:
the first contains nodes corresponding to the bytecode directlyloaded by the app from the .dex file (nodes #1-#12) and the sec-
ond contains nodes corresponding to Web code (HTML/JavaScript)
downloaded from the remote server (nodes #13-#15).
Whenweanalyzedthisapp,theremoteserverwasdownand,
thus, we have no access to the code downloaded from the server.
Wedescribethebehaviorofthatcodebasedonthedescriptionin
theblogpost:upontheuserenteringtheircredentials(node#13),
this info gets leaked to the malware developer‚Äôs server (nodes #14
and #15). As discussed in Section 2.2, we mark nodes for which we
followedthepostdescriptionratherthanobservedthemalicious
payload directly with a star ( /star_empty).
Apathinourgraphisasequenceofnodesconnectedbycontrol-
flowedges.Apathstartsfromanodewithnoincomingedge,which
is an Event Condition (e.g., node #1 in Figure 5). A path ends with
a node with no outgoing control-flow edges, which could be apayload, a data retrieval node, or a hiding technique node (e.g.,
node#15).TheexampleinFigure5hasthreepaths: ùëÉ1isthepath
fromnode#1to#15,wheretheconditioninnode#2evaluatesto
True. ùëÉ2isa(shorter)pathfromnode#1to#15wherethecondition
evaluates to False. Finally, ùëÉ3is the path from node #7 to #15.
Apathcanincludemultipleeventconditions.Forexample, ùëÉ3
requires the user to unlock the device (node #7) and provide sensi-
tiveinput(node#13).Likewise,apathcanincludemultiplecheck
conditions,e.g., ùëÉ1checksaservercommand(node#2)andinstalled
apps(node#12).Finally,apathcanhavemultiplehidingtechniques
andpayloads,e.g., ùëÉ2containstwoinformationstealingpayloads
(nodes #9 and #15).
Signatures of GP malware. By analyzing the malware signatures
of our samples, we make three main observations:
1)Overall,thesampleshave14.9pathsonaverage(forthiscal-
culation, we excluded 5 outlier samples with more than 100 paths
as the median number of paths is 9). Each path has multiple event
and check conditions, hiding techniques, data retrieval nodes, and
payloads. Thereare 2.8 event conditionsand 4.8 checkconditions
per path, on average. The relatively high number of conditions
per path shows that malware conditions the execution on specific
externalandinternalsettings(seeFigure4forthelistofconditions).
Forexample,Vilny(ID:108),whichminescryptocurrencyonthe
device,checksacommandfromtheserver,phonetemperature,bat-
tery level, and that the screen is off, all before starting the payload.
Malware analysis tools that are based on dynamic and symbolic
execution should account for all these conditions of different types
to fully analyze / trigger the malware.
2)Thereare5.3dataretrievalnodesperpath,onaverage.Thema-
jorityofthesedataretrievalsareforvalidatingthecheckconditions
1926
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
andtherestareforretrievingsensitivedatafortheinformationleak-
agepayloads.Interestingly,around40%ofdataretrievalshappen
onapathdifferentfromthetargetcheckconditionorpayload.That
is,theapplicationsretrieveandstoredatain,say,afile,andthen
usesitonanotherpath,triggeredbyadifferentevent.Weidentified
severalcross-pathdatastoragelocations:globalvariables,files,and
shared preferences. For example, Bahamut (ID: 18) records the call
audiointoafilewhenthecallisstarted.Later,inadifferentevent‚Äì
on network change ‚Äì it sends the stored file to a third-party server.
This implies that malware analysis tools should be able to consider
morethanonepathsimultaneously,e.g.,totriggermultiplepaths
during dynamic analysis and to analyze data flows across multiple
paths during information flow analysis. Unfortunately, some ofthe existing tools, especially those based on formal methods and
complex program analysis, currently only consider one callback at
atime,e.g.,[ 75,90,98].Furthermore,toolsshouldconsiderinfor-
mation flows through multiple data types given above, in addition
to fields and local variables.
3)Sampleshave3payloadsonaverage,eachofwhichisreach-
able via 12.4 paths on average. Multiple paths lead to the samepayload as malware typically triggers the payload from multipleevents, to maximize the likelihood and frequency of the payloadactivation. For example, a MilkyDoor (ID: 77) payload which isnot reachable by simply opening the app can instead be reached
from60differentpathsoriginatingfromphoneboot,restart,unlock,
Wi-Ficonnectivitychange,andcellularconnectivitychangeevents.
These events are more likely to occur on a user device rather than
onanemulator,asanemulatoristypicallyon,unlocked,andhas
astableconnection.Webelievemalwareusesthismechanismtoavoid detection while maximizing the likelihood to execute the
payload. In fact, more than 70% of the paths in our samples do not
start on app opening.
To answer RQ2, our samples have more than 14 paths on average,
many of which originate from different events. Each path contains
numerous conditions, which need to be satisfied for the payload to
execute.Pathsalsocontainnumerousdataretrievalnodestoaccess
datathat isvalidatedin theconditionsand thatflowsto payloads.
Somedataretrievaloperationscrossmultiplepathsby‚Äútemporar-
ily‚Äùstoringdatainglobalvariables,files,andsharedpreferences.
Understanding the set and order of these behaviors is needed to
build accurate malware detection approaches.
5 DISCUSSION AND IMPLICATIONS
In an attempt to understand why such malware still makes its way
totheGooglePlaystore,weanalyzehowexistingtoolsdealwith
the different characteristics of malware in our dataset. We focuson academic tools only because intellectual property (IP) rights,
‚Äúsecurity by obscurity‚Äù (to prevent malware authors from attack-
ing the tools), and other restrictions prevent us from analyzing
commercialofferings.Yet,asallmalwarecollectedinourdataset
bypassed Google Play defenses, we observe that commercial tools
are also limited in detecting such malware.
To identify relevant academic tools, we systematically analyzed
proceedings of 20 top conferences and journals in software engi-neering and security, focusing on publications between January
2010andJuly2021:ICSE[ 6],FSE[10],ASE[5],ISSTA[ 8],TSE[91],Forced Execution (7)Condition Detection (3)
Hiding Detection (4)Payload-specific (51)
Repackaged Malware (9)Malware Detection ToolsInfo Leakage (37)
Phishing (3)Privilege Abuse (5)
Inter-app Attack (26)Generic Malware (121)
Dynamic Code Loading (2) Sandboxing (14)Ad Abuse (5)
Ransom (1)
Figure 6: The space of malware detection tools
Empirical SE Journal [ 39], IEEE Software [ 3], JSS [12], Informa-
tion and Software Technology [ 4], TOSEM [ 18], CCS [2], S&P [15],
USENIX Security [ 19], ACSAC [ 1], NDSS [ 13], TIFS [17], Comput-
ers & Security [ 11], Information Security [ 7], Security and Privacy
Journal[14],andTrans.onDependableandSecureComputing[ 16].
Thissearchresultedin414papers.Wefurtheraugmentedourlistof
paperswithtechniquesfromsevenrecentsurveysonAndroidsecu-
rity [26,31,43,73,74,84,88], to cover papers that were published
in other venues, identifying additional 106 papers.
Twoauthorsofthispaperreadtheabstract/introductionofthe
identified papers, selecting those that propose approaches for flag-
ging apps as malicious vs. benign. The disagreements (7%) werediscussed and resolved either in a mutual discussion or with the
helpofathirdarbitrator.Attheendofthisprocess,weidentified
237relevantreportswhichwefurthercategorizedbythetypeof
malware analysis they perform. The resulting categorization is
showninFigure6anddiscussedbelow;thefulllistofpapersand
their categories is available online [35].
GenericMalware. Themajorityofpapersinourlist(121)arein
this category. They introduce techniques that aim to detect mal-
warebylearningfromalargesetofmaliciousandbenignapps.The
techniques vary by the type of features they extract, the way of
extracting these features (statically, dynamically, or using a hybrid
approach),andthetypeofmachinelearningtechniqueusedforcre-atingtheresultingmalwareclassificationmodel.Featuresextracted
from the apps include permissions, e.g., [ 40,77], Java/Android API
calls, e.g., [ 33,66,105], system calls, e.g., [ 78,87,109], properties
extracted from control- and data-flow graphs of the application,
e.g., [66] or combinations of the above, e.g., [30, 49, 57].
These techniques rely on the assumption that malware apps
havesimilarfeatures,whicharedifferentfromthefeaturesofbe-
nign applications. Our analysis shows that 65% of the analyzed
malware implement rich benign functionality to penetrate into the
store and further avoid detection by the user. In such situations,features extracted from the benign portion of the apps may out-
weighfeaturesfromthemaliciousportion,tippingtheclassification
outcome towards the benign class. Future research could benefit
from identifying more targeted features that highlight specific ma-
liciousbehaviors.Approachesforpre-processingapps,toremove
knownbenigncode,e.g.,usinglibraryorrepackagedcodedetec-tion [
37,62,86,104] could also be used in tandem with generic
malware detection techniques.
1927
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA Michael Cao, Khaled Ahmed, and Julia Rubin
Payload-specific. Another major line of work (51 papers) focuses
on looking for a specific payload in an app. Out of those, most
approaches (37 papers) identify information leakages. While infor-
mationleakageisindeedthemostprevalentpayloadinouranalysis,
other payloads do not seem to receive similar attention. In particu-
lar, onlya fewtechniques, e.g., [ 56], focuson adabuse detection ‚Äì
the second most common payload in our analysis (69 samples).
Moreover, while these techniques work on the Java bytecode level,
29samplesinouranalysisimplementthepayloadinJavaScriptand
11 ‚Äì in native code.
A handful of approaches have also been proposed to detect priv-
ilegeabuse,overlayphishing,andransom.Yet,theseapproaches
cannotdetectthefullrangeofrelatedmaliciousbehaviorsidenti-
fiedinourdataset.Forexample,ransomwaredetection[ 36]focuses
on identifying apps that perform encryption, while samples in our
datasetratherforcethedeviceintosilentmodebeforerequesting
ransom. Finally, no payload-specific techniques exist for other pay-
loads in our dataset, such as cryptomining, clipboard hijacking,
account stealing via accessibility services, and more.
Condition Detection. A few papers focus on detecting the check
conditionsthatleadtoactivatingmaliciouspayloads.Thislineof
work assumes that code that is executed under narrow conditions
isindicativeformaliciousbehavior.Forexample,TriggerScope[ 46]
identifiessensitiveAPIsconditionedbychecksconstrainedbyacon-
stant value, mostly targeting logic and time bombs. HsoMiner [ 69]
observes that malicious and benign branches under a narrow con-
dition usually exhibit different characteristics and thus trains a
classifier to learn the difference between malicious and benign
branches. EnMobile [ 101] detects data- and control-flows between
commandsreceivedfromtheInternetandsensitiveAPIsusedby
the app, targeting command-and-control malware.
We believe these are promising directions. Yet, our analysis
shows that these techniques might miss existing samples, e.g.,because both conditioned branches can be malicious, as in our
SpyBankerHUexampleinFigure5.Moreover,around30%ofthe
sampleswe analyzedemploy newcheckconditions thatwerenot
consideredbefore;suchconditionswouldbedifficulttointegrate
intoexistingapproaches,e.g.,checkingfortheInternetorscreen
status is a common behavior of benign apps as well. Finally, to
avoidfalsepositives,techniquesinthiscategoryoftenapproximate
malicious behaviors by the usage of sensitive APIs executed under
conditioned checks. Yet, the precise list of sensitive APIs is hardto define; we found samples that use even the most ‚Äúna√Øve‚Äù APIsfor malicious purposes, e.g., an API to set clipboard data. At the
sametime,appscandeliverpayloadswithoutrelyingonanyAPI
atall,e.g.,theycanusemathematicaloperationsonlytominecryp-
tocurrency on the device. We thus believe it would be beneficial
tocombinethislineofworkwithtechniquesthatlookatspecific
payloadsandalsoidentifystrategiesforincorporatingadditional
condition checks that are common in benign apps as well.
ForcedExecution. Anotherinterestinglineofworkaimsatdynam-
ically forcing the app execution into a malicious path. For example,
IntelliDroid [ 98] and AppIntent [ 102] use symbolic execution to
findthepathconstraintsthatleadtoexecutingsensitiveAPIs,thensolvetheconstraintsandprovidetheappropriateinputthattriggersthe path. FuzzDroid [ 75] and DualForce [ 90] use concolic execu-
tion to simplify unsolvable constraints. In addition to the problem
of triggering the right conditions in the right order discussed in
Section4,themainlimitationofthesetechniquesisthat,toscale
condition resolution via symbolic or concolic execution, they limit
the scope of the analysis, e.g., to analyze each application event
(entry point) separately. Our analysis shows that malicious behav-
iors cross entry points in 40% of the analyzed samples; to detect
suchbehaviors,itisessentialtoanalyzepathsthatcrossmultiple
entry points, including cases where data is transferred from one
pathtoanother.Moreover,constraintsforsomeconditionsarehard
to infer statically. For example, in the Bahamut sample (ID: 18),
the response from the server is processed in a loop, which extracts
and parses each response line separately, towards retrieving a com-
mand. Analyzing such code requires ‚Äúguessing‚Äù the right structure
of the response and the desired number of loop iterations, which is
a nontrivial task.
HidingDetection. Severalpapersinthiscategorymostlyfocus
on flagging the difference between the behavior of the app and its
presented user interface [ 52,68]. Shan et al. [ 80] propose scanning
the apps for identifying, ‚Äúself-hiding behavior‚Äù: blocking phone
calls/text messages or removing calls and messages from logs. Yet,
theauthors noticethatbenign appsalsosometimes employthese
behaviors. Thus, hiding techniques on their own do not providesufficient evidence of maliciousness and can be combined with
other techniques, e.g., for trigger and payload detection.
Dynamic Code Loading. A few papers focus on detecting dy-
namic code loading [ 72,82], where code that is not in the APK‚Äôs
bytecodeis fetched,either fromlocalstorage orfrom theinternet,
and loaded at runtime. While dynamic code loading can indeed be
used maliciously, it can still be used by benign apps for legitimate
reasons, such as patching or loading add-ons. Analyzing the dy-
namicallydownloadedcodeon-demand,asitisbeingloadedand
executed, could be a productive direction for possible future work.
Sandboxing. Toolsinthiscategoryaimtocreateanalysisplatforms
to aid researchers in analyzing malware apps, e.g., [ 27,63,89]. Our
analysis shows that in almost 80% of our samples, a payload is
activated on receipt of a command from the application server. As
the malicious developer may turn their servers off or simply notsend the right command until the app passes the vetting stage,
sandboxing will have limited abilities to detect such apps.
RepackagedMalwareandInter-appAttacks. Toolsinthesecat-
egoriesfocusondetectingrepackagedapps,i.e.,appsthatresemblebenignappsavailableinthestore,andappsthat‚Äúcollude‚Äùwitheach
other to perform a joint attack. As our dataset does not contain
such apps, we omit a discussion of papers in these categories.
ANote onProgrammingLanguages. Mostexisting toolsfocus
on Java bytecode, with a few analyzing native code as well [ 20,21,
49].Whilemorethanaquarterofoursamplessplitthemalicious
executionbetweenJavabytecodeandWeb/nativecode,noneofthe
tools perform an end-to-end analysis of such executions, e.g., to
identifyconditionsinbytecodethatconstrainWeb/nativepayloads.
As malware becomes increasingly more sophisticated, developing
such tools could be a direction of possible future work.
1928
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
Summary. The majority of existing tools focuses on identifying
features and training machine learning classifiers to tell malicious
andbenignappsapart.Payload-specifictoolsfocusmostlyoninfor-
mationleakages,leavingagap inidentifyingadditionalpayloads.
A number of approaches also look at analyzing and triggering
conditions that lead to payloads, as well as at hiding techniques.
A productive research direction could be to combine condition-,
payload-, and hiding-specific techniques, providing a holistic de-
tectionapproachthatcananalyzethefullbehaviorofapps.Tools
looking at cross-platform malware behaviors, as well as dynami-
cally downloaded code, are also needed.
6 LIMITATIONS AND THREATS TO VALIDITY
Themainthreattothevalidityofourresultsstemsfromthemanual
analysis we performed: when identifying blog posts describing the
malware, we could have misinterpreted the findings in a post or
missedsomerelevantblogposts.Wecouldalsohavemissedormis-
classifiedsomeoftheanalyzedtools.Tomitigatethesethreats,two
authorsofthispaperperformedtheblogsandtoolsclassification
independently and then cross-validated each other‚Äôs results.
Whenperformingmanualanalysisofapps,wecouldhavemissed
some payloads or incorrectly interpreted the findings. To mitigate
this threat, two authors of this paper worked collaboratively onanalyzing a number of apps, to establish a common process and
methodology. Thefindingsfrom allanalysissteps werediscussed
withallauthorsofthepaperinperiodicmeetings,toidentifyandfix
misinterpretations and omissions. We make all our results publicly
available to facilitate reproducibility.
Wecouldnotperformadetailedmanualanalysisforsomeofthe
appsduetoheavyobfuscation,theuseofcommercialpackers,miss-ing encryption keys, and more (see Section 2.2). We excluded theseappsfromouranalysis,toensurethevalidityofourresults.Forappsthat rely on a server that is now down, we used descriptions of ma-
licious behaviors taken from the blog post, when available. As the
posts may not describe all event conditions, check conditions, and
payloadsthatthedownloadedcodeuses,wecouldhavecaptured
the paths in these apps only partially. We explicitly mark nodes
(with /star_empty) in our flow signatures (5.9 % of all nodes) to distinguish
them from behaviors we observed directly.
Our findings might not generalize beyond the dataset that we
considered. Yet, as we carefully designed the data collection pro-
cess and selected a large number of apps from several top security
company blogs, we believe that our results are reliable.
Finally, our discussion of implications on malware detection
tools is based on paper analysis rather than concrete evaluation.
As we identified 202 relevant tools, with around 50 being open-
sourced, performing proper evaluation requires (1) a good toolsampling strategy, including a strategy for evaluating tools that
are not open-sourced, and (2) proper training/testing methodology
as the majority of the tools are based on machine learning (see
Section 5). We thus leave such a study for possible future work.
7 RELATED WORK
Felt et al. [ 44] were likely the first tomanually analyze and report
on the behavior of 18 Android malware apps, as well as 28 iOS and
Symbianapps,collectedbetween2009and2011.Later,JiangandZhou[108]collectedandmanuallyanalyzedappsfromantivirus
company blogs between 2010 and 2012, contributing a comprehen-
sive set of 1,260 labeled Android malware apps from 49 malwarefamilies (the Malware Genome dataset). Wei et al. [
97] applied a
similarmethodologytocollectalargesetof24,650appsthatbelong
to 71malware families(the AMD dataset)and manuallyanalyzed
405 of these apps. The dataset contains malware between 2012 and
2016. While our work is similar, we collected and manually ana-
lyzed a newer set of apps, identifying new payloads and activation
mechanisms, as discussed in Section 3. We also outlined hidingtechniques and code-level app properties, and provided detailedinformation on the end-to-end malware activation mechanisms
(Section 4), which was not done before.
Similartous,Kissetal.[ 58]performedadetailedmanualanalysis
of samples from seven malware families spanning 2011-2015, de-
scribingeventsandactivationconditionsrequiredtotriggerthema-
licious behavior. Yet, our dataset is substantially newer and larger,
allowing us to identifya larger set of malware characteristics.We
also created a schema to capture information about path-sensitive
behaviors.
Recently,Xiaetal.[ 100]andWangetal.[ 94]studiedpayloads
in cryptocurrency- and COVID-related apps from various markets.
Unlikeourwork,theseanalysesdidnotprovideactivationcondi-
tionsandthecode-levelpropertiesofmaliciousbehaviors,focusing
onhigh-levelcharacteristicsofthepayload.Wealsodonotlimit
our analysis to apps in a particular category.
Anumberofauthorscollectedlargedatasetsofmalwarefrom
various sources, mostly using antivirus scanners to distinguish ma-
liciousandbenignapps[ 24,30,51,59,60,93,106].Otherscollected
datasets of malware barring particular payloads, e.g., piggyback-
ing[61],adware[ 48,65],ransomware[ 36],orbankingmalware[ 32].
Whilethesedatasetsareusefulfortoolevaluation,theauthorsdo
not perform a detailed manual analysis to extract the exact proper-
ties of the collected apps, as we do in our work.
Several authorsfocused on studyingthe space of featuresused
for malware classification, e.g., [ 22,95,96], as well as biases in
malware classification, e.g., [ 23,25,71,103]. Others built generic
and dedicated techniques for identifying malicious applications, as
discussed in Section 5. Our work is orthogonal as we do not study
datasetsatscalebutratherperformadetailedmanualanalysisof
apps that evaded detection by the Google Play store.
8 CONCLUSION
In this paper, we systematically built a dataset of 1,238 malwareapps that penetrated the official Google Play app store between
January2016andJuly2021.Wemanuallyanalyzedsamplesfrom
105distinctfamilies, collectingdetailedinformationaboutactiva-
tionconditions,hidingtechniques,payloads,andcodeproperties
(original location and language) that malware employs. We com-
paredourcharacterizationtopriormalwareanalysisreportsand
furtherproduced detailedmalware signaturesthat accuratelycap-
turemaliciousexecutionpathsofeachsampleapp.Wediscussed
the properties of existing malware detection tools in the contextof our analysis and identified gaps and possible future research
directions.Webelieveourdetailedanalysisofmalwarebehaviors
can help develop more efficient malware detection tools.
1929
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA Michael Cao, Khaled Ahmed, and Julia Rubin
REFERENCES
[1] [n.d.]. Annual Computer Security Applications Conference (ACSAC).
[2] [n.d.]. Conference on Computer and Communications Security (CCS).[3] [n.d.]. IEEE Software.[4] [n.d.]. Information and Software Technology (IST).[5] [n.d.]. International Conference on Automated Software Engineering (ASE).[6] [n.d.]. International Conference on Software Engineering (ICSE).[7] [n.d.]. International Journal of Information Security (IJIS).[8] [n.d.]. International Symposium on Software Testing and Analysis (ISSTA).
[9][n.d.].Investopedia.https://www.investopedia.com/articles/forex/121815/bitcoins-
price-history.asp.
[10][n.d.]. Joint European Software Engineering Conference and Symposium on
the Foundations of Software Engineering (ESEC/FSE).
[11] [n.d.]. Journal of Computers & Security.[12] [n.d.]. Journal of Systems and Software (JSS).[13] [n.d.]. Network and Distributed System Security Symposium (NDSS).[14] [n.d.]. Security & Privacy Journal.[15] [n.d.]. Symposium on Security and Privacy (S&P).[16] [n.d.]. Transactions on Dependable and Secure Computing (TDSC).[17] [n.d.]. Transactions on Information Forensics and Security (TIFS).[18] [n.d.]. Transactions on Software Engineering and Methodology (TOSEM).[19] [n.d.]. USENIX Security Symposium.[20]
Vitor Monte Afonso, Matheus Favero de Amorim, Andr√© Ricardo Abed Gr√©gio,
GlaucoBarrosoJunquera,andPauloL√≠ciodeGeus.2015. IdentifyingAndroid
MalwareUsingDynamicallyObtainedFeatures. ComputerVirologyandHacking
Techniques 11, 1 (2015), 9‚Äì17.
[21]Shahid Alam, Zhengyang Qu, Ryan Riley, Yan Chen, and Vaibhav Rastogi. 2017.
DroidNative:AutomatingandOptimizingDetectionofAndroidNativeCode
Malware Variants. Computers and Security (CS) 65 (2017), 230‚Äì246.
[22]KevinAllix,Tegawend√©F.Bissyand√©,QuentinJ√©rome,JacquesKlein,RaduState,
and Yves Le Traon. 2016. Empirical Assessment of Machine Learning-Based
MalwareDetectorsforAndroid. EmpiricalSoftwareEngineering(EMSE) 21,1
(2016), 183‚Äì211.
[23]KevinAllix,Tegawend√©FBissyand√©,JacquesKlein,andYvesLeTraon.2015. Are
YourTrainingDatasetsYetRelevant?.In Proc.oftheInternationalSymposium
on Engineering Secure Software and Systems (ISESSS). 51‚Äì67.
[24]KevinAllix,Tegawend√©F.Bissyand√©,JacquesKlein,andYvesLeTraon.2016.
AndroZoo:CollectingMillionsofAndroidAppsfortheResearchCommunity.
InProc.oftheWorkingConferenceonMiningSoftwareRepositories(MSR).14‚Äì15.
[25]KevinAllix,Tegawend√©Fran√ßoisDAssiseBissyande,JacquesKlein,andYves
Le Traon. 2014. Machine Learning-Based Malware Detection for Android Applica-
tions: History Matters! Technical Report. University of Luxembourg, SnT.
[26]Ebtesam J. Alqahtani, Rachid Zagrouba, and Abdullah Almuhaideb. 2019. ASurvey on Android Malware Detection Techniques Using Machine Learning
Algorithms. In Proc. of the International Conference on Software Defined Systems
(SDS). 110‚Äì117.
[27]Cosimo Anglano, Massimo Canonico, and Marco Guazzone. 2020. The Android
Forensics Automator (AnForA): A tool for the Automated Forensic Analysis of
Android Applications. Computers and Security (CS) 88 (2020), 1‚Äì15.
[28] APKMonk. [n.d.]. APKMonk. https://www.apkmonk.com.[29] APKPure. [n.d.]. APKPure. https://apkpure.com.[30] Daniel Arp,Michael Spreitzenbarth,Malte H√ºbner,Hugo Gascon,and Konrad
Rieck.2014.DREBIN:EffectiveandExplainableDetectionofAndroidMalwarein
Your Pocket. In Proc. of the Network and Distributed System Security Symposium
(NDSS). 1‚Äì15.
[31]SabaArshad,MunamAliShah,AbidKhan,andMansoorAhmed.2016. Android
Malware Detection & Protection: A Survey. International Journal of Advanced
Computer Science and Applications (IJACSA) 7, 2 (2016), 463‚Äì475.
[32]ChongyangBai,QianHan,GhitaMezzour,FabioPierazzi,andVSSubrahmanian.
2019. Dbank: Predictive behavioralanalysis ofrecent android bankingtrojans.
Transactions on Dependable and Secure Computing (TDSC) (2019).
[33]Haipeng Cai, Na Meng, Barbara Ryder, and Daphne Yao. 2018. Droidcat: Effec-
tiveAndroidMalwareDetectionandCategorizationViaApp-LevelProfiling.
TransactionsonInformationForensicsandSecurity(TIFS) 14,6(2018),1455‚Äì1470.
[34]Michael Cao, Khaled Ahmed, and Julia Rubin. 2022. GooglePlayMalware. https:
//doi.org/10.5281/zenodo.5376011.
[35]MichaelCao,KhaledAhmed,andJuliaRubin.2022. SupplementaryMaterials.
https://resess.github.io/artifacts/GooglePlayMalwareAnalysis.
[36]Jing Chen, Chiheng Wang, Ziming Zhao, Kai Chen, Ruiying Du, and Gail-Joon
Ahn.2017. Uncoveringthefaceofandroidransomware:Characterizationand
real-timedetection. TransactionsonInformationForensicsandSecurity(TIFS) 13,
5 (2017), 1286‚Äì1300.
[37]Kai Chen, Peng Wang, Yeonjoon Lee, XiaoFeng Wang, Nan Zhang, Heqing
Huang,WeiZou,andPengLiu.2015. Findingunknownmalicein10seconds:
Mass vetting for new threats at the google-play scale. In Proc. of the USENIX
Security Symposium (USENIX). 659‚Äì674.
[38]DrizzleRisk.2021.DrizzleDumper.https://github.com/DrizzleRisk/drizzleDumper.[39] Empirical Software Engineering (EMSE). [n.d.].[40]
William Enck, Machigar Ongtang, and Patrick McDaniel. 2009. On Lightweight
Mobile Phone Application Certification. In Proc. of the Conference on Computer
and Communications Security (CCS). 235‚Äì245.
[41]ESET. [n.d.]. https://www.welivesecurity.com/2017/02/22/sunny-chance-stolen-
credentials-malicious-weather-app-found-google-play/.
[42]ESET. [n.d.]. ESET. https://www.welivesecurity.com/2018/02/28/
cryptocurrency-scams-android/.
[43]Parvez Faruki, Ammar Bharmal, Vijay Laxmi, Vijay Ganmoor, Manoj Singh
Gaur,MauroConti,andMuttukrishnanRajarajan.2015. AndroidSecurity:A
Survey of Issues, Malware Penetration, and Defenses. IEEE Communications
Surveys Tutorials 17, 2 (2015), 998‚Äì1022.
[44]Adrienne Porter Felt, Matthew Finifter, Erika Chin, Steve Hanna, and David
Wagner. 2011. A Survey of Mobile Malware in the Wild. In Proc. of the CCS
Workshop on Security and Privacy in Smartphones and Mobile Devices (SPSM).
3‚Äì14.
[45]Jeanne Ferrante, Karl J Ottenstein, and Joe D Warren. 1987. The Program
Dependence Graph and Its Use in Optimization. Transactions on Programming
Languages and Systems (TOPLAS) 9, 3 (1987), 319‚Äì49.
[46]Yanick Fratantonio, Antonio Bianchi, William Robertson, Engin Kirda, Christo-
pher Kruegel, and Giovanni Vigna. 2016. TriggerScope: Towards DetectingLogic Bombs in Android Applications. In Proc. of the Symposium on Security
and Privacy (S&P). 377‚Äì396.
[47]Yanick Fratantonio, Chenxiong Qian, Simon P Chung, and Wenke Lee. 2017.
Cloak and Dagger: From Two Permissions to Complete Control of the UI Feed-
back Loop. In Proc. of the Symposium on Security and Privacy (S&P). 1041‚Äì1057.
[48]Jun Gao, Li Li, Pingfan Kong, Tegawend√© F Bissyand√©, and Jacques Klein. 2019.
ShouldYouConsiderAdwareasMalwareinYourStudy?.In Proc.oftheInterna-
tional Conference on Software Analysis, Evolution and Reengineering (SANER).
604‚Äì608.
[49]Joshua Garcia, Mahmoud Hammad, and Sam Malek. 2018. Lightweight,
Obfuscation-Resilient Detection and Family Identification of Android Malware.
Transactions on Software Engineering and Methodology (TOSEM) 26, 3 (2018),
1‚Äì29.
[50]Google. 2021. FirebaseCloudMessaging. https://firebase.google.com/docs/cloud-
messaging.
[51]Alejandro Guerra-Manzanares, Hayretdin Bahsi, and Sven N√µmm. 2021. Kron-
oDroid:Time-BasedHybrid-FeaturedDatasetforEffectiveAndroidMalware
Detection and Characterization. Computers and Security (CS) 110 (2021), 1‚Äì38.
[52]Jianjun Huang, Xiangyu Zhang, Lin Tan, Peng Wang, and Bin Liang. 2014.
AsDroid:DetectingStealthyBehaviorsinAndroidApplicationsbyUserInterface
and Program Behavior Contradiction. In Proc. of the International Conference on
Software Engineering (ICSE). 1036‚Äì1046.
[53]E.OuelletI.McShane,A.LitanandP.Bhajanka.[n.d.]. MagicQuadrantforEnd-
point Protection Platforms. https://www.gartner.com/en/documents/4001307.
[54] JetBrains. 2021. IntelliJ IDEA. https://www.jetbrains.com/idea/.[55] Jiagu. 2021. Jiagu. https://jiagu.360.cn/.[56]
Joongyum Kim, Jung-hwan Park, and Sooel Son. 2020. The Abuser Inside Apps:
FindingtheCulpritCommittingMobileAdFraud.In Proc.oftheNetworkand
Distributed System Security Symposium (NDSS). 1‚Äì16.
[57]TaeGuen Kim, BooJoong Kang, Mina Rho, Sakir Sezer, and Eul Gyu Im. 2018.
A Multimodal Deep Learning Method for Android Malware Detection Using
Various Features. Transactions on Information Forensics and Security (TIFS) 14, 3
(2018), 773‚Äì788.
[58]Nicolas Kiss, Jean-Fran√ßois Lalande, Mourad Leslous, and Val√©rie Viet Triem
Tong. 2016. Kharon Dataset: Android Malware under a Microscope. In Proc. of
the Learning from Authoritative Security Experiment Results Workshop (LASER).
1‚Äì12.
[59]ArashHabibiLashkari,AndiFitriahAKadir,HugoGonzalez,KennethFonMbah,
andAliAGhorbani.2017. TowardsaNetwork-basedFrameworkforAndroid
MalwareDetectionandCharacterization.In Proc.oftheAnnualConferenceon
Privacy, Security and Trust (PST). 233‚Äì23309.
[60]Arash Habibi Lashkari, Andi Fitriah A Kadir, Laya Taheri, and Ali A Ghorbani.
2018. Toward Developing a Systematic Approach to Generate Benchmark An-
droidMalwareDatasetsandClassification.In Proc.oftheInternationalCarnahan
Conference on Security Technology (ICCST). 1‚Äì7.
[61]Li Li, Daoyuan Li, Tegawend√© F Bissyand√©, Jacques Klein, Yves Le Traon, David
Lo,andLorenzoCavallaro.2017. UnderstandingAndroidAppPiggybacking:
A Systematic Study of Malicious Code Grafting. Transactions on Information
Forensics and Security (TIFS) 12, 6 (2017), 1269‚Äì1284.
[62]MenghaoLi,WeiWang,PeiWang,ShuaiWang,DinghaoWu,JianLiu,RuiXue,andWeiHuo.2017. LibD:ScalableandPreciseThird-PartyLibraryDetectionin
AndroidMarkets.In Proc.oftheInternationalConferenceonSoftwareEngineering
(ICSE). 335‚Äì346.
[63]MartinaLindorfer,MatthiasNeugschwandtner,LukasWeichselbaum,Yanick
Fratantonio, Victor Van Der Veen, and Christian Platzer. 2014. Andrubis‚Äì
1,000,000 Apps Later: A View on Current Android Malware Behaviors. In Proc.
of the Workshop on Building Analysis Datasets and Gathering Experience Returns
1930
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware ICSE ‚Äô22, May 21‚Äì29, 2022, Pittsburgh, PA, USA
for Security (BADGERS). 3‚Äì17.
[64]Hongjiu Lu. 1995. ELF: From The Programmer‚Äôs Perspective. NYNEX Science &
Technology Inc (1995), 95.
[65]Samaneh Mahdavifar, Andi Fitriah Abdul Kadir, Rasool Fatemi, Dima Alhadidi,
and Ali A Ghorbani. 2020. Dynamic Android Malware Category Classification
usingSemi-SupervisedDeepLearning.In Proc.oftheInternationalConference
onDependable,AutonomicandSecureComputing,InternationalConferenceon
Pervasive Intelligence and Computing, International Conference on Cloud and
Big Data Computing, International Conference on Cyber Science and Technology
Congress (DASC/PiCom/CBDCom/CyberSciTech). 515‚Äì522.
[66]EnricoMariconti,LuckyOnwuzurike,PanagiotisAndriotis,EmilianoDeCristo-
faro,GordonRoss,andGianlucaStringhini.2017. MaMaDroid:DetectingAn-
droid Malware by Building Markov Chains of Behavioral Models. In Proc. of the
Network and Distributed System Security Symposium (NDSS). 1‚Äì12.
[67]Palo Alto Networks. 2021. PluginPhantom: New Android Trojan Abuses
‚ÄúDroidPlugin‚Äù Framework. https://unit42.paloaltonetworks.com/unit42-
pluginphantom-new-android-trojan-abuses-droidplugin-framework/.
[68]Xiang Pan, Yinzhi Cao, Xuechao Du, Boyuan He, Gan Fang, Rui Shao, and
YanChen.2018. FlowCog:Context-awareSemanticsExtractionandAnalysis
of Information Flow Leaks in Android Apps. In Proc. of the USENIX Security
Symposium (USENIX). 1669‚Äì1685.
[69]Xiaorui Pan, Xueqiang Wang, Yue Duan, XiaoFeng Wang, and Heng Yin. 2017.
Dark Hazard: Learning-based, Large-Scale Discovery of Hidden Sensitive Oper-
ations in Android Apps. In Proc. of the Network and Distributed System Security
Symposium (NDSS). 1‚Äì15.
[70]Parkour. [n.d.]. Contagio Malware Dump. http://contagiodump.blogspot.com/.
[71]Feargus Pendlebury, Fabio Pierazzi, Roberto Jordaney, Johannes Kinder, and
LorenzoCavallaro.2019. TESSERACT:EliminatingExperimentalBiasinMal-
ware Classification across Space and Time. In Proc. of the USENIX Security
Symposium (USENIX). 729‚Äì746.
[72]Sebastian Poeplau, Yanick Fratantonio,Antonio Bianchi, Christopher Kruegel,
and Giovanni Vigna. 2014. Execute This! Analyzing Unsafe and Malicious
Dynamic Code Loading in Android Applications. In Proc. of the Network and
Distributed System Security Symposium (NDSS). 23‚Äì26.
[73]Junyang Qiu, Jun Zhang, Wei Luo, Lei Pan, Surya Nepal, and Yang Xiang. 2020.
A Survey of Android Malware Detection with Deep Neural Models. Comput.
Surveys53, 6 (2020), 1‚Äì36.
[74]Bahman Rashidi and Carol J Fung. 2015. A Survey of Android Security Threats
and Defenses. Journal of Wireless Mobile Networks, Ubiquitous Computing, and
Dependable Applications 6, 3 (2015), 3‚Äì35.
[75]SiegfriedRasthofer,StevenArzt,StefanTriller,andMichaelPradel.2017.Making
MaloryBehaveMaliciously:TargetedFuzzingofAndroidExecutionEnviron-
ments.In Proc.oftheInternationalConferenceonSoftwareEngineering(ICSE).
300‚Äì311.
[76] Hex Rays. 2021. IDA. https://hex-rays.com/ida-pro/.[77]
BorjaSanz,IgorSantos,CarlosLaorden,XabierUgarte-Pedrero,PabloGarcia
Bringas,andGonzalo√Ålvarez.2013. PUMA:PermissionUsagetoDetectMal-
wareinAndroid.In Proc.oftheJointConferenceCISIS‚Äô12-ICEUTE‚Äô12-SOCO‚Äô12
Special Sessions. 289‚Äì298.
[78]Andrea Saracino, Daniele Sgandurra, Gianluca Dini, and Fabio Martinelli. 2016.
MADAM:EffectiveandEfficientBehavior-basedAndroidMalwareDetection
and Prevention. Transactions on Dependable and Secure Computing (TDSC) 15, 1
(2016), 83‚Äì97.
[79]Marcos Sebasti√°n, Richard Rivera, Platon Kotzias, and Juan Caballero. 2016.
Avclass: A Tool for Massive Malware Labeling. In Proc. of the International
Symposium on Research in Attacks, Intrusions, and Defenses (RAID). 230‚Äì253.
[80]ZhiyongShan,IulianNeamtiu,andRainaSamuel.2018. Self-HidingBehavior
inAndroidApps:DetectionandCharacterization.In Proc.oftheInternational
Conference on Software Engineering (ICSE). 728‚Äì739.
[81] Virus Share. [n.d.]. https://virusshare.com.[82]
LumanShi,JiangMing,JianmingFu,GuojunPeng,DongpengXu,KunGao,and
XuanchenPan. 2020. VAHunt:WardingOff NewRepackagedAndroid Malware
in App-Virtualization‚Äôs Clothing. In Proc. of the Conference on Computer and
Communications Security (CCS). 535‚Äì549.
[83] skylot. 2021. JADX. https://github.com/skylot/jadx.[84]
AlirezaSouriandRahilHosseini.2018. AState-of-the-artSurveyofMalwareDe-
tection Approaches Using Data Mining Techniques. Human-centric Computing
and Information Sciences 8, 1 (2018), 1‚Äì22.
[85]Tim Strazzere.2021. AndroidUnpacker. https://github.com/strazzere/android-
unpacker.
[86]Guillermo Suarez-Tangil and Gianluca Stringhini. 2020. Eight Years of Rider
Measurement in the Android Malware Ecosystem. Transactions on Dependableand Secure Computing (TDSC) (2020).
[87]MingshenSun,XiaoleiLi,JohnC.S.Lui,RichardT.B.Ma,andZhenkaiLiang.
2017. Monet: A User-Oriented Behavior-Based Malware Variants Detection
SystemforAndroid. TransactionsonInformationForensicsandSecurity(TIFS)
12, 5 (2017), 1103‚Äì1112.
[88]Kimberly Tam, Ali Feizollah, Nor Badrul Anuar, Rosli Salleh, and LorenzoCavallaro. 2017. The Evolution of Android Malware and Android Analysis
Techniques. Comput. Surveys 49, 4 (2017), 1‚Äì41.
[89]KimberlyTam,SalahuddinJKhan,AristideFattori,andLorenzoCavallaro.2015.CopperDroid:AutomaticReconstructionofAndroidMalwareBehaviors.In Proc.
of the Network and Distributed System Security Symposium (NDSS). 1‚Äì15.
[90]Zhenhao Tang, Juan Zhai, Minxue Pan, Yousra Aafer, Shiqing Ma, Xiangyu
Zhang, and Jianhua Zhao. 2018. Dual-Force: Understanding WebView Malware
viaCross-LanguageForcedExecution.In Proc.oftheInternationalConference
on Automated Software Engineering (ASE). 714‚Äì725.
[91] Transactions on Software Engineering (TSE). [n.d.].[92] VirusTotal. 2021. VirusTotal. https://www.virustotal.com/home.[93]
Haoyu Wang, Junjun Si, Hao Li, and Yao Guo. 2019. RmvDroid: Towards a Reli-
able Android Malware Dataset with App Metadata. In Proc. of the International
Conference on Mining Software Repositories (MSR). 404‚Äì408.
[94]LiuWang,RenHe,HaoyuWang,PengchengXia,YuanchunLi,LeiWu,Yajin
Zhou, Xiapu Luo, Yulei Sui, Yao Guo, et al. 2021. Beyond the virus: a first look
at coronavirus-themed Androidmalware. Empirical Software Engineering 26, 4
(2021), 1‚Äì38.
[95]Wei Wang, Meichen Zhao, Zhenzhen Gao, Guangquan Xu, Hequn Xian,
Yuanyuan Li, and Xiangliang Zhang. 2019. Constructing Features for Detecting
Android Malicious Applications: Issues, Taxonomy and Directions. IEEE Access
7 (2019), 67602‚Äì67631.
[96]Xing Wang, Wei Wang, Yongzhong He, Jiqiang Liu, Zhen Han, and Xiangliang
Zhang. 2017. Characterizing Android Apps‚Äô Behavior for Effective Detection of
Malapps at Large Scale. Future Generation Computer Systems 75 (2017), 30‚Äì45.
[97]FengguoWei,YupingLi,SankardasRoy,XinmingOu,andWuZhou.2017. DeepGroundTruthAnalysisofCurrentAndroidMalware.In Proc.oftheInternational
Conference on Detection of Intrusions and Malware, and Vulnerability Assessment
(DIMVA). 252‚Äì276.
[98]Wong,MichelleYandLie,David.2016. IntelliDroid:ATargetedInputGenerator
for the Dynamic Analysis of Android Malware.. In Proc. of the Network and
Distributed System Security Symposium (NDSS). 1‚Äì15.
[99] Woxihuannisja. 2021. Bangcle. https://github.com/woxihuannisja/Bangcle.
[100]Pengcheng Xia, Haoyu Wang, Bowen Zhang, Ru Ji, Bingyu Gao, Lei Wu, Xiapu
Luo, and Guoai Xu. 2020. Characterizing cryptocurrency exchange scams.
Computers & Security 98 (2020), 101993.
[101]WeiYang,MukulR.Prasad,andTaoXie.2018.EnMobile:Entity-basedCharacter-
ization and Analysis of Mobile Malware. In Proc. of the International Conference
on Software Engineering (ICSE). 384‚Äì394.
[102]ZheminYang,MinYang,YuanZhang,GuofeiGu,PengNing,andX.SeanWang.2013. AppIntent:AnalyzingSensitiveDataTransmissioninAndroidforPrivacy
Leakage Detection. In Proc. of the Conference on Computer and Communications
Security (CCS). 1043‚Äì1054.
[103]Yanfang Ye, Tao Li, Donald Adjeroh, and S. Sitharama Iyengar. 2017. A Survey
onMalwareDetectionUsingDataMiningTechniques. Comput.Surveys 50,3
(2017), 41:1‚Äì41:40.
[104]Jiexin Zhang, Alastair R Beresford, and Stephan A Kollmann. 2019. LibID:
ReliableIdentification ofObfuscated Third-PartyAndroid Libraries.In Proc.of
the International Symposium on Software Testing and Analysis (ISSTA). 55‚Äì65.
[105]Mu Zhang, Yue Duan, Heng Yin, and Zhiruo Zhao. 2014. Semantics-Aware
AndroidMalware ClassificationUsingWeighted ContextualAPIDependency
Graphs. In Proc. of the conference on Computer and Communications Security
(CCS). 1105‚Äì1116.
[106]XiaohanZhang,YuanZhang,MingZhong,DaizongDing,YinzhiCao,YukunZhang,MiZhang,andMinYang.2020. EnhancingState-of-the-artClassifiers
with API Semantics to Detect Evolved Android Malware. In Proc. of the Confer-
ence on Computer and Communications Security (CCS). 757‚Äì770.
[107]YueqianZhang,XiapuLuo,andHaoyangYin.2015. Dexhunter:TowardExtract-
ingHiddenCodeFromPackedAndroidApplications.In Proc.oftheEuropean
Symposium on Research in Computer Security (ESORICS). 293‚Äì311.
[108]YajinZhouandXuxianJiang.2012. DissectingAndroidMalware:Characteri-
zationandEvolution.In Proc.oftheSymposiumonSecurityandPrivacy(S&P).
95‚Äì109.
[109]Yajin Zhou, Zhi Wang, Wu Zhou, and Xuxian Jiang. 2012. Hey, You, Get Offof my Market: Detecting Malicious Apps in Official and Alternative AndroidMarkets. In Proc. of the Network and Distributed System Security Symposium
(NDSS). 50‚Äì52.
1931
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 08:52:10 UTC from IEEE Xplore.  Restrictions apply. 