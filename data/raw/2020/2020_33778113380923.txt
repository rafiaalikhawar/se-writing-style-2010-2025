A Large-Scale Empirical Study on Vulnerability Distribution
within Projects and the Lessons Learned
Bingchang Liu‚àó
liubingchang@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of SciencesGuozhu Meng‚àó‚Ä†
mengguozhu@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of SciencesWei Zou‚àó
zouwei@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of Sciences
Qi Gong
gongqi@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of SciencesFeng Li‚àó
lifeng@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of SciencesMin Lin
mingo.limz@gmail.com
InstituteforNetwork Scienceand
Cyberspace, Tsinghua University
Dandan Sun
sundandan@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of SciencesWei Huo‚àó
huowei@iie.ac.cn
Instituteof Information Engineering,
ChineseAcademy of SciencesChao Zhang‚Ä°
chaoz@tsinghua.edu.cn
InstituteforNetwork Scienceand
Cyberspace, Tsinghua University
ABSTRACT
The number of vulnerabilities increases rapidly in recent years,
duetoadvancesinvulnerabilitydiscoverysolutions.Itenablesa
thorough analysis on the vulnerability distribution and provides
support for correlation analysis and prediction of vulnerabilities.
Previous research either focuses on analyzing bugs rather than
vulnerabilities, or only studies general vulnerability distribution
among projects rather than the distribution within each project.In this paper, we collected a large vulnerability dataset, consist-
ing of all known vulnerabilities associated with five representative
opensourceprojects,byutilizingautomatedcrawlersandspending
monthsofmanualefforts.Wethenanalyzedthevulnerabilitydis-
tribution within each project over four dimensions, including files,
functions, vulnerability types and responsible developers. Basedon the results analysis, we presented 12 practical insights on the
distribution of vulnerabilities. Finally, we applied such insights on
several vulnerability discovery solutions (including static analysis
anddynamicfuzzing),andhelpedthemfind10zero-dayvulnera-
bilitiesin target projects, showing that our insights are useful.
CCS CONCEPTS
‚Ä¢Securityandprivacy ‚ÜíSoftwaresecurityengineering ;‚Ä¢
Generalandreference ‚ÜíEmpiricalstudies.
‚àóAlso with:School of Cyber Security, University of Chinese Academy of Sciences.
‚Ä†Corresponding Author
‚Ä°Alsowith:BeijingNationalResearchCenterforInformationScienceandTechnology
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSE ‚Äô20, May23‚Äì29, 2020, Seoul, Republic of Korea
¬© 2020 Association for Computing Machinery.
ACM ISBN 978-1-4503-7121-6/20/05...$15.00
https://doi.org/10.1145/3377811.3380923KEYWORDS
EmpiricalStudy, Vulnerability Distribution
ACM Reference Format:
BingchangLiu,GuozhuMeng,WeiZou,QiGong,FengLi,MinLin,Dandan
Sun, Wei Huo, and Chao Zhang. 2020. A Large-Scale Empirical Study on
Vulnerability Distribution within Projects and the Lessons Learned. In
42ndInternationalConferenceonSoftwareEngineering(ICSE‚Äô20),May23‚Äì
29, 2020, Seoul, Republic of Korea. ACM, New York, NY, USA, 13 pages.
https://doi.org/10.1145/3377811.3380923
1 INTRODUCTION
Software vulnerability is one of the major threats to cyber se-
curity. For example, vulnerabilities like HeartBleed [ 57], Sand-
Worm [58] and DirtyCow [ 56] have posed great risks on millions
ofusers.Duetorecentadvancesofmodernvulnerabilityhunters
(e.g. AFL [ 8], AFLGo [ 12], Steelix [ 33], CollAFL [ 19]), vulner-
abilities are being reported at a striking speed. The number of
exposed vulnerabilities recorded by National Vulnerability Data-
base (NVD) [ 40] already exceeds forty thousands, let alone the
vulnerabilitieswhichremainunknowntothepublic.Thislargevol-
ume enables a thorough analysis of vulnerability distribution, and
providessupportforcorrelationanalysisofvulnerabilities,which
in turn helps finding new vulnerabilities.
For instance, as shown in Figure 1, we found 5 new vulnerabili-
ties(markedas NVx)whenstudyingsomeexistingvulnerabilities
(marked as MSxx)i nMicrosoft Windows Journal . We figure out
that,allthesenewvulnerabilitiesareclosetoexistingvulnerabili-
ties(markedas MSxx)inthecallgraph.Someofthemevenreside
in the same functions as existing vulnerabilities, or have similar
code snippets. It therefore implies that, vulnerabilities in a project
could have locality in space (e.g., function locations) and patterns
(e.g.,codestructures),andsuchlocalitycouldbeutilizedtolocate
new vulnerabilities around known vulnerabilities in the project.
Motivatedbythis example,weintendto analyzethevulnerability
15472020 IEEE/ACM 42nd International Conference on Software Engineering (ICSE)
ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea Bingchang Liu, Guozhu Meng, Wei Zou, Qi Gong, Feng Li, Min Lin, Dandan Sun, Wei Huo, and Chao Zhang
DecompBitsToEmfStream
CEpEmrIn&ate::EmrProcess
CEpEmrIn&ate::EmrBltIn&ate
CReadPtck2RGB::Init
PTCdecinit
PTCdecode
sub_1dd78641decode_stripewrite_bitmap_rowMS15-045
MS13-054
MS15-098
MS15-045 MS14-038NV1 NV2
NV3
NV4
NV5
Figure1:Areal-worldexample:vulnerabilitieshaveastrong
correlationwhichcouldhelp findingnew vulnerabilities.
distributionwithinprojects,inorderto investigateifsuchvulner-
abilitylocalityiscommoninindividualprojects.Ifso,wefurther
intendtoinvestigatewhethersuchlocalitycouldbeutilizedtofind
new vulnerabilities around known vulnerabilities.
Priorworks[ 10,14,17,24,25,52]havestudiedalargenumber
ofbugsandprovidedinsightsforbetterunderstandingthedistri-
butionandrootcauses ofbugs.Theseinsightsarefurtherutilized
to detect more related bugs [ 9,53,54]. However, these approaches
and insights of bugs cannot be well shifted to vulnerabilities, since
vulnerabilitiesexhibitmanydifferentcharacteristicsfrombugs.For
instance, vulnerabilities are much more rare than bugs. Anotherline of works [
15,29,39,51] concentrate on utilizing individual
features of vulnerabilities, e.g., function calls and code complexity,
topredictnewvulnerabilities.Someotherworks[ 18,26,41,47,62]
focus on studying the life-cycle of vulnerabilities and how to fix
them.Thework[ 32]studiedthevulnerabilitydistributionacross
projects. However, existing works did not study the vulnerabil-ity distribution within projects, and thus are not able to analyze
vulnerabilitylocality in individual projects.
To study vulnerability distribution within projects, there are
several challenges to address. First, there are no qualified datasets
available fora largescale analysis.Existing vulnerabilitydatasets
focus on covering diversified projects, but not all vulnerabilitiesfor a given set of projects. Second, a large scale data analysis is
time-consumingand in general challenging.
Inthiswork,wemakeafirstattempttostudythedistribution
of and correlation between vulnerabilities within projects on a
largescale.Weselect5typicalopen-sourceprojects Linux-kernel,
FFmpeg, ImageMagick, OpenSSL and php-src as the analysis
objects. For each project, we collected all its associated vulnerabili-
tiesbyaggregatingmultipledatasources,includingNVDentries,
BugZilla reports, security bulletins and GitHub commits. We then
attemptto answer the following questions:
RQ1:Vulnerability Distribution. How are vulnerabilities dis-
tributed? Can it be used for hunting new vulnerabilities?
RQ2:Vulnerability Dependency. Why are vulnerabilities often-
timesfoundwithinashortcoderange?Isthereanydepen-
dencybetween vulnerabilities?
RQ3:Vulnerability Recurrence. Whydovulnerabilitiesrepeat-
edly occur in the same function? Is it a general case?
To this end, we analyze the collected vulnerability dataset as
follows.Wefirstassociateeachvulnerabilitywithitsresponsible
code commits, then localize the vulnerable code snippets related to
each vulnerability, and then build the call-graph for the vulnerable
code snippets. Further, based on the extracted information, we ana-
lyzethevulnerabilitydistributionoverspace,type,andresponsibledevelopers,aswellasthedependencybetweenvulnerabilitiesin
the call graphand the vulnerabilityrecurrence phenomena.
Wefindthat,thevulnerabilitydistributionfollowsthePareto
law [45] on the dimension of space (file, not function), type and
responsibledevelopers.Moreover,most(morethan60%)vulnerable
functionshaveat leastonevulnerableneighborfunctionlocated
in a 2-jump rangein the call-graph. In other words,most vulnera-
ble functions do not exist alone. We also find that, incomplete or
wrong patches for vulnerabilities are the most common reasons
for the existence of high-frequency vulnerable functions, whereas
the patching workflow ROPO (Report One issue and Patch One
position based on the reference PoC) is another important reason.
In summary, we make the following contributions.
‚Ä¢Large-scalevulnerability dataset. Aiming at studying the vulner-
ability distribution within projects, we spent 5 person months
effortstobuildalargest-to-datevulnerabilitydatasetregardinga
set of open source projects. We share this dataset to the public1,
to facilitate other researches.
‚Ä¢Thorough empirical study. Different from the prior work, our
study unveils the characteristics of vulnerability distribution
overseveraldimensionsincludingfile,function,typeandrespon-
sibledevelopers.Moreover,wealsoinvestigatethecorrelationof
vulnerabilitiesso as to uncover the causes of their presence.
‚Ä¢Practical insights. We present several practical insights based on
theanalysisresults.Inparticular,wefindthatmostvulnerabili-
ties do not exist alone. We also find that, imperfect vulnerability
patchesandthepatchingworkflowROPOaregeneralphenom-
ena, causingvulnerabilities repeatedlyoccur insome functions.
We also propose a solution to mitigate the ROPO issue.
‚Ä¢Newdiscoveries.Basedontheconcludedinsights,weproposea
solutiontousethemtoguidevulnerabilitydiscovery,andhaveap-
plied them to several vulnerability discovery solutions including
static analysis and dynamic fuzzing, and help them successfully
find10 zero-day vulnerabilities in target projects.
2 APPROACH
Figure2presentstheoverviewoftheapproachweusedinthis
empiricalstudy.First,weselectseveralpopularopensourceprojects
thatrepresentvaryingfunctionalities.Then,weaggregatemultiple
vulnerability data sources, including NVD/CVE and BugZilla, to
collectalldescriptioninformationofvulnerabilitiesassociatedwith
targetprojects.Wealsocrawlallcodecommitsoftargetprojects
from GitHub, to support detailed vulnerability analysis.
Further,weanalyzetherelationshipbetweenNVD/CVEvulnera-
bilityentriesandGitHubcommits,torecognizethecommitsrelatedtoeachvulnerability.Then,welocalizethevulnerablecodesnippets
and construct their call graphs. At last, we perform multiple analy-
sesonthesevulnerabilitiesandconcludemanytake-homemessages
for future research. Moreover, we develop proof of concepts based
on these findings to evaluate their practicality.
2.1 Target Selection
We select 5 popular open-source projects, written in C/C++
language, as our analysis object: FFmpeg [ 2], ImageMagick [ 3],
OpenSSL[ 6],PHP-SRC[ 7]andLinuxkernel[ 5].Ononehand,these
1https://github.com/twelveand0/CarrotsBlender
1548A Large-Scale Empirical Study on Vulnerability Distribution within Projects and the Lessons Learned ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea
Œ∏–´–†–°–ü–´–©–©–•–∞
Œ§”ìŒ•Œπ–ù–∞–ùŒ∏–´–®–®–°–ü–∞–•–´–™ Œ§”îŒ•Œπ–ù–∞–ùœÖ–Æ–´–ü–°–Ø–Ø–•–™–£ Œ§”ïŒ•œã–±–®–™–°–Æ–ù–û–•–®–•–∞–µŒ∂–™–ù–®–µ–Ø–• –Øœã–±–®ŒîŒ∫–™–∞–Æ–µŒº–•–∞ŒΩ–±–ûœÖ–Æ–´–¶–°–ü–∞–Ø
œã–±–®ŒîŒπ–°–Ø–ü–Æ–•–¨–∞–•–´–™ –≤–±–®–™–°–Æ–ù–û–•–®–•–∞–µ–ü–ù–®–®–£–Æ–ù–¨–§–ü–Æ–ù–≥–®
–Æ–±–®–°–Ø
Œ∏–´–™–Ø–∞–Æ–±–ü–∞–•–´–™
Œª–•–™–†–•–™–£–Ø
œÖ–Æ–´–´–¢–´–¢Œ∏–´–™–ü–°–¨–∞–ØŒ§”ìŒ•Œ∂–Ø–Ø–´–ü–•–ù–∞–•–´–™
Œ∂–™–ù–®–µ–Ø–•–Ø
Œ§”îŒ•œã–±–®–™–°–Æ–ù–û–•–®–•–∞–µ
œÅ–´–ü–ù–®–•–∂–ù–∞–•–´–™
Œ§”ïŒ•œãŒ∏Œº–≤–±–®–™–°–Æ–ù–û–•–®–•–∞–µ
–†–°–≤–°–®–´–¨–°–Æ–†–ù–∞–°
–∞–µ–¨–°–®–´–ü–ù–∞–•–´–™
–≤–±–®–™–°–Æ–ù–û–•–®–•–∞–µ–¨–Æ–´–¨–°–Æ–∞–•–°–Ø
ŒΩ–±–©–ù–™Œ¨–•–™–≤–´–®–≤–°–†Œ∂–™–ù–®–µ–Ø–•–Ø
œáœÜ”ïŒîœá–°–ü–±–Æ–Æ–°–™–ü–°
Œ∂–™–ù–®–µ–Ø–•–Ø
œáœÜ”îŒîŒπ–°–¨–°–™–†–°–™–ü–µ
Œ∂–™–ù–®–µ–Ø–•–Ø
œáœÜ”ìŒîŒπ–•–Ø–∞–Æ–•–û–±–∞–•–´–™
Œ∂–™–ù–®–µ–Ø–•–Ø
Figure 2: The overview of the empirical study
Table 1: Statistics of our dataset, including the number of
stars, forks and commits of each project obtained from
GitHub, and the number of associated CVE entries in NVD,as well as the number of vulnerabilities in our dataset, in-cludingthosewith CVEIDsandwithoutCVEIDs.
# Vulnerabilities in our datasetProject # Stars/Forks # Commits # CVEwith CVE w/oCVE total
FFmpeg 16,266/5,911 93,265 289 256 652 908
ImageMagick 3,083/543 15,202 458 280 476 756
OpenSSL 11,099/4,807 23,444 192 130 2 132
PHP-SRC 24,471/5,622 111,821 576 346 80 426Linux 79,149/27,578 841,891 2291 1716 0 1,716
Total 1,085,623 3,806 2,476 1,462 3,938
projects span a wide range of functionalities. FFmpeg is a multi-
mediaframework,ImageMagickisarepresentativeraster/vector
image file processing software suite, OpenSSL is an implementa-
tion of secure communication protocols, PHP-SRC is the official
interpreter for PHP language, and Linux kernel is one operating
system.Thediversityintuitivelyinvolvesdevelopersofdifferent
fieldsandvaryingprogrammingstyles.Therefore,moretypesof
vulnerabilitiescanbecovered.Ontheotherhand,everyprojecthas
at least hundreds of CVE entries in NVD [ 40], as shown in Table 1.
NotoriousvulnerabilitieslikeImageTragick[ 4],DirtyCow[ 56]
andHeartBleed[57]are all discovered in these projects.
2.2 Data Collection
Toobtainsufficientandcomprehensiveinformationforvulner-
abilities, we collect code commits from Github and vulnerability
entires from NVD/CVE for each project.Code commits
.WescrapeallcommitsfromtheselectedGithub
projectswithanimplementedwebcrawlerin8,000+LOCofPython.
The crawlerleverages GitHub developer APIs [ 20] and downloads
changed code, issues, pull requests, and responsible developers for
eachcommit.Toreducethedatavolume,wesetupacrawlrulethatfiltersoutthecommitswithoutmakinganysemantic-awarechange.Morespecifically,thechangestoconfigurationfiles,codecomments
and spacing are not substantially related to vulnerabilities, and
therebynotembodiedinourdataset.Afterapplyingthisrule,we
get a total of 1,085,623 commits as shown in Table 1.
Vulnerability entries . It is not always about security when a
developer makes a commit to the project. Functionality update,performanceoptimization,andsoftwarerefactoringareallpossible
reasons. As such, we have to first identify vulnerability-related
commits before the evaluation. To this end, we resort to NVD [ 40]
and CVE [ 34] which maintain a large corpus of vulnerabilities,
andrecognizetherealvulnerability-relatedcommits.NotallCVE
entriesareusefulinthistask,sowerestricttheentriesbyspecifyingthe vendors and products. For example, FFmpeg vulnerabilities canbedistilledbysearchingtheentrieswiththeproduct‚ÄúFFmpeg‚Äùand
vendor ‚ÄúFFmpeg‚Äù. In this way, 3,806 CVE entries are obtained.
2.3 Human-involved Analysis
There areseveral tasks requiringprofessionals‚Äô involvement as
indicated in Figure 2. In this study, we recruited 3 security experts,
all of whomhave more than 5-year experience invulnerability re-
search.Intotal,theyhavefounddozensofunknownvulnerabilities
inbothclose/open-sourcesoftware,andmorethan30vulnerabil-
ities have been assigned with CVE identifiers. One of them was
even listed in the 2016 MSRC Top 100 Security Researchers.
Cooperation. To ensure the correctness of the manual analysis
results, we employ a customized peer review process. At first, each
taskisanalyzedbytwoexperts.Thetaskfinishediftheycouldreach
an agreement. Otherwise, the third expert is involved to resolve
thedivergence.Ifshe/heagreeswitheitheroneoftheprevioustwo
experts,thenwefollowthesimplemajorityruletoyieldthefinal
analysisresult.Intheworstcase,threeexpertsreportthreedifferentresults,thenwefollowaconservativeprincipletoresolvetheissue.
More specifically, three experts will discuss together and yield a
conservative result. Take the CWE labelling task as an example,
given a CVE vulnerability, if three experts report three different
CWElabels,thenageneralizedCWElabelwhichcoversthemor
an ‚ÄôUNKNOWN‚Äô label will be yielded as the final result.
2.4 Data Processing
AsFigure2shows,weprocessthecollecteddatainthreesteps:
association analysis ,vulnerability localization andVCG (Vulnerabil-
ity CallGraph)construction. They are detailed as follows.
2.4.1 Association Analysis. We first try to associate CVE entries
withresponsiblecommits.Ifonecommitisfoundcontributingto
aCVEentry,weregarditasavulnerability-relatedcommit.Note
that, CVE entries in the NVD/CVE database often have references
to external links, including links of responsible commits in the
1549ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea Bingchang Liu, Guozhu Meng, Wei Zou, Qi Gong, Feng Li, Min Lin, Dandan Sun, Wei Huo, and Chao Zhang
(a) Files. (b) Functions.
Figure3:Albergdiagramsshowingthepercentageofvulner-
abilities over the percentage of vulnerable files/functions
foreachproject.The xaxisdepictsthepercentagesofvulner-
able files/functions sorted by the number of vulnerabilities
contained in descending order. The yaxis is the cumulative
percentages of vulnerabilities in these files/functions.
vulnerable project‚Äôs GitHub repository. With this guidance, we im-
plementatooltoparsethesereferencesandextractrelatedGitHub
commit links, and automatically build the connections to commits
for most CVE entries. For the remaining CVE entries, we spend
threepersonmonthstomanuallyinvestigatetheircorresponding
commits, by reviewing the detailed vulnerability descriptions frommultiple sources, including reports from Google OSS-Fuzz, RedHat
BugZillaand a wide range of security analysis blogs.
Dataquality. Tomakethevulnerabilitydataseterror-freeand
precise,weexertthefollowingefforts:1) Redundancyremoval.If
one vulnerability is associated with multiple commits, we check
whetherthecommitsareofthesamecontentbutappearindifferent
branches.Ifso,wejustretainthenewestcommit.2) Typecorrection.
Each vulnerability in the dataset is classified into a CWE category.
However, existing classification results are oftentimes wrong or
imprecise (cf. Section 3.2). We therefore manually correct the cate-
goryofeachvulnerability,followingtheCWE-1000classification
criteria. Take vulnerability CVE-2016-2549 in project Linux-kernel
asanexample,itislabeledwithCWE-20(ImproperInputValida-tion)andassociatedwiththecommit
2ba1fe7inNVD.However,
afterreviewingtheCVEdescription,RedHatBugZillacomments,
messages of the responsible commit and the corresponding patch,
wedeterminedthatitisactuallyadeadlockproblem,andreacha
consensusof labeling it as CWE-833 (Deadlock).
As depicted in Table 1, there are in total 3,806 vulnerabilities
recorded in the CVE/NVD database for the selected projects. After
the automated and manual association analysis, 2,476 CVE entries
are successfully associated with their responsible commits. Note
that,duringmanualanalysis,wealsofindalargenumberofcom-
mitsthatarecreatedforfixingsecuritybugsnotlistedinCVE/NVD.
We totally find 1,462 such commits, and associate them with un-
listed vulnerabilities, and put into our dataset as well.
In total, we obtain a cross-verified vulnerability database, includ-
ing3,938vulnerabilityentries.Eachentryhasbeenassociatedwith
responsible commits and related metadata information, including lo-
cations, the commit date and responsible developers of vulnerabilities.2.4.2 Vulnerability Localization. Afteridentifyingthevulnerability-
related commits, we seek to localize vulnerable code in a fine-grained granularity. By virtue of the unified diff format [
27], the
changes in commit mainly occur in two programming constructs‚Äì
function,and datastructure.Forachangefallingintoafunction,we
need to recover previous vulnerable code. This is fulfilled with the
built-in command‚Äú git reset ‚Äù, resetting the current HEAD to its
parentcommit.Additionally,wehandlethefollowingexceptions
duringanalysis:1)Ifacommitdoesnotdeleteanylinesandonly
hasadditions,wefirstidentifythekeyvulnerabilityvariable(s)influ-encedbytheaddedcodechunkandthendeterminethelocationsof
variable definition or reference as vulnerable points. 2) If a commit
adds a new function, this function is not treated as vulnerable.
2.4.3 VCG Construction. We aim to explore whether these vulner-
abilities have semantic relations in between. Here we use vulnera-
bilitycall graphto represent these relations.
Definition 1. A vulnerability call graph is a tuple ( F,V,Œ¥) such
thatFisa non-emptyfiniteset offunctions, Visa non-emptyfinite
sets of vulnerable functions where V‚äÜF, andŒ¥‚äÜF√óFis the
function call.
Weconductalightweightstaticanalysisontopof Doxygen[ 55]
to construct the call graph of these vulnerable functions. This tool
is context insensitive and cannot handle dynamic dispatch, a trade-
off between computation costs and gains. In the course of graph
construction, we address two challenging problems: same function
declarationsindifferentfiles byassigningauniqueidentifiertoeach
function, and polymorphic functions by taking into account fully
qualifiedfunctionnames.Itisworthmentioningthatsincesome
vulnerable functions are removed from the branch over time, they
would not be present in the constructed call graph.
3 RQ1. VULNERABILITY DISTRIBUTION
Inthissection,weconductananalysistorevealthevulnerability
distributioninmultipledimensions,particularlyspatialdistribution,
type distribution, and developer distribution.
3.1 Spatial Distribution
The study of vulnerability‚Äôs spatio-temporal distribution can fa-
cilitate the prediction of where and when vulnerabilities are prone
to occur. In this section, we take into account the collected vulner-
abilities as well as their locations and occurring dates, and tease
apart thecharacteristics,respectively.
Thespatialcharacteristicsaremeasuredintwogranularitylevels:
fileandfunction.Wesortthevulnerablefilesintermsofthenumber
ofcontainedvulnerabilitiesindescendingorder,andcomputethe
cumulativeprobabilitiesforvulnerabilitiesasshowninFigure3a.
For ImageMagick, the top 30% of vulnerable files account for about
80% of vulnerabilities, while for Linux, 60% of vulnerabilities are
discovered in the top 30% of vulnerable files.
This phenomenon raises a question whether it is because the
top30%offilesaccountforthelargerportionofcode.Therefore,to measure the code complexity, we employ four metrics widely
used in fault prediction [ 16,50,61]: non-blank lines of code (LoC),
cyclomatic,maximumlevelofindentationofblockswithinaregion
(MaxIndent)andthenumberofmagicnumbers.Weextractthefiles
1550A Large-Scale Empirical Study on Vulnerability Distribution within Projects and the Lessons Learned ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea
(a) Files (b) Functions
Figure4:Albergdiagramsshowingthepercentageofvulner-
able files (functions) over the percentage of complexity for
the projects. The xaxis presents a descendingly sorted list
of vulnerable files as per the number of vulnerabilities con-
tained.The yaxisisthecumulativepercentageofcodecom-
plexitiesbased on four metrics.
consisting of vulnerabilities,and compute the fourmetrics. If one
file has more than one vulnerability, we average the metric values
forthisfileintermsofthenumberofvulnerabilities.FromFigure4a
and Figure 3a, the vulnerability number and code complexity have
alinearrelationwherethevulnerabilitynumberismonotonically
increasing along with the increase of code complexity. Based on
the above investigation, we draw the following finding.
Finding 1. A small number (30%) of vulnerable files account for
most (66%) of vulnerabilities. However, these files only contribute
40%ofcodesizeandcomplexities.Therefore,ahighercomplexityof
codecannotnecessarilyinducemorevulnerabilities,andcomplexity
metricsindefectpredictionceasetobeingeffectiveforvulnerabilities.
Samewiththeanalysisofvulnerablefiles,weobservethatthese
vulnerabilities do not obviously conform to the same phenomenon
with regard to vulnerable functions, that is, top 30% vulnerable
functions only contribute 50% vulnerabilities. Figure 3b shows the
vulnerabilitynumberandfunctionnumberexhibitalinearrelation.
In addition, Figure 4a depicts that the complexity for each function
isrelatively evenwithothers. Asaresult, weconcludethespatial
distributionwithregard to vulnerable functions as follows.Finding2.
Withtheconsiderationofvulnerablefunctions,top30%
vulnerable functions account for 50% vulnerabilities, not as obviously
as vulnerable files do.
3.2 Type Distribution
The type of vulnerabilities is labelled by NVD, following the
CWE[35]classificationsystem.AsSection2,wehavescrapedall
meta information of vulnerabilities including type. However, by
manuallyreviewing this information, we find that:Finding3.
There are 9.6% erroneous, 10.9% imprecise and 7.2% miss-
ing problems in type labelling of our investigated vulnerabilities,
whichhave been reported to NVD.
Thethree problems are detailed as follows.(a) Alberg diagram showing the
cumulative number of vulnera-
bilities over that of types.(b) The number of vulnerabili-
ties of the top 3 types changesover time.
Figure 5: Type distribution diagram
(1)Erroneous: SomeCVEentiresareassignedwithwrongCWEs.
For example, by examining the description and code of CVE-
2009-2767[ 36],itissortofCWE-476(NullPointerDereference).
However, it is wrongly classified into CWE-119.
(2)Imprecise: There exist some CVE entries that are assigned
with imprecise CWEs, i.e., CWEs cannot describe their detailed
classification.Forexample,CVE-2010-4250[ 37]isbundledwith
CWE-399(ResourceManagementErrors).However,withour
analysis, it can be further classified into a child category CWE-
401 (Memory Leak), which is more precise.
(3)Missing: Some CVE entries do not connect to any CWEs, such
as CVE-2015-3636 [38].
Weovercometheaboveproblemsbyrelyingonarigorousreview
and remediation by our professionals. For each project, we sort the
types as per the number of contained vulnerabilities in descending
order and calculate the cumulative percentage of vulnerabilities
along with type. Figure 5a shows that 20% of types contain 70%of vulnerabilities. Besides, we list the top 3 types of each project
asshowninTable2.Fromthistable,the5projectsvaryfromthe
most3types.ForFFmpeg,integeroverflow(CWE-190)andnumeric
errors(CWE-189)arewidelypresent.ThatisbecauseFFmpegisa
multimediaencoding/decodinglibrary,whichoriginallyinvolves
a large number of arithmetic operations. For Linux, CWE-264 is
amongthetop3types.Itimpliesthatprivileges,permissionsand
access controls are the most important functionalities offered byan operating system kernel. Massive amounts of code are imple-mentedtoprotectthesystem‚Äôsresourcesand,however,inducea
considerablenumber of vulnerabilities.
Finding4. ForoneC/C++investigatedproject,70%ofvulnerabilities
fallinto20%oftypes;thetop3typesaccountfornearly50%ofvul-
nerabilitiesaveragely.Moreover,themostlikelyvulnerabilitytypes
existing in one project largely depend on the project‚Äôs core functional-
ities andprogramming languages.
3.2.1 Changes of Top Types over time. How do the types with the
mostvulnerabilitieschangeovertime?Weevaluatethistemporal
effect by counting the detected vulnerabilities of the top 3 types
over years and present the change curve in Figure 5b. From the
figure, we conclude that:
1551ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea Bingchang Liu, Guozhu Meng, Wei Zou, Qi Gong, Feng Li, Min Lin, Dandan Sun, Wei Huo, and Chao Zhang
Table 2: The most 3 vulnerability types in each project.
Project 1st Type 2nd Type 3rd Type
FFmpeg CWE-190 CWE-119 CWE-189
ImageMagick CWE-401 CWE-119 CWE-457OpenSSL CWE-310 CWE-119 CWE-399PHP-SRC CWE-119 CWE-416 CWE-20Linux CWE-457 CWE-264 CWE-119
Finding5. Thetoptypesinaprojectarenotdramaticallyaffectedby
time,andwillremainthemajorityinfuture.Itimpliesthatsecurity
analystscanspendprioritizedeffortsauditingvulnerabilitiesofthe
popular types based on the historical data.
3.3 Developer Distribution
Vulnerability developer: In this paper, we regard non-blank
andnon-commentlinesdeletedinavulnerability-relatedcommitas
thevulnerablecode,andforthecommitsthatonlyinsertlinesofcode,
correspondingcodewillbemarkedmanually.Developerscreatingsuch
code are thereby responsible for the introduction of vulnerabilities.
Inthissection,wemakeuseofcommand‚Äú git blame ‚Äùtoiden-
tify the developer(s) for each vulnerability. For each developer, we
count the number of vulnerable lines introduced or contributed by
him/her.Wesortthedevelopersinaprojectasperthenumberof
theirintroduced vulnerable lines in descending order.
From Figure 6, we can see all vulnerabilities of a project are
introducedbylessthan10%ofitsdevelopers.Itmeansthatmost
ofthedevelopersseldomintroduceanyvulnerabilities.Thecode
proportions contributed by vulnerability developers vary from 60%
to nearly 100%. In other words, for a certain project, there exist
suchdevelopersthatcontributelittleproportionofcodelinesbut
introduce more vulnerabilities.
Finding 6. Almost all of the vulnerabilities are introduced by less
than10%ofdevelopersforaproject.Such10%developerscontribute
from 60% to nearly 100% code, which varies cross projects depending
on the number of their developers.
3.3.1 Developers‚Äô Type Preference. Aredevelopers pronetointro-
ducing vulnerabilities of the same type? If so, security analysts
can try to discover new vulnerabilities of the same type in other
projectstowhichthedevelopercontributes.Inthemeantime,we
canidentify theinexperienceddevelopers ofsecureprogramming.
To this end, we compute the proportion of vulnerabilities with the
top1typeandthetop30%oftypestoallvulnerabilitiesintroduced
by a developer, shown in Figure 7a and 7b. For FFmpeg, 10% of
developersintroduceonlyonetypeofvulnerabilities,andtheintro-
duced vulnerabilities merely take up a small portion. There are 21
developers who introduce at least 10 vulnerabilities in project FFm-
peg.Further,wefindthattheyareofvarioustypes,andover60%
of them belong to the top 3 types. We conclude:
Finding 7. Although we cannot speculate the type preferences of
the developers who introduce <10 vulnerabilities, it does exist in the
remainingmoreproductivedevelopers.Therefore,thisoffersaguid-
anceforprioritizedcodereviewintermsofthetypesofvulnerabilities
likelyto be introduced by a certain developer.4 RQ2: VULNERABILITY DEPENDENCY
Securityresearchersoftenfind0-dayvulnerabilitiesincloseprox-
imityto1-dayvulnerabilities.Forexample,Jia etal.[28]foundtwo
new Microsoft Word vulnerabilities when generating the PoC of
CVE-2014-1761.TheillustrativeexampleinFigure1alsoshowsthat
thisphenomenonisnotjustbyaccident.Toexplainwhyvulnera-
bilitiesoftenappearinneardistance,wemeasuretheirdistances
and buildthesemanticrelations between vulnerabilities, .
4.1 Vulnerability Distance
Wehaveconstructedvulnerabilitycallgraphsforeachproject
andgroup vulnerabilitiestogetherin Section 2.Givenone vulner-
abilitycallgraph G(F,V,Œ¥)(asDefinition1)andtwovulnerable
functions v1andv2, wherev1,v2‚ààV, the distance between v1
andv2is computed by:
d(v1,v2)=argmin
n|{f1,...,fn}|‚àí1
wherefi‚ààF,f1=v1,fn=v2, and(fi,fi+1)‚ààŒ¥or
(fi+1,fi)‚ààŒ¥. The minimal value for nis 2, which means the
twovulnerablefunctionshaveadirectcallrelationshipinthecall
graph. If the distance is 2, there must be anintermediate function
connectingthe two vulnerableones. Wecompute thedistance by:
firstconvertingthedirectedvulnerabilitycallgraphintoanundi-
rected graph by eliminating the arrows of calls; then computing
the shortestpathforthese two vulnerable functions in the graph.
In light of the distance between vulnerabilities, we can slice one
call graphinto smallclusters.In particular, we define:
Definition 2. Ak-cluster Cis a slice from the entire call graph
G,whileforallvulnerablefunctions v1,v2‚ààC,d(v1,v2)<=k,and
for every vulnerable function v/prime‚ààG/C,d(v1,v/prime)>k .
We slice the VCG of a project into a number of 1-clusters and 2-
clusters, respectively. Then we count the number of vulnerabilities
in these clusters to check the percentage of vulnerabilities they
contribute.WeplotFigure8aand8btodemonstratethecontribution
rates of 1-cluster and 2-cluster, respectively. In Figure 8a, only
FFmpeg and ImageMagick have the phenomenon that 30% largest
1-clustersaccountformore than 60% vulnerabilities.
But for the other 3 projects, such clustering phenomenon is not
obvious.Moreover,wecanseethatabout20%ofallfunctionscan
be sliced into 1-clusters for a project. As for 2-cluster, the largest
2-clusterintheprojectsconsistsof80%-100%ofthevulnerabilities.
Based on the analysis, we conclude:
Finding 8. The locations where vulnerabilities emerge are very con-
centrated. For each investigated project, more than 80% of vulnerable
functionsassemblein one single 2-cluster.
4.2 Patterns of Dependency
Intheprevioussection,weobtainaprimary2-clusterforeach
project. The primary 2-cluster contains 80% - 99% of vulnerable
functions,however,itaccountsforabout50%ofallfunctionsofa
project.Inordertofurtherstudytherelations,weformulatefour
patternsof dependency relations:
‚Ä¢Common Parent: two vulnerable functions have a common
predecessornode(function)inthecallgraph.Thepredecessor
functioncanbe either vulnerable or non-vulnerable.
1552A Large-Scale Empirical Study on Vulnerability Distribution within Projects and the Lessons Learned ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea
(a) FFmpeg. (b) ImageMagick. (c) PHP-SRC. (d) OpenSSL. (e) Linux.
Figure 6: Alberg diagrams showing the percentage of LOCs over the percentage of all developers for the projects. Red line
represents vulnerable lines introduced by developers.
(a) Num. of vulnerabilities with
30% types versus developers for
each project.(b) Num. of vulnerabilities with
the most type versus developersforeach project.
Figure 7: Developer distribution diagram
(a) k=1 (b) k=2
Figure8:Albergdiagramsshowingthepercentageofvulner-
abilitiesover the percentage of k-clusters for each project
‚Ä¢Common Child: two vulnerable functions have a common suc-
cessor node (function) in the call graph. Here we consider the
patternonlywhen thesuccessoris also vulnerable.
‚Ä¢OneJumpCall: onevulnerablefunctioncallsanintermediate
non-vulnerable function which has a direct call to the other
vulnerablefunction.
‚Ä¢DirectCall: onevulnerablefunctionhasadirectcalltotheother.
One vulnerability-related commit may alter multiple functions
so that these functions are all tainted with the vulnerability.
Finding 9. More than 60% vulnerable functions of a project have
at least one basic call-relation to another vulnerable function with
different vulnerabilities.
AsshowninFigure10,foreachproject,wecountthenumber
of vulnerable function pairs according to each basic dependency
relation. Further, we calculate the intersection of four relation setsin which an element is a vulnerable function pair. For example, in
FFmpeg, there are 233 vulnerable function pairs that have common
parentrelation;amongthese,threepairsalsohave commonchild
relation,anotherthreepairshave directcall relation,twopairshave
one jump relation, one pair has direct call andone jump relation at
the same time. Besides, we count the total number of vulnerable
functionsintheunionoffourdependencyrelationsets.Forexample,
72%vulnerablefunctionshaveatleastonebasiccallrelationwith
another vulnerable function and they have different vulnerabilities.
Inall,formorethan60%vulnerablefunctions,thereexistsan-
other vulnerable function in the call graph between which the
distance is no more than 2. It inspires that one is likely to discover
newvulnerabilitiesinafunctionthathastheabovetypesofdepen-
dency relations with the already-known vulnerable functions.
4.3 Semantics of Dependency
In this section, we intend to identify what code structure and
relations exist between vulnerable code blocks.
4.3.1 Manual Analysis. Givenavulnerablefunctionpair( v1,v2)
complyingwithoneofthefouraforementioneddependencypat-
terns, three experts spent six person months to conduct a rigorous
and manualcodereview procedure, in order to determinethe cor-
relations between vulnerable code in v1and thatin v2.
For example, in Figure 9, CVE-2013-0863 resides in the function
old_codec47 and CVE-2013-0877 occurs in old_codec37 . Both
vulnerable functions are called by a commonparent. By reviewing
the code at call sites, we determine that there are four types of
relationsbetweenthem:(1)thesevulnerablefunctionsareintwo
parallel switch-case statements to decode different video types; (2)
bothvulnerabilitiesarecausedbythesamemissingcheckonthe
third parameter of function rle_decode ,i.e., they have similar op-
erations; (3) both vulnerability are related to the same key variable
decode_size, which holds some values read from input; and (4) they
both deal with multimedia files of SANMformat.
4.3.2 Semantic Relations. Finally, we identify 10 types of semantic
relations between vulnerable code as follows.
‚Ä¢R1:twovulnerablefunctionsareparallelfromtheviewofcon-
trolflow.Inparticular,twofunctionsmaybecalledfromdiffer-
entcasesinside a switchstatement, such as CVE-2013-0845
(FFmpeg:0ceca26)and CVE-2012-2775(ffmpeg:9d3032b).
‚Ä¢R2:vulnerablecodeintwofunctionsexecutessimilarorsame
operations. e.g., CVE-2013-0863 and CVE-2013-0877.
‚Ä¢R3:vulnerability-related code in two functions has similar or
samecodestructureinsyntax,suchasOSS-FuzzissueNO.1903[ 23]
(FFmpeg:58f8cd4)and NO.1506 [22] (FFmpeg: 5ac17f1).
1553ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea Bingchang Liu, Guozhu Meng, Wei Zou, Qi Gong, Feng Li, Min Lin, Dandan Sun, Wei Huo, and Chao Zhang
static int process_frame_obj(SANMVideoContext *ctx)
{
‚Ä¶
switch (codec) {
case 1:
case 3:
return old_codec1(ctx, t op, left, w, h); break;
case 37:
return old_codec37 (ctx, top, left, w, h);break;
case 47:
return old_codec47 (ctx, top, left, w, h); break;
‚Ä¶
}static int old_codec37(SANMVideoContext *ctx,
int top, int left, int width, int height) {
‚Ä¶.
+  if (decoded_size > height * stride - left - top * stride) {
+        decoded_size = height * stride - left - top * stride;
+        av_log(ctx->avctx, AV_LOG_WARNING, +                   "decoded size is too large\n");
}
‚Ä¶switch (compr) {
‚Ä¶
case 2:
if (rle_decode(ctx, dst, decoded_size ))
return AVERROR_INVALIDDATA;
‚Ä¶}‚Ä¶}CVE-2013-0877;  Commit-365270a
static int old_codec47(SANMVideoContext *ctx, 
Int top, int left, int width, int height) {
‚Ä¶
+   if ( decoded_size > height * stride - left - top * stride) {
+        decoded_size = height * stride - left - top * stride;
+        av_log(ctx->avctx, AV_LOG_WARNING, 
+                    "decoded size is too large\n");
}
‚Ä¶
switch(compr){
‚Ä¶
case 5:
if (rle_decode(ctx, dst, decoded_size ))
return AVERROR_INVALIDDATA;
‚Ä¶}‚Ä¶.}CVE-2013-0863; Commit-62c9bed
call-to
Figure 9: Example: Cross-function Semantic Relation Manual Analysis.
224235 244
512
300
050 112
32 PJ D
C
(a) FFmpeg10801316 394
11557130
17029812
1524341 53224
539152 PJ D
C
(b) ImageMagick3325 21
110
100
000 00
10 PJ D
C
(c) OpenSSL372103 64
543
611
134 65
80 PJ D
C
(d) PHP-SRC
Figure 10: Venn diagrams showing the statistics of dependency patterns. An element is a pair of vulnerable functions that
follows some Call-Relation Unit.
‚Ä¢R4:the variables involved in vulnerabilities have data flow rela-
tioninbetween.e.g.,OSS-FuzzissueNO.7420(FFmpeg:dce80a4)
andNO.4415 (FFmpeg: 1d0817d).
‚Ä¢R5:both the functions involve the same variable(s). e.g., CVE-
2015-6818and CVE-2017-7863.
‚Ä¢R6:thevariablesinvolvedbyvulnerabilitieshavecontrolflow
relation in between. e.g., OSS-Fuzz issue 2873 (ffmpeg: 6f03ffb)
and3444(ffmpeg:dcf9bae).
‚Ä¢R7:vulnerability-related code in two functions are under the
samemacrocondition.Forexample,OSS-Fuzzissue1471(ffmpeg:
3a0ff78)and 1878(ffmpeg:6b9cb5d).
‚Ä¢R8:twofunctionsareusedtodealwiththesamedataformats.
e.g., CVE-2013-0863 vs. CVE-2013-0877.
‚Ä¢R9:two functions are patched in one commit. e.g., OSS-Fuzz
issue5894(FFmpeg:647fa49).
‚Ä¢R10:two functions are called in the same caseof aswitch. e.g.,
OSS-Fuzzissue 3444(3a0ff78)and 2581(2886142).
Figure 11 shows an illustrative example about these semantic
relations in a 2-cluster from project FFmpeg. Function aac_decode
_frame_int hasR1relationwithfunction decode_ics .Thecode
shows thevulnerability of aac_decode_frame_int occurs within
acaseblock of a switchstatement, while function decode_ics
is called from another caseblock. So the two vulnerabilities are
parallelintheviewofcontrolflow.Boththevulnerabilities‚ÄúOSS-
Fuzzissue1471‚Äùin subband_scale and‚ÄúOSS-Fuzzissue1878‚Äùin
noise_scale are caused by an overlarge left-shift offset, inducing
integeroverflow.Sothesetwofunctionshave R2relation.Atthe
sametime,relatedcodeblocksofthesetwovulnerabilitiesaresimi-
larin syntax,indicating R3relation.Besides, subband_scale and
noise_scale arebothcalledinfunction decode_spectrum_and_11
1
121
21
1314
2
4
3 latm_decode_frameread_audio_mux_elementread_payload_length_info
push_output_congurationaac_decode
_frame_int
decode_cce
spectral_to_sampleapply_tns
apply_ltpdecode_ics
decode_ics_info
apply_prediction
predictdecode_spctrum_and _dequantsubband_scale
noise_scale
apply_dependent_coupling_xed
apply_independent_coupling_xedround
R9
R9R4
R1
R1R2
R6
R10 R10
R5,R6R2,R3R2R3,R4,R7
R2,R3,R5
R3R4
Figure 11: A simplified 2-cluster example from project FFm-
peg with multiple semantic relations between functions. Aredsolidcirclerepresentsavulnerablefunctionwithanum-ber inside counting the contained vulnerabilities; A hollowcircle represents a non-vulnerable function; A black arrowrepresentsthecallrelationbetweenfunctions;Adottedline
witha label represents semantic relations between them.
dequant
, and the vulnerability-related variable in subband_scale
hasadataflowtothevulnerability-relatedvariablein noise_scale ,
which denotes R4relation. There is no data flow between function
apply_dependent_coupling_fixed andapply_independent_c
oupling_fixed .Buttwovulnerabilities‚ÄúOSS-Fuzzissue1851‚Äùand
‚Äúissue 1762‚Äù in these functions manipulate the same variable of the
parameterobject,so they have R5relation.
Because the analysis is time-consuming and labor-intensive, we
just tookFFmpegas an example and sampled 324 vulnerablefunc-
tionpairswiththesesemanticrelations,Accordingtotheresults
summarizedinTable3,most(70.5%)ofvulnerablefunctionpairs
1554A Large-Scale Empirical Study on Vulnerability Distribution within Projects and the Lessons Learned ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea
Table 3: Inter-function semantic relations underlying the
four patterns from project FFmpeg. Notedly, a pair of vul-
nerablefunctionsmay possess multiple relations.
Relation# Common
Parent# Common
Child# Direct
Call# One
Jump# Total
R1 64 0 4 5 73
R2 86 10 13 4 113
R3 33 1 7 1 42
R4 42 5 14 11 72
R5 48 4 9 5 66
R6 25 10 21 21 77
R7 6 0 1 1 8
R8 170 19 36 16 241
R9 6 2 7 0 15
# Total
of Pairs241 19 40 24
aredueto processingthesame fileformat(i.e., R8).ForCommon-
Parentrelation, 26.6% of function pairs have Parallel Control Flow
relation, while pairs with the other three relations rarely have R2
relation.Forvulnerabilitiesfrom Common-Parent andCommon-
Childpairs,R2isthemostcommon.Whileforvulnerabilitiesfrom
Direct-Call andOne-Jump pairs,R6is the most common.
5 RQ3: VULNERABILITY RECURRENCE
It is observed that some functions are constantly found with
new vulnerabilities and hence have undergone several security
fixings. We call them high-frequency vulnerable functions and
inthissection,wecomputetheirstatistics,measuretheduration
betweentwodisclosedvulnerabilities,anddemystifytheprimary
reasons of this recurrence phenomenon.
5.1 High-frequency Vulnerable Functions
Foralltargetprojects,on average25.5% of functionshave been
discovered with at least 2 vulnerabilities.
Statistics . For each project, we compute the proportion of such
functions in the set of vulnerable functions, shown as Column 2 in
Table 4. The proportions of high-frequency vulnerable functions
varyfrom12.7%(OpenSSL)to38.3%(ImageMagick).Inaddition,
the average, median, maximal and minimal numbers of vulnerable
functions are also presented from Column 3 to 6. More specifically,
function mpeg4_decode_sprite_trajectory in FFmpeg has been
foundwith13 vulnerabilities. The function SPL_METHOD(Array,u
nserialize) has been found with 8 vulnerabilities.
Duration . We investigate the time window during which two suc-
cessive vulnerabilities are discovered in the same function, and
presentthe resultin Table5. ForOpenSSL, theaveragetime inter-
valbetweenthedisclosuredatesoftwosuccessivevulnerabilities
inthesamefunctionis1024.16days,andthemedianvalueis671.57days.However,forImageMagick,theaveragetimeintervalis65.62
days and the median is only 9.54 days. On average, the recurrence
phenomenonhappensinafunctionwitha514.95-dayinterval.Itis
worthmentioningthatthetimeintervalcanbe0.Thisisbecause
multiplevulnerabilitiesaresometimespatchedinthesamecommit,
e.g., CVE-2013-7267 and CVE-2013-7266.
Finding 10. The recurrence phenomenon occurs in a considerable
number (25.5%) of functions with 3 times on average. However, the
interval between two security fixings can be up to 514.95 days.Table 4: Statistics of high-frequency vulnerable functions.
Project% of high-frequency
functionsAvg. Median Max. Min.
FFmpeg 27.1 2.59 2 13 2
ImageMagick 38.3 4.85 3 36 2
OpenSSL 12.7 2.59 2 6 2
PHP-SRC 17.2 2.62 2 8 2
Linux 12.8 2.37 2 8 2
Average 25.5 3.00 2.2 14.2 2
Table 5: Statistics of time interval when two successive vul-
nerabilitiesare discovered in a same function.
Project Avg. (day) Median (day) Max. (day) Min. (day)
FFmpeg 191.52 29.28 2245.15 0.0
ImageMagick 65.62 9.54 1123.38 0.0
OpenSSL 1024.16 671.57 4612.09 0.0
PHP-SRC 496.87 189.62 4005.45 0.0
Linux 796.57 457.29 4661.33 0.0
Average 514.95 271.46 3329.48 0.0
œñœ©œòœä”≤”∞”±”≥œä”¥”±”≥”≥œâœñ—â—á—á—É—éœä”∑–æ”±”∂”≥–ø”∏
”Ü”ÜŒ¨”ì”í”ô”õŒë”ì”ö”≠”ì”í”ö”ñŒë”î”ï”Ü”Ü–≤–´–•–† ”Ä–¥–©–®”Ä–ü–§–ù–Æ–ù–ü–∞–°–ÆŒπ–ù–∞–ùŒΩ–ù–™–†–®–°–Æ Œ§
Œï
”ì”í”ö”ò Œ¨”Ä–¥–©–®”Ä–ù–†–†”Ä–∞–´”Ä–•–™–¢–´Œ§–¨–ù–Æ–Ø–°–ÆŒë–¨–ù–Æ–Ø–°–ÆŒ¨”π–®–∞–ù–£–ØŒ®–¨–ù–Æ–Ø–°–ÆŒ¨”π–®–°–≤–°–®Œ¨”ìŒ©”≠–¨–ù–Æ–Ø–°–Æ Œ¨”π–∞–´–¢–¢–Ø–°–∞Œ•Œí
”ì”í”ö”ô”≠–•–¢Œ§—ä–ª—å—ç–ø—åœä‘ó—Ü–ø—ê–ø—Ü ”∂”≤œçœÇœÅ”ÄœÇŒ∂œçœÅŒ∫œãŒ∫œÅŒ•Œ¶
”ì”í”ö”ö”≠œÇŒ∂œÄŒ∫”ÄœàœâŒπ”ÄœèœãŒ∂œÅŒ§–∞–ù–£Œ•Œí
Œï
œñœ©œòœä”≤”∞”±”∂œä”¥”∂”≥”πœâœñ—â—á—á—É—éœä–æ–Ω–Ω–æ–ª”∏”∏
”Ü”ÜŒ¨”õ”ö”ñŒë”ô”≠”õ”ö”ñŒë”ô”Ü”Ü–≤–´–•–† ”Ä–¥–©–®”Ä–ü–§–ù–Æ–ù–ü–∞–°–ÆŒπ–ù–∞–ùŒΩ–ù–™–†–®–°–Æ Œ§
Œï
”õ”ö”ôŒ¨–•–¢Œ§–¨–ù–Æ–Ø–°–ÆŒ¨”π–®–°–≤–°–®”∂”≤œçœÇœÅ”ÄœÇŒ∂œçœÅŒ∫œãŒ∫œÅŒ•Œ¶
”õ”ö”ô”≠–•–¢Œ§—ä–ª—å—ç–ø—åœä‘ó—Ü–ø—ê–ø—Ü ”∂”≤œçœÇœÅ”ÄœÇŒ∂œçœÅŒ∫œãŒ∫œÅ“å“å —ä–ª—å—ç–ø—åœä‘ó—Ü–ø—ê–ø—Ü ”π”íŒ•Œ¶
”õ”ö”ö œÇŒ∂œÄŒ∫”ÄœàœâŒπ”ÄœèœãŒ∂œÅŒ§–∞–ù–£Œ•Œí
Œï
Figure 12: Vulnerability recurrence example in PHP-SRC
5.2 Primary Reasons
What‚Äôsthereasonbehindtherecurrencephenomenonandwhat
are the semantic relations between vulnerabilities within the same
function?Toanswerthesequestions,wemanuallyanalyze1,095
vulnerabilitiesoccurredin348high-frequencyvulnerablefunctions
from project FFmpeg, OpenSSL andPHP-SRC and ImageMagick.
5.2.1 Manual Analysis. Threeanalystsweredesignatedtoidentify
thecausesoftherecurrentphenomenonandtheintra-functionrela-
tions between vulnerabilities. Taking Figure 12 as an example, two
vulnerabilitieswerefoundinonefunction _xml_characterDataH-
andler.Thefirstvulnerability(CVE-2013-4113),whichcausesheap
corruption,waspatchedwithasanitycheckinLine1087.However,
thissanity checkhas beenproved incomplete,since aheap buffer
over-read could happen if the integer variable parser->level is
zeroorless.Byusingacustomizedcodechangetrackerbasedon
Git(Section2.4.2),wefindthatanothercommitdccda88fixedthis
problematic patch. After that, one analyst determines the cause of
the latter vulnerabilityas incomplete fix.
5.2.2 Semantic Relations. Wespend3personmonthsidentifying
thefollowingsemanticrelationsbetweenvulnerabilitieswithinthe
same function:
‚Ä¢R1:Incompletefixorfixintroduction. Anothervulnerability
occursbecausethefixtotheformervulnerabilityisincompleteor
1555ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea Bingchang Liu, Guozhu Meng, Wei Zou, Qi Gong, Feng Li, Min Lin, Dandan Sun, Wei Huo, and Chao Zhang
it introduces new risks. e.g., CVE-2016-6307 (openssl: acacbfa)
vs. CVE-2016-6309(openssl:4b390b6).
‚Ä¢R2: Same or Similar Vulnerability Pattern . Two vulnera-
bilities have similar or same vulnerability pattern. e.g., both
CVE-2015-6835(php-src:df4bf28)andCVE-2016-6290(php-src:
8763c60)are induced because of improper exception handler.
‚Ä¢R3: Sameor Similar Code Structure .Thecodeblockswhere
vulnerabilitiesexistaresameorsimilarinsyntax.e.g.,CVE-2014-
3515(php-src: 88223c5)vs.CVE-2016-7417(php-src: ecb7f58).
‚Ä¢R4:InvolvedSameVariable. Twovulnerabilitiesaredirectlyor
indirectlyrelatedwiththesamevariable.Forexample,CVE-2019-
9022 (php-src: 8d3dfab) vs. CVE-2014-4049 (php-src: b34d784).
‚Ä¢R5: Parallel Control Flow. Related code is located in parallel
branches, such as different switch-cases. e.g., CVE-2012-0852
(ffmpeg:6087080)vs.CVE-2013-0844(ffmpeg:f18c873)
Table6liststhenumberofdetectedrelationsexistingbetween
vulnerabilitiesin the four projects. Based on the result, we find:
Finding11. Incompletefixandfixintroductionarethemajorreason
why vulnerabilities repeatedly occur in the same function. It implies
that some developers likely fail to fix all existing vulnerabilities or
makenew ones stemming from the patching code.
This problem happens many times as observed in our dataset,
for instance CVE-2016-6307 (OpenSSL: acacbfa) vs. CVE-2016-
6309 (OpenSSL: 4b390b6) and CVE-2013-4113 (PHP-SRC: 7d163e8)
vs. CVE-2016-4539 (PHP-SRC: dccda88). It raises an alarm for the
developers that they need to pay more attention to the security
ofpatches,avoidingintroducingadditionalvulnerabilities.Inthe
meantime, this finding can motivate researchers to analyze and
evaluate the security of patches, just as UC-Klee [43].
Wealsoobservethat R2occurswiththesecondmostfrequency.
This can explain why works like SPAIN [ 59] can be effective in de-
tectingsimilarvulnerabilitiestosomeextent.DifferentfromSPAIN,
which focuses on discovering inter-function similar vulnerabilities,
we observe that there exist many similar vulnerabilities within one
function. This conclusion has at least two benefits: on one hand, it
stresses the importance of research on similar or cloned vulnerabil-
ities [31]. On the other hand, it can be used by security researchers
to quickly detect other vulnerabilities in a cost-effective way.
Moreover,weobservethat R3occursinalloftheprojects.Iftwo
blocks of code are of a high similarity, they can be easily matched
by code clone techniques intuitively . However, according to our
investigation, developers prefer not to perform such a code search
andmerelyfixthereportedvulnerabilities.Morespecifically,whena developer tries to fix a reported vulnerability, she/he only locates
the root causes perhaps with PoCs and then makes all the neces-
sary changes to code to eliminate the reported vulnerabilities. But
thedeveloperfailstoauditothersimilarorclonedcodethatmay
containsimilarvulnerabilities.
It sheds light on the necessity of a robust vulnerability response
process, from where software engineering practitioners can re-
search to improve the process, figure out more vulnerability detec-
tion solutions and empirically study the features of vulnerabilities.
Finding12. Thereexistsa"ReportOneandPatchOne"(ROPO)prob-
lem commonly in vulnerability fixing. It reveals one weakness of theTable6:Intra-functionsemanticrelationsofvulnerabilities
withinonefunction
Relation # FFmpeg # ImageMagick # OpenSSL # PHP-SRC
R1 83 53 6 40
R2 66 32 5 16
R3 9 6 3 10
R4 39 8 0 10
R5 4 9 0 7
pcd::c@@
ReadPCDImage
quantum-private::c@@
ScaleCharToQuantum
pixel-accessor::c@@
SetPixelBluedistort::c@@
RotateImagepcd::c@@
DecodeImageimage::c@@
CloneImage
image::c@@
DestroyImage
image::c@@
SetImageExtent
memory::c@@
RelinquishMagickMemorymemory::c@@
AcquireQuantumMemory
CVE-2017-18251
COMMIT:2cf74b5
COMMIT:3d9bb55CVE-2016-7516
CVE-2016-5688
CVE-2017-9501
COMMIT:7f52c1fCOMMIT:90c0a13COMMIT:38b0717
COMMIT:3e7eda2
Figure13:Illustrativegraphfornewvulnerabilitydetection
vulnerability fixing process, and inspires many future research di-
rections such as the enhancement of patching process and efficient
detection of similar or cloned vulnerabilities.
6 APPLICATION OF FINDINGS
Our findings have a great potential for hunting new vulnerabili-
ties.Toevaluatetheirefficacy,weimplementtwoproof-of-concepts
thatintegratetheabove findings.
Guided Code Review. We take ImageMagick as an example.
According to Finding 5, the type CWE-401 (Memory Leak) con-
sists of the largest number of vulnerabilities, and it sustainedly
contributes the majority of vulnerabilities. Hence we prioritize our
efforts to explore new Memory Leak vulnerabilities. Further, ac-
cordingtoourobservation,mostofMemoryLeakvulnerabilitiesinImageMagickarecausedbymissingthememoryfreeingoperation
in exception handlers. We implement a prototype to search simi-lar patterns. Finding 8 implies that most of vulnerable functions
are adjacent with each other in the vulnerability call graph. So
we prioritize our review targets to such functions that have de-
pendency relations (e.g., Common Parent)with known vulnerable
functions.Figure13illustratesjustthecase.Function DecodeImage
hasCommon Parent ,Common Child andOne Jump relation
withothervulnerablefunctions.Usingthesefindings,wesuccess-
fully found a new Memory Leak vulnerability (CVE-2019-7175 [ 1])
inDecodeImage .Moreover,wefoundanother4newvulnerabilities
(CVE-2019-7395,CVE-2019-7396,CVE-2019-7397,CVE-2019-7398 )ina
similarway.
DirectedFuzzing. Weobservedthatthe k-clusterphenomenon
is very common in vulnerability distribution as stated in Finding 8.
WeenhancetheAFLbydirectingtheseedselectionandprioritiz-
ingmutationstrategy.TestingonFFmpeg,wefirstgetthelargest
2-clusterandthenusethisinformationtoselectbetterseeds.Inaddi-
tion,wemodifytheprioritystrategyandassignthefunctionsinthe
2-cluster the with higher priorities. Finally, we discovered five new
1556A Large-Scale Empirical Study on Vulnerability Distribution within Projects and the Lessons Learned ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea
vulnerabilities( Commit-3713833,CVE-2017-11399,CVE-2017-11719,
CVE-2017-14767,CVE-2017-16840 ) of project FFmpeg.
Inall,wehaveundertakenresponsibledisclosure,reported
10vulnerabilitiestotherelatedvendorsandfinallygot9new
CVE numbers from these target projects. These two proof of
concepts above show that our findings can facilitate the vul-nerabilitydetection to a large extent.
7 RELATED WORK
Vulnerability Analysis .Shahzad etal.[48]characterized vul-
nerabilitiesinawiderangeofaspectsincludingthephaseswhen
the vulnerabilities were introduced, how they evolved over the
years, and functionalities of vulnerabilities. Ruohomen conducted
a release-based time series analysis for Python vulnerabilities [ 44],
andfoundtheappearanceprobabilitiesofvulnerabilitiesindifferent
versionsobeyedtheMarkovproperty.KimandLee[ 30]analyzed
the cloned vulnerabilities and summarized the corresponding root
causes as well as their life cycle features. By examining the re-sponse from 21 software vendors to 241 vulnerabilities, Arora et
al.[11]studiedtheinfluentialfactorstothetimelinessofsecurity
patches and unveiled the relationship between competition andsoftware quality. Li and Paxson investigated over 4,000 security
patchesfor3,000+vulnerabilitiesandunveiledthepatchingchar-
acteristics with regard to the development life cycle [ 32].Apart
from vulnerability distribution, our study focuses on unveiling the
semanticrelationsbetweenvulnerabilities.Theanalysisresultscan
explainwhyvulnerabilitiesoccurandfurtherassistinvulnerability
detection. Gkortzis et al.[21] framed a vulnerability dataset from
open-source systems, and proposed several metrics to character-ize these vulnerabilities. Besidesvulnerability code and associated
properties,ourdatasetisalsopopulatedwithmanymatureyethandy
features including vulnerability introducer and call relations.
VulnerabilityPrediction .ShinandWilliams[ 49]unveiledthat
the faultprediction modeland the vulnerabilityprediction model
(VPM)providedsimilarpredictionperformance[ 51].Zimmermann
et al.[63] found that software measures could only achieve ahigh
precision rate but low recall rate in vulnerability prediction. Doyle
and Walden [ 13] observed a trend of decreasing vulnerability den-
sityovertime.Morrison etal.[39]concludedthatVPMsmustbe
refinedtoachieveactionableperformance.Scandariato etal.[46]
appliedtextminingsourcecodetopredictvulnerablesoftwarecom-ponents.Perl etal.builtamappingfromtheCVEsandvulnerability-
contributing commits and developed an SVM-based classifier to
identifypotentialvulnerabilitiesinalargecodebase[ 42].Ourstudy
concludes many significantfindings and insights that can aidboth
static- and dynamic- analysis based vulnerability prediction (cf. Sec-
tion 6).
8 DISCUSSION
Threats to validity .Data quality of vulnerabilities. Vulnera-
bility entries in NVD/CVE repos contain many human-crafted
piecesofinformationsuchasvulnerabilitytype,description,and
referencestovulnerablecode.Therefore,errorsandinaccuracies
inevitably flow in and degrade the quality of data. Our manualauditing cannot ensure a complete solution for solving this; We
determinethe position of vulnerabilities by checking what code isdeletedinacommitorinfluencedbytheaddedcode.However,it
is non-trivial to identify the exact scope of vulnerable code, and
any inaccurate labeling can have a negative impact on the analysis
results. Additionally, we did not consider the changes to a pure
datastructureorvariable,whichtakelessthan1%inourdataset.
Instead,we concentrate on the changes that alter actional code.
Generalizationlimits. Althoughouranalysisisbuiltonalarge
number (3,938) of vulnerabilities from five popular projects with
varying functionalities, we cannot make our findings as a gen-
eralclaim.Ononehand,ourtargetprojectsarelimitedtoC/C++
projects.Thefindingsmaynotapplyforprojectswritteninother
languages.Forexample,bufferoverflow(CWE-119)isneverasecu-
rityissueinJavaprojects.Ontheotherhand,weonlyanalyzed5
projects due to the overwhelming manual work. It could be insuffi-
cient to make a general claim from only 5 projects‚Äô observations.
Inall,whilethereisanindicationthatthesefindingsmaypersist
acrossC/C++projects,furtherstudiesonlargerprojectpopulations
writtenin various languages are required to draw a general claim.
Future research direction . Our study aswellas our findings
can inspire several future research directions. For example, the
semantic relations between vulnerabilities can facilitate the under-
standingoftheirrootcauses;thedependencypatternswhichreveal
the call relation and distance can power static analysis techniques
ofmoreefficiency;theROPOprobleminFinding12motivatesre-
searcherstore-inspectthepatchingprocess,keepmoreattention
on the security of patches, and work out a better solution.
9 CONCLUSION
We conduct a large-scale empirical study of security vulnerabili-
ties,evaluating 3,938 vulnerabilities from 5 popular projects. First
the vulnerabilities are attributed with descriptive information (e.g.,
type, involved developer), and blamed code. Then we leverage a
lightweightstaticanalysistobuildthecallingconnectionsbetween
vulnerabilities and extracted code semantics to represent them. We
haveextensivelycharacterizedvulnerabilitiesfromthreeaspects:
distribution,dependencyand recurrence, and distilled 12 findingsthatarebeneficial for thefuture research. Guidedby ourfindings,
we developed proof-of-concepts and successfully discovered 10
zero-day vulnerabilities.
ACKNOWLEDGMENTS
WewouldthankDefangBo,LuluTian,ZhaomingJinandZhem-
ingLifortheirhelpindataprocessingandpaperwriting.Wewould
alsothanktheanonymousreviewersfortheirvaluablecomments.
TheworkissupportedbytheKeyLaboratoryofNetworkAssess-
mentTechnology,ChineseAcademyofSciencesandBeijingKey
Laboratory of Network Security and Protection Technology, as
well as National Natural Science Foundation of China under Grant
No.: 61772308, 61972224, U1736209, 61802394, U1836209, 61902395;
National Key Researchand DevelopmentProgram ofChina under
Grant No.2016QY071405; Strategic Priority Research Program of
CASunderGrantNo.:XDC02040100,XDC02030200,XDC02020200;
BNRist Network and Software Security Research Program under
GrantNo.BNR2019TD01004 and No.BNR2019RC01009.
1557ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea Bingchang Liu, Guozhu Meng, Wei Zou, Qi Gong, Feng Li, Min Lin, Dandan Sun, Wei Huo, and Chao Zhang
REFERENCES
[1][n.d.].CVE-2019-7175. Retrieved February 4, 2020 from https://github.
com/ImageMagick/ImageMagick/issues/1450
[2] [n.d.]. FFmpeg. Retrieved August 15, 2019 from https://ffmpeg.org/
[3][n.d.].ImageMagick. Retrieved August 15, 2019 from https://
imagemagick.org/
[4][n.d.].ImageTragick. Retrieved August 15, 2019 from https://
imagetragick.com/
[5][n.d.].Linux-kernel. Retrieved August 15, 2019 from https://www.
kernel.org/
[6][n.d.].OpenSSL. RetrievedAugust15,2019fromhttps://www.openssl.
org/
[7][n.d.].PHP-SRC. RetrievedAugust15,2019fromhttps://www.php.net
[8]2010.american fuzzy lop. Retrieved March 09, 2019 from http://
lcamtuf.coredump.cx/afl/
[9]AmritanshuAgrawalandTimMenzies.2018. Isbetterdatabetterthan
better data miners?: on the benefits of tuning smote for defect predic-
tion. InProceedings of the 40th International Conference on Software
engineering. ACM, 1050‚Äì1061.
[10]CarinaAnderssonandPerRuneson.2007. Areplicatedquantitative
analysis of fault distributions in complex software systems. IEEE
Transactions on Software Engineering 33, 5 (2007), 273‚Äì286.
[11]AshishArora,ChrisForman,AnandNandkumar,andRahulTelang.
2010. Competitionandpatchingofsecurityvulnerabilities:Anempiri-
calanalysis. InformationEconomicsandPolicy 22,2(2010),164‚Äì177.
https://doi.org/10.1016/j.infoecopol.2009.10.002
[12]Marcel B√∂hme, Van-Thuan Pham, Manh-Dung Nguyen, and Abhik
Roychoudhury. 2017. Directed Greybox Fuzzing. In Proceedings of
the2017ACMSIGSACConferenceonComputerandCommunications
Security (CCS). 2329‚Äì2344. https://doi.org/10.1145/3133956.3134020
[13]IstehadChowdhuryandMohammadZulkernine.2011. Usingcomplex-ity,coupling,andcohesionmetricsasearlyindicatorsofvulnerabilities.
Journal of Systems Architecture 57,3 (2011), 294‚Äì313.
[14]Giulio Concas, Michele Marchesi, Alessandro Murgia, Roberto Tonelli,
and Ivana Turnu. 2011. On the distribution of bugs in the eclipse
system.IEEETransactionsonSoftwareEngineering 37,6(2011),872‚Äì
877.
[15]Hoa Khanh Dam, Truyen Tran, Trang Pham, Shien Wee Ng, JohnGrundy, and Aditya Ghose. 2017. Automatic feature learning for
vulnerability prediction. arXiv preprint arXiv:1708.02368 (2017).
[16]Xiaoning Du, Bihuan Chen, Yuekang Li, Jianmin Guo, Yaqin Zhou,
Yang Liu, and Yu Jiang. 2019. Leopard: identifying vulnerable code for
vulnerabilityassessmentthroughprogrammetrics.In Proceedingsof
the41stInternationalConferenceonSoftwareEngineering(ICSE).60‚Äì71.
https://dl.acm.org/citation.cfm?id=3339514
[17]Norman E. Fenton and Niclas Ohlsson. 2000. Quantitative analysis of
faults and failures in a complex software system. IEEE Transactions on
Software engineering 26, 8 (2000), 797‚Äì814.
[18]StefanFrei,MartinMay,UlrichFiedler,andBernhardPlattner.2006.
Large-scalevulnerabilityanalysis.In Proceedingsofthe2006SIGCOMM
workshop on Large-scale attack defense. ACM, 131‚Äì138.
[19]ShuitaoGan,ChaoZhang,XiaojunQin,XuwenTu,KangLi,Zhongyu
Pei, and Zuoning Chen. 2018. CollAFL: Path Sensitive Fuzzing. In2018 IEEE Symposium on Security and Privacy (SP). 679‚Äì696. https:
//doi.org/10.1109/SP.2018.00040
[20]GitHub.[n.d.]. GitHubDeveloperAPI . RetrievedAugust15,2019from
https://developer.github.com/v3/
[21]AntoniosGkortzis,DimitrisMitropoulos,andDiomidisSpinellis.2018.
VulinOSS: a dataset of security vulnerabilities in open-source systems.
InProceedings of the 15th International Conference on Mining Software
Repositories, MSR 2018, Gothenburg, Sweden, May 28-29, 2018. 18‚Äì21.
https://doi.org/10.1145/3196398.3196454[22]Google.[n.d.]. OSS-Fuzzissue1506. RetrievedAugust15,2019from
https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=1506
[23]Google.[n.d.]. OSS-Fuzzissue1903. RetrievedAugust15,2019from
https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=1903
[24]Tihana Galinac Grbac, Per Runeson, and Darko Huljeniƒá. 2012. A
secondreplicatedquantitativeanalysisoffaultdistributionsincomplex
software systems. IEEE Transactions on Software Engineering 39, 4
(2012), 462‚Äì476.
[25]Tihana Galinac Grbac, Per Runeson, and Darko Huljeniƒá. 2016. A
quantitative analysisof theunit verificationperspective onfault dis-
tributions in complex software systems: an operational replication.
Software quality journal 24, 4 (2016), 967‚Äì995.
[26]Zhen Huang, Mariana DAngelo, Dhaval Miyani, and David Lie. 2016.
Talos:Neutralizingvulnerabilitieswithsecurityworkaroundsforrapid
response.In 2016IEEESymposiumonSecurityandPrivacy(SP).IEEE,
618‚Äì635.
[27]JamesW.HuntandM.DouglasMcIlroy.1976. AnAlgorithmforDiffer-
entialFile Comparison. Technical Report.
[28]Xiangkun Jia, Chao Zhang, Purui Su, Yi Yang, Huafeng Huang, and
Dengguo Feng. 2017. Towards efficient heap overflow discovery. In
26th{USENIX}SecuritySymposium( {USENIX}Security17).989‚Äì1006.
[29]MatthieuJimenez, MikePapadakis, andYvesLe Traon.2016. Vulner-
ability prediction models: A case study on the linux kernel. In 2016
IEEE 16th International Working Conference on Source Code Analysis
andManipulation (SCAM). IEEE, 1‚Äì10.
[30]Seulbae Kim and Heejo Lee. 2018. Software systems at risk: An empir-
icalstudyofcloned vulnerabilitiesinpractice. Computers& Security
77 (2018), 720‚Äì736. https://doi.org/10.1016/j.cose.2018.02.007
[31]Seulbae Kim, Seunghoon Woo, Heejo Lee, and Hakjoo Oh. 2017.
VUDDY: A Scalable Approach for Vulnerable Code Clone Discov-
ery. In2017 IEEE Symposium on Security and Privacy, SP 2017, San Jose,
CA,USA,May22-26,2017.595‚Äì614. https://doi.org/10.1109/SP.2017.62
[32]Frank Li and Vern Paxson. 2017. A large-scale empirical study of
securitypatches.In Proceedingsofthe2017ACMSIGSACConference
on Computer and Communications Security. ACM, 2201‚Äì2215.
[33]YuekangLi, BihuanChen,MahinthanChandramohan, Shang-WeiLin,
YangLiu,andAlwenTiu.2017. Steelix:program-statebasedbinary
fuzzing.In Proceedingsofthe201711thJointMeetingonFoundations
of Software Engineering (ESEC/FSE). 627‚Äì637. https://doi.org/10.1145/
3106237.3106295
[34]MITRE. [n.d.]. Common Vulnerabilities and Exposures. Retrieved
August 15, 2019 from https://cve.mitre.org
[35]MITRE. [n.d.]. Common Weakness Enumetation . Retrieved August 15,
2019 from https://cwe.mitre.org
[36]MITRE. [n.d.]. CVE-2009-2767. Retrieved August 15, 2019 from https:
//www.cvedetails.com/cve/CVE-2009-2767
[37]MITRE. [n.d.]. CVE-2010-4250. Retrieved August 15, 2019 from https:
//www.cvedetails.com/cve/CVE-2010-4250
[38]MITRE. [n.d.]. CVE-2015-3636. Retrieved August 15, 2019 from https:
//www.cvedetails.com/cve/CVE-2015-3636
[39]Patrick Morrison, Kim Herzig, Brendan Murphy, and Laurie Williams.
2015. Challenges with applying vulnerability prediction models. InProceedings of the 2015 Symposium and Bootcamp on the Science of
Security. ACM, 4.
[40]U.S. National Institute of Standards and Technology. [n.d.]. Na-
tional Vulnerability Database (NVD). Retrieved August 15, 2019
from https://nvd.nist.gov/vuln/search/statistics?form_type=Basic&
results_type=statistics&search_type=last3years
[41]AndyOzmentandStuartESchechter.2006.Milkorwine:doessoftware
security improve with age?. In USENIX Security Symposium. 93‚Äì104.
1558A Large-Scale Empirical Study on Vulnerability Distribution within Projects and the Lessons Learned ICSE ‚Äô20, May 23‚Äì29, 2020, Seoul, Republic of Korea
[42]Henning Perl, Sergej Dechand, Matthew Smith, Daniel Arp, Fabian
Yamaguchi,KonradRieck,SaschaFahl,andYaseminAcar.2015. VC-
CFinder: Finding Potential Vulnerabilities in Open-Source Projects to
AssistCodeAudits.In Proceedingsofthe22ndACMSIGSACConference
on Computer andCommunications Security, Denver, CO, USA, October
12-16, 2015. 426‚Äì437. https://doi.org/10.1145/2810103.2813604
[43]David A Ramos and Dawson Engler. 2015. Under-constrained sym-
bolicexecution:Correctnesscheckingforrealcode.In 24th{USENIX}
Security Symposium ( {USENIX}Security 15). 49‚Äì64.
[44]Jukka Ruohonen. 2018. An Empirical Analysis of Vulnerabilities in
Python Packages for Web Applications. In 9th International Workshop
onEmpiricalSoftwareEngineeringinPracticeIWESEP.25‚Äì30. https:
//doi.org/10.1109/IWESEP.2018.00013
[45]Robert Sanders. 1987. The Pareto principle: its use and abuse. Journal
of Services Marketing 1, 2 (1987), 37‚Äì40.
[46]RiccardoScandariato,JamesWalden,AramHovsepyan,andWouter
Joosen. 2014. Predicting vulnerable software components via text
mining.IEEE Transactions on Software Engineering 40, 10 (2014), 993‚Äì
1006.
[47]MuhammadShahzad,MuhammadZubairShafiq,andAlexXLiu.2012.
A large scale exploratory analysis of software vulnerability life cycles.
In201234thInternationalConferenceonSoftwareEngineering(ICSE).
IEEE, 771‚Äì781.
[48]MuhammadShahzad,MuhammadZubairShafiq,andAlexX.Liu.2012.
A large scale exploratory analysis of software vulnerability life cycles.
In34th International Conference on Software Engineering, ICSE 2012,
June2-9, 2012,Zurich, Switzerland.771‚Äì781. https://doi.org/10.1109/
ICSE.2012.6227141
[49]YongheeShin,AndrewMeneely,LaurieWilliams,andJasonAOsborne.
2010. Evaluating complexity, code churn, and developer activity met-
rics as indicators of software vulnerabilities. IEEE Transactions on
Software Engineering 37, 6 (2010), 772‚Äì787.
[50]YongheeShinandLaurieWilliams.2008.Anempiricalmodeltopredict
security vulnerabilities using code complexity metrics. In Proceedings
of the Second International Symposium on Empirical Software Engi-
neeringandMeasurement(ESEM).315‚Äì317. https://doi.org/10.1145/
1414004.1414065
[51]Yonghee Shin and Laurie Williams. 2013. Can traditional fault predic-
tionmodelsbeusedfor vulnerabilityprediction? EmpiricalSoftware
Engineering 18,1 (2013), 25‚Äì59.
[52]CKShriram,KMuthukumaran,andNLBhanuMurthy.2018. Empirical
Study on the Distribution of Bugs in Software Systems. International
Journal of Software Engineering and Knowledge Engineering 28, 01
(2018), 97‚Äì122.
[53]ChakkritTantithamthavorn,ShaneMcIntosh,AhmedEHassan,and
Kenichi Matsumoto. 2016. Automated parameter optimization of clas-
sificationtechniquesfordefectpredictionmodels.In 2016IEEE/ACM
38th International Conference on Software Engineering (ICSE). IEEE,
321‚Äì332.
[54]ChakkritTantithamthavorn,ShaneMcIntosh,AhmedEHassan,and
Kenichi Matsumoto. 2016. An empirical comparison of model vali-
dation techniques for defect prediction models. IEEE Transactions on
Software Engineering 43, 1 (2016), 1‚Äì18.
[55]Dimitri van Heesch. [n.d.]. Doxygen. Retrieved July 1, 2019 from
http://www.doxygen.nl/
[56]Wikipedia. [n.d.]. DirtyCow. Retrieved August 15, 2019 from https:
//en.wikipedia.org/wiki/Dirty_COW
[57]Wikipedia.[n.d.]. Heartbleed. RetrievedAugust15,2019fromhttps:
//en.wikipedia.org/wiki/Heartbleed
[58]Wikipedia.[n.d.]. SandWorm. RetrievedAugust15,2019fromhttps:
//www.cvedetails.com/cve/CVE-2014-4114[59]Zhengzi Xu,Bihuan Chen,Mahinthan Chandramohan,Yang Liu, and
Fu Song. 2017. SPAIN: security patch analysis for binaries towards
understandingthepainandpills.In Proceedingsofthe39thInternational
Conference on Software Engineering. IEEE Press, 462‚Äì472.
[60]FabianYamaguchi,NicoGolde,DanielArp,andKonradRieck.2014.
ModelingandDiscoveringVulnerabilitieswithCodePropertyGraphs.
In2014 IEEE Symposium on Security and Privacy, SP 2014, Berkeley, CA,
USA,May 18-21, 2014. 590‚Äì604. https://doi.org/10.1109/SP.2014.44
[61]Yibiao Yang, Yuming Zhou, Jinping Liu, Yangyang Zhao, Hongmin Lu,
Lei Xu, Baowen Xu, and Hareton Leung. 2016. Effort-aware just-in-time defect prediction: simple unsupervised models could be better
thansupervisedmodels.In Proceedingsofthe24thACMSIGSOFTIn-
ternationalSymposiumonFoundationsofSoftwareEngineering(FSE) .
157‚Äì168. https://doi.org/10.1145/2950290.2950353
[62]Shahed Zaman, Bram Adams, and Ahmed E Hassan. 2011. Security
versus performance bugs: a case study on firefox. In Proceedings of the
8th working conference on mining software repositories. ACM, 93‚Äì102.
[63]ThomasZimmermann,NachiappanNagappan,andLaurieWilliams.
2010. Searching for a needle in a haystack: Predicting security vulner-
abilitiesforwindowsvista.In 2010ThirdInternationalConferenceon
Software Testing, Verification and Validation. IEEE, 421‚Äì428.
1559