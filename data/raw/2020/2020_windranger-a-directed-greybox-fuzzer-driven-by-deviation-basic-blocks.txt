WindRanger: A Directed Greybox Fuzzer driven by Deviation
Basic Blocks
Zhengjie Du
State Key Laboratory for Novel Software Technology
Nanjing University
Nanjing, ChinaYuekang Liâ€ 
Nanyang Technological University
Singapore
Yang Liu
Nanyang Technological University
SingaporeBing Mao
State Key Laboratory for Novel Software Technology
Nanjing University
Nanjing, China
ABSTRACT
Directed grey-box fuzzing (DGF) is a security testing technique
that aims to steer the fuzzer towards predefined target sites in the
program. To gain directedness, DGF prioritizes the seeds whose
executiontracesareclosertothetargetsites.Therefore,evaluating
thedistancebetweentheexecutiontraceofaseedandthetarget
sites(aka,theseeddistance)isimportantforDGF.Thefirstdirected
grey-box fuzzer, AFLGo, uses an approach of calculating the basic
blockleveldistancesduringstaticanalysisandaccumulatingthe
distancesoftheexecutedbasicblockstocomputetheseeddistance.
FollowingAFLGo,mostoftheexistingstate-of-the-art DGF tech-
niques use all the basic blocks on the execution trace and only the
control flow information for seed distance calculation. However,
not every basic block is equally important and there are certainbasic blocks where the execution trace starts to deviate from the
target sites (aka, deviation basic blocks).
Inthispaper,weproposeatechniquecalledWindRangerwhich
leveragesdeviationbasicblockstofacilitateDGF.Toidentifythe
deviation basic blocks, WindRanger applies both static reacha-
bilityanalysisanddynamicfiltering.Toconductdirectedfuzzing,
WindRanger uses the deviation basic blocks and their related
data flow information for seed distance calculation, mutation, seed
prioritizationaswellasexplore-exploitscheduling.Weevaluated
WindRanger on 3 datasetsconsisting of 29 programs. Theexper-
imentresultsshowthatWindRangeroutperformsAFLGo,AFL,
and FairFuzz by reaching the target sites 21%, 34%, and 37% faster
and detecting the target crashes 44%, 66%, and 77% faster respec-tively. Moreover, we found a 0-day vulnerability with a CVE ID
assignedinffmpeg(apopularmultimedialibraryextensivelyfuzzed
by OSS-fuzz) with WindRanger by supplying manually identified
suspect locations as the target sites.
â€ Corresponding author.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACMmustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA
Â© 2022 Association for Computing Machinery.
ACM ISBN 978-1-4503-9221-1/22/05...$15.00
https://doi.org/10.1145/3510003.3510197CCS CONCEPTS
â€¢Securityandprivacy â†’Softwaresecurityengineering ;Soft-
ware and application security;
KEYWORDS
Fuzz Testing, Directed Testing
ACM Reference Format:
Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao. 2022. WindRanger:
ADirectedGreyboxFuzzerdrivenbyDeviationBasicBlocks.In 44thInterna-
tionalConferenceonSoftwareEngineering(ICSEâ€™22),May21-29,2022,Pittsburgh,
PA, USA. ACM, New York, NY, USA, 12 pages. https://doi.org/10.1145/
3510003.3510197
1 INTRODUCTION
Softwarevulnerabilityisamajorthreattosoftwaresecurity.Fuzzing
is a software testing technique for finding vulnerabilities. The key
idea of fuzzing is to feed the program under test (PUT) with a
large amount of test inputs and observe for abnormal behaviors
(e.g., crashes) of the program. According to how much information
about the program internals is used, fuzzing techniques can be
categorizedasblackbox,greyboxandwhitebox.Blackboxfuzzing
techniquesrequirenoknowledgeabouttheinternalsofthePUTand
theymaylackeffectivenesswhentestingprogramswithcomplex
states. Whitebox fuzzing techniques captures the entire execution
context(memory,registersetc.)ofthePUTandtheyoftenapplytechniques such as symbolic execution or taint analysis which
maylimittheirapplicabilityonlargeprograms.Greyboxfuzzing
techniquesuselight-weightprograminstrumentationstocollect
therun-timeinformationneededforguidingthefuzzingprocess.
Greyboxfuzzinghasthebestofbothworldssinceitisbotheffective
enough to detect deeply embedded bugs and scalable enough to
be applied to large programs. Therefore, greybox fuzzing is widely
used by both practitioners and researchers [25, 30, 34, 40, 43, 45].
Despitebeinghighlyeffective,greyboxfuzzinggenerallylacks
the directedness to reach predefined target locations in the PUT
(aka,target sites1). To address this issue, BÃ¶hme et al. proposed
the concept of Directed Greybox Fuzzing (DGF) [ 3] in 2017. The
key feature of DGF is that it spends most of its time budget onreaching and testing the target sites without wasting resources
1Inthispaper,weassumeeachtargetsitecorrespondstoonebasicblockintheprogram
24402022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao
stressingunrelatedprogramcomponents.Thus,DGFcanreachand
test the target sites in the PUT faster than general purpose fuzzing
techniquessuchasCoverage-guidedGreyboxFuzzing(CGF),which
focuses on maximizing the code coverage. This feature makes DGF
excel in certain usage scenarios such as patch testing, crash re-
production and static analysis report verification [ 3]. For patch
testing,thepatchedcodesitescanbesetasthetargetsitesandwith
theDGFtechnique,onecanquicklytestwhetherthepatchesare
completeornot.Forcrashreproduction,thecrashingsitecanbe
set as the target site and with the DGF technique, one can quickly
reproduce and acquire the Proof-of-Concept crashing input. For
static analysis report verification, the suspicious locations reported
viastaticanalysescanbesetasthetargetsitesandwiththeDGF
technique, one can check whether the reported locations really
contains vulnerabilities.
From these usage scenarios, we can observe that reaching the
targetsitesistheprimarygoalforDGF.Inpractice,thetimebudgetsfortheseusagescenariosareoftenlimitedandthenumberoftarget
sitestoreachcanbehuge.Therefore,speedinguptheprocessofdirecting the fuzzer to reach the target sites can help to betterfulfill these tasks. For example, for static analysis verification, if
theDGFcanreachmoretargetsiteswithafixedamountoftime,
then the chance of revealing vulnerabilities is increased. In recent
years, researchers have proposed several techniques to allow DGF
toreachandtestmoretargetsiteswithalimitedtimebudget[ 8,49].
In DGF, to gain directedness, the fuzzer needs to identify and
prioritizetheseeds2whoseexecutiontracesare closertothetarget
sites.Thus,correctlymeasuringthe distanceofagivenseedtowards
thetargets isan importantfactor forboosting theperformanceof
DGF.Tocalculatethedistanceofaseedefficiently,theauthorsof
AFLGo proposed a novel two-step approach: first, during static
analysis,computethedistancebetweeneachbasicblockandthe
targetsitesonthecallgraphandcontrolflowgraphandtheninstru-
ment the distance information into the program; during fuzzing,
aggregatethedistancevaluesofeachexecutedbasicblockasthe
distance of the seed. This approach enables AFLGo to calculate the
seed distances with low runtime overhead.
Although AFLGoâ€™s approach of seed distance calculation is effi-
cientandhelpswiththetargetorientationofthefuzzer,itsuffers
from two pitfalls: Â‚The seed distance calculated with allthe basic
blocksontheexecutiontracecanbebiasedbecausenoteveryblock
is the key of driving the execution towards the target sites. Forexample, suppose the fuzzer needs to evaluate two seeds, A andB. Assume seed A goes through a lot of basic blocks which arefar away from the target site before it ends up somewhere very
close to the target site, while seed B does not go through too many
basic blocks and it ends up somewhere not as close. Rationally, the
fuzzer should prioritize seed A rather than seed B since seed A can
eventually get closer to the target site. However, if all the basic
blocks are counted, the distance of seed A can be larger due to the
noisesintroducedbysomeofthebasicblocks. ÂƒTheseeddistance
calculationis onlybasedoncontrolflowinformationwhilethedata
flowinformationisignored.Currently,thedistancebetweenabasic
blockandatargetsiteiscalculatedbasedonthenumberofedges
2In this paper, we denote all the files fed to the program in fuzzing as inputs, and only
the inputs preserved for subsequent fuzzing as seedsbetween them on the control flow graph and call graph. However,
this distance cannot represent the difficulty of reaching the targets
with the seed. For example, a basic block of a comparison for a
checksum value can have two edges extending from it: one for the
equalbranchandoneforthenotequalbranch.Fulfillingtheedgeoftheequalbranchismuchharderthanthenotequalbranchwithout
avalidinput.Thus,thesetwoedgesshouldbetreateddifferently
during distance calculation.
Tofindsolutionsfortheaforementionedpitfalls,wescrutinize
theexecutiontracesfailingtoreachthetargetsitesandobservethat
for every execution trace, there are some key basic blocks where it
startstodeviatefromthetargetsites.Wenamesuchbasicblocks
asdeviation basic blocks (DBBs). If the execution trace at the DBBs
can be altered, then the target site can be reached. Based on this
observation,weproposeWindRanger3,adirectedgrey-boxfuzzer
augmented by DBBinformation. The workflow of WindRanger
contains two major steps: static analysis and fuzzing. During static
analysis, WindRanger first identifies all the potential DBBs which
contain branches where the execution can deviate from the target
sites. Then, WindRanger calculates the distanceof the identified
basic blocks to the target sites. During fuzzing, given a seed andits execution trace, WindRanger first selects the DBBsf r o mt h e
statically identified candidates for the seed based on its executiontrace.(Â§3.1)Then,WindRangercalculatesthedistancevaluefor
the seed based on the DBBs and adjusts the distance value based
ontheconditionmatchingdifficultyofthese DBBs(Â§3.3).Withthe
calculated distances, WindRanger then prioritizes the seeds by
adjustingthepowerschedulingstrategy.Inaddition,baseson DBBs,
WindRanger also improves the seed prioritization strategy (Â§ 3.5),
mutationstrategy(Â§3.4)aswellastheexplore-exploitswitching
decision process (Â§ 3.6) to further enhance the performance.
To evaluate the performance of WindRanger, we selected 29
programsfrom3datasetsasbenchmarksandusedAFLGoaswellas
two coverage-guided grey-box fuzzers (AFL and FairFuzz) as base-
lines. We conducted 38,400 CPU hours of experimentsto evaluate
WindRangerâ€™s capability ofreaching target sites inthe programs
andreproducingcrashes.Ourexperimentresultsshowthatcom-
pare with AFLGo, AFL and FairFuzz, WindRanger can reach the
targetsitesfasterby21%,34%,and37%anddetectthetargetcrashesfasterby44%,66%,and77%respectively.Inpractice,withmanually
selected target sites, WindRanger successfully discovered a 0-day
vulnerability on one of the sites with a unique CVE ID assigned in
ffmpeg [15].
Themain contributionsofthispaperaresummarizedas follows:
â€¢Wepresenttheconceptofdeviationbasicblockandanap-
proachofidentifyingthedeviationbasicblockswithstatic
and dynamic analysis.
â€¢We present WindRanger, a directed grey-box fuzzer lever-
ages the deviation basic block information to augment seed
scheduling and mutation strategies.
â€¢We implementthe prototype for WindRanger and publish
the source code for future research.
â€¢WeevaluateWindRangerthoroughlywithextensiveexper-
iments and demonstrate the superiority of WindRanger.
3WindRanger is a heroine in the game Dota2. Her ultimate skill is called Focus Fire,
which allows her to quickly take down the target enemy.
2441
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. WindRanger: A Directed Greybox Fuzzer driven by Deviation Basic Blocks ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA
This paper is accompanied by a website: https://sites.google.
com/view/windranger-directed-fuzzing/. The experimental data
and source code are available on this website.
2 MOTIVATING EXAMPLE
Figure 1 shows a code snippet crafted from CVE-2018-8962 [ 32],
whereUse-After-Freebugscanbetriggeredwhentheprogramcalls
thegetNamefunction fromthe decompileJUMP function. Besides
thesourcecode,Figure1alsoshowsthecorrespondingcontrolflow
graphofthecodesnippetwhereeachnoderepresentsabasicblock.
Suppose we are trying to use DGF to reproduce this CVE, we
will need to set the basic blocks containing line 16 and line 22 as
the target sites and calculate the distance of each basic block to
the target sites accordingly. For simplicity, here we use the number
of edges between a basic block and the nearest target site as its
distance value.4In the control flow graph in Figure 1, the notation
of X:Y means that X is the line number of the first instruction of
the basic block and Y is the distance of the basic block towards the
target. If the target sites are not reachable from a basic block, only
thelinenumberislabeled.Forexample,node6:3meansthebasic
block starts from line six and it can reach the nearest target site
online16bytraversingthreeedges.Anotherexampleisnode18,
which starts from line 18 that is a return. Since the program can
neverreachthetargetsitesafterthereturn,nodistanceisassigned
to node 18.
LimitationsofExistingApproaches. Assumethedirectedgrey-
box fuzzer has found three seeds (A, B and C), and their execution
tracesareshowninFigure1.Fortheexecutiontracesofseedsin
Figure 1, the executed basic blocks are marked with dark back-
ground and the executed edges are represented with dashed lines.
Now,weneedtocalculatethedistanceofeachseedtodecidewhich
one should be prioritized. Following the idea of [ 3,8,50], where
the distance of a seed is the arithmetic mean of the distances of
allthe basic blocks on its execution trace, the distances of seed
A ,Ba n dCa r e3+5+4+3+2+2+1
7=2.86,3+2+2
3=2.33, and3+2+1
3=2
respectively.Basedonthesedistances,itseemsseedCshouldbe
preferred. However, in reality, the condition on line 15 is very hardforthefuzzertopenetratethrough,meaningthattheedgebetweennode15:1andnode16canhardlybeexecuted.Asaresult,seedCisnotagoodchoiceifweconsiderthepathconditions.Thediscussion
aboutseedCshowsthat onlyusingthecontrolflowinformationto
calculate the distance is not enough, data flow information should
also be considered. Now that seed C has been excluded, we need to
select from seed A and seed B. At first glance, seed B has a smaller
distance(2.33vs2.86)andthefuzzershouldpreferseedB.Nonethe-
less, if we check the execution trace, we can see that the execution
trace of seed A is actually closer to the target site on line 22 and
seedAisthebetteronetoselect.ThereasonforseedAtohavea
larger distance is that it executes node 7:5, node 9:4 and node 12:3,
whichincreasestheoverallseeddistance.Thecomparisonbetween
seed A and B shows that the seed distance calculated with all the
basic blocks can be biased and thus inaccurate.
4In [3][8], harmonic means are used to balance the distance between multiple target
sites.InWindRanger,wefocusonimprovingtheseeddistancecalculation,soweuse
a naive approach to calculate the basic block distance in this example for simplicity.Our Observations. From the execution traces in Figure 1, we can
see that for an execution trace that fails to reach the target sites,it must deviate from the target sites at certain basic blocks. Forexample,fortheexecutiontraceofseedA,whenitreachesnode21:1, it deviates from the target by not entering the if condition.Note that node 14:2 is not a deviation point because both edges
extended from this node can possibly reach a target site. Similarly,
for seed B, the deviation point is node 20:2 and for seed C, the
deviationpointisnode15:1.Inthispaper,wecallsuchbasicblocks
thedeviation basic blocks (DBBs).
OurApproach. Ifwecalculatethedistancesbyaveragingonlythe
DBBs, the seed distances for A, B and C are 1, 2 and 1 respectively.
If we can further adjust the distance of seed C according to thehard-to-meet condition on line 15, we can eventually prioritizeseed A, the actual best seed here. As we have demonstrated the
importanceofthe DBBs,theproblemnowbecomeshowtoidentify
them.
Although in this example, all the DBBs happen to be the ba-
sicblockswiththeshortestdistance,theidentificationofthemis
not that straightforward. Suppose we have another seed D, whose
execution trace is <6:3 â†’7:5â†’9:4â†’10>. For this seed, even
though node 6:3 has a shorter distance than node 9:4, the latter
oneshould bethe DBBsincethe executiontraceactuallydeviates
fromthetargetsitesatnode9:4.Thisisbecausethesuccessorofnode 9:4 is node 10, which is unreachable to the target sites, not
node12:3whichisreachable.Alteringthebranchingonnode9:4
can affect whether the target sites can be reached or not. On thecontrary, no matter how we alter the branching at node 6:3, the
executiontracealwayshasachancetoreachatleastonetargetsite.
In WindRanger, we give a clear definition of DBBs in the context
of DGF and propose an approach to identify them on execution
traces. Furthermore, we propose an approach to leverage the DBBs
informationaswellasdataflowinformationforbetterseeddistance
calculation. Last but not least, we integrate the improvements into
different components of DGF to maximize the performance boost.
3 APPROACH OF WINDRANGER
Figure2showstheoverviewof WindRanger.WindRangercon-
tainstwomajorcomponents:staticanalysisandfuzzing.Thestatic
analysis of WindRanger is used to identify the plausible candi-
dates of the deviation basic blocks (DBB s), calculate their distance,
andinstrumentthisinformationintothetargetprogram.Moreover,
like in CGF, the instrumentation can also collect edge coverage toguide the grey-box exploration of different program states.
In the fuzzing process, before selecting a seed input from the
seedqueue,WindRangerwillfirstdecidewhetheritshouldrunin
the exploration mode or the exploitation mode ( x). The switching
isdecideddynamicallytobalancebetweenexplorationandexploita-
tion and avoid getting stuck in local optimums. In the exploration
stage,WindRangerworkslikeanormalcoverage-guidedgrey-boxfuzzer.Intheexploitationstage,WindRangerprioritizestheseeds
with shorter distances via selecting them first and allocating more
energy for mutating them ( y). After a seed is selected from the
queue and allocated a power schedule (to determine how many
newtestinputstobegeneratedfromit),WindRangerwillconduct
mutation ( z) augmented with the results of the data flow analysis
2442
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao
   static int
   decompileJUMP (int n, SWF_ACTION * actions, int  maxn) {
     struct SWF_ACTIONIF *sactif;
     sactif=NULL;
     ...
     if (...) {
       if  (...) {
         sactif =  (struct SWF_ACTIONIF *)&( actions[n+i+j])
         if (!sactif)
           return -1;
       }
       ...
     }
     if (...) {
       if (XXX) { // hard condition
         getName(actions); //bug function
       }       return 0;     }
     if (...) {
       if (XXX) { // easy condition
         getName(actions); //bug function
       }
     }
     ...
   }6:3
7:5
20:2
2515:1
16
1821:1
229:4
10
14:212:31234567891011121314151617181920212223242526
Source Code Control Flow Graph6:3
7:5
20:2
2515:1
16
1821:1
229:4
10
14:212:36:3
7:5
20:2
2515:1
16
1821:1
229:4
10
14:212:36:3
7:5
20:2
2515:1
16
1821:1
229:4
10
14:212:3
Execution Trace of Seed A Execution Trace of Seed B Execution Trace of Seed C22
Figure 1: Code snippet crafted from CVE-2018-8962, its corresponding CFG and execution traces of 3 different seeds
Source CodeEdge Coverage Collection
Info
Deviation Basic Block and
Distance Info
Compile &
InstrumentInstrumented BinaryStatic Analysis
ExecutionExecution Trace
AnalysisNew SeedsSeed QueueExplore/Exploit
Switch
Energy Scheduler Power Schedule Selected Seed Mutation Mutated InputsCrashes
Static Analysis Fuzzing
Probing-based
Taint Analysis Deviation Basic
Block Info
Effector MapDistance
Calculation
21
345 6
Figure 2: The overall workflow of WindRanger
(|). The mutation helps to steer the fuzzer to pass the conditionals
oftheDBBs.Then,afteramutatedinputisexecuted,WindRanger
will analyze the execution traces to decide whether to keep the
input as a new seed and if the input is kept as a new seed, Win-
dRanger will also confirm the corresponding DBBs({). Before
addingtheseedtotheseedqueue,WindRangerwillcalculateits
distance towards the target sites according to the DBBs(}) and
adjustthedistancevalueaccordingtothedataflowanalysisresults
(|). This marks the end of one iteration in the fuzzing loop.
In the following sections, we will explain in detail the following
questions: Â‚how does WindRanger identify the DBBs for a seed
usingstaticanddynamicanalyses(Â§3.1); ÂƒhowdoesWindRanger
perform the probing based taint analysis (Â§ 3.2); Â„how does Win-
dRanger calculate the seed distance and fine-tune it with the taint
analysis result (Â§ 3.3); Â…how does WindRanger mutate the input
with the taint analysis result (Â§ 3.4); Â†how does WindRanger use
theDBBs for seed prioritization (Â§ 3.5); Â‡how does WindRanger
make decisions on switching between exploration and exploitation
(Â§ 3.6).
3.1 Deviation Basic Blocks Identification
Deviationbasicblock(DBB )isanimportantconceptinWindRanger.
Toidentifythe DBBsintheexecutiontraceofaseed,WindRangerfirst finds the potential DBBs in the program with static analy-
sis. Then, during fuzzing, WindRanger pinpoints the DBBsi nt h e
executiontracewithanalysesonexecutedbasicblocksandtheir
relations with the potential DBBs.
Static DBBCollection . Herewe providethe definitionof the po-
tentialDBBs for a program and then discuss how WindRanger
finds the potential DBBs with static analysis.
Definition 1 (Potential DBBs for a program) .Given a program ğ‘ƒ,
allitsbasicblocks ğ´ğ‘™ğ‘™ğµğµ(ğ‘ƒ)andasetoftargetsites ğ‘‡,thepotential
DBBso fğ‘ƒ(denoted as Î¦(ğ‘ƒ)) is a set of basic blocks:
Î¦(ğ‘ƒ)={ğ‘âˆˆğ´ğ‘™ğ‘™ğµğµ(ğ‘ƒ)|ğ‘–ğ‘ ğ‘…ğ‘’ğ‘ğ‘â„ğ‘ğ‘ğ‘™ğ‘’ (ğ‘,ğ‘‡)âˆ§
(âˆƒğ‘âˆˆğ‘†ğ‘¢ğ‘ğ‘ğ‘’ğ‘ ğ‘ ğ‘œğ‘Ÿğ‘  (ğ‘))[Â¬ğ‘–ğ‘ ğ‘…ğ‘’ğ‘ğ‘â„ğ‘ğ‘ğ‘™ğ‘’ (ğ‘,ğ‘‡)]}(1)
whereğ‘–ğ‘ ğ‘…ğ‘’ğ‘ğ‘â„ğ‘ğ‘ğ‘™ğ‘’ (ğ‘¥,ğ‘‡)is a function which returns true if the
basic block ğ‘¥is reachable to at least one target site in ğ‘‡on the
interprocedural control flow graph and returns false otherwise;
ğ‘†ğ‘¢ğ‘ğ‘ğ‘’ğ‘ ğ‘ ğ‘œğ‘Ÿğ‘  (ğ‘)is the set of all succeeding basic blocks of ğ‘.
Inplaintext,Definition1canbeexplainedas:thepotential DBBs
ofaprogramarethebasicblockswhichcanreachtoatleastone
targetandatleastoneofitssucceedingbasicblocksisnotreachable
to any target. The rationale of this definition is double-fold. First, a
potential DBBmust be reachable to the target sites, otherwise, it
cannothelptoreachthetargetsites,andthereisnopointtoanalyze
2443
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. WindRanger: A Directed Greybox Fuzzer driven by Deviation Basic Blocks ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA
thedeviationissueonthenon-reachablebasicblocks.Second,at
least one of the successors of a potential DBBis not reachable,
because,ifallsuccessorsofabasicblockarereachabletothetarget,executiontracescannotdeviatefromthetargetsonthisbasicblock.
In practice, WindRanger constructs an interprocedural Control
FlowGraph(iCFG)ofthetargetprogramandcomputesthereacha-
bility for each basic block and the target sites base on the iCFG. A
basic blockis considered reachableto a target siteif there existsa
pathfromthebasicblocktothetargetsiteontheiCFG.Thenfor
eachbasicblockthatisreachabletotargetsites,ifatleastoneof
itssuccessorisunreachabletoanytarget,WindRangeraddsthis
basic block to the Î¦(ğ‘ƒ).
Dynamic DBBCollection . Here we define the DBBso fa ne x ec u -
tion trace andthen discuss how WindRanger identifies the DBBs
dynamically.
Definition 2 (DBBs for a seed) .Given the potential DBBsÎ¦(ğ‘ƒ)
and a seed ğ‘ , theDBBs of the execution trace of ğ‘ (denoted as Î¦(ğ‘ ))
is a set of basic blocks:
Î¦(ğ‘ )={ğ‘âˆˆğœ‰(ğ‘ )|ğ‘âˆˆÎ¦(ğ‘ƒ)âˆ§
(âˆ€ğ‘âˆˆğ‘…ğ‘’ğ‘ğ‘â„ğ‘ğ‘ğ‘™ğ‘’ğ‘†ğ‘¢ğ‘ğ‘ (ğ‘))[ğ‘âˆ‰ğœ‰(ğ‘ )]}(2)
whereğœ‰(ğ‘ )denotes all basic blocks in the execution trace of the
seedğ‘ ;ğ‘…ğ‘’ğ‘ğ‘â„ğ‘ğ‘ğ‘™ğ‘’ğ‘†ğ‘¢ğ‘ğ‘ (ğ‘)isallsuccessorsofthebasicblock ğ‘which
can reach to the target sites.
Inplaintext,Definition2canbeexplainedas:the DBBsofaseed
are the basic blocks in its execution traces which are the potential
DBBsoftheprogramandalloftheirreachablesuccessorsarenot
executed by this seed. The rationale of this definition is double-
fold. First, a DBBof the execution trace, by nature, must be one
ofthepotential DBBsoftheprogram.Second,allofthereachable
successors ofa DBBshould notappear inthe executiontrace. The
reasonforthesecondpointisthatifoneofthereachablesuccessors
of a basic block is in its execution trace, the program is running
towards (instead of away from) the targets on this basic block and
thus the basic block is not an actual DBBfor this execution trace.
Thepotential DBBsforaprogramareusedasintermediateresults
to acquire the DBBs for seeds that are used for guiding the DGF.
Thus, in the following sections discussing the key steps of the
fuzzing process, if not specially mentioned, the term DBBrefers to
DBBfor seeds.
3.2 Probing-based Taint Analysis
WindRanger uses probing-based taint analysis similar to Fair-
Fuzz[25]andGreyOne[ 16]tocollectdataflowinformationabout
which bytes in the seed can influence the constraints for a given
branch. The data flow information is then stored in a hash map
calledeffectormap,wherethekeyisthebasicblockaddressfora
branch constraint and the value is a set of indexes of the bytes on
the seed which can influence the branch constraint. The effector
map is used for seed distance calculation (Â§ 3.3) and data sensitive
mutation (Â§ 3.4).
Algorithm1showstheprocessofgeneratingtheeffectormap,
whereğ‘‰ğ‘ğ‘™ğ‘¢ğ‘’ğ‘‚ğ‘“ (ğ‘£ğ‘ğ‘Ÿ,ğ‘ )returnsthevalueofvariable ğ‘£ğ‘ğ‘Ÿforaseed ğ‘ .
Foraseed ğ‘ anditsexecutiontrace ğœ‰(ğ‘ ),WindRangerfirstextracts
allthevariablesrelatedtobranchconstraintsontheexecutiontrace(VAR). Then, WindRanger mutates the seed byte by byte with
a set of predefined mutation operators ( OP). With each mutated
input,WindRangerchecksforeveryextractedvariablewhetherits
valueremains unchangedafter themutation. Ifthe variablevalue
is changed, WindRanger updates the effector map to take note
that the mutated position of seed ğ‘ can affect the variable.
Inthecurrentimplementationof WindRanger,wepredefine
three mutation operations for OP:1 )Bit-flip. Modify the byte at
the given position by flipping each bit of it. 2) Insertion. Insert a
randombyteatthegivenposition.3) Deletion.Deletethebyteat
the given position.
Algorithm 1 Effector Map Inference
Input:ğ‘ , the seed to be probed
Input:OP, the predefined mutation operators
Input:ğ‘ƒ/prime, the instrumented program
Output: ğ‘€, the effector map of ğ‘ 
1:ğ¼ğ‘›ğ‘–ğ‘¡ğ‘Šğ‘–ğ‘¡â„ğ¸ğ‘šğ‘ğ‘¡ğ‘¦ğ‘€ğ‘ğ‘ (ğ‘€)
2:ğœ‰(ğ‘ )â†ğ¸ğ‘¥ğ‘’ğ‘ğ‘¢ğ‘¡ğ‘’(ğ‘ ,ğ‘ƒ/prime)
3:VARâ†ğ¸ğ‘¥ğ‘¡ğ‘Ÿğ‘ğ‘ğ‘¡ğ¶ğ‘œğ‘›ğ‘ ğ‘¡ğ‘Ÿğ‘ğ‘–ğ‘›ğ‘¡ğ‘‰ğ‘ğ‘Ÿğ‘–ğ‘ğ‘ğ‘™ğ‘’ğ‘  (ğœ‰(ğ‘ ))
4:for0â‰¤ğ‘ğ‘œğ‘ <|ğ‘ |do
5:forğ‘œğ‘âˆˆOPdo
6: ğ‘ /primeâ†ğ‘€ğ‘¢ğ‘¡ğ‘ğ‘¡ğ‘’(ğ‘ ,ğ‘ğ‘œğ‘ ,ğ‘œğ‘ )
7: forğ‘£ğ‘ğ‘ŸâˆˆVARdo
8: ifğ‘‰ğ‘ğ‘™ğ‘¢ğ‘’ğ‘‚ğ‘“ (ğ‘£ğ‘ğ‘Ÿ,ğ‘ )â‰ ğ‘‰ğ‘ğ‘™ğ‘¢ğ‘’ğ‘‚ğ‘“ (ğ‘£ğ‘ğ‘Ÿ,ğ‘ /prime)then
9: ğ‘€[ğ‘£ğ‘ğ‘Ÿ]=ğ‘€[ğ‘£ğ‘ğ‘Ÿ]âˆª{ğ‘ğ‘œğ‘ }
3.3 Seed Distance Calculation
Seeddistancecalculationisimportantin DGF.Seedswithshorter
distances are prioritized and allocated with more energy for muta-
tion.
With the target basic blocks ğ‘‡ğµ, the distance of a seed ğ‘ is:
ğ‘‘ğ‘ (ğ‘ ,ğ‘‡ğ‘)=/summationtext.1
ğ‘šâˆˆÎ¦(ğ‘ )ğ‘‘ğ‘(ğ‘š,ğ‘‡ğ‘)
|Î¦(ğ‘ )|(3)
whereğ‘‘ğ‘(ğ‘š,ğ‘‡ğ‘)isthedistancebetween DBBğ‘šandthetargetbasic
blocks; Î¦(ğ‘ )consist of the DBBs in the execution trace of seed ğ‘ .I n
other words, forseed ğ‘ , Equation3uses theaverage distanceof the
DBBs in its execution trace as its distance to target basic blocks ğ‘‡ğ‘.
NotethatstructureofEquation3andthedefinitionof ğ‘‘ğ‘(ğ‘š,ğ‘‡ğ‘)
areboththesameasinAFLGo[ 3]andHawkEye[ 8]exceptthatwe
usetheDBBsinsteadofallthebasicblockstocalculatethedistance.
However, Equation 3 is still not accurate enough since only
control flow information is used for the distance calculation. We
needtofurtherbalancethedistanceofeach DBBwiththedataflow
information and the equation now becomes:
ğ‘‘ğ‘ (ğ‘ ,ğ‘‡ğ‘)=/summationtext.1
ğ‘šâˆˆÎ¦(ğ‘ )ğ‘‘ğ‘(ğ‘š,ğ‘‡ğ‘)Â·Î¨(ğ‘ ,ğ‘š)
|Î¦(ğ‘ )|(4)
where Î¨(ğ‘ ,ğ‘š)is used to judge the degree of difficulty to penetrate
the constraint on DBBğ‘šwith seed ğ‘ .Î¨(ğ‘ ,ğ‘š)is defined as:
Î¨(ğ‘ ,ğ‘š)=ğ‘šğ‘–ğ‘›(ğ‘€ğ‘ğ‘¥Î¨,âŒˆğ‘ğ‘¢ğ‘šğ‘‚ğ‘“ğ¸ğ‘“ğ‘“ğ‘’ğ‘ğ‘¡ğ‘–ğ‘£ğ‘’ğµğ‘¦ğ‘¡ğ‘’ğ‘  (ğ‘ ,ğ‘š)
ğ›¾âŒ‰)(5)
whereğ‘ğ‘¢ğ‘šğ‘‚ğ‘“ğ¸ğ‘“ğ‘“ğ‘’ğ‘ğ‘¡ğ‘–ğ‘£ğ‘’ğµğ‘¦ğ‘¡ğ‘’ğ‘  (ğ‘ ,ğ‘š)indicatesthenumberofinput
bytes that can affect the constraint variable(s) of ğ‘šaccording to
2444
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao
the effector map of ğ‘ ;ğ›¾is a constant ratio which controls the gran-
ularity;ğ‘€ğ‘ğ‘¥Î¨is a constant which is the upper bound of Î¨(ğ‘ ,ğ‘š).
The intuition here is that the more input bytes are influencing the
constraint, the more difficult it is for the fuzzer to penetrate the
constraint.
We use the number of bytes affecting the constraints instead of
branchdistancesmainlybecausebranchdistancescannotreflectthe
difficulty of penetrating a branch if the input content goes through
complex data transformations before reaching the branch condi-tions. For example, suppose we have an
ifcondition comparing
themd5sumoftheinputcontentwithaconstantstring.Assume,
the constant string is DEADBEEF and the md5sum of the input is
HEADBEEF .Ifweusebranchdistancehere,thecalculateddistanceis
very short since the md5sum is only one byte away from matching
the constant string. However, the fuzzer will need to modify the
contentoftheentireinputtomakethemd5summatchtheconstant
string. Therefore, in this case, using the number of bytes affecting
the constraints is a better choice. In addition, we empirically found
in the experiments that using the number of bytes affecting the
constraints can yield good results (Â§ 4).
3.4 Data Flow Sensitive Mutation
With the information provided by the effector map, WindRanger
adopts data flow sensitive mutation to better penetrate branchconditions.Givenaseedanditseffectormap,WindRangerfirst
checksifitisrunningintheexploitationstageorexplorationstage.
If WindRanger is running in the exploitation stage, it identifiesthe input bytes related to the constraint variables of the DBBsa s
high priority bytes. Otherwise, it identifies the input byte relatedto all the constraint variables as high priority bytes. During the
randommutation,highprioritybytesaregivenalargerchanceofmutation.
In addition, fora constraint variable andits related input bytes,
iftherelatedinputbytesareconsecutive,WindRangeralsochecks
if the variable and the related input bytes share thesame value. If
they have the same value, it is likely that the input bytes did notgothroughdatatransformations.Inthiscase,WindRangerwilltry to replace the related input bytes with the value of the othercomparison operand of the constraint before applying random
mutations.
3.5 Seed Prioritization
Similar to data flow sensitive mutation, the seed prioritization also
works differently during the exploitation stage and exploration
stage. During the exploitation stage, WindRanger maintains a
two-levelpriorityqueue.First,foreach DBB,WindRangerfinds
a list of seeds that can cover this DBB. Then, WindRanger sorts
the list of every DBBin ascending order according to the distances
of the seeds. Lastly, WindRanger selects the first seed on everylist and puts them into the favored queue with higher priority,and puts the rest of the seeds into the less favored queue. Whenselecting the next seed for mutation, WindRanger has a higherchance to select from the favored queue. During the exploration
stage,WindRangerworkslikeanormalCGFandprioritizesthe
seeds which can help to achieve better code coverage.As for power scheduling, WindRanger follows the simulated
annealing algorithm proposed in AFLGo [ 3]. The only difference is
the seed distance used for energy calculation.
3.6 Dynamic Switch between Explore and
Exploit Stage
Although the purpose of DGF is to reach the targets as fast as
possible, DGF still needs enough coverage exploration to avoid
gettingstuckinlocaloptima.Forexample,AFLGoadoptsauser-
definedtimebudgetinadvancetosplittheexplorationstageand
exploitation stage. However, strong domain knowledge is required
fortheuserstofindsuitabletimebudgetsfordifferentprograms.
Toaddressthisissue,weproposetodynamicallyswitchbetween
theexploration andexploitation stageaccording tothe execution
status ofDBBs.
Specifically, during fuzzing, WindRanger maintains all existing
DBBsasaglobalset(denotedas Î¦(ğ¹)).Intheexploitstage,when
allDBBsi nÎ¦(ğ¹)have been exploited adequately, WindRanger
switchestotheexplorationstage.Whethera DBBhasbeenexploited
adequatelyisdecidedaccordingtohowmanytimesthe DBBhas
been executed.
Formally, whether an input ğ‘¥can hit a basic block ğ‘(denoted as
â„ğ‘–ğ‘¡(ğ‘¥,ğ‘)) or not can be defined as
â„ğ‘–ğ‘¡(ğ‘¥,ğ‘)=/braceleftbigg1,ğ‘âˆˆğœ‰(ğ‘¥)
0,ğ‘âˆ‰ğœ‰(ğ‘¥)(6)
whereğœ‰(ğ‘¥)consist of all basic blocks in the execution trace of ğ‘¥.
During fuzzing, WindRanger records the number of how many
times each basic block has been hit. Formally, the hit count of a
basic block ğ‘is
ğ‘›ğ‘¢ğ‘šğ»ğ‘–ğ‘¡(ğ‘)=/summationdisplay.1
ğ‘¥âˆˆIâ„ğ‘–ğ‘¡(ğ‘¥,ğ‘) (7)
whereIis the set of all inputs produced by fuzzing so far.
Basedonthehitcount,abasicblock ğ‘isconsideredasexploited
adequately such that
ğ‘›ğ‘¢ğ‘šğ»ğ‘–ğ‘¡(ğ‘)>ğœÂ·min
ğ‘/primeâˆˆğ‘‡ğ‘›ğ‘¢ğ‘šğ»ğ‘–ğ‘¡(ğ‘/prime) (8)
whereTisthesetofallbasicblocksWindRangerhasencountered
during fuzzing; ğœis a constant factor.
As forswitching fromthe explorationstage tothe exploitation
stage,if WindRangerdiscoversnew DBBduringtheexploration
stage, it will switch to the exploitation stage. Note that the switch-
ing between stages always happens after WindRanger finishes
mutatingaseedandbeforeitselectsanewseedtomutate,asshown
in Figure 2.
4 IMPLEMENTATION & EVALUATION
The implementation of WindRanger mainly consists of two parts:
static analyzer and dynamic fuzzer. For the static analyzer, we
leverage the static analysis framework SVF [ 38] to construct iCFG
from LLVM IR. The static analyzer is implemented with about 900
lines of C/C++ code. The dynamic fuzzer is implemented based on
AFL [23], version 2.52b, with about 1000 lines of C code.
Withtheimplementedprototypeof WindRanger,weconducted
largescaleexperimentstoanswerthefollowingresearchquestions:
2445
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. WindRanger: A Directed Greybox Fuzzer driven by Deviation Basic Blocks ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA
RQ1: How good is the ability of WindRanger for reaching prede-
fined target sites?
RQ2:Howgoodistheperformanceof WindRangerintermsof
reproducing the target bugs?RQ3
:HowdoeseverycomponentinWindRangeraffecttheoverall
performance?RQ4: Can WindRanger help in real-world bug hunting?
4.1 Evaluation Setup
EvaluationDatasets .Weuseprogramsfromthefollowingdatasets
as the evaluation benchmarks:
â€¢UniBench[ 27]isarecentdatasetproposedtoevaluatefuzzing
works. It contains 20 real-world programs of 6 different cate-
gories (categorized according to the input file type). We selected
4targetsitesperprogramfromthisdatasettoevaluatetheTime-
to-Targets (TTT) of different techniques. This set of benchmarks
are used to answer RQ1andRQ3.
â€¢AFLGo Test Suite [ 3] is a set of programs with n-day vulnera-
bilities used in the experiments of AFLGo [ 5]. This test suite
hasbeenusedinseveralresearchworks[ 3,8]toevaluate DGF
techniques. This set of benchmarks are used to answer RQ2.
â€¢FuzzerTestSuite[ 18]isasetoffuzzingbenchmarksproposed
by Google. It contains several real-world programs with known
vulnerabilityinformationandisacommonbenchmarkusedin
fuzzing research [ 10,21]. This set of benchmarks are used to
answerRQ2.
Evaluated Techniques . Since WindRanger is built on the top of
AFL, we compare WindRanger with several AFL-based fuzzers
to avoid the potential bias caused by the implementation of the
techniques:â€¢
WindRanger is the tool proposed in this paper. We empirically
set the values of various configurable options (such as ğ›¾in Equa-
tion 5). All the settings for the configurable options are available
on our website [14].
â€¢AFLGo [3] is a state-of-the-art DGF technique. Other directed
grey-box fuzzers (e.g. HawkEye [ 8], FuzzGuard[ 49], etc.)are
not publicly available by the time of writing this paper.
â€¢AFL [23] is a representative coverage-guided grey-box fuzzer
whichisthebasisofmanyotherfuzzingtechniques[ 3,16,25,47].
â€¢FairFuzz [ 25] is a derivation of AFL. We chose FairFuzz for
comparisonbecauseFairFuzzalsousestheprobingtechniqueto
collect taint information to facilitate fuzzing. Note that although
FairFuzzsharessimilaritieswithWindRanger,itstillrepresents
advanced CGF techniques since its purpose is to maximize code
coverage.
By comparing with the CGF techniques, we can demonstrate
thatWindRangercantrulybringdirectednesstogrey-boxfuzzers.
By comparing with AFLGo, we can demonstrate the effectiveness
of the strategies proposed in WindRanger.Evaluation Criteria.
We use two types of criteria to evaluate the
performance of different techniques:â€¢
Time-to-Target (TTT) is used to measure the time used by the
fuzzer to generate the first input which can hit the specifiedtargetsite.Thiscriterionisusedtoevaluatethetechniqueson
benchmarks without known bugs.â€¢Time-to-Exposure(TTE)isusedtomeasurethetimeusedbythe
fuzzer to trigger a known bug. This criterion is used to evaluate
the techniques on benchmarks with known bugs.
Experiments Settings . By default, all the experiments were re-
peated10timeswithtimebudgetsof24hours,exceptfortheexper-imentsontheAFLGoTestSuite.Wefollowedthesetupinthepaperof AFLGowheretheexperimentswererepeated20timeswithtimebudgetsof8hours.Forthestatisticaltest,weusetheMann-Whitney
U test (ğ‘-ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’) to measure the statistical significance of the exper-
iment results. Moreover, we also use the Vargha-Delaney statistic
(Ë†ğ´12)[39] to measure the chance for one technique to perform
better than another.
Experiments Environment . We conducted the experiments
on machines equipped with Intel(R) Xeon(R) Gold 5118 CPU @
2.30GHz with 48 cores, using Ubuntu 20.04.3 LTS as the operating
system. During experiments, each fuzzer instance runs in a docker
container [12] and binds to one CPU core.
4.2 Target Site Reaching Capability (RQ1)
Currently, there is no standard dataset for evaluating TTT for
DGF techniques. Although Google fuzzer test suite contains three
projects ( libjpeg-turbo-07-2017, libpng 1.2.56 andfreetype2-2017 )
withgiventargetsitestotesttheabilityoffuzzerstocoverthese
locations,wefoundtheminsufficient.First,theamountoftarget
sitesissmall(only5).Second,usingAFL-basedfuzzers,sometarget
sites are easy to reach (1 second) with provided seeds or can notreach within the time budget (24 hours) without provided seeds
because this test suite was initially designed for LibFuzzer.
To get a dataset with abundant and valid target sites, we use the
UniBenchdatasetwhichhasdiverseprograms.Tocollectthetarget
sites from the programs, we use the following steps: Â‚For each
program, first we run AFL for 24h, repeat 10 times. During eachrun, we record the first-reach time (the time cost to generate thefirst seed to cover the basic block) for each basic block;
ÂƒThen,
we calculate the average first-reach time across the 10 runs for
each basic block; Â„Based on the average first-reach time for each
basic block, we use four scale time values (5 hours, 10 hours, 15
hours,20hours)toselectfourtargetsites.Normally,thereexists
no basic block that happens to be reached exactly at the scale time
values.Underthiscircumstance,we choosethetargetsiteswhose
first-reach time is close to the scale time value.
With the benchmark built on top of UniFuzz, we compare Win-
dRangerwiththebaselinestoevaluatehowmuchtimetheycost
to reach the selected target sites. We conducted the experiments
onalltheprogramsinUniBench(theresultsforalltheprograms
areonourwebsite[ 14]).However,duetothepagelimitation,we
select 6 programs (one program for a program type) and showthe results in Table 1. On most of the target sites (20/24), Win-
dRangeroutperformsallotherfuzzersandachievestheshortest
ğœ‡TTT.Overall,intermofmeanTTT,WindRangeroutperforms
CGFs(AFL,FairFuzz)by56%and55%respectivelyandoutperforms
DGF(AFLGo) by 31%. Besides, WindRanger outperforms AFLGo,
AFL and FairFuzz by 21%, 34% and 37% respectively on all the pro-
grams.Accordingtothevaluesofmean Ë†ğ´12againstotherfuzzers
(0.75 with AFL and Fairfuzz, 0.67 with AFLGo), we have enough
2446
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao
Table 1: Time-to-target results on programs from UniBench. For each target site, the statistically significant ( ğ‘-ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’< 0.05)
values of Ë†ğ´12is highlighted in bold; the shortest mean TTT is marked with an asterisk
âˆ—The detailed experiment results for all the programs are on our website [14]
Prog TargetsAFL AFLGo FairFuzz WindRanger
Runs ğœ‡TTT Factor Ë†ğ´12Runs ğœ‡TTT Factor Ë†ğ´12Runs ğœ‡TTT Factor Ë†ğ´12Runs ğœ‡TTT
imginfojpc_cs.c:316 10 1h28m 2.43 0.8710 1h1m 1.68 0.8210 1h17m 2.14 0.8510âˆ—36m17s
bmp_dec.c:474 10 2h20m 2.23 0.8610 1h40m 1.61 0.7510 2h12m 2.11 0.7910âˆ—1h2m
jas_image.c:378 10 6h30m 1.26 0.70 10 7h42m 1.50 0.8010 5h51m 1.14 0.61 10âˆ—5h8m
jas_stream.h:1026 7 16h33m 1.42 0.828 15h24m 1.35 0.737 18h0m 1.54 0.869âˆ—11h37m
lamegain_analysis.c:224 10 1h10m 3.11 0.9010 51m35s 2.30 0.8810 1h17m 3.40 0.9410âˆ—22m40s
bitstream.c:399 10 5h16m 1.27 0.69 10âˆ—3h59m 0.96 0.47 10 5h39m 1.40 0.7510 4h8m
get_audio.c:1452 10 14h40m 1.70 0.8810 11h46m 1.33 0.7910 13h1m 1.47 0.8410âˆ—8h51m
mpglib_interface.c:142 7 19h37m 1.64 0.778 15h53m 1.43 0.64 8 18h13m 1.52 0.719âˆ—11h57m
mp42aacAp4ByteStream.cpp:199 10 4h43m 1.47 0.7610 4h12m 1.31 0.66 10 5h25m 1.69 0.7710âˆ—3h11m
Ap4Lish.h:172 10 9h38m 1.34 0.7410âˆ—7h1m 0.97 0.50 10 9h14m 1.28 0.7510 7h11m
Ap4CttsAtom.cpp:170 8 15h48m 1.46 0.818 14h31m 1.34 0.7510 15h22m 1.42 0.809 10h47m
Ap4ElstAtom.cpp:100 5 20h10m 1.17 0.66 6 18h38m 1.08 0.59 3 21h43m 1.26 0.737âˆ—17h14m
mujsjsrun.c:1024 10 5h39m 1.47 0.72 10 5h11m 1.35 0.68 10 7h13m 1.66 0.81 10âˆ—3h50m
jsdump.c:867 9 10h12m 2.18 0.8510 4h59m 1.15 0.6810 7h13m 1.66 0.8110âˆ—4h21m
jsdump.c:892 9 14h1m 1.85 0.8610 9h23m 1.24 0.64 8 13h11m 1.74 0.8210âˆ—7h33m
jsvalue.c:396 6 19h10m 1.28 0.758 17h44m 1.18 0.757 18h55m 1.26 0.769âˆ—14h58m
objdumpobjdump.c:10875 10 5h6m 1.30 0.69 10 4h38m 1.18 0.61 10 6h13m 1.58 0.8110âˆ—3h55m
section.c:943 10 10h8m 1.20 0.7410 11h29m 1.36 0.8410 11h50m 1.40 0.8510âˆ—8h24m
objdump.c:1514 8 15h31m 1.12 0.61 10âˆ—12h54m 0.93 0.47 8 16h31m 1.20 0.65 9 13h46m
dwarf2.c:3176 3 20h58m 1.17 0.65 4 19h59m 1.12 0.61 5 19h19m 1.08 0.56 6âˆ—17h49m
tcpdumpprint-ppp.c:729 10 5h2m 1.51 0.69 10 4h35m 1.37 0.63 10 5h29m 1.64 0.7710âˆ—3h20m
extract.h:591 9 9h53m 1.70 0.7610 7h34m 1.40 0.6910 8h24m 1.44 0.7410âˆ—5h48m
print-l2tp.c:840 10 15h4m 1.20 0.7010 14h27m 1.15 0.63 10 15h21m 1.22 0.7010âˆ—12h33m
print-decnet.c:832 5 20h23m 0.95 0.44 3 22h37m 1.05 0.58 6âˆ—19h53m 0.92 0.40 4 21h39m
ğœ‡TTTinc +56% +31% +55%
meanË†ğ´12 0.75 0.67 0.75
ğœ‡TTT inc (all programs) +34% +21% +37%
confidencetoconcludethatWindRangerhasbettercapabilityto
reach the given target sites than other tools.
4.3 Bug Reproducing Capability (RQ2)
Reproducingbugs/crashesisanimportantapplicationofdirected
fuzzing. Here we study the bug reproducing capability of Win-
dRangerbycomparingitwiththebaselinesusingtheTTEcrite-
rion.
4.3.1 AFLGo Test Suite. Inthepaper[ 3]andwebsite[ 5]of AFLGo,
therearesomeprogramswithknownvulnerabilitiesbeusedtoeval-
uatethedirectness ofDGF.Hence,wecomparethe performanceof
WindRangerontheseprogramsdirectlywithothertools.Specially,
GUN Binutils 2.26 [ 2] and Libming 0.4.8 [ 29] with 9 CVEs are used
in this experiment. We follow the same experiment settings in [ 3]:
each instance conducted 20 times; with the time budget set to 8
hours; use an empty file as initial seed.
Thistest suiteconsistsof programsfrom GUNBinutils2.26 [ 2]
andLibming0.4.8[ 29]with9CVEs.However,inthepreliminary
experiments,wefoundthatplentyofcrashesarisewhenfuzzing
Binutils 2.26 but only 7 CVEs among them were used in the experi-
mentsof AFLGo.Itrequirescumbersomemanualeffortstoclassify
these crashes to find the corresponding CVEs. To minimize thedeviationcausedbymanuallabelingandimprovethesoundness
of the results, we conduct experiments on Binutil 2.28 in which all
theCVEsusedintheexperimenthavebeenpatched.ForeachCVE,we reverse its related patch(es) to ensure only this CVE is exposed
in the experiments.
Table2showstheresultsfromwhichwecanobservethat:1)For
CVEs which are difficult to expose ( ğœ‡TTE > 1 hour), WindRanger
significantly outperforms other tools by 1.22 Ã—to 2.2Ã—faster to ex-
pose them. For CVE-2016-4491 and CVE-2016-6131, WindRanger
getthemosthittingrounds(6and8rounds).2)The valueof Ë†ğ´12
shows that WindRanger steadily achieves better performance, es-
pecially for CVE-2018-8807 and CVE-2018-8962, of which Ë†ğ´12is
equalorgreaterthan0.75againstothertools.3)ForCVE-2016-4489
and CVE-2016-4490, WindRanger do not exhibit better perfor-
mancethanAFLGo.However,theseCVEsareeasytoexposewhich
only need few minutes. On these CVEs, the randomness of fuzzing
matters for ğœ‡TTE.
4.3.2 Fuzzer Test Suite. Compared to the bugs in AFLGo test suite,
thebugsinGooglefuzzertestsuiterequirenoclassificationsince
eachprogramonlycontainsonebug.Theexperimentresultsare
shown in Table 3. The results in Table 3 demonstrate that by set-
tingvulnerabilitieslocationsastargetsites, DGFs(WindRanger
andAFLGo)canachievebetterperformanceonexposingrelative
crashes than CGFs (AFL and FairFuzz). Among the 11 vulnerabili-
ties,WindRangergainsbetter ğœ‡TTEon 9.Overall,WindRanger
achieves a mean speed up in TTE of 47% against AFL and 59%
againstFairFuzz.ComparedtoAFLGo,the30%speedupshows
thatWindRangerownsbetterdirectednesscapability.Moreover,
2447
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. WindRanger: A Directed Greybox Fuzzer driven by Deviation Basic Blocks ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA
Table 2: Crash exposure results on aflgo test suite. For each
CVE, the statistically significant ( ğ‘-ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’< 0.05) values of
Ë†ğ´12ishighlightedinbold;theshortestmeanTTEismarked
with an asterisk
CVE-ID Tool Runs ğœ‡TTE Factor Ë†ğ´12
binutils2016-4487WindRanger 20 âˆ—1m58s - -
AFL 20 3m41s 1.92 0.82
AFLGo 20 3m18s 1.37 0.65
FairFuzz 20 4m15s 2.22 0.87
2016-4488WindRanger 20 âˆ—10m25s - -
AFL 20 16m39s 1.60 0.86
AFLGo 20 13m15s 1.27 0.70
FairFuzz 20 15m57s 1.50 0.86
2016-4489WindRanger 20 5m7s - -
AFL 20 6m38s 1.30 0.66
AFLGo 20 âˆ—4m22s 0.85 0.39
FairFuzz 20 5m19s 1.04 0.49
2016-4490WindRanger 20 2m5s - -
AFL 20 âˆ—1m21s 0.65 0.25
AFLGo 20 1m29s 0.71 0.30
FairFuzz 20 2m48s 1.34 0.67
2016-4491WindRanger 6 âˆ—5h26m - -
AFL 5 6h37m 1.22 0.63
AFLGo 4 7h4m 1.30 0.70
FairFuzz 3 7h28m 1.37 0.72
2016-4492WindRanger 20 âˆ—8m32s - -
AFL 20 14m34s 1.71 0.84
AFLGo 20 9m39s 1.13 0.63
FairFuzz 20 15m4s 1.77 0.89
2016-6131WindRanger 8 âˆ—4h58m - -
AFL 3 7h17m 1.46 0.82
AFLGo 6 6h5m 1.22 0.66
FairFuzz 5 6h57m 1.40 0.76
libming2018-8807WindRanger 20 âˆ—1h32m - -
AFL 20 2h16m 1.47 0.78
AFLGo 20 2h41m 1.73 0.85
FairFuzz 20 2h49m 1.82 0.87
2018-8962WindRanger 20 âˆ—1h38m - -
AFL 20 2h22m 1.46 0.75
AFLGo 20 3h36m 2.20 0.93
FairFuzz 20 2h50m 1.74 0.80
three vulnerabilities only take a few minutes or seconds to trigger
(note that the two vulnerabilities on which WindRanger does not
achieve the best results both belong to these three vulnerabilities).
Normally these easy-to-trigger crashes can hardly benefit from
DGF,andifweonlyconsiderthevulnerabilitieswhose ğœ‡TTEex-
ceed 1 hour, WindRanger can achieve larger performance gain
with speed up of 66% against AFL, 44% against AFLGo and 77%
against FairFuzz.
4.4 Impact of Different Components (RQ3)
ToinvestigatetheimpactofdifferentcomponentsinWindRanger,
wedisableeachcomponentindividuallyandconductexperiments
on the same targets selected from UniBench as in Â§ 4.2.
Table 4 shows the results. We can observe that disabling each
componentcausesanincrease(>10%)onTTT,whichmeanseach
component has a significant impact on the performance of Win-dRanger. Among the four components, the data flow sensitivemutation component contributes the most with a 22% speed up
on TTE. By disabling other components (distance calculation, seedprioritization, and explore-exploit stage switch), we also see an in-
creaseinTTEof12%,17%,and15%respectively.Notethatallthesecomponentsarerelatedtotheconceptof DBB,whichdemonstrates
the usefulness of DBBin DGF.
4.5 New Vulnerability (RQ4)

	
Figure3:Thetimecosttoexposethenewvulnerabilityin10runs
Tochecktheif WindRangercanbeusedforhuntingpreviously
unknownbugs,wegavetheprototypeof WindRangertoasecurity
expert5. This security expert tried WindRanger on an interesting
target, ffmpeg [ 15], which is a popular multimedia library and is
well-fuzzed[ 17].ItisheavilyfuzzedbyOSS-fuzzwithclustersof
machinesandusingconventionalfuzzingstrategiescanhardlyyield
any crash/bug. Therefore, the security expert conducted manual
codereviewtoidentifysuspiciouslocationsbeforefuzzing.Tobe
specific, she selected 50 assertions as the interesting locations to
test (Details about the assertion locations can be found on our web
site [14]).
Then,shetriedtobuildagoodenoughseed(thoughcannotreach
anyofthetargets)andfedtheinterestinglocationsastargetsites
toWindRangertoperformdirectedfuzzing.Eventually,shefound
one assertion fail among 50 assertions on the development branch.
Note that on the release branch, all assertions will be removedand this assertion fail can possibly lead to security issues. Theassertion fail has been confirmed as a vulnerability and fixed by
thedevelopers. Moreover,itreceived aCVE-ID(CVE-2021-38291).
Thenwetooktheinitialseedtogetherwiththevulnerablever-
sion of ffmpeg and used the vulnerability as the target site, to
compareWindRangerwithAFLGoonexposingthenewvulner-
ability. Figure 3 shows the results. The horizontal axis indicatesthe time cost to expose (TTE) the vulnerability. The boxes in thegraphindicate theTTE resultsof correspondingtools in10 runs.
FromFigure3,wecanobservethatWindRangercostslesstime
to expose the vulnerability in almost every run. Specifically, themedian TTE of WindRanger (8220s) is 1.64
Ã—smaller than the
meadian TTE of AFLGo (13440s).
5 THREATS TO VALIDITY
Thefirstinternalthreatcomesfromtheaccuracyofthereachability
analysis, which directly affects the identification of DBBs. The cur-
rentimplementationof WindRangerusestheSVFframework[ 38]
toobtaintheiCFGtoanalyzethereachabilityofthebasicblocks.
The iCFG can be erroneous due to some pitfalls such as inaccurate
5The security expert works in a security company and is not involved in the develop-
ment of our tool.
2448
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao
Table 3: Time for exposing the known crashes in Google fuzzer test suite. For each vulnerability, the statistically significant
(ğ‘-ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’< 0.05) values of Ë†ğ´12is highlighted in bold; the shortest mean TTE is marked with an asterisk. BO = buffer overflow;
UAF = use after free; ML = memory leak; AE = assertion error
Prog TypeAFL AFLGo FairFuzz WindRanger
ğœ‡TTE Factor Ë†ğ´12ğœ‡TTE Factor Ë†ğ´12ğœ‡TTE Factor Ë†ğ´12 ğœ‡TTE
boringssl UAF 1h47m 2.04 0.861h21m 1.56 0.821h55m 2.19 0.85 âˆ—52m36s
guetzli AE 6h13m 1.29 0.65 5h58m 1.24 0.59 6h30m 1.34 0.67 âˆ—3h40m
libarchive BO 5h33m 1.59 0.794h12m 1.35 0.67 5h21m 1.53 0.75 âˆ—3h29m
libssh ML âˆ—4m41s 0.83 0.37 5m12s 0.92 0.47 5m46s 1.02 0.56 5m38s
libxml2 BO 4h41m 1.57 0.783h54m 1.30 0.675h16m 1.76 0.77 âˆ—2h59m
pcre2 UAF 6h12m 1.82 0.815h52m 1.72 0.748h3m 2.37 0.93 âˆ—3h23m
pcre2 BO 9h26m 1.41 0.718h38m 1.29 0.67 9h6m 1.36 0.70 âˆ—6h39m
re2 BO 7h2m 1.20 0.678h29m 1.45 0.767h39m 1.31 0.59 âˆ—5h49m
woff2 BO 2h51m 2.34 0.871h55m 1.57 0.65 2h48m 2.29 0.74 âˆ—1h13m
c-ares BO 54s 0.93 0.45 âˆ—53s 0.91 0.42 1m6s 1.13 0.59 58s
openssl-1.0.1f BO 5m38s 1.10 0.57 5m31s 1.08 0.57 6m1s 1.17 0.65 âˆ—5m6s
ğœ‡TTE inc +47% +30% +59%
ğœ‡TTE(> 1h) inc +66% +44% +77%
Table 4: TTT results of disabling each improved component in WindRanger. Short names for components: DC = distance
calculation; SP = seed prioritization; M = data flow sensitive mutation; EES = explore-exploit stage switch
Prog TargetsDefault No DC No SP No M No EES
Runs ğœ‡TTTRuns ğœ‡TTTRuns ğœ‡TTTRuns ğœ‡TTTRuns ğœ‡TTT
imginfojpc_cs.c:316 10 36m17s 10 43m57s 10 50m18s 10 58m44s 10 41m20s
bmp_dec.c:474 10 1h2m 10 1h21m 10 1h36m 10 1h19m 10 1h30m
jas_image.c:378 10 5h8m 10 5h48m 10 5h22m 10 5h32m 10 5h29m
jas_stream.h:1026 9 11h37m 9 12h48m 9 13h6m 9 14h17m 9 13h8m
lamegain_analysis.c:224 10 22m40s 10 33m18s 10 43m15s 10 53m14s 10 40m54s
bitstream.c:399 10 4h8m 10 4h27m 10 4h43m 10 4h19m 10 3h54m
get_audio.c:1452 10 8h51m 10 9h43m 10 10h18m 10 10h36m 10 10h9m
mpglib_interface.c:142 8 11h57m 8 13h5m 8 12h44m 8 14h39m 8 14h7m
mp42aacAp4ByteStream.cpp:199 10 3h11m 10 3h29m 10 3h41m 10 4h3m 10 3h57m
Ap4Lish.h:172 10 7h11m 10 7h33m 10 7h5m 10 7h15m 10 6h55m
Ap4CttsAtom.cpp:170 9 10h47m 9 12h7m 8 13h10m 8 13h43m 8 13h19m
Ap4ElstAtom.cpp:100 6 17h14m 6 17h51m 6 17h36m 6 18h11m 6 18h28m
mujsjsrun.c:1024 10 3h50m 10 4h46m 10 4h24m 10 4h53m 10 4h36m
jsdump.c:867 10 4h21m 10 4h52m 10 5h18m 10 5h33m 10 5h35m
jsdump.c:892 10 7h33m 10 9h16m 10 8h49m 10 9h17m 10 8h20m
jsvalue.c:396 9 14h58m 9 16h47m 9 15h45m 8 17h21m 8 16h57m
objdumpobjdump.c:10875 10 3h55m 10 4h29m 10 4h11m 10 4h53m 10 4h29m
section.c:943 10 8h24m 10 9h10m 10 8h54m 10 8h49m 10 8h33m
objdump.c:1514 9 13h46m 9 13h45m 9 12h47m 9 13h21m 9 13h6m
dwarf2.c:3176 6 17h49m 6 18h28m 6 18h42m 6 18h55m 6 18h11m
tcpdumpprint-ppp.c:729 10 3h20m 10 3h38m 10 4h13m 10 4h5m 10 3h30m
extract.h:591 10 5h48m 10 6h15m 10 7h13m 10 6h31m 10 7h21m
print-l2tp.c:840 10 12h33m 10 12h42m 10 13h40m 10 12h54m 10 13h16m
print-decnet.c:832 4 21h30m 4 19h44m 4 21h34m 4 21h14m 4 20h52m
ğœ‡TTTInc +12% +17% +22% +15%.
pointer analysis. After analyzing the experiment results, we empir-
ically find that the quality of the current reachability analysis is
enoughtoyieldgoodperformance.Thus,weleavetheimprovement
of the reachability analysis as future work.
The second internal threat comes from the configurable options
in WindRanger such as the variable for tuning the seed distances
andthethresholdfortheexploration-exploitationswitching.We
empirically choose the variable values for experiments and the
currentexperimentresultsarepromising.Webelievefine-tuningtheconfigurableoptionscanfurtherimprovetheexperimentresults
butitisnotthekeytechniquetodiscuss.Thus,weleavefine-tuning
the configurable options as future work.
The external threats mainly come from the experiment setup.
Tool evaluation results should always be taken with a grain of
salt. To mitigate the randomness in the experiments, we follow thesuggestions in [
22] to repeat the experiments for 10 or 20 runs and
applystatisticaltestsontheresults.Tomitigatetheinfluencesof
different implementations, we choose the techniques implemented
2449
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. WindRanger: A Directed Greybox Fuzzer driven by Deviation Basic Blocks ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA
basedonAFLasbaselinessinceWindRangerisalsobuiltontop
of AFL. Furthermore, we also conduct fine-grained crash triage for
the TTE experiments to acquire more accurate results.
6 RELATED WORK
Instead ofdiscussing all therelated works, we focuson the most
relatedones.Ourworkismainlyrelatedtothreetopics:directed
symbolicexecution,directedgrey-boxfuzzingandcoverage-guided
grey-box fuzzing.
Directed Symbolic Execution. Directed Symbolic Execution
(DSE)isatechniquewhichreliesonsymbolicexecutiontoreach
thetargetsites.SeveralworkshavebeenproposedtodeployDSEin
diversetasks,suchaspatchtesting[ 31,35],totestcriticalsystem
calls [19], to validate static analysis reports [ 11]. DSE leverages
synergisticprograminformationtogaindirectness,comparedwith
generalsymbolicexecutiontechniqueslikeKLEE[ 6],DSEcanef-
fectivelytestdesiredpartsofPUT.However,DSEisnoteffectiveon
real-world programs as symbolic execution techniques suffer from
problemslikepath-explosion[ 37].ComparetoDSE,oursolution
WindRanger belongs to directed grey-box fuzzing (DGF) which is
only rely on lightweight program analysis and is more effective on
real-world programs as discussed in [3].
DirectedGrey-boxFuzzing .DirectedGrey-boxFuzzing(DGF)
aims to bring directedness to grey-box fuzzing. AFLGo [ 3]i st h e
first DGF. To gain the directness ability, the authors of AFLGo
proposedmethodstocalculatethedistancebetweenaseedtraceand target sites, this distance is used in the power schedule to
decide the energy of the seed. Hawkeye [ 8] improves AFLGo with
trace augmented power schedule, seed prioritization, and adaptive
mutation.AFLGoandHawkeyebothconsiderallbasicblocksintheseeddistancecalculation.Differentfromthis,WindRangerfocusesonimportantbasicblockswhichhinderinputsreachingtargetsitestoimprove theefficiencyofDGF.Besides,FuzzGuard[
49]leverages
deeplearningtofilteroutinputswhichareunreachabletotarget
sitesbeforefeedingthemtoDGF .However,W indRangerimproves
the efficiency of DGF and is orthogonal to FuzzGuard.
Some works deployed DGF on different kinds of target sites.
Leopard[ 13]usesprogramsmetricstoidentifythevulnerablecode
intheprogramandsetthemastargetsites.Parmesan[ 33]identifies
the program locations instrumented by sanitizers (like ASAN [ 36])
and uses these locations as target sites. Besides, Parmesan calcu-
latesdistancebasedondynamicallyconstructedCFG.CAFL[ 24]
leveragesinformationoforderedtargetsitesanddataconditions
to boost up the DGFâ€™s capability to expose targeted crashes. These
works can gain better performance with more efficient DGF which
WindRanger aims at.
Coverage-guided Grey-box Fuzzing . Coverage-guided Grey-
boxFuzzing(CGF)aimstoguidefuzzingtocovermorecode.AFL[ 23]
isaclassicCGFthatemployscoverageasfeedbacktoguideseeds
evolution. To increase the coverage in CGF, a research direction
is tohelp CGF solvethe conditionconstraints in thePUT. Hybrid
fuzzing [37,47] combines CGF and symbolic execution to enhance
the constraint solving ability in CGF. Several other works adopt
lightweightmethodstohelpwithconstraintsolving.Steelix[ 26]
useslight-weightstaticanalysisandbinaryinstrumentationtogain
thecomparisonprogressinformationwhichhelpsCGFtoexplorepaths protected by magic bytes comparisons. Angora [ 9] uses a
novel technique called gradient descent based input search to solv-
ingconstraintswithoutsymbolicexecution.Greyone[ 16]adopts
fuzzing-driven inference to conduct taint and uses data flow fea-
tures to guide the evolution of fuzzing. FairFuzz [ 25] identifies and
masks the bytes which influence producing inputs covering rarebranches.Besidestechniquesforpenetratingbranches,thereare
alsosomeothertechniquesfocusingonimprovingtheseedschedul-ingprocess[
4,28,42,46],detectingspecifictypesofbugs[ 7,41,44]
and automatic fuzz harness generation [ 1,20,48]. Although the
aimof WindRangerisreachingtargetsitesefficientlyinsteadof
increasing code coverage, WindRanger can benefit from some of
thetechniquesusedinCGF(e.g.,theconstraintsolvingtechniques).
7 CONCLUSION
In this paper, we propose the concept of deviation basic block in
the context of directed grey-box fuzzing. We propose an approach
called WindRanger to effectively identify and use the deviationbasic blocks to facilitate directed grey-box fuzzing. We conduct
38,400CPUhoursofexperimentstoevaluateWindRanger.The
evaluation results show that WindRanger can outperform the-state-of-the-art directed grey-box fuzzer by reaching the targetsites 21% faster and exposing the vulnerabilities 44% faster. Last
but not least, WindRanger shows practical usefulness by helping
a security expert to find a 0-day vulnerability in an extensively
fuzzed popular media library.
ACKNOWLEDGEMENTS
ThisresearchispartiallysupportedbytheNationalResearchFoun-
dation, Prime Ministers Office, Singapore under its National Cy-
bersecurityR&DProgram(AwardNo.NRF2018NCR-NCR005-0001),NRFInvestigatorshipNRFI06-2020-0022-0001,theNationalResearchFoundationthroughitsNationalSatelliteofExcellenceinTrustwor-thySoftwareSystems(NSOE-TSS)projectundertheNationalCyber-securityR&D(NCR)Grantawardno.NRF2018NCR-NSOE003-0001.
This research is supported by the Ministry of Education, Singapore
under its Academic Research Fund Tier 3 (MOET32020-0004). Any
opinions, findings and conclusions or recommendations expressed
in this material are those of the author(s) and do not reflect the
views of the Ministry of Education, Singapore. This work is also
supported partially by the National Natural Science Foundation of
China under Grants No. 61272078, 62032010, 62172201.
REFERENCES
[1]DomagojBabiÄ‡,StefanBucur,YaohuiChen,FranjoIvanÄiÄ‡,TimKing,Markus
Kusano,CarolineLemieux,LÃ¡szlÃ³Szekeres,andWeiWang.[n.d.]. Fudge:fuzz
drivergeneration atscale.In Proceedingsofthe 201927thACMJoint Meetingon
European Software Engineering Conference and Symposium on the Foundations of
Software Engineering.
[2]GUNBinutils.1990. Acollectionofbinarytools. https://www.gnu.org/software/
binutils/
[3]MarcelBÃ¶hme,Van-ThuanPham,Manh-DungNguyen,andAbhikRoychoudhury.
2017.Directedgreyboxfuzzing.In Proceedingsofthe2017ACMSIGSACConference
on Computer and Communications Security. 2329â€“2344.
[4]Marcel BÃ¶hme, Van-Thuan Pham, and Abhik Roychoudhury. 2016. Coverage-
based greybox fuzzing as markov chain. In Proceedings of the 2016 ACM SIGSAC
Conference on Computer and Communications Security. ACM.
[5]Marcel BÃ¶hme. 2021. Directed Greybox Fuzzing with AFL. https://github.com/
aflgo/aflgo
2450
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. ICSE 2022, May 21â€“29, 2022, Pittsburgh, PA, USA Zhengjie Du, Yuekang Li, Yang Liu, and Bing Mao
[6]Cristian Cadar, Daniel Dunbar, Dawson R Engler, et al .2008. Klee: unassisted
and automatic generation of high-coverage tests for complex systems programs..
InOSDI, Vol. 8. 209â€“224.
[7]Hongxu Chen, Shengjian Guo, Yinxing Xue, Yulei Sui, Cen Zhang, Yuekang
Li,HaijunWang,andYangLiu.2020. MUZZ:Thread-awareGrey-boxFuzzing
forEffectiveBugHuntinginMultithreadedPrograms.In 29thUSENIXSecurity
Symposium(USENIXSecurity20).USENIXAssociation,2325â€“2342. https://www.
usenix.org/conference/usenixsecurity20/presentation/chen-hongxu
[8]HongxuChen,YinxingXue,YuekangLi,BihuanChen,XiaofeiXie,XiuhengWu,
and Yang Liu. 2018. Hawkeye: Towards a desired directed grey-box fuzzer. In
Proceedingsofthe2018ACMSIGSACConferenceonComputerandCommunications
Security. 2095â€“2108.
[9]Peng Chenand HaoChen. 2018. Angora: Efficientfuzzing byprincipled search.
In2018 IEEE Symposium on Security and Privacy (SP). IEEE, 711â€“725.
[10]YuanliangChen,YuJiang,FuchenMa,JieLiang,MingzheWang,ChijinZhou,
XunJiao,andZhuoSu.2019. Enfuzz:Ensemblefuzzingwithseedsynchronization
among diverse fuzzers. In 28th USENIX Security Symposium (USENIX Security 19).
1967â€“1983.
[11]Maria Christakis,Peter MÃ¼ller, and Valentin WÃ¼stholz.2016. Guiding dynamic
symbolic execution toward unverified program executions. In Proceedings of the
38th International Conference on Software Engineering. 144â€“155.
[12] Docker. 2021. Use containers to Build, Share and Run your applications. https:
//www.docker.com/resources/what-container
[13]XiaoningDu,BihuanChen,YuekangLi,JianminGuo,YaqinZhou,YangLiu,and
YuJiang.2019. Leopard:Identifyingvulnerablecodeforvulnerabilityassessment
through program metrics. In 2019 IEEE/ACM 41st International Conference on
Software Engineering (ICSE). IEEE, 60â€“71.
[14]Zhengjie Du and Yuekang Li. 2021. Windranger: Advanced Directed Greybox
Fuzzer. https://sites.google.com/view/windranger-directed-fuzzing/
[15]FFmpeg. 2021. A complete, cross-platform solution to record,convert and stream
audio and video. https://www.ffmpeg.org/
[16]ShuitaoGan,ChaoZhang,PengChen,BodongZhao,XiaojunQin,DongWu,and
ZuoningChen.2020. GREYONE:DataFlowSensitiveFuzzing.In 29thUSENIX
Security Symposium (USENIX Security 20). 2577â€“2594.
[17]Google.2014. FFmpegandathousandfixes. https://security.googleblog.com/
2014/01/ffmpeg-and-thousand-fixes.html
[18]Google. 2021. Set of tests for fuzzing engines. https://github.com/google/fuzzer-
test-suite
[19]IstvanHaller,AsiaSlowinska,MatthiasNeugschwandtner,andHerbertBos.2013.
Dowsing for Overflows: A Guided Fuzzer to Find Buffer Boundary Violations. In
22nd USENIX Security Symposium (USENIX Security 13). 49â€“64.
[20]KyriakosIspoglou,DanielAustin,VishwathMohan,andMathiasPayer.[n.d.].
Fuzzgen:Automaticfuzzergeneration.In 29th{USENIX}SecuritySymposium
({USENIX}Security 20).
[21]Yuseok Jeon, WookHyun Han, Nathan Burow, and Mathias Payer. 2020. FuZZan:
Efficient sanitizer metadata design for fuzzing. In 2020 USENIX Annual Technical
Conference (USENIX ATC 20). 249â€“263.
[22]GeorgeKlees,AndrewRuef,BenjiCooper,ShiyiWei,andMichaelHicks.2018.
EvaluatingFuzzTesting.In Proceedingsofthe2018ACMSIGSACConferenceon
ComputerandCommunicationsSecurity (Toronto,Canada) (CCSâ€™18).Association
forComputingMachinery,NewYork,NY,USA,2123â€“2138. https://doi.org/10.
1145/3243734.3243804
[23]lcamtuf. 2021. American Fuzzy Lop (AFL) Fuzzer. https://lcamtuf.coredump.cx/
afl/
[24]Gwangmu Lee, Woochul Shim, and ByoungyoungLee. 2021. Constraint-guided
DirectedGreyboxFuzzing.In 30thUSENIXSecuritySymposium(USENIXSecurity
21).
[25]Caroline Lemieux and Koushik Sen. 2018. Fairfuzz: A targeted mutation strategyforincreasinggreyboxfuzztestingcoverage.In Proceedingsofthe33rdACM/IEEE
InternationalConference on Automated Software Engineering . 475â€“485.
[26]Yuekang Li, Bihuan Chen, Mahinthan Chandramohan, Shang-Wei Lin, Yang Liu,
and Alwen Tiu. 2017. Steelix: program-state based binary fuzzing. In Proceedings
of the 2017 11th Joint Meeting on Foundations of Software Engineering. 627â€“637.
[27]YuweiLi,ShoulingJi,YuanChen,SizhuangLiang,Wei-HanLee,YueyaoChen,
ChenyangLyu,ChunmingWu,RaheemBeyah,PengCheng,etal .2021.UNIFUZZ:
AHolisticandPragmaticMetrics-DrivenPlatformforEvaluatingFuzzers.In 30th
USENIX Security Symposium (USENIX Security 21).
[28]Yuekang Li, Yinxing Xue, Hongxu Chen, Xiuheng Wu, Cen Zhang, Xiaofei
Xie, Haijun Wang, and Yang Liu. 2019. Cerebro: Context-Aware Adaptive
Fuzzing for Effective Vulnerability Detection. In Proceedings of the 2019 27th
ACM Joint Meeting on European Software Engineering Conference and Sympo-sium on the Foundations of Software Engineering (Tallinn, Estonia) (ESEC/FSE
2019). Association for Computing Machinery, New York, NY, USA, 533â€“544.
https://doi.org/10.1145/3338906.3338975
[29]Libming. 2008. C library for generating Macromedia Flash files (.swf). http:
//www.libming.org/
[30]Valentin J. M. ManÃ¨s, HyungSeok Han, Choongwoo Han, Sang Kil Cha, Manuel
Egele, Edward J. Schwartz, and Maverick Woo. 2018. Fuzzing: Art, Science, andEngineering. CoRRabs/1812.00140 (2018). arXiv:1812.00140 http://arxiv.org/abs/
1812.00140
[31]PaulDanMarinescuandCristianCadar.2013. KATCH:High-coveragetestingof
softwarepatches.In Proceedingsofthe20139thJointMeetingonFoundationsof
Software Engineering. 235â€“245.
[32] NVD. 2018. CVE-2018-8962. https://nvd.nist.gov/vuln/detail/CVE-2018-8962[33]
SebastianÃ–sterlund,KavehRazavi,HerbertBos,andCristianoGiuffrida.2020.
Parmesan:Sanitizer-guidedgreyboxfuzzing.In 29thUSENIXSecuritySymposium
(USENIX Security 20). 2289â€“2306.
[34]Rohan Padhye, Caroline Lemieux, Koushik Sen, Mike Papadakis, and YvesLe Traon. 2019. Semantic fuzzing with zest. In Proceedings of the 28th ACM
SIGSOFT InternationalSymposium on Software Testing and Analysis . 329â€“340.
[35]Raul Santelices, Pavan Kumar Chittimalli, Taweesup Apiwattanapong, Alessan-
dro Orso, and Mary Jean Harrold. 2008. Test-suite augmentation for evolving
software. In 2008 23rd IEEE/ACM International Conference on Automated Software
Engineering. IEEE, 218â€“227.
[36]Konstantin Serebryany, Derek Bruening, Alexander Potapenko, and Dmitriy
Vyukov.2012. Addresssanitizer:Afastaddresssanitychecker.In 2012USENIX
Annual Technical Conference (USENIXATC 12) . 309â€“318.
[37]NickStephens,JohnGrosen,ChristopherSalls,AndrewDutcher,RuoyuWang,
Jacopo Corbetta, Yan Shoshitaishvili, Christopher Kruegel, and Giovanni Vigna.
2016. Driller: Augmenting fuzzing through selective symbolic execution.. In
NDSS, Vol. 16. 1â€“16.
[38]YuleiSuiandJinglingXue.2016.SVF:interproceduralstaticvalue-flowanalysisinLLVM.In Proceedingsofthe25thinternationalconferenceoncompilerconstruction.
265â€“266.
[39]AndrÃ¡s Vargha and Harold D Delaney. 2000. A critique and improvement of
the CL common language effect size statistics of McGraw and Wong. Journal of
Educational and Behavioral Statistics 25, 2 (2000), 101â€“132.
[40]HaijunWang,Xiaofei Xie,YiLi,ChengWen,YuekangLi,YangLiu,Shengchao
Qin, Hongxu Chen, and Yulei Sui. 2020. Typestate-guided fuzzer for discovering
use-after-free vulnerabilities. In 2020 IEEE/ACM 42nd International Conference on
Software Engineering (ICSE). IEEE, 999â€“1010.
[41]HaijunWang,Xiaofei Xie,YiLi,ChengWen,YuekangLi,YangLiu,Shengchao
Qin,HongxuChen,andYuleiSui.2020. Typestate-GuidedFuzzerforDiscovering
Use-after-Free Vulnerabilities. In Proceedings of the ACM/IEEE 42nd International
Conference on Software Engineering (Seoul, South Korea) (ICSE â€™20). Association
for ComputingMachinery, NewYork,NY,USA, 999â€“1010. https://doi.org/10.
1145/3377811.3380386
[42]Jinghan Wang, Chengyu Song, and Heng Yin. 2021. Reinforcement Learning-
based Hierarchical Seed Scheduling for Greybox Fuzzing. In NDSS.
[43]Cheng Wen, Haijun Wang, Yuekang Li, Shengchao Qin, Yang Liu, Zhiwu Xu,Hongxu Chen, Xiaofei Xie, Geguang Pu, and Ting Liu. 2020. Memlock: Mem-ory usage guided fuzzing. In Proceedings of the ACM/IEEE 42nd International
Conference on Software Engineering. 765â€“777.
[44]Cheng Wen, Haijun Wang, Yuekang Li, Shengchao Qin, Yang Liu, Zhiwu
Xu, Hongxu Chen, Xiaofei Xie, Geguang Pu, and Ting Liu. 2020. MemLock:
Memory Usage Guided Fuzzing. In Proceedings of the ACM/IEEE 42nd Inter-
national Conference on Software Engineering (Seoul, South Korea) (ICSE â€™20).
Association for Computing Machinery, New York, NY, USA, 765â€“777. https:
//doi.org/10.1145/3377811.3380396
[45]WeiYou,XuweiLiu,ShiqingMa,DavidPerry,XiangyuZhang,andBinLiang.
2019. SLF:fuzzingwithoutvalidseedinputs.In 2019IEEE/ACM41stInternational
Conference on Software Engineering (ICSE). IEEE, 712â€“723.
[46]Tai Yue, Pengfei Wang, Yong Tang, Enze Wang, Bo Yu, Kai Lu, and Xu Zhou.2020. EcoFuzz: Adaptive Energy-Saving Greybox Fuzzing as a Variant of the
AdversarialMulti-ArmedBandit.In 29thUSENIXSecuritySymposium(USENIXSe-
curity20).USENIXAssociation,2307â€“2324. https://www.usenix.org/conference/
usenixsecurity20/presentation/yue
[47]Insu Yun, Sangho Lee, Meng Xu, Yeongjin Jang, and Taesoo Kim. 2018. QSYM: A
practicalconcolicexecutionenginetailoredforhybridfuzzing.In 27thUSENIX
Security Symposium (USENIX Security 18). 745â€“761.
[48]Cen Zhang, Xingwei Lin, Yuekang Li, Yinxing Xue, Jundong Xie, Hongxu Chen,
Xinlei Ying, Jiashui Wang, and Yang Liu. 2021. APICraft: Fuzz Driver Generation
forClosed-sourceSDKLibraries.In 30thUSENIXSecuritySymposium(USENIXSe-
curity21).USENIXAssociation,2811â€“2828. https://www.usenix.org/conference/
usenixsecurity21/presentation/zhang-cen
[49]Peiyuan Zong, Tao Lv, Dawei Wang, Zizhuang Deng, Ruigang Liang, and KaiChen. 2020. Fuzzguard: Filtering out unreachable inputs in directed grey-boxfuzzing through deep learning. In 29th USENIX Security Symposium (USENIX
Security 20). 2255â€“2269.
[50]Peiyuan Zong, Tao Lv, Dawei Wang, Zizhuang Deng, Ruigang Liang, and Kai
Chen. 2020. FuzzGuard: Filtering out Unreachable Inputs in Directed Grey-box
FuzzingthroughDeepLearning.In 29thUSENIXSecuritySymposium(USENIXSe-
curity20).USENIXAssociation,2255â€“2269. https://www.usenix.org/conference/
usenixsecurity20/presentation/zong
2451
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 09:00:32 UTC from IEEE Xplore.  Restrictions apply. 