Control Parameters Considered Harmful: Detecting Range
Specification Bugs in Drone Configuration Modules via
Learning-Guided Search
Ruidong Han
hanruidong@stu.xidian.edu.cn
Xidian University
Xian, ChinaChao Yangâ€ 
chaoyang@xidian.edu.cn
Xidian University
Xian, ChinaSiqi Maâˆ—â€ 
siqimslivia@gmail.com
The University of New South Wales
Canberra
Sydney, Australia
JiangFeng Ma
jfma@mail.xidian.edu.cn
Xidian University
Xian, ChinaCong Sun
suncong@xidian.edu.cn
Xidian University
Xian, ChinaJuanru Li
mail@lijuanru.com
Shanghai Jiao Tong University
Shanghai, China
Elisa Bertino
bertino@purdue.edu
Purdue University
West Lafayette, USA
ABSTRACT
In order to support a variety of missions and deal with different
flight environments, drone control programs typically provide con-
figurablecontrolparameters.However,suchaflexibilityintroduces
vulnerabilities.Onesuchvulnerability,referredtoasrangespecifica-
tionbugs,hasbeenrecentlyidentified.Thevulnerabilityoriginates
from the fact that even though each individual parameter receives
avalueintherecommendedvaluerange,certaincombinationsof
parameter values may affect the drone physical stability. In this
paper, we develop a novel learning-guided search system to find
suchcombinations,thatwerefertoasincorrectconfigurations.Our
system applies metaheuristic search algorithms mutating config-urations to detect the configuration parameters that have valuesdriving the drone to unstable physical states. To guide the muta-
tions, our system leverages a machine learning based predictor as
the fitness evaluator. Finally, by utilizing multi-objective optimiza-
tion, our system returns the feasible ranges based on the mutation
searchresults.Becauseinoursystemthemutationsareguidedbyapredictor,evaluatingtheparameterconfigurationsdoesnotrequire
realistic/simulationexecutions.Therefore,oursystemsupportsa
âˆ—The work was conducted while the author was lecturer at the University of
Queensland.
â€ Corresponding Author
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACMmustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Â© 2022 Association for Computing Machinery.
ACM ISBN 978-1-4503-9221-1/22/05...$15.00
https://doi.org/10.1145/3510003.3510084comprehensiveandyetefficientdetectionofincorrectconfigura-
tions.Wehavecarriedoutanexperimentalevaluationofoursystem.
Theevaluationresultsshowthatthesystemsuccessfullyreportspo-
tentially incorrect configurations, of which over 85% lead to actual
unstable physical states.
KEYWORDS
Drone security, configuration test, range specification bug, deep
learning approximation
ACM Reference Format:
RuidongHan,ChaoYang[2],SiqiMa,JiangFengMa,CongSun,JuanruLi,
andElisaBertino.2022.ControlParametersConsideredHarmful:Detecting
Range Specification Bugs in Drone Configuration Modules via Learning-
Guided Search. In 44th International Conference on Software Engineering
(ICSE â€™22), May 21â€“29, 2022, Pittsburgh, PA, USA. ACM, New York, NY, USA,
12 pages. https://doi.org/10.1145/3510003.3510084
1 INTRODUCTION
Dronesâ€“flyingminirobots,arerapidlygrowinginpopularity.They
havebecomeessentialinsupportingthecentralfunctionsofvariousbusinesssectors(e.g.,motionpicturefilmmaking)andgovernmental
organizations (e.g., surveillance). Due to their features of pilotless,
a small physical shape, and fast speed, drones are often used in
missions,suchasdelivery,surveillance,andtargetinglocationsthat
aredifficultorexpensivetoreachwithothermeans.However,as
dronesareincreasinglyused forcritical missions,it isessential to
ensurethereliabilityandadaptabilityofthecontrolsystem,towards
completing missions successfully.
Toachievereliabilityandadaptability,enhancedflightcontrol
systemshavebeendeveloped.Suchsystemsprovidelargenumbers
ofcontrolparametersthatcanbeconfiguredtomodifytheflight
states of drones, such as linear and angular positions. Through pa-
rameter adjustment, different configurations can be set and sent to
theflightcontrolprogram.Basedonsuchaconfiguration,theflight
4622022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Ruidong Han, Chao Yang2, Siqi Ma, JiangFeng Ma, Cong Sun, Juanru Li, and Elisa Bertino
control program controls the flight states of the drone to complete
flight missions. However, the functionality of adjusting parameters
introducescertainvulnerabilities(referredtoasrangespecification
bugs) arising from the lack of adequate checking of the control
parametervalues.Specifically,whensettingsomeparticularconfig-
urations by selecting parameter values within the ranges provided
bythemanufacturer,unstableflightstatesmightbetriggered,such
as trajectory deviation or even drone crash.
Unfortunately,existingvulnerabilitydetectiontechniquescan-
notdetectsuchrangespecificationbugs.Ifthesourceofthecontrol
program is available, static program analysis can be used to detect
data/control dependencies [ 22,23] and find such bugs. However,
suchanapproach workswellonlyforsmallcode snippets.Ifused
onlargeandcomplexprograms,staticanalysiswouldhavescala-
bility issues. To address scalability, taint analysis can be used by
tracking input data flow [ 10,13,30], which relies more on input
construction.However,when dealingwithvery largenumbersof
control parameters, each with a wide range of values, analyzingconfigurations by tainting all the parameter values is time con-
suming.Arecentlyproposedtool,rvfuzzer[ 20],triestoaddress
suchan issueby generatingconfigurationinputs throughfuzzing.
Eventhoughrvfuzzerisabletoreducethetotalamountofcon-
figurationstobetested,itisstillinefficientandunabletoachieve
high-coverage analyses of configurations. As a result, it misses
incorrect configurations.
Major challenges for detecting range specification bugs include
how to validate configurations effectively and how to efficientlysearch for correct parameter ranges. In this work, we address
thesechallengesbydevelopingalearning-guidedfuzzingapproach
specificallydesignedtodetectrangespecificationbugs.Atahigh
level, our detection tool, LGDFuzzer, relies on a genetic algorithm
(GA) [37]andaflightstatepredictortodetecttheconfigurations
thatarepotentiallyincorrectandtesttheincorrectconfiguration
throughsimulation.Specifically,LGDFuzzerisequippedwiththree
core components, State Change Predictor, Learning-Guided Muta-
tion Searcher, and Range Guideline Estimator. First, we manually
collectedalistofflightlogs,eachofwhichcontainsaflightstate,
sensordata,configurations,andatimestamp.Byusingsuchlogs,
LGDFuzzer trains a state predictor, which is utilized to estimate
the state, referred to as reference state, that will be reached by the
drone at the next timestamp. Simultaneously, LGDFuzzer runs the
learning-guidedmutationsearchertogenerateconfigurationsby
leveraging the GA. Unlike the traditional configuration validation
schemes that test the configuration on either a flight simulatoror a realistic drone, LGDFuzzer leverages the state predictor to
estimatethereferencestateandinferswhetheraconfigurationis
correct based on the deviation of the reference state concerning
theexpectedstate.Finally,LGDFuzzervalidatestheconfigurationsthatarepredictedasâ€œincorrectâ€andfurthergeneratesavalidrange
for each parameter.
We used LGDFuzzer to analyze the most popular flight control
program, ArduPilot [35]. In total, LGDFuzzer validated 46 ,500 con-
figurations and labeled 2 ,319 as â€œincorrectâ€, out of which 2 ,036
incorrect configurations were confirmed. Apart from the identified
rangespecificationbugs,wealsofound564privilegeescalationvul-
nerabilities,referredtoas Post-LaunchPrivilegeEscalation.These
refer to configurations that are detected as incorrect before thedrone takes off and, as a result, the flight is aborted. However, the
controlprogramwill accepttheseincorrectconfigurationsif they
aresenttothecontrolprogramafterthedronehastakenoff.Our
analysis also shows that a significant number of incorrect configu-
rationsaresetinordertoenhanceadaptability.Toassistdevelopers
andusersinbuildingsecureflightcontrolprograms,LGDFuzzer
optimizes the parameter ranges based on a manually set adaptabil-
itylevel.Ifdevelopersanduserspreferhigheradaptability,larger
parameter ranges will be provided by LGDFuzzer; however, the
possibility of causing unstable flight would be higher. Otherwise, a
smallerrangewillbesetandtheflightstatesofthedronewillbe
more stable.
Contributions.
(1) We have designed and implemented LGDFuzzer to detect in-
correctconfigurationseffectivelyandefficiently.Oursystemuses
a GA to select the â€œhighly possibleâ€ incorrect configurations and
validates configuration correctness by using a deep learning based
state predictor.
(2) According to the requirements of reliability and adaptability
by developers and users, we designed and implemented a range
optimization component in LGDFuzzer to provide the most ap-propriate parameter value ranges to minimize the possibility of
introducing incorrect configurations.
(3)WeappliedLGDFuzzertoareal-worldflightcontrolprogram
andidentified2 ,036incorrectconfigurationscausingunstableflight
states. We also verified 106 incorrect configurations on real-world
drones and confirmed that these incorrect configurations cause
trajectory deviations or drone crashes.
(4) We found a new type of bug, Incorrect Configuration Tackling
bug, and verified that this bug also causes unstable flight states.
(5)WehaveopensourcedourLGDFuzzerathttps://github.com/
BlackJocker1995/uavga/tree/main;thesitemakesavailablethetool,
dataset, and video recordings of our tests of incorrect configura-
tions.
2 MOTIVATION AND CHALLENGES
In this section, we first introduce background information of flight
controlprogramsutilizedbydronesandrangespecificationbugs.
We then discuss the challenges in the design of an approach to
validate parameter configurations, followed by our solutions to
address these challenges.
2.1 Flight Control Program
During a flight, the ground control station (GCS) communicates
withthedronebysendingaseriesofcommandstotheflightcon-
trol program. Before the drone takes off, users can configure the
flightcontrolprogrambyadjusting theparameterstomanipulate
the flight states of the drone (e.g., linear position, angular position,
angularspeed,velocity,andacceleration).Toensurethatadrone
completesits flightmissionsuccessfully,the flightcontrolprogram
periodically observes the current positioned flight state and sensor
data (e.g., from GPS, gyroscopes, and accelerometers) to estimate a
reference stateindicating the next state ofthe drone. Then thecon-
trol program generates actuator signals (e.g., motor commands) to
463
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. Detecting Range Specification Bugs in Drone Configuration Modules via Learning-Guided Search ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
move the drone to the reference state. The positioned state and the
referencestateneedtobecloseenough,i.e.,withinastandarddevi-
ation. If this is not the case, the drone flight may become unstable,
leading to trajectory deviations and crashes.
Although thevalue ranges for control parametersare typically
hardcodedinthecontrolprogramsandonewouldexpectthatall
possiblecombinationsofthesevaluesbecorrect,butsomeofthe
combinations are actually incorrect. Any configurations triggering
unstable flight states are regarded as incorrect. The corresponding
control parameter ranges are range specification bugs [20]. Since
hundreds ofcontrol parameters canbe specified bythe flight con-
trol program, identifying range specification bugs by validating all
parametervaluesistimeconsumingbecausesomeparametersmay
not affect flight stability. Therefore, we focus on the parameters
that might affect angular position and angular speed state, because
theydirectlyimpacttheflightattitudeandtheirincorrectvalues
are more likely to cause unstable states.
Byanalyzingthephysicalimpactondrones,wedefinefiveun-
stable flight states:
FlightFreeze. Adroneisrequiredtokeepmovingunlesstheflight
control program generates a signal to keep the drone stationary
or to instruct the drone to land. However, incorrect configurations
may lead the drone to accidentally freeze at a waypoint, when
moving forward/backward, or to wander around a position within
a minimum range. To determine whether a flight is frozen, we
calculate the movement distance between the previous and the
current positions within a time interval. If the distance is less than
a threshold, the flight state is regarded as frozen, i.e.,â€œflight freezeâ€.
Deviation. According to the actuator signals generated by the
flightcontrolprogram,thedronewillbedriventoachievetherefer-
ence state as close as possible. In practice, however, the positioned
statemaynotalwaysmatchthereferencestate,thatis,thedroneisdeviatingfromtheexpectedtrajectory.Whenthedeviationissmall,
the control system can generate an actuator signal based on the
differences between the current positioned state and the reference
state.However,anincorrectconfigurationmaytriggerasignificant
deviation. Such a deviation may lead to an erroneous trajectory
from which the drone cannot return back to the correct trajectory.
Ifthedeviationexceedsagiventhreshold,weconsidertheflight
state as unstable, i.e., a â€œdeviationâ€ state.
DroneCrash. Forgeneraldeviations,thedronecanstilllandsafely
eventhoughnotattheexpectedlocation.Aworsecaseisadeviation
leading the drone against an object and eventually to crash.PotentialThrustLoss.
Bydrivingthedronemotor,theflightcon-
trolprogramusesmotorpowertoadjustthedronetothereference
state.Nonetheless,theadjustmentthatcanbedonebythedrone
motor is limited. If an incorrect configuration is set, the drone may
not be able to move close to the reference state even when saturat-
ing the motor up to 100% throttle. Remaining in such an incorrect
state can cause a decrease in the drone flight altitude, or even a
crash.Post-Launch Privilege Escalation.
Before taking off, the flight
controlprogramvalidatestheconfigurationanddetermineswhether
it will trigger unstable flight states. (i.e., the configuration is incor-
rect).Whenoneormoreincorrectparametersoftheconfigurationsareidentified,thecontrolprogramdisplaysawarningmessageand
abortsthetaking-offoperation.However,iftheseconfigurations,
flagged as incorrect, are set after taking off, they can still be ac-
cepted by the flight control program. As a consequence, the drone
may end up in some unstable states.
2.2 Challenges
Inordertovalidateallconfigurationsanddetectrangespecification
bugs, the following challenges must be addressed:Challenge I: How to validate configurations effectively?
Ap-
proachesproposedforanalyzingflightcontrolprogramsaregen-
erally based on static program analysis techniques that explore
control and data dependencies [ 11,19,26]. However, such tech-
niques are not suitable for validating configurations because large
numbers of specified parameter values need to be analyzed. Unlike
conventional bug detection techniques that statically analyze only
smallcodesnippets,theentireflightcontrolprogramneedstobe
analyzedinordertoachievehighcodecoverage.Thereasonisthatdifferentparametervaluesoftenresultinexecutionflowsinvolving
verydifferentportionsofthecontrolprogram.Unfortunately,flight
control programs have huge sizes (e.g., over 700K lines of code);
complicated control and data dependencies. Therefore, it is critical
that the approach designed for configuration validation be effec-
tive, that is, able to provide high coverage of all possible parameter
values.
ChallengeII:Howtoconductanefficientconfigurationvali-dation?
ReferringtotheunstableflightstatesdefinedinSection2.1,
we need to validate each configuration through either a realistic or
simulated flight execution. Because of the large number of control
parameters, each with a wide value range, changing the parameter
valuestogenerateconfigurationsandvalidatingalltheseconfigura-
tionsisinefficient.Completingtheentirevalidationproceduremaythenenduprequiringhours.Therefore,existingapproaches[
17,32],
which analyze all possible configurations, are not suitable.
An alternativeapproach is touse fuzzing [ 20] combinedwith a
binary search [ 21] to reduce thesearch space of the combinations
tobeanalyzed.However,althoughthesearchscopeisnarrowed,
the execution time increases because each fuzzing iteration needs
to wait until the validation feedback of the previous configuration
is obtained.
Challenge III: How to balance the requirements of drone
adaptabilityandflightstability? Theflightcontrolprogramsup-
portsdifferentconfigurationstoadapttodifferentflightmissions.
Whenhighadaptabilityisrequired,eachcontrolparametermust
have a large value range to adapt to different scenarios. As a result,
thenumberofincorrectconfigurationswillbehigher,whichwill
then affect flight stability. On the other hand, when parametershave small value ranges, the possible configurations are limited,
which reduces adaptability. Hence, complex flight missions cannot
be carried out. Identifying proper value ranges is thus challenging.
2.3 Solutions
We propose three solutions to address the above challenges.
Solution I: Grey-box based fuzzing. Sincedependenciesofthe
flight control program are complex, simple static program analysis
464
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Ruidong Han, Chao Yang2, Siqi Ma, JiangFeng Ma, Cong Sun, Juanru Li, and Elisa Bertino
techniquesareineffective.Ourapproachisinsteadtoconductgrey-
box based fuzzing by setting various configurations and validating
thecorrespondingflightstates.Inparticular,weapplyaGAtocarry
out fuzzing. The algorithm first selects some parameter values and
validatestheparameterconfigurationbypredictingitsimpacton
the flight states. After that, referring to the validation result, the
algorithm conducts mutation to select alternative incorrect param-
eter values and set new configurations to validate. The process
of configuration searching is executed iteratively. This approach
addresses challenges I and II.
Solution II: Flight state prediction. Although GA and fuzzing
reducethesearchrangeofparametervalues,thenumberofcom-
binationsisstillhuge.Therefore,validatingallthecorresponding
configurations through realistic/simulation execution is highly in-
efficient.Inresponse,wedesignedastategenerationapproachthat
leveragesamachinelearningalgorithmtotrainastatepredictor.
Insteadofvalidatingconfigurationsthrougharealistic/simulation
execution, the state predictor takes each configuration as input
andpredictsthepotentialflightstatetoguidethemutation.Such
an approach requires much less time than a realistic/simulation
execution.Itisimportanttonotethatdatalabelingandpredictor
generationareone-timecosts.Henceitisstillmoreefficienttocon-
duct prediction rather than a realistic/simulation execution. The
reason is that configuration validation has to be executed itera-
tively wheneach new configuration isgenerated by themutation
algorithm. This solution addresses Challenge II.
Solution III: Multi-objective optimization. To balance adapt-
ability and stability, we utilize a multi-objective optimization ap-
proach. Our approach estimates multiple feasible range guidelines
accordingtothedetectedincorrectconfigurations.Theoptimiza-
tion target is to eliminate the incorrect configurations (improve
stability)whileprovidingawiderrangeforparameters(improve
adaptability).Eachsolutionofthemulti-objectiveoptimization(i.e.,
range guideline) is the best solution in specific conditions, i.e., the
optimal balance of adaptability and stability. Our approach allows
userstochooseanappropriaterangefrommultiplerangeguidelines
based on their requirements. This approach addresses Challenge
III.
3 LGDFUZZER
In this section, we present the design of LGDFuzzer, a system for
findingrangespecificationbugsdronecontrolprogramsthrough
learning-guidedmutationsearch.Wefirstpresentanoverviewofits
architecture and then the detailed design of its three components.
3.1 Overview of LGDFuzzer
LGDFuzzer (see Fig. 1) contains three components: state change
predictor, a module to predict the flight state and assess whether a
configuration will lead to unstable states; learning-guided mutation
searcher, a GA search module to detect incorrect configurations;
range guideline estimator, a module to provide secure parameter
range guidelines.
LGDFuzzer relies on log entries that we generate by repeatedly
executingdrone flightmissions( 1).The logentriesare splitintoFeasible
RangeState Change Predictor
Learning-Guided Mutation Searcher Range Guideline EstimatorPredictor
Generation
Cluster 
SampleExecution
Validation
ConfigConfigIncorrect
LOGMulti-Objective 
OptimizationFeature
DronePredictor
SPL
Samples Searcher Config
IndividualsEvaluation 
Feedback 12 3 4
5 6 7 98
Break
Potentially 
IncorrectSimulator
101112
13
14Iterated 
Evaluate 
Fitness
Figure 1: Overview of LGDFuzzer.
two groups, one group is used by the state change predictor to gen-
erate a feature matrix containing vectors with flight states, sensor
data, and configurations ( 2), and another used by the learning-
guided mutation searcher to carry out cluster sampling ( 5). By
using the feature matrix, LGDFuzzer then generates a predictor
(34). The searcher clusters data and selects representative sam-
ples from each cluster ( 6). It further uses each representative
sample to find out the corresponding incorrect configurations ( 7).
Inparticular,LGDFuzzeriterativelymutatestheconfigurationand
usesthepredictortoevaluatewhichconfigurationismorelikely
tocauseunstablestates( 8).TheiterativesearchwillstopWhen
certainconditionsaresatisfied.Alltheidentifiedpotentialincorrect
configurationsare collected to construct a configuration set ( 9)
and validated by a simulation ( 101112). Finally, through the vali-
dation results, the estimator uses a multi-objective optimization to
generatemultiplefeasiblerangeguidelinesthatbalanceavailability
and stability under specific conditions ( 1314).
3.2 Flight Log Generation
Since there is no standard data set for testing drones, in order toconstruct the feature matrix for the predictor and generate datafor the searcher, we manually fly a drone through a simulator to
generateanumberofflightlogs.Whenflyingthedrone,weseteachflightwiththesameflighttestmission, AVC2013[
34],whichisoften
used to test the drone mission execution capabilities. The flight
missionisrepeatedlyexecutedbysettingconfigurations.Werecord
all flight logs but discard those causing unstable states. Becauseunstable state data is uncontrollable and complex (compared to
stable state data), dropping the unstable states prevents them from
affectingthetrainingofthepredictor.Intotal,werecorded308 ,533
systemlogentries.Eachentrycontainsstateinformationincludingangularposition,angularacceleration,throttlespeed,sensordataofGPS,gyroscopes,andaccelerometers,thecurrentsetconfiguration,
and a timestamp index.
3.3 State Change Predictor
Sincethecontrolalgorithmestimatesthenextreferencestatebased
on the current positioned state and sensor data, we leverage a ma-
chinelearning(ML)predictortoemulatethecorrelationbetween
input states and output states, and then assess how the configura-
tions affect flight states. Through the ML predictor, LGDFuzzerexplores the diversity of flight states and configurations. Then it
465
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. Detecting Range Specification Bugs in Drone Configuration Modules via Learning-Guided Search ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
calculatesthenextreferencestatewhichdemonstratesthedevia-
tion caused by incorrect configuration accurately. Two steps are
executed to train the predictor: feature extraction andpredictor
generation.
FeatureExtraction. Giventhelogentries,LGDFuzzerconstructs
afeaturematrixbyselectingthespecificdata.Sincewefocusonthe
unstable states that affect flight attitude (i.e., angular and speed),
the predictor considers the following state, sensor data, and config-
urationsthatmightaffectflightattitude:(i)angularpositionand
angularspeedof the flight state ğ‘; (ii) sensordata ğ‘ obtained from
gyroscopesandaccelerometers;(iii)controlandmissionparameters
oftheconfiguration ğ‘¥,whichcouldadjustflightattitude.According
to the above information, LGDFuzzer groups them as a feature
vector,ğ‘£{ğ‘,ğ‘¥}, whereğ‘={ğ‘,ğ‘ }. The vectors are further combined
to construct a feature matrix.
PredictorGeneration. AsLongShort-TermMemory(LSTM)[ 16]
techniquehandlescomplicatedinput/outputdataefficiently[ 6,7,
28], LGDFuzzer further utilizes LSTMas the predictor to refer
the next reference state. Specifically, for a pre-processed feature
vectorğ‘£ğ‘–={ğ‘ğ‘¡,ğ‘¥ğ‘¡}with timestamp ğ‘¡,LSTMtakes a number â„of
consecutive vectors with timestamp lower or equal than ğ‘¡as input
(i.e.,ğ‘‰{ğ‘£ğ‘¡âˆ’â„âˆ’1,...,ğ‘£ğ‘¡âˆ’1,ğ‘£ğ‘¡}), and returns the maximum conditional
probability prediction of the next reference state units ğ‘/prime
ğ‘¡+1.W e
show in Sec. 4 how we determine the best values for â„. In the
training stage, the weight of the predictor is iteratively updated
to ensure that the predicted reference state ğ‘/prime
ğ‘¡+1is closer to the
ground truth state ğ‘ğ‘¡+1. We use the Mean Squared Error (MSE) [36]
loss for training.
3.4 Learning-Guided Mutation Searcher
To exploreincorrect configurations, weuse aGA, a metaheuristic
search relying on biologically inspired operators such as mutation,
crossover,andselection.Initially,asincorrectconfigurationsmay
only produce unstable states in specific contexts (i.e., state andsensor data), our system conducts searches for multiple specificcontexts to find incorrect configurations. We split the data from
logsintomultiplesegments ğ¶ğ‘–={ğ‘ğ‘–,ğ‘ğ‘–+1,...,ğ‘ğ‘–+â„},ğ‘–ğ‘šğ‘œğ‘‘(â„+1)=0,
whereğ‘–istheindexoftherecordeddata.Butconsideringthatthere
aresimilaritiesamongsegments,searchingforeachonewillgener-
ate a huge number of duplicate results. To address such an issue,
we cluster the segments and sample from these clusters in order to
reduceredundancywhilemaintainingdiversity.Weleveragethe
meanshift [12],aprobabilitydensity-basednon-parametricadap-
tiveclusteringalgorithm,toclustersegmentsandrandomlysample
ğ‘šrepresentative examples from each cluster for the subsequent
search. Then, for each sample segment, the searcher carries outa GA search to explore incorrect configurations by iterative mu-tation, crossover, and selection. When the searcher has collected
alltheincorrectconfigurationsforeachsample,itmergesandde-
duplicates them as a unique set, referred to as set of potentially
incorrect configurations.
In what follows we provide details on the Fitness Evaluation
Function, used to evaluate the fitness of a configuration, and the
Searching Process.Fitness Evaluation Function. The GA search applies fitness to
quantify, by using the predictor, how much deviation a given con-
figuration may cause. Intuitively, the fitness evaluation function
returnstheprobabilityofdeviationforaconfiguration.Specifically,assumethatthecurrentsearchiscarriedoutforthecontextsegment
ğ¶{ğ‘1,...ğ‘â„,ğ‘â„+1};thefunctionselects ğ¶/prime{ğ‘1,ğ‘2,...ğ‘â„}tobeusedas
inputtothepredictionmodeland ğ‘â„+1ofğ‘â„+1tobeusedasground
truthforcalculatingthedeviation.Whenevaluatingaconfigura-tion
ğ‘¥{ğ‘¥1,...,ğ‘¥ğ·}(ğ·is the number of parameters), the function
mergesitwiththesegmenttocreatefeatures ğ‘‰{{ğ‘1,ğ‘¥},...,{ğ‘â„,ğ‘¥}}.
Then,suchfeaturesaregiven asinputtothepredictor,whichre-
turnsapredictedreferencestate ğ‘/prime
â„+1.ThefitnessistheL1-distance
/bardblğ‘â„+1âˆ’ğ‘/prime
â„+1/bardblbetween the predicted state and the ground truth
state.Thegoalofthesearchisthentofindincorrectconfigurations,
whicharepredictedtomaximizethefitness,thatis,thedeviation
(and thus maximize the probability of causing unstable states).
SearchingProcess. Foreachcontextsegmentsample,thesearcher
firstinitializesapopulationwhoseindividualsareconfigurations,
and the parameter values of each configuration are set to their
defaultvalues.Weassumethatthepopulationsizeis ğ‘ğ‘ƒandthe
maximum number of iterationsis ğºğ‘šğ‘ğ‘¥. The search process itera-
tively mutates and updates the population as follows.
Intheğ‘”-thgenerationiteration( ğ‘”âˆˆ[1,ğºğ‘šğ‘ğ‘¥]),thesearcherfirst
mutatesthecurrentpopulation ğ‘ğ‘œğ‘ğ‘”{ğ‘¥1,ğ‘”...,ğ‘¥ğ‘ğ‘ƒ,ğ‘”}andgeneratesa
variantpopulation ğ‘ğ‘œğ‘ğ‘£{ğ‘¦1,ğ‘”,...,ğ‘¦ğ‘ğ‘ƒ,ğ‘”}. Eachconfigurationof the
variant population is obtained as follows:
ğ‘¦ğ‘–,ğ‘”=ğ‘¥ğ‘–,ğ‘”+ğ¹âˆ—(ğ‘¥ğ‘ğ‘’ğ‘ ğ‘¡,ğ‘”âˆ’ğ‘¥ğ‘–,ğ‘”)+ğ¹âˆ—(ğ‘¥ğ‘Ÿ1,ğ‘”âˆ’ğ‘¥ğ‘Ÿ2,ğ‘”)(1)
whereğ‘¥ğ‘Ÿ1/ğ‘Ÿ2,ğ‘”are random configurations, ğ‘¥ğ‘ğ‘’ğ‘ ğ‘¡,ğ‘”is the best fitness
configuration, and ğ¹is the scaling factor.
Then,ğ‘ğ‘œğ‘ğ‘”iscrossedoverwith ğ‘ğ‘œğ‘ğ‘£toproduceanewexperi-
mental population ğ‘ğ‘œğ‘ğ‘’{ğ‘’1,ğ‘”,...,ğ‘’ğ‘ğ‘ƒ,ğ‘”}, whoseğ‘–-th configuration
isğ‘’ğ‘–,ğ‘”{ğ‘’ğ‘–1,ğ‘”,ğ‘’ğ‘–2,ğ‘”,...,ğ‘’ğ‘–ğ‘—,ğ‘”},whereğ‘—âˆˆ[1,ğ·].The parametervalues
ğ‘’ğ‘–ğ‘—,ğ‘”of each configuration are calculated as follows:
ğ‘’ğ‘–ğ‘—,ğ‘”=/braceleftBigg
ğ‘¦ğ‘–ğ‘—,ğ‘”,ğ‘– ğ‘“ ğ‘Ÿ ğ‘ ğ‘› ğ‘‘ (0,1)<ğ¶ğ‘…ğ‘œğ‘Ÿ ğ‘— =ğ‘—ğ‘Ÿğ‘ğ‘›ğ‘‘
ğ‘¥ğ‘–ğ‘—,ğ‘”,ğ‘œ ğ‘¡ â„ ğ‘’ ğ‘Ÿ ğ‘¤ ğ‘– ğ‘  ğ‘’(2)
whereğ‘—ğ‘Ÿğ‘ğ‘›ğ‘‘is a random integer in [1,ğ·],ğ¶ğ‘…is the crossover rate,
ğ‘¥ğ‘–ğ‘—,ğ‘”istheğ‘—-thparametervalueofthe ğ‘–-thconfigurationin ğ‘ğ‘œğ‘ğ‘”,
andğ‘¦ğ‘–ğ‘—,ğ‘”is theğ‘—-th parameter value of the ğ‘–-th configuration in
ğ‘ğ‘œğ‘ğ‘£.
Then, the searcher evaluates the fitness of each configuration
both inğ‘ğ‘œğ‘ğ‘”andğ‘ğ‘œğ‘ğ‘’. According to their fitness, the searcher
selects some configurations from the population to obtain the next
generation of population ğ‘ğ‘œğ‘ğ‘”+1{ğ‘¥1,ğ‘”+1,...,ğ‘¥ğ‘ğ‘ƒ,ğ‘”+1}by using the
following selection function:
ğ‘¥ğ‘–,ğ‘”+1=/braceleftBigg
ğ‘’ğ‘–,ğ‘”,ğ‘– ğ‘“ ğ‘“(ğ‘’ğ‘–,ğ‘”)<ğ‘“(ğ‘¥ğ‘–,ğ‘”)
ğ‘¥ğ‘–,ğ‘”,ğ‘œ ğ‘¡ â„ ğ‘’ ğ‘Ÿ ğ‘¤ ğ‘– ğ‘  ğ‘’(3)
whereğ‘“is the fitness evaluation function.
Finally,ifthefitnessofeachconfigurationinthepopulationdoes
not any longer increase or the maximum number ğºğ‘šğ‘ğ‘¥is reached,
the search stops the mutation. We select the top 10 highest-fitness
configurations from the final generation population as incorrect
configurations.
466
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Ruidong Han, Chao Yang2, Siqi Ma, JiangFeng Ma, Cong Sun, Juanru Li, and Elisa Bertino
3.5 Execution Validation
Thepredictorclassifiesaconfigurationasincorrectiftheconfigura-
tionhasahighprobabilityof causingunstablestates.Ho wever, the
set of all such configurations needs to be validated to confirm that
they actually cause unstable states. We thus simulate the flight and
use a monitor to observe which potential incorrect configurations
actually lead to unstable states during the simulated execution.
Specifically,thedroneissetwithpotentiallyincorrectconfigura-
tionstoperformthe AVC2013flightmission.Forflightfreeze,ifthe
dronemovesatdistancesalwayslessthan0 .5metersin15seconds,
themonitoridentifiesthisasaflightfreeze.Fordeviations,ifthe
flight deviation continues to be 15 times higher than 1 .5 meters,
the flight is considered a deviation.
3.6 Range Guideline Estimator
Therangeguidelinesprovidedtotheusersshouldconsiderstabil-
ity and adaptability, while at the same time eliminating discrete
incorrect configurations and reserving relatively complete space
foreachparameter.Meanwhile,aswecannotensurethestability
of unverified configurations, the estimation of range guidelines
shouldreferencetheobtainedvalidationresultsandrefrainfrom
consideringincorrectconfigurations.Therefore,weleverageamul-
tivariate optimizationto determine the suitablerange guideline. If
allparameter valuesina configurationarewithin therangespeci-
fied by the guideline, we consider the configuration to be covered.
Our system estimates the range guideline ( ğ‘…ğ‘ğ‘›ğ‘”ğ‘’/prime) based on the
following optimization problem:
â§âªâªâªâªâªâª â¨
âªâªâªâªâªâªâ©ğ‘šğ‘–ğ‘› ğ‘“
1=ğ‘›ğ‘¢ğ‘š(ğ‘…ğ‘–ğ‘›ğ‘ğ‘œğ‘Ÿğ‘Ÿğ‘’ğ‘ğ‘¡ âˆˆğ‘…ğ‘ğ‘›ğ‘”ğ‘’/prime)
ğ‘›ğ‘¢ğ‘š(ğ‘…âˆˆğ‘…ğ‘ğ‘›ğ‘”ğ‘’/prime)
ğ‘šğ‘ğ‘¥ ğ‘“2=ğ‘›ğ‘¢ğ‘š(ğ‘…âˆˆğ‘…ğ‘ğ‘›ğ‘”ğ‘’/prime)
ğ‘ .ğ‘¡.
ğ‘…ğ‘ğ‘›ğ‘”ğ‘’/primeâˆˆğ‘‚ğ‘Ÿğ‘–ğ‘”ğ‘–ğ‘›ğ‘…ğ‘ğ‘›ğ‘”ğ‘’(4)
Theoptimizationproblemhastwoobjectives:(a)tomaximize
the number of validated configurations ğ‘…covered by the guideline;
(b) to minimize the coverage of incorrect configurations ğ‘…ğ‘–ğ‘›ğ‘ğ‘œğ‘Ÿğ‘Ÿğ‘’ğ‘ğ‘¡.
If weshrink theallowed rangesto avoid incorrectconfigurations,
therangeofeachparametervaluewouldalsoshrinkandviceversa.
Therefore, instead of defining strict ranges for each parameter, the
system solves this optimization problem with multiple constraints
to obtain a diverse group of Paretosolutions. These Paretosolu-
tions form a boundary consisting of the best feasible solutions,
allowing users to select the best configuration according totheirrequirements. The system provides this range guideline mainly
basedonthefollowingconsiderations:(1)Asthenumberofparam-etersincreases,itwouldbedifficulttocompletelyruleoutinsecureparametervaluesasthesecureparameterrangesmaynotbecontin-uous.(2)Whilestabilityisparamount,usersmaybewillingtoincur
some minor risk for better controlling flexibility or availability.
4 EVALUATION
WeassessedLGDFuzzerbyconsideringitseffectivenessandeffi-
ciencyinvalidatingconfigurations.Thefollowingresearchques-
tions (RQs) were answered:
â€¢RQ1: Effectiveness. How many incorrect configurations
are detected by LGDFuzzer precisely?â€¢RQ2:Adaptability. CanLGDFuzzerprovidethemostsuit-
ablevalue rangesfor parameterswithminimum incorrect
configurations?
â€¢RQ3:Enhancement. How do the mutation and the predic-
tor help improve configuration validation?
4.1 Experiment Setup
WeappliedLGDFuzzertoanopensourceflightcontrolprogram,
ArduPilot (4.0.3) [35], which is widely used by drone manufacturers
suchasParrot,Mamba,andMateksys [33].Tovalidateconfigura-
tionsspecifiedin ArduPilot ,weutilizedthreeexperimentalvehicles
(showninFig.2)fortesting,includingtwodroneswith Pixhawk[24]
(i.e.,CUAV ZD550 andAMOVLab Z410 ) and a drone simulator (i.e.,
Airsim[29]).
(a) CUAV ZD550
 (b) AMOVLab Z410
 (c) Airsim
Figure 2: Real and virtual drone vehicles used for experi-ments.
According to the control parameter descriptions provided by
the manufacturer, we selected 20 parameters that may affect flight
angularpositionandangular speed.Wepro videdetailsaboutthese
parameters in Appendix A, including the parameter name, the pa-
rametervaluerange,adefaultvalue,andtheparameterdescription.
ThepredictorandtheGAsearcherareimplementedinPython.
Concerning the GA, its evolutionary stagnation judgement thresh-
old is set to 0 .1, the number of representatives ğ‘šis set to 3, and
themaximumnumberofevolutionarygenerationsissetto200.We
further setthe sizeof initialpopulation to 1 ,000 (i.e.,ğ‘ğ‘ƒ=1,000)
and the scaling factor ğ¹to 0.4.
4.2 RQ1: Effectiveness
ToevaluatewhetherLGDFuzzeridentifiesincorrectconfigurations
accurately,wefirstassessedthepredictionaccuracyofthepredictor
in theflight state predictorphase. Then wevalidated whether the
predicted incorrect configurations can impact flight stability.
State Prediction. Wefirstsent1,500configurationsto Airsimto
testandmanuallylabeledtheconfigurationscausinganunstable
state and the ones resulting in a regular state. The same method
inFitnessEvaluationFunction wasusedtocalculatethedeviation
for each configuration. We calculated the average deviations of
unstable states and regular states, and regarded the median val-ues between them as a threshold. We then treated another 1
,500
configurations as test data to verify the accuracy, precision, and
recall of predictors. Specifically, our experiment first extracted the
context(i.e.,stateandsensordata)segmentsfromlogdata.Then,
eachlabeledconfigurationinthetestdatawasrandomlymerged
with a segment, and its deviation was calculated. If the deviation is
467
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. Detecting Range Specification Bugs in Drone Configuration Modules via Learning-Guided Search ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
greaterthanthethreshold,thepredictorclassifiestheconfiguration
as unstable, and as stable otherwise. Table 1 reports the perfor-
mance of predictors with different input lengths â„, whereDCis
the average deviation that the correct configurations affected, and
DIis the average deviation that incorrect configurations caused.
Table1:Predictoraccuracy,precisionandrecallfordifferent
input lengths.
â„Accuracy Precision Recall DC DI
3 0.8650 0.8786 0.9818 9.7643 14.68184 0.8689 0.8778 0.9882 9.6246 14.65085 0.8546 0.8777 0.9695 9.8126 14.73936 0.8662 0.8769 0.9553 9.6246 14.6508
*â„is the input length of the model, DCis the average deviation of
correctconfigurations, DIistheaveragedeviationofincorrectcon-
figurations.
Generally, the results show that our predictor is robust when
taking various input lengths. The deviation values derived fromtheincorrectconfigurationsareobviouslylargerthanthevalues
collectedfromthecorrectconfigurations.Thatisthereasonwhy
wecanusethepredictorintheGAsearchtodriveconfigurationsto
ahigherdeviation.Inaddition,theexperimentresultsshowthatthe
recallofthepredictiondoesnotlinearlyincreasewhen â„exceeds
4. Therefore,we chose thepredictor with thebest recall i.e., â„=4
as the input length to carry out the subsequent experiments.
To assess the prediction accuracy for state changes, we sent the
configurationsto Airsimandrecordedthecorrespondingflightdata.
Then,werandomlyselected150consecutivefeaturesfromthedata,
gavethemasinputtothepredictortopredictthestatechange,and
compared it with the ground truth state. The results in Fig. 3 show
that the predictions closely match the real states (an example of
angle roll). In the figure, the dotted curve denotes the actual states,
thesolidcurvedenotesthepredictedstates,andthehistogramatthe
bottom (the blue bar) indicates the prediction errors as differences
betweenthetwocurves.Thesmallerrorshowedthatthetrained
predictor can accurately predict flight state changes.
Figure 3: Match between real behavior and prediction.
ConfigurationValidation. Giventhepredictedincorrectconfig-
urations, we validated them through realistic/simulation execution.
Sincetheincorrectconfigurationsmaycausedronecrash,weex-
amined all of them on Airsim. For the 465 samples obtained byclustering and sampling, LGDFuzzer searched out 2 ,319 unique
incorrect configurations. Finally, after a validation, 2 ,036 config-
uration of 2 ,319 were marked as truly incorrect resulting in 500
Deviations,2Flight Freeze,2Crashes, 564 Post-Launch Privilege Es-
calation, and 968 Potential Thrust Losses.
4.3 RQ2: Adaptability
Inthisexperiment,weusedthepreviousvalidationresultsabout
incorrectconfigurationstoestimatetherangeguidelines,anddis-
cussed how they balance stability and adaptability. With reference
tothevalidationresults,theestimatorfoundout143 Paretosolution
results (see Fig. 4). In the graph, the horizontal axis represents the
number of validated configurations covered by the range guideline,
and the vertical axis represents the ratio of incorrect configuration
in the range guideline. Each Paretosolution represents a feasible
solution (i.e., range guideline) satisfying specific constraints (i.e.,
adaptability and stability constraints).
Figure 4: Paretofrontier solution.
Forinstance,weselectedsomerangeguidelineexamplesinTa-
ble 2 andfurther analyzed theirstability and adaptability. To illus-
tratethemodifiedguidelinesgeneratedbyLGDFuzzer,weselected
severalparametersoutof20onestoshowtheirdetails.Thetable
shows three examples in which stability decreases and the con-
figurable space (i.e., adaptability) increases. Guideline i avoids the
majority of incorrect configurations. It covers 28 validated configu-
rations,onlyoneofwhichcausedanunstablestate;thismeanshigh
stability.However,comparedwiththeoriginalparameterranges,
thisguidelinereducestoomuchtheavailablespace,whichresulted
in low adaptability. In contrast, Guideline iii reserves relatively
complete ranges for the parameters. It covers 236 validated con-
figurationsbutmorethanhalfofthem(133)areincorrect,which
resulted in low stability. Guideline ii is an intermediate choice, cov-
ering 91 validated configurations where only 29 are incorrect.
Ifusershavemorestringentstabilityrequirements,theycanuse
the lower error ratio range guideline, at the cost of limiting the
configuration space and thus being unable to satisfy other flight re-quirements.Onthecontrary,ifusershavetosatisfyspecialmission
requirements (e.g., the mission is a time-limited task, or it needsa large flight angle to reach the target speed), they may consider
sacrificingabitthestabilityinordertoimproveadaptability.Infact,
they can choose an appropriate range guideline from the Pareto
solutionsaccordingtotheirstabilityandadaptabilityrequirements.
468
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Ruidong Han, Chao Yang2, Siqi Ma, JiangFeng Ma, Cong Sun, Juanru Li, and Elisa Bertino
Table 2: Examples of feasible range guideline
ParameterGuideline i Guideline ii Guideline iii
LU Reduce LU Reduce LU Reduce
PSC_POSZ_P 1.00 2.57 -21.5% 1.00 2.59 -20.5% 1.00 2.97 -1.5%
ATC_ANG_RLL_P 0.92 11.4 -12.6% 0.88 11.73 -9.5% 1.02 11.69 -11.0%
ATC_ANG_PIT_P 1.22 11.69 -12.7% 0.94 11.78 -9.6% 1.00 11.93 -8.9%
ATC_RAT_PIT_P 0.035 0.39 -27.5% 0.035 0.375 -30.6% 0.01 0.36 -28.5%
ATC_RAT_PIT_I 0.13 1.92 -10.0% 0.11 1.93 -8.5% 0.10 1.96 -6.5%
ATC_RAT_YAW_I 0.01 0.69 -31.3% 0.01 0.72 -28.2% 0.01 0.95 -5.0%
WPNAV_SPEED 250 1550 -34.3% 250 1850 -19.1% 100 1800 -14.1%
WPNAV_SPEED_UP 150 650 -49.4% 50 650 -39.3% 50 650 -39.3%
I,C,V 1,27,28 29,62,91 133,103,236
Coverage(covered/total validation) 0.05%,9.5%,1.2% 1.4%,21.9%,3.9% 6.5%,36.3%,10.1%
*Lisrangelowerbound, Uisrangeupperbound,reducediscalculatedrelativetooriginalrange, Iisthenumberofincorrectconfigurations
covered by the range guidance, Cis the number of correct configurations covered by the range guidance, Vis the number of validated
configurations covered by the range guidance.
4.4 RQ3: Improvement
To show the advantages of our system, we experimentally com-
pareditwithrvfuzzer[ 20],arecentapproachforsearchingrange
specificationbug.rvfuzzerreliesonthe One-dimensionalMutation
andMulti-dimensional Mutation search to detect incorrect configu-
rations.Byusing One-dimensionalMutation ,centeredonthedefault
parametervalues,rvfuzzerseparatelyconductsbinarysearches
to narrow the upper and lower bounds until a midpoint value is
obtainedthatdoesnotanylongercauseunstablestates.Inthe Multi-
dimensional Mutation multiple parameters are considered, each of
which determines a novel binary mutation search configured with
differentextremevalues(i.e.,maximumandminimum)oftheother
parameters.Alltheseexperimentswerebasedonthesixparame-
ters utilized in rvfuzzer (see Appendix A). In the experiments, we
considered the unstable states listed in Section 2.1.
ComparisonwithRespecttoMissedIncorrectConfigurations.
In theOne-dimensional Mutation , the optimal solution may not
be consistent with the right optimum. For example, using such a
mutationstrategy,thesearchindicatedthatthecorrectrangefor
INS_POS1_Z should remain within [âˆ’4.7,0.0]when it searched for
thelowerbound.However,therewerestillincorrectconfigurations,
specificallybetween âˆ’1.0and0.0,insidethis range.Thereasonis
that,becauseofthebinarysearch,asthefirstmidpoint(i.e., âˆ’2.5)
didnotcauseanunstablestate,thesearchdirectlyskippedvalues
greater than âˆ’2.5. It thus did not cover the [âˆ’1.0,0.0]space, which
resulted in missing potentially incorrect configurations.
In the case of multiple parameters mutations, we first applied
theMulti-dimensional Mutation to determine the correct range. Af-
ter that, based on this correct range, we leveraged LGDFuzzer
to start another search to evaluate whether there are incorrect
configurations. LGDFuzzer still detected 727 potentially incorrect
configurations, of which only 185 were confirmed. Such a result
indicated that the ranges provided by the Multi-dimensional Muta-
tionarenotcorrect.Inouropinion,the Multi-dimensionalMutation
isstill aone-dimensionmutation,because itusesbinary searchto
mutate parameters separately but only imports the extremes of the
value ranges of other parameters. It can be regarded as multipleone-dimensionalmutationswithalimitedcorrelationbetweencon-trolparameters;assuch,itdoesnotconsidertheinfluenceofvalues
different from the extremes of the ranges.
Comparison withRespect to CorrectRange Guidelines. The
six parameters utilized in this experiment are listed in Appendix A.
We leveraged LGDFuzzer to search incorrect configurations for
these six parameters. The search detected 1 ,199 unique potentially
incorrectconfigurations.Thenthevalidationdeterminedthat714
out of those configurations actually leaded to unstable states. After
that, we used them to generate the feasible range guidelines and
chose the lowest incorrect ratio result. Table 3 lists the ranges
obtainedbythreemethods,where 1isOne-dimensionalmutation ,
MisMulti-dimensionalmutation ,andGA(ourGeneticAlgorithm
mutation).
rvfuzzer method 1obtained little reduction for each parameter
range; thus it is not able to rule out incorrect configurations. M
avoidedsomeoftheincorrectconfigurationsbutstillmissesothers.
Because our GAgreatly reduced the ranges, it provided high stabil-
ity. A special case is related to INS_POS3_Z ; the range given by GA
is larger than the range given by M. But this does not mean that
our range for INS_POS3_Z is incorrect. The reason is that, as other
parameters have a smaller range, INS_POS3_Z can have a larger
range, since the validity of configurations is decided based on mul-
tipleparametersinsteadofasingleone.Asforotherparameters,
ANGLE_MAX influences the flight inclination angle. Under the influ-
ence of other parameters, a too large value for ANGLE_MAX is more
likely to cause flight problems. A too small value for the waypoint
speed WPNAV_SPEED makes the drone more likely to freeze; both
MandGAreducesthelowerpartoftherangeforthisparameter.
ForINS_POS*_Z , the ranges returned by GAare smaller than the
ones returned by M, and closer to default values. In fact, chang-
ingINS_POS*_Z influences the position judgment of the inertial
measurement unit. Therefore, this parameter should be changed
carefullyandshouldnotdeviatetoomuchfromthedefaultvalue.
PSC_VELXY_P affected the output gain of the system for accelera-
tion; a too large gain can easily cause drone deviations or thrust
losses.
469
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. Detecting Range Specification Bugs in Drone Configuration Modules via Learning-Guided Search ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Table 3: Comparison of range guideline.
Parameter1 M GA
LU LU LU
PSC_VELXY_P 0.1 6.0 0.6 6.0 1.9 4.2
INS_POS1_Z -4.7 5.0 -1 4.1 -0.5 2.1
INS_POS2_Z -5.0 5.0 -0.7 3.2 -0.7 1.2
INS_POS3_Z -5.0 5.0 -0.8 3.0 -0.9 3.2
WPNAV_SPEED 50 2000 300 2000 50 1950
ANGLE_MAX 1000 8000 1000 8000 1100 4650
I,V,C 699/476/1175 32/18/50 0/7/7
*1: One-dimensional mutation, M: Multi-dimensional mutation, GA: Genetic
Algorithm mutation, Lis range lower bound, Uis range upper bound, Iis
the number of incorrect configurations covered by the range guidance, Cis
thenumberofcorrectconfigurationscoveredbytherangeguidance, Visthe
number of validated configurations covered by the range guidance.
Comparison with Respect to Time Requirements. We ana-
lyzed the time taken by LGDFuzzer and Multi-dimensional Mu-
tation. To determine the range guideline for the six parameters,
we started multiple simulations and took 696 seconds to collect
log data. The predictor took 700 seconds to train until reaching
convergence. The GA search took another 156 seconds to iterateand updated its population (1
,000 configurations). Finally, from
generating data to searching out 1 ,000 incorrect configurations,
our system totally took 1 ,552 seconds. Also, over 85% configura-
tions were validated and detected to actually cause unstable states.
On the contrary, depending on the configuration values, rvfuzzer
usually took between 20 and 120 seconds per round to complete
aAVC2013 flightmission.Evenwhenweallocated1 ,552seconds
toMulti-dimensionalMutation ,itcanonlycarryout78roundsof
mission test. In fact, the Multi-dimensional Mutation search took
roughly2hourstoestimatetheguidelinesforthesixparameters.
In addition, for 20 parameters, the time taken by Multi-dimensional
Mutation increasedexponentially.Instead,thetimeconsumption
of LGDFuzzerwasstillclosertothetimeconsumptionrequiredby
six parameters because the time required by predictor was almost
unchanged.
4.5 Case Studies
After obtaining the fuzzing results, we selected several representa-
tive examples of unstable states to analyze their characteristics.
Deviation. Therearetwomaindeviationsituationsinourexper-
iment: overshoot and fly away. When flying from one waypoint
toanother,thedronefirstacceleratestoreachthetargetvelocity
anddecelerateswhileapproachingthenextwaypoint.Ifthecon-
figuration is set improperly, the dr one is unable to re duce its speed
when close to the waypoint, which caused an overshoot deviation
(see the video of a simulation in which the drone is not able to
break at [ 3]). In comparison, fly away is much more dangerous, in
thatthedronekeepsmovingawayfromitsmission-plannedpath.
We leveraged a real drone experiment to demonstrate the damage
resultingfromthoseunstablestates.Theexperimentsetupasimplesurroundflightmissionandadroneconfigurationissetthat,inthe
simulationtest,resultedinaflyawaydeviation.Asshowninthe
video[2],thedronedeviatedfromthemission-plannedpath.Unfor-
tunately,eventhoughweusedtheRCcontroller(remotemanualcontroller)tomanuallyswitchitsmodeto landinordertostabilize
thedroneandmakesureitwouldlandslowly,thedronewasstill
unable to stabilize and kept deviating. In fact, after checking theoffline flight log, when we manually switched to the landmode,
thesystemreportedaswitchingerrorindicatingthatitcouldnot
stabilize and land. In other words, if the incorrect configuration is
not dealt with in time, the flight stability cannot be even corrected
manually.
FlightFreeze. Therearetwomainsituationsofflightfreeze.On
theonehand,anincorrectcontrolgainparametermakesthedrone
failtoreachthedesiredpositionintime,orprolongthetimetoreach
aparticularwaypointorthedesiredposition.Ontheotherhand,
aninvalidconfigurationaffectsthepositionandcausesthedrone
to around-flight within a small area. We tested the around-flightsituation with a real drone experience. The video at [
4] showed
thatthe drone keepscirclingand wasunableto completethegiven
mission. We analyzed the offline flight log, and from the log, wecould see that the drone kept flight switching between althold
(hovering fly) and landbut could not land successfully.
Drone Crash. Drone crash may be caused by a rollover during
takeofforbyhittingthegrounddue toimproperdescent speed.The
videoat[ 1]showedanactualexampleofadronecrashingwhen
taking off.
Potential Thrust Loss. Thissituation ismainly causedbyan ex-
cessivechangeinangleors peed;the flightcontrollerattemptsto
recoveritspositiontonormal,butthepowerofthemotorcannot
satisfytherequirement.Failureinrecoveringfromthethrustloss
or stabilizing the altitude would lead to a drone crash. In the post-
mortemanalysis,wefoundthatchangingthecontrolparameters
relatedtotheinertialmeasurementunitposition(e.g., INS_POS*_Z )
andthePIDanglecontroller(e.g., ATC_ANG_*_P/I/D )canforcethe
drone into a gradually amplified oscillation.Post-LaunchPrivilegeEscalation.
Post-Launchprivilegeescala-
tionisthenewtypeoferrorwedefined.Acontrolprogramusually
containsacheckingmechanismtopreventobviouserrorsinconfig-urations.Iftheparametersarerelatedtothepositioncontroller(e.g.,
ATC_*_*_P/I/D ),theincorrectconfigurationwillraiseawarning
when the GCS tries to arm the drone. But in fact, if we update
the configuration after the drone takes off, the problem is that the
control system still accepts it, which ultimately drives the drone
to become unstable and out of control. The video at [ 5] showed an
example in which uploading an incorrect configuration during the
mission causes the drone to crash.
5 RELATED WORK
5.1 Drone Fault Detection
A large number of drone fault detection methods/systems have
been proposed to prevent errors during flights. Among them, an
invariant approach [ 14] uses the control invariant to identify phys-
icalattacksagainstroboticvehicles.Buttheirapproachisunableto
prevent attacks thatexploit the range specification bug.Todetect
faultycomponentsinadronesystem,afaultdetectionmethod[ 18]
constructsanobservermodeltoestimatetheoutputinfault-free
470
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Ruidong Han, Chao Yang2, Siqi Ma, JiangFeng Ma, Cong Sun, Juanru Li, and Elisa Bertino
conditions from the history inputs and outputs. Such a system uti-
lizesthedifferencebetweenactualoutputsandthepredictedvalues
todetectfaultysensorandactuatorcomponents,butitstilldoesnotconsidertheinstabilitycausedbyrangespecificationbug.Aneural
network based validation approach [ 27] leverages the analytical
redundancy between flight parameters to detect sensor faults. Like
the other approaches, it only considers external factors. In compar-
ison, LGDFuzzer implements a search system to avoid incorrect
configurationsthat are instability factors within the system.
5.2 Learning-Based Testing
Fromtheperspectiveoflearning-basedtesting,therearethreerele-
vant systems or methods. NEUZZ [ 31] is a gradient-guided search
strategy. It uses a feed-forward neural network to approximateprogrambranchingbehaviorsandpredictthecontrolflowedges
tocovermoretestspace,butthepredictivemodelisnotusedfor
guiding testing. ExploitMeter [ 38] uses dynamic fuzzing tests with
machine learning-based prediction to update the belief in software
exploitability. A learning-guided fuzzing [ 9] uses an LSTM net-
work to model the input-output relation of the target system and a
meta-heuristic method to search for specific actuator commandsthat could drive the system into unsafe states. A reinforcement
fuzzing[8]appliesadeepQ-learning[ 25]algorithmtogeneratean
optimizedpolicyforthefuzzing-basedtestingofPDFprocessing
programs.DeepSmith[ 15]trainsagenerativemodelwithalarge
corpus of open source code and uses this model to produce test-
inginputstoexaminetheOpenCLcompilerautomatically.These
approaches make use of prior knowledge to drive the mutation
input. Similarly, we introduced a machine learning model to guide
the search test process. However, our LGDFuzzer combines the
modelwiththegeneticalgorithmtocarryoutalarge-scalemulti-
parameter search.
6 CONCLUSION
Incorrect configurations of drone control parameters, set by legiti-
mateusersorworstsentbyattackers,canresultinflightinstabilitiesdisruptingdronemissions.Inthispaper,weproposeafuzzing-based
systemthat efficientlyand effectivelydetectsthe incorrectparam-
eterconfigurations.LGDFuzzerusesamachinelearning-guided
fuzzing approach that uses a predictor, a genetic search algorithm,
and multi-objective optimization to detect incorrect configurations
and provide correct feasible ranges. We have experimentally com-
pared LGDFuzzer with a state-of-the art tool. The experimentalresults show that LGDFuzzer is superior to such a tool in all re-
spects. Even though our methodology has been designed for aerial
drones,webelievethatitcanbeusedforothermobiledeviceswith
complex controls, such as underwater drones.
ACKNOWLEDGMENT
We would like to thank anonymous reviewers for the insightful
comments.ThisworkissupportedbytheFoundationforInnovative
Research Groups of the National Natural Science Foundation of
China (Grant No. 62121001).
REFERENCES
[1] Demo Video 2021. [n.d.]. Crash. https://youtu.be/TZFcyl5d2mk.[2]Demo Video 2021. [n.d.]. Deviation with flying away . https://youtu.be/
0buFPNhkLJc.
[3]Demo Video 2021. [n.d.]. Deviation with overshoot. https://youtu.be/imsBGaX-
8ug.
[4] Demo Video 2021. [n.d.]. Flight Freeze. https://youtu.be/g79lsTp6H4g.
[5]DemoVideo2021.[n.d.]. Post-LaunchPrivilegeEscalationLeadstoCrash. https:
//youtu.be/B_WULGY-Dbg.
[6]RyoAkita,AkiraYoshihara,TakashiMatsubara,andKuniakiUehara.2016. Deeplearningforstockpredictionusingnumericalandtextualinformation.In Proceed-
ings of the 15th IEEE/ACIS International Conference on Computer and Information
Science (ICIS). IEEE, 1â€“6.
[7]Florent AltchÃ© and Arnaud de La Fortelle. 2017. An LSTM network for highway
trajectory prediction. In Proceedings of the 20th IEEE International Conference on
Intelligent Transportation Systems (ITSC). IEEE, 353â€“359.
[8]Konstantin BÃ¶ttinger, Patrice Godefroid, and Rishabh Singh. 2018. Deep rein-
forcementfuzzing.In Proceedingsofthe2018IEEESecurityandPrivacyWorkshops
(SPW). IEEE, 116â€“122.
[9]YuqiChen,ChristopherMPoskitt,JunSun,SridharAdepu,andFanZhang.2019.
Learning-Guided network fuzzing for testing cyber-physical system defences. In
Proceedingsofthe34thIEEE/ACMInternationalConferenceonAutomatedSoftware
Engineering (ASE). IEEE, 962â€“973.
[10]Kai Cheng, Qiang Li, Lei Wang, Qian Chen, Yaowen Zheng, Limin Sun, andZhenkai Liang. 2018. DTaint: detecting the taint-style vulnerability in embed-ded device firmware. In Proceedings of the 48th Annual IEEE/IFIP International
Conference on Dependable Systems and Networks (DSN). IEEE, 430â€“441.
[11]Long Cheng, Ke Tian, Danfeng Daphne Yao, Lui Sha, and Raheem A. Beyah.
2021. Checking is Believing: Event-Aware program anomaly detection in cyber-
physicalsystems. IEEETransactionsonDependableandSecureComputing 18,2
(2021), 825â€“842.
[12]Yizong Cheng. 1995. Mean shift, mode seeking, and clustering. IEEE transactions
on pattern analysis and machine intelligence 17, 8 (1995), 790â€“799.
[13]Victor Chibotaru, Benjamin Bichsel, Veselin Raychev, and Martin Vechev. 2019.
Scalable taint specification inference with big code. In Proceedings of the 40th
ACMSIGPLANConferenceonProgrammingLanguageDesignandImplementation
(PLDI). ACM, 760â€“774.
[14]Hongjun Choi, Wen-Chuan Lee, Yousra Aafer, Fan Fei, Zhan Tu, Xiangyu Zhang,Dongyan Xu, and Xinyan Deng. 2018. Detecting attacks against robotic vehicles:
A control invariant approach. In Proceedings of the 2018 ACM SIGSAC Conference
on Computer and Communications Security (CCS). ACM, 801â€“816.
[15]ChrisCummins,PavlosPetoumenos,AlastairMurray,andHughLeather.2018.
Compilerfuzzingthroughdeeplearning.In Proceedingsofthe27thACMSIGSOFT
InternationalSymposiumonSoftwareTestingandAnalysis(ISSTA) .ACM,95â€“105.
[16]Felix A Gers, JÃ¼rgen Schmidhuber, and Fred Cummins. 2000. Learning to forget:Continual prediction with LSTM. Neural Computation 12, 10 (2000), 2451â€“2471.
[17]AxelHalin,AlexandreNuttinck,MathieuAcher,XavierDevroey,GillesPerrouin,
andBenoitBaudry.2019. Testthemall,isitworthit?Assessingconfiguration
samplingonthejHipsterwebdevelopmentstack. EmpiricalSoftwareEngineering
24, 2 (2019), 674â€“717.
[18]G Heredia, A Ollero, M Bejar, and R Mahtani. 2008. Sensor and actuator fault
detection in small autonomous helicopters. Mechatronics 18, 2 (2008), 90â€“99.
[19] Taegyu Kim, Chung Hwan Kim, Altay Ozen, Fan Fei, Zhan Tu, Xiangyu Zhang,
Xinyan Deng, Dave (Jing) Tian, and Dongyan Xu. 2020. From control model
to program: Investigating robotic aerial vehicle accidents with MAYDAY. In
Proceedings of the29th USENIX Security Symposium(USENIX Security). USENIX
Association, 913â€“930.
[20]Taegyu Kim, Chung Hwan Kim, Junghwan Rhee, Fan Fei, Zhan Tu, Gregory
Walkup, Xiangyu Zhang, Xinyan Deng, and Dongyan Xu. 2019. RVFuzzer:
Finding input validation bugs in robotic vehicles through control-guided testing.
InProceedingsofthe28thUSENIXSecuritySymposium(USENIXSecurity).USENIX
Association, 425â€“442.
[21]Donald E. Knuth. 1971. Optimum Binary Search Trees. Acta informatica 1, 1
(1971), 14â€“25.
[22]SiqiMa,JuanruLi,HyoungshickKim,ElisaBertino,SuryaNepal,DiethelmOstry,
and Cong Sun. 2021. Fine with â€œ1234â€? An analysis of SMS one-Time password
randomnessin androidapps. In Proceedingsof the43rd IEEE/ACMInternational
Conference on Software Engineering (ICSE). IEEE, 1671â€“1682.
[23]Siqi Ma, Juanru Li, Surya Nepal, Diet Ostry, David Lo, Sanjay Jha, Robert H
Deng, and Elisa Bertino. 2021. Orchestration or automation: authentication flaw
detectioninandroidapps. IEEETransactionsonDependableandSecureComputing
(2021).
[24]Lorenz Meier, Petri Tanskanen,Friedrich Fraundorfer, andMarc Pollefeys. 2011.
Pixhawk: A system for autonomous flight using onboard computer vision. In
Proceedings of the 2011 IEEE International Conference on Robotics and Automation
(ICRA). IEEE, 2992â€“2997.
[25]Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis
Antonoglou,DaanWierstra,andMartinRiedmiller.2013. Playingatariwithdeep
reinforcement learning. arXiv preprint arXiv:1312.5602 (2013).
471
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. Detecting Range Specification Bugs in Drone Configuration Modules via Learning-Guided Search ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
[26]Xiao rui Zhu, Chen Liang, Zhen guo Yin, Zhong Shao, Meng qi Liu, and Hao
Chen. 2019. A new hierarchical software architecture towards safety-critical
aspects of a drone system. arXiv:1905.06768 [cs.SE]
[27]Ihab Samy, Ian Postlethwaite, and Dawei Gu. 2008. Neural network based sensor
validationschemedemonstratedonanunmannedairvehicle(UAV)model.In
Proceedings of the 47th IEEE Conference on Decision and Control (CDC). IEEE,
1237â€“1242.
[28]SreelekshmySelvin,RVinayakumar,E.AGopalakrishnan,VijayKrishnaMenon,andK.P.Soman.2017. StockpricepredictionusingLSTM,RNNandCNN-sliding
windowmodel.In Proceedingsofthe2017InternationalConferenceonAdvances
in Computing, Communications and Informatics (ICACCI). IEEE, 1643â€“1647.
[29]Shital Shah, Debadeepta Dey, Chris Lovett, and Ashish Kapoor. 2017. AirSim:High-fidelityvisualandphysicalsimulationforautonomousvehicles.In Field
and Service Robotics. arXiv:arXiv:1705.05065
[30]DongdongShe,YizhengChen,AbhishekShah,BaishakhiRay,andSumanJana.
2020. Neutaint:Efficientdynamictaintanalysiswithneuralnetworks.In Proceed-
ings of the 2020 IEEE Symposium on Security and Privacy (SP). IEEE, 1527â€“1543.
[31]DongdongShe,KexinPei,DaveEpstein,JunfengYang,BaishakhiRay,andSuman
Jana.2019. NEUZZ:Efficientfuzzingwithneuralprogramsmoothing.In Proceed-
ings of the 2019 IEEE Symposium on Security and Privacy (SP). IEEE, 803â€“817.
[32]Reinhard Tartler, Daniel Lohmann, Christian Dietrich, Christoph Egger, and
Julio Sincero. 2011. Configuration coverage in the analysis of large-scale system
software. In Proceedings of the 6th Workshop on Programming Languages and
Operating Systems (PLOS). ACM, Article 2, 5 pages.
[33]ArduPilot Team. [n.d.]. Autopilot Hardware Options. https://ardupilot.org/
copter/docs/common-autopilots.html#closed-hardware.
[34]ArduPilot Team. [n.d.]. SparkFun autonomous vehicle competition 2013. https:
//avc.sparkfun.com/2013.
[35]ArduPilot Dev Team. [n.d.]. Ardupilot - Versatile, Trusted, Open Autopilot
software for drones and other autonomous systems. https://ardupilot.org/.
[36]Zhou Wang and Alan C. Bovik. 2009. Mean squared error: Love it or leave it?
AnewlookatSignalFidelityMeasures. IEEESignalProcessingMagazine 26,1
(2009), 98â€“117.
[37]Darrell Whitley. 1994. A genetic algorithm tutorial. Statistics and computing 4, 2
(1994), 65â€“85.
[38]Guanhua Yan, Junchen Lu, Zhan Shu, and Yunus Kucuk. 2017. Exploitmeter:Combining fuzzing with machine learning for automated evaluation of soft-
ware exploitability. In Proceedings of the 2017 IEEE Symposium on Privacy-Aware
Computing (PAC). IEEE, 164â€“175.
472
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Ruidong Han, Chao Yang2, Siqi Ma, JiangFeng Ma, Cong Sun, Juanru Li, and Elisa Bertino
A DESCRIPTION OF PARAMETERS
Table 4: Parameters of control program for experiments.
Control Module Parameter Range Default Description.
ControllerPSC_POSXY_P [0.50, 2.00] 1.0 PositioncontrollerPgain.Convertsthedistance(inthelatitudedirection)tothe
target location into a desired speed which is then passed to the loiter latitude rate
controller.
PSC_VELXY_P [0.10, 6.00] 2.0 Velocity (horizontal) P gain. Converts the difference between desired velocity to a
target acceleration.
PSC_POSZ_P [1.00, 3.00] 1.0 Position(vertical)controllerPgain.Convertsthedifferencebetweenthedesired
altitude and actual altitude into a climb or descent rate which is passed to the
throttle rate controller.
ATC_ANG_RLL_P [0.00, 12.0] 4.5 Roll axis angle controller P gain. Converts the error between the desired roll angle
and actual angle to a desired roll rate.
ATC_RAT_RLL_I [0.01, 2.00] 0.135 Roll axis rate controller I gain. Corrects long-term difference in desired roll rate vs
actual roll rate.
ATC_RAT_RLL_D [0.00, 0.05] 0.0036 RollaxisratecontrollerDgain.Compensatesforshort-termchangeindesiredroll
rate vs actual roll rate.
ATC_RAT_RLL_P [0.01, 0.50] 0.135 RollaxisratecontrollerPgain.Convertsthedifferencebetweendesiredrollrate
and actual roll rate into a motor speedoutput.
ATC_ANG_PIT_P [0.00, 12.0] 4.5 Pitchaxisangle controllerPgain. Convertstheerror between thedesiredpitch
angle and actual angle to a desired pitch rate.
ATC_RAT_PIT_P [0.01, 0.50] 0.135 Pitch axis rate controller P gain. Converts the difference between desired pitch
rate and actual pitch rate into a motor speedoutput.
ATC_RAT_PIT_I [0.01, 2.00] 0.135 Pitch axis rate controller I gain. Correctslong-term difference in desired pitch rate
vs actual pitch rate.
ATC_RAT_PIT_D [0.00, 0.05] 0.0036 PitchaxisratecontrollerDgain.Compensatesforshort-termchangeindesired
pitch rate vs actual pitch rate.
ATC_ANG_YAW_P [0.00, 6.00] 4.5 YawaxisanglecontrollerPgain.Convertstheerrorbetweenthedesiredyawangle
and actual angle to a desired yaw rate.
ATC_RAT_YAW_P [0.10, 2.50] 0.18 Yaw axis rate controller P gain. Converts the difference between desired yaw rate
and actual yaw rate into a motor speedoutput.
ATC_RAT_YAW_I [0.01, 1.00] 0.018 YawaxisratecontrollerIgain.Correctslong-termdifferenceindesiredyawrate
vs actual yaw rate.
ATC_RAT_YAW_D [0.00, 0.02] 0 Yaw axis rate controller D gain. Compensates for short-term change in desired
yaw rate vs actual yaw rate.
MissionWPNAV_SPEED [20, 2000] 500 Definesthespeedin ğ‘ğ‘š/ğ‘ whichtheaircraftwillattempttomaintainhorizontally
during a Waypoint mission.
WPNAV_SPEED_DN [10, 500] 150 Defines the speed in ğ‘ğ‘š/ğ‘ which the aircraft will attempt to maintain while
descending during a Waypoint mission.
WPNAV_SPEED_UP [10, 1000] 250 Defines the speed in ğ‘ğ‘š/ğ‘ which the aircraft will attempt to maintain while
climbing during a Waypoint mission.
WPNAV_ACCEL [50, 500] 100 Defines the horizontal acceleration in ğ‘ğ‘š/ğ‘ 2used during missions.
ANGLE_MAX [1000, 8000] 4500 Maximum lean angle in all flight modes.
Table 5: Parameters of control program for comparisons.
Control Module Parameter Range Default Description.
Controller PSC_VELXY_P [0.0,6.0]2.0 Converts the difference between desired velocity to a target acceleration.
SensorINS_POS1_Z [âˆ’5.0,5.0]0.0 Z position of the first IMU accelerometer in body frame.
INS_POS2_Z [âˆ’5.0,5.0]0.0 X position of the second IMU accelerometer in body frame.
INS_POS3_Z [âˆ’5.0,5.0]0.0 Y position of the second IMU accelerometer in body frame.
MissionWPNAV_SPEED [20, 2000] 500 Defines the speedinğ‘ğ‘š/ğ‘ which the aircraft will attempt to maintain horizontally
during a Waypoint mission.
ANGLE_MAX [1000, 8000] 4500 Maximum lean angle in all flight modes.
473
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 07:54:11 UTC from IEEE Xplore.  Restrictions apply. 