KVS: A Tool for Knowledge-Driven Vulnerability Searching 
Xingqi Cheng∗
Yangzhou University 
Yangzhou, China 
cinqi1026@gmail.comXiaobingSun †
Yangzhou University 
Yangzhou, China 
xbsun@yzu.edu.cn
Lili Bo ‡
Yangzhou University 
Yangzhou, China 
lilibo@yzu.edu.cnYingWei 
Yangzhou University 
Yangzhou, China 
252764195@qq.com
ABSTRACT 
Itisdiﬃculttoquicklylocateandsearchforspeciﬁcvulnerabilities 
andtheirsolutionsbecausevulnerabilityinformationisscattered 
intheexistingvulnerabilitymanagementlibrary.Toalleviatethis 
problem,weextractknowledgefromvulnerabilityreportsandor- 
ganize the vulnerability information into the form of a knowledge 
graph. Then, we implement a tool for knowledge-driven vulner- 
ability searching, KVS. This tool mainly uses the BERT model to 
realize the vulnerability named entity recognition and construct 
the vulnerability knowledge graph (VulKG). Finally, we can search 
vulnerabilities of interest-based on VulKG. The URL of this tool 
is https://cinnqi.github.io/Neo4j-D3-VKG/ . Video of our demo is 
available at https://youtu.be/FT1BaLUGPk0 .
CCSCONCEPTS
•Software and its engineering →Softwaredefect analysis ;•
Computingmethodologies →Information extraction .
KEYWORDS 
vulnerability knowledge graph, BERT, namedentity recognition 
ACM Reference Format: 
Xingqi Cheng, Xiaobing Sun, Lili Bo, and Ying Wei. 2022. KVS: A Tool 
forKnowledge-DrivenVulnerabilitySearching.In Proceedingsofthe30th 
ACMJointEuropeanSoftwareEngineeringConferenceandSymposiumonthe 
FoundationsofSoftwareEngineering(ESEC/FSE’22),November14–18,2022,
Singapore, Singapore. ACM, New York, NY, USA, 5pages.https://doi.org/10.
1145/3540250.3558920
∗AlsowithInstituteofComputerScience,HeidelbergUniversity,Heidelberg,Germany 
†Correspondingauthor
‡Also with State Key Laboratory for Novel Software Technology, Nanjing University,
Nanjing, China
Permissionto make digital or hardcopiesof all orpart ofthis work forpersonal or 
classroom use is granted without fee provided that copies are not made or distributed 
forproﬁtorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation 
on the ﬁrst page. Copyrights for components of this work owned by others than ACM 
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspeciﬁcpermissionand/ora 
fee. Requestpermissions frompermissions@acm.org.
ESEC/FSE’22, November14–18,2022,Singapore,Singapore 
©2022Association forComputing Machinery.
ACM ISBN 978-1-4503-9413-0/22/11...$15.00 
https://doi.org/10.1145/3540250.35589201 INTRODUCTION 
Some famous vulnerability collection platforms, such as CVE 1
(Common Vulnerabilities and Exposures) and NVD 2(National Vul- 
nerabilityDatabase)arewidelyusedtosupportanalysisofsoftware 
vulnerabilities.Thescaleofvulnerabilitiescontinuestoexpand,and 
thenumberofvulnerabilitiesinthevulnerabilitymanagementdata- 
base increases. Since CVE ﬁrst included vulnerabilities in 1999, the 
number of vulnerabilities has been on the rise every year, from 894 
in 1999 to 18,325 in 2020 [ 1]. The increase in the number of vul- 
nerabilitieshasmadeitdiﬃculttomanageandsearch.Therefore,
whendeveloperswanttocomprehensivelysearchforvulnerabili- 
ties related to their own work, they not only need to spend time 
ﬁnding similar vulnerabilities but also need time to analyze the re- 
lationships among related vulnerabilities. This makes vulnerability 
analysisandﬁxing time-consumingandlaborious.
In ordertoreduce the manual maintenance costofsoftware se- 
curityandimprovetheutilizationofdatainthepublicvulnerability 
management database, we developed a tool called KVS. The tool 
has three key components, namely the vulnerability named en- 
tity recognition (VulNER) part, the vulnerability knowledge graph 
(VulKG) storage part, and the VulKG visualization part. We use 
VulNER to extract knowledge from the vulnerability description 
and use the extracted information to build VulKG, then perform 
further search operations based on VulKG. Achieving the purpose 
ofin-depthanalysisofvulnerabilitydatainCVEandNVD,along 
with improving the accuracy of search, makes search results more 
intelligentandthe searchprocessmore eﬀective.
2 USAGEEXAMPLE 
KVSismainlybasedontheVulKGtosearchforvulnerabilities,and 
its functionalarea is dividedinto three.
•Graphdisplayarea(‘4’inFigure 1)mainlydisplaystheforce- 
directed graph realized by D3 (Data-Driven Documents),
includingallthenodesandrelationships,whichisthemajor 
part of the page.
•Graph information display area (‘2’ in Figure 2) is used to 
displaythe information of the currently selectednode.
•User operation area includes node and text display mode 
switching(‘1’inFigure 1),graphsearch(‘2’inFigure 1),and 
multi-legendmodelswitch(‘3’inFigure 1),whichisthearea 
that userscan interact.
1http://cve.mitre.org/ 
2https://nvd.nist.gov/ 
1731
ESEC/FSE’22,November14–18, 2022, Singapore, Singapore XingqiCheng, XiaobingSun, LiliBo, and YingWei 
KVS uses diﬀerent legends to represent diﬀerent types of nodes.
The information extracted by the Named Entity Recognition (NER) 
task is represented by yellow nodes, other vulnerability attributes 
are represented by green nodes, and CWE ID (the type of CVE),
representedbybluenodes.Userscanzoominoroutofthegraph 
withthemousewheel.Mousedraggingisalsoprovidedtoincrease 
interactivity. When the mouse is placed over a node, only nodes 
relatedtothecurrentnodewillbedisplayed(‘1’inFigure 2),and 
all relevant information will be visible in texton the right side (‘2’ 
in Figure 2).
Figure1:Theoverallinterfaceof KVS 
Figure2:Displayresult of a nodeselected by themouse 
Vulnerability search is the most vital function of KVS, which 
mainlyincludeskeyword-basedsearchandIDnumber-basedsearch.
Keyword-based search means the user can enter any keywords 
he/she wants to ﬁnd as long as they exist in the graph. Figure 3
shows the search based on the keywords. When the user enters 
the “race condition" in the input box (‘2’ in Figure 3), the web 
page will return the search results. However, a search for "race 
condition" from the CVE website 3will return a list of CVE IDs 
and their descriptions. The information is unstructured and it is 
hard to capture key information. Compared with the search results 
displayedintheCVEwebsitelist,thegraphicalsearchresultsshown 
inFigure 3displaykeyinformationandresultrelationshipsinan 
orderlymanner.AsshowninFigure 3,the"racecondition"isthe 
cause ofmultiple CVEs. When hovering overa speciﬁcCVE node,
the user can also view detailed information. By comparing with 
3https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=race+condition suchsearchresults,vulnerabilityanalysiswillbecomeeasierand 
more comprehensive.
Figure 3: Search and display model switch example 
3 APPROACH 
The overview of the KVS is shown in Figure 4. KVS obtains un- 
structuredandsemi-structureddatafromCVEandNVD.ThenKVS 
performsﬁne-grainedNERusingtheBERT-BiLSTM-CRFmodelfor 
unstructureddata.Theextractedinformationtogetherwithsemi- 
structured data forms entities and relation tables. Finally, VulKG 
isvisualizedusingthefront-endtechnique.Thissectionoutlines 
each constructionstep andgives a detailedexplanation.
Vulnerability 
Reports Vulnerability 
Reports 
Unstructured Text 
Summary Semi-structured Text 
CWE ID 
CVSS Score 
Ċ
 Entity Table 
Relation Table VulKG 
Front- end Visualization CRF 
BiLSTM BiLSTM Ċ BiLSTM 
BERT
W0W1 Wn ĊCRF 
BiLSTM BiLSTM Ċ BiLSTM 
BERT
W0WWW0W1WWW1 WnWWWn Ċ
Figure 4: Overviewof the KVS 
3.1 Data Preparation 
Inthissection,wemainlydevelopedanewﬁne-grainedNERdataset 
fortheVulNERtask.WeusetheBig-VuldatasetconstructedbyJia- 
hao Fan et al. [ 5] in 2020 as a data resource. Big-Vul crawls data on 
CVEandNVDwebsites,includessemi-structuredtextsuchasCWE 
ID, CVSS score, and unstructured text such as summary(as shown 
inFigure 4).This paperuses thesummaryinformation inBig-Vul 
for data labeling and constructs a ﬁne-grained VulNER dataset.
SummaryisaspeciﬁcdescriptionofeachCVEvulnerability,which 
ishigh-qualityunstructureddatasource.Afterpreprocessingthe 
summarydata,whichisseparatethepunctuationandcharactersin 
thetext, we use the preprocesseddata fordata labeling. Examples 
of data labeling are shown in Table 1. The number for the train set 
is915,thetestsetis102andthepredictionsetis4114.Thispaper 
deﬁnes eight entity categories for VulNER task, namely version,
consequence, attacker, triggering operation, location, cause, occur- 
rence scenario, and related issue. The distribution of each entity 
category on the train andtestdata setsis shown in Figure 5.
1732KVS: ATool forKnowledge-Driven Vulnerability Searching ESEC/FSE’22,November14–18, 2022, Singapore, Singapore 
Table 1:Datalabelingexample 
SummaryInteger overﬂowin the pango_glyph_string_set_ 
sizefunction in pango/glyphstring.cin Pango be- 
fore 1.24allows context-dependentattackers to 
causea denial ofservice via a long glyphstring 
that triggersa heap-based buﬀeroverﬂow.
Label cause:Integeroverﬂow; location :pango_glyph_ 
string_set_sizefunction in pango/glyphstring.c;
version :Pangobefore 1.24; attacker:context- 
dependent attac_kers; consequence :a denial of 
serviceconsequence :a heap-basedbuﬀerover- 
ﬂow;triggeringoperation :a long glyph string 
98.47% 95.19% 
89.95% 89.51% 
82.51% 79.78% 
6.99% 4.81% 98.04% 92.16% 
86.27% 84.31% 73.53% 82.35% 
8.82% 5.88% 
0100200 300 400 5006007008009001000
version consequence attacker triggering 
operation location cause occurrence 
scenario related issue trian test 
Figure5:Entities distributionfortrainand test set 
3.2 VulnerabilityNamed Entity 
Recognition(VulNER) 
Based on the eight entity types we deﬁned, the next step is to 
use Natural Language Processing (NLP) technology to identify 
these entities. NER is essentially a sequence labeling task in the 
downstreamtaskofNLP.WeadopttheBIOmethodtolabeleach 
sentence, B-NE indicates the beginning of an entity of type NE,
I-NEindicatesthemiddle(includingtheend)ofanentityoftype 
NE,andOindicatesthenon-entitypartofthetext.NERtaskisto 
predictthedistributionofnewsentencesandtheirlabelsthrough 
countlesssentences andtheirBIOtags.
Since Google proposed the BERT (Bidirectional Encoder rep- 
resentations from Transformers) pre-training model in 2018 [ 3],
itsexcellentperformanceindiﬀerentdownstreamtaskshasmade 
the use of BERT one of the mainstream choices for completing 
NER tasks. Therefore, this paper introduces the BERT-base as a 
pre-trainedmodel,usingBiLSTM-CRF[ 7]onthetopasthemodel 
architecturetoidentifyvariousentitiesoftheCVEsummary.The 
model architecture withBIOexample is shown in Figure 6.
3.3 VulKGStorage and Visualization 
VulKG is composed of relationships and nodes. The deﬁnition and 
number of nodes and relationships, as well as the color of each 
typeofnode,areshowninTable 2.Afterdataprocessing,theeight 
entitiesidentiﬁedbyVulNERandtheselectedkeysareextracted 
to form entity tables and relation tables (as shown in Fig. 4). The O
LSTMB-cause I-cause O B-location I-location I-location O
LSTM LSTM LSTM LSTM LSTM LSTM LSTM
LSTM LSTM LSTM LSTM LSTM LSTM LSTM
BERT
[CLS] ##. cLSTMCRF
Layer
Forward  
LSTMBackward
LSTM
Integer  overflow in pango [SEP] 
Figure 6: BERT-BiLSTM-CRF model 
deﬁnition of the relationship is the relationship between CVE and 
15 entities (8 extracted info + 6 selected keys + 1 CWE ID), thus 
the source node in each pair of relationships is the CVE ID, the 
target node is one of the remaining 15 nodes. The relationship 
nameisthesameasthetargetnodename.VulKG containsatotal 
of 20,631 nodes and 50,961 relationships stored in a graph database 
called Neo4j. For the visualization of VulKG, we combined D3.js 
to realize the front-end visualization. For searching with VulKG,
therealizationofthevisualquerymainlyconvertstheJSONdata 
formatreturnedbyNeo4jintotheD3requiredformatandthenuses 
the D3 binding query event to search the results, ﬁnally rendering 
the resultsandvisualizing themto the user.
Table 2:Thenumberof nodes and relationships in VulKG 
nodes relationships 
Extracted
Info
(yellow) cause 1877 cve:cause 3398
consequence 1567cve:consequence 4264
version 1955 cve:version 4052
location 2530 cve:location 3160
attacker 153 cve:attacker 3349
triggering
operation 1896cve:triggering 
operation 3359
occurrence 
scenario224cve:occurrence 
scenario267
relatedissue 107cve:related issue 126
Keys 
(blue) publish date 838cve:publishdate 4114
score 51 cve:score 4114
project 348 cve:project 4114
vulnerability
classiﬁcation54 cve:vulnerability 
classiﬁcation4114
commitid 4390 cve:commitid 4114
update date 688cve:update date 4114
IDsCWEID 92 cve:cwe id 4114
CVEID 3755
Total 20631 50961
4 EXPERIMENTS 
4.1 ExperimentalSettings
The hardware environment of the experiment is GPU: NVIDIA 
Tesla T4, CPU: Inter(R) Xeon(R) Silver 4214R, and the software 
environment isPython 3.8 and Pytorch1.8.The BERTmodel uses 
1733ESEC/FSE’22,November14–18, 2022, Singapore, Singapore XingqiCheng, XiaobingSun, LiliBo, and YingWei 
thePytorchversion 4.Themodelhas12layers,12headpatterns,768- 
dimensional hidden layers, and 110M parameters. Then connect 
diﬀerent layers to form BERT-Softmax and BERT-BiLSTM -CRF 
model. The related parameters of the experiment are shown in 
Table 3.
Table 3:Experimental parametersettings 
parameter BERT-Softmax BERT-BiLSTM-CRF
maxlength 512 512
batchsize 8 8
learning rate 2.00E-05 4.00E-05
dropout 0.1 0.1
weightdecay 0.0005 0.0005
gradient clipping 1 1
4.2 Experimental Results
In order to better evaluate the recognition results of the model, we 
use the/u1D45D/u1D45F/u1D452/u1D450/u1D456/u1D460/u1D456/u1D45C/u1D45B (/u1D443),/u1D45F/u1D452/u1D450/u1D44E/u1D459/u1D459 (/u1D445)and the/u1D4391to evaluate the results 
separately. The formula is as follows:
/u1D443=/u1D447/u1D45D
/u1D447/u1D45D+/u1D439/u1D45D(1)
/u1D445=/u1D447/u1D45D
/u1D447/u1D45D+/u1D439/u1D441(2)
/u1D4391=2×/u1D443×/u1D445
/u1D443+/u1D445(3)
/u1D447/u1D45Drepresentsthenumberofentitiescorrectlyidentiﬁedbythe 
model,/u1D439/u1D45Drepresentsthenumberofentitiesincorrectlyidentiﬁed 
bythemodel,and /u1D439/u1D441isthenumberofentitiesnotidentiﬁedbythe 
model.
After 20 epochs, the precision, recall, and F1 score of the two 
models are shown in Table 4. From the overall results aspect, com- 
paredwiththebenchmarkmodelBERT-Softmax,therevisedmodel 
BERT-BiLSTM-CRFhasaprecisionrateincreaseof2 %,arecallrate 
increaseof4 %andanF1scoreincreaseof3 %.Fromtherecognition 
resultsofeachentityaspect,BERT-BiLSTM-CRFisalsopowerful 
than BERT-Softmax.This is because the BiLSTM layer adds seman- 
tic cohesion at the temporal level and the CRF layer makes the 
predictedoutputlabelsofthesequencecorrelatewitheachother,
which is more conducive to the recognition of long entities such 
as location entity and consequence entity. However, there are also 
twotypesofentitieswithpoorrecognitioneﬀectscomparewith 
otherentities,thatis,occurrencescenarioentitiesandrelatedissue 
entities,theirF1scoredoesnotexceed0.8inthetwomodels.The 
reason for the result may consider that these two types of enti- 
ties have fewer training samples, as shown in Figure 5, thus the 
model cannot learn their features well. Based on the results of this 
experiment, the better BERT-BiLSTM-CRF model is used for en- 
tity prediction on the prediction set. However, the accuracy of the 
prediction resultscannotbemeasured. ThetwoNER modelsused 
inthispaperperformwellinﬁne-grainedentityrecognition,but 
thereisstillalotofroomforimprovement.Duetotherelatively 
4https://github.com/huggingface/transformerssmalldataset, furtherresearchcanconsideraddingmoretraining 
samplesto improve the recognition accuracy ofthe model.
Table 4:Entities Result and overallresult ontwomodels 
EntitiesBERT-Softmax BERT-BiLSTM-CRF
P R F1 P R F1 
version 0.90 0.91 0.90 0.93 0.93 0.93
consequence 0.81 0.79 0.80 0.85 0.85 0.85
attacker 0.93 0.92 0.93 0.94 0.93 0.93
triggering
operation 0.82 0.86 0.84 0.88 0.89 0.89
location 0.90 0. 94 0.92 0.93 0.95 0.94
cause 0.80 0.79 0.79 0.83 0.83 0.83
occurrence 
scenario0.86 0.67 0.75 0.75 0.67 0.71
relatedissue 0.33 0.11 0.17 0.45 0.56 0.50
OverallResult 0.86 0.85 0.85 0.88 0.89 0.88
5 RELATEDWORK 
Croft et al. [ 2] investigated the inconsistency over the software 
vulnerability reports and reported this inconsistency can signiﬁ- 
cantlyreducetheperformanceofpredictingtasksbyupto77%.Gao 
et al. [ 6] conducted the vulnerabilities evolution study based on 
Androidbyreconstructinglineagesandapks.Insecuritydomain 
knowledgegraphconstructionresearches,thereweremanymod- 
els and methods proposed. Du et al. [ 4] collected and integrated 
dataofCVE,Maven,andGithubtoformasoftwarevulnerability 
knowledge graph. Jia et al. [ 8] used Stanford NER to recognize 
security-related entities, build a cybersecurity knowledge graph.
Qin et al. [ 9] proposed the AARV model for automatic analysis 
and reasoning basedon vulnerability knowledge graph. Compare 
with the worksmentionedabove, KVS uses diﬀerentdata sources.
Moreover, KVS deﬁnes more entity types to recognize and adds 
more vulnerability detailstothe knowledge graph.
6 CONCLUSION 
In this paper, we design a vulnerability search tool (KVS) based on 
theknowledgegraph.ThroughKVS,userscanobtainthehidden 
relationshipbetweenvulnerabilities,searchtherelevantknowledge 
fora certain vulnerability.
ACKNOWLEDGMENTS 
ThisworkissupportedbytheNationalNaturalScienceFoundation 
of China (No.61872312, No.61972335, No.62002309); the Six Talent 
PeaksProjectinJiangsuProvince(No.RJFW-053),theJiangsu“333” 
Project;the Natural Science Foundation ofthe Jiangsu Higher Ed- 
ucationInstitutionsofChina(No.20KJB520016);theOpenFunds 
of State Key Laboratory for Novel Software Technology of Nan- 
jing University (No.KFKT2022B17), the Yangzhou University In- 
terdisciplinary Research Foundation for Animal Husbandry Dis- 
cipline of Targeted Support (yzuxk202015), the Yangzhou city- 
Yangzhou University Science and Technology Cooperation Fund 
Project (YZ2021157) and Yangzhou University Top-level Talents 
SupportProgram(2019).
1734KVS: ATool forKnowledge-Driven Vulnerability Searching ESEC/FSE’22,November14–18, 2022, Singapore, Singapore 
REFERENCES
[1]SicongCao,XiaobingSun,LiliBo,YingWei,andBinLi.2021. BGNN4VD:Con- 
structing Bidirectional Graph Neural-Network for Vulnerability Detection. In-
formationandSoftware Technology 136(2021), 106576. https://doi.org/10.1016/j.
infsof.2021.106576
[2]RolandCroft,M.AliBabar,andLiLi.2022. AnInvestigationintoInconsistencyof 
Software VulnerabilitySeverityacross Data Sources. In 2022 IEEEInternational
ConferenceonSoftwareAnalysis,EvolutionandReengineering(SANER) .338–348.
https://doi.org/10.1109/SANER53432.2022.00050
[3]Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019. BERT:
Pre-training of Deep Bidirectional Transformers for Language Understanding. In 
Proceedingsofthe2019ConferenceoftheNorthAmericanChapteroftheAssociation 
forComputationalLinguistics:HumanLanguageTechnologies,NAACL-HLT2019,
Minneapolis,MN,USA,June2-7,2019,Volume1(LongandShortPapers) .Association 
forComputationalLinguistics,4171–4186. https://doi.org/10.48550/arXiv.1810.
04805
[4]DongdongDu,XingzhangRen,YupengWu,JienChen,WeiYe,JinanSun,Xiangyu 
Xi, Qing Gao, and Shikun Zhang. 2018. Reﬁning Traceability Links Between 
VulnerabilityandSoftwareComponentinaVulnerabilityKnowledgeGraph.In ICWE 2018, Cáceres, Spain, June 5-8, 2018, (Lecture Notes in Computer Science,
Vol.10845) . Springer, 33–49. https://doi.org/10.1007/978-3-319-91662-0_3 
[5]Jiahao Fan, Yi Li, Shaohua Wang, and Tien N. Nguyen. 2020. A C/C++ Code 
VulnerabilityDatasetwithCodeChangesandCVESummaries.In MSR’20:17th
International Conference on Mining Software Repositories,Seoul,RepublicofKorea,
29-30 June, 2020 (Seoul, Republic of Korea) (MSR ’20) . Association for Computing 
Machinery,NewYork,NY,USA,508–512. https://doi.org/10.1145/3379597.3387501
[6]JunGao,LiLi,PingfanKong,TegawendéF.Bissyandé,andJacquesKlein.2021.
UnderstandingtheEvolutionofAndroidAppVulnerabilities. IEEETransactions 
on Reliability 70,1(2021),212–230. https://doi.org/10.1109/TR.2019.2956690
[7]Zhiheng Huang, Wei Xu, and Kai Yu. 2015. Bidirectional LSTM-CRF Models 
for Sequence Tagging. CoRRabs/1508.01991 (2015). arXiv: 1508.01991 https:
//doi.org/10.48550/arXiv.1508.01991
[8]Yan Jia, Yulu Qi, Huaijun Shang, Rong Jiang, and Aiping Li. 2018. A Practical 
ApproachtoConstructingaKnowledgeGraphforCybersecurity. Engineering 4,1 
(2018),53–60. https://doi.org/10.1016/j.eng.2018.01.004
[9]Shengzhi Qin and K. P. Chow. 2019. Automatic Analysis and Reasoning Based 
on Vulnerability Knowledge Graph. In Cyberspace Data and Intelligence, and 
Cyber-Living,Syndrome,andHealth ,HuanshengNing(Ed.).SpringerSingapore,
Singapore, 3–19. https://doi.org/10.1007/978-981-15-1922-2_1
1735