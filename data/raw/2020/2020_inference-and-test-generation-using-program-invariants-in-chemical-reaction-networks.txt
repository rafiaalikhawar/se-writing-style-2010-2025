Inference and Test Generation Using Program Invariants in
Chemical Reaction Networks
Michael C. Gerten
Iowa State University
Ames, Iowa, USA
mcgerten@iastate.eduAlexis L. Marsh
Iowa State University
Ames, Iowa, USA
almarsh@iastate.eduJames I. Lathrop
Iowa State University
Ames, Iowa, USA
jil@iastate.edu
Myra B. Cohen
Iowa State University
Ames, Iowa, USA
mcohen@iastate.eduAndrew S. Miner
Iowa State University
Ames, Iowa, USA
asminer@iastate.eduTitus H. Klinge
Iowa State University
Ames, Iowa, USA
tklinge@iastate.edu
ABSTRACT
Chemical reaction networks (CRNs) are an emerging distributed
computationalparadigmwhereprogramsareencodedasasetofab-
stract chemical reactions. CRNs can be compiled into DNA strands
which perform the computations in vitro, creating a foundation for
intelligent nanodevices. Recent research proposed a software test-
ingframeworkforstochasticCRNprogramsinsimulation,however,
it relieson existingprogramspecifications.In practice, specifica-
tions are often lacking and when they do exist, transforming them
intotestcasesistime-intensiveandcanbeerrorprone.Inthiswork,
weproposeaninferencetechniquecalledChemFlowwhichextracts
3typesofinvariantsfromanexistingCRNmodel.Theextracted
invariants can then be used for test generation or model validation
against program implementations. We applied ChemFlow to 13
CRNprogramsrangingfromtoyexamplestorealbiologicalmodels
with hundreds of reactions. We find that the invariants provide
strongfaultdetectionandoftenexhibitlessflakinessthanspecifica-
tionderivedtests.Inthebiologicalmodelsweshowedinvariantsto
developers and they confirmed that some of these point to parts of
the model that are biologically incorrect or incomplete suggesting
we may be able to use ChemFlow to improve model quality.
CCS CONCEPTS
â€¢Software and its engineering â†’Software testing and de-
bugging.
KEYWORDS
chemical reaction networks, test generation, invariants, Petri nets
ACM Reference Format:
Michael C. Gerten, Alexis L. Marsh, James I. Lathrop, Myra B. Cohen,
Andrew S. Miner, and Titus H. Klinge. 2022. Inference and Test Gener-
ation Using Program Invariants in Chemical Reaction Networks. In 44th
International Conference on Software Engineering (ICSE â€™22), May 21â€“29,
2022, Pittsburgh, PA, USA. ACM, New York, NY, USA, 13 pages. https:
//doi.org/10.1145/3510003.3510176
This work is licensed under a Creative Commons Attribution-NoDerivs International 
4.0 License.
ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Â© 2022 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-9221-1/22/05.
https://doi.org/10.1145/3510003.35101761 INTRODUCTION
Manynon-traditionalprogrammingparadigmshaverecentlyemerged,
including techniques to leverage physical processes to embed com-
putationsinnanodevices(called molecular programming )[13,45,
49,53]. Chemical reaction networks (CRNs) are one such paradigm
where programs are encoded as a set of abstract chemical reac-
tions[9,10,15,54].CRNsareofspecialinterestbecausetheycan
be compiled into a program using DNA strands and then executed
in vitro [4,51]. As a result, CRNs help catalyze the development
of intelligent nanodevices; devices that could be leveraged for pur-
poses such as intelligent drug delivery [1, 17, 26].
SinceCRNsformthefoundationoflivingorganisms,theseare
alsoofinteresttobiochemistsandsyntheticbiologists(engineers
of new biological functions), who build models to describe the
physical program implementations (bothsynthesizedandnatural).
Therearenownumerousrepositoriesofreusablebiologicalparts
availableonline,manyofwhichcanberepresentedasCRNs[ 8,45].
Some of these repositories have even been likened to the Github
for synthetic biology [ 8,11,23]. Several recent advances include
higherlevelprogramminglanguagesthatcompileintoCRNs[ 48,
54]. Recently CRNs have even been formulated to represent neural
networksandthesehavebeenshowntobeeffectiveandefficient
atcommonclassificationtasks[ 49,53]suggestingapotentialfor
nanolearning.Ifweexaminerecentpublicationspromotingnovel
uses/programmingapproachesforCRNswefindthatasmanyas
halfofthepapersintherecent(2020/21)DNAconferences[ 24]ar e
onthistopic.AndifweexaminetheACMdigitallibrarywefind
recentpaperscrossingdomainssuchassoftwareengineering(in
venues such as TOSEM, TSE, ICSE, ASE, RE) and computational
biology, networking and chemistry domains.
WhilethescienceofprogrammingCRNsisexploding,validating
theircorrectnesslags.MuchofthestateoftheartinvalidatingCRNs
usesmodel checkingor otherformal approachessuch astheorem
proving [ 18,33,36]. However, scalability of model checking is
often an issue, in particular in CRNs that have faults [ 20,32,36].
Usershaveinsteadstartedtoaskabouttestingonforumssuchas
MATLAB help forum [39].
The CRN community uses two primary semantics for CRNs
(which differ in how the CRNs are simulated/evaluated). In this
work we focus on one type, stochastic CRNs. In recent work we
proposed an automated software testing framework for stochastic
CRNs, ChemTest [20].However, ChemTest relies onthe existence
11932022 IEEE/ACM 44th International Conference on Software Engineering (ICSE)
ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Gerten, Marsh et al.
of program specifications. These specifications define both the
program inputs and the oracles using a temporal logic.
As we demonstrate in our motivating examples, writing manual
specifications for stochastic CRNs is time consuming and poten-
tiallyerrorprone.Andasintraditionalsoftware,CRNsmayhave
ambiguousspecifications,maybeautogenerated,ormaycomewith-
outanyspecifications(suchasbiologicalorganisms).Allofthese
issues suggest the need for automated inference and generation
techniques.SinceCRNsareknowntobeequivalenttoacommon
structure in distributed software testing, Petri nets [ 9], and there is
alargebodyof literatureonwaystoanalyze thesenetworks[ 41],
weaskifwecanleveragethatresearchtoanalyzeCRNsandextract
(invariant)propertiesoftheCRNs.IfwecaninferaCRNsbehavior
sufficiently, we have a powerful technique that can be used for test
generation, and to validate known models.
In this paper, we explore this idea. We have created a technique
called ChemFlow .ChemFlowextractslinearinvariantsfromstochas-
tic CRNs using a form of Gaussian elimination. It creates different
typesofinvariants,somewhichcanbeeasilyincorporatedintoa
testing framework. Others require more complex harnessing (reac-
tioncounting).Weimplementedandevaluatedbothinthiswork.
ChemFlow is significant forthe software engineering community;
aswemovetothenewnanocomputationalworld(asisalreadyhap-
pening)weneedtoprovidestrongsoftwareengineeringpractices
that can guide and ensure program correctness.
We evaluate ChemFlow by first comparing tests created from its
invariantsagainstmanuallygeneratedtestcasesforawiderangeof
CRNprogramswhichhave specifications.Wefindthatthe invari-
antshavegoodfaultdetectionandthattheytendtobelessflaky.
Wealsoseethataddingreactioncountingincreasesthequalityof
theinvariants.Wethenevaluatetheuseofinvariantdetectionin
four subjects which lack manual specifications. Two of these are
based on metabolic models of a living organism Escherichia coli .
We presented the biological invariants to developers (bioinformati-
cists) who work with these types of models and write programs
toanalyzethem.Theypointedoutthatsomeinvariantsrepresent
potential inconsistencies between the model and known behavior.
The contributions of this work are:
(1)A linear invariant inference technique for chemical reaction
networks, called ChemFlow;
(2)Alargestudyshowinginvariantsprovidegoodfaultdetec-
tionandcanindicatepotentialproblemswithmodelquality;
(3)An analysis of some tradeoffs between different types of
invariants and manual specifications.
Inthenextsectionwepresentsomemotivatingexamplesand
background. We follow this with a presentation of our invariant
test generation technique (Section 3). We then present our study in
Sections 4 and 5, followed by discussion. We present related work
in Section 6. Finally, we conclude and present future work.
2 MOTIVATION AND BACKGROUND
We begin with some motivating examples to demonstrate the need
for automated invariant inference in CRNs. We then present some
background on CRNs and the state of the art in CRN testing.2.1 Three Motivating Examples
ScenarioOne:UnclearSpecifications Webeginwithoneofour
subject programs obtained from a tutorial on building CRNs [ 9]
for which we needed to write test cases. The author of this tutorial
presents a CRN that satisfies the specification Suppose we are given
a state with an unknown number of molecules of species X and Y and
we want to decide whether or not #X is equal to #Y modulo 3 .They
then present a program with five reactions (see background below
forspecificsofCRNprogramnotationetc.).Ourinterpretationof
this specification is that the program accepts two inputs (X and
Y) and performs modulo 3 arithmetic. It then returns a Boolean
result (0 or 1) stating if these are equal. We quickly realized the
specificationwasunclear.Weinitiallyassume da0or1r eturnvalue,
but of course, this may also be 0 or any strictly positive value (if
true).Thespecificationfailstostatewhichwaytheprogramworks.
In our initial (incorrect) test cases we checked for a return value of
1astrue.Manytestsfailedandittookhoursandmanyiterations
to determine the exact specifications for this simple, correct CRN.
Scenario Two: Autogenerated Code. Anotherof ourstudy sub-
jects(Hailstone4),isanauto-generatedCRNcreatedbyacompiler
using a high level domain specific language. This function (Hail-
stone) is a well known function. However, the particular formu-
lation of the program has 91 reactions and 50 species. Although
we know the general functional properties of Hailstone, we do not
knowtheexactvaluesofthevariousinput/outputsandwecould
not extract complete specifications manually for this program.
Scenario Three: Model Quality for Existing Programs. The
lastexampleisforevaluatingconformanceofamodelanditsim-
plementation.Weagainlookatoneofourstudysubjects,aCRN
extracted from the metabolic model of a living organism. The CRN
isamodel,nottheactualprogramimplementation.Whileouror-
ganismiswellstudied,therearenoexactspecificationsforaliving
organism. These are learned over time using years of collective
experimentation. In addition, the organisms evolve. We, therefore,
want to extract specifications from the existing model and com-
pare with the organismâ€™s known behaviors. The biological CRN
has almost 500 reactions and as many species.
2.2 Chemical Reaction Network Programs
Chemical reaction networks (CRNs) and its many variants are
widelyusedtomodeltheinteractionsofmolecules[ 15,19].Here,
weusethestochasticmass-actionvariantwhichmodelsthestate
ofthenetworkwithintegralcountofmoleculesratherthanreal-
valuedconcentrations.CRNsarenowcommonlyusedtodevelop
chemical algorithms by carefully specifying the interactions be-
tween abstract molecules. Recently, researchers have developed
methodsto synthesizeabstract chemicalnetworks intostrandsof
DNA molecules [4, 13, 51].
Roughly, the stochastic model of a CRN is defined as a pair
N=(S,R)where Sis a finite set of species (abstract molecule
types)and Risafinitesetof reactions thatoperateoverthespecies.
Areactioniscomposedofreactantsandproducts,whicharevectors
of species, and are often denoted using the format
A+B2.43âˆ’âˆ’âˆ’â†’C+D.
1194Program Invariants in Chemical Reaction Networks ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
The reaction above depicts the interaction of two molecules, Aand
B,thatcometogetherinsolution,interact,andproducemolecules C
andD. The rate of the reaction is proportional to the rate constant
2.43andtheproductofthenumberof AandBmoleculesinsolution.
Inthestochasticmodel,thisoverallratedeterminesaprobability
that the reaction will occur and how long it will remain in the new
state(sojourntime).Thus,ifthenumberof Amoleculesis10and
thenumbersof Bmoleculesis2,thenthepropensityofthisreaction
firingataspecifictimeisdeterminedbythequantity10 Â·2Â·2.43/V
where Vis the volume of the solution. The probability that the
reaction fires is determined by its propensity and the propensity of
all the other reactions in the system. When the volume is constant
we can write the above reaction as A+Bâˆ’âˆ’âˆ’â†’C+D.
We give an example CRN to illustrate the semantics of a sto-
chastic CRN. Consider the CRN N=(S,R)with species S=
{X,Y,PE,PO}andRconsisting of the following four reactions.
Xâˆ’âˆ’âˆ’â†’PO+Y (R1)
PO+POâˆ’âˆ’âˆ’â†’PE (R2)
PE+POâˆ’âˆ’âˆ’â†’PO (R3)
PE+PEâˆ’âˆ’âˆ’â†’PE (R4)
ThisCRNcomputes parity,i.e.,whetherthenumberofinputmolecules
Xis even or odd. The output is a single molecule: PO(odd number
inX)orPE(evennumberin X),andpreservestheinitialnumber
ofXin the species Y. To see how this works, we initialize Xto 5
andPE,PO, and Yto zero, noting that the number of molecules
inXis an odd number. At the end of the computation, the species
PEshould be 0 and POshould contain a single molecule that indi-
cates the initial input in Xwas odd. We can examine the behavior
more clearly by looking at a traceof the CRN over time. Table 1
showsthetraceandenumeratesthemoleculecountsoftheCRN
after each reaction occurs. It represents only one of many different
orderingsthereactionsmayoccur.Notethatifnotallordersleadto
the correct results, the failure is probabilistic, which leads to flaky
CRNs and flaky CRN testing. Flaky tests can also occur when they
are evaluated before the CRN stabilizes.
Table 1: Example of a CRN execution
Time Reaction XP OP EY
0 Initial Values 50 0 0
0.0410 Xâˆ’ â†’PO+Y41 0 1
0.1556 Xâˆ’ â†’PO+Y32 0 2
0.1773 PO+POâˆ’ â†’PE30 1 2
0.3567 Xâˆ’ â†’PO+Y21 1 3
0.7181 Xâˆ’ â†’PO+Y12 1 4
0.7622 PO+POâˆ’ â†’PE10 2 4
0.7828 PE+PEâˆ’ â†’PE10 1 4
1.5815 Xâˆ’ â†’PO+Y01 1 5
1.9690 PE+POâˆ’ â†’PO01 0 5
10 End of simulation 01 0 5
As we see in Table 1, at time 0 .0410 reaction (R1)fires, which
converts a molecule of Xinto a molecule of PO. Since there is only
a single POmolecule present, no other reactions can fire, and so
reaction(R1)must fire again. This occurs at time 0 .1156 where
another Xis converted and we now have two POmolecules. Atthis point, both reactions (R1)and(R2)are enabled, and one is
chosenprobabilisticallyproportionaltothereactionâ€™spropensity.
On our example, reaction (R2)is chosen at time 0 .1773. As more
reactions are enabled, the state of the molecules changes according
to the rules of the reactions that fire, eventually leaving a single
molecule of PEorPO. In this state, no reaction can fire and the
system remains stable.
2.3 Testing CRNs
In prior work we proposed a stochastic CRN testing framework,
ChemTest , which uses a multi-step process[ 20]. In that work we
comparedscalabilitywithmodelcheckinganddemonstratedthe
needforanalternativeapproachtoCRNverification.Wesummarize
ChemTesthere.First,testsareformulatedfromspecifications(as
statedinourfirstmotivatingexample)usingalineartemporallogic
(LTL).Boththeprograminputsandthepropertieswhichmusthold
(the oracles) are defined by the LTL. These become abstract test
cases.Fourtypesoftestcasesaredesigned.Functionaltestcases,are
properties on the program output. Equation (1)shows a functional
abstract test for subtraction from the ChemTest artifact website.
Itissubtracting X2fr om X1andtheresultgoesintospecies Y.Y
can never be negative, hence any negative values become 0. The
propertystatesif X2isgreaterthan X1then future globally Y(at
evaluation time t) will be equal to zero.
Metamorphic tests are also used. These are compared against
two program executions. Equation (2)states if X1/prime(the second
execution)isgreaterthan X1and X2isheldconstant,then future
globallyat evaluation time t,Y/primeis greater than Y.
[X2[0]>X1[0]] â†’ FG[Y[t]=0] (1)
[X1/prime[0]>X1[0]] â†’ FG[Y/prime[t]>Y[t]] (2)
Two other tests types are defined. Internal tests can be either
functionalormetamorphic,buttestpropertiesofaninternalspecies
ratherthanaprogramoutput.Hypertestsaresetsoftestcasesacross
whichapropertyholds.Theyareusedforprobabilisticprograms
whicharenotguaranteedtogivethesameanswereachrun.Wedo
not use either of these test types in this paper.
As can be seen by the examples writing LTL test cases may
be cumbersome and can require significant manual effort. It also
requires a full set of program specifications.
Onceabstracttestsarecreated,ChemTestusescategorypartition
to define sets of inputs which generate concrete test cases . The test
specificationlanguage(TSL)[ 44]isastandardwaytoimplement
the category partition method on a program input space. TSL first
partitionsaprogrambyitsparametersandforeachparameteritde-
fines choicesorequivalenceclassesofvalues.Thesetofparameters
and choices for the program becomes the TSL model. In stochastic
CRNsspeciesareparametersandchoicesarethespeciesconcentra-
tion equivalence classes (e.g. we might use odd number of species,
zero species, large number of species). Constraints between inputs
can also be specified using temporal logic to help restrict invalid
test inputs (some of the specifications require that X1>X2 for in-
stance).Usingtheconcretetests,ChemTestthenrunsthetestcases
on a CRN simulator (in the MATLAB Simbiology package [ 52]).
The properties of each test run are checked for correctness at a
1195ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Gerten, Marsh et al.


"
"
! 
# 

$
	 		
 

 

 	




Figure 1:ChemFlow Overview. In #1it pre-processes thedata, performs Gaussianelimination and flow analysis.Once invari-
ants are extracted they can be used either for (#2) Model comparison and quality and/or (#3) Test Generation and Testing.
specifiedtimeduringsimulation.Becausetestscanbeflaky,each
simulation is run a number of times.
3 CHEMFLOW
We now present ChemFlow. Figure 1 shows an overview of Chem-
Flow. We begin with a stochastic CRN. We then pre-process and
use our tool we call chem_flows (Step #1) to extract invariants.
Theinvariants canbeofthree types.Thesecan thenbecompared
against an implementation for model quality (#2) or they can be
automaticallytranslated(#3)intoabstracttestcases.Theabstract
testcasesarethenconcretizedandusedfortesting(#4)byassigning
sets of inputs (and associated oracles) using category partition. We
discussthekeyaspectsofinvariantextractionnext,followedbyan
example of test generation.
3.1 Invariant Extraction
Chemical reaction networks are known to be equivalent to Petri
nets [9]; in fact, Petri nets were originally conceived to describe
chemical processes [ 47], where molecules, species and reactions
in CRNs become tokens, places and transitions in Petri nets. Thus,
CRNsinheritmostofthetheoreticalresultsoriginallyderivedfor
Petri nets [ 41] and Vector Addition Systems [ 29]. In particular, we
utilize the well-known Petri net concept of linear invariants, or
â€œPâ€“flowsâ€[ 50].EachPâ€“flowisaweightedsumofnumbersoftokens
in places, that is guaranteed to remain constant. For example, in
theCRN specifiedbyreactions (R1)â€“(R4),we seethatthe number
ofXmoleculesplusthenumberof Ymoleculesisaconstantthat
depends on the initial value of X. In the trace shown in Table 1, we
seethat X+Y=5holdsatalltimesduringtheCRNexecutionand
that 1Â·X+1Â·Yis a Pâ€“flow.
We can also derive relationships from inequalities . For example,
POâˆ’Y+2Â·PEâ‰¤0 is an invariant of the CRN. Moreover, we
can utilize relationships found in the CRN by counting the number
of times a reaction fires in the CRN. This information gives us
additionalequalityinvariants.Forexample,intheaboveexample
R1+Y=5 says that the number of times R1 has fired plus the
number of Ymolecules is 5 at any time during the execution of
the CRN. A more interesting invariant for this system is 2 Â·R2+
POâˆ’Y=0, which is also true for all time the CRN is executing.
Thisinequalitycanonlybeevaluatedwithspecialcountingharness
which evaluates how often a reaction has occurred.We now give a more detailed description of how these relation-
ships are derived. We start with an equation for the number of
molecules for each species, as the initial number of molecules mod-
ified by the number of firings of each reaction multiplied by the
netchangeforthatspecieswhenthatreactionfires.ForourCRN
shown above, we would obtain the linear equations:
X=Xinitialâˆ’R1
Y=Yinitial+R1
PO=POinitial+R1âˆ’2Â·R2
PE=PEinitial+R2âˆ’R3âˆ’R4.
Theseholdforanynon-negativenumberoffiringsforeachreaction,
i.e.,foralltimeaftertheinitialconfiguration.Next,werearrange
eachequation,keepingtheinitialvaluesontherighthandside,and
moving everything else to the left hand side. We now obtain
X+R1=Xinitial
Yâˆ’R1=Yinitial
POâˆ’R1+2Â·R2=POinitial
PEâˆ’R2+R3+R4=PEinitial
Wecanthenuseaseriesofelementaryoperations,namelymultiply-
ingequationsonbothsidesbyaconstantoraddingoneequationto
another,with the goalofeliminatingthereactioncountingterms.
For our example, adding the first equation to the second eliminates
R1, giving us
X+Y=Xinitial+Yinitial
This is the linear invariant discussed above, X+Y=5, for the
inputs Xinitial=5 and Yinitial=0. Similarly,subtracting the second
equation from the third gives the linear invariant
POâˆ’Y+2Â·R2=POinitialâˆ’Yinitial
An important observation is now in order. For any linear invariant
obtained fromthese equations,its right-handside, whichis acon-
stant,canbeobtainedfromitsleft-handside,bysubstitutingthe
initialcountforeachspeciesandzeroforeachreactioncount.To
seethatthispropertyistrue,notethatitholdsinthestartingequa-
tions, and remains true after performing any elementary operation.
It therefore suffices to manipulate the left sides of the equations
only, keeping in mind that the right side is always a constant that
can be recovered from the initial configuration.
1196Program Invariants in Chemical Reaction Networks ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Based on the above discussion, we implemented a standalone
tool, chem_flows , that reads a CRN model, and derives its linear
invariants. Prior to its use, we pre-process the CRNs to a standard
format and eliminate any non-integer coefficients using a multi-
plicative factor. We also split bi-directional reactions. chem_flows
first indexes the CRN species and reactions, and then builds the
stoichiometrymatrix MoftheCRN[ 9],knownalsoastheincidence
matrixinPetrinetliterature[ 50].Thismatrixhasarowforeach
speciesand acolumn foreach reaction,and element M[s,r]is the
net change in species swhen reaction roccurs. The left side of the
initial set of equations is given by the matrix Maugmented with
âˆ’I,denotedas [M:âˆ’I],where Iistheidentitymatrixofdimension
number of species. The augmented matrix is then reduced using
Gaussian elimination with integer arithmetic. After reduction, the
rows contain the linear invariants, each true at all times and for
any sequence of reactions that may occur.
Our chem_flows tool then classifies each linear invariant into
one ofthree categories. Thefirst category,labeled Flows, contains
relationships between species only, without reaction counts. These
are obtained from rows whose reaction count coefficients are all
zero.Thesecondcategory,labeled Inequalities ,areusedtoderive
the inequalities used in this study, but may also be used in test
harnessesthatutilizereactioncounting.Theseareobtainedfrom
rowscontainingatleastonenon-zeroreactioncountcoefficient,and
whose reaction count coefficients all have the same sign. The third
category,labeled Irreducible ,requiresreactioncountingtoevaluate.
Theseareobtainedfromrowscontainingreactioncountcoefficients
ofdifferentsigns,whichpreventderivationofaninequalityinterms
of species counts.
3.2 Test Generation
We now summarize the procedure for generating test cases, using
aCRNprogramfromourstudy:Hailstone(H1).Steponecreates
invariants using the chem_flows tool. The Hailstone input file for
thechem_flows program and its output is shown below:
X 1- >P O+H+M ;
P O+P O- >P E ;
P E+P O- >P O ;
P E+P E- >P E ;
H+H- >D ;
M- >3 B+6 A ;
2 B+2 A- > ;
P E+D- >P E+C E+Y ;
P O+A- >P O+C O+Y ;
C E+P O+Y- >P O+D ;
C O+P E+Y- >P E+A ;
Flows (== constant):
+ 3X 1+ 3M- 1B+ 1A+ 1C O
+ 3H- 3M+ 6D+ 1B- 1A+ 6Y- 7C O
+1 CE -1 Y +1 CO
Inequalities (remove reactions, <= constant):
+3 (reaction 1) -3 M +1 B -1 A -1 CO
+6 (reaction 2) +3 PO -3 M +1 B -1 A -1 CO
+6 (reaction 3) +6 (reaction 4) +3 PO -3 M +6 PE +1 B -1 A -1 CO
+1 (reaction 5) -1 D -1 Y +1 CO
+3 (reaction 6) +1 B -1 A -1 CO
+2 (reaction 7) +2 B -1 A -1 CO
Irreducible:
+1 (reaction 8) -1 (reaction 10) -1 Y +1 CO
+1 (reaction 9) -1 (reaction 11) -1 COTheoutputfromthe chem_flows programisusedtogeneratean
abstracttest(inputsandanoracle)andsubsequentconcretetests.
We begin by describing how we transform an expression in the
Flowssection of the output into an LTL formula.
Each expression in the flows section is transformed by setting it
equalto someconstant ( G[expression =consant])which mustbe
trueatallevaluationtimesofthesimulation t>=0.Forexample,
in the output shown above, the first flow, +3 X1 +3 M -1 B +1 A
+1 CO, transforms to the to LTL formula
+3X1+3Mâˆ’1B+1A+1CO=constant
To generate a concrete test we need values for the species in the
formula.FortheinputspeciesweuseaTSLmodel.Oncetheinitial
values are generated, the concrete test is created by setting each of
the species involved in the abstract test to its initial value. We then
evaluatetheexpressiontocalculatetheconstant.Thisconstantis
placed within the LTL global operator G, and forms a concrete test.
Inthecase whenthespeciesarenotinput species,wesetthemto
zero.Intheaboveexample,thefunctionhasonlyoneinputspecies
X1.TheTSLfollowsChemTestwhichhascategoriesfor X1such
aseven,odd,zeroormaximumandanenvironmentwhichcontrols
themaximumvalues(toensurewehavecombinationswhichare
small, medium and large). All the other species are set to 0. If X1i s
set to 50, then the the concrete test
+3X1+3Mâˆ’1B+1A+1CO=150
isusedtotesttheoutputtraceoftheCRN.ManyofourCRNshave
multiple input species.
Eachexpressioninthe Inequalities sectioncanbetransformed
intoanabstracttestandconcretetestusinganearlyidenticalproce-
dure. For these expressions, any terms in the expression that refers
to a reaction firing is ignored and the same procedure for flows
is performed. However, the invariant is no longer an equality, but
ratheralessthaninequality.Theconstantisagainfoundbysetting
the species involved to their initial values and using equality to
determine the constant. For example, the first expression in the
inequalities section becomes
âˆ’3Â·M+Bâˆ’Aâˆ’COâ‰¤0.(initial values of M,B,A,CO=0)
The Irreducible section has expressions that contain reaction fir-
ing but cannot be used as an inequality. As such, reaction counting
must be used to utilize these expressions. The Inequalities section
also contains expressions with reaction firing, hence both sections
canbeusedwithreactioncountingforcreatingabstractandcon-
cretetests.Sincereactioncountingexpressionsareequalities,the
invarianttheyrepresentaretreatedthesameasintheFlowssection.
Howeverabstracttestsfromtheseexpressionsmustutilizereaction
counting to evaluate the property of the CRN.
3.3 Implementation
We first run the CRN models through a script that scales any reac-
tions to eliminatenon-integer coefficients. This model is thenfed
intothe chem_flows tool,which extractsand classifiestheinvari-
ants.AMATLABscriptthenprocessesandtranslateseachinvariant
into a set of abstract test cases, based on the invariant type. The
concrete inputs are generated from a TSL program. Since the in-
variantabstracttestshavenoconstraintsontheinputvalueswe
1197ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Gerten, Marsh et al.
endupwithasetoftestscontainingtheCartesianproductofthe
TSL categories for all input species.
WeusetheChemTestframeworkusingMATLABSimBiology[ 52]
to run tests. It accepts the CRN, the set of concrete inputs and the
abstract test cases. Itthen executes the test cases, and processthe
traces to extract passing or failing test cases.
4 EVALUATION
We evaluate the quality of ChemFlow by asking three research
questions. Artifacts for this study are available online:1
RQ1:HoweffectivearetheflowinvariantscreatedbyChem-
Flow?Weanswerthisquestionusingfaultdetectioncomparedwith
specification based test suites.
RQ2:Whatistheimpactoneffectivenessandefficiencywhen
weaddinequalityandirreducibleinvariants? Weevaluatethe
change in fault detection and the time to execute.
RQ3: Does ChemFlow provide useful information when we
lackspecifications? Weexamineif theinvariantscanfind faults
in the mutants and if they indicate potential model quality issues.
4.1 Study Subjects
Wegatheredasetof13benchmarkCRNprogramsfrom(a)prior
workonCRNtesting,(b)theliterature,(c)aCRNsimulationtool,
and (d) a metabolic model from an online database. They range in
size and complexity from a single reaction to almost 500 reactions.
AlloftheCRNscanbefoundonoursupplementarydatawebsite.
For 9 ofof these CRNs,weeither have existing manualtest suites
from ChemTest, or we followed Gerten et al.â€™s [ 20] approach to
buildourowntestsuitesbasedonspecifications.Weexaminethe
other four CRNs in a regression environment, where no manual
tests are available. Table 2 summarizes the characteristics of the
CRNsorderedbythenumberofspecies,followedbythenumber
ofreactions.ThefirstcolumngivestheCRNnameanditsacronym
used throughout the rest of this paper. The second column refer-
ences the source of the CRN and is followed by the number of
species(#Species)andreactions(#React).Thenexttwocolumns
arethenumberofspecificationsforabstracttestcases(#ATests)
andthenumberconcretetests(#CTests).Adashindicatesalack
of specifications for this subject. The next column (# Mutants) lists
the number of mutant programs we used for testing (see below for
detailsonmutants).Thelastcolumn(#Unstable)indicates(with
an x) which programs are considered unstable, meaning they do
not have a single terminating state and are therefore likely to be
eitherprobabilisticorflakyonthecorrectCRNs.Wesummarizeour
programsnext.Thefirstfoursubjectswereeitherobtaineddirectly
from the ChemTest artifacts [20] or are derivatives of them.
(1)Subtraction(S) .ThisCRNcomputesthevalue X1âˆ’X2and
places the result in species Y.
(2)Hailstone One (H1) . The Hailstone function [ 34] has a
single input species X1 and outputs a species Ythat is X1/2
ifX1 is even, and 3 Â·X1+1i fX1 is odd. It is composed of
four separate units that compute (1) if X1 is even or odd, (2)
adividerthatcomputes X1/2,(3)amultiplierthatcomputes
3Â·X1+1,and(4)amultiplexerthatselectsbetweentheoutput
of two components based on the results of the multiplier.
1Artifact Website:https://doi.org/10.5281/zenodo.5915597(3)HailstoneTwo(H2) .ThisCRN issimilartoHailstone One
exceptitdiffersinthecomputationof3 Â·X1+1,requiring
two more reactions.
(4)Approximate Majority (AM) . Using four reactions, this
CRNprobabilisticallydetermineswhetherinputs X1orX2
hasaninitialmajority.If X1>X2,thenwithhighprobability
theexecutionwillterminatewith X1+X2moleculesresiding
inX1 and none in X2. Similarly, if X2>X1, then with high
probability allof themolecules residein X2 at termination.
Theprobabilityofcorrectoutputisa functionoftheinitial
difference between X1 and X2.
The next set of subjects comes from a tutorial on CRNs [9].
(5)Min.ThisCRNcomputestheminimumoftwoinputspecies
XandYand places the result in species Z.
(6)Max.ThisCRNcomputesthatmaximumoftwoinputspecies
XandYand places the result in species Z.
(7)XYMod3 (Mod) . This CRN determines if two input species
XandYare congruent modulo 3. If Xâ‰¡Ymod3, then
the output species Vcontains at least one molecule, and
otherwise it contains no molecules.
OurnextsubjectwastakenfromChenetal.[ 12]whichcontainsa
seriesofCRNsthattheauthorsdesignedforoptimalparallelization.
(8)AtLeastOne(AL1) . This program determines if there is at
leastonemoleculeofspecies A1andatleastonemoleculeof
A2 and if true, the output Ycontains at least one molecule.
Our next subject is a safety critical mechanism designed for use
in nanodevices, (a heartbeat detector). It has probabilistic model
checking results which verify its correctness on up to 5 molecules.
(9)MolecularWatchdogTimer(MWT) .Thisprogramdeter-
minesifaheartbeatmolecule Hisdetectedwithinaspecified
time interval (specified when designing the system). We fol-
lowed Gerten et al. techniques to generate LTL properties
from the original goal diagrams [ 18]. We then did a parame-
ter search to find inputs for the concrete tests.
The next two programs lack specifications.
(10)Hailstone Four (H4) . This subject was written by some
oftheco-authorsforadifferentprojectinahigh-level,do-
main specific language and automatically compiled into the
concrete CRNconsisting of 50 speciesand 91 reactions[35].
Mapping the inputs and outputs from another variant of
Hailstone is non-trivial.
(11)Predator Prey Model (PP) .Thisisapredatorpreymodel
takenfromtheonlineGECCRNsimulator[ 45]whichgen-
erates CRNs that are compilable into physical systems. It
follows a common predator prey model, but given the varia-
tioninhowthiscanbeimplementedthelackofspecifications
means it is difficult to develop a sufficient set of tests.
The last two CRNs are derived from metabolic networks of well-
studiedlivingorganisms.Cellularmetabolismcanbeviewedasa
distributednetworkofchemicalreactions[ 22].Forthisstudywe
usedtheDepartmentofEnergySystemsBiologyKnowledgebase
(KBase) [3, 30], an open science platform for biologists.
(12) Escherichia coli (EC).
(13) Escherichia coli Glucose Pathway (ECG) .
1198Program Invariants in Chemical Reaction Networks ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Table2:StudySubjects.Weshowthesubjectname(andacronym),itssource,thenumberofspecies(#Species),thenumberof
reactions # React, followed by the number of manually created abstract (ATests) and concrete (CTests) tests. Last we provide
the number of mutant programs and indicate if the program is unstable. Starred subjects are used in Figure 3.
Name(abbrev) Source # Species # React # ATests # CTests # Mutants Unstable
Min* Brijder[9] 3 1 12 430 23
Subtraction (S)* Gerten et al.[20] 3 2 9 354 32
Approximate Majority (AM)* Gerten et al.[20] 3 4 3 279 29 x
XYMod3 (Mod)* Brijder [9] 3 5 5 74 24
Max* Brijder [9] 5 3 10 160 24
At Least One var d. (AL1)* Chen et al.[12] 7 5 14 262 22 x
Hailstone One (H1)* Gerten et al.[20] 11 11 13 70 34
Hailstone Two (H2) Variant of Gerten et al. [20] 12 13 8 22 25
Molecular Watchdog Timer (MWT)* TOSEM[18] 16 22 9 27 22 x
Predator Prey (PP) GEC[45] 27 47 â€” â€” 23 x
E. coli Glucose Pathway (ECG) KBase [30] 23 12 â€” â€” 25 x
Hailstone Four (H4) paper authors [35] 50 91 â€” â€” 25 x
E. coli(EC) KBase [30] 496 484 â€” â€” 25 x
For the EC subject, we built a genome scale metabolic model
ofEscherichia coli str.K-12substr.MG1655onCarbon-D-Glucose
usingtheKBase[ 3]BuildMetabolicModelapp(Version:2.0.0).The
genome was retrieved through KBase [ 3] from National Center
for Biotechnology Information (NCBI) RefSeq Genomes [ 43]. Since
genome annotations are incomplete, the metabolic models built
fromthemhavemissingreactionswhichmakethemodelunable
to produce biomass (grow) using typical media. Gap-filling adds
theminimalsetofreactionsrequiredfortheorganismtoproduce
biomass on the selected media. We used the KBase [ 30]â€™s Gapfill
Metabolic Model (Version: 2.0.0) on Carbon-D-Glucose.
TheECGsubjectwasderivedfromKBasemodelof E. coliglycol-
ysispathway.Weextractedjusttheglycolysispathwayfromthe
E. colimodel. These was done by hand by one of the authors (with
biological knowledge) from the complete metabolic network based
on its KEGG map [28].
Onceweextractthesetsofinvariantsforthe E. coliCRNs,we
needvalidinputspeciesvaluessothesimulationisnotstatic(i.e.
the organism simulates growth). We did not attempt to add in full
kinetics, which means that the growth results may not be realistic,
however,wedidensurethattheCRNwasdynamicandcompounds
were being consumed throughout the simulation.
4.2 Mutations
The three subjects from ChemTest [ 20] include a set of mutant
representingfaultyCRNs.SincethereisnodatabaseoffaultyCRNs
wefollowtheirmethodtocreatemutantprogramsfortheothers.In
other experimental settings for testing, mutants have been shown
to be representative of real faults [ 2,42]. Mutants are created by
randomlyaddingorremovingareactant,productorreaction.Dele-
tionsareselected10%ofthetime,whilechangesandadditionseach
haveaprobabilityof45%.Speciesandreactionsareselectedwith
equalprobability.IntheChemTestsubjectstherewereatmost10
mutants. We added up to 25 more in each of those subjects and up
to25inthenewsubjects.Mutantswhichranoutofmemoryduring
our experiments (more than 32 GB) were removed.
4.3 Method
For each CRN we extract the invariants and split these into the
flows,inequalitiesandirreducibles.Forreactioncountingweaddin-
strumentation to capture reaction counts during execution. For theinvarianttests,theinvariantsproducedbyrunningthe chem_flows
programaretransformedintooraclesthatcontaintheabstracttests
asdescribedearlier.Forthespecificationtests,theabstracttestsare
obtained either from existing tests (i.e. ChemTest) or hand written
using expected program behavior.
For the abstract tests we use a TSL to generate concrete inputs.
For specification tests we often have constraints between inputs
(e.g.inputonehastobegreaterthaninputtwo).Forinvariantbased
tests, we used the same set of TSL but remove constraints. We run
each concrete test 100 times using the Simbiology simulator in
MATLAB [ 52]. We run the original CRNs (without faults) for each
subject as a baseline to confirm that the test cases are valid. For all
test types, we then evaluate each of the mutant programs. We run
all experiments on a server, using a homogeneous set of Intel(R)
Xeon(R) Gold 6244 CPUs @ 3.60GHz with 32 gb of RAM. The E.
colimodel required additional resources, with 64 GB of RAM for
the larger model. We used MATLAB R2021a-io4754x running on
RedHat Enterprise Linux 7.
4.4 Independent Variables
Wehavetwoindependentvariables:thetypeofinvariant(ortest
suite), and the testing technique. Flows are the basic invariants
whichrepresentequalities.WeusetheseinRQ1asabaseevaluation,
sincetheydonotneedanyspecialinstrumentationortranslation.
ForRQ2 weexamineifadditionaltypes ofinvariants(inequalities
andirreducibles)impactfaultdetectionandefficiency.Forthein-
equalities we can evaluate these both with and without our second
variable (reaction counting). For the irreducibles, we can only eval-
uate these using reaction counting. The instrumentation in our
testharnessworksby addinganewspeciesforeachreactionand
countingthenumberoftimesthisisfired.Thelasttypeoftestsuite
we use are the specification tests suites.
4.5 Metrics
Weexaminethefaultdetectionrate(numberofmutantsdetected
overthetotalnumberofmutants)andpercentofmutantswhichare
flaky (at least one concrete test exhibits flaky behavior by passing
and/orfailingonatleastonerunanddoingtheoppositeonanother.)
We measure efficiency using testing time (simulation plus oracle
evaluation).
1199ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Gerten, Marsh et al.
4.6 Threats to Validity
While we used a variety of CRN programs, we cannot guarantee
thattheresultsgeneralizebeyondtheseprograms.Tolessenthis
threat weselecteda varietyof programs(stable andprobabilistic)
in a variety of sizes. We also provide these on our external website.
A second threat is that we wrote the specification tests for subjects
other than those in Gerten et al. This could bias the data, however,
we tried to use an approach similar to the one they described, and
used programs whose specifications could be easily understood.
WealsomaynothaveagroundtruthCRN,butassumetheoneswe
usetostartareworkingproperly;wedidconfirmthattherewere
no faults detected in the stable CRNs.
Third,weremovedmutantsthatranoutofmemory.Weremoved
these from all of our analysis meaning there could be some bias
against test suites which generate more data. It is possible that
some of our errors were faults which could be detected by some
test suites and not others.
Last, we wrote our own programs to generate invariants, run
the tests, analyze the results and merge our data. There could be
faultsintheseprograms,butwehavedonesomevalidationonthese
programsandhavemanuallycheckeddataacross/betweenpaper
authors.Wealsoshowedinvariantsgeneratedbyourprogramto
externalusers/developersofbioinformaticstoolsandobtainedtheir
feedback as a sanity check. We provide our data artifacts for the
community to inspect and re-validate.
5 RESULTS
We now present the results of our three research questions.
Table3:FaultDetectionforinvariantflowsvs.specification
basedtests.Columnsshowthenumberofconcretetestcases
andthepercentofmutantsdetectedbyatleastonetest.The
lasttwocolumnsindicatemutantsdetectedbytheinvariant
only(Inv.)orspecificationonly(Spec.)tests.Astarindicates
a small positive value. Org is the non-faulty program.
Flows Specification
Org# %Org# %# Inv.#Spec.
CRN %TestsDetected %TestsDetected OnlyOnly
Min 09295.7 0430 43.5 12 0
S 04687.5 0354 90.6 20
AM 09362.1 0*279100.0 03
Mod 00 â€” 07487.5 10
Max 09287.5 0160 95.8 11
AL1 05659.1 0262 86.4 22
H1 03085.3 07097.1 11
H2 03076.0 02292.0 23
MWT 01572.7 0*27100.0 04
5.1 RQ1: Effectiveness of Flow Invariants
To answer this question, we examine Table 3. The table comprises
test data using the flow invariants. It compares this with the speci-
fication derived tests. The last two columns show the number of
mutantsdetectedbyinvarianttestsonly,followedbythosedetected
byspecificationtestsonly.WithintheFlowsandSpecificationstest
columns, we show the number of concrete tests performed, the
percentofmutantsdetected,andthepercentofmutantsthatare
detectedflakily.Thefirstcolumn(Org)isthepercentoftestfailuresin the non-faulty program. In all but two subjects (AM and MWT)
all concrete test cases pass on all iterations for both techniques. In
AMandMWTwesawaverysmallpercentage(lessthan.5)tests
failing flakily on the specification based tests which is expected
behavior. A test is flaky if at least one test differs in its detection
ononeofthe100runs.Thespecificationbasedtestsfindahigher
percentageoffaultsonallsubjectsbuttheMinsubject.Forinstance,
the invariant tests for H1 detect 85.3% of the mutants while the
specificationtestsdetect97.1%.Weseesimilardataforothersub-
jects suchas AM and MWT.However, the invarianttests still find
a high percentage of faults (except for Mod). They also have fewer
concretetestcases(46vs.354insubtractionand92vs.160inMax).
We examine the implications for tests execution time in RQ2. Mod
isinterestingsinceithasnoFlowinvariants.Inordertotestthis
program, we need either inequalities or reaction counting.
Ifweexaminethelasttwocolumnsweseethatinsomesubjects
suchasAMandMWTtheinvarianttestsdonotfindfaultsthatthe
specification based tests find. We examined some of those mutants
(see discussion) and determined that these are mutations which
cause all reactions to stop firing. The invariant tests will always
hold, but the functional specifications will fail.
Summary of RQ1. We conclude that the flow invariants
are effective at fault detection. They also pass on the origi-
nalprograms providingevidence thatthey accuratelyde-
scribe program behavior. However, they do not perform
as well as the specification based test cases in most cases.
5.2 RQ2: Impact of Other Invariants and
Reaction Counting
We now examine how adding inequality (with and without reac-
tioncounting)andirreducibletestsimpactstheeffectivenessand
efficiency of fault detection. Table 4 shows results of the various
invariants and the different techniques (with and without reac-
tion counting). The columns for each of these techniques show
the percent of faults detected deterministically and flakily, and the
number of invariants of that type. For the Subtraction CRN the de-
tectionrateimprovesfrom87.5%to90.6%whenweaddinequalities,
however inequalities on their own are not that effective. If we add
reaction counting, the inequalities alone jumps to 75%, and can be
combined withthe irreducibles whichthen detects 96.9%of faults.
Thisimprovesoverthespecificationtests.Thetrendisconsistent
acrossmostsubjects.TheModCRNwhichgeneratednoflowsat
all,improvesto91.7%faultdetectionwithreactioncounting,andis
betterthanthespecificationtests.Forthelastfoursubjects(tobe
examined further in RQ3), we see both H4 and ECG improve with
theadditionaltechniques.Ingeneralwefindthattheinvarianttests
exhibitslightlylowerpercentageofflakiness.Thisisnotentirely
unexpected since they lack timing information.
We examine efficiency (Table 5) using testing runtime which
generallyincreasesforthelargertestsuiteasweaddnewinvari-
ants, but not significantly. However, we do see a jump in time
betweentechniqueswhenweusereactioncountingonthelarger
subjects.Runningthe chem_flows tooltakeslessthanasecondfor
all subjects.
1200Program Invariants in Chemical Reaction Networks ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
Table4:FaultDetectionbyInvariantType(Flows,Inequality,Irreducible)andTechnique(With/WithoutReactionCounting).
PercentsshownforDetect(Det)andFlakyonly(flky)detection.Numberofinvariants(No.Inv).Adashmeansthetypeoftest
is not present for the subject.
Without Reaction Counting With Reaction Counting
Flows Ineq Flows+Ineq Ineq Irred Ineq+Irred Flow+Ineq+Irred Specification
%%No.%%.No.%%No.%%No.%%.No.%%No.%%No.%%
CRNDetFklyInvDetFlkyInvDetFlkyInvDetFlkyInvDetFlkyInvDetFlkyInvDetFlkyInvDetFlky
Min95.70.028.70.0195.70.0330.40.01â€”â€”030.40.0195.70.0343.50.0
S87.50.0125.06.3290.63.1375.00.02â€”â€”075.00.0296.90.0390.63.1
AM62.13.41â€”â€”062.13.41â€”â€”082.17.1282.17.1296.66.93100.010.3
Mod â€”â€”020.84.2220.84.2287.54.2283.34.2191.74.2391.74.2387.562.5
Max87.50.0245.88.3387.50.0583.30.03â€”â€”083.30.0395.80.0595.813.0
AL159.14.5263.64.5586.44.5777.39.15â€”â€”077.39.1586.44.5786.431.8
H185.30.0323.511.8685.30.0988.20.0638.20.0291.20.08100.00.01197.18.6
H276.00.0328.04.0676.00.0984.00.0644.00.0384.00.0988.00.01292.00.0
MWT72.70.05â€”â€”072.70.05â€”â€”071.40.01171.40.01186.40.016100.09.1
PP45.84.25â€”â€”045.84.25â€”â€”091.38.72291.38.72295.88.727â€”â€”
ECG24.00.0110.00.01224.00.02320.00.012â€”â€”020.00.01228.00.023â€”â€”
H464.044.01128.024.01664.044.02752.048.01660.052.02360.052.03964.044.050â€”â€”
EC12.00.0704.00.036812.00.04388.00.03688.00.05812.00.042620.00.0496â€”â€”
Table 5: Time Required to Run Tests. The table shows the
total runtime for all tests across all mutants (Time) in min-
utes(m) or hours(h).
Without Reac. Count With Reac. Count
CRNFlowsFlows + Ineq Flows + Ineq + Irred Specification
Min 13m 25m 31m 34m
S 32m 1.0h 59m 56
AM 34m 34m 1.3h 1.2h
Mod â€” 33m 1.1h 18m
Max 15m 29m 31m 41m
AL1 21m 48m 51m 56m
H1 57m 1.4h 1.8h 47m
H2 12m 28m 46m 50m
MWT 51m 51m 1.7h 1.1h
PP 30m 41m 58m â€”
ECG 8m 16m 22m â€”
H4 37m 1.1h 2.5h â€”
EC 5.0h 18.2h 54.3h â€”
	

      

	



 	

Figure 2: Fault Detection by Type of Test Case. Allcontains
all subjects with specification based tests. Stableincludes
subjects Min, S, Mod, Max, H1, H2. Unstable includes AM,
AL1, MWT.
Wealsoexaminedtheoverallfaultdetectionbyinvarianttype
for the programs with specification tests (from top half of Table 4).
Figure 2 shows this data for all subjects (first bar in each group),
followed by stable program (second bar) and unstable programs.Stableprogramsareguaranteedtoreturnthesameresulteverytime.
Unstable programs have a probabilistic element. Flow invariants
alone (leftmost set of bars) perform pretty well, but detect fewer
faultsthanspecificationtests(rightmostgroup).Wedoseeaslight
increase when adding inequalities (third group of bars). When we
addreactioncountingandallinvariants(Flows+Ineq+Irred)nextto
lastgroup,weseehigherfaultdetectionforthe AllandstableCRNs
overthespecificationtests.However,theinvariantsperformworse
on the unstable CRNs. This is likely due to the fact that unstable
CRNscontainaprobabilisticcomponentandextractedinvariants
are weak since any invariant must account for the probabilistic
nature. We explore this issue as future work.
To analyze coverage of the CRNs we examine Figure 3. This
shows coverage of individual invariants for the starred subjects in
Table 2. For each we show the the normalized reaction coverage
(outofthetotalreactionsforthatCRN)annotatedwithanR(e.g.
FlowR)andthespeciescoverageannotatedwithanS(e.g.FlowS).A
reaction is covered if a species from an invariant is in the reaction.
We see a range of coverage by invariant type suggesting that there
may be an opportunity for test selection or prioritization.
We examined one subject further to look for a correlation be-
tween coverage fault detection. Table 6 shows 11 invariant tests
generatedby ChemFlow for the Hailstone1 subject.We seesome
correlation between increased species and reaction coverage but
leave a full evaluation as future work.
Summary of RQ2. We conclude that adding inequalities
slightly improves fault detection. The biggest impact is
addingreactioncounting.Wedoseeatradeoffwithrespect
to fault detection and runtime in the larger subjects.
5.3 RQ3: Lack of Specifications
Our last RQ investigates the situation when we do not have speci-
fications, and evaluates the potential to use invariants for model
quality. We first examine the data from Tables 4 and 5 focusing on
thelastfourrows.Wewereabletofindfaultsinallfourofthese
1201ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Gerten, Marsh et al.
0.250.500.751.00
FlowR FlowS IneqR IneqS IrredR IrredS
Coverage of Reactions (R) and Species (S) by Invariant TypeNormalized CoverageTypeFlowR
FlowSIneqR
IneqSIrredR
IrredS
Figure 3: Invariant Coverage by Type
Table6:FaultDetectionbyInvariantforHailstone1.Typeof
invariant and technique shown. Ineq-RC indicates inequal-
itiesusingreactioncounting.Foreachweshowthenormal-
izedSpeciesCoverage(SpCv)andReactioncoverage(ReCv).
TestInv % Faults % %
IDType Detected SpCv ReCv
1Flow 35 45 45
2Flow 59 64 73
3Flow 38 27 36
4Ineq 3 36 45
5Ineq 3 45 73
6Ineq 3 55 91
7Ineq 12 27 36
8Ineq 3 27 36
9Ineq 3 27 36
4Ineq-RC 35 36 45
5Ineq-RC 41 45 73
6Ineq-RC 53 55 91
7Ineq-RC 29 27 36
8Ineq-RC 18 27 36
9Ineq-RC 18 27 36
10Irred 29 18 36
11Irred 18 9 18

	

	

Figure 4: Invariants in E. colirepresent Islands of Species
subjects. We see similar trends that we saw in RQ2 with respect to
fault detection and time.
Inadditiontorunningthetests,wewerecuriousiftheinvariants
could provide useful information to bioinfomaticists (external toourorganization)whowriteandusemetabolicmodelingapplica-
tions.Wemetandpresentedourresultsusingasubsetofinvariants
which webelieved might be unexpectedbased on ourunderstand-
ing of biology. We used the real chemical compound names that
these reactions represent. The tool authors suggested that these
were interesting and might represent places where our model was
missing information or flows and that they would be interested in
seeingafullersetoftheseonanalternativemodel(onewhichthey
said was more highly curated), suggesting that fewer invariants
would mean a better model.
We extracted invariants from a second (higher quality) model of
the same variant of E. coli. The original model (EC) contains 426
reactions, 497 species, 47 genes and has 70 invariants. We chose
the iML1515 model from the UCSDâ€™s BiGG database, thought to
be the most complete genome scale metabolic model for E. coli
K-12 MG1655 [ 27]. It contains 2712 reactions, 1877 metabolites,
1516genesandhasonly32invariants.Whencomparinginvariants
between models, we noticed the refinement of some. In general,
the invariants in the iML1515 model are composed of less familiar
metabolites suggesting it fixed problems in the EC model. There
are also fewer species in the invariants. We showed these to the
developersagainandtheyaskedus(1)performastudyonhundreds
of other models and (2) help incorporate this into one of their
systems,whichhasover21,000users,toaidusersintheanalysisof
their models. A real (confirmed) fault in our original E. colisubject
model is the absence of an exchange flux for fluoride which means
it can never leave the cell which is not biologically accurate.
Manyoftheinvariantsfoundshow islandsofspecies.Figure3
shows four invariants, denoted by the boxed reactions, from the
E. colimodel. The species on the left (group A) are involved in two
reactionswhereasthespeciesontheright(groupB)areonlypart
ofonereactioninthemodel.ThespeciesingroupAarevitamins
participatinginbidirectionaltransport:eachdirectionisconsidered
a separate reaction. In group B, the species are ions undergoing
unidirectional transport (in this case, into the cell). The species
in the middle are extracellular protons as well as protons in the
cytoplasm necessary for the species to be transported across the
cellwall.Sincethespeciesinthisexampleareonlyparticipatingin
transport,theycouldsuggestaproblemwiththemodel.Thisisnot
immediately clear in the network graph, suggesting the invariants
are useful.
Summaryof RQ3. We conclude that invariants have po-
tentialforbothregressiontestingandmodelqualitywhen
no specifications exist.
5.4 Discussion
We discuss a few interesting phenomena we saw during the experi-
ments here.
Specification Tests Find Faults, Invariants Do Not. Wefound
cases where none of the invariants were able to detect a fault, but
the specification tests did. An example is the mutant MIN-25. This
mutation causes Reaction 1 to add a reactant Zwhich changes the
firstreaction( X+Yâˆ’ â†’Z)to:X+Y+Zâˆ’ â†’Z.Since Zisnotaninput
species, it is initially set to 0 molecules for simulation. However, Z
1202Program Invariants in Chemical Reaction Networks ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
is areactant inthe mutation, soat least 1molecule isrequired for
thereactiontofire,thusnoreactionscanfire.Theinvarianttests
failtodetectthis, becausetheoracleonlychecksifthe valuesare
constant,notwhattheirvaluesare;allinvarianttestsaretautologies.
However,thespecificationsevaluatefunctionalbehavior,andthose
detect the faults. This was seen in other subjects as well, forming a
class of mutations that require specifications.
Invariants Find Faults, Specifications Do Not. An example of
this situation is AL1-25, which adds the reaction F1Pâˆ’ â†’A1+F1P.
This mutation causes the number of A1 molecules in the system
toincrease.Sinceatleast1 A1hastobepresentinitiallytocreate
theF1Pfor the reactant, the functional behavior of the CRN is
maintained(atleast1 A1ispresent).Thisfaultisdetectedbythe
invariants since they check that the number of molecules in the
affected species are constant during simulation. We would need an
internal test case in the specification suite to detect this.
Invariants Usedfor Model Quality. We now look at the results
from the biological models. The reduced number of the invariants
in the iML1515 model over the EC model suggests improvement,
however,someproblemsremain.Anexampleweidentifiedisthe
absenceof anexchange flux.Inthe iML1515modelthe amountof
fluoride remains invariant due to the absence of an exchange flux,
sothefluoridecanneverleavethesystem.Whilethisinvariantwas
not found in the original model, suggesting the presence of a (new)
regression fault, we saw similar invariants for other elements such
as Zn2+, Cu2+, Cl-, Ca2+, Co2+, and K+ in the original model.
6 RELATED WORK
Much of the research on CRNs defines novel programs to compute
or accomplish some behavioral goal [ 10,18,56]. Another direction
of work has been to provide domain specific languages to generate
CRNs[31,45,54].InthispaperwefocusonvalidationofCRNs.We
summarize key related work next.
VerificationandTestingCRNs. Onestateofthearttechniquefor
verificationofCRNsistousemodelcheckingorautomatedtheorem
proving, such as PRISM [ 36,55]. PRISM does have a statistical
model checker, but it does not support LTL path properties and
requires translation of the CRN model to its format. Gerten et al.
[20]demonstrateditslackofscalabilityinparticularonfaultyCRNs.
Vasic et al. [ 55] use Alloy [ 25] to model and explore a subset of
deterministicCRNs(theotherCRNsemantic).Itispossiblethatthey
canextendthistogeneratetests,howevertheydidnotperformthis
step and the CRNs explored are deterministic, not stochastic CRNs.
ThemostcloselyrelatedworktothispaperisChemTest[ 20]and
CRNRepair(aprogramrepairtechnique)[ 40]. However, both use
specification-basedtestswhichwehavecomparedagainstinthis
paper.ChemFlowcanbeappliedineitheroftheseenvironments,
hence it is complementary to these approaches.
Invariant Detection. Dynamic invariant detection has been used
to extract program invariants both from code [ 16,37,46,58] and
viaexecutionlogs[ 6,7,38].Ourinvariantdetectiontechniquedoes
not require logs or dynamic traces. Instead it uses an algebraic
representation.
PetriNetInvariants. ThereisabreadthofearlierworkinthePetri
netcommunityontheuseoflinearinvariantstodeterminestruc-
turalproperties;see[ 50]forasurvey.Generally,thesestructuralpropertiesholdregardlessoftheinitialconfiguration,andunlike
modelchecking,aredeterminedwithoutexaminingthereachable
statesofthePetrinet.InsteadofPâ€“flows,muchworkhasbeendone
indeterminingandutilizingPâ€“ semiflows,whicharethePâ€“flows
whereallcoefficientsarenon-negative.However,whilethesetof
allPâ€“flowscanbegeneratedfromabasisofsizeatmostequaltothe
numberofspecies,ageneratingsetofminimalPâ€“semiflowsmay
beexponentiallylarger.Assuch,therearedifferentapproachesand
heuristicstoreducethecomputationalcostofdeterminingthemin-
imalPâ€“semiflows.OurworkonPâ€“flowsiscomputationallymuch
simpler, and can extract linear invariants that cannot be expressed
as Pâ€“semiflows. Other work has shown that Petri nets are effec-
tive for modeling metabolic pathways. Gupta et al. explored the
use of Petri nets for metabolic pathway validation by determining
the presence of inconsistency or deadlock as well as noting that
invariantanalysiscanidentifyT-invariants(reversiblereactions)
and P-invariants (conserved compounds) [21].
ManytoolsutilizePetrinetstoanalyzetheirstructure[ 5,14,57].
SinceCRNscanbetranslatedintoaPetrinetrepresentation,itis
theoretically possible to convert the CRN to a Petri net representa-
tion,performanalysis,andthenconverttheresultbacktoaform
corresponding to the CRN. This technique has several disadvan-
tages. (1) As noted above, most Petri net tools build generator sets
forPâ€“semiflows,notP-flows,withpotentiallymuchhighercompu-
tational cost and loss of some linear invariants. (2) ChemFlow uses
reaction counting, which most Petri net tools do not provide. (3)
TheChemFlowframeworkisdesignedfordevelopersofCRNswho
design,simulate,andvalidatetheirsystemsusingtheCRNmodel.
Translating the CRN to the Petri net model for testing would force
them to use a potentially unfamiliar representation. In addition, it
maybedifficulttomaintaintraceabilitybetweeninvariantsandthe
CRN since Petri net tools that translate the analysis back to a CRN
model may change names and labels for reactions and species.
7 CONCLUSIONS AND FUTURE WORK
Inthis paperwepresentedChemFlow, anautomatedinvariantin-
ferencetechniqueforCRNs.WeevaluatedChemFlowonasetof13
benchmarkCRNsincluding4whichdonothavespecifications.We
show that the base type of invariant, flows, finds a large number
offaultsefficiently,butisslightlylesseffectivethanspecification
basedtestsuites.Asweaddadditionaltypesofinvariantsandre-
actioncounting,theinvariantsfindasimilarnumberoffaultsas
specifications and more deterministically. We also find differences
in fault detection by test type when we classify programs as ei-
therstableandunstable.Lastweseeatradeoffbetweentestcase
efficiency and effectiveness of the various approaches.
ForfutureworkweplantoimplementChemFlowasatoolfor
others to utilize. We plan to examine the connection between fault
detection and CRN coverage in more depth. Finally, we plan to
exploremodelqualitymorethoroughlybyanalyzinglargesetof
biological models.
8 ACKNOWLEDGMENTS
We would like to thank C.Henry, J.P. Faria and B. Cottingham for
feedback and discussions on the E. coliinvariants. This work is
supportedinpartbyNSFGrantsCCF#1909688andFET#1900716.
1203ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA Gerten, Marsh et al.
REFERENCES
[1]Ebbe S. Andersen, Mingdong Dong, Morten M. Nielsen, Kasper Jahn, Ramesh
Subramani, Wael Mamdouh, Monika M. Golas, Bjoern Sander, Holger Stark,
Cristiano L. P. Oliveira,Jan Skov Pedersen, Victoria Birkedal,Flemming Besen-
bacher, KurtV.Gothelf,and JÃ¸rgenKjems.2009. Self-assembly ofananoscale
DNA box with a controllable lid. Nature459, 7243 (01 May 2009), 73â€“76.
https://doi.org/10.1038/nature07971
[2]J. H. Andrews, L. C. Briand, and Y. Labiche. 2005. Is Mutation an Appropriate
ToolforTestingExperiments?.In Proceedings of the 27th International Conference
on Software Engineering .AssociationforComputingMachinery,NewYork, NY,
USA, 402â€“411. https://doi.org/10.1145/1062455.1062530
[3]Adam P. Arkin, Robert W. Cottingham, Christopher S. Henry, Nomi L. Harris,
Rick L Stevens, Sergei Maslov, et al .2018. KBase: The United States Department
ofEnergySystemsBiologyKnowledgebase. Nature Biotechnology 36,7(2018),
566â€“569. https://doi.org/10.1038/nbt.4163
[4]StefanBadelt,SeungWooShin,RobertF.Johnson,QingDong,ChrisThachuk,
and Erik Winfree. 2017. A General-Purpose CRN-to-DSD Compiler with Formal
Verification, Optimization, and Simulation Capabilities. In International Confer-
ence on DNA Computing and Molecular Programming (Lecture Notes in Computer
Science). 232â€“248. https://doi.org/10.1007/978-3-319-66799-7_15
[5]B. Berthomieu, P.-O. Ribet, and F. Vernadat. 2004. The tool TINA â€“ Construc-
tion of abstract state spaces for Petri nets and time Petri nets. International
Journal of Production Research 42, 14 (2004), 2741â€“2756. https://doi.org/10.1080/
00207540412331312688
[6]Ivan Beschastnikh, Yuriy Brun, Jenny Abrahamson, Michael D. Ernst, and
Arvind Krishnamurthy. 2015. Using declarative specification to improve the
understanding, extensibility, and comparison of model-inference algorithms.
IEEE Transactions on Software Engineering 41, 4 (April 2015), 408â€“428. https:
//doi.org/10.1109/TSE.2014.2369047
[7]Ivan Beschastnikh, Yuriy Brun, Sigurd Schneider, Michael Sloan, and Michael D.
Ernst.2011.LeveragingExistingInstrumentationtoAutomaticallyInferInvariant-
Constrained Models. In Proceedings of the 19th ACM SIGSOFT Symposium and
the 13th European Conference on Foundations of Software Engineering (Szeged,
Hungary) (ESEC/FSE â€™11) . Association for Computing Machinery, New York, NY,
USA, 267â€“277. https://doi.org/10.1145/2025113.2025151
[8]BioBricksFoundation2021. BioBrickPublicDNAParts. BioBricksFoundation.
Last Accessed: August 2021.
[9]Robert Brijder. 2019. Computing with chemical reaction networks: a tutorial.
Natural Computing 18,1(2019),119â€“137. https://doi.org/10.1007/s11047-018-
9723-9
[10]Luca Cardelli, Marta Kwiatkowska, and Luca Laurenti. 2018. Programming
discrete distributions with chemical reaction networks. Natural Computing 17, 1
(01 Mar 2018), 131â€“145. https://doi.org/10.1007/s11047-017-9667-5
[11]MikaelaCashman,JustinFirestone,MyraB.Cohen,ThammasakThianniwet,and
WeiNiu.2021. AnEmpiricalInvestigationofOrganicSoftwareProductLines.
Empirical Software Engineering 26,3(2021),44. https://doi.org/10.1007/s10664-
021-09940-0
[12]Ho-LinChen,RachelCummings,DavidDoty,andDavidSoloveichik. 2014. Speed
FaultsinComputationbyChemicalReactionNetworks.In Distributed Computing ,
Fabian Kuhn (Ed.). Springer Berlin Heidelberg, Berlin, Heidelberg, 16â€“30.
[13]Yuan-JyueChen,NeilDalchau,NiranjanSrinivas,AndrewPhillips,LucaCardelli,
David Soloveichik, andGeorg Seelig. 2013. Programmablechemical controllers
made from DNA. Nature Nanotechnology 8, 10 (2013), 755â€“762.
[14]G. Chiola, G. Franceschinis, R. Gaeta, and M. Ribaudo. 1995. GreatSPN 1.7:
GraphicaleditorandanalyzerfortimedandstochasticPetrinets. Performance
Evaluation 24, 1 (1995), 47â€“68. https://doi.org/10.1016/0166-5316(95)00008-L
Performance Modeling Tools.
[15]Matthew Cook, David Soloveichik, Erik Winfree, and Jehoshua Bruck. 2009.
Programmability of Chemical Reaction Networks . Springer Berlin Heidelberg,
Berlin, Heidelberg, 543â€“584. https://doi.org/10.1007/978-3-540-88869-7_27
[16]Christoph Csallner, Nikolai Tillmann, and Yannis Smaragdakis. 2008. DySy:
Dynamic Symbolic Execution for Invariant Inference. In Proceedings of the 30th
International Conference on Software Engineering (Leipzig,Germany).Association
for Computing Machinery, New York, NY, USA, 281â€“290. https://doi.org/10.
1145/1368088.1368127
[17]ShawnM.Douglas,IdoBachelet,andGeorgeM.Church.2012. ALogic-Gated
Nanorobot for Targeted Transport of Molecular Payloads. Science335, 6070
(2012), 831â€“834. https://doi.org/10.1126/science.1214081
[18]SamuelJ.Ellis,TitusH.Klinge,JamesI.Lathrop,JackH.Lutz,RobynR.Lutz,An-
drewS.Miner,andHughD.Potter.2019. RuntimeFaultDetectioninProgrammed
Molecular Systems. ACM Transactions on Software Engineering Methodology 28,
2, Article 6 (March 2019), 20 pages. https://doi.org/10.1145/3295740
[19]MartinFeinberg.2019. Foundations of chemical reaction network theory . Springer.
[20]MichaelC.Gerten,JamesI.Lathrop,MyraB.Cohen,andTitusH.Klinge.2020.
ChemTest:AnAutomatedSoftwareTestingFrameworkforanEmergingPara-
digm.In Proceedings of the 35th IEEE/ACM International Conference on Automated
Software Engineering . 548â€“560. https://doi.org/10.1145/3324884.3416638[21]SakshiGupta,SunitaKumawat,andGajendraPratapSingh.2022. Validationand
AnalysisofMetabolicPathwaysUsingPetriNets. In Soft Computing: Theories
and Applications . Springer, 361â€“374.
[22]ChristopherSHenry,MatthewDeJongh,AaronABest,PaulMFrybarger,Ben
Linsay, and Rick L Sevens. 2010. High-throughput generation, optimization and
analysis of genome-scale metabolic models. Nature Biotechnology 28, 9 (August
2010), 977â€“982.
[23]iGEMRegistry2021. RegistryofStandardBiologicalParts. iGEMFoundation.
Last Accessed: August 2021.
[24]International Society for Nanoscale Science 2021. International Society for
Nanoscale Science, Computation and Engineering (ISNSCE). https://isnsce.org/
Accessed on 2021-09-09.
[25]D. Jackson. 2012. D. Jackson, Software Abstractions, 2nd ed. MIT Press, 2012. (2nd
ed.). MIT Press.
[26]ShuoxingJiang,ZhileiGe,ShanMou,HaoYan,andChunhaiFan.2021. Designer
DNA nanostructures for therapeutics. Chem7, 5 (2021), 1156â€“1179. https:
//doi.org/10.1016/j.chempr.2020.10.025
[27]Monk JM, Lloyd CJ, Brunk E, and et al. 2017. iML1515, a knowledgebase that
computes Escherichia coli traits. Nat Biotechnol. 35 (2017), 904â€“908. https:
//doi.org/10.1038/nbt.3956
[28]MinoruKanehisaandSusumuGoto.2000. KEGG:kyotoencyclopediaofgenes
and genomes. Nucleic acids research 28, 1 (2000), 27â€“30.
[29]Richard M. Karp and Raymond E. Miller. 1969. Parallel program schemata. J.
Comput. System Sci. 3, 2 (1969), 147â€“195. https://doi.org/10.1016/S0022-0000(69)
80011-5
[30]KBase2021. TheDepartmentofEnergySystemsBiologyKnowledgebase. http:
//kbase.us.
[31]TitusH.Klinge,JamesI.Lathrop,SoniaMoreno,HughD.Potter,NarunK.Raman,
and Matthew R. Riley. 2020. ALCH: An Imperative Language for Chemical
Reaction Network-Controlled Tile Assembly. In 26th International Conference
on DNA Computing and Molecular Programming (DNA 26) (Leibniz International
Proceedings in Informatics (LIPIcs), Vol. 174) ,CodyGearyandMatthewJ.Patitz
(Eds.).SchlossDagstuhlâ€“Leibniz-ZentrumfÃ¼rInformatik,Dagstuhl,Germany,
6:1â€“6:22. https://doi.org/10.4230/LIPIcs.DNA.2020.6
[32]Marta Kwiatkowska, Gethin Norman, and David Parker. 2010. Advances
and challenges of probabilistic model checking. In 2010 48th Annual Allerton
Conference on Communication, Control, and Computing (Allerton) . 1691â€“1698.
https://doi.org/10.1109/ALLERTON.2010.5707120
[33]Marta Kwiatkowska and Chris Thachuk. 2014. Probabilisticmodel checking for
biology. In Software Systems Safety . IOS Press, 165â€“189.
[34]Jefferey C. Lafarias (Ed.). 2010. The ultimate challenge : the 3x + 1 problem .
American Mathematical Society.
[35]James I. Lathrop, Titus H. Klinge, and Bryce Valley. 2021. personal communica-
tion.
[36]JamesI.Lathrop,JackH.Lutz,RobynR.Lutz,HughD.Potter,andMatthewR.
Riley. 2020. Population-Induced Phase Transitions and the Verification of
Chemical Reaction Networks. In 26th International Conference on DNA Com-
puting and Molecular Programming (DNA 26) (Leibniz International Proceed-
ings in Informatics (LIPIcs), Vol. 174) , Cody Geary and Matthew J. Patitz (Eds.).
Schloss Dagstuhlâ€“Leibniz-Zentrum fÃ¼r Informatik, Dagstuhl, Germany, 5:1â€“5:17.
https://doi.org/10.4230/LIPIcs.DNA.2020.5
[37]Kaituo Li, Christoph Reichenbach, Yannis Smaragdakis, and Michal Young. 2013.
Second-Order Constraints in Dynamic Invariant Inference. In Proceedings of the
2013 9th Joint Meeting on Foundations of Software Engineering (Saint Petersburg,
Russia) (ESEC/FSE 2013) .AssociationforComputingMachinery,NewYork,NY,
USA, 103â€“113. https://doi.org/10.1145/2491411.2491457
[38]David Lo and Shahar Maoz. 2009. Mining Scenario-Based Specifications with
Value-Based Invariants. In Proceedings of the 24th ACM SIGPLAN Conference
Companion on Object Oriented Programming Systems Languages and Applications
(Orlando,Florida,USA). AssociationforComputingMachinery,New York,NY,
USA, 755â€“756. https://doi.org/10.1145/1639950.1639999
[39]Matlab-Simbiology User Forum 2020. MATLAB Forum Question on Test-
ing CRNs. https://www.mathworks.com/matlabcentral/answers/593965-unit-
testing-on-simbiology-created-model?s_tid=srchtitle_simbiology_53.
[40]Ibrahim Mesecan, Michael C. Gerten, James I. Lathrop, Myra B. Cohen, and
TomasHaddadCaldas.2021. CRNRepair:AutomatedProgramRepairofChem-
ical Reaction Networks. In 2021 IEEE/ACM International Workshop on Genetic
Improvement (GI) . 23â€“30. https://doi.org/10.1109/GI52543.2021.00014
[41]TadaoMurata.1989. PetriNets:Properties,AnalysisandApplications. Proc. IEEE
77, 4 (April 1989), 541â€“580.
[42]Akbar Siami Namin and SahityaKakarla. 2011. The Use of Mutation in Testing
Experiments and Its Sensitivity to External Threats. In Proceedings of the 2011
International Symposium on Software Testing and Analysis (ISSTA â€™11) .Association
for Computing Machinery, New York, NY, USA, 342â€“352. https://doi.org/10.
1145/2001420.2001461
[43]NCBI 2021. National Center for Biotechnology Information (NCBI), National
Library of Medicine (US), National Center for Biotechnology Information. https:
//www.ncbi.nlm.nih.gov/.
1204Program Invariants in Chemical Reaction Networks ICSE â€™22, May 21â€“29, 2022, Pittsburgh, PA, USA
[44]T.J.OstrandandM.J.Balcer.1988. TheCategory-partitionMethodforSpecifying
and Generating Functional Tests. Commun. ACM 31, 6 (June 1988), 676â€“686.
[45]Michael Pedersen and Andrew Phillips. 2009. Towards programming languages
for genetic engineering of living cells. Journal of the Royal Society Interface 6
(2009), S437â€“S450. https://doi.org/10.1098/rsif.2008.0516.focus
[46]Jeff H. Perkins and Michael D. Ernst. 2004. Efficient Incremental Algorithms
for Dynamic Detection of Likely Invariants. In Proceedings of the 12th ACM
SIGSOFT Twelfth International Symposium on Foundations of Software Engineering
(Newport Beach, CA, USA) (SIGSOFT â€™04/FSE-12) . Association for Computing
Machinery,NewYork,NY,USA,23â€“32. https://doi.org/10.1145/1029894.1029901
[47]C. Adam Petri and W. Reisig. 2008. Petri net. Scholarpedia 3, 4 (2008), 6477.
https://doi.org/10.4249/scholarpedia.6477 revision #91647.
[48]William Poole, Ayush Pandey, Andrey Shur, Zoltan A. Tuza, and Richard M.
Murray. 2020. BioCRNpyler: Compiling Chemical Reaction Networks from
Biomolecular Parts in Diverse Contexts. bioRxiv(2020). https://doi.org/10.1101/
2020.08.02.233478
[49]LuluQian,ErikWinfree,andJehoshuaBruck.2011. Neuralnetworkcomputation
with DNA strand displacement cascades. Nature475, 7356 (2011), 368â€“372.
[50]ManuelSilva,EnriqueTerue,andJosÃ©ManuelColom.1998. Linearalgebraicand
linearprogrammingtechniquesfortheanalysisofplace/transitionnetsystems.
InLectures on Petri Nets I: Basic Models: Advances in Petri Nets , Wolfgang Reisig
and Grzegorz Rozenberg (Eds.). Springer Berlin Heidelberg, 309â€“373. https:
//doi.org/10.1007/3-540-65306-6_19
[51]David Soloveichik, Georg Seelig, and Erik Winfree. 2009. DNA as a Universal
Substrate for Chemical Kinetics. In DNA Computing (Lecture Notes in Computer
Science, Vol. 5347) . 57â€“69.
[52]TheMathworks,Inc.2021. MATLAB version 9.10.0.1613233 (R2021a) . TheMath-
works, Inc., Natick, Massachusetts.[53]Marko Vasic, Cameron Chalk, Sarfraz Khurshid, and David Soloveichik. 2020.
DeepMolecularProgramming:ANaturalImplementationofBinary-WeightReLU
Neural Networks. In Proceedings of the 37th International Conference on Machine
Learning (Proceedings of Machine Learning Research, Vol. 119) , Hal DaumÃ© III
andAartiSingh(Eds.).PMLR,9701â€“9711. https://proceedings.mlr.press/v119/
vasic20a.html
[54]Marko Vasic, David Soloveichik, and Sarfraz Khurshid. 2018. CRN++: Molecular
Programming Language. In DNA Computing and Molecular Programming , David
Doty and Hendrik Dietz (Eds.). Springer International Publishing, 1â€“18.
[55]MarkoVasic,DavidSoloveichik,andSarfrazKhurshid.2020. CRNsExposed:A
Method for the Systematic Exploration of Chemical Reaction Networks. In 26th
International Conference on DNA Computing and Molecular Programming (DNA
26) (Leibniz International Proceedings in Informatics (LIPIcs), Vol. 174) ,CodyGeary
and Matthew J.Patitz (Eds.). Schloss Dagstuhlâ€“Leibniz-Zentrum fÃ¼rInformatik,
Dagstuhl, Germany, 4:1â€“4:25. https://doi.org/10.4230/LIPIcs.DNA.2020.4
[56]ErikWinfree.2019. ChemicalReactionNetworksandStochasticLocalSearch.In
DNA Computing and Molecular Programming , Chris Thachuk and Yan Liu (Eds.).
Springer International Publishing, Cham, 1â€“20.
[57]KarstenWolf.2018. PetriNetModelCheckingwithLoLA2.In Application and
Theory of Petri Nets and Concurrency , Victor Khomenko and Olivier H. Roux
(Eds.). Springer International Publishing, Cham, 351â€“362.
[58]Lingming Zhang, Guowei Yang, Neha Rungta, Suzette Person, and Sarfraz Khur-
shid. 2014. Feedback-Driven Dynamic Invariant Discovery. In Proceedings of the
2014 International Symposium on Software Testing and Analysis (San Jose, CA,
USA) (ISSTA 2014) . Association for Computing Machinery, New York, NY, USA,
362â€“372. https://doi.org/10.1145/2610384.2610389
1205