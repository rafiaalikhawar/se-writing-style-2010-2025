Finding Client-side Business Flow Tampering Vulnerabilities
I Luk Kim
kim1634@purdue.edu
Departmentof Computer Science,
Purdue University
West Lafayette, Indiana, USAYunhui Zheng
zhengyu@us.ibm.com
IBM T. J. Watson Research Center
Yorktown Heights, USAHogun Park
hogun@purdue.edu
Departmentof Computer Science,
Purdue University
West Lafayette, USA
Weihang Wang
weihangw@buffalo.edu
University at Buffalo, SUNY
Buffalo, USAWei You
youwei@ruc.edu.cn
Renmin University of China
Beijing,ChinaYousra Aafer
yaafer@purdue.edu
Departmentof Computer Science,
Purdue University
West Lafayette, USA
Xiangyu Zhang
xyzhang@cs.purdue.edu
Departmentof Computer Science,
Purdue University
West Lafayette, USA
ABSTRACT
Thesheercomplexityofwebapplicationsleavesopenalargeattack
surfaceofbusinesslogic.Particularly,insomescenarios,developers
havetoexposeaportionofthelogictotheclient-sideinorderto
coordinate multiple parties (e.g. merchants, client users, and third-
partypaymentservices)involvedinabusinessprocess.However,
such client-side code can be tampered with on the fly, leading to
businesslogicperturbationsandfinancialloss.Althoughdevelop-
ersbecomefamiliar withconceptsthatthe clientshouldneverbe
trusted,giventhesizeandthecomplexityoftheclient-sidecodethat
maybeevenincorporatedfromthirdparties,itisextremelychal-
lengingtounderstandandpinpointthevulnerability.Tothisend,
we investigate client-side business flow tampering vulnerabilities
anddevelopadynamicanalysisbasedapproachtoautomatically
identifying such vulnerabilities. We evaluate our technique on 200
popular real-world websites. With negligible overhead, we have
successfully identified 27 unique vulnerabilities on 23 websites,
suchas New York Times, HBO, and YouTube, where an adversarycan interrupt businesslogic to bypass paywalls, disable adblocker
detection,earn reward points illicitly, etc.
CCSCONCEPTS
â€¢Security and privacy â†’Web application security.
Permissionto make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSEâ€™20,May23â€“29,2020,Seoul, Republic of Korea
Â© 2020Association for Computing Machinery.
ACM ISBN 978-1-4503-7121-6/20/05...$15.00
https://doi.org/10.1145/3377811.3380355KEYWORDS
JavaScript; vulnerability detection; business flow tampering; dy-
namicanalysis;
ACM Reference Format:
ILukKim,YunhuiZheng,HogunPark,WeihangWang,WeiYou,Yousra
Aafer,andXiangyuZhang.2020.FindingClient-sideBusinessFlowTamper-
ingVulnerabilities.In 42ndInternationalConferenceonSoftwareEngineering
(ICSEâ€™20),May23â€“29,2020,Seoul,RepublicofKorea. ACM,NewYork,NY,
USA,12 pages. https://doi.org/10.1145/3377811.3380355
1 INTRODUCTION
Theintrinsiccomplexityofthewebecosystemhascreatedanattrac-
tive attack surface for manipulation and exploitation. Adversaries
have exploited many common flaws that plague various entities in
theecosystem.Ofparticularinterestareclient-sidebusinesslogic
flaws.If exploited, they may lead to devastating consequences.
Asasideeffectofexposingpartialbusinesslogictotheclient-
side, by perturbing the internal control flow of events, adversaries
are able to change the intended behavior of a website and cause
variouskindsofdamages.Forexample,supposeanapplicationâ€™s
addeliverymechanismis developedwiththeintentionofplaying
asponsorâ€™svideobeforestreamingtheactualcontent.Malicecan
directly skip the first step to circumvent the business model of the
website.Similarly,awebsiterewardsairlinemilesafteraparticipant
fills out a survey. An attacker can illegitimately earn miles without
finishing the survey. A plausible approach to achieving this is to
disabletheconditioncheckandforcetheexecutionofrewardslogic,
withthehelpofuserscriptmanagerutilitieslikeGreasemonkey[ 13]
or Tampermonkey [12].
AlthoughOWASPstronglyrecommendsenforcingbusinesslogic
ontheserver-side[ 8],client-sideimplementationsare commonly
seen in practice. Sometimes, developers find it is easier to do so on
the client-side without thinking too much about the consequences.
But more importantly, it is unavoidable to devise some portion
*&&&"$.OE*OUFSOBUJPOBM$POGFSFODFPO4PGUXBSF&OHJOFFSJOH	*$4&
ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea I Luk Kim, Yunhui Zheng, Hogun Park, Weihang Wang, Wei You, Yousra Aafer, and Xiangyu Zhang


		
	
 
,($ ,&0 #
'#+00'$(*"(
'#+#
'#+""&	:/00'(&( C 
 345
;/1
</('&#!&#*&'3('4.
=/39D('0'0 "(45
>/		

?/65
@/('0'$(*"(
38#"("(')!%)'( 84.
A/1
B/6
:9/6.
		
00'(&(<&$&(,
&#*&'
#)()#"("(
&*&


		

+"#+0+$	'#"$
(&(
'#+,+  :/('0"((& C34CE5
;/#"'(!(&&#!' C('.
</
32!(&&#!'
--
07
--'#)   (&3445
=/ 	
>/6?/1
	





"((&
!'

&*&
::/('0(&(C34CE5
:;/1
:</((33(4CE5
:=/'#+(&(()'3(4.
:>/3(0& DC94
:?/'#+,+  34.
:@/64.
:A/1
Figure 1: Motivating examples
ofthelogicontheclient-sidetoconnectthedotsinsomescenar-
ios. Web applications nowadays commonly integrate third-party
content or services. In such cases, the client-side logic plays an
importantroleincoordinatingtheinternalstateswiththoseofmul-
tiple parties. Forexample, a web store may integrate a third-party
paymentserviceandimplementtheclient-sidelogictodrivethecheckout procedure [
40]. For websites that serve a huge number
of anonymous users (e.g., YouTube), it is very expensive to rely on
the server-side to maintain the comprehensive states of all users.
Threat Model. We assume adversaries can manipulate client-side
executiononthefly.Forinstance,theycantriggerwebpageevents
in arbitrary orders. They can modify client-side scripts, change
event handlers, bypass condition checks and alert, and send HTTP
requeststoservers.However,weassumetheydonothaveaccess
to servers so they cannot modify server-side logic.Problem Statement
. Web applications extensively incorporate
codefrommultiplesourcesandthusitisdesirabletounderstandtheriskshiddenintheclient-sideimplementations.However,giventhesizeandthecomplexitiescausedbyJavaScript(JS)dynamicfeatures
and event-based executions, it is extremely hard to audit client-side scripts (including those from third parties) and identify the
locationsthatarevulnerabletobusinessflowtampering.Tothisend,
we propose a dynamic analysis based approach to help developers
focus on places that are more likely to be real vulnerabilities. By
reportingthe locations andtheconcretetampering instances,our
methodcanhelpdeveloperseffectivelyevaluateifactionsshould
betakentoeitherrelocatethelogictotheserver-side,deploysomeruntimeattackdetectiontechniqueorincorporateadditionalclient-
side defensetechniques.
In this paper, we investigate the pervasiveness of the client-
side DOM-related business flow tampering vulnerabilities,T ot h ebest of our knowledge, this is the first study to characterize theimpact of the client-side business flow tampering vulnerabilities.
Astheyarecommonlycausedbyinsufficientprocessvalidation,we
proposeanautomaticdetectionmethodthataddressesthefollowing
challenges:
â€¢Pinpointingplacesvulnerabletobusinessflowmanipulationis
difficultin multi-functional web applications.
â€¢Dynamicwebapplicationfeaturesshouldbehandledascodecan
be injected and generated on the fly.
â€¢Codemodificationtechniquesandevent-baseddynamicexecu-
tionsmakestaticanalysis difficult.Inparticular,ourmethodsystematicallyexamineswebsitesas
follows: (1) Starting with business operation descriptions, we navi-
gate the website and collect a set of functions that may be relevant
tothebusinesslogic.(2)Weanalyzeeachcandidatefunctionand
lookforpotentialtamperinglocations,whichmayperturbthein-
tended behavior if modified. (3) We develop techniques to select
functionsthataremorelikelytobevulnerableandgeneratetamper-
ing proposals for each selected function. (4) We revisit the website
withthetamperingproposalsandconfirmifthedetectionresults
are indeed business flow tampering vulnerabilities.
To understand the scope and magnitude of the vulnerabilities in
practice,weevaluateourmethodon200real-worldwebsites.Weare
abletodetectclient-sidebusinesslogictamperingvulnerabilitieson
popularwebsites.Specifically,attackerscanbypasspaywallsand
read an unlimited number of articles without paying on NYTimes
andWashingtonPost.Detectedflawson YoutubeandCWTVenable
attackers to skip in-stream video ads. We also discover a flaw inthe popular reward-earning website InboxDollars; attackers can
illegitimatelyearnrewardspointswithoutfinishingtherequired
steps(e.g.watchvideos).Inourexperiments,weareabletostack
$3.44 reward for an hour attack with a single machine without
watching videos, and if we continue this attack, we could steal
around $80 per day.
In summary, we make the following contributions:
â€¢We investigate the pervasiveness of the DOM related client-side
business flow tampering vulnerabilities.
â€¢We develop a novel dynamic analysis based approach to auto-
matically identifying client-side business flow tampering vulner-
abilities.
â€¢We evaluate our method on 200 popular real-world websites.
Withnegligiblepageloading/renderingoverhead,wefound27
unique vulnerabilities, where an adversary can interrupt the
business logic to bypass paywall, disable adblock detection, earn
rewards illicitly, etc.
2 MOTIVATION
In this section, we use two real-world examples to show (a) how
business logic can be tampered with on the client-side, (b) whysuch vulnerabilities are common, and (c) why identifying these
vulnerabilitiesis challenging.
Finding Client-side Business Flow Tampering Vulnerabilities ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea
2.1 Bypassinga Metered Paywall
New York Times [ 37] (NYT) is a well known news publisher. Its
mainbusinessmodelisameteredpaywall.Itallowsuserstoread
alimitednumberofarticlesforfree.Afterthat,paidsubscription
isrequired.NYTdevelopersimplementedthemeteredpaywallin
March 2011. Within three months, the system generated 224,000
subscribers[ 29].Withthepaywall,afterauserreachesthequota
of 5 free articles, a subscription message box with a black-colored
background covering most of the screen will be displayed. Inspired
by NYTâ€™s success, many publishers (e.g., Washington Post, The
Boston Globe, and Chicago Tribune) adopted a similar paywall
system. Fig.1(a) describes part of the simplified paywall implemen-
tation.Eachtimeanewsarticleisaccessed,thearticlepageisloaded
as if there was no paywall. The paywall logic is implemented ina JS file loaded as part of the article page. In the JS file, function
window.webpackJsonp invokesfunction initMeter ,whichfurther
calls checkMeterData (line4)thatimplementsthepaywalllogic.In
thefunction,themeterdataisfirstaccessed(line13).Ifthecurrentuserexceedsthefreequota,function
showPaywall (line16)inserts
the subscription message box. To bypass the paywall, the attacker
candisablethefunctioncall checkMeterData() .Consequently,the
subscriptionmessageboxiselidedandtheattackercancontinue
toaccessarticlesforfree.Ademovideooftheattack(hostedonan
anonymouswebsite) can be found at [1].
WhileOWASPrecommendsthatcriticalaccesscontrolshould
beperformedsolelyontheserver-sidetoavoidanyclient-sidetam-
pering,NYTâ€™sdesignsimplydeliversallthecontenttotheclient
and relies on client-side access control to protect the content. Fur-
ther inspection suggests that there are reasons for such a flawed
design.Itlookslikethepaywallsystemwasintroducedasawell-
encapsulatedandstand-alone add-on(i.e.,a self-contained JSfile)
to avoid any complex interference with the previous code-base.
Properlyimplementedaccesscontrolhastomonitoreachpageload
fromtheserver-side,requiringsubstantialcodechanges.Further-
more,thenumberoffree-readersisordersofmagnitudelargerthanthatofthesubscribers.Acorrectdesignrequiresmaintainingsome
profile for each free-reader on the server-side (e.g., the numberof free articles accessed by the reader in a time duration), which
wouldbemuchmoreexpensivethanthecurrentdesignthatonly
needs to maintain subscribersâ€™ profile. The current design relieson the client-side resources to deal with a large number of free
readers. Such dilemmas are typical, leading to many flawed design
and implementationas shown by our results in Section 5.
2.2 SkippingIn-stream Ads
Ads revenue is crucial for business sustainability of streaming ser-
vices like YouTube. Although service providers try to make money
from other sources such as membership subscriptions, it turnedout they often have to scale back and rely mostly on ads [
11]. In
particular,YouTubeinsertsadvideosbeforeandinthemiddleof
contentvideos.Recently,itevenstartedshowingHollywoodmovies
with ad breaks for free [ 34]. To implement this, YouTube has to
use client-side logic because it needs to coordinate states among
multiplepartiesand dynamicallyload videos from ad networks.
Fig.1(b)showsasimplifiedversionoftheprocess.Theadvideos
arecontrolledbyfunctionsconnectedbybluearrows,whilebannerads are managed by functions linked by green arrows. Function
ytplayer.load isinvokedduringpageloadandeventuallyinvokes
function g.h.start .Thefunctionfirstgetsavailableadsfromthird-
partyadproviders(line3),thendecidesifadvideosshouldbeplayed
by checking if the list this.ads is empty (line 4). If yes, functions
showAdandshowVideoAd arecalledtoplaythein-streamvideoads.
Otherwise,itskipsandplaystheactualcontent(lines7 âˆ’8).Filling
upthis.adsisbyaseparatethreadinthebackground,controlledbya
timer.Similarly,function g.h.dispatchEvent isinvokedregularly
to deliver ad banners via function showBanner . By enforcing the
falsebranchoutcomeatline4,theadsareskippedandtheusercan
watchthecontentvideowithoutwatchingtheads.Notethatthis
is different from using an ad blocker to block ads. Many modern
web applications are equipped with anti-adblocker mechanism,
including Youtube [ 38]. Anti-adblockers often work by monitoring
DOM object changes after ads are loaded. If no change is observed
(meaningtheadsarenotdisplayed),itgetsintoablockingmode
requiring the user to turn off the adblocker. An anti-adblocker has
to be closely coupled with the ad display function. In this case, the
anti-adblockerispartofthefunction shownAd() (line5).Assuch,
bytamperingwiththeJScode(i.e.,line4)directly,theads,together
with theanti-adblockerlogic,are silently evaded.
Akeyfeatureofthesebusinessmodelsisthatthecontentpub-
lisher(orserviceprovider)wantstoensurecertainoperationsmust
beperformedontheclient-side,whichcannotbetrusted.Thisis
not a new problem. There are many other rigorous business logics
such as online shopping, credit card transactions, and online bank
transactions. The key enabling technique in those business models
is to associate a crypto-protected credential (e.g., token) with a
user[5].Thetokenissharedbythemultiplepartiesinthebusiness
model such that client-side operations can be remotely verified.
Forinstance,anonlineshoppingapplicationhastointeractwith
atleastaremotepaymentserviceproviderandaremoteproduct
provider.Thepaymentisrecordedbythepaymentserviceprovider
with thecredential of theuser.The product providercan indepen-
dentlycheckwiththepaymentserviceprovidertomakesurethe
payment is in place before the product is sent. Such distributed
integrityprotectionmechanismisheavyweightandoftendeployed
inapplicationswhereusersareproperlyprofiled(e.g.,userswith
accounts).
However,manywebapplicationsserveavastnumberofusers
with most of them not properly profiled and hence do not have as-
sociatedcredentials.Nonetheless,thecontentpublisherswanttheirinteresttobeprotectedonthoseun-profiledusers(bylimitingtheir
quotalikeinNYTorforcingthemtowatchadslikeinYouTube).
Suchlight-weightbusinessmodelsusuallyhavetorelyonclient-
side logic to conduct access control. In the YouTube example, ad
networksaredesignedinsuchawaythatanythirdparty,including
individuals, can bid for an ad slot (on YouTube). Most such third
partiesdo nothave thecapacity tosupport remoteauthentication
(likethepaymentserviceproviderinonlineshopping),whichen-
tailssaving credentialsof individualusers.While abetterscheme
may be possible for lightweight business models in the future (e.g.,
through some centralized service like Google DoubleClick), client-side tampering is a realistic and prevalent vulnerability. As shown
in the above examples, such vulnerabilities can lead to financial
ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea I Luk Kim, Yunhui Zheng, Hogun Park, Weihang Wang, Wei You, Yousra Aafer, and Xiangyu Zhang
loss.Ifsuchattackswerelaunchedatalargescale,websitesmay
go out of business. Hence, it is in websitesâ€™ best interest to identify
such vulnerabilities so that they can take action to secure their
interest, for example, by employing more expensive authentication
schemes,deployingon-the-flyattackdetectionon the server-side,
or even performing sophisticated client-side obfuscation.
Identifying Client-side Tampering Vulnerabilities Is Chal-
lenging. Client-sidecodeusuallycomesfrommultipleparties.In
addition, as suggested by the results in Table. 2, there are 8 ,307 JS
functionsonaverageinasinglepageload.Duetotheoverwhelming
size and complexities (i.e., JS dynamic features, code minimization,
and obfuscation) of the client-side code, it is impractical for de-
veloperstomanuallylocatethevulnerablepoints.Developingan
automated tool to expose such problems is necessary.
Therefore, we propose a dynamic search-based approach that
applies a set of pre-defined tampering operations on client-side JS
code. These tampering operations include enforcing branch out-
comes,skippingorrepeatingfunctions.Toreducethesearchspace,
we develop an analysis technique to identify JS code elements that
arelikelytobebusinesslogicrelatedandfocusontamperingthose.
In particular, we observe that client-side business operations areusually correlated to DOM mutations. Hence, we intercept such
eventsandcollectthecorresponding candidate JSfunctions.Todeal
withtheprominentdynamicfeaturesofJScode,ourtechniqueis
dynamic, modifying the underlying JS engine to instrument the
internal intermediate representations of JS code on-the-fly, instead
ofdirectlyinstrumentingJSsourcecode.Fortheaforementioned
Youtubeadbannercase,ourtechniqueselects159codeelements
as potential tampering candidates from 8,191 functions. The vul-
nerability disabling ad banners is identified after 10 trials. We have
reported such problem to developers along with the NYT case.
3 SYSTEM OVERVIEW
Fig.2providesanoverviewofourvulnerabilitydetectionprocedure,
whichcan be largely divided into three phases.
Siteinformationcollection .Byrecordingandinspectinguserin-
teractions,wecollectbasicinformationaboutthetargetedwebsites.
In particular, we identify DOM objects that should be monitored
formutationeventsandgeneratebrowsingautomationscriptsthat
allow automatic website navigation. They will be used as inputs to
the wholeprocedure. Details can be found in Sec. 4.1.Identify potential JS code elements to tamper with
. We ana-
lyze the website and generate candidates for tampering. In par-ticular, we monitor DOM mutation events and collect the corre-
sponding call stacks. By inspecting the functions on the stack, we
identifycandidatefunctionsthatmaybebusinesslogicrelated.The
candidatesarefurtherrankedbasedontheestimationhowlikely
theyarevulnerabletotamperingattacks.Foreachcandidate,we
generate potential tampering proposals that include the tampering
points and the corresponding tampering operations. We explain
the components and algorithmsin Sec. 4.2- 4.4.
Vulnerability scanning by tampering testing . We repeatedly
runthewebsitesaccordingtothegeneratedtamperingproposals
to filter out proposals that cannot lead to tampering attacks. In
ordertoreducemanualeffortstoconfirmiftheoutcomesarereal
attacks, we develop automated techniques to group test results,based on DOM event tracking and clustering. Instead of examining
alloutcomes,testersonlyneedtocheckonerepresentativefrom
eachcluster.Weproduceavulnerabilityreporttoexplaintheattack
for eachexploit. We explain the details in Sec. 4.5.
4 DESIGN
Inthissection,wedescribeeachcomponentindetailandreason
about our design choices.
4.1 Website Information Collection
Our system requires two pieces of information about the target
websitetostarttheprocedure:(a)identifiersofDOMobjectsthat
arerelatedtobusinesslogicand(b)browsingautomationscripts.
They are collected automatically by recording testersâ€™ interactions
withthe targetedwebsites. Inthe YouTubeexample discussedin
Sec.2,testerscanrecordbrowsingactivitiestoautomatetheopera-tionssuch asâ€œplayvideo".In themeantime,testers canalsospecify
elements or regions on the webpage that might be related to the
businesslogicbysimplyclickingabuttonprovidedbyourtool.OursystemautomaticallycollectsDOMselectorsthatidentifytheDOM
objects involved. Note that our technique does not require good
code coverage of the application. Any test case that triggers the
businessmodelissufficient.Duetotheessentialroleofbusiness
model,a typicaluse casewould easilycover it.Furthermore, such
manualeffortsareone-time.Ourtoolrecordstheuseroperationsinanautomaticscriptthatcanberepeatedlyexecutedinthescanning
phase. Hence, the manual efforts required are minimal.
4.2 IdentifyingPotentialBusiness Logic
Related Functions
As testers already specified their areas of interest on the web page,
weinterceptthemutationeventsontheDOMobjectsandcollect
the corresponding (asynchronous) call stack. Then, we consider
the functions onthe stack that aremore likely related tobusiness
logicandgivethemhighpriorities.Inparticular,whenmutation
eventssuchasattributeupdates,nodemodifications,orchildDOMtreechangeshappen,ahookfunctionwillbeinvokedtocollectthefunctioncalltracecontainingthefunctionsthatdirectly/transitively
trigger the changes. We exclude common JS libraries since they
are unlikely tampering vulnerability candidates. We remove them
using a whitelisting approach.
Notethatwemayobservedifferentcallstacksforthesamemuta-
tionevent.Wehenceconstructacalltree,bymergingthesamefunc-tionsinstacktracesthroughapreprocessingstep.TaketheYouTube
caseinFig.1(b)asanexample.Thefunctionâ€œ showAdâ€appearsin
twodifferenttraces.Ithastwodifferentcallees(â€œ showVideoAd â€and
â€œshowBanner â€)inthetwotraces.Theyarehencethetwochildren
of â€œshowAdâ€ in the call tree. All nodes in the call tree of a relevant
DOM mutationare considered candidates and given high priorities.
4.3 Dynamic Page Data Collection
In order to overcome the challenges introduced by JS dynamicfeatures, in this step, we collect runtime information about thecandidate functions obtained in the previous step. In particular,
we dynamically construct a Business Control Flow Graph (BCFG)
Finding Client-side Business Flow Tampering Vulnerabilities ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea
'!
!
(
  
!
"!!
) $    
!!
+ "   #
 !
"!$
!
* 
 !
"%
&    !     
!



  
# 
"!!!
	! 

 

	
Figure 2: Approach overview
  : 	 *+,
*"*$&++,

:. .%
*"*&++, ))(
	
*
:/%;&&%99+
*&+%
&*+$
&&	*+$
&&*+%
*':&+
&&*+%
-,))

:&%
*':## !+
&&*+$
	
 ))!
,
*+
&*+%
-
-
-
&*+$
"*+
-0
1
2
3
4
5
6
7
8
0/00
01
02
03
04
05
06
07
08
1/
10
11
12
13
14
(a)







	
	







	









(b)
Figure 3: Source code and Business Control Flow Graph
(BCFG)offunction showAdwitheachnoderepresentingaba-
sicblockwithauniqueidfollowedbythestatementsintheblock
for eachcandidate, which abstracts away path conditions that are
unlikelyto do with access control in business logic.
4.3.1 Business Control Flow Graph (BCFG). The abstraction fo-
cusesonprecludingpredicatesthatarenotrelatedtobusinesslogic
access control. Specifically, loop predicates are abstracted away as
we consider loop predicates are unlikely to perform access control.
While abstracting away loop predicates, we retain the loop body
which may contain important function calls. Note that BCFG is not
intended to be compiled and executed. It is more a representation
forustoenumeratethepossibletamperingschemes(calledtamper-
ing proposals). After abstraction, BCFG mostly contains the fol-
lowingconditionalstatements: if-then-else ,switch-case ,and
conditional ternary operator . A more heavy-weight analysis
(e.g.,onethatleveragesdata-flowanalysis)mayhavedifficultydeal-
ing with the various complex language features and the extremely
dynamicnature of JS code, and hence is less desirable.Example.
Fig.3adepictsasimplifiedversionofthefunction showAd
discussedintheYouTubemotivatingexample.Functionâ€œ showAdâ€
renders ads differently based on the ad types (e.g., video ads orbanner ads). At line 4, it checks the ad type (variable â€œ
a.oâ€) and
verifies if itâ€™s a banner ad. If so, the function resumes the player
(â€œa.dispatchEvent(e) â€ at line 7) and displays the banner ad by
invokingfunctionâ€œ a.o.start â€atline9.Otherwise,thefunction
plays the video ad by invoking function â€œ a.o.start() â€ at line 17.Table 1: Ten features for function ranking
IDFeatures of Candidate Function fn
F1Domainsimilaritybetween the website URL and fnâ€™s script URL
F2The loading order of the script containing fn
F3The number of appearance of fnamong all call stacks
F4The position of fnon its call stack
F5The collecting order of the call stack with fn
F6The lengthof the call stack with fn
F7The number of times fnis called
F8The number of times fnâ€™s callee is called
F9The number of branches in fn
F10 fnâ€™s callee directly mutates DOM (1: yes, 0: no)
Fig. 3b shows the BCFG of the function â€œ showAdâ€, where each box
represents a block of instructions and each arrow denotes control
flow.Inparticular,theexecutionpath( ğµğµ0,ğµğµ1,ğµğµ4andğµğµ6)rep-
resents the video ads delivery procedure. The yellow-colored block
ğµğµ6containsthefunctioncalllinkingtothenextfunctiononthe
callstack.Besides, ğµğµ6iscontrol-dependantonthegreen-colored
blocks (ğµğµ0,ğµğµ1andğµğµ4). Observe that the loop predicate at line
5 is abstracted away.
In addition to stack traces and BCFG, we collect DOM mutation
types,functionexecutionfrequencies,positionsinsourcecode,and
thesourceURL.Suchinformationisneededinthelaterscanning
phase. Note that we convert the position information (of a codeelement) in the row and column format (in the source code) toits IR offset used inside the JS engine as tampering is performed
bythe modifiedengine. Forexample, thepositionof functioncall
statement â€œ showAd(this) â€i nF i g .1i sâ€œ row:5, column:9 â€. We
convertittoâ€œ offset:89 â€with89theIRidentifierofthestatement.
4.4 Tampering Proposal Generation
WiththecalltreesofDOMmutationsandtheBCFGsofthefunc-
tionsinthecalltrees,thenextstepistogenerateasetoftampering
proposals that specify the code location to tamper with and the
tamperingoperation.Althoughthesefunctionsandpredicateshave
a higher priority compared to others, due to the large search space,
we develop additional techniques to further rank the functions and
predicates.Inparticular,wefirstrankfunctionsusingalearning-
basedmethod.ThentheBCFGsofrankedfunctionsaretraversed
in order to derive tampering proposals.
4.4.1 CandidateFunctionRanking. AswewillshowinSection5,
the number of functions in the call trees of DOM mutations is still
verylarge.Ideally,wewouldliketodevelopatechniquetodeter-
mine which of these functions are more likely to contain business
access control. However, a solely program analysis based solution
may not have the desirable effectiveness as runtime information
provides strong hints. For example, a business access control JS
ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea I Luk Kim, Yunhui Zheng, Hogun Park, Weihang Wang, Wei You, Yousra Aafer, and Xiangyu Zhang
file tends to be loaded before many other JSs; the function that
performsaccesscontroloftenhashighexecutionfrequencythan
the content delivery function guarded by the access control; the
URL of a business model related JS file tends to share common
domainnameasthemainpage,etc.Unfortunately,theseproper-
ties are uncertain and their importance is difficult to determine by
humans. Therefore we propose a learning-based method to predict
the likelihood of a function containing business access control. We
then rank the functionsbased on their likelihood.Featureselection.
Basedonourobservationofthepropertiesthat
arepossiblyimportant,we select10features,asshowninTable1.
Weusetamperinglocationswealreadyknow(inasmallnumber
of web applications) to evaluate the significance of the features.
To refine selected features, ANOVA F-test [ 30] was leveraged. The
null hypothesis of the test is that the feature takes the same value
independently of the output value to predict. As a result, highlysignificant features were chosen for our classification task. All
featuresarenormalizedindividuallybysubtractingthemeanand
scalingto the unit variance.Estimationof likelihood by learning a classifier.
After select-
ing features, a classifier is learned from the training data. As our
data may be biased, we explore using the Balanced Random Forest
(BRF) [14], the weighted-SVM (w-SVM) [ 10], and the weighted-
Logistic Regression (w-LR) [ 46], which are more interpretable than
other classifiers (e.g., neural networks) and more robust when they
have a small scale of training data. Balanced Random Forest (BRF)
isanensemble algorithmbyabalancedbootstrappingmethod.In
particular,weuse1,000asthenumberofestimators.Inaddition,the
gini impurity is used for split criterions. W-SVM (with RBF kernel)
and w-LR use the ratio of class labels in their cost functions and
putmoreweightontherarecasestoalleviatebias.Inthetesting
stage, probabilities or regression values are used to estimate the
likelihoods and are ranked by the scores.
To collect the training set for selecting features and learning
the classifier, we first prepare a few confirmed tampering cases.
Afterthe training,we keepusingthe trainedclassifierto rankthe
candidatefunctionswithoutany additionaltraining.The result ofthe feature selection and learning will be discussed in Sec. 5.3.3.
4.4.2 Tampering Proposal Generation. Tampering proposals are
generated by Algorithm 1. It takes two inputs: 1) the ranked candi-
datefunctions,whereeachfunctionhasitsabstractedBCFG,the
callsitetoitscalleesinthecalltree,andtheURLofthesourcecode.2)thetamperingstrategy ,whichcanbeeither bypassorrepeat.Intu-
itively,bypassskips a function call to see if the logic can be altered
inthedesiredway,whilethe repeatstrategygeneratesproposals
thatrepeatedly invoke the callee.
The output is a list of tampering proposals indicating where
and how the execution should be tampered with. In particular, a
tampering proposal consists of (1) the URL of the script containing
thecandidatefunction,(2)thesourcecode offsetofthetampering
point,(3)the branchindex,and(4)thetampering action.The branch
indexspecifiesabranchoutcomethatshouldbeenforced.Forex-
ample, a basic block ended with an ifstatement may have two
outgoing branches. If we want to execute the true branch next, we
assign0tothebranchindex.Otherwise,wesetthebranchindex
to1.Besidepredicates,wemayalsotamperwiththeexecutionofAlgorithm1 Tampering Proposal Generation
Input:
ğ¹:candidate functions sorted by the likelihood having tampering points. ğ‘“âˆˆğ¹
is a function with the BCFG, the call site to its callee on stack, and the URL of
thescripthaving ğ‘“.
ğ‘¡ğ‘ : thetamperingstrategy, which can be ğ‘ğ‘¦ğ‘ğ‘ğ‘ ğ‘ orğ‘Ÿğ‘’ğ‘ğ‘’ğ‘ğ‘¡
Output:
ğ‘‡:tamperingproposal (script_URL, offset, branch index, action) âˆˆğ‘‡
1:function GenerateTamperingProposals( ğ¹,ğ‘¡ğ‘ )
2:ğ‘‡â†[ ]
3:for each ğ‘“âˆˆğ¹do
//ğ‘“. ğ‘ğ‘ ğ‘™ğ‘™ğ‘ ğ‘–ğ‘¡ğ‘’ is the call site in ğ‘“to its callee on stack
4: coâ†GetOffset (ğ‘“. ğ‘ğ‘ ğ‘™ğ‘™ğ‘ ğ‘–ğ‘¡ğ‘’ )
5: ifğ‘¡ğ‘ isğ‘ğ‘¦ğ‘ğ‘ğ‘ ğ‘ then
6: ğ‘‡â†ğ‘‡âˆª(ğ‘“. ğ‘¢ğ‘Ÿğ‘™, co, none, â€œdisable callee")
7: ğµâ†GetControlDepBasicBlocks (ğ‘“. ğ‘ğ‘ ğ‘™ğ‘™ğ‘ ğ‘–ğ‘¡ğ‘’ )
8: foreachğ‘âˆˆğµdo
//ğ‘.ğ‘ğ‘Ÿğ‘ğ‘›ğ‘â„ _ğ‘ğ‘›ğ‘¡is the number of outgoing paths of basic block ğ‘
9: forğ‘–â†0toğ‘.ğ‘ğ‘Ÿğ‘ğ‘›ğ‘â„ _ğ‘ğ‘›ğ‘¡do
10: ifHasPath(ğ‘,ğ‘–,ğ‘“.ğ‘ğ‘ğ‘™ğ‘™ğ‘ ğ‘–ğ‘¡ğ‘’.ğ‘ğ‘ğ‘ ğ‘–ğ‘ _ğ‘ğ‘™ğ‘œğ‘ğ‘˜)then
// skip the existing path from ğ‘to the callsite
11: continue
// b.branching_stmt is the last stmt before branching in ğ‘.
12: bcoâ†GetOffset(b.branching_stmt)
// generate a non-existing path starting from b.branching_stmt
13: ğ‘‡â†ğ‘‡âˆª(ğ‘“. ğ‘¢ğ‘Ÿğ‘™, bco, i, â€œforce branch outcome")
14: foâ†GetOffset (ğ‘“)
15: ğ‘‡â†ğ‘‡âˆª(ğ‘“. ğ‘¢ğ‘Ÿğ‘™, fo, 0, â€œdisable caller") // disable function ğ‘“
16: else
// repeatedly invoke the callee of ğ‘“on stack
17: ğ‘‡â†ğ‘‡âˆª(ğ‘“. ğ‘¢ğ‘Ÿğ‘™, co, none, â€œrepeat callee")
non-predicatestatements.Inthiscase,theproposalsimplyspecifiesthelocationofthestatementwithoutthebranchindexinformation.
Theactionindicateshowtheexecutionshouldbetamperedwith
at a particular tampering point. The action can be disable callee,
disable caller, force branch outcome,o rrepeat callee. Details of each
actioncan be found in Sec. 4.5.1.
Foreachcandidatefunction ğ‘“,wefirstlocatethelocationswhere
ğ‘“invokes its callees observed on the stack (line 4). For example, in
Fig. 1(b), the invocation statement at line 5 is the call site wherefunction
g.h.start invokes its callee showAd. Although a candi-
date function may invoke multiple callees in the execution, weseparate them and create a trace for each invocation. Therefore,in our representation, a candidate function only has one call siteto its callee in a trace. Under the strategy bypass, we generate a
proposal that skips the invocation of the callee function (line 6).
Then, we obtain the basic blocks that the call site control-depends
on(line7),whereeachbasicblockreturnedhasanumberofoutgo-
ing branches (i.e. 2 branches for basic blocks with an ifstatement,
andğ‘›branchesfor basicblocks ended with a switch-case).
Nowwewanttogenerateproposalsthatfollowpathsthatare
differentfromtheoneonthestack.Todoso,wecheckifthecall
siteisreachablethroughaparticularpath.Amongthem,weskip
the path connecting the predecessor block and the call site (line
11). Since we want to explore the remaining paths even the path
conditions are not met, we generate proposals for such paths (line
13)so that we can force the branch outcome.
Thealgorithmalsocreatesaproposaltoskipexecutingtheentire
function ğ‘“(line15).Ontheotherhand,ifthegenerationstrategy
isrepeat, the algorithmcreates a proposal that repeatedlyinvokes
the callee function (line 17).
Finding Client-side Business Flow Tampering Vulnerabilities ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea
4.5 BusinessFlow Tampering Testing
Afterthetamperingproposalsaregenerated,weuseatesting-based
approach to confirm the real vulnerabilities. For each proposal, we
leverage the automated script (recorded in the earlier phase) to
load the target website. When the modified JS engine gets a script
specified by the tampering proposal, it mutates the bytecode IR
on-the-flyaccordingtotheactionspecifiedintheproposal.After
a batch of tests, we gather test results and cluster them based on
similarities.Finally,atesterconfirmsthesuccessofthetestingby
checking the clustered results, which are usually just a few screen
shots showing if the access control is circumvented. In this section,
we first discuss how our system manipulates the business flow.
Then,wedescribehow wefilter outtest resultsusing DOMevent
tracking and clustering techniques in order to minimize manual
efforts.
4.5.1 Tampering Actions. As mentioned before, there are four pos-
sible actions: disable callee, disable caller, forced branching, and
repeat callee. Next, we explain how they are supported.
Disablecallee. When the interpreter encounters the function call
expression specified by the tampering location, it skips the call.Disable caller.
We disable the bytecode generation for statements
inthefunction,whichisequivalenttogeneratinganemptyfunction.
This is because we still need the definition of the disabled function.
Otherwise, the interpreter may crash if the disabled function is
referredtosomewhere.Disablingcallercanbe beneficial because
it disables all function calls from other locations even not in thecall stacks we collected. For example, in Fig. 1(b), if the website
also plays the ad in the middle of playing the content, it can be
turnedoffbydisablingtheexecutionoffunction showAd,instead
ofdisablingall thefunctioncalls.Furthermore,callbackfunctions
triggered by native functions (e.g. event handler) or by external JS
libraries can only be disabled by this method since call statements
are not accessible.Forced Branching.
The branchingtarget is forcefully setregard-
less of the result of the predicate condition. However, we still inter-
pret the condition expression because it may have sub-operations
(e.g. function calls).
Repeat callee. Thistamperingactionisforduplicatingdesirable
behavior(e.g.gettingrewards)byrepeatedlyinvokingthefunction.
A naive approach to repeating callee would be to interpret the
function call statement twice. However, business logic normally
requiresnetworkinteractionbetweentheclientandwebservers.
So, it is very likely the duplicated requests without interval willbe ignored or considered as an error. We could add intervals by
callingthe sleepfunctionatruntimeintheJSengine.However,this
mayblockthesingle-threadedJSengineandsubstantiallyinterrupt
thenormalexecution.Tosolvethisproblem,weuse setTimeout
function and register the function to be repeated as a callback
functionof the timer event.
4.5.2 TestResultScreening. Afterfinishingeachtesttrial,weneed
tocheckifthetamperingproposalsuccessfullyalterstheoriginal
business flow in an intended way. Since our approach relies on
DOMchanges, asimplesolution istotrack theexistence ofDOM
mutationevents.FortheNYTexamplementionedinSec.2,iftheDOMmutationeventthatistriggeredwhendisplayingthesubscrip-
tion message box is reproduced in testing, this tampering proposal
is not successful. However, even if the DOM mutation event is not
triggered, it does not mean that this test trial succeeds for various
reasons.Forinstance,thetamperedexecutionmaystopshowing
thesubscriptionmessagebox,butitalsoblocksotherDOMobjects,
suchasthearticlecontent.Itisalsopossiblethattheeventisnot
triggered because the page is crashed. A more complex scenario is
thatthetextmessagedisappears,buttheblackboxstillexists.Since
there could be countless outcomes depending on web applications,
a testerâ€™s intervention is inevitable to make the final decision. In
order to minimize the manual efforts, we group test results using a
similarity-basedclusteringtechnique.Insteadofaskingtestersto
check every result, they can just check one in each cluster. Such
number is smaller according to our experiment in Section 5. Fur-
thermore,fortherestofthetestingbatches,thetesteronlyneedsto
checkwhenanewclusterisfound.Tobespecific,foreachtesttrial,
when the original DOM mutation event is not triggered, we take a
screenshot, get the corresponding HTML source code, and store as
a test result entry. After testing a batch of tampering proposals, wegroupthecollectedtestresultswithasimilarity-basedclusteringal-gorithm.WeusetheStructuralSimilarityIndexMethod(SSIM)[
41]
for screenshots, and Tree Edit Distance (TED) [ 45] algorithm for
HTML files to compute the structural similarity between DOM
trees. As a metric of the clustering algorithm, we combine the two
similarity scores since they complement each other. Specifically,
clusteringwiththeimagesimilaritymetricusuallygeneratesfine-
grained clusters especially if a screen changes frequently. In the ad
banner case from the motivating example, screenshots might vary
depending on the screenshot taking time since the video content is
being played; therefore, there would be many clusters. In this case,
DOMtreesimilaritymetricwouldreducethenumberofclusters
ifwecombine themtogether.Onthe otherhand,imagesimilarity
shows better performance if DOM structures change dynamically,
suchasafrontpageofnewspaperwebsitesloadingdynamiccon-
tents. As a clustering algorithm, we select Density-Based Spatial
Clustering of Applications with Noise (DBSCAN) [ 18]. The advan-
tage of DBSCAN is it does not require the number of clusters as an
inputunlikeotheralgorithmssuchask-means.Itisanimportant
factor since we do not have any clues about how many clusters
exist in the test results.
Note that we do not need this step for the ğ‘Ÿğ‘’ğ‘ğ‘’ğ‘ğ‘¡tampering
strategy,instead,wecansimplycheckiftheoriginalDOMmutation
event is triggered after the specified timeout.
5 EVALUATION
5.1 Implementation
Our system1is implemented in Python and Node.js, and the modi-
fied JS engine isbased on V8 6.6.74. The testingmodule leverages
thePuppeteerlibrary[ 4],whichprovideshigh-levelAPIstocontrol
Chromium over the DevTools Protocol[ 2]. To collect dynamic data
andperformthebusinessflowtamperingtesting,weinstrumentthe
targetJScodebymodifyingV8engine[ 6]inChromium.Inparticu-
lar,theinstrumentationworksasfollows:oncetheV8engineloads
1We plan to make our system available at https://github.com/yirugi/JSFlowTamper
ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea I Luk Kim, Yunhui Zheng, Hogun Park, Weihang Wang, Wei You, Yousra Aafer, and Xiangyu Zhang
Table 2: Statistics of websites from 5 categories
CategoryTotal JS
Size(KB)#o fJ S # of Functions # of Branches
Newspapers 6,313 451 11,403 9,700
Magazine 4,334 258 8,046 6,884
OnlineMedia 4,761 240 7,902 6,737
SurferRewards 2,521 132 3,931 3,330
Travel 4,402 220 7,031 5,854
Average 4,814 281 8,307 7,049

%! ! ' 
#  
% ! $ "	$

!"
"
 &"
"
  !"
Figure 4: Normalized execution overhead
a scriptfile,an Abstract SyntaxTree (AST) isbuilt for eachfunc-
tionandfurthertranslatedtobytecodebythebytecodegenerator.
Wemodify InterpreterCompilationJob classtogenerateBCFGs
forJS functionsafter theASTsare built.The BytecodeGenerator
classisalsomodifiedtocollectdynamicdataandmutateexecution.
Comparing to code rewriting approaches [ 44], we modified the JS
enginebecauseitbringsinadditionalbenefits.First,itcaneasily
handle dynamically generated codes as well as other sophisticated
code modification techniques discussed in Sec. 2. Second, it has
fewer side-effects. For example, it can work with code integrity
checkingtechniques(e.g.,SubresourceIntegrity(SRI)features[ 7]).
5.2 Research Questions
Weinvestigatethefollowingresearchquestionsinordertoevaluate
the effectiveness of our system:RQ1.How much overhead does our system introduce?
RQ2.
Howmanyreal-worldbusinessflowtamperingvulnerabilities
can our systemfind?RQ3.
Howwelldoweestimatethelikelihoodofvulnerablefunc-
tions?Inparticular,whataretheresultsofthefeatureselectionand
the learning algorithm?RQ4.How effective are tampering testing and result screening?
RQ5.How effective is our system on reducing search space?
Toanswertheseresearchquestions,werunoursystemon200
real-worldwebsites.Thewebsitesarecollectedfrom5differentcat-egoriesinAlexaTop500sincetheyusethemostcommonbusiness
models, such as advertisement, paywall, and point reward.
5.3 ExperimentalMethodologyandResults
5.3.1 RQ1:PerformanceOverhead. Table 2 shows the benchmark
statisticsclustered by categories. On average,8 ,307functionscan
be observed in a single page load, which points to the needs of our
approach.Wemeasurethreekindsofoverhead,thefirstoneisto
collectthestacktraceofDOMmutationevents,thesecondiscaused
bytheinstrumentationtocollectdynamicpageinformationsuch
asfunctionexecutionfrequencies,andthethirdisthetamperingTable 3: Result of our testing on 200 websites
Case
No.Website T.A.*Vulnerable
OperationCase
No.Website T.A.*Vulnerable
Operation
C-01 BostonGlobe DCEPaywallC-14 CNBC DCE
Anti-AdblockC-02 NYTimes DCE C-15 CWTV FE
C-03 CWTV DCE Video Ad C-16 CBS FE
C-04 FoxNews DCEAnti-Adblock C-17 SeattleTImes DCE
C-05 NewsWeek DCROffer
NotificationC-18 MiamiHerald DCE
C-19 DenverPost DCE
C-06 CBS DCR
Video AdC-20 ETOnline DCE
C-07 Youtube FE C-21 AMC DCE
C-08 ETOnline DCE C-22 DallasNews DCE
Paywall C-09 AMC FE C-23WashingtonPost FE
C-10CartoonNetwork FE C-24ChicagoTribune DCE
C-11 Fox FEOffer
NotificationC-25 Youtube DCE
Etc C-12 PCMag FE C-26 HBO FE
C-13Business-Standard DCE C-27 Inboxdollars RC
T.A: Tampering Action*: FE = Forced Branching, DCE = Disable Callee, DCR = Disable Caller, RC = Repeat Callee
testingoverhead.Toreducenon-determinismcausedbydynamic
pagecontent(e.g.,ads),wecrawlthepagesandresourcestoalocal
directory, and then load the local pages and resources with and
withoutourtechnique.Theformerisconsiderthebaseline.Werun
eachofthe200websites10timesandaveragetheexecutiontime.
Fig.4depictsthenormalizedoverhead.Thefirst5setsofbarsshow
the overhead observed in each category and the last set denotesthe average overhead. The overhead for the call stack collection
step is 2.41% (90ms) on average. We observed the average number
of DOM mutation events triggered during page loading is 60.55.Hence, the overhead of handling one mutation event is around
1.5ms. Similarly, the overhead for dynamic page data collection
step is 1.39% (70ms). We do not measure the overhead of executing
tamperingproposalsforall200websitesasitcausesexceptionsand
early termination in many cases, skewing the real overhead. From
the cases that terminate normally, the average overhead is 0.53%
(4ms)which is lower than dynamic page data collection.
5.3.2 RQ2: Effectiveness in Finding Vulnerability. Our technique
discovers27vulnerablecasesfrom23websitesasshowninTable3.
The first and the fifth columns show the case number while the
secondandthesixthcolumnsdescribethewebsite.Thethirdand
theseventhcolumnsindicatethetamperingaction,andthelastones
contain the vulnerable businesslogic. Observe many websites are
mainstream content publishers. We use the first 5 cases to produce
thetrainingsetforthefunctionrankingmodel.Afterwetrained
the classifier, we found 22 more cases. Besides the NYT case in the
motivationsection,wefound4morevulnerablepaywallsystems(C-
01,02,and 22 - 24). Instead of using paywall, some websites show
an offer notification popup at the front page. We found 4 cases
thattheofferpopupcanbedisabled(C-05,and11-13).Fromthe
websitesinonlinemediacategory,mostofthefindingsareabout
skipping the ads before or in the middle of video playing (C-03,
and 06 - 10). We also try to tamper with the protection method for
theirad-relatedbusinesslogicagainstadblockers.Wefound9cases
(C-04, and 14 - 21) in which the anti-adblock techniques can be
bypassed.Youtubeshowsadbannersinthemiddleofvideoplaying,
and this can be skipped by disabling callee (C-25). HBO prompts a
usertoprovidepersonalinformationinordertowatchfreeepisodes
right before video starts. This can be skipped by forced branching
(C-26). Inboxdollars gives points to users at the end of watching a
video.Our systemfounda wayto repeat therewarding operation
using the repeat callee tampering action (C-27). We have uploaded
Finding Client-side Business Flow Tampering Vulnerabilities ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea
Table 4: Function ranking with classifiers
(a)
Case No.Avg. Rank of Func.
w/ Tampering Point
w-LRw-SVM BRF
C-01 3.5 13.22.1
C-02 26.1 16.213.4
C-03 4.4 5.76.3
C-04 1.4 5.21.8
C-05 21.51.1
Average 7.48 8.364.94(b)
Case
No.Rank of Func. w/
Tampering PointCase
No.Rank of Func. w/
Tampering Point
BRFRandom BRFRandom
C-06 1 82.5C-17 3 10.4
C-07 4 90.4C-18 1 3.8
C-08 8 47.4C-19 1 9.3
C-09 1 31.4C-20 9 46
C-10 6 25.2C-21 4 69.5
C-11 5 19.4C-22 1 7.1
C-12 1 4.3C-23 2 63.2
C-13 3 4.6C-24 1 9.1
C-14 1 5.6C-25 1 3.5
C-15 1 8.5C-26 2 12.3
C-16 8 26.3C-27 11 12.4
Average 3.41 26.92
demosofourfindings(recordedscreensofthesuccessfultampered
cases)toaprivatewebsite2.Weonlyusethesefindingsforresearch
purpose. We have responsibly reported the vulnerabilities to the
victim websites and are in communication with them for possible
defensesolutions.
5.3.3 RQ3: Feature selection and learning algorithm. We use candi-
datefunctionsfromthefirst5casesinTable3asthetrainingset.
For these cases, we test every tampering proposals. If a vulnera-
bility is found, the candidate function containing the tampering
proposal is marked as a positive sample. The others are marked as
negativesamples.Attheend,weacquire56positivesamplesand
402negativesamples.Usingthetrainingset,weperformthefeature
selection process for the 10 features in Table 1. We conduct the
ANOVA test to find out which features are significant. As a result,
thefirst5featureswhosep-valueislessthan0.1areselected(F1,
F4,F5,F7,andF8).Next,inordertocheckwhichlearningalgorithm
worksbestforourscenario,wetested3classifiersdiscussedinSec-
tion4.4.1usingthetrainingsetwiththe5websites.Inparticular,
we learn each classifier on 3 randomly picked websites and test
them on the rest of the websites for its cross-validation. In orderto evaluate the learned models, we order candidate functions foreach website based on the likelihood scores and got the rank of
thefirstfunctioncontainingtherealvulnerability.Weperformthis
evaluation test 10 times, then calculate the average rank values,and Table 4a describes the results of the 3 classifiers, as a result,
BRF shows the best average rank value.
Table 4b shows the function ranks of the 22 successful cases we
findafterweapplythetrainedclassifiers(BRF).Inordertoevaluate
its efficacy, we also select functions 10 times randomly, then getthe averaged rank of functions containing the real vulnerability.
As we can see in the table, the rank values with the classifier show
significantly better performance than the random method. In 10 of
the22cases,wefindthevulnerabilityatthefirstcandidatefunction
using the ranking.
5.3.4 RQ4: Effectiveness of Tampering Testing and Result Screening.
Table 5 shows the effectiveness of tampering testing and test result
screening.Thesecondcolumnshowsthetotalnumberoftampering
proposals. The third column describes the number of tests until
we find a successful case. The last two columns show the effects
ofthetestresultscreening,thenumberoftestresultsafterDOM
2https://sites.google.com/view/tampering-cases/Table 5: Function ranking and screening results
Case
No.#o fT . P .# of Tests
to Success# of Results
afterE.S.# of Results
afterClustering
C-01 264 170 32 4
C-02 191 150 107 17
C-03 176 90 42 16
C-04 150 20 13 4
C-05 208 10 8 2
Average 197.80 88.00 40.40 8.60
C-06 486 10 10 4
C-07 281 20 8 3
C-08 440 20 16 2
C-09 99 10 10 3
C-10 460 20 12 2
C-11 45 20 14 6
C-12 209 10 8 4
C-13 93 10 3 1
C-14 66 10 10 3
C-15 211 10 5 3
C-16 225 50 27 3
C-17 173 10 2 1
C-18 35 10 4 1
C-19 623 10 10 1
C-20 722 20 18 4
C-21 113 10 7 2
C-22 53 10 1 1
C-23 529 10 7 2
C-24 933 10 10 3
C-25 159 10 2 2
C-26 57 10 6 3
C-27 42 19 - -
Average 275.18 14.50 9.05 2.57
T.P.: Tampering Proposal, E.S.: Event-based Screening
event-basedscreening,andthenumberofresultsaftersimilarity-
based clustering. The last column also indicates that the number ofresultsrequiringatesterâ€™sconfirmation.Inthisexperiment,wetest
10 tampering proposals in one batch. As we mentioned, the first 5
cases are collected from randomly picked candidate functions, and
the rest 22 cases are found with the help of the candidate function
ranking method. In the first 5 cases (C-01 to C-05), the numbers of
tests vary from 10 to 170. The worst case is almost 80% of the total
tampering proposals (C-02), and on average, we test around 50% of
thetamperingproposals.Theclusteringandscreeningsignificantlyreducemanualeffortssuchthattestersonlyneedtocheck8results
on average, in comparison to the hundreds proposal executions. In
the 22 cases found later (C-06 to C-27), the number of tests needed
toexposetherealvulnerabilitiesistremendouslyreducedusingthefunctionrankingmethod.Theaverageis14.50,whichisonly5%ofthetotaltamperingproposals.Becauseofthereduction,testersonlyneedtocheck2.57resultsonaverage.Inaddition,weinvestigatethe
casesthatdonothavevulnerabilities, andweobservethat testers
have to check 27.93 clusters on average. As checking a cluster is as
simple as inspecting a screenshot, we consider such manual efforts
are manageable.
5.3.5 RQ5:EffectivenessinReducingSearchSpace. Inordertore-
ducesearchspace,wecollectcallstacksbyobservingDOMmuta-
tion events, and we remove redundant functions and those from
JS libraries. Moreover, the functions have zero call count during
dynamicdatacollectionarealsoremovedinthetamperingproposalgeneration.Toevaluatetheeffectivenessofourfilteringmethod,we
collect statistics for the 27 successful cases. Specifically, we collect
thetotalnumberof3typesofdata(JSfiles,functions,andbranches)
ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea I Luk Kim, Yunhui Zheng, Hogun Park, Weihang Wang, Wei You, Yousra Aafer, and Xiangyu Zhang
	

	



	



	


#
 
 "! 
  
Figure 5: Effectiveness in reducing search space
!#"$!
&"$!
+&+"%
" #=$#"!#"$!* 
 ./0
+++
.''#"+ 


 /0
.#!$>>>+""/0
>-3 
3*33)
1
	


")
105*6*7*
8*
9*:*
;*
<*=*
#"#
#* 
 .,/0
,>+$#+ 
	 .3"! #3/(
+	 .33(
 ./0
#.+
	 .++2(
++2	2	(+++//
1/(+	 .3!!!3(
 ./0
#.+
	 .++(
++	2	(+++//
1/(+$#+&+ 	 ./)5*6*
7*
8*
9*:*
;*
<*=*
54*55*56*
	

 !#"$!
	

 #"#
#
Figure 6: Bypassing adblock detection in cbs.com
we have to consider before and after filtering. Fig. 5 shows the nor-
malized numbers of each data types from 27 cases, and the last bar
denotestheaveragenumber.Aswecansee,wecouldreducethe
number of each data type substantially. For instance, we need to
investigate18,658functionswithoutfilteringifwewanttofindthe
case C-22. However, after filtering, there are only 84 functions left,
and this is only 0.45% of the original number. On average, we only
needtoinspect3.18%oftheJSfiles,1.31%ofthefunctions,or2.13%
of the branches of those in the original execution.
5.4 CaseStudy
In this section, weshow two case studies to demonstratehow our
systemfindsthe business flow tampering vulnerabilities.
5.4.1 Bypassing Adblock Detection. The website we use in this
case study (C-16) is cbs.com which is one of the biggest television
networks in the US. They provide the subscription-based online
streamingservice,andsomeoftheirepisodescanbewatchedfor
free with video ads fromsponsors. They also protect their business
logic using the anti-adblock technique. If a user tries to watch a
freeepisodewithanadblocker-enabledwebbrowser,thewebsite
blocks the actualcontents witha warning message.
Inordertofindiftheiranti-adblockertechniquecanbebypassed
using our system, we collect call stacks by tracking the warningmessage. After preprocessing, we have 95 functions, which areonly0.86%ofthetotal functionsonthe page.Thereare225 totaltampering proposals, and after 5 batches, which is 50 trials, wefoundthevulnerability.Notethatafterthescreening,only3test
results required a manual check.
%


%


%


 !"#

!"#
			
$
		 !	"
! "#
&'(
)
*+
,
	

 


	
	

 !"#

!"#
			
					
$
		 !	"
! "#
&'(
)
*+
,
-
Figure 7: Repeating point reward in inboxdollars.com
To analyze how our system found the success case, we checked
the vulnerability report. Our system found the tampering location
infunction createResourceConfig .Itscallstackandcodesnippet
aredescribedinFig.6(a)and(b).Itchecksthepresenceofadblocker
using checkForAdBlocker (line3),anditcalls dispatchAdBlocked
to show the warning message (line 7). If we follow the function
checkForAdBlocker , the function testMethod in Fig. 6(c) tries to
inject a script containing " ğ‘ğ‘‘" string in its url (line 12) since the
adblock applications usually block those scripts. The tamperingproposal that forces the false branch of the if statement at line 3
succeeds.Asshown,oursystemsuccessfullyfoundawaytobypass
the anti-adblocker technique. With the tampered business flow,
userscanwatchfreeepisodeswithoutwatchingvideoads,andthis
would affect the business model of the website.
5.4.2 Repeating Point Reward. Inboxdollars (C-27) is an online
marketing company that connects consumers and advertisers, and
consumers can earn cash rewards for engaging in a variety of web
activities.Accordingtotheirwebsite,totalcashpaidtomembers
surpasses$50millionin2016[ 3].Oneoftheservicestheyprovide
is video reward; they offer points after a user watches a video con-
tainingad.Tobespecific,whenavideoplayerreachestheendof
the video, it increases a progress bar indicating the current reward
status. In this case, we tried to repeat the rewarding activity. In
ordertostarttesting,wefirstrecordedbrowsinginteractionsfor
logginginandclickingaplaybutton,thengatheredaDOMiden-
tifierbyselectingtheprogressbar.Thetotalnumberoffunctions
that appeared during testing is 12,642, and we could reduce it to 27
whichisonly0.21%ofthetotalnumber.Oursystemsuccessfully
found the tampering location with 19 trials out of 42 tampering
proposals.AswediscussedinSection4.5.2,itdidnotrequirethe
manual work to check the success case.
Fig.7illustratesthecallstackandthecodesnippetofthefunc-
tiondoOnBeforeComplete thathasvulnerability.Specifically,when
thevideo isfinished, theplayercalls thefunction ended,then the
function triggercallsthefunction doOnBeforeComplete .Inthe
function,itfirstchecksifthevideohasfinished(line2).Ifso,itcalls
thefunction SC_increaseProgress(1) tosendarewardrequest
toitsserveraswellastoincreasetheprogressbar.Inordertore-
peatthecall,themodifiedJSenigneaddedthesetTimeoutfunction
containing the name of the function and a parameter, indicating
thefunctionwillbecalledafter5,000msec.Usingthisvulnerability,
we could get multiple rewards after watching a single video. As
Finding Client-side Business Flow Tampering Vulnerabilities ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea
mentioned,therewardedpointscanbeexchangedtoactualcash.
This directly causes financial damage to the website. We were able
to stack $3.44 reward points for an hour attack with a single ma-
chine, and if we continue this attack, we would get around $80 per
day. We did not exchange the points we got from the vulnerability,
andweareincommunicationwithInboxdollarssothattheycan
deploy defense mechanism.
6 THREATS TO VALIDITY
Thereareanumberofthreatstothevalidityofourconclusion.Part
of our technique (i.e, function ranking) requires training. Although
ourtrainingtaskisquitesimplewithwelldefinedfeatures,weonly
use 458 training samples. While the training set and the test set
arestrictlyseparatedandourresultsindicatetheeffectivenessof
the trained model, it may be possible that the training set is notrepresentative and hence the ranking model may not be optimal.
We will study the effect of including more cases in the training
set in our future work. Our results are only acquired on 200 top-ranked websites as our technique is heavyweight testing-based,
requiringprocessingthousandsofdynamicallyloadedJSfilesand
substantial dynamic contents. It is possible that these 200 websites
are not representative. We plan to test on more websites. Checking
thefinalresultsrequires humanefforts.Itispossiblethatwemay
misssomerealvulnerabilities.Wecurrentlyonlysupportsimpletampering operations, which may not disclose complex business
model flaws.
7 RELATED WORK
Our work builds on extensive previous work on automatically test-
ingwebapplicationsforvulnerabilities.Webrieflydescriberelevant
approaches, as well as previous works that detect business logic
vulnerabilitiesin web applications.
Multiplepathexecution. Our work shares some similarity with
recent work to explore execution paths by forcing program exe-
cution on JS programs [ 21], native binary programs [ 28], mobile
apps[16,20],andkernelrootkits[ 42].Forcedexecutionwasfirst
proposed in [ 42], which brute-forces control-flow at branches to
exploreprogrampaths.X-Force[ 28]movesforwardbydesigninga
crash-freeengine.Inourwork,forcingbranchoutcomeisoneof
thetamperingactions.However,ourtechniqueaddressesamuch
broader problem. Guided mutation testing for JS web applications
developsgenericmutationtestingapproachesbasedoncommon
mistakes made by JS programmers [ 23,24]. Our technique mutates
placesspecifictobusinessmodels.Itfeaturessophisticatedmethods
to narrow down the candidates of such mutation. Symbolic andconcolic execution based techniques [
22,31â€“33] have also been
proposedtoanalyzeJSprograms.Despitetheirgreatpotential,han-
dlingsubstantialdynamicfeatures in complex websites remains a
challenge.
Business logic vulnerability detectors. Recently, researchers
have proposed a number of techniques to test web applications for
business logic vulnerabilities [ 15,17,19,27,35,36,39,40]. These
techniques focus mostly on the detection of web-based single sign-
onsystemsandthird-partypaymentsystems.Wangetal.arethe
first to analyze logic vulnerabilities on merchant websites [ 40],
and[39]studiedlogicflawsonpopularwebsinglesign-onsystems.ThesetechniquesfollowanAPI-orientedmethodologythatdissects
the workflow in a particular application by examining how indi-
vidual parties affect the arguments of related API calls. Sun et al.
proposesastaticdetectionoflogicvulnerabilitiesine-commerce
webapplicationsbycombiningsymbolicexecutionandtaintanaly-
sistodetectinvariantviolationsofcorrectpaymentlogic[ 36].[15]
proposesanapproachtoinvokingstaticverificationofthesafety
property of multiparty online services.Dynamic JS code analysis.
Dynamic analysis is commonly used
to deal with the highly dynamic nature of JS applications. [ 25]
builds a call graph on client-side codes embedded in server-sidecodes as string literals. It handles all possible client-side JS code
variationbysymbolicallyexecutingserver-sidecode.AjaxRacer[ 9]
detects AJAX event race errors in JS web applications by testing
pairs of user events that are potentially AJAX conflicting. [ 43]
proposesadynamicslicerprovidingacomprehensiveanalysisto
identifydata,control,andDOMdependenciesforclient-sideJScode.
ConfictJS [ 26] finds conflicts between JS libraries by identifying
potentially conflicting libraries and testing them with generated
clientapplicationsthatmaysufferfromthecorrespondingconflicts.
8 CONCLUSION
We present a novel dynamic analysis approach that scans web
applications and automatically detects client-side business flow
tampering vulnerabilities. We overcome technical challenges that
hinder the detection process to make the technique practical. Our
evaluation shows that our method has small overhead, and discov-
ers27uniquevulnerabilitiesinpopularwebsites,whichallowan
adversary to interrupt the business logic of web applications such
asskippingadsatthebeginningofvideos,bypassingadblocking
checking and even illicitly earning reward points.
In the future, we will further investigate our approach by cal-
culatingprecisionandrecallmetricsforknownvulnerabilitiesso
that we can show more accurate coverage evaluation results for
possible missing cases.
ACKNOWLEDGMENTS
We thank the anonymous reviewers for their constructive com-
ments. This research was supported, in part by DARPA FA8650-15-
C-7562,NSF1748764,1901242and1910300,ONRN000141410468
andN000141712947,andSandiaNationalLabunderaward1701331.
Any opinions, findings,and conclusionsin this paper are those of
the authors only and do not necessarily reflect the views of our
sponsors.
REFERENCES
[1][n.d.]. BusinessFlowTamperingSuccessCases. https://sites.google.com/view/
tampering-cases.
[2][n.d.]. ChromeDevToolsProtocol. https://chromedevtools.github.io/devtools-
protocol/.
[3][n.d.]. InboxDollars - about us. http://corporate.inboxdollars.com/about-us/
company/.
[4] [n.d.]. Puppeteer. https://pptr.dev/.
[5] [n.d.]. Security Token. https://en.wikipedia.org/wiki/Security_token.[6] [n.d.]. V8 JavaScript engine. https://v8.dev/.[7]
2016. W3CRecommendation-SubresourceIntegrity. https://www.w3.org/TR/
SRI/.
[8]2019. OWASP AJAX Security Cheat Sheet. https://github.com/OWASP/
CheatSheetSeries/blob/master/cheatsheets/AJAX_Security_Cheat_Sheet.md#
dont-rely-on-client-business-logic.
ICSE â€™20, May 23â€“29, 2020, Seoul, Republic of Korea I Luk Kim, Yunhui Zheng, Hogun Park, Weihang Wang, Wei You, Yousra Aafer, and Xiangyu Zhang
[9]Christoffer Quist Adamsen, Anders MÃ¸ller, Saba Alimadadi, and Frank Tip. 2018.
Practical AJAX race detection for JavaScript web applications. In Proceedings of
the201826thACMJointMeetingonEuropeanSoftwareEngineeringConference
andSymposiumon the Foundations of Software Engineering . ACM, 38â€“48.
[10]Rehan Akbani, Stephen Kwek, and Nathalie Japkowicz. 2004. Applying support
vector machines to imbalanced datasets. In European conference on machine
learning. Springer, 39â€“50.
[11] JuliaAlexander. 2018. YouTube Premium is changing because it has to.
https://www.theverge.com/2018/11/29/18116154/youtube-premium-free-ads-
subscription-red.
[12] JanBiniok.2019. Tampermonkey project homepage.
https://tampermonkey.net/.
[13] Aaron Boodman. 2019. Greasemonkey project homepage.
https://www.greasespot.net/.
[14]ChaoChen, AndyLiaw, and Leo Breiman. 2004. Using random forest to learn
imbalanced data. Tech. Rep (2004),1â€“12.
[15]Eric Y Chen, Shuo Chen, Shaz Qadeer, and Rui Wang. 2015. Securing multiparty
online services via certification of symbolic transactions. In Security and Privacy
(SP),2015IEEESymposiumon . IEEE, 833â€“849.
[16]Zhui Deng, Brendan Saltaformaggio, Xiangyu Zhang, and Dongyan Xu. 2015.
iris: Vetting private api abuse in ios applications. In Proceedings of the 22nd ACM
SIGSAC Conference on Computer and Communications Security. ACM, 44â€“56.
[17]Adam DoupÃ©,Bryce Boe, ChristopherKruegel, andGiovanni Vigna. 2011. Fear
theEAR:discoveringandmitigatingexecutionafterredirectvulnerabilities.In
Proceedingsofthe18thACMconferenceonComputerandcommunicationssecurity .
ACM, 251â€“262.
[18]MartinEster,Hans-PeterKriegel,JÃ¶rgSander,XiaoweiXu,etal .1996. Adensity-
based algorithm for discovering clusters in large spatial databases with noise.. In
Kdd, Vol. 96. 226â€“231.
[19]Daniel Fett, Ralf KÃ¼sters, and Guido Schmitz. 2014. An expressive model for the
Web infrastructure: Definition and application to the Browser ID SSO system. In
Security and Privacy (SP), 2014 IEEE Symposium on. IEEE, 673â€“688.
[20]Ryan Johnson and Angelos Stavrou. 2013. Forced-path execution for android
applications on x86 platforms. In Software Security and Reliability-Companion
(SERE-C),2013IEEE7thInternationalConferenceon . IEEE, 188â€“197.
[21]Kyungtae Kim, I Luk Kim, Chung Hwan Kim, Yonghwi Kwon, Yunhui Zheng,
XiangyuZhang,andDongyanXu.2017.J-force:Forcedexecutiononjavascript.In
Proceedings of the 26th international conference on World Wide Web . International
World Wide Web Conferences Steering Committee, 897â€“906.
[22]Clemens Kolbitsch, Benjamin Livshits, Benjamin Zorn, and Christian Seifert.
2012. Rozzle: De-cloaking internet malware. In 2012 IEEE Symposium on Security
andPrivacy. IEEE, 443â€“457.
[23]Shabnam Mirshokraie, Ali Mesbah, and Karthik Pattabiraman. 2013. Efficient
JavaScriptmutationtesting.In SoftwareTesting,VerificationandValidation(ICST),
2013IEEESixthInternationalConferenceon . IEEE, 74â€“83.
[24]Shabnam Mirshokraie, Ali Mesbah, and Karthik Pattabiraman. 2015. Guided
mutationtestingforjavascriptwebapplications. IEEETransactionsonSoftware
Engineering 41,5 (2015), 429â€“444.
[25]HungVietNguyen,ChristianKÃ¤stner,andTienNNguyen.2014. Buildingcall
graphsforembeddedclient-sidecodeindynamicwebapplications.In Proceedings
ofthe22ndACMSIGSOFTInternationalSymposiumonFoundationsofSoftware
Engineering. ACM, 518â€“529.
[26]Jibesh Patra, Pooja N Dixit, and Michael Pradel. 2018. Conflictjs: finding and
understandingconflictsbetweenjavascriptlibraries.In Proceedingsofthe40th
InternationalConferenceon Software Engineering . ACM, 741â€“751.
[27]Giancarlo Pellegrino andDavide Balzarotti. 2014. Toward Black-Box Detection
of Logic Flaws in Web Applications.. In NDSS.
[28]FeiPeng,ZhuiDeng,XiangyuZhang,DongyanXu,ZhiqiangLin,andZhendong
Su.2014. X-Force:Force-ExecutingBinaryProgramsforSecurityApplications.
InProceedings of the 23rd USENIX Security Symposium, San Diego, CA, USA,
August 20-22, 2014., Kevin Fu and Jaeyeon Jung (Eds.). USENIX Association, 829â€“
844. https://www.usenix.org/conference/usenixsecurity14/technical-sessions/
presentation/peng
[29] PeterPreston. 2011. A paywall that pays? Only in America.
https://www.theguardian.com/media/2011/aug/07/paywall-that-pays-only-in-
america.
[30]Yvan Saeys, IÃ±aki Inza, and Pedro LarraÃ±aga. 2007. A review of feature selection
techniques in bioinformatics. bioinformatics 23,19 (2007), 2507â€“2517.
[31]Prateek Saxena, Devdatta Akhawe, Steve Hanna, Feng Mao, Stephen McCamant,
andDawnSong.2010. Asymbolicexecutionframeworkforjavascript.In Security
andPrivacy(SP),2010IEEESymposiumon . IEEE, 513â€“528.
[32]Koushik Sen, Swaroop Kalasapur, Tasneem Brutch, and Simon Gibbs. 2013.
Jalangi:aselectiverecord-replayanddynamicanalysisframeworkforJavaScript.
InProceedingsofthe20139thJointMeetingonFoundationsofSoftwareEngineering.
ACM, 488â€“498.
[33]Koushik Sen, George Necula, Liang Gong, and Wontae Choi. 2015. MultiSE:
Multi-path symbolic execution using value summaries. In Proceedings of the 2015
10thJointMeeting on Foundations of Software Engineering. ACM, 842â€“853.[34]Garett Sloane. 2018. YouTube is now showing ad-supported Holly-
wood movies. https://adage.com/article/digital/youtube-starts-showing-free-
hollywood-movies-ad-breaks/315631/.
[35]Avinash Sudhodanan, Alessandro Armando, Roberto Carbone, Luca Compagna,
etal.2016. AttackPatternsforBlack-BoxSecurityTestingofMulti-PartyWeb
Applications..In NDSS.
[36]FangqiSun,LiangXu,andZhendongSu.2014. DetectingLogicVulnerabilities
in E-commerce Applications.. In NDSS.
[37] TheNew York Times. 2019. Breaking News, World News & Multimedia.
https://www.nytimes.com/.
[38]Jordan Valinsky. 2016. Some Adblock Plus users are reporting problems with
YouTube.
https://digiday.com/social/youtube-adblock-problems/.
[39]RuiWang,ShuoChen,andXiaoFengWang.2012. Signingmeontoyouraccounts
throughfacebookandgoogle:Atraffic-guidedsecuritystudyofcommercially
deployed single-sign-on web services. In Security and Privacy (SP), 2012 IEEE
Symposium on. IEEE, 365â€“379.
[40]Rui Wang, Shuo Chen, XiaoFeng Wang, and Shaz Qadeer. 2011. How to Shop
for Free Onlineâ€“Security Analysis of Cashier-as-a-Service Based Web Stores. In
Security and Privacy (SP), 2011 IEEE Symposium on. IEEE, 465â€“480.
[41]Zhou Wang, Alan C Bovik, Hamid R Sheikh, and Eero P Simoncelli. 2004. Image
qualityassessment:fromerrorvisibilitytostructuralsimilarity. IEEEtransactions
on image processing 13,4 (2004), 600â€“612.
[42]Jeffrey Wilhelm and Tzi-cker Chiueh. 2007. A Forced Sampled Execution Ap-
proach to Kernel Rootkit Identification. In Recent Advances in Intrusion Detection,
10th International Symposium, RAID 2007, Gold Goast, Australia, September 5-
7, 2007, Proceedings (Lecture Notes in Computer Science), Christopher KrÃ¼gel,Richard Lippmann, and Andrew J. Clark (Eds.), Vol. 4637. Springer, 219â€“235.
https://doi.org/10.1007/978-3-540-74320-0_12
[43]Jiabin Ye, Cheng Zhang, Lei Ma, Haibo Yu, and Jianjun Zhao. 2016. Efficient
and precise dynamic slicing for client-side javascript programs. In 2016 IEEE
23rd International Conference on Software Analysis, Evolution, and Reengineering
(SANER), Vol. 1. IEEE, 449â€“459.
[44]Dachuan Yu, Ajay Chander, Nayeem Islam, and Igor Serikov. 2007. JavaScript
instrumentationforbrowsersecurity.In ACMSIGPLANNotices,Vol.42.ACM,
237â€“249.
[45]KaizhongZhangandDennisShasha.1989. Simplefastalgorithmsfortheediting
distancebetweentreesandrelatedproblems. SIAMjournaloncomputing 18,6
(1989),1245â€“1262.
[46]ZhaohuiZheng,XiaoyunWu,andRohiniSrihari.2004. Featureselectionfortext
categorization on imbalanced data. ACM SIGKDD Explorations Newsletter 6, 1
(2004),80â€“89.
