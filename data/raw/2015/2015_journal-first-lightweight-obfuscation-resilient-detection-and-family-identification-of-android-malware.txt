Lightweight, Obfuscation-Resilient Detection and Family
Identification of Android Malware
Joshua Garcia, Mahmoud Hammad, and Sam Malek
Department of Informatics
University of California, Irvine
Irvine, California, USA
{joshug4, hammadm, malek}@uci.edu
ABSTRACT
The number of malicious Android apps has been and continues
toincreaserapidly.Thesemalwarecan damageoralterotherfiles
or settings, install additional applications, obfuscate their behav-
iors, propagate quickly, and so on. To identify and handle such
malware, a security analyst can significantly benefit from identify-
ingthefamilytowhichamaliciousappbelongsratherthanonly
detecting if an app is malicious. To address these challenges, wepresent a novel machine learning-based Android malware detec-tion and family-identification approach, RevealDroid, that oper-ates without the need to perform complex program analyses or
extract large sets of features. RevealDroid’s selected features lever-
agecategorizedAndroidAPIusage,reflection-basedfeatures,and
features from native binaries of apps. We assess RevealDroid for
accuracy,efficiency,andobfuscationresilienceusingalargedataset
consisting of more than 54,000 malicious and benign apps. OurexperimentsshowthatRevealDroidachievesanaccuracyof98%
indetectionofmalwareandanaccuracyof95%indetermination
of their families. We further demonstrate RevealDroid’s superi-orityagainststate-of-the-artapproaches.[URLoforiginalpaper:
https://dl.acm.org/citation.cfm?id=3162625]
KEYWORDS
Android malware, obfuscation, machine learning, lightweight, na-
tive code, reflection
1 EXTENDED ABSTRACT
ThenumberofmaliciousAndroidappsisincreasingrapidly.An-
droid malware can damage or alter other files or settings, install
additionalapplications,etc.Todeterminesuchbehaviors,asecu-
rity analyst can significantly benefit from identifying the family
to which an Android malware belongs, rather than only detecting
ifanappismalicious.TechniquesfordetectingAndroidmalware,
and determining their families, lack the ability to handle certainobfuscations that aim to thwart detection. Moreover, some prior
techniques face scalability issues, preventing them from detecting
malware in a timely manner.
In this paper, we introduce RevealDroid, a lightweight machine
learning-based approach for detecting malicious Android apps and
identifyingtheirfamilies.RevealDroidleveragesasetoffeatures
selected to achieve obfuscation resiliency, efficiency of analysis,
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthefirstpage.Copyrightsforthird-partycomponentsofthisworkmustbehonored.
For all other uses, contact the owner/author(s).
ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
© 2018 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-5638-1/18/05.
https://doi.org/10.1145/3180155.3182551andaccuracy.Itdoesnotrequirecomplexprogramanalyses(e.g.,
data-flow analysis) or large sets of features (e.g., hundreds of thou-
sands of features), which can lead to scalability problems. More
specifically, our selected machine-learning features are based on
Android-API usage, including resolution of APIs invoked using
reflection, and function calls (e.g., system calls) made by native
binaries within an Android app. No previous work has included
native-codefeatureextractiontodetectmalware.Includingfeatures
based on reflection and native code significantly aids RevealDroid
with achieving obfuscation resiliency.
RevealDroid is capable of accurately detecting malicious apps
witha98%accuracy,andidentifyingtheirfamilieswitha95%ac-
curacy, in under 90 seconds on average. RevealDroid can maintain
highaccuracyevenforobfuscatedapps.WeevaluateRevealDroid’s
detection and family identification accuracy by comparing its abil-
itytocorrectlyidentifymalwareandclassifyitsfamilyonadataset
of over 24,600 benign apps and over 30,000 malicious apps from
two different malware repositories. We further compare Reveal-
Droid’s detection and family-identification accuracy against state-
of-the-researchapproaches:Adagio,Drebin,andMUDFLOW,all
ofwhich areapproachesformalware detection;andDendroid,an
approach for malware-family identification. RevealDroid has an
overall greater accuracy by about 11%-25% and mislabels 25%-54%
fewer benign apps as malicious than MUDFLOW; RevealDroidachieves up to 23% greater accuracy than Adagio and up to 60%
greateraccuracythanDrebin.Additionally,RevealDroidachievesa
24%-70% higher classification rate than Dendroid.
This paper makes the following contributions:
•RevealDroid demonstrates that highly lightweight analyses that
extractAPI-basedfeatures—including thosebasedon reflection—
andnativecodefeaturescombinedwithmachinelearning,can
achieve high accuracy, scalability, and obfuscation resiliency.
•We construct an updated dataset of over 27,900 malware apps
labeledwiththeir447malwarefamiliesandassessRevealDroid’s
family-identification accuracy on that dataset. We make this
updateddatasetavailableonlineforresearchersandpractitioners.
•ToevaluateRevealDroid’sobfuscationresiliency,weapplysev-
eral transformations to malware apps in order to obfuscate them
and assess its ability to detect and identify families of thosetransformed apps. Using these transformed apps, we compare
RevealDroid’saccuracyfordetectionagainstAdagio,Drebin,and
MUDFLOW, and for family identification against Dendroid. We
also make the transformed dataset available online.
•We assess the efficiency of RevealDroid’s feature extraction and
machine-learning classification. We show that RevealDroid’s
featurescanbeextracted,onaverage,inunder90seconds—while
stillexhibitingobfuscationresiliencyandaccuracy.Wefurther
demonstrate that RevealDroid can produce classifiers efficiently,
as compared to other state-of-the-research tools.
4972018 ACM/IEEE 40th International Conference on Software Engineering
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:53:28 UTC from IEEE Xplore.  Restrictions apply. 