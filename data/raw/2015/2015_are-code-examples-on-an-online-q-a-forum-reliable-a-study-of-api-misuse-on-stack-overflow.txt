Are Code Examples on an Online Q&A Forum Reliable?
A Study of API Misuse on Stack Overflow
Tianyi Zhang1Ganesha Upadhyaya2Anastasia Reinhardt3∗Hridesh Rajan2Miryung Kim1
1University of California, Los Angeles
2Iowa State University
3George Fox University
{tianyi.zhang, miryung}@cs.ucla.edu, {ganeshau, hridesh}@iastate.edu, areinhardt14@georgefox.edu
ABSTRACT
Programmers often consult an online Q&A forum such as Stack
OverflowtolearnnewAPIs.Thispaperpresentsanempiricalstudy
on the prevalence and severity of API misuse on Stack Overflow.
To reduce manual assessment effort, we design ExampleCheck,a n
APIusageminingframeworkthatextractspatternsfromover380K
Java repositories on GitHub and subsequently reports potential
APIusageviolationsinStackOverflowposts.Weanalyze217,818
Stack Overflow posts using ExampleCheck and find that 31% may
have potential API usage violations that could produce unexpected
behavior such as program crashes and resource leaks. Such API
misuse is caused by three main reasons—missing control constructs ,
missingorincorrectorderofAPIcalls,and incorrectguardconditions.
Even the posts that are accepted as correct answers or upvoted by
other programmers are not necessarily more reliable than other
posts in terms of API misuse. This study result calls for a newapproachtoaugmentStackOverflowwithalternativeAPIusage
details that are not typically shown in curated examples.
CCS CONCEPTS
•General and reference →Empirical studies ;•Software and
its engineering →Softwarereliability ;Collaborationinsoftware
development ;
KEYWORDS
online Q&A forum, API usage pattern, code example assessment
ACM Reference Format:
Tianyi Zhang, Ganesha Upadhyaya, Anastasia Reinhardt, Hridesh Rajan,
Miryung Kim. 2018. Are Code Examples on an Online Q&A Forum Reli-
able?.InProceedingsofICSE’18:40thInternationalConferenceonSoftware
Engineering , Gothenburg, Sweden, May 27-June 3, 2018 (ICSE ’18), 11 pages.
https://doi.org/10.1145/3180155.3180260
∗Anastasia Reinhardt contributed to this work as a summer intern at UCLA.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthe firstpage.Copyrights forcomponentsof thisworkowned byothersthan the
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/or a fee. Request permissions from permissions@acm.org.
ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
©2018 Copyright held by the owner/author(s). Publication rights licensed to Associa-
tion for Computing Machinery.
ACM ISBN 978-1-4503-5638-1/18/05...$15.00
https://doi.org/10.1145/3180155.31802601 INTRODUCTION
Library APIs are becoming the fundamental building blocks in
modernsoftwaredevelopment.Programmersreuseexistingfunc-
tionalities in well-tested libraries and frameworks by stitching API
callstogether,ratherthanbuildingeverythingfromscratch.Online
Q&A forums such as Stack Overflow have a large number of cu-
ratedcodeexamples[ 22,30].Thoughsuchcuratedexamplescan
serve as a good starting point, they could potentially impact the
quality of production code, when integrated to a target application
verbatim.Recently,Fischeretal.findthat29%ofsecurity-related
snippetsinStackOverflowareinsecureandthesesnippetscould
havebeenreusedbyover1millionAndroidappsonGoogleplay,
which raises a big security concern [ 9]. Previous studies have also
investigatedthequalityofonlinecodeexamplesintermsofcompil-
ability[23,37],uncheckedobsoleteusage[ 39],andcomprehension
issues[29].However,noneofthesestudieshaveinvestigatedthere-
liability of online code examples in terms of API usage correctness.
There is also no tool support to help developers easily recognize
unreliable code examples in online Q&A forums.
ThispaperaimstoassessthereliabilityofcodeexamplesonStack
Overflow by contrasting them against desirable API usage patterns
minedfromGitHub.OurinsightisthatcommonlyrecurringAPI
usagefromalargecodecorpusmayrepresentadesirablepattern
that a programmer can use to assess or enhance code examples
on Stack Overflow. The corpus should be large enough to provide
sufficientAPIusageexamplesandtominerepresentativeAPIusage
patterns. We also believe that quantifying how many snippets are
similar (or related but not similar) to a given example can improve
developers’ confidence about whether to trust the example as is.
Therefore, we design an API usage mining technology, Exam-
pleCheck that scales to over 380K GitHub repositories without
sacrificing the fidelityandexpressiveness of the underlying API
usagerepresentation.Byleveraginganultra-large-scale software
mininginfrastructure[ 7,31],ExampleCheck efficientlysearches
over GitHub and retrieves an average of 55144 code snippets fora given API within 10 minutes. We perform program slicing toremove statements that are not related to the given API, which
improves accuracy in the mining process (Section 5). We combine
frequent subsequence mining and SMT-based guard condition min-
ing to retain important API usage features, including the temporal
orderingofrelatedAPIcalls,enclosingcontrolstructures,andguard
conditions that protect an API call. In terms of our study scope,
we target 100 Java and Android APIs that are frequently discussed
onStackOverflow.Wetheninspectallpatternslearnedby Exam-
pleCheck, create a data set of 180 desirable API usage patterns for
the100APIs,andstudytheextentofAPImisuseinStackOverflow.
8862018 ACM/IEEE 40th International Conference on Software Engineering
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhang, Upadhyaya, Reinhardt, Rajan, & Kim
(a) An example that does not close FileChannel properly1
(b) An example that misses exception handling2
Figure 1: Two code examples about how to write data to a
file using FileChannel on Stack Overflow
Outof217,818SOpostsrelevanttoourAPIdataset,31%contain
potentialAPImisusethatcouldproducesymptomssuchasprogram
crashes,resourceleaks,andincompleteactions.SuchAPImisuseis
causedbythreemainreasons—missingcontrolconstructs, missingor
incorrect order of API calls, and incorrect guard conditions. Database,
crypto, and networking APIs are often misused, since they often
require observing the ordering between multiple calls and complex
exception handling logic. Though programmers often put more
trustonhighlyvotedpostsinStackOverflow,wedonotobserve
a strong positive nor negative correlation between the numberof votes and the reliability of Stack Overflow posts in terms of
API usage correctness. This observation suggests that votes alone
should not be used as the single indicator of the quality of Stack
Overflow posts. Our study provides empirical evidence about the
prevalence and severity of API misuse in online Q&A posts and
indicates that Stack Overflow needs another mechanism that helps
userstounderstandthelimitationofexistingcuratedexamples.We
propose a Chrome extension that suggests desirable or alternative
API usage for a given Stack Overflow code example, along with
supporting concrete examples mined from GitHub.
2 MOTIVATING EXAMPLES
SupposeAlicewantstowritedatatoafileusing FileChannel .Alice
searchesonStackOverflowandfindstwocodeexamples,bothof
whichareacceptedascorrectanswersandupvotedbyotherpro-
grammers,asshowninFigure1.Thoughsuchcuratedexamplescan
serve as a good starting point for API investigation, both examples
have API usage violations that may induce unexpected behavior in
realapplications.IfAliceputstoomuchtrustonthegivenexample
as is, she may inadvertently follow less ideal API usage.
The first post in Figure 1a does not call FileChannel.close to
close the channel. If Alice copies this example to a program that
1http://stackoverflow.com/questions/10065852
2http://stackoverflow.com/questions/10506546does not heavily access new file resources, this example may be-
have properly, because OS will clean up unmanaged file resources
eventually after the program exits. However, if Alice reuses the
example in a long-running program with heavy IO, such lingering
file resources may cause file handle leaks. Since most operating
systems limit the number of opened files, unclosed file streams caneventuallyrunoutoffilehandleresources[
28].Alicemayalsolose
cacheddatainthefilestream,ifsheuses FileChannel towriteabig
volume of data but forgots to flush or close the channel.
Even though the second example in Figure 1b calls FileChannel-
.close, it does not handle the potential exceptionsthrown by File-
Channel.write .Calling writecouldthrow ClosedChannelException ,
if the channel is already closed. If Alice uses FileChannel in a con-
current program where multiple threads attempt to access the
samechannel, AsynchronousCloseException willoccurifonethread
closes the channel, while another thread is still writing data.
As a novice programmer, Alice may not easily recognize the
potential limitation of given Stack Overflow examples. In this case,
our approach ExampleCheck scans over 380K GitHub repositories
and finds 2230 GitHub snippets that also call FileChannel.write .
ExampleCheck thenlearnstwocommonusagepatternsfromthese
relevant GitHub snippets. The mostly frequent usage supportedby 1829 code snippets on GitHub indicates that a method call to
write()must be contained inside a tryandcatchblock. Another
frequentusagesupportedby1267GitHubsnippetsindicatesthat
writemust be followed by close. By comparing code snippets in
Figures 1a and 1b against these two API usage patterns, Alice may
consider adding a missing call to closeand an exception handling
block during the example integration and adaptation.
3 API USAGE MINING AND PATTERN SET
As it is difficult to know desirable or alternative API usage a priori,
wedesignanAPIusageminingapproach,called ExampleCheck
thatscalestomassivecodecorporasuchasGitHub.WetheninspecttheresultsmanuallyandconstructadatasetofdesirableAPIusage
to be used for the Stack Overflow study in Section 4.
IntermsofAPIscope,wetarget100popularJavaAPIs.Fromthe
StackOverflowdumptakeninOctober2016,3wescanandparse
all Java code snippets and extract API method calls. We rank the
APImethodsbasedonfrequencyandremovetrivialonessuchas
System.out.println .Asaresult,weselect70frequentlyusedAPI
methodsonStackOverflow.Theyareindiversedomains,including
Android,Collection,documentprocessing(e.g.,String,XML,JSON),
graphical user interface (e.g., swing), IO, cryptography, security,
Java runtime (e.g. Thread, Process), database, networking, date,
andtime.Therest30APIscomefromanAPImisusebenchmark,
MUBench [2],afterweexcludethosepatternswithoutcorrespond-
ingSOpostsandthosethatcannotbegeneralizedtootherprojects.
Given an API method of interest, ExampleCheck takes three
phasestoinferAPIusage.InPhase1,givenanAPImethodofinter-
est,ExampleCheck searchesGitHubsnippetsthatcallthegiven
API method, removes irrelevant statements via program slicing,
andextractsAPIcallsequences.InPhase2, ExampleCheck finds
commonsubsequencesfromindividualsequencesofAPIcalls.In
Phase3,toretainconditionsunderwhicheachAPIcanbeinvoked,
3https://archive.org/details/stackexchange, accessed on Oct 17, 2016.
887
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. Are Code Examples on an Online Q&A Forum Reliable? ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
sequence :=ϵ|call;sequence
|structure {;sequence ;};sequence
call:=name(t1, ...tn)@condition
structure :=if|else|loop|try|catch(t)|finally
condition :=boolean expression
name:=method name
t:=argument type|exception type|∗
Figure 2: Grammar of Structured API Call Sequences
ExampleCheck mines guard conditions associated with individual
APIcalls.Inordertoaccuratelyestimatethefrequencyofunique
guard conditions, ExampleCheck uses a SMT solver, Z3 [ 6], to
checkthesemanticequivalenceofguardconditions,insteadofcon-
sidering the syntactic similarity between them only. We manually
inspectallinferredpatternstoconstructthedatasetofdesirable
APIusage.ThisdatasetisusedtoreportpotentialAPImisusein
the Stack Overflow posts in our study discussed in Section 4.
3.1 Structured Call Sequence Extraction and
Slicing on GitHub
Given an API method of interest, ExampleCheck searches individ-
ualcodesnippetsinvokingthesamemethodintheGitHubcorpora.
ExampleCheck scans380,125JavarepositoriesonGitHub,collected
onSeptember2015.Tofilteroutlow-qualityGitHubrepositories,
we only consider repositories with at least 100 revisions and 2 con-
tributors. To scale code search to massive corpora, ExampleCheck
leverages a distributed software mining infrastructure [ 7] to tra-
verse the abstract syntax trees (ASTs) of Java files. ExampleCheck
visits every AST method and looks for a method invocation of the
APIofinterest.Figure3showsacodesnippetretrievedfromGitHub
fortheFile.createNewFile API.Thissnippetcreatesapropertyfile,
if it does not exist by calling createNewFile (line 18).
ToextracttheessenceofAPIusage, ExampleCheck modelseach
codesnippetasastructuredcallsequence,whichabstractsawaycertainsyntacticdetailssuchvariablenames,butstillretainsthe
temporal ordering, control structures, and guard conditions of API
calls in a compact manner. Figure 2 defines the grammar of our
API usage representation. A structured call sequence consists of
relevantcontrolstructuresandAPIcalls,separatedbythedelim-
iter“;”.Thisdelimiterisisaseparatorinourpatterngrammarin
Figure2,notasemi-colonforendingeachstatementinJava.We
resolve the argument types of each API call to distinguish method
overloading.Incertaincases,theargumentconsistsofacomplex
expression such as write(e.getFormat()) , where the partial pro-
gramanalysismaynotbeabletoresolvethecorrespondingtype.
Inthatcase,werepresentunresolvedtypeswith ∗,whichcanbe
matchedwithanyothertypesinthefollowingminingphases.Each
API call is associated with a guard condition that protects its us-
age ortrue, if it is not guarded by any condition. Catch blocks are
also annotated with the corresponding exception types. We nor-malizeacatchblockwithmultipleexceptiontypessuchas
catch
(IOException | SQLException){...} tomultiplecatchblockswith
a single exception type such as catch (IOException){...} catch
(SQLException){...} .1voidinitInterfaceProperties(String temp, File dDir) {
2if(!temp.equals(/quotedblVarprops.txt/quotedblVar)) {
3log.error(/quotedblVarWrong Template./quotedblVar);
4 return;
5}
6// load default properties
7FileInputStream in = newFileInputStream(temp);
8Properties prop = newProperties();
9prop.load(in);
10// init properties
11prop.set(/quotedblVarinterface/quotedblVar, PROPERTIES.INTERFACE);
12prop.set(/quotedblVaruri/quotedblVar, PROPERTIES.URI);
13prop.set(/quotedblVarversion/quotedblVar, PROPERTIES.VERSION);
14// write to the property file
15String fPath=dDir.getAbosulatePath()+/quotedblVar/interface.prop/quotedblVar;
16File file = new File(fPath);
17if(!file.exists()) {
18file.createNewFile();
19}
20FileOutputStream out = new FileOutputStream(file);
21prop.store(out, null);
22in.close();
23}
Figure 3: This method is extracted as an example of
File.createNewFile fromtheGitHubcopora.Programslicing
only retains the underlined statements when kbound is set
to 1, since they have direct control or data dependences onthe focal API call to
createNewFile at line 18.
ExampleCheck builds the control flow graph of a GitHub snip-
pet and identifies related control structures [ 1]. A control struc-
tureisrelatedtothegivenAPIcall,ifthereexistsapathbetween
the two and the API call is not post-dominated by the controlstructure. For instance, the API call to
createNewFile (line 18) is
control dependent on the ifstatements at lines 2 and 17 in Fig-
ure 3.From eachcontrol structure,we liftthe containedpredicate.
This process is a pre-cursor for mining a common guard condi-
tion that protects each API method call in Phase 3. We use the
conjunction of the lifted predicates in all relevant control struc-
tures. If an API call is in the false branch of a control structure, we
negatethepredicatewhenconstructingtheguard.InFigure3,since
createNewFile is in the false branch of the ifstatement at line 2
andthetrue branchofthe ifstatementatline17, itsguardcondi-
tion istemp.equals(/quotedblVarprops.txt/quotedblVar) && !file.exists() . The process
ofliftingcontrolpredicatescanbefurtherimprovedviasymbolic
execution to account for the effect of program statement before
an API call. Project-specific predicates and variable names usedin the guard conditions are later generalized in Phase 3 to unify
equivalent guards regardless of project-specific details.
ExampleCheck performs intra-procedural program slicing [ 36]
tofilteroutanystatementsnotrelatedtotheAPImethodofinterest.
Forexample, Properties APIcallsinFigure3shouldberemoved,
since they are irrelevant to createNewFile . During this process,
ExampleCheck usesbothbackwardandforwardslicingtoidentify
data-dependent statements up to khops. Setting kto 1 retains
onlyimmediatelydependentAPIcallsinthecallsequence,while
settingkto∞includes all transitively dependent API calls. For
instance,the Properties APIssuchas load(line9)and set(lines11-
13) are transitively dependent on createNewFile through variables
file,out, andprop. Table 1 shows the call sequences extracted
from Figure 3 with different kbounds. By removing irrelevant
statements, program slicing significantly reduces the mining effort
888
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhang, Upadhyaya, Reinhardt, Rajan, & Kim
Bound Variables Structured Call Sequence
k=1 file new File; if {; createNewFile; }; new FileOutputStream
k=2file, fPath,
outgetAbsolutePath; new File; if {; createNewFile; };new FileOutputStream; store
k=3file, fPath,out, prop new Properties; load; set; set; set; getAbsolutePath; new File;if {; createNewFile; }; new FileOutputStream; store
k=∞file, fPath,out, prop,in, tempnew FileInputStream; new Properties; load; set; set; set;getAbsolutePath; new File; if {; createNewFile; };new FileOutputStream; store; close
No Slicingfile, fPath,
out, prop, in,
temp, logif {; debug; }; new FileInputStream; new Properties;
getAbsolutePath; load; set; set; set; new File; if {;
createNewFile; }; new FileOutputStream; store; close
Table 1: Structured call sequences sliced using kbounds.
Guard conditions and argument types are omitted for pre-
sentation purposes.
and also improves the mining precision. Setting kto 1 leads to best
performance empirically (discussed in Section 5).
3.2 Frequent Subsequence Mining
GivenasetofstructuredcallsequencesfromPhase1, ExampleCheck
finds common subsequences using BIDE[34]. Computing the com-
mon subsequence is widely practiced in the literature of API usage
mining [25,26,33,38] and has the benefit of filtering out API
calls pertinent to only a few outlier examples. In this phase, Exam-
pleCheck focuses on mining the temporal ordering of API calls
only. The task of mining a common guard condition is done in
Phase3instead. BIDEminesfrequentclosedsequences aboveagiven
minimum support threshold σ. A sequence is a frequent closed
sequence, if it occurs frequently above the given threshold and
there is no super-sequence with the same support. When match-
ing API signature, ExampleCheck matches∗with any other types
in the same position in an API call. For example, write(int,∗)
can be matched with write(int,String) but will not be matched
withwrite(String,int) .ExampleCheck ranks a list of sequence
patterns based on the number of supporting GitHub examples,
which we call support. ExampleCheck filters invalid sequence
patterns that do not follow the grammar in Figure 2, as frequentsub-sequence mining can find invalid patterns with unbalanced
brackets such as “ foo@true; }; } ”.
3.3 Guard Condition Mining
GivenacommonsubsequencefromPhase2, ExampleCheck mines
the common guard condition of each API call in the sequence. The
rationale is that each method call in the common subsequence
may have a guard toensure that the constituent API call does not
leadtoafailure.Therefore, ExampleCheck collectsallguardcon-
ditions from each call from Phase 1 and clusters them based on
semanticequivalence.TheguardconditionsextractedfromGitHub
often contain project-specific predicates and variable names. In
Figure3,theidentifiedguardconditionof createNewFile (line18)
istemp.equals(/quotedblVarprops.txt/quotedblVar) && !file.exists() . Its first predicate
temp.equals(/quotedblVarprops.txt/quotedblVar) checks whether a string variable temp
contains a specific content. Neither the variable tempnor the pred-
icate are related to the usage of createNewFile . Therefore, Exam-
pleCheck first abstracts away such syntactic details before clus-
tering guard conditions. For each guard condition from Phase 1,API Call Guard Generalized Symbolized
s.substring(start)start>=0 &&
start<=s.length()start>=0 &&start<=s.length() arg0>=0 &&arg0<=rcv.length()
log.substring(index)-1<index &&index<log.length()+1 -1<index &&index<log.length()+1 -1<arg0 &&arg0<rcv.length()+1
f.substring(
f.indexOf(“/”))dir!=null &&f.indexOf(“/”)>=0 &&f.indexOf(“/”)<=f.length()true &&f.indexOf(“/”)>=0 &&f.indexOf(“/”)<=f.length()true &&arg0>=0 &&arg0<=rcv.length()
Table 2: Example guard conditions of String.substring .API
Callshows three example call sites. Guardshows the guard
condition associated with each call site. Generalized shows
theguardconditionsaftereliminatingproject-specificpred-
icates.Symbolized shows the guard conditions after symbol-
izing variable names.
ExampleCheck removesproject-specificpredicates(i.e.,predicates
that do notmention the receiver object or inputarguments of the
givenAPIcall)bysubstitutingthemwith true.Thisensuresthat
thegeneralizedguardconditionisstillimpliedbytheoriginalguard
afterremovingproject-specificpredicates.Inaddition,sinceeach
code snippet may use different variable names, we normalize these
namesintheguardconditions. ExampleCheck usesrcvandargi
as the symbolic names of the receiver and the i-th input argument.
Table 2 illustrates how we canonicalize guard conditions of
String.substring .Thismethodtakesanintegerindexasinputand
returnsasubstringthatbeginsfromthegivenindex.Thethirdguard
conditioninColumn Guardcontainsaproject-specificpredicate,
dir!=null .Sincesuchpredicateisnotrelatedto String.substring ’s
argumentsorreceiverobject, ExampleCheck substitutes dir!=null
withtrue, as shown in Column Generalized. All three examples
name the receiver object differently— s,log, andfrespectively. Ex-
ampleCheck replacesthemwithauniquesymbol, rcv.Similarly,
ExampleCheck replacestheinputargumentwith arg0,asshown
in Column Symbolized.
ExampleCheck initializes each cluster with each canonicalized
guard. In the following clustering process, ExampleCheck checks
theequivalenceofeverypairofclustersandmergesthemwithif
theguardsarelogicallyequivalent,untilnomoreclusterscanbe
merged.Attheend,wecountthenumberofguardconditionsineach cluster as frequency. In a large corpus, the same logic pred-icate can be expressed in multiple ways. ExampleCheck checks
thesemanticequivalenceofguard conditions,insteadofsyntactic
similarity only. ExampleCheck formalizes the equivalence of two
guard conditions as a satisfiability problem:
p⇔qis valid iff.¬((¬p∨q)∧(p∨¬q))is unsatisfiable.
ExampleCheck uses a SMT solver, Z3 [ 6] to check the logical
equivalencebetweentwoguardsduringthemergingprocess.As
Z3onlysupportsprimitivetypes, ExampleCheck declaresvariables
of unsupported data types as integer variables and substitutes con-
stants such as nullwith integers in Z3 queries. In addition, Exam-
pleCheck substitutes API calls in a predicate to symbolic variables
basedontheirreturntypes.Comparedwithpriorwork[ 18],Exam-
pleCheck iscapableofprovingthesemanticequivalenceofarbi-
trarypredicatesregardlessoftheirsyntacticsimilarity.Forexample,thesymbolizedguardsofthefirsttwoexamplesinTable2areequiv-
alent,eventhoughtheyareexpressedindifferentways, (-1<arg0
889
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. Are Code Examples on an Online Q&A Forum Reliable? ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
&& arg0<rcv.length()+1) and(0<=arg0 && arg0<=rcv.length()) re-
spectively. Prior work [ 18] cannot reason about the equivalence
between -1<arg0and0<=arg0. However, ExampleCheck groups
these logically equivalent predicates into the same cluster using
the integer theorem prover in Z3.
IfExampleCheck identifies a sequence pattern containing mul-
tiple guard patterns for each API call, ExampleCheck enumerates
different guards for each API and ranks these patterns by the num-
ber of supporting code examples in the corpora. Similar to the
subsequencemininginPhase2, ExampleCheck usesaminimum
support threshold θto filter infrequent guard conditions.
We bootstrap ExampleCheck with both the sequence mining
threshold σandtheguardconditionmining threshold θsetto0.5,
whichmeans sequenceand guard conditionpatterns arereported,
only if more than half of relevant GitHub snippets include them. If
ExampleCheck learnsnopatternswiththeseinitialthresholds,we
graduallydecreaseboththresholdsby0.1tillfindingpatterns.Ifthe
miningprocessdoesnotterminateafter2hoursduetotoomany
candidatepatterns,wekilltheprocessandincreaseboththresholds
by0.1accordingly.Thisthresholdadjustmentmethodisempirically
effective to achieve a good precision (73%).
3.4 Manual Inspection of Mined API Usage
ExampleCheck scansover380KGitHubprojectsandfindsanaver-
age of 55144 relevant code snippets for each API method, ranging
from 211 to 450,358 snippets. This result indicates that massive
corpora can provide sufficient code snippets to learn API usage
patterns from. ExampleCheck infers 245 API usage patterns for
the 100 APIs in our study scope. This initial set of patterns mayinclude invalid or incorrect patterns. Therefore, we manually in-
spectthe245inferredpatternscarefullyandexcludeincorrectones
based on online documentation and pattern frequencies. The over-
all precision is 73%, resulting in 180 validated, correct patternsthat we can use for the empirical study in Section 4. These 180
validated patterns cover 85 of the 100 API methods. The rest 15
APImethodsdonotconvergetoanyAPIusagepatternsthatcan
be confirmed by online documentation, since they are simple touse and do not require additional guard conditions or additional
APIcalls.Forexample, System.nanoTime canbeusedstand-aloneto
obtain the current system time. Even though these 15 API methods
do not have any patterns, we still include them in the scope ofStack Overflow study, since they represent a category of simple
API methods that programmers are less likely to make mistakes.
Duringtheinspectionprocess,eachpatternisannotatedaseither
alternative orrequired.Acodesnippetshouldsatisfyoneofalter-
native patterns and must satisfy all required patterns. For example,
ExampleCheck learnsfirstKey()@rcv.size()>0 andfirstKey()@-
!rcv.isEmpty() forSortedMap.firstKey . Both patterns ensure that
a sorted map is not empty before getting the first key to avoid
NoSuchElementException . They are considered alternative to each
other. As an example of required patterns, programmers musthandle potential
IOException , when reading from a stream (e.g.,
FileChannel ), and close it to avoid resource leaks.
Table3shows25samplesofvalidatedAPIpatternsin9domains.
Alternative patterns are marked with ♣. Column Description de-
scribes each pattern. For instance, TypedArray is allocated from astaticpooltostorethelayoutattributes,wheneveranewapplica-
tion view is created in Android. It should be recycled immediately
to avoid resource leaks and GC overhead, as mentioned in the
JavaDoc.4Thispatternissupportedby2126of3348relatedsnip-
pets in GitHub and inferred by ExampleCheck (ranked #1). The
entire data set of API usage patterns for all 100 APIs and the list of
SOpostswithpotentialAPIusageviolationsarepubliclyavailable.5
4 API MISUSE STUDY ON STACK OVERFLOW
We use the data set of validated, desirable API usage patterns from
Section 3 and study API misuse in Stack Overflow posts.
4.1 Data Collection
We collectallStackOverflowpostsrelevanttothe100Java APIsin
our study scope from the Stack Overflow data dump. We extractcode examples in the markdown
<code>from SO posts with the
Javatagandconsidercodeexamplesintheanswerpostsonly,since
code appearing in the question posts is buggy and rarely usedas examples. We gather additional information associated with
eachpost,includingviewcounts,votescores(i.e.,upvotesminus
downvotes), and whether a post is accepted as a correct answer.
Previous studies have shown that online code snippets are often
unparsable[ 23,37]andcontainambiguousAPIelements[ 5]due
to the incompleteness of these snippets. ExampleCheck leverages
a state-of-the-art partial program parsing and type resolution tech-
nique to handle these incomplete snippets, whose accuracy of API
resolution is reported to be 97% [ 24]. Code examples that call over-
ridden APIs or ambiguous APIs (i.e., APIs with the same name but
fromdifferentJavaclasses)arefilteredbycheckingtheargument
andreceivertypesrespectively.Intotal,wefind217,818SOposts
with code examples for the 100 APIs in our study scope. Each post
has 7644 view counts on average.
ExampleCheck checks whether the structured call sequence of
aStackOverflowcodeexampleis subsumed bythedesirableAPI
usageinthepatternset.Astructuredcallsequence sissubsumedby
a pattern p, only ifpis a subsequence of sand the guard condition
ofeachAPIcallin simpliestheguardofthecorrespondingAPIcall
inp.Duringthissubsumptioncheckingprocess,theguardcondi-
tions in Stack Overflow code examples are generalized in the same
mannerbeforecheckinglogicalimplicationusingZ3.ForaSOpost
with multiple method-level code snippets, ExampleCheck inlines
invoked methods before extracting the structured call sequence in
order to emulate a lightweight inter-procedural analysis.
4.2 Manual Inspection of Stack Overflow
To check whether Stack Overflow posts with potential API misuse
reported by ExampleCheck indeed suggest undesirable API usage,
thefirstandthethirdauthorsmanuallycheck400randomsamples
ofSOpostswithreportedAPIusageviolations.Wereadthetextdescriptions and comments of each post and check whether thesurrounding narrativediscusses howto prevent theviolatedpat-
tern. If there are multiple code snippets in a post, we first combine
themalltogetherandcheckthemasasinglecodeexample.Wealso
account for aliasing during code inspection. We examine whether
4https://developer.android.com/reference/android/content/res/TypedArray.html
5http://web.cs.ucla.edu/~tianyi.zhang/examplecheck.html
890
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhang, Upadhyaya, Reinhardt, Rajan, & Kim
Domain API Pattern Support Description
CollectionArrayList.get loop {; get(int)@arg0 <rcv.size(); } 31254 check if the index is out of bounds
Iterator.next iterator()@true; loop {; next()@rcv.hasNext(); } 218962 check if more elements exist to avoid NoSuchElementException
IOFile.createNewFile if {; createNewFile()@!rcv.exists(); } ♣ 5493 check if the file exists before creating it
File.mkdir mkdirs()@true 26343 callmkdirsinstead, which also create non-existent parent directories
FileChannel.write try {; write(ByteBuffer)@true; close()@true; }; catch(IOException) {, } ♣ 1267 close the FileChannel after writing to avoid resource leak
PrintWriter.write try {; write(String)@true; close()@true; }; catch(Exception) {; } 2473 close the PrintWriter after writing to avoid resource leak
StringStringTokenizer.nextToken nextToken()@rcv.hasMoreTokens() ♣ 36179 check if more tokens exist to avoid NoSuchElementException
Scanner.nextLine loop {; nextLine()@rcv.hasNextLine(); } 2510 check if more lines exist to avoid NoSuchElementException
String.charAt charAt(int)@arg0 <rcv.length() 27597 check if the index is out of bounds
RegexMatcher.find matcher(String)@true; find()@true 5851 callmatcherto create a Matcherinstance first
Matcher.group if {; group(int)@rcv.find(); } 16447 check if there is a match first to avoid IllegalStateException
DatabaseSQLiteDatabase.query query(String,String[],String,String[],String,String,String)@true; close()@true 5563 close the cursor returned by queryto avoid resource leak
ResultSet.getString try {; getString(String)@rcv.next(); }; catch(Exception) {; } 18933 check if more results exist to avoid SQLException
Cursor.close finally {; close()@rcv!=null; } 15732 callclosein a finally block
AndroidActivity.setContentView onCreate(Bundle)@true; setContentView(View)@true 56321 always call super.onCreate first to avoid exceptions
TypedArray.getString getString(int)@true; recycle()@true 2126 recycle the TypedArray so it can be reused by a later call
SharedPreferences.Editor.edit edit()@true; commit()@true 9650 commit the changes to SharedPreferences
ApplicationInfo.loadIcon getPackageManager()@true; loadIcon(PackageManager)@true 400 get aPackageManager as the argument of load
CryptoMac.doFinaltry {; getInstance(String)@true; getBytes()@true; doFinal(byte[])@true;
}; catch(Exception) {; }474 get aMacinstance first and convert the input to bytes
MessageDigest.digest getInstance(String)@true; digest()@true 7048 get aMessageDigest instance first
NetworkJsoup.connect try {; connect(String)@true; get()@true; }; catch(IOException); { } ♣ 376 callgetto fetch the web content
URL.openConnection try {; new URL(String)@true; openConnection()@true; }; catch(Exception) {; } 19056 create a URLobject first and handle potential exceptions
HttpClient.execute new HttpGet(String)@true; execute(HttpGet)@true 2536 create a HttpGetobject as the argument of execute
SwingSwingUtilities.invokeLater new Runnable()@true; invokeLater(Runnable)@true 20406 create a Runnable object as the argument of invokeLater
JFrame.setPreferredSize setPreferredSize(Dimension)@true, pack()@true 394 callpackto update the JFramewith the preferred size
Table 3: 25 samples of manually validated API usage patterns after GitHub code mining.
thereportedAPIusageviolationcouldproduceanypotentialbe-
havioranomaly,suchasprogramcrashesandresourceleaksona
contrivedinputdataorprogramstateandwhethersuchanomaly
could have been eliminated by following the desirable pattern. For
short posts, this inspection takes about 5 minutes each. For longer
posts with a big chunk of code or multiple code fragments, it takes
around 15 to 20 minutes. To reduce subjectivity, the two authors
inspectthesepostsindependently.Theinitialinter-rateragreement
is 0.84, measured by Cohen’s kappa coefficient [ 32]. The two au-
thors resolve disagreements on all but two posts, and the kappacoefficient after the discussion is 0.99. The two authors disagree
how helpful reported violations are in two posts, where API usage
violations in these posts are either clarified in surrounding natural
language explanations or mentioned in post comments.
True Positive. 289 out of 400 inspected Stack Overflow posts
(72%)containrealAPImisuse,confirmedbybothauthors.Forin-
stance,thefollowingexampledemonstrateshowtoretrieverecordsfrom
SQLiteDatabase usingCursorbutforgetstoclosethedatabase
connection at the end.6Programmers should always close the con-
nectiontoreleaseallitsresources.Otherwise,itmayquicklyrun
out of memory, when retrieving a large volume of data from the
database frequently.
1publicArrayList<UserInfo> get_user_by_id(String id) {
2ArrayList<UserInfo> listUserInfo = newArrayList<UserInfo>();
3SQLiteDatabase db = this.getReadableDatabase();
4Cursor cursor = db.query(...);
5
6 if(cursor != null){
7 while(cursor.moveToNext()) {
8 UserInfo userInfo = newUserInfo();
9 userInfo.setAppId(cursor.getString(cursor.getColumnIndex(
COLUMN_APP_ID)));
10 // HERE YOU CAN MULTIPLE RECORD AND ADD TO LIST
11 listUserInfo.add(userInfo);
6https://stackoverflow.com/questions/3153125012 }
13}
14 returnlistUserInfo;
15}
In many cases, a code example may function well with some
crafted input data, even though it does not follow desirable API
usage.Forexample,programmersshouldcheckwhetherthereturn
valueofString.indexOf isnegativetoavoid IndexOutOfBoundsExcep-
tion. The example below does not follow this practice, but still
works well with a hard-coded constant, text.7One can argue that
theinputdataishard-codedforillustrationpurposesonly,asthe
role of Stack Overflow post is to provide a starting point rather
than teachingcomplete detailsof correct APIusage. However,if a
programmer reuses this code example and replaces the hard-coded
textwithafunctioncallreadingfroma htmlfile,thereusedcode
maycrashifthe htmldocumentdoesnothaveanexpectedelement.
Therefore,itisstillbeneficialtoinformtheusersaboutdesirable
usage and potential pitfalls, especially for a novice programmer
who may not be familiar with the given API.
1String text = /quotedblVar<img src=\/quotedblVarmysrc\/quotedblVar width=\/quotedblVar128\/quotedblVar height=\/quotedblVar92\/quotedblVar border=\/quotedblVar0\/quotedblVar
alt=\/quotedblVaralt\/quotedblVar /><p><strong>/quotedblVar;
2text = text.substring(text.indexOf(/quotedblVarsrc=\/quotedblVar/quotedblVar));
3text = text.substring(/quotedblVarsrc=\/quotedblVar/quotedblVar.length());
4text = text.substring(0, text.indexOf(/quotedblVar\/quotedblVar/quotedblVar));
5System.out.println(text);
FalsePositive. ExampleCheck mistakenlydetectsAPImisuse
in 64 posts. The majority reason is that ExampleCheck checks for
API misuse via a sequence comparison without deep knowledge of
itsspecification,whichisnotsufficientin56posts.Forinstance,the
following SO post calls substring (line 5) without explicitly check-
ing whether the start index ( index+1) is not a negative number and
the end index ( strValue.length() ) is not greater than the length
7https://stackoverflow.com/questions/12742734
891
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. Are Code Examples on an Online Q&A Forum Reliable? ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
ofthe string.8WhileExampleCheck warnspotential APImisuse,
accordingtoJDKspecifications, indexOfneverreturnsanegative
integer≤-2. Thus, the following code is still safe, because index+1
isguaranteedto benon-negative.Similarly, strValue.length() re-
turnsthestring’slength,whichcannotbeoutofbounds.Suchcases
requirehavingdetailedspecifications,suchasthereturnvalueof
indexOf() is always≥1.
1publicString getDecimalFractions(BigDecimal value) {
2String strValue = value.toPlainString();
3 intindex = strValue.indexOf(/quotedblVar./quotedblVar);
4 if(index != -1) {
5 returnstrValue.substring(index+1, strValue.length());
6}
7 return/quotedblVar0/quotedblVar;
8}
Second, 36 false positives are correct but infrequent alternatives.
ExampleCheck does not learn these alternative usage patterns,
because they do not commonly appear in GitHub. For example,
programmers should first call new SimpleDateFormat to instantiate
SimpleDateFormat with a valid date pattern and then call format,
which is supported by 18,977 related GitHub snippets. An alterna-
tive way is to instantiate SimpleDateFormat by calling getInstance ,
asshown inthe followingSOpost.9Thisalternative usageis sup-
portedby360GitHubsnippetsandthereforenotinferredby Exam-
pleCheck due to its low frequency.
1... some other code...
2publicString toString() {
3Calendar c = newGregorianCalendar();
4c.set(Calendar.DAY_OF_WEEK, this.toCalendar());
5SimpleDateFormat sdf=(SimpleDateFormat)SimpleDateFormat.getInstance();
6sdf.applyPattern(/quotedblVarEEEEEEEEEE/quotedblVar);
7 returnsdf.format(c.getTime());
8}
InsomeSOposts,usersexplicitlystateinsurroundingnatural
languagetextthatthegivencodeexamplemustbeimprovedduring
integration or adaptation. The following example shows how to
loadaClassinstancebynameandthencasttheclass.10Theauthor
of this post comments that “be aware that this might throw several
Exceptions, e.g. if the class defined by the string does not exist or if
AnotherClass.classMethod() doesn’treturnaninstanceoftheclass
youwanttocastto. ”ExampleCheck stillflagsthepostbecauseof
a missing exception handling, since the desirable API usage is not
reflected in the embedded code. However, it is certainly possible
thatSOuserswillreadboththecodeandsurroundingtextcarefully
and investigate how to handle edge cases narrated in the text.
1Class<?> myclass = Class.forName(/quotedblVarmyClass_t/quotedblVar);
2myClass_t myVar = (myClass_t)myclass.cast(AnotherClass.classMethod());
Sometimes,StackOverflowuserssplitasinglecodeexampleinto
multiple fragments and provide step-by-step explanation, which is
consideredasabetterwayofansweringquestionsinStackOver-
flow[17].ExampleCheck mayreportAPImisuseiftworelatedAPI
calls are split in different code fragments.11This can be addressed
by stitching these snippets together during analysis.
8http://stackoverflow.com/questions/7473462
9https://stackoverflow.com/questions/2243850
10https://stackoverflow.com/questions/4650708
11https://stackoverflow.com/questions/115527544.3 Is API Misuse Prevalent on Stack Overflow?
ExampleCheck detects potential API misuse in 66,897 (31%) out
of 217,818 Stack Overflow posts in our study. We manually label
each API pattern with its corresponding domain as well as theconsequence of each possible violation. Then we write scripts to
categorizereportedviolationsbasedontheirdomainsandbasedon
theirconsequences.Figure4showstheprevalenceofAPImisuse
from different domains. Database, IO, and network APIs are often
misused,sincetheyoftenrequiretohandlepotentialruntimeex-
ceptionsandcloseunderlyingstreamstoreleaseresourcesproperly
at the end. Similarly, many cryptography related posts are flagged
asunreliable,duetounhandledexceptions.StackOverflowposts
onstringandtextmanipulationoftenforgettocheckthevalidityofinputdata(e.g.,whethertheinputstringisempty)orreturnvalues
(e.g., whether the returned character index is -1).
Among posts with potential API misuse reported by Exam-
pleCheck, 76% could potentially lead to program crashes, e.g.,unhandled runtime exceptions. 18% could lead to incomplete ac-
tion,e.g.,notcompletingatransactionaftermodifyingresources
in Android, or not calling setVisible after modifying the look and
feelofaswingGUIwidget.2%couldleadtoresourceleaksinop-
eratingsystems,e.g.,notclosingastream.Wefullyacknowledge
that not all detected violations could lead to bugs when ported to a
targetapplication.ToaccuratelyassesstheruntimeimpactofSO
codeexamples,onemustsystematicallyintegratetheseexamples
to real-world target applications and run regression tests.
Many SO examples aim to answer a particular programming
question. Therefore, authors of these examples may assume SOusers who posted these questions already know about the used
APIsand maynotinclude completedetailsof desirableAPIusage.
However,giventhateachposthas7,644viewcountsonaverage,
someusersmaynothavesimilarbackgroundknowledge.Especially
for novice programmers, it may be useful to show extra tips about
desirableAPIusageevidencedbyalargenumberofGitHubcode
snippets. We also find that SO posts with API misuse are more fre-
quently viewed than those posts without API misuse, 8365 vs. 7276
on average. Therefore, there is an opportunity to help users con-
sider better or alternative API usage mined from massive corpora,
when they stumble upon SO posts with potential API misuse.
4.4 Are highly voted posts more reliable?
StackOverflowallowsuserstoupvoteanddownvoteaposttoindi-
catetheapplicabilityandusefulnessofthepost.Therefore,votes
are often considered the main quality metric of Stack Overflowexamples [
17]. However, we find that highly voted posts are not
necessarily more reliable in terms of correct API usage. Figure 5shows the percentage of SO posts with different vote scores thatare detected with at least one API usage violation. We perform a
linearregressiononthevotescoreandthepercentageofunreliable
examples, as shown by the red line in Figure 5. We do not observe
astrongpositiveornegativecorrelationbetweenthevoteofapost
anditsreliabilityintermsofAPImisuse.Apreviousstudyshows
that concise code examples and detailed step-by-step explanations
are two key factors of highly voted Stack Overflow posts [ 17]. Our
manualinspectionconfirmsthatmanyunreliableexamplesaresim-plifiedtooperateoncraftedinputdataforillustrationpurposesonly
892
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhang, Upadhyaya, Reinhardt, Rajan, & Kim
Android Collection Crypto Database IO Network Regex Runtime Swing Text Time0 2 04 06 08 0 1 0 0Percentage of Code Examples 
 with API Misuse Per API (%)
Figure 4: API Misuse Comparison between Different Domains
(Section4.2).Suchcuratedexamplesarenotsufficientforvarious
input data and usage scenarios in real software systems, especially
for handling corner cases. Therefore, votes alone should not be
used as a single indicator of the quality of online code examples.
To improve the quality of curated examples, Stack Overflow needs
anothermechanismthathelpsdevelopersunderstandthelimitationofexistingexamplesanddecidehowtointegratethegivenexample
to production code (Section 5).
0 2 04 06 08 0 1 0 002 0 4 0 6 0
Score (i.e., upvotes minus downvotes)Stack Overflow Posts with API Misuses (%)
Figure 5: API Misuse Comparison between Code Examples
with Different Vote Scores on Stack Overflow
4.5 What are the characteristics of API misuse?
We classify the detected API usage violations into three categories
based on the required edits to correct the violations.Missing Control Constructs.
Many APIs should be used in a
specific control-flow context to avoid unexpected behavior. This
type of API usage violations can be further split based on the type
of missing control constructs.
Missingexceptionhandling. IfanAPImaythrowanexception,the
thrownexceptionshouldeitherbecaughtandhandleda try-catch
block or be declared in the method header. In total, we find 17,432
codeexamplesthatdonothandleexceptionsproperly.Forexample,
Integer.parseInt may throw NumberFormatException if the string
does not contain a parsable integer. The following example willcrash, if a user enters an invalid integer.12A good practice is to
surround parseInt with a try-catch block to handle the potential
exception. Unlike checked exceptions such asIOException , runtime
exceptions such as NumberFormatException will not be checked at
compile time. In such cases, it would be helpful to inform users
aboutwhichruntimeexceptionsmustbehandledbasedoncommon
exception handling usage in GitHub.
1Scanner scanner = newScanner(System.in);
2System.out.print(/quotedblVarEnter Number of Students:\t/quotedblVar);
3intnumStudents =:::::::::Integer.parseInt(scanner.nextLine());
Missing if checks. Some APIs may return erroneous values such
asnullpointers,whichmustbecheckedproperlytoavoidcrashing
the succeeding execution. For example, TypedArray.getString may
returnnull,ifthegivenattributeisnotdefinedinthestyleresource
of an Android application. Therefore, the return value, customFont
mustbecheckedbeforepassingitasanargumentof setCustomFont
(line 6) to avoid NullPointerException , which is violated by the
following Stack Overflow example.13
1public class TextViewPlus extends TextView {
2... some other code ...
3 private void setCustomFont(Context ctx, AttributeSet attrs) {
4 TypedArray a = ctx.obtainStyledAttributes(attrs, R.styleable.
TextViewPlus);
5 String customFont = a.getString(R.styleable.TextViewPlus_customFont);
6 setCustomFont(ctx, customFont);
7 a.recycle();
8}
9}
Missing finally. Clean-up APIs such as closeshould be invoked
inafinallyblockincaseanexceptionoccursbeforeinvokingthose
APIs.83%ofStackOverflowexamplesthatcall Cursor.close does
notcallitinafinallyblock,showninthefollowing.14Cursor.close
may be skipped, if getString (line 5) throws an exception.
1Cursor emails = contentResolver.query(Email.CONTENT_URI,...);
2while(emails.moveToNext()) {
3String email = emails.getString(emails.getColumnIndex(Email.DATA));
4 break;
5}
6::::::::emails.close();
Missing or Incorrect Order of API calls. In certain cases, mul-
tipleAPIsshouldbecalledtogetherinaspecificordertoachieve
12https://stackoverflow.com/questions/3137481
13https://stackoverflow.com/questions/7197867
14https://stackoverflow.com/questions/31427468
893
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. 894
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhang, Upadhyaya, Reinhardt, Rajan, & Kim
Threats to Validity. Our study is limited to 100 Java APIs that
frequently appearin Stack Overflowand thus maynot generalize
tootherJavaAPIsordifferentlanguages.Ourscopeislimitedto
codesnippetsfoundonStackOverflow.Othertypesofonlinere-
sources such as programming blogs and other Q&A forums may
have better curated examples. According to the manual inspection
of 400 sampled SO posts with detected API usage violations, Ex-
ampleCheck detectsAPImisusewith72%precision(Section4.2).
Whiletheprecisionisratherlow, ExampleCheck couldbestilluse-
fulinthecaseoffalsepositives,sincethegoalof ExampleCheck
is not to discard SO posts with potential API violations, but rather
to suggest desirable or alternative API usage details to the users.
6 RELATED WORK
Quality Assessment of Online Code Examples. Prior work has
investigated the quality of online code examples from different
perspectives. The majority of code examples on Stack Overflow
arefree-standingprogramstatementsthatcannotbeacceptedby
compilers[ 23,37].Duetotheincompletenessofcodesnippets,89%
of API names in code snippets from online forums are ambigu-ous and cannot be easily resolved [
5]. Subramanian et al. design
apartialprogramparsingandtyperesolutiontechniqueforStack
Overflow code snippets, which ExampleCheck uses to resolve API
names [24]. Zhou et al. find that 86 of 200 accepted posts on Stack
OverflowusedeprecatedAPIsbutonly3ofthemarereportedby
otherprogrammers [39].Fischer etal. investigatesecurity-related
code on Stack Overflow and find that 29% is insecure [ 9]. They
further apply clone detection to check whether insecure code isreused from Stack Overflow to Android applications on GooglePlay and find that insecure code may have been copied to over
1 million Android apps. An et al. investigate copyright issues be-
tweenStackOverflowandGitHub[ 4]andfindalargenumberof
potential license violations. Treude and Robillard conduct a survey
toinvestigatecomprehensiondifficultyofcodeexamplesinStack
Overflow [ 29]. The responses from GitHub users indicate that less
than half of the SO examples are self-explanatory.
While our study also indicates the limitation of code example
qualityinStackOverflow,ourstudyfocusesonAPIusageviolationsthatmayleadtounexpectedbehaviorsuchasprogramcrashesand
resourceleaksbycontrastingSOcodeexamplesagainstdesirable
APIusageminedfrommassivecorpora.Ourresultsstronglymo-
tivatetheneedofsystematicallyaugmentingStackOverflowand
helping the user to implicitly assess the given SO example with
quantitative evidence about how many GitHub snippets follow (or
do not follow) related API usage patterns.API Usage Mining.
There is a large body of literature in mining
implicit programming rules, API usage, and temporal properties
ofAPIcalls.SinceAPIusageminingisonlyapartofourdataset
constructionprocess,wearenotarguingthenoveltyofAPIminingemployedin ExampleCheck.Nevertheless,webrieflydescribehow
API usage mining in ExampleCheck is related to prior work.
Gruska et al. extract call sequences from programs and perform
formal concept analysis [ 11] to infer pairwise temporal properties
ofAPIcalls[ 14].Manyotherspecificationminingtechniquesare
dedicated to inferring temporal properties of API calls [ 3,8,10,
19,20,35]. UP-Miner mines frequent sequence patterns but doesnot retain control constructs and guard conditions in API usagepatterns [
33]. Several techniques [ 15,16,27] model programs as
item sets and infer pairwise programming rules using frequent
itemset mining [ 13], which does not consider temporal ordering or
guard conditions of API calls.
ExampleCheck mines from massivecorpora ofGitHub projects,
several orders of magnitude larger than prior work [ 14,20,33,35].
ExampleCheck minesnotonlyAPIcallorderingbutalsoguardcon-
ditionsusingpredicatemining.Toourbestknowledge,Ramanathan
et al. [21] and Nguyen et al. [ 18] are the only two predicate min-
ing techniques. Ramanathan et al. apply inter-procedure data-flow
analysistocollectallpredicatesrelatedtoacallsiteandthenuse
frequent itemset mining to find common predicates. Unlike Ex-
ampleCheck, Ramanathan et al. only mine a single project and
cannothandlesemanticallyequivalentpredicatesindifferentforms.Nguyenetal.improveuponRamanathanetal.bynormalizingpred-
icatesusingseveralrewritingheuristics.Unlikethesetechniques,
ExampleCheck formalizes the predicate equivalence problem as a
satisfiabilityproblemandleveragesaSMTsolvertogrouplogically
equivalent predicates during guard mining.
7 CONCLUSION
ProgrammersoftenresorttocodeexamplesononlineQ&Aforums
such as Stack Overflow to learn about how to use APIs correctly
duringsoftwaredevelopment.However,thereliabilityofcodeexam-
ples in Stack Overflow posts is under-investigated. To demonstrate
the prevalence and severity of API misuse in online code examples,
weminefrequentAPIusagepatternsfrom380,125GitHubreposito-
ries,carefullychecktheresulting245minedpatternsmanually,and
contrast 217,818 Stack Overflow posts with 180 validated patterns.
Our study provides empirical evidence that almost one third of
StackOverflowpostsmaycontainpotentialAPIusageviolations
thatcouldproducesymptomssuchasprogramcrashesandresource
leaks. Even highly voted posts are not necessarily more reliable
than other posts in terms of API usage correctness.
Certainly, the purpose of Stack Overflow is to provide a starting
point for investigation and its code examples do not necessarilyinclude all details of how to reuse the given code. However, for
novice developers, it may be useful to show extra tips about desir-
able API usage evidenced by a large number of GitHub snippets.
Our work provides a foundation for enriching and enhancing code
snippetsinacollaborativeQ&Aforumbycontrastingthemagainst
frequentusagepatternslearnedfrommassivecodecorpora.Such
approach could help the user to implicitly assess the given code
example and reduce the effort of integrating, adapting, and testing
thecuratedexampleinatargetapplication.Asafuturework,we
plantovalidate ExampleCheck withdevelopersandsolicittheir
feedback on its Chrome extension.
8 ACKNOWLEDGMENTS
We would like to thank anonymous reviewers for the helpful feed-
back. This work is supported by AFRL grant FA8750-15-2-0075,and NSF grants CCF-1527923, CCF-1460325, CCF-1423370, CNS-
1513263, and CCF-1518897. Anastasia Reinhardt’s internship at
UCLAissupportedbyCRA-WDistributedResearchExperiences
for Undergraduates (DREU) program.
895
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. Are Code Examples on an Online Q&A Forum Reliable? ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
REFERENCES
[1]FrancesEAllen.1970. Controlflowanalysis.In ACMSigplanNotices ,Vol.5.ACM,
1–19.
[2]Sven Amani, Sarah Nadi, Hoan A Nguyen, Tien N Nguyen, and Mira Mezini.
2016. MUBench: a benchmark for API-misuse detectors. In Proceedings of the
13th International Conference on Mining Software Repositories. ACM, 464–467.
[3]Glenn Ammons, Rastislav Bodik, and James R. Larus. 2002. Mining specifica-tions. InPOPL ’02: Proceedings of the 29th ACM SIGPLAN-SIGACT Symposium
onPrinciplesofProgrammingLanguages.ACMPress,NewYork,NY,USA,4–16.
DOI:http://dx.doi.org/10.1145/503272.503275
[4]Le An, Ons Mlouki, Foutse Khomh, and Giuliano Antoniol. 2017. Stack overflow:
acodelaunderingplatform?.In SoftwareAnalysis,EvolutionandReengineering
(SANER), 2017 IEEE 24th International Conference on. IEEE, 283–293.
[5]Barthélémy Dagenais and Martin P Robillard. 2012. Recovering traceability links
between an API and its learning resources. In 2012 34th International Conference
on Software Engineering (ICSE). IEEE, 47–57.
[6]LeonardoDeMouraandNikolajBjørner.2008. Z3:AnefficientSMTsolver.In
InternationalconferenceonToolsandAlgorithmsfortheConstructionandAnalysis
of Systems. Springer, 337–340.
[7]RobertDyer,HoanAnhNguyen,HrideshRajan,andTienNNguyen.2013. Boa:A
language and infrastructure for analyzing ultra-large-scale software repositories.
InProceedings of the 2013 International Conference on Software Engineering . IEEE
Press, 422–431.
[8]Michael D Ernst, Jake Cockrell, William G Griswold, and David Notkin. 2001.
Dynamicallydiscoveringlikelyprograminvariantstosupportprogramevolution.
IEEE Transactions on Software Engineering 27, 2 (2001), 99–123.
[9]Felix Fischer, Konstantin Böttinger, Huang Xiao, Christian Stransky, Yasemin
Acar,MichaelBackes,andSaschaFahl.2017.StackOverflowConsideredHarmful?
The Impact of Copy&Paste on Android Application Security. In Security and
Privacy (SP), 2017 IEEE Symposium on. IEEE, 121–136.
[10]Mark Gabel and Zhendong Su. 2010. Online inference and enforcement of
temporalproperties.In Proceedingsofthe32ndACM/IEEEInternationalConference
on Software Engineering-Volume 1. ACM, 15–24.
[11]Bernhard Ganter and Rudolf Wille. 2012. Formal concept analysis: mathematical
foundations. Springer Science & Business Media.
[12]ElenaGlassman*,TianyiZhang*,BjörnHartmann,andMiryungKim.2018. Visu-
alizing API Usage Examples at Scale. In Proceedings of the SIGCHI Conference on
Human Factors in Computing Systems. ACM. *The two lead authors contributed
equally to the work as part of an equal collaboration between both institutions.
[13]Gösta Grahne and Jianfei Zhu. 2003. Efficiently using prefix-trees in mining
frequent itemsets.. In FIMI, Vol. 90.
[14]Natalie Gruska, Andrzej Wasylkowski, and Andreas Zeller. 2010. Learning from
6,000 projects: lightweight cross-project anomaly detection. In Proceedings of the
19th international symposium on Software testing and analysis. ACM, 119–130.
[15]Zhenmin Li and Yuanyuan Zhou. 2005. PR-Miner: automatically extracting
implicitprogrammingrulesanddetectingviolationsinlargesoftwarecode.In
ACM SIGSOFT Software Engineering Notes, Vol. 30. ACM, 306–315.
[16]Martin Monperrus, Marcel Bruch, and Mira Mezini. 2010. Detecting missing
method calls in object-oriented software. In European Conference on Object-
Oriented Programming. Springer, 2–25.
[17]SeyedMehdiNasehi,JonathanSillito,FrankMaurer,andChrisBurns.2012. What
makesagoodcodeexample?:AstudyofprogrammingQ&AinStackOverflow.
InSoftwareMaintenance(ICSM),201228thIEEEInternationalConferenceon .IEEE,
25–34.
[18]HoanAnhNguyen,RobertDyer,TienNNguyen,andHrideshRajan.2014.Mining
preconditions of APIs in large-scale code corpus. In Proceedings of the 22nd ACM
SIGSOFT International Symposium on Foundations of Software Engineering. ACM,
166–177.
[19]MichaelPradelandThomasRGross.2009. Automaticgenerationofobjectusage
specifications from large method traces. In Proceedings of the 2009 IEEE/ACM
International Conference on Automated Software Engineering. IEEE Computer
Society, 371–382.
[20]MichaelPradel,CieraJaspan,JonathanAldrich,andThomasRGross.2012. Stati-cally checking API protocol conformance with mined multi-object specifications.
InProceedings of the 34th International Conference on Software Engineering. IEEE
Press, 925–935.
[21]Murali Krishna Ramanathan, Ananth Grama, and Suresh Jagannathan. 2007.
Staticspecificationinferenceusingpredicatemining.In ACMSIGPLANNotices,
Vol. 42. ACM, 123–134.
[22]CaitlinSadowski,KathrynTStolee,andSebastianElbaum.2015. Howdevelopers
search for code: a case study. In Proceedings of the 2015 10th Joint Meeting on
Foundations of Software Engineering. ACM, 191–201.
[23]SiddharthSubramanianandReidHolmes.2013. Makingsenseofonlinecodesnip-pets.InProceedingsofthe10thWorkingConferenceonMiningSoftwareRepositories.
IEEE Press, 85–88.
[24]SiddharthSubramanian,LauraInozemtseva,andReidHolmes.2014. LiveAPI
documentation.In Proceedingsofthe36thInternationalConferenceonSoftwareEngineering. ACM, 643–652.
[25]SureshThummalapentaandTaoXie.2007. Parseweb:aprogrammerassistant
for reusing open source code on the web. In Proceedings of the twenty-second
IEEE/ACM international conference on Automated software engineering. ACM,
204–213.
[26] Suresh Thummalapenta andTao Xie. 2009. Mining exception-handlingrules as
sequence association rules. In Proceedings of the 31st International Conference on
Software Engineering. IEEE Computer Society, 496–506.
[27]Suresh Thummalapenta and Tao Xie. 2011. Alattin: mining alternative patterns
for defect detection. Automated Software Engineering 18, 3 (2011), 293.
[28]Emina Torlak and Satish Chandra. 2010. Effective Interprocedural Resource
Leak Detection. In Proceedings of the 32Nd ACM/IEEE International Conference on
SoftwareEngineering-Volume1(ICSE’10).ACM,NewYork,NY,USA,535–544.
DOI:http://dx.doi.org/10.1145/1806799.1806876
[29]Christoph Treude and Martin P Robillard. 2017. Understanding Stack Overflow
Code Fragments. In Proceedings of the 33rd International Conference on Software
Maintenance and Evolution. IEEE.
[30]MedhaUmarji,SusanElliottSim,andCristaLopes.2008. Archetypalinternet-
scale source code searching. In IFIP International Conference on Open Source
Systems. Springer, 257–263.
[31]GaneshaUpadhyayaandHrideshRajan.2018. CollectiveProgramAnalysis.In
Proceedings of the 40th International Conference on Software Engineering. ACM.
[32]AnthonyJViera,JoanneMGarrett,andothers.2005.Understandinginterobserver
agreement: the kappa statistic. Fam Med 37, 5 (2005), 360–363.
[33]Jue Wang, Yingnong Dang, Hongyu Zhang, Kai Chen, Tao Xie, and Dongmei
Zhang.2013. Miningsuccinctandhigh-coverageAPIusagepatternsfromsource
code. InProceedings of the 10th Working Conference on Mining Software Reposito-
ries. IEEE Press, 319–328.
[34]Jianyong Wang, Jiawei Han, and Chun Li. 2007. Frequent closed sequencemining without candidate maintenance. IEEE Transactions on Knowledge and
Data Engineering 19, 8 (2007).
[35]Andrzej Wasylkowski, Andreas Zeller, and Christian Lindig. 2007. Detectingobject usage anomalies. In Proceedings of the the 6th joint meeting of the Euro-
peansoftwareengineeringconferenceandtheACMSIGSOFTsymposiumonThe
foundations of software engineering. ACM, 35–44.
[36]Mark Weiser. 1981. Program slicing. In Proceedings of the 5th international
conference on Software engineering. IEEE Press, 439–449.
[37]Di Yang, Aftab Hussain, and Cristina Videira Lopes. 2016. From query to usable
code: an analysis of stack overflow code snippets. In Proceedings of the 13th
International Workshop on Mining Software Repositories. ACM, 391–402.
[38]HaoZhong,TaoXie,LuZhang,JianPei,andHongMei.2009. MAPO:Miningand
recommendingAPIusagepatterns.In EuropeanConferenceonObject-Oriented
Programming. Springer, 318–343.
[39]JingZhouandRobertJWalker.2016.APIdeprecation:aretrospectiveanalysisand
detectionmethod forcode examplesonthe web.In Proceedingsof the2016 24th
ACM SIGSOFT International Symposium on Foundations of Software Engineering.
ACM, 266–277.
896
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:38:44 UTC from IEEE Xplore.  Restrictions apply. 