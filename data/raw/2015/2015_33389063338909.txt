WhyAren’tRegularExpressionsa LinguaFranca? An Empirical
Study onthe Re-useand PortabilityofRegularExpressions
James C. Davis
davisjam@vt.edu
VirginiaTech,USALouis G.Michael IV
louism@vt.edu
VirginiaTech,USAChristyA.Coghlan∗
ccogs@vt.edu
VirginiaTech,USA
FranciscoServant
fservant@vt.edu
VirginiaTech,USADongyoonLee
dongyoon@vt.edu
VirginiaTech,USA
ABSTRACT
Thispaperexplorestheextenttowhichregularexpressions(regexes)
areportableacrossprogramminglanguages.Manylanguagesof-
fersimilarregexsyntaxes,anditwouldbenaturaltoassumethat
regexes can be ported across language boundaries. But can regexes
becopy/pastedacrosslanguageboundarieswhileretainingtheir
semantic andperformance characteristics?
Inoursurveyof158professionalsoftwaredevelopers,mostindi-
catedthattheyre-useregexesacrosslanguageboundariesandabout
halfreportedthattheybelieveregexesareauniversallanguage.We
experimentallyevaluatedtheriskinessofthispracticeusinganovel
regex corpus Ð 537,806 regexes from 193,524 projects written in
JavaScript, Java, PHP,Python,Ruby,Go,Perl, andRust.Using our
polyglotregexcorpus,weexploredthehitherto-unstudied regex
portability problems : logic errors due to semantic differences,
andsecurity vulnerabilitiesdueto performance differences.
We report that developers’ belief ina regex lingua franca is un-
derstandable but unfounded. Though most regexes compile across
language boundaries, 15%exhibitsemanticdifferencesacross lan-
guagesand 10%exhibitperformance differencesacrosslanguages.
We explained these differences using regex documentation, and
furtherilluminateourfindingsbyinvestigatingregexengineim-
plementations. Along the way we found bugs in the regex engines
ofJavaScript-V8,Python,Ruby,andRust,andpotentialsemantic
andperformance regex bugsinthousandsofmodules.
CCS CONCEPTS
·Software and its engineering →Reusability ;·Social and
professional topics →Softwareselectionand adaptation .
KEYWORDS
Regular expressions, developer perceptions, re-use, portability, em-
pirical software engineering, mining software repositories, ReDoS
∗Christy A. Coghlan is nowemployed by Google, Inc.
Permissionto make digitalor hard copies of allorpart ofthis work for personalor
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthefirstpage.Copyrights forcomponentsofthisworkownedbyothersthanthe
author(s)mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,or
republish,topostonserversortoredistributetolists,requirespriorspecificpermission
and/or a fee. Request permissions from permissions@acm.org.
ESEC/FSE ’19, August 26ś30,2019, Tallinn,Estonia
©2019 Copyright heldby the owner/author(s). Publicationrightslicensed to ACM.
ACM ISBN 978-1-4503-5572-8/19/08...$15.00
https://doi.org/10.1145/3338906.3338909ACMReference Format:
JamesC.Davis,LouisG.MichaelIV,ChristyA.Coghlan,FranciscoServant,
andDongyoonLee.2019.WhyAren’tRegularExpressionsaLinguaFranca?
AnEmpiricalStudyontheRe-useandPortabilityofRegularExpressions.In
Proceedingsofthe27thACMJointEuropeanSoftwareEngineeringConference
andSymposiumontheFoundationsofSoftwareEngineering(ESEC/FSE’19),
August 26ś30, 2019, Tallinn, Estonia. ACM, New York, NY, USA, 12pages.
https://doi.org/10.1145/3338906.3338909
1 INTRODUCTION
Regular expressions (regexes) are a core component of modern
programminglanguages. Regexes are commonly used fortext pro-
cessing and input sanitization [ 105], appearing,for example,in an
estimated30-40%ofopen-sourcePythonandJavaScriptprojects[ 20,
26].However,craftingacorrectregexisdifficult[ 101],anddevel-
opers may prefer to re-use an existing regex than write it from
scratch. They might turn to regex repositories like RegExLib [ 4,7];
ortoStackOverflow,wherełregexžisapopulartag[ 8];ortoother
softwareprojects.Forexample,aregexderivedfromtheNode.js
pathmoduleappears inmore than2,000 JavaScript projects[ 26].
Correctness and security are fundamental problems in software
engineeringingeneral,andforregexesinparticular: re-usingregexes
can be risky . Like other code snippets [ 109], regexes may flow into
softwarefromInternetforumsorothersoftwareprojects.Unlike
mostcodesnippets,however,regexescanflowunchangedacross
languageboundaries.Programminglanguageshavesimilarregex
syntaxes, so re-used regexes may compile without modification.
However, surface-level syntactic compatibility can mask more sub-
tlesemantic andperformance portability problems. If regex seman-
tics vary, then a regex will match different sets of strings across
programming languages, resulting in logical errors. If regex per-
formancevaries,aregexmayhavedifferingworst-casebehavior,
exposing service providersto security vulnerabilities[ 25,78].
Despitethewidespreaduseofregexesinpractice,theresearch
literature is nearly silent about regex re-use and portability. We
knowonlyanecdotallythatsomedevelopersstrugglewithł[regex]
inconsistencies across [languages]ž [ 20]. In this paper we explored
the coupled concepts of cross-language regex re-use and regex
portabilityusingamixed-methodsapproach.First,wesurveyed158
professional developers to better understandtheir regex practices
(ğ4),andempiricallycorroboratedtheregexre-usepracticesthey
reported (ğ 6). Then, we investigated the extent to which these
practices may result in bugs. We empirically measured semantic
and performance portability problems, attempted to explain these
problems using existing regex documentation, and explored regex
443
ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia James C.Davis,LouisG.MichaelIV,Christy A.Coghlan, Francisco Servant, andDongyoonLee
engine implementations to illuminate our findings (ğ 7). We are not
thefirsttoobserveregexportabilityissues,butwearethefirstto
provideevidenceofthe extentandimpact ofthe phenomenon.
Our contributionsare:
•We describe the regex re-usepractices of158developers (ğ 4).
•We present a first-of-its-kind polyglot regex corpus consisting of
537,806 unique regexes extracted from 193,524 software projects
written in8popular programminglanguages(ğ 5).
•Weempiricallyshowthatregexre-useiswidespread,bothwithin
andacrosslanguagesandfrom Internet sources(ğ 6).
•Weidentify andexplainsemanticandperformanceregex porta-
bility problems (ğ 7). We report that approximately 15% of the
regexes in our corpus have semantic portability problems, while
10% have performance portability problems. Most of these prob-
lems could not be explained using existing regex documentation.
•Weidentifythousandsofpotentialregexbugsinrealsoftware,
as well as bugsinJavaScript-V8, Python,Ruby,andRust (ğ 8).
2 BACKGROUND
2.1 RegexDialects
Most programming languages support regexes, providing develop-
erswithaconcisemeansofdescribingasetofstrings.Therehas
beennosuccessfulspecificationofregexsyntaxandsemantics;Perl-
CompatibleRegularExpressions(PCRE)[ 46]andPOSIXRegular
Expressions [ 47] have influenced but not standardized the various
regexdialectsthatprogramminglanguagessupport,leadingtoman-
ualswithphraseslikełtheseaspects...maynotbefullyportablež[ 6].
Anecdotally,inconsistentbehaviorhasbeenreportedevenbetween
differentimplementations ofthe same regex specification [ 19].
Thislackofstandardizationmaycomeasnosurprisetodevelop-
ersfamiliarwithregexesasalibraryfeatureratherthanalanguage
primitive. But for the latest generation of developers, regexes have
alwaysbeenpartoftheprogramminglanguage,andbecausethe
regex dialects are similar in syntax it would be natural for devel-
opers to assume that they are in fact a lingua franca . We report
thatmanydevelopersdomakethisassumption,andweexplorethe
potentialconsequencesbyinvestigatingthedistinctsemanticand
performance characteristics ofmanyregex dialects.
2.2 RegexDenialofService(ReDoS)
Under the hood, programming languages implement a regex en-
ginetotestcandidate inputsformembershipinthelanguageofa
regex. Most regex engines evaluate a regex match by simulating
thebehaviorofanequivalentFiniteAutomaton(Deterministicor
Non-) on the candidate string [ 90], but they vary widely in the par-
ticular algorithm used. Despite the recommendations of automata
theorists[ 24,95],inmostprogramminglanguagesaregexmatch
may require greater-than-linear time in the length of the regex
andtheinputstring.Suchasuper-linear(SL)matchmayrequire
polynomialorexponential time inthe worst case[ 25,78].
SLregexbehaviorhadlongbeenconsideredanunlikelyattack
vector in practice, but in the past year this has begun to change.
Daviset al.[27] and Staicu and Pradel [ 92] identified Regular ex-
pression Denial of Service (ReDoS) as a major problem facing
Node.js applications, and Davis et al.reported thousands of SL
regexesaffectingover10,000JavaScriptprojects[ 26].Althoughit
isknownthatSL regexbehavioris possibleinJavaScript,Python,and Java [ 26,104,107], from a portability perspective we do not
know the relative risk of ReDoS across different programming lan-
guages. Cox [ 24] has suggested that languages fall into two classes
ofperformance,thoughhedidnotsystematicallysupporthisclaim.
2.3 DeveloperPractices Around Regexes
Despite the widespread use of regexes in practice [ 20,26], sur-
prisingly little is known about how software developers write and
maintain them. Recent studies have shed some light on the typical
languages developers encode in regexes [ 20,26], the relative read-
abilityofdifferentregex notations[ 21], developerregextestprac-
tices[102], anddeveloper regex maintenancepractices [ 26,101].
Mostoftheseworkshavefocusedonsoftwareartifactsrather
than on developers’ thought processes and day-to-day practices.
The only previous qualitative perspective on developers’ approach
to regex development is Chapman and Stolee’s exploratory sur-
vey of 18 professional software developers employed by a single
company [ 20]. They reported high-level regex practices like the
frequencywithwhichthosedevelopersuseregexesandthetasks
they use regexesfor.
3 RESEARCH QUESTIONS
In this work we seek to better understand developer regex re-use
practices and understand the potential risks they face. First, we
survey professional software developers to learn their regex per-
ceptionsandpractices.Wethenmeasureregexre-usepracticesin
real software to corroborate the findings of our survey. Finally, we
empiricallyevaluatethesemanticandperformanceportabilityprob-
lems that may result from cross-language regex re-use practices,
andexplaindifferences acrosslanguages.Our research questions:
Theme1: Developerperspectives
RQ1:Dodevelopers re-useregexes?
RQ2:Where do developers re-useregexesfrom?
RQ3:Dodevelopers believe regexesare a linguafranca ?
Theme2: Measuringregex re-use
RQ4:Howcommonly are regexesre-usedfrom othersoftware?
RQ5:Howcommonly are regexesre-usedfrom Internet sources?
Theme3: Empirical portability
RQ6:Semanticportability: Whenandwhydoregexesmatchdif-
ferentsetsofstrings indifferentprogramming languages?
RQ7:Performance portability: When and why do regexes have
different worst-case performance in different programming
languages?
4 THEME1: DEVELOPER PERSPECTIVES
We surveyed developers to better understand regex re-use and
portability issuesfrom their perspective.
Findings: (RQ1)94%of developers re-useregexes,
(RQ2)commonly from StackOverflowandothercode.
(RQ3)47%ofdevelopers treatregexeslike a linguafranca .
4.1 Methodology
Surveycontent. Wedevelopeda33-questionsurveywithamixof
closed and open-ended questions. We asked participants about: (1)
theprocesstheyfollowwhenwritingregexes;(2)theirregexre-use
444WhyAren’t Regular Expressions aLingua Franca? ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia
practices; and (3) what awareness they have of regex portability
problems1.Wedraftedoursurveybasedondiscussionswithprofes-
sionalsoftwaredevelopers,andfollowedbestpracticesinsurvey
design [51,88]. We refined the survey through internal iteration
andtwopilotrounds withgraduatestudents.
Survey deployment. After obtaining approval from our institu-
tion’sethics board,we took atwo-prongedapproach to surveying
professional developers. First, following the snowball sampling
methodology [ 16,81], we asked developers of our acquaintance
to take the survey and propagate it to their colleagues. Second,
to diversify our population, we posted the survey on popular In-
ternetmessageboardsfrequentedbysoftwaredevelopers(Hack-
erNews[1]andReddit[ 3](r/SampleSize ,r/coding,andr/compsci ).
We compensatedrespondentswitha$5 Amazongiftcard.
Filtering results. We received some invalid responses from users
on the Internet message boards. We manually inspected the first
100responsestodevelopfiltersforvalidity.Wereportonresponses
thattookatleast5minutes,wereinternallyconsistent,andgave
a łthoughtfulž answer to at least one of our open-ended questions.
This filteredout253responses, mostly from aspoofing campaign.
4.2 Results
Demographics. Wereceived158validresponsesfromprofessional
software developers. Our responses came from direct (51) and indi-
rect (25) professional contacts, and Internet message boards (73),
with no trackinginformationfor 9 responses.The medianrespon-
denthas 3-5years of professional experience,works at amedium-
size company,andclaims intermediate regex skill2(Figure1).
RQ1: Re-use Prevalence. Almost all (94%) of respondents indi-
cated that they re-use regexes, with 50% indicating that they re-use
aregexat leasthalfofthe timethat they usearegex(Figure 2(a)).
The most frequent reason to re-use a regex was to meet a common
usecase,e.g.,matchingemails.Thissupportsaprevioushypothesis
that developers may write regexes for a few common reasons [ 26].
Participants also mentioned time savings: łA good programmer
doesn’tre-inventthe wheel.ž
RQ2: Re-use Sources. Developers most frequently said they re-
use regexes from Stack Overflow, but they often re-use regexes
fromothercode,includingtheirown,acolleague’s,oropen-source
projects (Figure 2(b)). About 90% of respondents reported re-using
regexesfromsomeInternetsource,andabout90%reportedre-using
regexesfrom othercode.
RQ3:DeveloperPerceptionof LinguaFranca .Weaskeddevel-
opers if their regex design process was influenced by language.
Figure3(a)showsthat47%ofourrespondentsdonothaveadesign
process that is language specific. And their actions match their
beliefs: as shown in Figure 3(b), respondents frequently re-use
regexeswithoutbeingconfidentthattheywerewritteninthesame
language. Only 21% of respondents (34/158) were confident they
never re-usedacrosslanguageboundaries.
1Dueto space limits wedo not report allresults.
2Regexskillwasself-reportedonascalefromnovicetomaster,basedonfamiliarity
with increasingly complex regex features according to Friedl [ 40]. łIntermediate: For
example,youhaveusedmoresophisticatedfeatureslikenon-greedyquantifiers( /a+?/)
and characterclasses( /\d|\w|[abc]|[^\d]/ ).ž5 POLYGLOTREGEX CORPUS
Inordertoanswerourremainingresearchquestionsweneededa
polyglotregexcorpus :asetofregexesextractedfromalargesample
of software projects written in many programming languages. The
existing regex corpuses are small-scale [ 20,107] or include only
two programminglanguages [ 26]. Ourcorpus is neither,covering
about 200,000 projects in 8 programming languages Ð see Table 1.
Figure 1:Our survey reached adiverseset ofdevelopers.
Figure 2: (a) When developers must use a regex, they fre-
quently re-use them from another source. (b) Developers
commonly re-use fromthe Internetand other software.
Languages. Weareinterestedinstudyingcommonregexpractices,
andasaresultwefocusourattentiononłmajoržprogramminglan-
guagesdefinedbytwoconditions:(1)Thelanguagehasalargemod-
ule ecosystem; (2) The language is widely used by the open-source
community.Weoperationalizedtheseconceptsbyconsultingthe
ModuleCountswebsite[ 28]andtheGitHublanguagepopularity
report [42]. We also considered Go, Perl, and Rust for scientific in-
terest; Perl popularized the idea of regexes as a first-class language
member,andGoandRustarerelativelynewmainstreamlanguages.
Softwareprojects. Withintheselanguages,wechosetostudythe
software modules published in each language’s primary module
registryfor two reasons. First, it permits a relatively fair cross-
language comparison, since we observe that many modules fill
equivalent ecological niches, e.g.,logging or schema validation.
Second,wefeelthatmodulesareofgreatergeneralinterestthan
applications.Modulesarepublished,maintained,andusedbyamix
of open-source and commercial software developers, and bugs and
security vulnerabilitiesinmoduleshave asignificant rippleeffect.
3WealsoextractedregexesfromTypeScriptsourcecode,bytranspilingittoJavaScript.
445ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia James C.Davis,LouisG.MichaelIV,Christy A.Coghlan, Francisco Servant, andDongyoonLee
Figure 3: (a) Many developers design regexes without con-
sidering the programming language. (b) Developers’ regex
re-usedecisionsalsoimplybeliefinregexasa linguafranca .
Table 1: Our regex corpus was derived from software writ-
tenin8programminglanguages.Thefirstfivelanguagesare
ranked by the most available libraries (ModuleCounts [ 28])
and popularity in open-source (GitHub). We also studied
Go, Perl, and Rust out of scientific interest. The two final
columnsshow thecontributionto our corpus.
Lang. (Registry) Libs. GH # mod. anal. Uniqueregexes (avg.)
JavaScript3(npm) 1 1 24,997 150,922 (6.0)
Java(Maven) 2 3 24,986 19,332 (0.8)
PHP (Packagist) 3 5 24,995 44,237 (1.2)
Python(pypi) 4 2 24,997 43,896 (1.8)
Ruby (RubyGems) 5 4 24,999 153,334 (6.1)
Go(Gopm) 9 9 24,997 22,105 (0.9)
Perl(CPAN) 7 Ð 31,827 (all) 142,777 (4.5)
Rust (Crates.io) 10 Ð 11,724 (all) 2,025(0.2)
Sum: 193,524 578,628
Our goal was to analyze the most important modules in each
language’s primary module registry. To have a uniform measure
of importance across languages, we filtered each registry for the
modules available onGitHub, sorted those by thenumber ofstars,
and analyzed the top 25,000 modules from each registry. Borges
and Valente recently showed that GitHub star count is a reason-
ableproxyforimportance[ 17].Unsurprisingly,wefoundthatthe
distributionofGitHubstarswassimilarforthemodulesineachlan-
guage, and analyzing the top 25,000 modules typically captured all
butthe(verylong)tailof0-2stars.PerlandRusthadrelativelyfew
modulesintheirregistries, andwe analyzedalloftheirmodules.
Regex extraction. Following [ 26], for each module we cloned
the HEAD of its default branch from GitHub and extracted any
statically-declared regexes. We extracted regexes declared in regex
evaluations as well as regexes compiled and stored in variables for
later use. In each module we extracted regexes only from source
filesinthelanguagecorrespondingtotheregistry,omittingregexes
inplaceslike buildscripts written inanotherlanguage.Polyglotregexcorpus. Ourcorpuscontains537,806uniqueregexes
extracted from 193,524 projects written in 8 programming lan-
guages.Eachlanguage’scontributionsarelistedinTable 1.Average
regex usevarieswidelybylanguage,from 0.2regexespermodule
(Rust)upto6.1regexespermodule(Ruby).Thetotaluniqueregexes
by language exceeds 537,806 due to inter-language duplicates (ğ 6).
6 THEME2: MEASURING REGEX RE-USE
The developers in our survey indicated that they re-use regexes
from other software and from Internet sources like Stack Overflow.
They also reported re-using regexes across language boundaries.
In this theme we corroborate their report by measuring the extent
ofregex re-useÐmodulesthat use non-unique regexes.
Definitionofre-use. Tothebestofourknowledgewearethefirst
to attempt to measure regex re-use. As a first approximation, in
keeping withthephrasing inour survey(łcopy/pasting regexesž),
we label as re-use any pair of identical regexes (string equality). To
eliminate trivially identical regexes like /\s/, we conservatively
requireanymatchingregexestobeatleast15characterslong.While
it is possible that two developers might independently produce the
same (longer) regex, this seems unlikely given that hundreds of
distinct regexes have been reported even for łsimplež languages
likeemails[ 26].Wedonotconsiderlessstrictmeasuresofregex
equivalencelikestring[ 101]orbehavioral[ 20]similarity,though
suchmeasuresmightbettercapturethełShipofTheseusžapproach
to regex re-usedescribedbysomeof our survey respondents.
Findings: (RQ4)Thousandsofcorpusmodules(20%)share
thesamecomplexregexes,bothwithinandacrosslanguages.
(RQ5) 5% of all corpus modules (about 10,000), primarily in
JavaScript, use regexesfrom StackOverflowandRegExLib.
6.1 RQ4: Re-usefrom OtherSoftware
Howmuchintra-/inter-languageregexre-useoccursinourcorpus?
6.1.1 Methodology. Whendevelopingourregexcorpus(ğ 5),we
tracked the modules and registries in which each regex was found.
As noted above, we only consider as re-use candidates the regexes
that are at least 15 characters long. When such a regex appeared
inmultiplemodulesinthe sameregistry, wemarkthosemodules
ascontaininganintra-languageduplicate.Whensucharegexap-
peared in at least one module in differentregistries, we mark those
modulesascontaininganinter-languageduplicate.Note,then,that
for a single duplicated regex we may mark several modules as con-
taining intra-language duplicates and/or inter-language duplicates.
6.1.2 Results. The extent of intra- and inter-language regex re-
use by modules is shown in Figure 4(second and third bars). De-
velopers re-use regexes in the modules in every language, some
more than others. In most languages, 10% or more of the mod-
ules contain an intra-language duplicate, and inter-language dupli-
cates are also common. These duplicates are often due to łpopularž
regexes. Forexample,wefoundthe16-character ł<email>:žregex
/[\w\-]+\@([^:]+):/ in476modules.
446WhyAren’t Regular Expressions aLingua Franca? ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia
Figure 4:Empirical regex re-use practices,by language.
6.2 RQ5: Re-usefrom InternetSources
The developers in our survey frequently indicated that they re-use
regexesfromoneoftwoInternetsources:RegExLib[ 4]andStack
Overflow[ 5]. Nextwe use our corpusto corroboratetheirclaims.
6.2.1 Methodology. WeextractedregexesfromRegExLibandStack
Overflow, and then searched our corpus for matches. In both of
these relatively-unstructured Internet regex sources, the resulting
set of łregexesž may include false positives; it is the intersection
ofourcorpusandthesesetsthatisofinterest.Anintersectionis
acasewherearealregexfrom ourcorpusalsoappearedverbatim
in one of these Internet sources. Any module that contained one
ofthese(15charactersorlonger)Internetregexeswasmarkedas
containingan Internet duplicate.
RegExLib regexes. Weobtainedareasonablycompletedumpof
the RegExLibdatabasebysearching for łall regexesž.
Stack Overflow regexes. For Stack Overflow, we relied on the
łregexž tag to identify regexes. Through manual analysis we found
that questions and posts with the łregexž tag commonly denote
regexesusingcodesnippets.UsingallStackOverflowpostsasof
September 20184, we found all questions tagged with łregexž as
well as the answers to those questions and automatically extracted
codesnippetsfromthoseposts.Tofilter,wethenremovedsnippets
that containednoregex-like characters basedonTable4of[ 20].
6.2.2 Results. OurfindingsareshowninFigure 4(fourthbarfor
eachlanguage).Manyofthemodulesinourcorpuscontainatleast
oneInternetregex.ThispracticeismostcommoninJavaScriptÐ
15%ofnpmmodulescontain an Internet regex.
7 THEME3: EMPIRICALPORTABILITY
Having shown that developers re-use regexes across language
boundaries, now we experiment on our polyglot regex corpus to
investigatetheimplicationsofcopy/pastingaregexfromonelan-
guagetoanother.Firstweconsidersemanticportability(ğ 7.1),then
performance portability (ğ 7.2).
Experimentalparameters. Theseexperimentswereperformed
ona 10-node cluster of server-class nodes. We usedthe same base
toolsinbothexperiments:atesterforeachofthe8languages.Each
4Seehttps://archive.org/download/stackexchange/stackoverflow.com-Posts.7z .Table2:Summaryoflanguageversionsanddocsusedinour
experiments. Most are at the default forUbuntu 16.04.
Language Version information Documentation
JavaScript Node.js v10.9.0(V8 v6.8) [ 31,32]
Java OracleJDK 8 [ 23]
PHP PHP 7.4.0-dev(cli) [ 44]
Python Python3.5.2 [ 37,53]
Ruby Ruby 2.3.1p112 [ 18]
Go Go v1.6.2 [ 43]
Perl Perlv5.22.1 [ 2,54,97]
Rust Rust v1.32.0(nightly) [ 30]
testeracceptsaregexpatternandinputandattemptsapartialregex
match. Table 2liststhe languageversionsusedinour tests.
When we compare a regex’s behavior in a pair of languages, we
use the subset of the regex corpus that is syntactically valid in that
pair.Thissimulatestheregexre-usepracticesweidentified.Most
comparisons are on the majority of the corpus Ð 76% of the corpus
wasvalid inevery language,and88%were valid inallbut Rust.
Findings: (RQ6) 15% of regexes exhibit documented and un-
documented semantic differences. (RQ7) 10% of regexes ex-
hibitperformance differences due to regex engine algorithms
andoptimizations.
7.1 RQ6: Semantic Portability Problems
When two languages express the same feature using different syn-
tax,developersfaceatranslationproblem.Butwhentwolanguages
exhibit different features (or behaviors) for the same syntax, devel-
opersmustsolveasemanticproblem.Inthissectionweempirically
study the semantic portability problems that developers mayface.
7.1.1 Methodology. To understandvariations in regex semantics,
we testedthe behaviorofeachregexinour corpusonavarietyof
inputsineachlanguageofinterest.Anyinconsistentregexbehavior
across languages is something a developer would have to discover
andaddressafter re-using the regex.
Input generation. In search of an interesting set of inputs, we
created an ensemble of five state-of-the-art regex input generators:
Rex [100], MutRex [ 11], EGRET [ 56], ReScue [ 87] and Brics [ 65].
Thesegeneratorsproduceeithermatchingstrings(Rex,Brics)or
both matching and mismatching strings (MutRex, EGRET, ReScue).
WeusedRex,MutRex,andEGRETunchanged.WemodifiedReScue
tousethestringsitexploresinitssearchforSLinputs.Wemodified
Brics to generate random input subsets, not infinitely many inputs.
Wewantedtheseinputstoprovidegoodregexautomatoncover-
age. Wang and Stolee showed that100 Rex-generated inputs yield
about 50% regex coverage [ 102], so we requested 10,000 inputs
from each input generator with a time limit of 10 seconds. Table 3
summarizes the number of unique inputs generated for each regex.
Attempted match. For each regex, for each input, for each pro-
gramming language that supported it, we tested for a match using
partial-matchsemantics5.Onamatch,werecorded(1)thesubstring
that matched,and(2) the contentsof capture groups.
5We used default flags. As the 8 languages in our study support around 20 distinct
regexflags,evaluatingameaningful subset of the flagcombinationswas infeasible.
447ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia James C.Davis,LouisG.MichaelIV,Christy A.Coghlan, Francisco Servant, andDongyoonLee
Table 3:Statistics forsemantic portability experiment.
Metric Value
Percentileinputsperregex: 25th-50th-75th1,057-2,410-2,510
Regexeswithany difference witnesses 15.4%(82,582)
Regexeswithany matchwitnesses 8.1% (43,417)
Regexeswithany substring witnesses 4.2% (22,597)
Regexeswithany capturewitnesses 7.5% (40,457)
Witnesses. Some pairs of languages may perfectly agree on the
behavior of a regex on all of its inputs; others may not. We refer
to(reдex,input)pairsthatproducedifferentbehaviorindifferent
programming languages as difference witnesses between those lan-
guages,anddistinguishbetween three disjointtypes ofwitnesses:
(1)Matchwitness :Languagesdisagreeonwhetherthereisamatch.
(2)Substring witness : Languages agree that there is a match but
disagree aboutthe matching substring.
(3)Capture witness : Languages agree on the match and the match-
ingsubstring,butdisagreeaboutthedivisionofthesubstring
intoany capture groupsofthe regex.
7.1.2 Results. Table3summarizesourresults.About15%ofregexes
participatedinatleastonedifferencewitness,andamongthelan-
guagepairsweobservedallthreeclassesofwitnesses.InTable 3
andFigure 5wereportthenumberofdistinctregexesparticipating
in the difference witnesses rather than the number ofdistinct wit-
nesses themselves, because we expect that many of the witnessing
inputs for a given regex are members of an equivalence class on
whichadifference manifests.
Amoredetaileddescriptionofthesemanticdifferencesbetween
languages is presented in Figure 5. The cells are colored propor-
tionaltothenumberofregexesthathaveanywitnessofadifference
betweenthatpairoflanguages.Thethreenumbersinthecellde-
note the percent6of regexes with match, substring, and capture
witnesses for that pair of languages. As can be seen in Figure 5:
there are many language pairs with match witnesses; PHP and
Python are the primary sources of substring witnesses; and PHP is
the primary sourceofcapture witnesses.
7.1.3 Analysis. Wedevelopedanautomatictool,the Cross Examiner ,
toestimatethecausesofthedifferencewitnessesidentifiedthrough
our experiment. We iteratively examined unclassified witnesses,
referenced the regex documentation for the disagreeing languages
(Table2), understood the reason for the different behaviors where
documented, and encoded heuristics to classify witnesses as due to
thisbehavior. Thecauseswe identifiedaresummarized inTable 4.
Approximately 98% (80,736/82,582) of witnesses could be explained
byone ormore ofthesecauses.
Table4differentiatesthewitnessesbytype.Thefirstgroupof
witnessesarecaseswheresomelanguagessupportafeaturethat
others do not. In the second group, languages use the same syntax
fordifferentfeatures.Thethirdgrouparecaseswherelanguages
use the same syntax for the same features but exhibit different
behavior.The final group are bugswe identified,describedbelow.
6At the scaleof ourcorpus,eachpercentage pointrepresents about 5,300regexes.
Figure5:(Symmetric)Pairwiseviewofdifferencewitnesses
by language and type. The individual cells indicate the
percent of the regex corpus with at least one (M)atch,
(S)ubstring, and (C)apture witnesses in that language pair,
anddarkercellsindicatethatregexesmorecommonlyhave
difference witnesses in that pair of languages. For example,
Java,Go,andRust generally agree on regex behavior.
Documented semantics. Westudiedeachlanguage’sregexdoc-
umentation (Table 2) to see if these witnesses could be easily ex-
plained.ComparingthegreycellsandboldfacinginTable 4,wenote
that more than half of the łunusualž behaviors were unspecified in
that language’s documentation. Testing, not reading the man-
ual, istheonlyway fordevelopers to learn these behaviors.
7.1.4 RegexEngineTesting. Thoughinthisexperimentweassumed
thattheregexenginesweretrustworthy,ourmethodologycanbe
viewedasamixoffuzz[ 22]anddifferential[ 62]testing.Undera
lingua franca hypothesis, if languages disagree then at least one of
themiswrong.Duringourexaminationofdifferencewitnesses,we
identified five cases where one language disagreed with the others
andits behavior was inconsistent with the corresponding regex
documentation. We opened bug reports based on the behaviors
brieflydescribedinthethirdsectionofTable 4.Sofarthebugshave
been confirmedinV8-JavaScript, Python,Ruby,andRust.
7.2 RQ7: Performance Portability Problems
Programming languages have distinct regex engines which may
exhibitdifferentperformancecharacteristics.Are-usedregexmight
have worse worst-case performance in its new language than in its
languageoforigin.Forexample,softwarebeingportedfromPHP
to Node.js might develop Regular expression Denial of Service (Re-
DoS) vulnerabilitiesbecauseregexes often have worse worst-case
performance in Node.js. In this experiment, we measure the fre-
quency with which regexes have different worst-case performance
characteristics indifferentprogramming languages.
7.2.1 Methodology. WegenerallyfollowthemethodologyofDavis
etal.[26]andusetheirtoolsInbrief,foreachregexwe(1)query
an ensemble of state-of-the-art super-linear regex detectors, and
448WhyAren’t Regular Expressions aLingua Franca? ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia
Table 4: Difference witnesses identified during our semantic portability experiment. Each row indicates a witness regex, the
expected behavior(s), and each language’s interpretation. The first three groups describe different classes of valid but seman-
tically distinct behavior. The final group describes the bugs we found; E- means Engine, D- means Docs. Boldface indicates
potentially-surprisingbehavior(cf.ğ 8).ł-žindicateslanguageswhereafeaturecausessyntaxerrors.Thebehaviorinthegrey
cellswas notspecified inthedocumentation.
Witness Description JavaScript Java PHP Python Ruby Go Perl Rust
False friends 1: Regexnotationdescribes afeaturein onelanguage andnofeaturein another.
/\Qa\E/ Quote directive; łQaEž łQaEž Quote Quote łQaEž łQaEž Quote Quote -
/\G/ Matchassertion ; łGž łGž Assertion Assertion łGž Assertion -Assertion -
/\Ab\Z/ Anchors; łAbZž łAbZž Anchors Anchors Anchors Anchors -Anchors -
/a\z/ Endof line; łazž łazž EOL EOL łazž EOL EOL EOL EOL
/\K/ Matchreset ; łKž łKž - Reset łKž Reset - Reset -
/\e/ ESC ; łež łež ESC ESC łež ESC - ESC -
/\cC/ ctrl-C ; łcCž ctrl-C ctrl-C ctrl-C łcCž ctrl-C -ctrl-C -
/\x{41}/ łAž(hex); łx...xž łx...xž łAž łAž - - łAž łAž łAž
/(a)\g1/ Backref notation ; łag1ž łag1ž - Backref łag1ž łag1ž -Backref -
/(a)\g<1>/ Backref notation ; łag<1>ž łag<1>ž - Backref łag<1>ž Backref - - -
/\p{N}/ Unicodedigit; łpNž łp{N}ž 1 1 łp{N}ž 1 1 1 1
/\pN/ Unicodedigit; łpNž łpNž Digit Digit łpNž łpNž Digit Digit Digit
/[[:digit:]]/ Digit; Custom Char. Class(CCC) CCC CCC Digit CCC Digit Digit Digit Digit
False friends 2: The same regexnotationdescribes different features.
/^a/ ^ : Beginningof input orline Input Input Input Input Line Input Input Input
/a++/ Possessivequantifier; regular -Possessive Possessive -Possessive -Possessive Regular
/(a)\1/ Backref ; octal Backref Backref Backref Backref Backref -Backref Octal
/\h/ Horz.whitespace; Hex;łhž łhžWhitespace Whitespace łhž Hex -Whitespace -
Nuanced:The same regexnotationdescribes the same feature,but engines exhibit subtlydifferent behavior.
/(a)(?<b>b)/ Named and unnamed capturegroups? Both Both Both -Named only - Both -
/[]]/ CCCof ł]ž ; empty CCC+ł]ž Empty ł]ž ł]ž ł]ž ł]ž ł]ž ł]ž ł]ž
/((a*)+)/ Diff.captureof \2 onłaaž \2: łaaž \2: empty \2: empty \2: empty \2: empty \2: łaaž \2: empty \2: łaaž
/((a)|(b))+/ Diff.captureof \2 onłabž Empty łaž łaž łaž łaž łaž łaž łaž
Bugswefound in regexengines.
E-Python: /(ab|a)*?b/ Diff.captureof \1 oninput:łabž łaž łaž łaž Empty łaž łaž łaž łaž
E-Rust:/(aa$)?/ Matched substring onłaazž Empty Empty Empty Empty Empty Empty Empty łaaž
E-Rust:/(a)\d*\.?\d+\b/ Matched substring onła0.0c ž ła0ž ła0ž ła0ž ła0ž ła0ž ła0ž ła0ž ła0.0ž
E-JavaScript: Complicated Input ordermatters? Yes No No No No No No No
D-OracleJava: /$\s+/ $ matchesbeforefinal \r? No Yes No No No No No No
D-Ruby:/a{2}?/ Lazyłaaž ; optional łaaž Lazy Lazy Lazy Lazy Optional Lazy Lazy Lazy
then(2)evaluateanypredictedsuper-linearregexbehaviorsineach
languageofinterestusing partial-matchsemantics.
Experimentalparameters. Weallowedeachofthedetectorsto
evaluate a regex for up to 60 seconds using no more than 2 GB
of memory. If a detector predicted that a regex would be super-
linear, we evaluated its proposed worst-case input in each of the
8 languages in our study using input strings intended to trigger
exponentialorpolynomialbehavior7.Ifaregexmatchtookmore
than10 secondsinsomelanguage,we markeditas super-linear.
Reducingfalsepositives. Weextendedtheirmethodologyintwo
waystoreducethenumberoffalsenegatives( i.e.,SLregexesmarked
as linear-time). First, we added Shen et al.’s new dynamic SL regex
detector [ 87] to their ensemble ([ 75,104,107]). More critically, we
introduce a new technique that identifies both polynomial and
exponential SL regexes that their detector ensemble would not
detect.Thestaticdetectorsintheirensemble:(1)assumefull-match
semantics, and (2) do not scale well to regexes with large NFAs.
We combat these problems by querying detectors with the original
regex as well as regex variants that they can more readilyanalyze.
Thefirstqueryvariantaddressesan unrealisticassumption inthe
analysisperformedbysomeofthedetectorsintheensemble([ 75,
104,107]). Although thesedetectors assumethat the regex engine
7Weused 100pumps for exponential and 100,000 pumps for polynomial.is using full-match semantics, regex engines generally default to
partial-matchsemantics.Forexample,somedetectorspredictlinear
behavior for /a+$/, but it is quadratic in many languages when
used with a partial-match API. To address this assumption, we
query the detector ensemble with an (anchored) full-match variant
ofunanchoredregexes, e.g.,/^[\s\S]*?a+$/ .
Thesecondqueryvariantaddresses inefficientimplementations
in the detector ensemble. Some of the detectors exceed our time
limit on regexes with large NFA representations. For example, they
time out on the (exponential) regex /(a{1,1000}){1,1000}$/ be-
cause its NFA explodes in size. To account for this inefficiency, we
query the detector ensemble with variants that replace bounded
quantifiers withunboundedones, e.g.,/(a+)+$/ .
Thesevariantsreducetherateoffalsenegativeswithoutintro-
ducingfalsepositives.Althoughwequerythedetectorensemble
on several variants, we always test any worst-case input on the
originalregex(dynamic validation).Thefirst variantmay unmask
polynomialregexesthatwouldotherwisegoundetected,andthe
secondmayidentifyboth polynomialandexponential regexes.
7.2.2 Results. Figure6illustratestheextenttowhichtheregexes
in our polyglot corpus exhibit worst-case super-linear behavior in
eachofthe 8languagesunderstudy.
Figure6indicatesthatSLregexesmaybemorecommonÐbyup
toanorderofmagnitude!Ðthanwaspreviouslyreported[ 26].The
449ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia James C.Davis,LouisG.MichaelIV,Christy A.Coghlan, Francisco Servant, andDongyoonLee
Figure 6: Proportion of SL regexes in each language. There
are three distinct families of worst-case regex performance.
We identified no regexes with exponential behavior in Go
and Rust, and only 6 regexes had polynomial behavior in
thoselanguages.Regexeswithexponentialbehaviorarerare
inPHPandPerl(Perlś227;PHPś0),butpolynomialbehav-
iorstilloccurs.Incontrast,over1,000regexeshaveexponen-
tialbehaviorinRuby,Java,JavaScript,andPython,andpoly-
nomialbehaviorisalsomore commoninthoselanguages.
majorityofthenewly-discoveredregexeswereidentifiedthrough
our variant testing technique; as expected, the new detector by
Shenet al.[87] identified only exponential regexes (1,421 of them).
Our results agree with a small-scale estimate in Java [ 107]. Al-
thoughFigure 6doesnotprovideadirectcomparisonto[ 26],the
same larger proportions occur when considering the subset of our
corpusderivedfrom JavaScript andPython(as theirswas).
7.2.3 Analysis. Theproportionofregexesthatexhibitexponential
andpolynomialworst-casebehaviorvarieswidelybylanguage.The
regex engines in these languages appear to fall into three families:
(1)Slow(JavaScript,Java,Python,Ruby);(2) Medium(PHP,Perl);
and (3)Fast(Go, Rust). To clarify this taxonomy, Figure 7shows
the frequency with which regexes exhibit worsebehavior in one of
apairoflanguages.Forexample,weseethatthe~10%ofregexes
thataresuper-linearinbothJavaandJavaScript(cf.Figure 6)are
thesameregexes.Theworst-caseperformanceofa regexgenerally
worsens when moved between these families, but not within them.
Inthissectionweexplorethereasonsbehindthesethreefamilies
ofregexperformance.Westudiedthelanguagedocumentationand
the implementation of these engines and identified a variety of
mechanisms by which some regex engines fall prey to super-linear
behaviorandothersavoid it.
Documented performance. We studied each language’s regex
documentation(Table 2)toseewhetheritsworst-caseperformance
isdiscussed.JavaScript,Java,andPythononlyprovidetipsonmi-
nor optimizations. PHP and Ruby comment vaguely on worst-case
performance: łcan take a long time to runž [ 44]. The best docu-
mentation explicitly states worst-case expectations: linear (Rust
and Go) or exponential (Perl). Similar to the semantic behaviors
in Table4, in most languages these performance differences can
only be identifiedthroughexperimentation.
Figure 7: Pairwise view of regex performance differences.
Cellsarecoloredaccordingtothenumberofregexesthatex-
hibitworsebehaviorinthedestination(row)thanthehypo-
theticalsource(column).Darkerrowsaredangerousdestina-
tions;theindividualcellscontainthepercentoftheregexes
supported in that language pair whose worst-case perfor-
mance is worse in the destination. For example, regexes do
not perform any worse in JavaScript than Java, but 8% of
regexesperformworsewhenmovedfromRusttoJavaScript.
Underthehood. The primary distinctionbetween these families
is their core regex matching algorithms and varying support for
super-linearregexfeatures( e.g.,backreferences[ 9]).GoandRust
offerlinearbehaviorbecausetheyprimarilyrelyonThompson’s
algorithmforlinear-timeregexevaluations[ 95],thoughinconse-
quence they offer a limited set of regex features. In contrast, the
remaining 6 languages perform regex matches using some variant
ofSpencer’sbacktrackingalgorithm[ 91].Thompson’salgorithmis
similartoabreadth-firsttraversaloftheNFAgraph,whileSpencer’s
is analogous to a depth-first traversal. Some implementations of
the Spencer-style DFS may exhibit super-linear behavior due to
redundant state visits, though there are also truly exponential (NP-
complete) regexeswithbackreferences [ 9,15].
Within the set of Spencer engines, though, there are distinct
MediumandSlowFamilies.Inourexperiments,exponentialbehav-
ior was unusual in PHP and Perl, while it occurs at about the same
ratesinJava,JavaScript,Python,andRuby.Similarly,PHPandPerl
havealowerincidenceofpolynomialbehaviorthandotheother
Spencerengines.Thedifferencesbetweenthesetwofamiliescan
be attributedto amixof defensesandoptimizations .
Tothebestofourknowledge,PHPandPerlaretheonlySpencer
enginesinourstudythathaveexplicitdefensesagainstexponential-
timebehavior.Bothlanguagesrelyon counterstotracktheamount
ofworkperformedduringamatch,andifaregexevaluationexceeds
a threshold it is terminated with an exception. In experiments, we
foundthatthesecountersareincrementedsuchthatexponential
searches may trigger the threshold but poly-time searches will not.
Perladditionallymaintainsa cacheofvisitedstatesinordertoshort-
circuit redundant paths through the NFA, permitting it to evaluate
450WhyAren’t Regular Expressions aLingua Franca? ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia
somesearchesinlineartimethattakepolynomialorexponential
time inotherSpencer engines.
In addition to their exponential defenses, PHP and Perl both
haveoptimizationsthatactasasafeguardagainstpolynomialregex
enginebehavior.Forpartialmatches,someregexengineswilltry
every possible starting offset in the string, trivially leading to poly-
nomialbehavior.PHPandPerlhaveoptimizationstoprunethese
starting offsets, and these optimizations appear to reduce the in-
cidenceofpolynomialbehaviorinthoselanguages.Therelevant
optimizationsseemtobe:(1)skippingaheadtoplausiblestarting
points,and(2) filtering outinputsthat lacknecessary substrings.
Tothebestofourknowledge,thisisthefirstdescriptionofthese
real-worldregexenginemechanismsinthescientificliterature8.We
hopeourfindingswillinformthemaintenanceanddevelopment
ofregex enginesthat are less susceptible to super-linear behavior.
Three families, nottwo? Inourexperimentsweweresurprised
tofindthreefamiliesofregexengineperformanceinsteadofthe
two previously described by Cox [ 24]. Perhaps based on Cox’s
analysis, others argued that exponential regex behavior in Java
would translate to PHP [ 87]. The defenses and optimizations we
identifiedinPHPandPerl have previously gone unremarked.
8 REGEX BUGS
Semantic bugs. Although developers may identify some seman-
tic regex problems during testing, others may cause unexpected
regex behaviorinpractice.To estimatethefrequencyofsemantic
problems in practice, we developed linter-style tools to identify
regexes that use features that are unavailable in their language
(Table4).Forexample,inJavaScripttheanchornotation /\Ab\Z/is
interpretedliterallyasAbZ,butdeveloperswhousethisnotationin
JavaScript projects probably intend anchors. Among the JavaScript
(npm)modulesfromwhichwederivedourcorpus,weidentified31
modules that used this notation. In total we identified hundreds of
modules containing potential semantic regex bugs. We have begun
opening bugreports against thesemodules.
It is possible that these regexes were derived from copy/paste
practices. However, developers might introduce such bugs even
when designing regexes from scratch, since they may design them
basedona(supposed)regex linguafranca thatdoesnotextendto
the languageinwhichthey are developing(cf.Figure 3).
ReDoS regexes. The super-linear regexes we identified represent
potentialReDoS vectors. Afterfilteringout regexes thatappear in
pathslike testorbuild,wehaveinitiatedtheresponsibledisclosure
processto informthe developersof14,495modulesaboutpotential
security vulnerabilities.
9 DISCUSSION AND FUTUREWORK
Considerations: software engineers. Our findings suggest that
portingregexesacrosslanguageboundaries, e.g.,fromothersoft-
wareprojectsorfromStackOverflow,isapotentiallyriskyactivity.
Subtlesemanticandperformanceissuescanoccurandshouldbe
8Besides our description, we are only aware of descriptions of these defenses in
discussionforumposts[ 69]andthesourcecodeitself( e.g.,seeline7835of[ 70]).These
mechanismsarenot described in the PHP and Perldocumentation that westudied.consideredbydevelopersintroducingregexesinto theircode.Un-
fortunately,thelargestdevelopercommunitiesareinthelanguages
mostvulnerable to ReDoS(cf.Table 1andFigure 6).
Wehavereleasedourmany-languagetoolstohelpdevelopers
understand the possible risks of regexes. Our tools can test the
semantic and performance of regexes in many languages on many
inputs.We hope Table 4willbe auseful reference for developers.
Recommendations:programminglanguagedesigners. Weem-
pathize with the developers we surveyed who expected regexes
to behave consistently across programming languages. We believe
that regexes should truly be the lingua franca many developers
alreadybelievethemtobe.Wesuggestthathavingthefastestor
most feature-rich engine is not worth the cost of regex portability
problems. Perhaps supported by researchers, programming lan-
guage designers could agree on a universal regex specification and
relieve software engineers of the burden of reconciling regexes
across languages. We acknowledge that diversity and competition
sometimesimproveoutcomesforusers,butregexesareamature
technology andunifyingtheir behaviormakes sense.
Each language’s regex documentation currently focuses only on
itsownsyntaxandsemantics.Werecommendthatregexdocumen-
tationadditionallydescribeitsdeviationsfromexternalspecifica-
tion(s),e.g.,PCRE[46]orPX-BRE[ 47].Explicitlydiscussingincom-
patibilities will inform developers of łgotchasž, and it will have the
indirect effect of reminding them that regexes are (currently) not a
linguafranca .Longerterm,explicitlyconsideringeachlanguage’s
divergence from specification(s) will help designers reach agree-
ment on a next-generation universal regex specification. Lastly,
languagesshould document their worst-case regex performance.
We recommend that language designers in the łSlow Familyž
(JavaScript, Java, Python, Ruby) of regex engines adopt techniques
fromthełMediumFamilyž(PHP,Perl)toreducetheincidenceof
ReDoSvulnerabilitiesinthesepopular languages.
Corpus applications. Our polyglot regex corpus is a promising
basisfor further research. Clearly developers searchfor regexes Ð
canweadaptsemanticcodesearchtechniques[ 50]tothediscovery
of relevant regexes? And do developers have different regex needs
indifferentprogramminglanguagesÐdothesedifferencesmanifest
inmeasurableways,andshouldthisaffecttheregexfeaturesupport
oroptimizations usedinregex engines?
Regextools andregex engines. Motivatedbythiswork,ween-
visionaregexłuniversaltranslatoržtohelpdevelopersportregexes
betweenlanguages.Thistaskiscomplicatedbyincompleteregex
specifications, different feature supportindifferent programming
languages, and performance variations. As a starting point, van
der Merwe et al.’s work on regex transformations that preserve
semantics but changeperformance seems promising[ 98].
We believe that two directions for regex engine research are
promising.First,weaccidentallyidentifiedbugsinfourregexen-
gines(ğ7.1.3).Testingregexenginesbyrefiningregexsemanticsand
applying model-checking techniques will improve the developer
experience. Second, we suggest that most ReDoS vulnerabilities
canbesolvedattheregexenginelevelbyrefiningandenhancing
the optimizations already present in Perl and PHP (ğ 7.2.3). Care
willbe needed,however,to avoid changing regex semantics.
451ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia James C.Davis,LouisG.MichaelIV,Christy A.Coghlan, Francisco Servant, andDongyoonLee
OtherLinguaFrancas .Whatistheimpactofotherł linguafranca
problemsžinsoftwareengineering?Forexample,howdodevelopers
account for variations in SQL dialects, Markdown specifications,
software compilers, and browser JavaScript support, and what are
the consequenceswhen they fail to doso?
10 THREATS TO VALIDITY
Internal validity. Survey.Our survey instrument has not been
validated [ 51]. We assume the survey respondents who survived
our łbogus responsežfilterrepliedingoodfaith.
Performance portability. Our results assume that the SL regex
detector ensemble is effective. These detectors were designed with
the naive Spencer-style regex engines in mind (łSlow familyž) and
mightmissSLregexesintheMediumandFastfamilies.Forexample,
itisnotclearwhetherthedefensesofPHPandPerlaresoundor
simply effective against thesedetectors’ inputs.
Externalvalidity. Regexcorpus. Ourmethodologyforprocuring
theregexcorpusfacestwothreats.First,ourcorpusiscomposed
onlyofstatically-declaredregexes.Togeneralize,weassumethat
either most regexes are statically declared, or that dynamically-
declaredregexeshavesimilarproperties.Second,weonlyextract
regexes from modules. We do not know whether developers follow
thesameregexpracticeswhenwritingregexesinmodulesandin
applications,soour results maynot generalize to applications.
Construct validity. Regex re-use. We took a simple approach to
identifying regex re-use in our corpus: exact string matches for
regexesatleast15characterslong.Wechosethisthresholdbased
on our assessment of regexes more or less likely to have been
independentlyderivedbymultipledevelopers.However,theremay
havebeenshorterre-usedregexes,longerindependently-derived
regexes, and many regexes that were re-used with modifications to
tailor themto specific use cases.
Ourdefinitionofre-usedoesnotaccountforthepossibilityof
wholesalefileduplication,whichisnottrueregexre-use.Filedu-
plication would only affect our intra-language regex re-use results.
11 RELATED WORK
Empirical studies of regexes. Theempiricalstudyofregexuse
is a recentendeavor,with severallines ofresearch. Chapman and
StoleeassessedtheuseofdifferentregexfeaturesinPython[ 20].
Usingthatcorpus,Chapman etal.assessedtherelativeunderstand-
abilityofregexsynonymstodeterminecommunitypreferences[ 21].
WangandStoleereportedthatregexesare poorlyunittested inJava
applications[ 102],thoughthismightbeduetodeveloperprocesses
notcapturedbyversioncontrol, e.g.,usingregexcheckingtools[ 55].
Our polyglot regex techniques will enable generalizing some of
theseresults to otherprogramminglanguages.
Softwarere-use:othercode. Software re-use is a prevalent prac-
ticeinsoftwareengineering[ 14,33,39,86].Developersre-usecode
fromtheirownorotherprojects[ 89],introducing codeclones [41,
79]. Multiple studies estimate that more than 50% of the code in
GitHub is duplicated [ 58,64], with similar ratios for Android appli-
cations [80].
Whether code clones are good practice is a matter of debate.
Some researchers have pointed out the benefits of code clones [ 68],
and found little difference between cloned and non-cloned codein qualities such as comprehensibility [ 83] and defect-proneness
[74,84].Butotherstudieshaveexaminednegativeeffectsofcloning
code[49],suchasmaintenancedifficulties[ 38]duetofrequent[ 59]
butinconsistent[ 52]changes.Asaresult,awidevarietyoftech-
niques have been proposedto detectcode clones, e.g.,[76,79,82].
To the best of our knowledge, our paper presents the first study
ofregex re-useandthe problems that can arisefrom it.
Software re-use: Internet forums. Researchers have also stud-
iedsoftwarere-usefromInternetforums.Multiplestudiesfound
evidence of code flow from Stack Overflow to software reposito-
ries [109], and found that code frequently flows, although some-
timeswithoutrespectinglicenseterms[ 10]orauthorshipattribu-
tion [12]. Researchers have also studied the interplay of developer
contributionsto both resources[ 99].
GiventheprevalenceofcodesnippetsinStackOverflow,mul-
tiple tools have been proposed to help developers re-use them,
e.g.,to automatically generate comments [ 106], or to augment the
IDE [72,73]. However, some problems have been identified with
reusingcodesnippetsfromStackOverflow, e.g.,quality[67]andus-
ability [108]. Furthermore, other studies have identified particular
threats with code re-use from Stack Overflow, such as API mis-
use [110], security vulnerabilities [ 36,63], or unreadable code [ 96].
InthispaperwefoundthatInternetforumsarealsoapopular
source of regex re-use among developers, and we observed similar
risks: feature mis-useandReDoSvulnerabilities.
Migration. Researchershavelongdiscussedthedifficultiesofcode
migration [ 29,48,60,77,94,103]. As new technologies emerge, so
donewmigrationtools, e.g.,within[13]andbetweenlanguages[ 34,
61,66,71,85,93,111]andframeworks [ 35,45,57].
Our work shows that regexes are (currently) not a lingua franca ,
creating an opportunity for toolsfor regex migration.
12 CONCLUSION
Regexesarenota linguafranca .Althoughabout92%ofregexeswill
compileinmostprogramminglanguages,theirapparentportability
masksproblemsofcorrectnessandperformance.Weempirically
investigated the extent and causes of these portability problems,
offering the first empirical perspective on regex portability. In the
processweidentifiedhundredsofmoduleswithpotentialsemantic
problemsandthousandswithpotentialperformanceproblems,plus
documentation andimplementationerrorsinpopular languages.
Unfortunately,butquiteunderstandably,abouthalfofthesoft-
ware developers we surveyed believe and act as though regexes
are alingua franca . We hope that this paper increases developer
awareness of regex portability problems. We also hope to motivate
languagedesigners towardregex standardization.
REPRODUCIBILITY
An artifact containing our survey instrument, regex corpus, and
analysesisavailable at https://doi.org/10.5281/zenodo.3257777 .
ACKNOWLEDGMENTS
A. Kazerouni and R. Davis advised us on data analysis. J. Donohue
andE.Deramsharedinsightsaboutdeveloperre-usepractices.This
work was supported in part by the National Science Foundation
grant CNS-1814430.
452WhyAren’t Regular Expressions aLingua Franca? ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia
REFERENCES
[1] [n.d.]. Hacker News. https://news.ycombinator.com/ .
[2][n.d.]. Perl Regular Expressions - Perl. https://perldoc.perl.org/5.22.0/perlre.
html.
[3] [n.d.]. Reddit. https://www.reddit.com/ .
[4][n.d.]. Regular Expression Library. https://web.archive.org/web/
20180920164647/http://regexlib.com/ .
[5][n.d.]. StackOverflow-Regextag. https://stackoverflow.com/questions/tagged/
regex.
[6]2009. regex(7) - Linux manual page - POSIX.2 regular expressions. http://man7.
org/linux/man-pages/man7/regex.7.html .
[7]2013. Debuggex: A Composable Regex Repository. https://web.archive.org/
web/20170222084629/https://www.debuggex.com/blog/2013/a-composable-
regex-repository/ .
[8]2018.TagsśStackOverflow. https://web.archive.org/web/20180919183037/https:
//stackoverflow.com/tags?tab=popular .
[9]AlfredVAho.1990. Algorithmsforfindingpatternsinstrings . Elsevier,Chapter5,
255ś300.
[10]LeAn,OnsMlouki,FoutseKhomh,andGiulianoAntoniol.2017. StackOverflow:
Acodelaunderingplatform?.In InternationalConferenceonSoftwareAnalysis,
Evolutionand Reengineering (SANER) . IEEE.
[11]Paolo Arcaini, Angelo Gargantini, and Elvinia Riccobene. 2017. MutRex: A
Mutation-Based Generator ofFault DetectingStringsforRegularExpressions.
InInternationalConferenceonSoftwareTesting,VerificationandValidationWork-
shops(ICSTW) .
[12]Sebastian Baltes and Stephan Diehl. 2018. Usage and attribution of Stack Over-
flowcodesnippetsinGitHubprojects. EmpiricalSoftwareEngineering (2018),
1ś37.
[13]EarlT.Barr,MarkHarman,YueJia,AlexandruMarginean,andJustynaPetke.
2015. Automated Software Transplantation. In International Symposium on
SoftwareTestingand Analysis(ISSTA) .
[14]VeronikaBaueretal .2016. Comparingreusepracticesintwolargesoftware-
producing companies. Journal ofSystemsand Software 117(2016), 545ś582.
[15]Martin Berglund and Brink Van Der Merwe. 2017. Regular Expressions with
Backreferences.In PragueStringology . 30ś41.
[16]Patrick Biernacki and Dan Waldorf. 1981. Snowball Sampling: Problems and
TechniquesofChainReferralSampling. SociologicalMethods&Research 10,2
(11 1981),141ś163.
[17]HudsonBorgesandMarcoTulioValente.2018. What’sinaGitHubStar?Un-
derstanding Repository Starring Practices in a Social Coding Platform. Journal
of Systems and Software 146 (2018), 112ś129. https://doi.org/10.1016/j.jss.2018.
09.016
[18]James Britt and Neurogami Secret Laboratory. [n.d.]. Regexp - Ruby. https:
//ruby-doc.org/core-2.3.1/Regexp.html .
[19]Cezar Câmpeanu and Nicolae Santean. 2009. On the intersection of regex
languages with regular languages. Theoretical Computer Science 410, 24-25
(2009), 2336ś2344.
[20]Carl Chapman and Kathryn T Stolee. 2016. Exploring regular expression usage
andcontextinPython. InternationalSymposiumonSoftwareTestingandAnalysis
(ISSTA)(2016).
[21]Carl Chapman, Peipei Wang, and Kathryn T Stolee. 2017. Exploring Regular
ExpressionComprehension. In AutomatedSoftwareEngineering (ASE) .
[22]ChenChen,BaojiangCui,JinxinMa,RunpuWu,JianchaoGuo,andWenqian
Liu. 2018. A systematic review of fuzzing techniques. Computers & Security 75
(2018), 118ś137.
[23]OracleCorp.[n.d.]. Pattern-Java. https://docs.oracle.com/en/java/javase/11/
docs/api/java.base/java/util/regex/Pattern.html .
[24]RussCox.2007. Regular ExpressionMatchingCanBe SimpleAndFast(butis
slowin Java, Perl,PHP, Python,Ruby, ...).
[25]Scott Crosby. 2003. Denial of service through regular expressions. USENIX
Securitywork inprogressreport (2003).
[26]James C Davis, Christy A Coghlan, Francisco Servant, and Dongyoon Lee. 2018.
The Impact of Regular Expression Denial of Service (ReDoS) in Practice: an
EmpiricalStudyattheEcosystemScale.In TheACMJointEuropeanSoftwareEn-
gineering Conference and Symposium on the Foundations of Software Engineering
(ESEC/FSE) .
[27]JamesCDavis,EricRWilliamson,andDongyoonLee.2018. ASenseofTime
for JavaScript and Node.js: First-Class Timeouts as a Cure for Event Handler
Poisoning.In USENIXSecuritySymposium(USENIXSecurity) .
[28]ErikDeBill.[n.d.]. ModuleCounts. http://modulecounts-production.herokuapp.
com/.
[29]ArievanDeursen,PaulKlint,andChrisVerhoef.1999. ResearchIssuesinthe
RenovationofLegacySystems. FundamentalApproachestoSoftwareEngineering
1577 (1999), 1ś21.
[30]The Rust Project Developers. [n.d.]. regex - Rust. https://docs.rs/regex/1.1.0/
regex/.
[31]MDN WebDocs. [n.d.]. RegExp- JavaScript. https://developer.mozilla.org/en-
US/docs/Web/JavaScript/Reference/Global_Objects/RegExp .[32]MDN Web Docs. [n.d.]. Regular Expressions - JavaScript. https://developer.
mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions .
[33]Yael Dubinsky, Julia Rubin, Thorsten Berger, Slawomir Duszynski, Martin
Becker, and Krzysztof Czarnecki. 2013. An exploratory study of cloning in
industrialsoftwareproductlines.In EuropeanConferenceonSoftwareMainte-
nanceand Reengineering . IEEE.
[34]M. El-Ramly, R. Eltayeb, and H.A. Alla. 2006. An Experiment in Automatic
ConversionofLegacyJavaProgramstoC#. IEEEInternationalConferenceon
Computer Systemsand Applications,2006. March(2006), 1037ś1045.
[35]Xiaochao Fan and Kenny Wong. 2016. Migrating user interfaces in native
mobile applications. In International Workshopon Mobile SoftwareEngineering
and Systems(MOBILESoft) .
[36]FelixFischer,KonstantinBottinger,HuangXiao,ChristianStransky,Yasemin
Acar, Michael Backes, and Sascha Fahl. 2017. Stack Overflow Considered Harm-
ful?theImpactofCopy&PasteonAndroidApplicationSecurity.In IEEESym-
posiumonSecurityand Privacy (IEEE S&P) . 121ś136.
[37]PythonSoftwareFoundation.[n.d.]. reśRegularexpressionoperations-Python.
https://docs.python.org/3.6/library/re.html .
[38]MartinFowler.2018. Refactoring:improvingthedesignofexistingcode . Addison-
WesleyProfessional.
[39]W. B. Frakes and KyoKang. 2005. Software reuse research: status and future.
IEEE Transactions onSoftwareEngineering 31,7 (July2005),529ś536.
[40] JeffreyEF Friedl. 2006. Mastering regularexpressions . " O’ReillyMedia,Inc.".
[41]Mohammad Gharehyazie, Baishakhi Ray, Mehdi Keshani, Masoumeh Soleimani
Zavosht, Abbas Heydarnoori, and Vladimir Filkov. 2018. Cross-project code
clones in GitHub. EmpiricalSoftwareEngineering (2018), 1ś36.
[42] GitHub. 2018. The State of the Octoverse. https://octoverse.github.com/ .
[43] Google. [n.d.]. regexp - Go. https://golang.org/pkg/regexp/ .
[44]The PHP Group. [n.d.]. Regexp - PHP. http://php.net/manual/en/regexp.
introduction.php .
[45]Ahmed E. Hassan and Richard C. Holt. 2005. A lightweight approach for
migratingwebframeworks. InformationandSoftwareTechnology 47,8(2005),
521ś532.
[46]Hazel,Philip.2018. PCRE-PerlCompatibleRegularExpressions. https://web.
archive.org/web/20180919101106/https://www.pcre.org/ .
[47]IEEEandTheOpenGroup.2018. Theopengroupbasespecificationsissue7,
2018 edition,ieeestd 1003.1-2017.
[48]Ivar Jacobson and Fredrik Lindström. 1991. Reengineering of old systems to an
object-oriented architecture. ACMSIGPLAN Notices 26,11(1991), 340ś350.
[49]Elmar Juergens, Florian Deissenboeck, Benjamin Hummel,and Stefan Wagner.
2009.Docodeclonesmatter?.In InternationalConferenceonSoftwareEngineering
(ICSE). IEEE.
[50]YalinKe,KathrynT.Stolee,ClaireLeGoues,andYuriyBrun.2016. Repairing
programs with semantic code search. In Automated Software Engineering (ASE) .
295ś306.
[51]BarbaraA.KitchenhamandShariL.Pfleeger.2008. Personalopinionsurveys.
InGuidetoAdvancedEmpiricalSoftwareEngineering .
[52]JensKrinke.2007. Astudyofconsistentandinconsistentchangestocodeclones.
InWorking conference onreverse engineering (WCRE) . IEEE.
[53]A.M. Kuchling. [n.d.]. Regular Expression HOWTO - Python. https://docs.
python.org/3.6/howto/regex.html .
[54]MarkKvale.[n.d.]. PerlRegularExpressionsTutorial-Perl. https://perldoc.perl.
org/5.22.0/perlretut.html .
[55]Eric Larson. 2018. Automatic Checking of Regular Expressions. In Source Code
Analysisand Manipulation (SCAM) .
[56]Eric Larson and Anna Kirk. 2016. Generating Evil Test Strings for Regular
Expressions. In International Conference on Software Testing, Verification and
Validation (ICST) .
[57]Terry Lau, Jianguo Lu, Erik Hedges, and Emily Xing. 2001. Migrating E-
commerceDatabaseApplicationstoanEnterpriseJavaEnvironment.In Confer-
ence ofthe Centrefor AdvancedStudiesonCollaborativeResearch .
[58]Cristina V Lopes, Petr Maj, Pedro Martins, Vaibhav Saini, Di Yang, Jakub Zitny,
HiteshSajnani,andJanVitek.2017. DéjàVu:amapofcodeduplicatesonGitHub.
Proceedingsofthe ACMonProgrammingLanguages (OOPSLA) .
[59]AngelaLozano,MichelWermelinger,andBasharNuseibeh.2007. Evaluating
the harmfulness of cloning: A change based experiment. In Mining Software
Repositories(MSR) . IEEE.
[60]Andrew J Malton. 2001. The Software Migration Barbell. Proceedings of the
ASERC Workshop onSoftwareArchitecture (2001).
[61]J.MartinandH.a.Muller.2002. CtoJavamigrationexperiences. Proceedings
of the Sixth European Conference on Software Maintenance and Reengineering
(2002), 143ś153.
[62]William M McKeeman. 1998. Differential testing for software. Digital Technical
Journal10,1 (1998), 100ś107.
[63]Na Meng, Stefan Nagy, Danfeng Yao, Wenjie Zhuang, and Gustavo Arango-
Argoty. 2018. Secure coding practices in java: Challenges and vulnerabilities. In
InternationalConference onSoftwareEngineering (ICSE) . IEEE.
453ESEC/FSE ’19, August 26–30, 2019,Tallinn,Estonia James C.Davis,LouisG.MichaelIV,Christy A.Coghlan, Francisco Servant, andDongyoonLee
[64]AudrisMockus.2007. Large-scalecodereuseinopensourcesoftware.In First
International Workshop on Emerging Trends in FLOSS Research and Development,
FLOSS’07.
[65]Anders Mùller. 2010. dk. brics. automatonśfinite-state automata and regular
expressions for Java, 2010.
[66]M. Mossienko. 2003. Automated Cobol to Java recycling. In Conference on
SoftwareMaintenance and Reengineering (CSMR) , Vol. 7.IEEE,40ś50.
[67]Seyed Mehdi Nasehi, Jonathan Sillito, Frank Maurer, and Chris Burns. 2012.
What makes a good code example?: A study of programming Q&A in Stack-
Overflow. In IEEE International Conference on Software Maintenance (ICSM) .
IEEE.
[68]JoelOssher,HiteshSajnani,andCristinaLopes.2011. Filecloninginopensource
java projects: The good, the bad, and the ugly. In IEEE International Conference
onSoftwareMaintenance (ICSM) . IEEE.
[69]PerlMonks.[n.d.]. Perlregexpmatchingisslow?? https://perlmonks.org/?node_
id=597262 .
[70]PerlMonks. [n.d.]. Snapshot of Perl 5 regex.c. https://web.archive.org/web/
20190206210240/https://github.com/Perl/perl5/blob/blead/regexec.c .
[71]Hung Dang Phan, Anh Tuan Nguyen, Trong Duc Nguyen, and Tien N. Nguyen.
2017. StatisticalmigrationofAPIusages.In InternationalConferenceonSoftware
Engineering Companion (ICSE-C 2017 .
[72]LucaPonzanelli,AlbertoBacchelli,andMicheleLanza.2013. Seahawk:Stack
overflowintheide.In InternationalConferenceonSoftwareEngineering(ICSE) .
IEEE Press.
[73]LucaPonzanelli,GabrieleBavota,MassimilianoDiPenta,RoccoOliveto,and
MicheleLanza.2014. MiningStackOverflowtoturntheIDEintoaself-confident
programming prompter. In Working Conference on Mining Software Repositories
(MSR). ACM.
[74]Foyzur Rahman, Christian Bird, and Premkumar Devanbu. 2012. Clones: What
is that smell? EmpiricalSoftwareEngineering 17,4-5 (2012), 503ś530.
[75]Asiri Rathnayake and Hayo Thielecke. 2014. Static Analysis for Regular Expres-
sion Exponential Runtime via SubstructuralLogics . Technical Report.
[76]Dhavleesh Rattan, Rajesh Bhatia, and Maninder Singh. 2013. Software clone
detection:Asystematicreview. InformationandSoftwareTechnology 55,7(2013),
1165ś1199.
[77]BaishakhiRay,MiryungKim,SuzettePerson,andNehaRungta.2013. Detect-
ingandcharacterizingsemanticinconsistenciesinportedcode.In Automated
SoftwareEngineering (ASE) . IEEE.
[78]Alex Roichman and Adar Weidman. 2009. VAC - ReDoS: Regular Expression
Denial OfService. OpenWeb ApplicationSecurityProject (OWASP) (2009).
[79]ChanchalKRoy,JamesRCordy,andRainerKoschke.2009. Comparisonand
evaluationofcodeclonedetectiontechniquesandtools:Aqualitativeapproach.
Scienceofcomputer programming 74,7 (2009), 470ś495.
[80]Israel J Mojica Ruiz, Meiyappan Nagappan, Bram Adams, and Ahmed E Has-
san. 2012. Understanding reuse in the android market. In IEEE International
Conference onProgramComprehension(ICPC) . IEEE.
[81]Georgia Robins Sadler, Hau-Chen Lee, Rod Seung-Hwan Lim, and Judith Fuller-
ton. 2010. Recruitment of hard-to-reach population subgroups via adaptations
of the snowball sampling strategy. Nursing & Health Sciences 12, 3 (9 2010),
369ś374.
[82]VaibhavSaini,FarimaFarmahinifarahani,YadongLu,PierreBaldi,andCristinaV
Lopes.2018. Oreo:Detectionofclonesinthetwilightzone.In EuropeanSoft-
ware Engineering Conference and Symposium on the Foundations of Software
Engineering (ESEC/FSE) . ACM.
[83]VaibhavSaini,HiteshSajnani,andCristinaLopes.2018. Clonedandnon-cloned
Javamethods:acomparativestudy. EmpiricalSoftwareEngineering (2018),1ś47.
[84]HiteshSajnani,VaibhavSaini,andCristinaVLopes.2014. Acomparativestudy
ofbugpatternsinjavaclonedandnon-clonedcode.In InternationalWorking
Conference onSourceCodeAnalysisand Manipulation (SCAM) . IEEE.
[85]HananSamet.1981. Experiencewithsoftwareconversion. Software:Practice
and Experience 11,10(1981), 1053ś1069.
[86]WaltScacchi.2007. Free/opensourcesoftwaredevelopment:recentresearch
resultsandemergingopportunities.In EuropeanSoftwareEngineeringConference
and Symposiumonthe FoundationsofSoftwareEngineering (ESEC/FSE) .
[87]YujuShen,YanyanJiang,ChangXu,PingYu,XiaoxingMa,andJianLu.2018.
ReScue: Crafting Regular Expression DoS Attacks. In Automated Software Engi-
neering (ASE) .[88]Janet Siegmund, Christian Kästner, JÃűrg Liebig, Sven Apel, and Stefan Ha-
nenberg.2014. Measuringandmodelingprogrammingexperience. Empirical
SoftwareEngineering 19,5 (10 2014),1299ś1334.
[89]Susan Elliott Sim, Charles LA Clarke, and Richard C Holt. 1998. Archetypal
source code searches: A survey of software developers and maintainers. In
InternationalWorkshop onProgramComprehension(IWPC) . IEEE.
[90]MichaelSipser.2006. IntroductiontotheTheoryofComputation .Vol.2. Thomson
CourseTechnologyBoston.
[91]Henry Spencer. 1994. A regular-expression matcher. In Software solutions in C .
35ś71.
[92]Cristian-AlexandruStaicuandMichaelPradel.2018. FreezingtheWeb:AStudy
ofReDoSVulnerabilitiesinJavaScript-basedWebServers.In USENIXSecurity
Symposium(USENIXSecurity) .
[93]A.A.Terekhov.2001.Automatinglanguageconversion:acasestudy(anextended
abstract). IEEE International Conference on Software Maintenance (ICSM) (2001),
654ś658.
[94]Andrey A. Terekhov and Chris Verhoef. 2000. The realities of language conver-
sions.IEEE Software 17,6 (2000), 111ś124.
[95]Ken Thompson. 1968. Regular Expression SearchAlgorithm. Communications
ofthe ACM(CACM) (1968).
[96]Christoph Treude and Martin P Robillard. 2017. Understanding stack overflow
codefragments.In IEEEInternationalConference onSoftwareMaintenanceand
Evolution(ICSME) . IEEE.
[97]Iain Truskett. [n.d.]. Perl Regular Expressions Reference - Perl. https://perldoc.
perl.org/5.22.0/perlreref.html .
[98]BrinkVanDerMerwe,NicolaasWeideman,andMartinBerglund.2017. Turning
Evil Regexes Harmless. In Proceedings of the South African Institute of Computer
Scientists and InformationTechnologists(SAICSIT) .
[99]Bogdan Vasilescu, Vladimir Filkov, and Alexander Serebrenik. 2013. Stackover-
flowandgithub:Associationsbetweensoftwaredevelopmentandcrowdsourced
knowledge.In 2013InternationalConferenceonSocialComputing .IEEE,188ś195.
[100]MargusVeanes,PeliDeHalleux,andNikolaiTillmann.2010.Rex:Symbolicregu-
larexpressionexplorer. InternationalConferenceonSoftwareTesting,Verification
and Validation (ICST) (2010).
[101]Peipei Wang, Gina R Bai, and Kathryn T Stolee. 2019. Exploring Regular Ex-
pressionEvolution.In SoftwareAnalysis,Evolution,andReengineering(SANER) .
[102]Peipei Wang and Kathryn T Stolee. 2018. How well are regular expressions
tested in the wild?. In FoundationsofSoftwareEngineering (FSE) .
[103]RichardWaters.1988.Programtranslationviaabstractionandreimplementation
- Software Engineering. IEEE Transactions on Software Engineering 14, 8 (1988).
[104]NicolaasWeideman,BrinkvanderMerwe,MartinBerglund,andBruceWatson.
2016. Analyzing matching time behavior of backtracking regular expression
matchers by using ambiguity of NFA. In Lecture Notes in Computer Science
(includingsubseriesLectureNotesinArtificialIntelligenceandLectureNotesin
Bioinformatics) , Vol. 9705.322ś334.
[105]Wikipediacontributors.2018. RegularexpressionÐWikipedia,TheFreeEn-
cyclopedia. https://web.archive.org/web/20180920152821/https://en.wikipedia.
org/w/index.php?title=Regular_expression .
[106]EdmundWong,JinqiuYang,andLinTan.2013. Autocomment:Miningquestion
and answer sites for automatic comment generation. In Automated Software
Engineering (ASE) . IEEE.
[107]ValentinWustholz,OswaldoOlivo,MarijnJHHeule,andIsilDillig.2017. Static
Detection of DoS Vulnerabilities in Programs that use Regular Expressions.
InInternational Conference on Tools and Algorithms for the Construction and
AnalysisofSystems(TACAS) .
[108]DiYang,AftabHussain,andCristinaVideiraLopes.2016. Fromquerytousable
code:ananalysisofstackoverflowcodesnippets.In MiningSoftwareRepositories
(MSR). ACM,391ś402.
[109]DiYang,PedroMartins,VaibhavSaini,andCristinaLopes.2017. StackOverflow
inGithub:AnySnippetsThere?.In IEEEInternationalWorkingConferenceon
MiningSoftwareRepositories(MSR) .
[110]TianyiZhang,GaneshaUpadhyaya,AnastasiaReinhardt,HrideshRajan,and
MiryungKim. 2018. AreOnlineCode ExamplesReliable? AnEmpirical Study
of API Misuse on Stack Overflow. In International Conference on Software Engi-
neering (ICSE) .
[111]Hao Zhong, Suresh Thummalapenta, Tao Xie, Lu Zhang, and Qing Wang. 2010.
Mining API mapping for language migration. In International Conference on
SoftwareEngineering .
454