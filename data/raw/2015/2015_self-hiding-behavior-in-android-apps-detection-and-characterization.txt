Self-Hiding Behavior in Android Apps: Detection and
Characterization
Zhiyong Shan
Wichita State University
Wichita, Kansas, USA
zhiyong.shan@wichita.eduIulian Neamtiu
New Jersey Institute of Technology
Newark, New Jersey, USA
ineamtiu@njit.eduRaina Samuel
New Jersey Institute of Technology
Newark, New Jersey, USA
res9@njit.edu
ABSTRACT
Applications (apps) that conceal their activities are fundamentally
deceptive;app marketplacesandend-users shouldtreatsuch apps
assuspicious.However,duetoitsnatureandintent,activitycon-
cealingisnotdisclosedup-front,whichputsusersatrisk.Inthis
paper, we focus on characterization and detection of such tech-
niques, e.g., hiding the app or removing traces, which we call ‚Äúself
hiding behavior‚Äù (SHB). SHB has not been studied per se ‚Äì rather it
hasbeenreportedononlyasabyproductofmalwareinvestigations.
Weaddressthisgapviaastudyandsuiteofstaticanalysestargeted
at SHin Android apps.Specifically, we present(1) a detailedchar-
acterization of SHB, (2) a suite of static analyses to detect such
behavior, and (3) a set of detectors that employ SHB to distinguish
betweenbenignandmaliciousapps.WeshowthatSHBrangesfrom
hiding the app‚Äôs presence or activity to covering an app‚Äôs traces,
e.g.,byblockingphonecalls/textmessagesorremovingcallsand
messagesfromlogs.Usingourstaticanalysistoolsonalargedataset
of 9,452 Android apps (benign as well as malicious) we expose the
frequencyof12suchSHbehaviors.Ourapproachiseffective:ithas
revealed thatmalicious appsemploy 1.5 SHBsper app onaverage.
Surprisingly,SHbehaviorisalsoemployedbylegitimate(‚Äúbenign‚Äù)
apps, which can affect users negatively in multiple ways. Whenusing our approach for separating malicious from benign apps,
ourapproachhashighprecisionandrecall(combinedF-measure
= 87.19%). Our approach is also efficient, with analysis typicallytaking just 37 seconds per app. We believe that our findings and
analysistoolarebeneficialtobothappmarketplacesandend-users.
CCS CONCEPTS
‚Ä¢Securityandprivacy ‚ÜíSoftwaresecurityengineering ;Soft-
ware reverse engineering ;‚Ä¢Software and its engineering ‚Üí
Automated static analysis;
KEYWORDS
Android, static analysis, malware, mobile security
ACM Reference Format:
ZhiyongShan,IulianNeamtiu,andRainaSamuel.2018.Self-HidingBehavior
inAndroidApps:DetectionandCharacterization.In ICSE‚Äô18:ICSE‚Äô18:40th
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACMmustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden
¬© 2018 Association for Computing Machinery.
ACM ISBN 978-1-4503-5638-1/18/05...$15.00
https://doi.org/10.1145/3180155.3180214International Conference on Software Engineering , May 27-June 3, 2018,
Gothenburg,Sweden. ACM,NewYork,NY,USA,12pages.https://doi.org/
10.1145/3180155.3180214
1 INTRODUCTION
Mobilesecurityresearchhasmostlyfocusedonmalwareactivation,
malicious payloads, permission abuse, or leaking sensitive data.
Little attention has been paid to deceptive mechanisms that areessential for the success of malware, i.e., how malware manages
to get installed, and continues operating on the phone without the
users noticing anything suspicious. To do so, malware uses a range
of SHB, e.g., hiding the app, hiding app resources, blocking calls,
deletingcallrecords,orblockinganddeletingtextmessages.Sur-
prisingly,extremelypopular‚Äúbenign‚Äùappssuchas Airbnb,Truecaller,
andWazealso employ certain SH techniques in the name of user
convenience.
WebelievethatSHBisfundamentallydeceptiveandthathaving
tools that perform accurate and early detection of SHB is key. First,
app marketplaces, e.g., Google Play or Apple Store, should be able
to detect SHB, so that SHB can be considered in the decision topublish an app or not. Even when an app with SHB is published
on the marketplace, users should be forewarned about the SHB so
they can decide whether to install the app on their phone or not.
We address these problems on the Android platform via several
advances: (1) we shine a light on SHB via detailed characterization,
(2) we construct an SHB-detecting tool based on static analysis,1
and(3)weshowhowourapproachforidentifyingSHBcanbeveryeffectiveatexposingmaliciousappsaswellasdeceptivepracticesinbenignapps.WechosetofocusonAndroidbecauseAndroidclearlydominatestheworldwidemobilemarket,withan87%marketshareinthesecondquarterof2017[
8].Whilepopular,Android‚Äôssecurity
couldbeimproved:researchersfromtheantivirusfirmGDatahave
discovered that more than 750,000 new malicious Android apps
havesprungoutduring2017‚Äôsfirstquarter,andestimatethatthe
total number will grow up to a staggering 3.5 million by the end of
2017 [1]. Therefore, there is plenty of evidence that the threat level
forAndroidusers remainshigh,andthereisan impetustodetect
andweedoutmalwarebeforeitispublishedonGooglePlayorit
reaches users‚Äô devices.
We start by presenting a detailed characterization of SHB in
Section 2. We group SHB into three main categories: SHB that
involveappobjects,i.e.,hidingthepresenceoftheapp;SHBthat
blockorremovetracesofremotecommunication,e.g.,blockingcalls
ordeletingtextmessages;andsubvertingthesystem‚Äôsreminders,
e.g., hiding notifications or muting the phone.
1The tool and datasets are available at http://spruce.cs.ucr.edu/SelfHiding/
7282018 ACM/IEEE 40th International Conference on Software Engineering
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden Zhiyong Shan, Iulian Neamtiu, and Raina Samuel
InSection3wepresentourapproach:atool,consistingofasuite
ofstaticanalyses,thatexposespotentialSHBinagivenAndroid
app.OurtoolworksdirectlyonAPKs,i.e.,theformatAndroidapps
are distributed in, and does not require access to app source code.
In Section 4 we evaluate our approach along several dimensions.
First, we check our approach‚Äôs accuracy via manual validation on
a set of 198 malware samples; we found that it attains an 85.71%
F-measure. Second, we check whether our approach can be used to
triage benign from malicious apps: using a dataset of 9,452 benign
and malicious apps, the attained F-measure is 87.19%.
InSection 5weprovideadetailedexpos√©ofSHB inwidely-used
apps, and how these deceptive behaviors can affect users.
To summarize, we make the following contributions:
(1)Anexpos√©ofofSHBs,includingnovelSHBs,asemployed
by malware and widely-used benign apps.
(2) A static-analysis-based approach for detecting SHB.
(3)Anevaluationofourapproachon9,452sampleapps,both
benign and malicious.
2 SELF-HIDING BEHAVIORS
In this section, we provide a comprehensive description of SHbehaviors. We define as SHa behavior meant to hide the app or
its actions from being viewed (or heard!) by the user. Note that we
exclude those behaviors meant to evade security mechanisms, e.g.,
anti-malware tools or access control mechanisms ‚Äì they have been
studied thoroughly and are outside the scope of this paper.
Ourcharacterizationisbasedonmanualanalysisofabout200
maliciousappsandautomatedanalysisofabout3,000othermali-
cious apps. We found 12 SHBs; few of these are even mentioned in
theresearchcommunity,letalonecharacterizedthoroughly,and
some,including ‚ÄúHideicon‚Äùand ‚ÄúHideactivity‚Äù,arenot mentioned
at all.
Userscouldemploythreemainapproachesforidentifyingthe
presenceofmaliciousapps:inspectingappobjects(icon,app,ac-
tivity),analyzingremotecommunication(SMS,MMS,andphone
calls)orcheckingsystemreminders(systemdialogs,sound,system
logs, notifications, recent apps list, etc). There are two main issues
with this approach, though: (1) it requires a highly knowledgeable
user who performs such inspections periodically, and (2) malware
actively attempts to escape (hide itself) from such identification.
Tosetupthediscussion,inFigure1weshowthenumberofSHBs
insamplesetsof1,000maliciousand1,000benignapps,respectively;the1,000benignappsarearandomsampleextractedfromthe6,233
benignapps,whilethe1,000maliciousappsarearandomsample
extractedfromthe3,219maliciousapps(amorethoroughdataset
description is provided in Section 4).
2.1 App Objects
2.1.1 Hideicon. Afterinstallation,benignappsaddtheiricon
to the home screen. To hide itself, a malicious app removes theicon so the user cannot notice the app‚Äôs presence. There are two
methods for hiding the icon:
(a) Modifying the app‚Äôs manifest file to remove the app from the
default launcher, i.e., home screen. This can be done by deletingcategory android.intent.category.LAUNCHER from the app‚Äôs main activ-
itysectioninthemanifestfile.2Forexample,malware Fake-skype
camouflages as the popular app Skypeand runs in the background
without an icon in the home screen.
(b)CallinganAndroidAPImethodtodisabletheiconatruntime.
Thiscanbedonebyinvokingmethod setComponentEnabledSetting() .For
example, malware Facebook-otp (full package name: jgywwv.jvyjsd.
sordvd), masquerades as the Facebook app but disables its icon im-
mediatelyafterinstallation.Weshowthesegmentofthecodewe
reverse-engineered from this malware:
1PackageManager pm = getPackageManager();
2ComponentName cn = newComponentName("jgywwv.jvyjsd.sordvd", "
jgywwv.jvyjsd.sordvd.Activity1");
3pm.setComponentEnabledSetting(cn, PackageManager.
COMPONENT_ENABLED_STATE_DISABLED, PackageManager.
DONT_KILL_APP);
2.1.2 Hide app. When benign apps are running, they typically
show up in the running app list. In contrast, a malicious app can
run as a service, in the background, hence does not show up in the
list.Inordertoautomaticallystartthemalwareasaservicewithout
the user clicking the icon, a malicious app creates a BroadcastReceiver
class and registers it to receive certain events like SMS_RECEIVED ,
BOOT_COMPLETED ,etc.After receivingoneoftheregistered events,
the malware‚Äôs BroadcastReceiver launches the malware as a service
inthebackground.Asaresult,theusercannotseethemalicious
appintherunningapplist.Forexample,thespyware Candy_corn
automatically records Google Voice calls in the background. As
showninthefollowingcodesegment, Candy_corn monitorsseven
kinds of events and starts itself as a service (if the service is not
running already):
1public void onReceive(Context context, Intent intent) {
2...
3String act = intent.getAction() ;
4 if(Intent.ACTION_BOOT_COMPLETED.equals(act) |
5 Intent.SMS_RECEIVED.equals(act) |
6 Intent.NEW_OUTGOING_CALL.equals(act) |
7 Intent.SCREEN_OFF.equals(act) |
8 Intent.PACKAGE_INSTALL.equals(act) |
9 Intent.PACKAGE_ADDED.equals(act) |
10 Intent.SIG_STR.equals(act)) {
11 if(isServiceRunning())
12 return;
13 Intent serviceIntent = newIntent(context, com.google.progress
.AndroidClientService. class);
14 serviceIntent .setAction("com.google.
ACTION_START_CALL_RECORD");
15 context. startService ( serviceIntent );
16}
17...
18}
2.1.3 Hideactivity. Mostmalwarerunsasabackgroundservice.
However, starting in Android version 3.1, apps cannot create a
service without having an activity associated with that service.
Therefore, a malicious app must first create an activity. Next, to
hide the activity, the app can employ two approaches: making the
activity transparent or destroying the activity before it becomes
visible.
2The manifest file ( AndroidManifest.xml ), bundled with the app, contains a descrip-
tion of the app‚Äôs capabilities, system requirements, resources, permissions, etc.
729
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. Self-Hiding Behavior in Android Apps: Detection and Characterization ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden
Figure 1: The numbers of SHBs in two sample sets of 1,000 malware apps and 1,000 benign apps, respectively.
Torenderanactivitytransparent,amaliciousappneedstomake
theactivity‚Äôsmainlayouttransparent,settheactivityasfullscreen,
then remove the action bar and window title. These values can
be set in the app‚Äôs manifest file. In addition, malware can also
accomplishthisviacertainAPImethods.Forexample,AndroidAPI
methods setBackground() ,setBackgroundDrawable() orsetBackgroundColor()
canchangetheactivitytotransparent.Methods addFlags(),setFlags
(),o rrequestWindowFeature() can change the window to full screen,
as well as remove the action bar and the window title. We now
illustrate this with malware DroidKungFu3 . First, the manifest file is
used to make the activity layout transparent:
<style name="Theme.NoTitle" parent="@android:style/Theme">
<item name="android:windowBackground">@android:color/transparent</
item>
<item name="android:windowNoTitle">true</item>
<item name="android:windowIsTranslucent">true</item>
<item name="android:windowContentOverlay">@null</item>
</style>
Then,atruntime,theappsetsthewindowflagto FLAG_NOT_TOUCH
_MODAL,meaningthatevenwhenthewindowisfocusable,itallows
anypointereventsoutsidethewindowtobesenttothewindows
behind it. As a result, the user cannot see the malware activity but
can still use the activity of another app, which is just below the
malwareactivity‚Äìdefactothemalwareactivityhassuccessfully
inserted itself between the unsuspecting user and the app below:
1protected void onCreate(Bundle savedInstanceState) {
2 super.onCreate(savedInstanceState);
3...
4setContentView(R.layout.activity_main);
5getWindow().addFlags(WindowManager.LayoutParams.
FLAG_NOT_TOUCH_MODAL);
6...
7}
To destroy an activity before showing it, a malicious app will
callfinish ()inoneofthethreelifecyclecallbackmethods: onCreate(),
onStart(),o ronResume() . Thefinish ()method in turn calls onDestroy()
to finish the activity. If finish ()is called in onCreate() oronStart(), the
activityisnotshownatall.Butifitiscalledin onResume() ,thescreen
will flicker during the activity transition from the foreground to
thebackground.Topreventthis,theactivityissettotransparent.
We show this being accomplished in the SaveMespyware:1protected void onCreate(final Bundle bundle)
2{
3 super.onCreate(bundle);
4...
5 this.getPackageManager().setComponentEnabledSetting(this.
getComponentName(), 2, 1);
6// 2 = COMPONENT_ENABLED_STATE_DISABLED; 1 = DONT_KILL_APP
7 this. finish () ;
8...}
2.2 Remote Communication
2.2.1 DeleteMessage. SendingSMS/MMSmessagesfurtively,
inthebackground,isacommonbehaviorinmalware.Therefore,
several anti-malware products focus on this to recognize malware.
After sending or receiving SMS/MMS in the background, Android
saves a copy of the SMS/MMS in the outbox or inbox, respectively.
Tocoveritstracks,malwareneedstodeletethiscopy.Themalware
usuallycalls delete ()onacontentURI,i.e., "content://sms/inbox/" and
"content://sms/outbox/" ,respectively.Furthermore,malwarecanalso
delete SMS/MMS associated with a certain message ID, time, or
phone number. An example is malware XTaoAd.A that deletes a
message upon receipt:
1voidonReceive(android.content.Context context,android.content.Intent
intent){
2...
3 if(android.os.Build.VERSION.SDK_INT >= android.os.Build.
VERSION_CODES.KITKAT) {
4 if(!Telephony.Sms.getDefaultSmsPackage(context).equalsIgnoreCase(
context.getPackageName())) {
5 context.getContentResolver().delete(Uri.parse("content://sms/"),
null,null);
6 ...
7}}}
2.2.2 DeleteCallLog. Aftermakingorreceivingaphonecall
inthebackground,Androidwillgeneratearecordinthecalllog.
Tocoveritstraces,malwarehastodeletethisentryfromthecall
log.Anexampleisthe SaveMespyware. SaveMehasaservicethat
can make a call in the background (e.g., to a premium number)as dictated by the malware‚Äôs server. We show this in Figure 4. In
the left code snippet EXT_CALLis the number to be called. After the
phonecall,themalwaredeletesthecorrespondingcalllogentry.In
730
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden Zhiyong Shan, Iulian Neamtiu, and Raina Samuel
therightcodesnippet,thestring scontainsthenumberthatwas
just called.
2.2.3 Block Message. After a malicious app sends SMS/MMS
to sign up for a premium-rate service in the background, it will
receive a confirmation SMS/MMS sent from the service provider.
Topreventusersfromknowingthis,themalwarehastofilterthe
received SMS/MMS by calling abortBroadcast() . An example is Tro-
jan:Fakebank.B , shown below (please note that method achecks the
intent to see whether the SMS message has been received).
1voidonReceive(android.content.Context context,android.content.Intent
intent) {
2...
3 if(!Telephony.Sms.getDefaultSmsPackage(context).equalsIgnoreCase(
context.getPackageName())) {
4a(intent.getExtras() , context);
5abortBroadcast() ;
6 ...
7}}
2.2.4 Block Call. For malware that is part of a botnet, the com-
mandandcontrol(C&C)servercouldcalltheinfectedphonetoask
the bot (malware app) to perform certain services; the C&C server
isencodedinthephonenumber.Topreventusersfromrealizing
this, the malware needs to block the phone call. If the malware
received an intent android.intent.action.PHONE_STATE and the number
of the caller is the C&C server, then the ringer mode is set to silent
to suppress the notification of the incoming call and the phonecall is disconnected. Its corresponding entry from the call logs is
also removed, removing all traces of the phone call. An example is
malware fakeAVthat uses endCall()to cancel the incoming call:
1voidonReceive(android.content.Context context,android.content.Intent
intent) {
2...
3TelephonyManager tm = (TelephonyManager) context.getSystemService(
context.TELEPHONY_SERVICE);
4 try{
5Class c = Class.forName(tm.getClass().getName());
6Method m = c.getDeclaredMethod("getITelephony");
7m.setAccessible( true);
8com.android.internal .telephony.ITelephony telephonyService = (
ITelephony) m.invoke(tm);
9telephonyService.endCall();
10}catch(Exception e) {
11 e.printStackTrace () ;
12}
13...
14}
2.3 System Reminders
2.3.1 Hide Alert. System dialogs could revealthe presence of
malware by displaying alarms, user account balances, or otherabnormal behaviors to the user. To avoid this, malware has to
dismissthesystemdialogbybroadcastingtheintent ACTION_CLOSE_
SYSTEM_DIALOGS , as shown in the following code snippet:
1public void onWindowFocusChanged(boolean hasFocus) {
2 super.onWindowFocusChanged(hasFocus);
3...
4 if(! hasFocus) {
5Intent closeDialog = newIntent(Intent.
ACTION_CLOSE_SYSTEM_DIALOGS);
6sendBroadcast(closeDialog);7}
8...
9}
2.3.2 HideNotification. Appscansendalertstotheuserbygen-
eratinganotificationonthe notificationbar.Butthemalwarecan
delete notifications by calling NotificationManager ‚Äôs methods cancel()
orcancelAll () when receiving notifications. An example is malware
Bios.NativeMaliciousCode.apk :
1voidclearNotify(android.content.Context context){
2...
3((android.app.NotificationManager) context.getSystemService("
notification ")).cancel(1) ;
4...
5}
2.3.3 MutePhone. Tocovertheirpresence,maliciousappsof-
ten resort to muting the phone or disabling the vibrate function, to
prevent the user from hearing the sound of alarms, notifications,
phone calls or incoming SMSs. This can be accomplished in a vari-
etyofways:switchingtosilentmode,callingthevibratorservice,
setting the phone to mute, or adjusting the volume to the lowest
level. An example is the Trojan iBanking:
1voida(android.content.Context context){
2...
3((android.media.AudioManager)context.getSystemService("audio")).
setStreamMute( AudioManager.STREAM_ALARM, true);
4...
5}
2.3.4 Exclude From Recent Apps List. After an app has run, the
systemputsitsactivitiesintotherecentappslist.Topreventthis,
malware can set the flag excludeFromRecents in the manifest file, or
by calling ActivityManager.setExcludeFromRecents() . An example is Tro-
jan:Malapp .
<activity android:name="com.yangccaa.chengaa.WEYY"
android: label="@string/notification_name"
android: taskAffinity =". NotificationActivity "
android:excludeFromRecents="true">
<intent‚àífilter >
<action android:name="android.intent.action.MAIN" /><category android:name="android.intent.category.LAUNCHER" />
</intent
‚àífilter >
</ activity >
2.3.5 DeleteSystemLog. Androidsavessystemactivityintothe
system log, which can be viewed via the logcat. Malware can call
adb logcat -c to delete the logs if the phone is rooted or if the
AndroidAPIislowerthan16.Wepresentanexampleofsuchan
action extracted from the trojan SMSblocker :
1r = getRuntime();
2r.exec("logcat‚àíc");
3 DETECTING SH BEHAVIORS
Our approach relies on a suite of static analyses to detect SHBs.
Figure 2 shows an overview of our tool‚Äôs design. The input is an
APKfile(APKistheformatAndroidappsaredistributedin).We
passthebytecodetoSoot[ 12]/FlowDroid[ 13]whichperformbasic
tasks such as alias analysis, call graph analysis, as well as fixpoint
computationstodealwithloopsandrecursion.Next,weperform
731
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. Self-Hiding Behavior in Android Apps: Detection and Characterization ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden
	

	
	'
' !$!'*+'*+
'*+
!% ''*+

''  )&
#$ '
Figure 2: Tool overview.
	
	
	



	
	





Figure 3: SAPI analysis.
ourcoreanalyses(describedshortly)onbothbytecodeandXML
files. Finally, a report detailing the potential SHBs is produced.
3.1 Static Analysis
3.1.1 FindingSHCallInvocations(SAPIAnalysis). Ourfirstanal-
ysisfindswhether SHAPIcalls areinvoked(wenamethis SAPIanal-
ysisfor short). We present the analysis in Figure 3. Specifically, the
analysisstartsatan Origin(apporactivitystart).Inthefirststage,
weusecontrol-flowandcallgraphanalysistofindwhetheracertain
SAPI call isinvoked‚Äìgreennodesandedgesontheleftrepresent
methods and call graph edges, respectively. In the second stage,
we use backward dataflow analysis to find if the call is invoked
with certain SH-indicating parameters; more precisely, we walk
thedef-usechainsbackwards(showninblack)untilwecanfindtheparameterdefinition,e.g.,aconstantoranalias.InTable1weshow
the origins and SAPI calls for each SHB. For example, to detect the
‚ÄúHide app‚Äù SHB, our analysis will check whether the call to Context.
startService () isreachablewhenstartingin BroadcastReceiver.onReceive() .
To check for ‚ÄúDelete message‚Äù on the other hand, we start track-
ingfrom BroadcastReceiver.onReceive(SMS_RECEIVED/ACTION_VIEW) tosee
if we can reach ContentResolver.Delete() ; next, we walk the def-use
chainsbackwardstoseeiftheargumentis "content://sms" .Forcer-
tainbehaviors,e.g.,‚ÄúHideactivity‚Äù,weusealltheapp‚Äôsentrypoints
as origin; app entry points are provided by FlowDroid.Wenowprovideanexamplefromtherealmalware DroidKungFu1 ,
which deletes all SMS messages. In this case we show simplified
disassembledcode,fromwhichwehaveremovedirrelevantinstruc-
tions.
1specialinvoke $r3.<java.lang. StringBuilder : void<init>(java.lang.
String)>("content://sms/")
2$r4 = virtualinvoke $r3.<java.lang. StringBuilder : java.lang.String
toString () >()
3$r5 = staticinvoke <android.net.Uri: android.net.Uri parse(java.lang.
String)>($r4)
4virtualinvoke $r2.<android.content.ContentResolver: intdelete(android
.net.Uri,java.lang.String,java.lang.String [])>($r5, null,null)
Let us assume that our analysis has determined that an invo-
cation of ContentResolver.Delete() is reachable from BroadcastReceiver.
onReceive(PHONE_STATE) . To check the value of Delete()‚Äôs parameter,
we walk the def-use chains backwards starting at $r5 (that is used
at line 4 and defined at line 3). As line 3 calls method parse(),w e
proceed further on $r4 and then $r3. Eventually on line 1 we see
thedefinition,i.e., "content://sms/" .Thisconcludesouranalysisand
we report the potential ‚ÄúDelete message‚Äù behavior.
3.1.2 Pair Action (PAPI) Analysis. Another broad self-hiding
category consists of pair actions, where an app first performs a ma-
licious action then deletes traces of this action, e.g., deleting a text
message after sending it. Our analysis (we name this PAPI analysis
for short) detects six types of pair actions: send message/deletemessage log, receive message/delete message log, receive/block
message, make phone call/delete call log, receive phone call/delete
call log, receive/block phone call.
Our pair action detector uses data flow analysis in a manner
similartotaintanalysistoseeifdataflowsfroma pairstart toapair
end.ThepairedmethodsandtheSHBarelistedinTable2. Figure4
showsacodesnippetfromtherealmalware Savemethatdeletesa
callfromthecalllog.Ourtooldetectsdataflowfrom startActivity
()tocontentResolver.delete () . Actually EXT_CALLon line 2 (left) and s
on line 4 (right) have the same value ‚Äì the phone number called.
Therefore, the pair ( Context. startActivity () ,contentResolver.delete () ), is
detected, indicating the SHB ‚ÄúDelete call log‚Äù.
3.1.3 User-decision(UD)Analysis. Toreducepotentialfalsepos-
itivesincaseswhereSAPImethodsarealsousedbybenignapps,
we perform a user-decision analysis that checks whether an API
732
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden Zhiyong Shan, Iulian Neamtiu, and Raina Samuel
Table 1: SH call (SAPI) analysis.
SH Behavior Origin SH Call (SAPI)
Hide app BroadcastReceiver.onReceive(ACTION_BOOT_COMPLETED
/SMS_RECEIVED/NEW_OUTGOING_CALL/SCREEN_OFF/
PACKAGE_INSTALL/PACKAGE_ADDED/SIG_STR)Context. startService ()
Hide activity any Window.addFlags(FLAG_NOT_TOUCH_MODAL)
entry Window.setFlags(FLAG_NOT_TOUCH_MODAL,‚àó)
point Window.requestFeature(FLAG_NOT_TOUCH_MODAL)
Delete message BroadcastReceiver.onReceive(SMS_RECEIVED/ACTION_VIEW) ContentResolver.Delete("content://sms")
Delete call log BroadcastReceiver.onReceive(PHONE_STATE) ContentResolver.Delete("content:// cal_log/ calls ")
PhoneStateListener.onCallStateChanged(TelephonyManager.
CALL_STATE_RINGING)
Block message BroadcastReceiver.onReceive(SMS_RECEIVED) BroadcastReceiver.abortBroadcast("content://sms")
Block call BroadcastReceiver.onReceive(PHONE_STATE) ITelephony.endCall()
PhoneStateListener.onCallStateChanged(TelephonyManager.
CALL_STATE_RINGING)
Hide alert any entry point Context.sendBroadcast(Intent.
ACTION_CLOSE_SYSTEM_DIALOGS)
Hide notification BroadcastReceiver.onReceive() NotificationManager.cancel()
NotificationManager.cancelAll ()
Mute phone any Vibrator.Cancel()
entry AudioManager.setRingerMode(RINGER_MODE_SILENT)
point AudioManager.setStreamMute(true)
AudioManager.adjustStreamVolume(ADJUST_LOWER)
Delete system log any entry point Runtime.Exec("logcat ‚àíc")
Figure 4: Code snippets of malware Savemethat implement the ‚ÄúDelete call log‚Äù SHB.
Table 2: Pair action (PAPI) analysis.
SH Behavior Pair start Pair end
Delete message SmsManager.sendTextMessage()/sendMultipartTextMessage()/sendMultimediaMessage() ContentResolver.Delete()
SmsMessage.createFromPdu()
Delete call log Context. startActivity () ContentResolver.Delete()
PhoneStateListener.onCallStateChanged()
BroadcastReceiver.onReceive()
Block message SmsMessage.createFromPdu() BroadcastReceiver.abortBroadcast()
Block call BroadcastReceiver.onReceive() ITelephony.endCall()
PhoneStateListener.onCallStateChanged()
method invocation is the result of an user decision. We name this
UD analysis for short.Theuser‚ÄôsGUIactionscanbe decision-related ordecision-unrelated,
asexplainednext.Decision-relatedactionsincludeclickingabut-
ton, checking a checkbox or selecting a menu item; in other words,
theusertakesdecisions(andactsaccordingly)inawaymeantto
733
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. Self-Hiding Behavior in Android Apps: Detection and Characterization ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden
change the app state. Examples of decision-unrelated actions in-
clude scrolling down a window or changing focus. If an SAPI is
invokedbyadecision-relatedaction,werulethatcallaslegitimate,
rather than an SH attempt. However, if invoked by a decision-
unrelated action, it can be an SHB. Note that existing research can
onlydetect whetheranAPI isinvokedby aGUI[ 15,17],whereas
we further consider whether the GUI can reflect decisions.
Inordertopresenttheuser-decisionanalysisapproach,weintro-
duceseveraldefinitions.User-Decision-GUI(UDG)isaninteractive
GUI element, e.g., Button, Checkbox, Radio Button, Toggle Button,
Spinner, Picker, or menu. User-Decision-Callback (UDC) is a top-
levelcallbackmethoddirectlyinvokedasaresultoftheuseraction,e.g.,
onClick(),onCheckedChanged() .Incontrast,somecallbackmethods
are due to decision-unrelated actions, e.g., onBackPressed() ,onScroll (),
onEditorAction() .
Androidofferstwowaysfor creating acorrespondencebetween
acallbackmethodandaGUIelement:staticallydefiningthecall-
back as the handler of an event in the GUI element‚Äôs layout file or
dynamically defining a callback for the GUI element by registering
a listener object ‚Äì we handle both.
We determine that a given callback isan UDC if either of these
two conditions is satisfied:
‚Ä¢ThecorrespondingGUIofthecallbackisanUDG, andthe
event to be handled by the callback is a decision-related
event, e.g., click. Note that there exist decision-unrelated
events, e.g., scroll and focus change.
‚Ä¢ThecorrespondingGUIofthecallbackisanUDG, andthelis-
tener of the callback is decision-related, e.g., onCheckedChange
Listener. Note that there exist decision-unrelated listeners,
e.g.,onCreateContextMenuListener andonFocusChangeListener .
Finally,weinferthatanAPIinvocationisuser-decidedifallof
its callbacks are UDC, which includes callbacks within the same
componentandcallbacksinothercomponents.Ifanycallbackis
not UDC, we infer that the API call is not invoked by the user ‚Äì
further, if this call is an SAPI, it is potentially an SHB.
3.1.4 Activity Finish Analysis. This analysis detects activity hid-
ing,i.e.,whetheranactivityisterminatedprematurely,beforebeing
displayed,asillustratedinSection2.1.3.Toachievethis,theactivity
callsfinish ()within onCreate(),onStart(),o ronResume() (or their de-
scendants in the call graph). Therefore, our analysis starts at the
beginningofthesethreecallbackmethods.Weperformacontrol
flowanalysis tocheckwhetherthere existsapath fromthebegin-
ning of the callback to the callback‚Äôs end that includes finish ();i f
suchapathexists,itindicatespotentialactivityhiding.Wename
thisAF analysis for short.
3.1.5 AttributeAnalysis. Thepurposeofthisanalysisistocheck
whether the app attempts to manipulate activity attributes in or-
der to deceive the user. The analysis checks both the XML mani-fest file and the attribute-related API methods. For example, theliner layout of an activity has an attribute ‚Äúbackground color‚Äù.If the attribute value is
#00000000, the activity is transparent. An
app can set the value of an attribute in the manifest or layout
files,orbycallingcertainAPImethods,e.g., setBackgroundDrawable() ,
setBackgroundColor() orsetBackgroundResource() .Anotherexampleistheattribute excludeFromRecents which can be specified in the manifest
file, or set via the API methods setFlags ()andaddFlags().
3.2 Detection Rules
WeuseSAPI,PAPI,UD,AF,andAttribute todenotethefivestatic
analyses.ThedetectionrulesfortheSHBsareshowninFigure5.If
anyoftherulesfires,thetoolwillreporttheappasmalicious.We
now explain each rule.
Rule 1 reports ‚ÄúHide icon‚Äù when the main activity is removed
from the home screen without user involvement. Rule 2 detects
‚ÄúHide app‚Äù ifstarting anapp asa service withoutuser involvement.
Rule3reports‚ÄúHideactivity‚Äùwhentheactivityfinishanalysisre-
turnstrueorthemainactivityistransparent.Rule4infersbehavior
‚ÄúDelete message‚Äù when deleting occurs after receiving or sending a
message.Rule5reports‚ÄúDeletecalllog‚Äùwhendeletingoccursafter
makingorreceivingaphonecall.Rule6detects‚ÄúBlockmessage‚Äù
if blocking received or sent messages. Rule 7 reports ‚ÄúBlock call‚Äù
when blocking incoming or outgoing phone calls. Rule 8 reports
‚ÄúHide alert‚Äù if the app closes a system dialog without user involve-
ment.Rule9infersbehavior‚ÄúHidenotification‚Äùwhencancelinga
notificationwithoutuserintervention.Rule10detects‚ÄúMutephone‚Äù
whenmutingthephonesurreptitiously.Rule11findsSHB‚ÄúExclude
from recent apps list‚Äù if the attribute EXCLUDE_FROM_RECENTS is set
without user‚Äôs involvement. Rule 12 reports ‚ÄúDelete system log‚Äù if
that specific shell command is not launched by the user.
3.3 Implementation
We implementedour tool ontop ofthe Soot andFlowDroid static
analysis frameworks. These frameworks only analyze bytecode,so we added modules to analyze XML files (e.g., categories and
attributes in
AndroidManifest.xml ,style.xml , etc). Our static
analysis modules use both data-flow and control-flow analyses.
Finally, the analysis results are produced using the detection rules.
3.4 Limitations
Limitations/falsenegatives. Ourtoolhasseveralanalysislimita-
tions.First,ifanSHBisinvokedbyGUIinteractionbuttheGUItext
does not reflect the invocation of the SHB, the tool will not report
it; Huang et al.‚Äôs idea of finding mismatches between user interface
and app behavior [ 17] could be used to address this limitation. Sec-
ond,therewereafewappsthat,duetoobfuscation,couldnotbe
analyzed, e.g., TripAdvisor (com.tripadvisor.tripadvisor.apk )
andKCLS
(com.bibliocommons.kcls.apk).
Improvingprecision/reducingfalsepositives. Ouranalysis,built
on top of FlowDroid, is based on over-approximation, and handles
reflection/native code conservatively ‚Äì this can be a source of false
positives. Also, the SAPI functions with zero parameters tend to
havemorefalsepositives‚Äìamoreprecisealiasandflowanalysis
would improve precision.
Broader concerns. There could be other classes of SHBs, beyond
theones wehavediscovered. Nevertheless,ourlist ofSHBs:(1)is
effectiveatmalwarediscrimination,and(2)exposesquestionable
practices in benign apps.
734
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden Zhiyong Shan, Iulian Neamtiu, and Raina Samuel
1 Hide icon !UD‚àßRemoveFromHomeScreen(MainActivity)
2 Hide app !UD‚àßSAPI(Start_service)
3 Hide activity ActivityFinish ()‚à®(!UD‚àßAttributeAnalysis(Transparent_Main_Activity) ‚àßSAPI(Set_Flags))
4 Delete message !UD‚àßSAPI(Delete_Sms_Mms) ‚àß(PAPI(Receive_Sms_Mms) ‚à®PAPI(Send_Sms_Mms))
5 Delete call log !UD‚àß(PAPI(Make_Phone_Call) ‚à®PAPI(Receive_Phone_Call)) ‚àßSAPI(Delete_Call_Log)
6 Block message !UD‚àßSAPI(Block_Sms_Mms) ‚àßPAPI(Receive_Sms_Mms) ‚àßPAPI(Send_Sms_Mms)
7 Block call !UD‚àßSAPI(Block_Phone_Call) ‚àßPAPI(Receive_Phone_Call) ‚àßPAPI(Make_Phone_Call)
8 Hide alert !UD‚àßSAPI(Close_System_Dialog)
9 Hide notification !UD‚àßSAPI(Cancel_Notification)
10 Mute phone !UD‚àß( SAPI(Cancel_Vibrate) ‚à®SAPI(Mute)‚à®SAPI(Adjust_Volume) ‚à®SAPI(Chang_Ringer_Mode) )
11 Exclude from recent apps list !UD‚àßAttributeAnalysis(EXCLUDE_FROM_RECENTS)
12 Delete system log !UD‚àßSAPI(Delete_Logcat)
Figure 5: Detection rules.
Finally, our approach cannot recognize specific malware fam-
ilies: certain SHBs might span multiple malware families. This is
expected,asourdesigngoalwasatalowerlevel,automaticSHB
identification, rather than clustering malware by family.
4 EVALUATION
In this section, we present an evaluation of our approach along
severaldimensions:IstheapproacheffectiveatidentifyingSHBs?
Istheapproachefficient?Whatarethemaincausesoffalseposi-
tives/falsenegatives?Webeginbydescribingthetwodatasetsused
in our evaluation.
Datasets. Our first dataset, which we name MA-198, contains
198 malware samples that were decompiled and analyzed manu-
ally, in detail. The 198 samples come from the Malware Genome
Project [31], Drebin [11], and AndroZoo [10].
The second dataset, which we name ALL-9452 , consists of 6,233
benign apps3and 3,219 malicious apps.4These apps were analyzed
automatically. To ensure that the benign set does not contain mal-
ware, we sent all the apps in this set to VirusTotal [ 7], a public
malwarescanningservice.Ifanappisreportedbyatleastonecom-
monanti-virustoolasmalicious,weremoveditfromthebenign
set. For the malware samples, we performed a quick and simple
static analysisto eliminatethe sampleswithout anypossibility to
haveSHBs.Thisisdonebysearchingrequestedpermissions,major
SAPI calls and intent actions. For example, if an app does not have
permissions SEND_SMS andRECEIVE_SMS , it is impossible to have the
SHB ‚ÄúDelete message‚Äù. Moreover, in order to make sure that thesamples are malware, we sent them to VirusTotal. If an app was
reported malicious by less than two scanners, we removed it from
the malware set.
Platform. The static analysis tool ran on an 8-core Intel Xeon
i7-4770 (8MB Cache, 3.4 GHz) with 32GB of RAM. The system ran
Ubuntu 14.04.1, Linux kernel version 3.13.0-32-generic.
3The benign app samples are from Google Play and AndroZoo [ 10]; specifically, 4,970
(70%) of the benign apps are from Google Play and span all 33 app categories, as well
as games.
4The malware samples are from Drebin [ 11], DroidCat [ 3], Kharon [ 5], AndroMal-
Share [2], Malware Genome Project [31], and Offensive Computing [6].Table 3: Effectiveness results on MA-198.
TrueOver-reported Under-reported
SHBs SHBs (FP) SHBs (FN)
219 46 27
Precision :219
219+46=82 .64% Recall:219
219+27=89 .02%
F‚àímeasure:2‚àó82.64‚àó89 .02
82.64+89 .02=85 .71%
4.1 Effectiveness
The test for evaluating effectiveness consists of two steps: SHB
detectionvalidation(manual)andlargescalemeasurement(auto-
matic).
4.1.1 ManualCross-checkingon MA-198.Asthereisnoexisting
oracle to determine SHB, we manually verified each static analysis
report. Specifically, we reverse-engineered each app ‚Äì decompiled
the app (to source code) via the JADX decompiler [ 4]. Note that
decompilationisnotalwayspossibleduetoobfuscation,sosomeofourmanualanalysiswasbasedonsourcecodeinspection,someon
Dalvik bytecode inspection. The results are shown in Table 3. Our
toolhasreported265 SHBsintotal;ofthese 219weretrue SHBs,
while 46 SHBs were over-reported (false positives) and 27 were
falsenegatives,i.e.,ourtoolmissedthoseSHBs(thereasonswillbe
discussedinSections4.1.3and4.1.4,respectively).Thisyieldsan
F-measure of 85.71%, indicating that our tool is quite effective.
4.1.2 Automated Analysis on AA-9452.We now turn to dis-
cussingthe large-setresults, shownin Table4. Notethathere the
numbers in columns 2‚Äì4 indicate apps, not SHBs (since we only
have ground truth for app nature, not SHBs).
A sample is identified as malicious if it exhibited any one of the
SHbehaviors.Thetoolmissed(falsenegatives,or‚ÄòFN‚Äô)311samples
from the malware set, hence the recall value is 90.62%. The toolalso reported 996 benign apps as having SHB (false positives, or
‚ÄòFP‚Äô)fromthebenignset,hencetheprecisionis84.02%.Whilethese
996 apps were not malicious, their use of SHB is questionable ‚Äì we
discuss such uses at length in Section 5.
735
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. Self-Hiding Behavior in Android Apps: Detection and Characterization ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden
Table 4: Effectiveness results on AA-9452.
Apps Apps reported as SHBsSHBs
Malicious Benign /app
Malicious set 3,219 2,908 3114,843 1.5
(FN)
Benign set 6,233 9965,2371,241 0.2
(FP)
Precision :5,237
5,237+996=84 .02% Recall:2,908
2,908+311=90 .62%
F‚àímeasure:2‚àó84.02‚àó90 .62
84.02+90 .62=87 .19%
Figure 6: FPs generated by each SHB.
Finally,theF-measureis87.19%;themalwaresetexhibited1.5
SHB per sample on average5while the benign set exhibited only
0.2SHBpersample. WebelievethatthehighF-measurevalueand
theper-appfiguresof1.5SHB(malicious)vs0.2(benign)indicatethat
our approach is effective for detecting SHB (and perform SHB-based
triaging) in Android apps.
4.1.3 FalsePositives. Tobetterunderstandthecausesoffalse
positives,inFigure6wehavegroupedthembySHBs.FiveSHBs,
‚Äúhideactivity‚Äù,‚Äúhidenotification‚Äù,‚Äúhideicon‚Äù,‚Äúhideapp‚Äùand‚Äúdelete
system log‚Äù, generated the most false positives. We investigated
this and found that the false positives were due to several reasons:
(1)CertainappsemploySHB,suchasrunninginthebackground
without the user having started the app, or without the user
beingabletoseethatrunningapp,inthenameofimproving
user experience (see Section 5).
(2)StaticAnalysis:alias,data-flow,andcontrol-flowanalyses
are over-approximating, which is inherent in static analysis.
4.1.4 FalseNegatives. Wehavecategorizedthefalsenegative
sources as follows:
(1)ParametersofanSHBaredynamicallysentfromaremote
control server, hence our static analysis cannot identify the
behavior. For example, spyware Savemehas a remote server
5M ed i a n=1 ,m i n=0 ,m a x=5 .thatsendstheid,timeorphonenumberthroughthenetwork
to delete certain SMS/MMS messages.
(2)SHBs are launched by GUI interaction, but the behavior
mismatches the content shown on the GUI. For example,
appsPure girlandiCalendar employ this behavior.
(3)Some malware samples do not have SHB, though they doinvoke SAPI calls, e.g.,
Towelroot andFakeCMCC . Our tool
did not identify these samples as malicious.
4.1.5 Behavior statistics. Figure 1 shows the number of each
type of SHBs detected per 1,000 malware samples and 1,000 benign
samples,respectively.6ThetotalnumberofSHBsdetectedinthe
malwaresetis1502per1000sampleswhileinthebenignsetitis
only185per1000samples.‚ÄúHideapp‚Äù,‚ÄúHideactivity‚Äùand‚ÄúBlock
message‚Äù are the three most common SHBs in the malware set.
4.2 Efficiency
Runningourtoolonthe9,452appstookabout10days.Weshowthe
detailedefficiencyresultsinTable5.The‚ÄúBytecodesize‚Äùgrouped
columns show that the datasets had substantial variety in termsof app size, and some apps‚Äô bytecode size was as large as 24 MB.
The‚ÄúTime‚Äùgroupedcolumnsshowrunningtimestatisticsforeach
dataset.Wefocuson AA-9452 asitislarger,hencemorerepresenta-
tive. The mean analysis time was 84 seconds while the median was
37seconds,whichshowsthatouranalysisispractical.Finally,we
believethateventhemaximumanalysistimeof15,290seconds(i.e.,
4 hours 15 minutes) is acceptable for a static analysis. To conclude,
with a median analysis time of 37 seconds on a median app size of
2.4MB we believe that our approach is efficient at SHB analysis.
5 SELF-HIDING BEHAVIOR IN BENIGN APPS
For each SHB category our tool has found in benign apps, we per-
formedatwo-parttargetedmanualinvestigation:first,weanalyzed
thedisassembledbytecode,andthenrantheappwithinstrumen-
tation to confirm the SHB. We focused this investigation on two
categoriesofapps:(1)appsthatareverypopular,e.g.,withmore
than 100millioninstalls; or(2) lesspopular appswhich displayed
severecasesofSHB.Ultimatelyweaimedtoanswerthequestions‚Äú
WhydoesthisSHbehavioroccurandwhataretheconsequences
for the user?‚Äù This section summarizes some of our findings; we
limit the discussion to 8 SHBs for brevity.
5.1 Hide App
Manypopularbenignapps,suchas AirbnbandBBMstartthemselves
as an automatic service after receiving the BOOT_COMPLETED event.
Thisevent,whichrequiresthepermission RECEIVE_BOOT_COMPLETED
,notifiestheappthatthesystemhasrebooted.Inconjunctionwith
thiseventandpermission,thereisafunctionwhichlaunchesthe
auto-startservice.Ourtoolreportsthisas‚ÄúHideapp‚ÄùSHB.Appsem-ploythistechniqueasameanstoinitializeapp-specificinformation
and functions upon startup. While it could be argued that the app
isnothidinginthemalicioussense(ratheritisrunningintheback-
groundtohaveaccesstocertaintypesofdata‚Äìmostcommonly,
locationservices),webelievethatusersshouldknowwhensuch
6The 1,000 benign apps are a random sample extracted from the 6,233 benign apps,
whilethe1,000maliciousappsarearandomsampleextractedfromthe3,219malicious
apps.
736
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden Zhiyong Shan, Iulian Neamtiu, and Raina Samuel
Table 5: Efficiency results.
Dataset Bytecode size (KB) Time (seconds)
minmaxaverage median minmaxaverage median
MA-198 3215,021 5,326 1,995 136,596 140 32
AA-9452 524,218 4,496 2,459 215,290 84 37
apps are running: (1) so they understandwhy the battery is drain-
ing, and (2) so they understand the privacy implications of apps
accessing and transmitting sensitive information (e.g., location) in
the background.
5.2 Hide Notification
Certain apps, such as Waze,Truecaller,All in One Toolbox ,Quick
HealMobileSecurity ,andMiniFetion useNotificationManager.cancel() or
NotificationManager.cancelAll () to block notifications without user in-
tervention. As a result these apps have been marked as having the
‚ÄúHide notification‚Äù SHB. This is due to the nature of cancel()and
cancelall (),whichcancelallpreviously-shownnotifications.Apps
employ this technique as a meansto update the userto the most
recentnotificationortoconsolidatenotifications,especiallyincom-
munication apps such as MiniFetion andTrueCaller . Lately, many
‚Äúcleanup‚Äùand‚Äúdevicemaintenance‚Äùappshavestartedtoexhibit
this behavior for the same reasons. Consolidated notifications may
appear convenient to the user, however the app does not have a
means to show high-priority notifications first (other than through
chronologicalorder).Therefore,usersmightprefertoreceivenotifi-
cations for all messages to reduce the risk of missing an important
notification. However in the case of Waze, the app blocks certain
notificationsusingVanagonNotificationManagerwhichcancelsall
appnotificationswhentheuserisnotdriving.Whiletheappmight
betryingtoappearhelpful,notificationcancellationandblocking
without user‚Äôs consent/awareness is questionable at best.
5.3 Mute Phone
Our tool discovered the use of AudioManager.setRingerMode() in the be-
nign app Camera360 . As its name states, this is a camera app which
edits and takes photos; it has more than 100 million installs and
was‚ÄúBestAppof2016onGooglePlayinseveralcountries‚Äù.7Many
cameraappsusevolumecontrolswhenrecordingaudio.Ourtool
alsodiscoveredthe‚ÄúMutephone‚ÄùSHBincertainbenignpopular
apps like Smart Truck Route andAll in One Toolbox due to the use
ofVibrator.cancel() andAudioManager.setRingerMode() . Regarding Smart
TruckRoute ,theappdirectlychecksandmanipulatesthedevice‚Äôs
audiosettings,includingitsringermode.Asfor AllinOneToolbox ,
theappmutesthephonebasedontheSDKversionofthedevice.
Thisisdubiousbehaviorforautilityappaimedatoptimizingthe
Android device. To sum up, even though it seems reasonable in
someofthesecases,webelievethatmutingthephoneshouldbe
doneby the user through a system-wide control rather than silently
by the app.
7https://play.google.com/store/apps/details?id=vStudio.Android.Camera360&hl=en5.4 Block Message
As the BroadcastReceiver is usually a dormant app component, it is
not surprising that its methods can be categorized as SHBs, es-
pecially abortBroadcast() .Asaresult,manybenignappscanexhibit
this behavior. Interestingly, these apps are not limited to those
which rely heavily on BroadcastReceiver . For example, the popular
navigation app WazeusesabortBroadcast() which can be construed
asthe ‚ÄúBlockMessage‚ÄùSHB. The abortBroadcast() methodis usedto
preventotherreceiversfromobtainingthebroadcast,thusblock-
ing the communication. It might be justified that Wazeemploys
this tactic as a means to prevent itself from getting location-based
alerts that may be irrelevant or annoying to the user. While theintentions of message-blocking apps might appear benign, such
blocking removes decision-making from the user and can interfere
with usability.
5.5 Block Call
Appswhichuse ITelephony.endCall() areconsideredtohavethe‚ÄòBlock
Call‚ÄùSHB.Thebenignapp Truecaller hasthesolepurposetoidentify
andblockspamcalls,henceitwasobviouslymarkedtohavethis
behavior. Despite explicitly stating that it automatically blocks
calls,anappwhichdecidesfortheuserwhichcallsarespamcan
be maliciously manipulated against the user‚Äôs interest.
5.6 Hide Icon
‚ÄúHideicon‚Äùachievesitsgoalbydeletinganactivity‚Äôs category.LAUNCHER
fromtheAndroidmanifest.Whilethisdeletionmerelyindicates
that that activity should appear as an initial activity of a task, it
isevidentthatadeceitfulappcanusehide-icontopromoteother
activities,maskingthedeceitfulappbeneath.Manypopularbenignapps such as
ES File Explorer andNext Launcher 3D Shell Lite have this
behavior. For example, app Next Launcher 3D Shell Lite is a premium
launcherforAndroid‚Äôshomescreen,butoneofitskeyfeaturesis
thatitdraws3Diconsandwidgetsovertheiroriginalcounterparts.
AppES File Explorer has permissions to draw over apps, which is
surprising and might be regarded as excessive for a file manager.
By having the ability to promote certain activities and controlling
the launcher‚Äôs top level apps, apps with this SHB should be treated
with caution.
5.7 Delete Call Log
The app Quick Heal Mobile Security exemplifies this SHB. The app
usesContentResolver.Delete() to delete the call logs on the device. The
app has call filtering capabilities and has explicit permissions to
readandwritecalllogsontheuser‚Äôsdevice.Nevertheless,(1)users
may not be aware of the security implications of log deletion, and
737
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. Self-Hiding Behavior in Android Apps: Detection and Characterization ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden
(2) the user does not initiate call deletion. These two factors make
this particular SHB instance quite problematic.
5.8 Delete System Log
MiniFetion , an app from the Baidu app marketplace, sends free SMS
totheuser‚Äôscontacts.Despitetheseeminglystraightforwardnature
oftheapp,wefound twohighlyquestionablebehaviors.First,the
appdeletesthesystemlogvia "logcat -c" .Second,theapphas
an activity MobClickAgent which uploads device logs to a third party
server. Thus the app is able to manipulate, as well as exfiltrate, the
systemlogswithouttheuser‚Äôsawareness.Whilenotmanypopular
appshavethisSHB,usersneedtobeextremelysuspiciousofany
app which send device logs and user information to third-party
servers.
6 RELATED WORK
Behavior-based malware detection for Android has been long been
studied due to the prevalence of malware in the Android ecosys-
tem; a variety of methods for characterization and behavior-based
detection have been proposed.
Malwarebehaviorcharacterization. CopperDroidcharacterizes
malware behavior based on how it is initiated, either through Java,
JNI, or native code execution [ 20]. SmartDroid uses a combination
of static and dynamic analysis to detect conditions as a way to
expose the behavior of Android malware in UI-based triggers [ 29].
Machinelearning. Crowdroidusesc rowdsourcing toobtaintraces
of an app‚Äôs behavior [ 14]; it distinguishes between benign and ma-
licious apps of the same name and version by detecting anomalous
behaviorusingk-means;somelimitationsincludehavingtorelyon
theAndroid usercommunityasa sourceforapptraces, aswellas
having high energy consumption on devices. PUMA [ 21] evaluates
the scope and use of permissions. DREBIN [ 11] uses both static
analysisandmachinelearningtooptimizeanalysisanddetection
patterns; MAMA [ 22] uses classifiers based on features to detect
malware. Yerima et al. [ 28] use static analysis to build Bayesian
modelsasawaytodetectevasivemalware.Andromalyappliesma-
chinelearning(anomalydetectors)toclassifyfeaturesandevents
as benign or malicious [ 25]. DroidRanger uses a permission-based
footprinting scheme to detect malware followed by a heuristic-
basedfilteringschemetoidentifybehaviorofunknownmalware
families[32].DroidDetectivedetectsmalwarebasedonpermission
combination [ 19]; by obtaining permission combinations which
have been requested frequently by malware, it auto-generates sets
tobeusedasameansofidentifyingmalware.MONETcombines
runtime behavior with static structures to detect malware vari-
antsandtogeneratearuntimesignatureofthemalware[ 27].AV-
class performsmassive-scalemalware labelingthrough clustering
anti-viruslabels,andidentifyingthemostlikelyfamilynamesfor
each sample [ 24]. Similarly, Euphony categorizes malware samples
based on clustering the anti-virus labels produced by anti-virus
vendors [18].
Static analysis. Apposcopy uses static analysis to extract mal-
ware properties, and takesa more semantics-oriented approach to
classify malware based on its signature [ 16]. However one of its
biggestlimitationsisthatitcannotdetectobfuscationorself-hiding.Anothersignature-basedtoolisDroidAnalyticswhichcollects,man-
ages,andextractsmalwareandanalyzesmutationsandrepackaging
methods[ 30].Similarly,DroidAPIMinerusesclassifiersbasedonse-
manticinformationfromthebytecodeofapps,namelyAPIcalls[ 9].
Using dataflow analysis and frequency analysis, it captures the
mostcommonandrelevantAPIcallsusedbymalware.Fengetal.
focus on a structure of information flows gathered through the se-
quenceofAPIcallsandthepatternsofbehaviorpresenttoidentify
malware [ 26]. Similarly, we have employed such API and dataflow
analysesinourworktoanalyzeSHB.MADAMisahost-basedmal-
waredetectionsystemforAndroiddevices[ 23];itanalyzesfeatures
at 4 levels ‚Äì kernel, app, user, and package ‚Äì which enables it to
detect 125 existing malware families.
Rather than focusing on general behavior-based analysis of mal-
ware,weimplementarangeofstaticanalysestodetectSHBand
malware.Machinelearning,whileusefulinbetterunderstanding
malware behavior, has several disadvantages, e.g., the models itlearns are opaque whereas we have a static analysis report that
helpsusers/developers/marketplacestracetheSHB precisely;fur-
thermore,machinelearningmayoversimplifySHBresultinginto
largenumbersoffalsepositives.Moststaticanalysesofmalware
are focused on behavior and do not employ attribute analysis as
wedo;thisanalysisiskeyinidentifyingSHBsuchastransparent
activities. Finally, our work differs from dynamic analysis-basedapproaches in the standard static vs. dynamic analysis way: due
to static analysis our approach is prone to false positives, but does
not require running the app. Dynamic analysis is prone to false
negativesandrequireshigh-qualityinputstoensuregoodcoverage.
7 CONCLUSION
Motivated by the common tendency of Android malware to self-
hideinordertodeceiveusersandcovermalicioustraces,wedefineasetofself-hidingbehaviorsandconstructasuiteofstaticanalysestorevealsuchbehavior.Ourexperimentsindicatethatthepresenceofself-hidingbehaviorisstronglyassociatedwithmaliceinagiven
app. Nevertheless, we also found plenty of benign, widely-popular
appsthatemployhidingtechniques,whichsuggeststhatend-users
and marketplaces would benefit from using an approach like oursto shed light on potential nefarious behavior in Android apps andimprove user experience.
ACKNOWLEDGMENTS
We thank the anonymous reviewers for their valuable feedback.
ThismaterialisbaseduponworksupportedbytheNationalScience
FoundationunderGrantNo. CNS-1617584 .Researchwassponsored
by the Army Research Laboratory and was accomplished under
CooperativeAgreementNumberW911NF-13-2-0045(ARLCyber
Security CRA). The views and conclusions contained in this doc-ument are those of the authors and should not be interpreted asrepresenting the official policies, either expressed or implied, of
the Army Research Laboratory or the U.S. Government. The U.S.
Government isauthorized to reproduce anddistribute reprints for
Government purposes notwithstanding any copyright notation
here on.
738
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. ICSE ‚Äô18, May 27-June 3, 2018, Gothenburg, Sweden Zhiyong Shan, Iulian Neamtiu, and Raina Samuel
REFERENCES
[1]2017. 8,400 new Android malware samples every day.
(April 2017). https://www.gdatasoftware.com/blog/2017/04/
29712-8-400-new-android-malware-samples-every-day.
[2] 2017. AndroMalShare. (August 2017). http://sanddroid.xjtu.edu.cn:8080.
[3]2017. The DroidCat Dataset. (June 2017). http://www.people.vcu.edu/~rashidib/
Res_files/DroidCatDataset.htm.
[4] 2017. JADX. (August 2017). http://skylot.github.io/jadx/.
[5] 2017. Kharon project. (May 2017). http://kharon.gforge.inria.fr/index.html.
[6]2017. OpenMalware. (August2017). http://www.offensivecomputing.net/search.
cgi?search=android.
[7] 2017. VirusTotal. (August 2017). https://www.virustotal.com.
[8]2018. Global mobile OS market share in sales to end users from 1st quarter 2009
to2ndquarter2017. (February2018). https://www.statista.com/statistics/266136/
global-market-share-held-by-smartphone-operating-systems/.
[9]YousraAafer,WenliangDu,andHengYin.2013. Droidapiminer:Miningapi-level
features for robust malware detection in android. In International Conference on
Security and Privacy in Communication Systems. Springer, 86‚Äì103.
[10]Kevin Allix, Tegawend√© F. Bissyand√©, Jacques Klein, and Yves Le Traon. 2016.
AndroZoo: Collecting Millions of Android Apps for the Research Community. In
Proceedingsofthe13thInternationalConferenceonMiningSoftwareRepositories
(MSR ‚Äô16). ACM, New York, NY, USA, 468‚Äì471. https://doi.org/10.1145/2901739.
2903508
[11]Daniel Arp, Michael Spreitzenbarth, Malte Hubner, Hugo Gascon, Konrad Rieck,
andCERTSiemens.2014. DREBIN:EffectiveandExplainableDetectionofAn-
droid Malware in Your Pocket.. In NDSS.
[12]StevenArzt,SiegfriedRasthofer,andEricBodden.2017.TheSoot-basedToolchain
forAnalyzingAndroidApps.In Proceedingsofthe4thInternationalConferenceon
MobileSoftwareEngineeringandSystems(MOBILESoft‚Äô17).IEEEPress,Piscataway,
NJ, USA, 13‚Äì24. https://doi.org/10.1109/MOBILESoft.2017.2
[13]Steven Arzt, Siegfried Rasthofer, Christian Fritz, Eric Bodden, Alexandre Bartel,
JacquesKlein,YvesLeTraon,DamienOcteau,andPatrickMcDaniel.2014. Flow-
Droid:PreciseContext,Flow,Field,Object-sensitiveandLifecycle-awareTaint
Analysis for Android Apps. In Proceedings of the 35th ACM SIGPLAN Conference
on Programming Language Design and Implementation (PLDI ‚Äô14). ACM, New
York, NY, USA, 259‚Äì269. https://doi.org/10.1145/2594291.2594299
[14]Iker Burguera, Urko Zurutuza, and Simin Nadjm-Tehrani. 2011. Crowdroid:
behavior-basedmalwaredetectionsystemforandroid.In Proceedingsofthe1st
ACM workshop on Security and privacy in smartphones and mobile devices. ACM,
15‚Äì26.
[15]Karim O. Elish, Danfeng (daphne Yao, and Barbara G. Ryder. 2012. User-Centric
Dependence Analysis For Identifying Malicious Mobile Apps (MOST‚Äô12).
[16]YuFeng,SaswatAnand,IsilDillig,andAlexAiken.2014. Apposcopy:Semantics-
based detection of android malware through static analysis. In Proceedings of
the 22nd ACM SIGSOFT International Symposium on Foundations of Software
Engineering. ACM, 576‚Äì587.
[17]JianjunHuang,XiangyuZhang,LinTan,PengWang,andBinLiang.2014. As-
Droid: DetectingStealthy Behaviorsin AndroidApplications by UserInterface
andProgramBehaviorContradiction.In Proceedingsofthe36thInternationalCon-
ferenceonSoftwareEngineering(ICSE2014).ACM,NewYork,NY,USA,1036‚Äì1046.
https://doi.org/10.1145/2568225.2568301
[18]Mederic Hurier, Guillermo Suarez-Tangil, Santanu Kumar Dash, Tegawende
F.Bissyande,YvesLeTraon,JacquesKlein,andLorenzoCavallaro.2017.Euphony:Harmonious unification of cacophonous anti-virus vendor labels for Android
malware. In Proceedings of the 14th International Conference on Mining Software
Repositories. IEEE, 425‚Äì435.
[19]ShuangLiangandXiaojiangDu.2014. Permission-combination-basedscheme
for android mobile malware detection. In Communications (ICC), 2014 IEEE Inter-
national Conference on. IEEE, 2301‚Äì2306.
[20]Alessandro Reina,Aristide Fattori,and Lorenzo Cavallaro.2013. A systemcall-
centric analysis and stimulation technique to automatically reconstruct android
malware behaviors. EuroSec, April (2013).
[21]Borja Sanz, Igor Santos, Carlos Laorden, Xabier Ugarte-Pedrero, Pablo Garcia
Bringas,andGonzalo√Ålvarez.2013. Puma:Permissionusagetodetectmalwarein
android. In International Joint Conference CISIS¬¥12-ICEUTE¬¥ 12-SOCO¬¥ 12 Special
Sessions. Springer, 289‚Äì298.
[22]BorjaSanz,IgorSantos,CarlosLaorden,XabierUgarte-Pedrero,JavierNieves,
PabloGBringas,andGonzalo√ÅlvarezMara√±√≥n.2013. MAMA:manifestanalysis
formalwaredetectioninandroid. CyberneticsandSystems 44,6-7(2013),469‚Äì488.
[23]Andrea Saracino, Daniele Sgandurra, Gianluca Dini, and Fabio Martinelli. 2016.
Madam:Effectiveandefficientbehavior-basedandroidmalwaredetectionand
prevention. IEEE Transactions on Dependable and Secure Computing (2016).
[24]Marcos Sebastian,Richard Rivera, PlatonKotzias, and JuanCaballero. 2016. Av-
class:Atoolformassivemalwarelabeling.In InternationalSymposiumonResearch
in Attacks, Intrusions, and Defenses. Springer, 230‚Äì253.
[25]AsafShabtai,UriKanonov,YuvalElovici,ChananGlezer,andYaelWeiss.2012.
Andromaly: a behavioral malware detection framework for android devices.
Journal of Intelligent Information Systems 38, 1 (2012), 161‚Äì190.
[26]Feng Shen, JustinDel Vecchio, Aziz Mohaisen, StevenY Ko, and LukaszZiarek.
2017. Poster:AndroidMalwareDetectionusingMulti-FlowsandAPIPatterns.
InProceedings of the 15th Annual International Conference on Mobile Systems,
Applications, and Services. ACM, 171‚Äì171.
[27]Mingshen Sun, Xiaolei Li, John CS Lui, Richard TB Ma, and Zhenkai Liang. 2017.
Monet:auser-orientedbehavior-basedmalwarevariantsdetectionsystemfor
android. IEEE Transactions on Information Forensics and Security 12, 5 (2017),
1103‚Äì1112.
[28]SuleimanYYerima,SakirSezer,GavinMcWilliams,andIgorMuttik.2013. Anew
android malware detection approach using bayesian classification. In Advanced
Information Networking and Applications (AINA), 2013 IEEE 27th International
Conference on. IEEE, 121‚Äì128.
[29]Cong Zheng, Shixiong Zhu, Shuaifu Dai, Guofei Gu, Xiaorui Gong, Xinhui Han,
andWeiZou.2012.Smartdroid:anautomaticsystemforrevealingui-basedtrigger
conditionsinandroidapplications.In ProceedingsofthesecondACMworkshopon
Security and privacy in smartphones and mobile devices. ACM, 93‚Äì104.
[30]MinZheng,MingshenSun,andJohnCSLui.2013. Droidanalytics:asignature
based analytic system to collect, extract, analyze and associate android malware.
InTrust, Security and Privacy in Computing and Communications (TrustCom),
2013 12th IEEE International Conference on. IEEE, 163‚Äì171.
[31]Yajin Zhou and Xuxian Jiang. 2012. Dissecting Android Malware: Character-ization and Evolution. In Proceedings of the 2012 IEEE Symposium on Security
and Privacy (SP ‚Äô12). IEEE Computer Society, Washington, DC, USA, 95‚Äì109.
https://doi.org/10.1109/SP.2012.16
[32]Yajin Zhou, Zhi Wang, Wu Zhou, and Xuxian Jiang. 2012. Hey, you, get off of
my market: detecting malicious apps in official and alternative android markets..
InNDSS, Vol. 25. 50‚Äì52.
739
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 11:37:39 UTC from IEEE Xplore.  Restrictions apply. 