Automated Localization for Unreproducible Builds
Zhilei Ren
Key Laboratory for Ubiquitous Network and Service
Software of Liaoning Province, School of Software,
Dalian University of Technology, Dalian, China
zren@dlut.edu.cnHe Jiang
Key Laboratory for Ubiquitous Network and Service
Software of Liaoning Province, School of Software,
Dalian University of Technology, Dalian, China
jianghe@dlut.edu.cn
Jifeng Xuan
School of Computer Science,
Wuhan University,
Wuhan, China
jxuan@whu.edu.cnZijiang Yang
Department of Computer Science,
Western Michigan University,
Kalamazoo, MI, USA
zijiang.yang@wmich.edu
ABSTRACT
Reproducibility is the ability of recreating identical binaries un-
der pre-defined build environments. Due to the need of quality
assuranceandthebenefitofbetterdetectingattacksagainstbuild
environments, the practice of reproducible builds has gained popu-
larityinmanyopen-sourcesoftwarerepositoriessuchasDebianand Bitcoin. H owever,identifying the unreproducible issues re-
mainsalabourintensiveandtimeconsumingchallenge,because
of the lacking of information to guide the search and the diversity
of the causes that may lead to the unreproducible binaries.
InthispaperweproposeanautomatedframeworkcalledRepLoc
tolocalize theproblematicfilesfor unreproduciblebuilds.RepLoc
featuresaqueryaugmentationcomponentthatutilizestheinfor-
mation extracted from the build logs, and a heuristic rule-based
filtering component that narrows the search scope. By integrating
the two components with a weighted file ranking module, RepLoc
is able to automatically produce a ranked list of files that are help-
fulinlocatingtheproblematicfilesfortheunreproduciblebuilds.
We have implemented a prototype and conducted extensive ex-
periments over 671 real-world unreproducible Debian packages in
four different categories. By considering the topmost ranked file
only, RepLoc achieves an accuracy rate of 47 .09%. If we expand
our examination to the top ten ranked files in the list produced by
RepLoc, the accuracy rate becomes 79 .28%. Considering that there
arehundredsofsourcecode,scripts,Makefiles,etc.,inapackage,
RepLoc significantly reduces the scope of localizing problematic
files. Moreover, with the help of RepLoc, we successfully identified
and fixed six new unreproducible packages from Debian and Guix.
CCS CONCEPTS
•Softwareanditsengineering →Maintainingsoftware ;Soft-
ware evolution;
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the first page. Copyrights for components of this work owned by others than ACMmustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,topostonserversortoredistributetolists,requirespriorspecificpermissionand/ora
fee. Request permissions from permissions@acm.org.
ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
© 2018 Association for Computing Machinery.
ACM ISBN 978-1-4503-5638-1/18/05 ...$15.00
https://doi.org/10.1145/3180155.3180224KEYWORDS
Unreproducible Build; Localization; Software Maintenance
ACM Reference Format:
ZhileiRen,HeJiang,JifengXuan,andZijiangYang.2018.AutomatedLocal-
izationforUnreproducibleBuilds.In ICSE’18:ICSE’18:40thInternational
Conference on Software Engineering , May 27-June 3, 2018, Gothenburg, Swe-
den.ACM,NewYork,NY,USA,11pages.https://doi.org/10.1145/3180155.
3180224
1 INTRODUCTION
Asanindicatoroftheabilitythatthebinariescouldberecreated
consistentlyfromsource,recentyearshavewitnessedtheemerging
idea of reproducible builds. Given the source files, the reproducibil-
ity is described as the ability of building identical binary under
pre-definedbuildenvironments[ 15].Inthisstudy,sourcefilesin-
cludesourcecode,scripts,Makefiles,buildconfigurations,etc[ 6].
Checkingthereproducibilityofsoftwarecreatesaverifiablelink-
age thatbridges the gapbetween thereadable source filesand the
binary packages, which is important from various perspectives.
Firstly,reproducibilityisveryimportantforthesafetyofbuild
environments.Forsoftwareecosystems,attacksagainstthebuild
environment may lead to serious consequences. By compromising
the system to produce packages with backdoors [ 26,45], malicious
behaviors such as trusting trust attack [ 41] may be introduced
duringthebuildtime.Forexample,in2015,over4,000iOSappli-cations were infected by a counterfeit version of Apple’s Xcode
developmentenvironment(knownasXcodeGhost)[ 1].XcodeGhost
injectedmaliciouscodeduringcompilingtimesothatdevelopers
unknowinglydistributedmalwareembeddedintheirapplications
[21]. Obviously, a solution is to ensure that the same source files
always lead to the same binary packages so that an infected dif-
ferent binary immediately raises alarms. Unfortunately, a major
obstacleofdetectingsuchattacksliesinthetransparencygapbe-
tween the source filesand their compiled binary packages. Due to
non-deterministicissuessuchastimestampsandlocales,itisnot
uncommonthatrebuildinganapplicationyieldsdifferentbinaries
evenwithinsecurebuildenvironments.Therefore,thesekindsof
attacksofteneludedetectionbecausedifferentbinariesofthesame
application is normal.
Besides detecting attacks against build environments, validating
the reproducibility is also helpful in debugging and finding certain
712018 ACM/IEEE 40th International Conference on Software Engineering
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhilei Ren, He Jiang, Jifeng Xuan, and Zijiang Yang
release-critical bugs (e.g., libical-dev 1.0-1.1) [2]. Furthermore,
in the context of and continuous integration and software upgrade
[37], reproducible packages could be helpful in caching, and re-
ducing redundant operations,e.g., by eliminating the necessityof
delivering the different binaries compiled from the same source
files. Due to the significant benefits, many open-source software
repositories have initiated their validation processes. These reposi-
toriesincludeGNU/LinuxdistributionssuchasDebianandGuix,as
well as software systems like Bitcoin [ 19]. For instance, since 2014,
the number of Debian’s reproducible packages has been steadily
increasing.Figure1presentsthetrendofthereproduciblebuilds
inDebian [ 14].AsofAugust2017,over 85%of Debian’spackages
could be reproducibly built.
Despitetheefforttowardsreproducibility,manypackagesremain
unreproducible. For example, according to Debian’s Bug Track-
ingSystem(BTS),asofAugust23,2017,thereare2,342packages
that are not reproducible [ 14] for the unstable branch targeting
the AMD64 architecture. Such large number of unreproduciblepackages implies the challenges in detecting and then fixing theunreproducible issues. In particular, the localization task for the
problematicfilesistheactivityofidentifyingthesourcefilesthat
cause unreproducibility, which ranks source files based on theirlikelihoodofcontainingunreproducibleissues.Currently,thelo-
calization task is mostly manually conducted by developers. Since
theremaybehundredstothousandsofsourcefilesforapackage,
the localization tends to be labor intensive and time consuming.
To address this problem, we consider the source files as text
corpus, and leverages the diff log1generated by comparing the
differentbinariestoguidethesearch.Assuch,thelocalizationofthe
problematic files can be modeled as a classic Information Retrieval
(IR) problem: given the source files and the diff log, determine
thoseproblematicfilesfromthesourcefilesthatarerelevanttothe
unreproducible issues. The IR model has the potential to automate
the localization task. However, the localization task is challenging,
due to its unique characteristics.
First,theinformationforlocatingtheproblematicfileswithin
thesourcefilesisverylimited.Thediffloggeneratedbycomparing
the different binaries, which is considered as the input of the IR
process, may not be sufficiently informative. We call this challenge
aninformationbarrier .Inaddition,therearemanycausesthat
may lead to unreproducible builds, such as embedding timestamps
infilesandrecordingfilelistsinnon-deterministicorder.Thede-
tailed issues are manually listed in Debian’s documentation [ 12].
Moreover, the diverse types of files in a package also add to thecomplexity of localizing the problematic files, which may residein not only the source code, but also other types of files such as
scripts,Makefilesandbuildconfigurations.Wecallthischallengea
diverse-cause barrier .
To break through the barriers, we propose a localization frame-
work called RepLoc that targets the localization task in search
ofproblematicfilesforunreproduciblebuilds.Givenanunrepro-
duciblepackagewithtwodifferentbuiltbinariesastheinput,Re-
pLoc produces a list of ranked source files. RepLoc features two
componentsthataddressthetwoaforementionedchallenges.For
theinformationbarrier,wedevelopaQueryAugmentation(QA)
1Generated by diffoscope , https://diffoscope.org
Figure 1: Reproducibility status of Debian unstable for
AMD64
componentthatutilizestheinformationextractedfromthebuild
logstoenhancethequalityofthequeries(representedbythefile
names extracted from the difflogs, see Section 2). For the diverse-
causebarrier,wedevelopaHeuristicrule-basedFiltering(HF)com-
ponent. More specifically, we propose 14 heuristic rules that areobtained by summarizing the information presented in Debian’s
documents. Furthermore, we employ a weighted File Ranking (FR)
componenttocombinetheQAandHFcomponents,andbuildanin-tegratedframeworktoautomatethelocalizationoftheproblematic
files for unreproducible builds.
To evaluate RepLoc, we have collected a real-world dataset that
consistsof671unreproduciblepackages.SincethesepackageswerelaterfixedwithpatchesfromDebian’sBTS,weknowexactlywhich
files caused the unreproducibility and thus can use the facts to
evaluatetheaccuracyofRepLoc.Ifweconsiderthetopmostranked
file only, RepLoc achieves an accuracy rate of 47 .09%. If we expand
therangetoincludetoptenrankedfiles,theaccuracyratebecomes
79.28%. For other metrics such as precision and recall, RepLoc also
outperforms the comparative approaches significantly. To further
evaluate the effectiveness of our approach, we use RepLoc on unre-
producible packages that have never been fixed before. With thehelp of RepLoc, we successfully identified the problematic files,
thenmanuallyfixedtheunreproducibleissuesoverthreeDebian
packages. Moreover, the usefulness of RepLoc is examined overa different software repository (Guix [
11] in this study). Under
the guidance of RepLoc, problematic files for three unreproducible
packages from Guix are detected and fixed.
This paper makes the following main contributions.
•Tothebestofourknowledge,thisisthefirstworktoaddressthe
localization task for unreproducible builds.
•WeproposeaneffectiveframeworkRepLocthatintegratesheuris-
ticfilteringandqueryaugmentation.Aprototypehasbeenim-
plemented based on the approach.
•WehaveevaluatedRepLocon671unproducibilepackagesthat
werelaterfixedintheDebianrepository.Theexperimentalre-
sults show that RepLoc is effective. We have made the bench-
marks publicly available at https://reploc.bitbucket.io .
•UndertheguidanceofRepLoc,wefixedsixunreproduciblepack-
ages from Debian and Guix, and submitted the patches to the
BTSsofthetworepositories.Amongthesubmittedpatches,four
have been accepted.
72
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. Automated Localization for Unreproducible Builds ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
Figure 2: Reproducibility validation work flow
Table 1: Snippet of altered environment variations
Configuration First build Second build
env TZ “/usr/share/zoneinfo/Etc/GMT+12” “/usr/share/zoneinfo/Etc/GMT-14”
env LANG “C” “fr_CH.UTF-8”env LANGUAGE “en_US:en” “fr_CH:fr”env BUILDDIR “/build/1st” “/build/2nd”... ... ...
Therestofthispaperisorganizedasfollows.InSection2,we
give the background of this work. Our approach is presented in
Section 3, followed by experimental study in Section 4. The threats
tovalidityandrelatedworkaredescribedinSections5–6.Finally,
Section 7 concludes the paper.
2 BACKGROUND
Taking Debian as a typical example, Figure 2 illustrates the com-
monworkflowofvalidatingthereproducibilityofpackages[ 17].
First, the source files are compiled under two pre-defined build en-
vironments(steps1–2).Morespecifically,thebuildenvironments
are constructed by setting up altered environment variables or
software configurations. For instance, within Debian’s continuous
integration system,2altered environment variables include locales,
timezones, user privileges, etc. Table 1 presents a snippet of the
altered environment (see [ 22] for more detailed information). Two
versions of binaries can be generated with respect to each environ-
ment.Thetwoversionsarethencomparedagainsteachother(step3).Iftheyarenotbit-to-bitidentical,thelocalizationofproblematic
filesthatleadtounreproduciblebuildsisrequired,basedonthediff
log and the source files (step 4).
The build and the comparison procedures (steps 1–3) can easily
be automated, but the localization (step 4) mainly relies on the
developers.Unfortunately,manualefforttoidentifythefilesthat
leadtounreproduciblebuildsisnontrivial.AsshowninFigure2,
thedifflogsarethemajorsourceoftheinformationtoguidethe
localization of the problematic files, which, unfortunately, are not
always sufficiently informative.
Figure 3 gives a snippet of the diff log for dietlibc , a libc
implementation optimized for small size. In the original version
(0.33~cvs20120325-6),astaticlibraryfilediffersbetweenthetwover-
sions during the build time ( /usr/lib/diet/lib/libcompat.a ).
Asshowninthedifflog, diffoscope indicatesthedifferencevia
theoutput oftheGNUbinary utility readelf.However,since the
2https://jenkins.debian.net
Figure 3: Diff log snippet for dietlibc
(a) Makefile snippet
(b) Patch snippet
Figure 4: Makefile and patch snippet for dietlibc
diff content may not be well comprehensible (e.g., lines 7–8 in
Figure 3), we do not leverage such information in this study. Mean-
while,Figure4presentsasnippetofaproblematicfile( /Makefile )
and the patch that fixes the issue. In Figure 4(b), line 8 indicates
thattherootcauseoftheunreproducibilityliesinthenon-stable
order of the object files, which are fed to the arutility to generate
libcompat.a (lines 6–7 of Figure 4(a)). The difficulty in this exam-
ple is that, the diff log may fail to provide sufficient information.
Though it is possible to match the correct file with only the file
name, i.e., line 6 of Figure 4(a), chances are that other irrelevant
files containing the same file name might be matched as well.
Theaforementionedexampleillustrateshowproblematicfiles
can be detected and fixed. In reality there are multiple altered
buildconfigurationsandcanbemanycorrespondingcausesthat
lead to unreproducible builds. For example, changing the timezone
environment variable ( env TZ) may cause the C/C++ packages
thatembed __DATE__ macrotobeunreproducible,andthelocale
environmentvariable( env LC_* )maytriggerunreproducibleissues
of packages that capture the text generated by programs. These
diverse unreproducible causes make the localization task difficult.
3 OUR APPROACH
In this section, we discuss the details of RepLoc. Figure 5 depicts
the work flow of RepLoc that consists of three components QA,HF, and FR. For each component, we shall explain its design and
implementation,companionedwiththeintermediateresultsover
the running example dietlibc .
3.1 Query Augmentation Component
TheupperpartofFigure5depictstheQAcomponent,whichen-
riches the queried information by matching the files in the diff log
and the build logs, to tackle the information barrier.
73
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhilei Ren, He Jiang, Jifeng Xuan, and Zijiang Yang
Figure 5: The RepLoc Framework
Figure 6: Build log snippet for dietlibc
First,thedifflogisgeneratedusing diffoscope .Then,thequery
extraction module takes the diff log as the input, and generates
the basic query. In this study, the basic query consists of the file
names in the diff log. As mentioned, due to the information barrier,
the information that can be utilized to localize the problematic
files is limited other than a list of files that are different within the
twobuildprocesses.Thus,weenhancethequalityofthequeries
with the build command retrieval module. The motivation for this
moduleisthat,duringthebuildprocess,thebuildinformationsuch
as the executed commands can be obtained. Moreover, based on
theco-occurrencerelationshipbetweenthefilenamesinthediff
logandthebuildcommands, we canidentifythebuildcommands
with which the files mentioned in the diff log are built. Hence,
it is rational to augment the query by supplementing the build
commands from the build log.
Figure6illustratesasnippetofthebuildlogoftheexemplifying
package dietlibc . It can be observed that the build log is more
informative and provides supplementary information with respect
to the diff log. More specifically, we first split the build log into
build command segments, with respect to the “ Entering/Leaving
directory ”tagsgeneratedby make(e.g.,lines1and10ofFigure6).
With this operation, the commands invoked under the same direc-
tory can be grouped together, as a file of the augmentation corpus
(denotedasacommandfile).Notethatthoughtherearetwover-
sionsofbuildlogswithrespecttothetwobuildenvironments,since
we are interested in the build command, the choice of either ver-
sion of build log does not have an impact on the results. Then, the
relevantfilesinthecorpusareobtainedbyutilizinganIRmodel.Inessence,anyIRmodelcanbeadopted.Inthisstudy,weemploythe
Vector Space Model (VSM), due to its simplicity and effectiveness.Table 2: Heuristic rule set
IDRule PCRE statement
1 TIME_MACRO __TIME__
2 DATE_MACRO __DATE__
3 GZIP_ARG \bgzip \s(?!.*-[a-z9]*n)
4 DATE_CMD (\$\(date)|(\$\(shell \s*date)|(\`date)
5 PY_DATE datetime \.datetime \.today
6 PL_LOCALTIME \$\.*localtime
7 SYSTEM_DATE system.*date
8 DATE_IN_TEX \\date.*\\today
9 SORT_IN_PIPE ˆ.*\|‘(?!.*LC_ALL=).* \s*sort\b
10 GMTIME gmtime \(
11 TAR_GZIP_PIPE \btar\b.*\|\s*\bgzip \b
12 PL_UNSORTED_KEY (ˆ(?!.*sort).*\s*keys \s*%)
13 LS_WITHOUT_LOCALE ˆ.*\$\(.*(?!.*LC_ALL=).* \s*\bls\b
14 UNSORTED_WILDCARD (ˆ(?!.*sort).*\s*\bwildcard \b)
To realize the VSM based augmentation, we calculate the cosine
similarity between basic query and the command files. Thereafter,
the matched commands from the most relevant command files are
obtained. In particular, for the VSM model, we assign weight value
foreachfilewiththe TF-IDF(TermFrequency-InverseDocument
Frequency)measurement,whichiswidelyusedinIR[ 32].Inthis
paper,foraterm tinadocument d,itsTF-IDFt,dvalueiscalculated
basedon ft,d×N
nt,whereft,dindicatesthenumberof t’soccur-
rences in d,ntdenotes the number of files in which tappears, and
Nmeans the number of source files. With TF-IDFdefined, each file
isrepresentedasavector,andthecosinesimilaritywiththebasic
query is used to rank the command files.
Sim(/vecl,/vecs)=/vecl·/vecs
|/vecl||/vecs|, (1)
where/vecl·/vecsrepresents the inner product of the basic query and
thecommandfile,and |/vecl||/vecs|denotestheproductof2-normofthe
vectors.Afterthat,thebasicqueryandtheretrievedcontents,which
are commands executed during the build process, are concatenated
together as the enhanced query.
Running example: Fordietlibc , all the file names in the diff
log, e.g., ./usr/lib/diet/lib/libcompat.a , are extracted as the
basic query. Then, within the augmentation, ar cru bin-x86_-
64/libcompat.a [ ...](line 3 of Figure 6) and the build com-
mandsinthesamecommandfileareretrieved.Finally,thecontents
of theretrieved commandfiles areappended afterthe basicquery,
as the final query.
3.2 Heuristic Filtering Component
The HF component is designed to capture the problematic files
byincorporatingthedomainknowledge,whichisrepresentedas
frequently observed patterns. In HF, the heuristic rules are con-
structed based on the following criteria: (1) The rules are manually
constructedbasedonDebian’sdocumentation[ 13].(2)Therules
are summarized for the four major categories of unreproducible
issues(seeSetcion4.2).Wetraversethenotesinthedocumentation,
and capture those issues that are described as Perl Compatible Reg-
ularExpression(PCRE).Forexample,invoking gzipwithout“-n”
argument could be expressed using the negative assertions feature
ofPCRE(rule3inTable2).Meanwhile,asacounterexample,the
timestampsembeddedinPortableExecutable(PE)binariesarehard
74
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. Automated Localization for Unreproducible Builds ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
to be identified by heuristic rules or even by developers [ 20]. After
manual inspection based on the criteria, we obtain 14 heuristic
rules, which are presented in Table 2, and described as follows:
(1)TIME_MACRO : using C time preprocessing macro in source
fileswillembeddifferenttimestampswhencompiledatdifferent
times.(2) DATE_MACRO :embeddingC datepreprocessingmacro in
sourcefilesissimilarasthepreviouscase.(3) GZIP_ARG :ifapplying
gzip without -n argument, timestamps will be embedded in the
header of the final compressed file. (4) DATE_CMD : capturing the
current date with the dateshell command. (5) PY_DATE: obtain-
ingdatetimeinPythonscripts.(6) PL_LOCALTIME :obtainingdate
time in Perl scripts. (7) SYSTEM_DATE : recording system time in the
compiled binary. (8) DATE_IN_TEX : embedding date in TeX files,
whichinfluencesthebuiltpdffiles.(9) SORT_IN_PIPE :executesort
inpipelinewithoutlocalesetting.(10) GMTIME:obtainingcurrent
date time. (11) TAR_GZIP_PIPE : execute tarandgzipin pipeline.
(12)PL_UNSORTED_KEY :traversingunsortedhashkeysinPerlscript
does not guarantee identical order. (13) LS_WITHOUT_LOCALE : cap-
turinglswithout locale setting is similar with SORT_IN_PIPE . (14)
UNSORTED_WILDCARD :usingwildcard inMakefileswithoutsorting,
similar with PL_UNSORTED_KEY .
By applying the rules over the source files (e.g., with GNU grep
-r -P), we obtain a subset of files that may lead to unreproducible
builds.Notethattheserulesequallytreatthesourcefilesasplain
text,ratherthanconsiderthefiletypes(e.g.,basedonfileextension).
Thereasonisthattheunreproducibleissuesmayresideinsnippets
ortemplatesthatdonotfollowfileextensionconventions,which
are eventually embedded into unreproducible binaries. Based on
such consideration, we do not sort the matched files in HF.
Running example: Fordietlibc ,thereareintotalfiveprob-
lematic files, namely, /libpthread/Makefile ,/libdl/Makefile ,
/debian/{rules ,implicit} , and /Makefile . Among these files,
/Makefile (see Figure 4(b)) can be captured by the UNSORTED_-
WILDCARD rule, in which sortdoes not appear before wildcard .
However,weshouldnotethattheremaybefalsealarms,e.g.,for
unexecuted commands or text in the comments. Consequently, HF
mayfailtoplacethematchedproblematicfilesatthetopofthelist.
3.3 File Ranking Component
ThemotivationsbehindthecombinationofHFandQAaretwofold:(1)TheheuristicrulesinHFfocusonthestaticaspectofthesource
files, i.e., treat all the source files in a unified way, and capture the
suspiciousfilesthatmatchthedefinedpatterns.Suchmechanism
can handle various file types. Unfortunately, there may be false
alarms,especiallyforthosefilesunusedduringthebuildprocess.(2)
The build log based augmentation takes the dynamic aspect of the
build process into consideration. With QA, we concentrate on the
commands invoked during the build process. Hence, by combining
themechanisms,wecanstrengthenthevisibilityoftheproblematic
files that lead to unreproducible builds.
IntheFRcomponent,thesegoalsarerealizedasfollows.First,
with the augmented query, the relevant files are obtained with the
sourcefileretrievalmodule.SimilarasinSection3.1,theVSMmodelisadoptedtocalculatethesimilarityvaluesbetweentheaugmentedqueryandeachsourcefile.Second,sincewehaveacquiredboththe
files retrieved by HF and the similarity values between source filesAlgorithm 1: RepLoc
Input:binary package first, binary package second, weightα
Output:candidate file list result
1begin
// Query Augmentation
2log←diffoscope (first ,second)
3query←parse_log(log)
4command_files ←parse_build_log (build_log)
5relevant_command ←retrieve_relevant (query ,command_files )
6augmented ←concatenate (query ,relevant_commant )
// Heuristic Filtering
7list←∅
8foreach source file sdo
9 ifsis matched by any rule in Table 2 thenlist←list∪{s}
10end
// File Ranking
11foreach source file sdo
12 ifs∈listthenws←1
13 elsews←0
14 scores←CalculateSim/primewith respect to Equation 2
15end
16returnsort(source_files ,score)
17end
Table 3: Files retrieved by RepLoc and its components over
dietlibc , with successful hits in bold
Rank FR (without QA) Rank FR (with QA)
1/CHANGES 1/debian/rules
2/debian/rules 2/Makefile
3/Makefile 3/CHANGES
4/debian/control 4/debian/patches/0005-[ ...].diff
5/FAQ 5/diet.c
Rank HF Rank RepLoc
1/t.c 1/debian/rules
2/debian/implicit 2/Makefile
3/debian/dietlibc-dev.postinst.in 3/CHANGES
4/debian/rules 4/libpthread/Makefile
5/libugly/gmtime.c 5/libdl/Makefile
andtheaugmentedquery,inthefilerankingmodule, itisnatural
to combine these two types of information, to better capture the
problematicfiles.Forexample,wecanmodifyEquation1andapply
Sim/primeto rank the source files:
Sim/prime(/vecl,/vecs)=(1−α)×Sim(/vecl,/vecs)+α×ws, (2)
wherews=1 for those source files matched by the HF compo-
nent, and ws=0 otherwise. α∈[0,1]is a weight parameter to
balancethetwoterms,e.g.,large αvaluesmakeRepLocfavorthe
HF component.
WithEquation2,thesourcefilesarerankedaccordingtotheir
modified similarity to the augmented query, and the top ranked
files are returned as the final results of RepLoc. We should note
that, in this study, we adopt the file-level localization paradigm, in
thatthefixingformanyunreproduciblepackagesisnotunique.Forinstance,statementsdeclaringmissingenvironmentalvariablescanappearanywhereinthefilebeforeitisneeded.Hence,itisdifficult
to establish line-level ground-truth. In Algorithm 1, we present the
pseudo-code of RepLoc, which combines QA (lines 2–6), HF (lines
7–10), and FR (lines 11-16) sequentially.
Running example: In Table 3, we present the top five files
retrieved by RepLoc and its individual components. From the table,
75
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhilei Ren, He Jiang, Jifeng Xuan, and Zijiang Yang
wecanobservethatwithoutaugmentingthequery,FRisableto
retrieve two problematic files. However, the topmost ranked fileis a changelog (
/CHANGES ), in that the file names in the diff log
appear in this file. In contrast, with the query augmented, FR (with
QA)isabletorankthetwoproblematicfilesatthetopofthelist.
Meanwhile,althoughHFisabletocapture /libpthread/Makefile ,
thefileisnotassignedtoprankduetootherfalsealarms,e.g., /t.c.
Finally,bycombiningFR,QA,andHF,RepLocisabletolocatefour
problematic files.
4 EXPERIMENTAL RESULTS
4.1 Research Questions
Inthisstudy,weintendtosystematicallyanalyzeRepLoc,byinves-
tigating the following Research Questions (RQs):
•RQ1: Is RepLoc sensitive to the weighting parameter α?
•RQ2: How effective is RepLoc?
•RQ3: How efficient is RepLoc?
•RQ4: Is RepLoc helpful in localizing unfixed packages?
AmongtheseRQs,RQ1concentratesontheimpactoftheweight-
ing scheme between the components in RepLoc. RQ2 focuses on
howwellRepLocperformsintermsofdifferentqualitymetrics.RQ3
examineswhetherRepLocistimeconsuming,andRQ4investigates
the RepLoc’s generalization.
4.2 Data Preparation
Inthisstudy,thedatasetisconstructedbyminingDebian’sBTS.To
the best of our knowledge, Debian is the only repository providing
both past-version packages and reproducibility-related patches,
whicharecrucialforgeneratingthecorpusandthegroundtruth.
Consequently,allthepackageswithinthedatasetareextractedfrom
Debian’ BTS, which are tagged as unreproducible bybug reporter
viadebtags, i.e., the command line interface for accessing the
BTS. According to Debian’s documentation, there are 14 categories
of reproducible issues [ 16]. There are also two special categories
indicating the packages that fail to build from source, and the tool-
chainissues(non-deterministicissuesintroducedbyotherpackages,
see Section 5), which are not considered in this study.
We download all the 14 categories of 1716 bug reports, and
download the packages, with their corresponding patches. Then,
weapplythevalidationtoolkit,3toobtainthecorrespondingdiff
logsandbuildlogs.Inthisstudy,weconsiderthosecategorieswithmorethan30packages.Withsuchcriterion,weobtain671packagesinthedataset,whichfallintothefourlargestcategories.Figure7(a)
illustrates the statistics of the dataset. In the figure, we present the
numbersoftheopenandclosedbugsinDebian’sBTS,aswellas
the number of packages in the dataset. Among the four categories
of packages, the Timestamps category contains the most packages
(462), followed by File-ordering (118), Randomness (50), and Locale
(41). For all the four categories of 1491 packages that are labeled as
“done”,thepackagesinthedatasettakeaportionof45 .34%.Note
that there are less packages in the dataset than closed bug reports,
sincepackagesmaynotbecompilableduetotheupgradeoftheir
dependencies.
3Thetoolkitrealizessteps1–3ofFigure2,availableathttps://anonscm.debian.org/
cgit/reproducible/misc.git
(a) Number of packages
 (b) Problematic file types
Figure 7: File statistics of the dataset
In Figure 7(b), we illustrate the statistics of the patches in the
dataset. From the figure, we could observe that there are many
typesoffilesthatmightbeinvolvedintheunreproduciblebuilds.
For these files, the Debian rulesfiles, which are the main build
scripts,takethelargestportionofthefixedfiles(29.82%).Auxiliaryfiles,suchasthe
configure scriptsandinputfiles( *.in),takesthe
second largest portion (17.21%). After that, there are the Makefiles
(11.68%), scripts such as Python/Perl/PHP files (14.60%), C/C++
files (5.94%), XML files (4.80%), implicit build files (2.71%). Since
we classify the files based on their file extensions heuristically,
there are also 13.24% of the files that are not easy to classify, e.g,
those without file extensions. This phenomenon conforms with
the second barrier mentioned in Section 1, i.e., the causes to theunreproducible builds are diverse, which makes the localization
task very challenging.
4.3 Implementation and Metrics
RepLocisimplementedinPerl5.24andJava1.8.Alltheexperimentsare conducted on an Intel Core i7 4.20 GHz CPU server with 16 GB
memory,runningGNU/Linuxwithkernel4.9.0.Forthecompara-
tive algorithms, we consider four variants of RepLoc, since there is
no priorapproach addressing this problem.The first twovariants
implement two baseline algorithms, which only consider either
theHFortheFRmodel(denotedasRepLoc(HF)andRepLoc(FR)).
Thesetwovariantsareincorporatedtoexaminetheperformance
ofitsbuilding-blockcomponents.Moreover,RepLoc(FR)couldbe
consideredthesimulationofthemanuallocalization,sinceinFR,
theretrievalisrealizedbymatchingsourcefileswithdifflogcon-
tents.Then,RepLoc(FR+QA)considersutilizingtheQAcomponent
to enhance the basic queries extracted from the diff logs. Finally,
RepLoc indicates the version discussed in Section 3.
ToevaluatetheeffectivenessofRepLoc,metricscommonlyused
intheIRliteraturesareemployedtoevaluatetheperformanceof
RepLoc,includingtheaccuracyrate,theprecision,therecall,and
theMeanAveragePrecision( MAP).Themetricsarecomputedby
examiningtherankedlistofsourcefilesreturnedbytheframework
in response to a query. The Top- Nsource files in the ranked list
iscalledtheretrievedsetandiscomparedwiththerelevancelist
to compute the Precision and Recall metrics (denoted by P@Nand
R@Nrespectively).Givenanunreproduciblepackagewithproblem-
aticfiles,aTop- Naccuracyratescore,e.g. A@1,A@5,andA@10,
of a localization tool is the portion of Top- Nlists a tool provides
thatatleastoneproblematicfilecontainsinit[ 30,48].Inthisstudy,
76
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. Automated Localization for Unreproducible Builds ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
Figure 8: Impact of varying α
wealsoreport P@1,P@5,P@10andR@1,R@5,R@10[28,48].P@N
meanstheportionofproblematicfilessuccessfullyretrievedina
Top-Nlist,while R@Nmeasureshowmanyproblematicfilesare
retrieved in a Top- Nlist among all the problematic files:
P@N=# of files that cause unreproducible builds
N,(3)
R@N=# retrieved problematic files in the Top- Nlist
# of problematic files.(4)
Precision and Recall usually share an inverse relationship, in
that, the Precision is higher than Recall for lower values of Nand
vice versa for higher values of N. An overall metric of retrieval
accuracy is known as Mean Average Precision ( MAP), which is
the average of the Average Precision ( AP) values over all the prob-
lematic files in unreproducible packages. For an unreproducible
package with several problematic files, the APis computed as/summationtext.1M
k=1P@k×pos(k)
# of files related in the patch, whereMis the size of a ranking
list,pos(k)indicates whether the kthfile in a ranking list is related
to the unreproducible build, and P@kis the precision described in
Equation 3. With APdefined,MAPcan be calculated by averaging
all theAPscores across all the unreproducible packages.
4.4 Investigation of RQ1
In this RQ, we intend to investigate whether RepLoc is sensitive to
theweightingparameter α.AsdescribedinSection3,inEquation2,
we propose the weighted similarity between queries and source
files. Hence, in this RQ, we are interested in investigating RepLoc’s
behavior as we alter the weight of the two components. More
specifically,foreachcategoryofdataset,werandomlyselecthalf
of the packages, and a grid search from 0.1 to 0.9 with a step of 0.1
is employed to analyze the impact of varying α.
ConsideringtheTimestampsandtheLocaledatasets,wevisually
present the trend of the A@10,P@10,R@10and theMAPvalues
againstthe αvalueinFigure8.Fromthefigure,thefollowingob-
servations can be drawn. First, for the randomly selected packages,
theperformanceofRepLocexhibitssimilartrend,i.e.,when αisset
within the range [0.2,0.4], RepLoc obtains the best results. Second,
weobservethatRepLocisnotverysensitiveto α,unlessαistoo
large,whichwillmakeRepLocprefertheHFcomponent.Hence,
for the subsequent experiments, αis set with 0.3.
AnswertoRQ1: Experimentalresultsshowthat,RepLocisnot
verysensitivetotheparameter,whichtosomeextentdemonstrates
the robustness of RepLoc.4.5 Investigation of RQ2
In this RQ, we examine whether RepLoc locates the problematic
filesaccurately.Wepresenttheexperimentalresults,anddiscuss
thephenomenaobserved.InTable4,wefirstgivetheresultsover
the datasets. The table is organized as follows. The first column
indicates the four categories of datasets we built in this study (see
Section 4.2). The second column represents the four variants of
RepLoc.Then,therestofthetablepresentsthemetricsthatevaluate
the performance of each variant. Note that for the accuracy rate,
theprecision,andtherecall,themetricvaluesareaveragedoverall
thepackages. Besides,wealsopresent theaggregateperformanceat the bottom of the table.
TakingtheTimestampsdatasetasanexample,severalinteresting
phenomena can be observed. First, the performance of RepLoc(HF)
is not satisfying. Even considering the Top-10 results, the corre-sponding accuracy rate is around 70%. To examine the represen-
tativenessoftheheuristicrules,inTable5wepresenttheresults
of RepLoc(HF)with singlerule. We reportthe A@10,P@10,R@10,
andMAPof the five rules that perform the best. Among the rules,
theGZIP_ARG ruleachievesthehighestaccuracyrate.However,the
A@10valueisbelow30%,whichissignificantlyoutperformedby
RepLoc(HF) that considers all the rules. Similar observations could
be drawn for other performance metrics, which to some extent
confirms the diverse-cause barrier.
Second, by comparing the results of RepLoc(FR+QA) against
RepLoc(FR) in Table 4, we can confirm the usefulness of QA. As
mentioned, RepLoc(FR) could be loosely considered the simulation
ofmanuallocalization,whichtriestomatchtheproblematicfiles
withthedifflogcontents.OvertheTimestampsdataset, A@10of
RepLoc(FR) is71 .21%. Withthe augmentationof the query, A@10
improves to 76 .41%. Moreover, when we combine RepLoc(FR+QA)
withHF,theperformanceisfurtherimproved,i.e., A@10ofRepLoc
achieves 82 .90%, which implies that for over 80% of the unrepro-
duciblepackagesintheTimestampsdataset,atleastoneproblem-
atic file is located in the Top-10 list. Besides, similar results are
obtainedovertheotherdatasets,i.e.,RepLoc(HF)andRepLoc(FR)
performtheworst,RepLoc(FR+QA)outperformsRepLoc(FR)con-
sidering the A@10value, and RepLoc performs the best.
Associated with Table 4, we also conduct statistical tests, to
draw confident conclusions whether one algorithm outperforms
the other. For the statistical test, we employ the Wilcoxon’s signed
rank test, with a null hypothesis stating that there exists no dif-
ferencebetweentheresultsofthealgorithmsincomparison.We
consider the 95% confidence level (i.e., p-values below 0.05 are con-
sidered statisticallysignificant), andadopt the P@10andR@10as
theperformancemetrics.Wedonotconsidertheaccuracyrateand
theMAPmetrics,inthattheseareaggregatemetrics.Overallthe
instances, when comparing RepLoc with any of the other three
baseline variants, the null hypothesis is rejected ( p-value<0.05
for bothP@10andR@10), which implies that RepLoc outperforms
their baseline variants in a statistically significant way.
TogainmoreinsightsintothebehaviorofRepLoc,wepresent
theperformanceofthefourvariantsagainstthenumberofretrieved
results in Figure 9, over typical datasets. In the figure, the x-axis
andthey-axisindicatethenumberofretrievedfiles,andtheper-
formance metrics. From the sub-figures, we confirm that over both
77
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhilei Ren, He Jiang, Jifeng Xuan, and Zijiang Yang
Table 4: Comparison results between RepLoc and its variants
Dataset Model A@1 A@5 A@10 P@1 P@5 P@10 R@1 R@5 R@10 MAP
TimestampsRepLoc(HF) 0.4048 0.6775 0.7229 0.4048 0.1511 0.0835 0.3587 0.6222 0.6682 0.3522
RepLoc(FR) 0.3160 0.5736 0.7121 0.3160 0.1268 0.0807 0.2821 0.5253 0.6553 0.2777
RepLoc(FR+QA) 0.4762 0.6753 0.7641 0.4762 0.1511 0.0883 0.4155 0.6177 0.7102 0.4009
RepLoc 0.5238 0.7792 0.8290 0.5238 0.1792 0.0991 0.4538 0.7295 0.7839 0.4400
File-orderingRepLoc(HF) 0.3136 0.4407 0.4576 0.3136 0.0983 0.0534 0.2653 0.3968 0.4197 0.2528
RepLoc(FR) 0.1525 0.5169 0.6949 0.1525 0.1085 0.0729 0.1215 0.4427 0.6150 0.1136
RepLoc(FR+QA) 0.3814 0.6780 0.7627 0.3814 0.1492 0.0864 0.3040 0.5978 0.6856 0.2804
RepLoc 0.4492 0.7288 0.7966 0.4492 0.1661 0.0966 0.3774 0.6506 0.7331 0.3572
RandomnessRepLoc(HF) 0.1000 0.2200 0.2600 0.1000 0.0480 0.0280 0.0850 0.2100 0.2500 0.0813
RepLoc(FR) 0.1000 0.3000 0.4800 0.1000 0.0640 0.0500 0.1000 0.3000 0.4650 0.1000
RepLoc(FR+QA) 0.2200 0.3200 0.4200 0.2200 0.0680 0.0460 0.2100 0.3050 0.4100 0.2050
RepLoc 0.2000 0.4200 0.5000 0.2000 0.0880 0.0540 0.1900 0.4050 0.4900 0.1854
LocaleRepLoc(HF) 0.0976 0.3171 0.3659 0.0976 0.0634 0.0366 0.0976 0.3049 0.3415 0.0976
RepLoc(FR) 0.1463 0.2439 0.4634 0.1463 0.0488 0.0463 0.1463 0.2317 0.4512 0.1494
RepLoc(FR+QA) 0.2439 0.4146 0.5610 0.2439 0.0829 0.0561 0.2317 0.4024 0.5488 0.2256
RepLoc 0.2683 0.5122 0.7317 0.2683 0.1024 0.0732 0.2561 0.5000 0.7195 0.2500
OverallRepLoc(HF) 0.3472 0.5797 0.6200 0.3472 0.1288 0.0712 0.3059 0.5324 0.5734 0.2990
RepLoc(FR) 0.2608 0.5231 0.6766 0.2608 0.1142 0.0750 0.2320 0.4760 0.6216 0.2278
RepLoc(FR+QA) 0.4262 0.6334 0.7258 0.4262 0.1404 0.0829 0.3694 0.5777 0.6736 0.3544
RepLoc 0.4709 0.7273 0.7928 0.4709 0.1654 0.0937 0.4087 0.6774 0.7491 0.3949
Table 5: Result of RepLoc(HF), with single heuristic rule
IDRule A@10 P@10 R@10 MAP
3 GZIP_ARG 0.2981 0.0341 0.2823 0.1864
4 DATE_CMD 0.2191 0.0253 0.1878 0.1250
14 UNSORTED_WILDCARD 0.1058 0.0112 0.0968 0.0578
13 LS_WITHOUT_LOCALE 0.0671 0.0072 0.0428 0.0247
9 SORT_IN_PIPE 0.0387 0.0039 0.0351 0.0261
Figure 9: Trends of precision and recall of RepLoc
thedatasets,RepLocoutperformstheothervariantssignificantly,
i.e., the performance curves for RepLoc lie above those for other
variants,whichimpliesthatforallthecasesoftheretrievedresults,
combiningthetwocomponentsisabletoobtainbetterresults.This
phenomenon conforms with our observations in Table 4.
AnswertoRQ2: BycomparingthevariantsofRepLocover671
realworldpackages,weconfirmthatbycombiningtheheuristicrule-based filter and the query augmentation, RepLoc is able to
outperform its variants.
Figure 10: Histogram for scale statistics
Figure 11: Histogram for efficiency evaluation
4.6 Investigation of RQ3
In this RQ, we evaluate RepLoc from the efficiency perspectives.
Sincemanuallylocalizingtheunreproducibleissuesisatimecon-
suming task, automating such process is profitable only if the pro-
posed approach is time efficient. Hence, we present the time statis-
ticsoftheexperiments.Figure10depictsthestatisticsofthesource
files as histograms, in which the x-axis indicates the number ofsource files (fileNum) and the words (wordNum), and the y-axisrepresentstheassociatedfrequency.Inthisstudy,thenumberoffiles ranges within [6, 19890], and the number of words for the
majorityofthepackagesrangesaround1 ×104,whichimpliesthat
manually inspecting the files would be difficult.
Sincethescaleofthepackagesinthisstudyvariesgreatly,itis
intuitivethatthelocalizationprocessoverdifferentpackageswill
78
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. Automated Localization for Unreproducible Builds ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
Table 6: Results of RepLoc, over manpages-tr
Rank RepLoc(FR) Rank RepLoc(FR+QA)
1/debian/rules 1/debian/patches/bashisms.patch
2/source/man8/mount.8.xml 2/debian/rules
3/source/tr/linkata.sh 3/source/manderle.sh
4/source/man1/rsync.1.xml 4/Makefile
5/source/manderle.sh 5/debian/manpages-tr.prune
Rank RepLoc(HF) Rank RepLoc
1/source/man1/gzip.1.xml 1/source/manderle.sh
2/source/manderle.sh 2/debian/patches/bashisms.patch
3 3/debian/rules
4 4/source/man1/gzip.1.xml
5 5/source/man1/patch.1.xml
varyaccordingly.Toinvestigatethisissue,wepresenttheresults
related to time efficiency considering the three variants of RepLoc.
InFigure11,weillustratethedistributionsofthedatasetscalability
and the execution time. In the sub-figures, the x-axis indicates the
time in seconds, and the y-axis represents the frequency. From the
results, we observethat, the indexing ofthe documents consumes
thelargestportionoftime,comparedwithothercomponents.In
particular, the median of the execution time for RepLoc is 5.14
seconds.
Answer to RQ3: In this RQ, we investigate the efficiency per-
spectives of RepLoc. In this study, the indexing of the document
consume the majority of the time.
4.7 Investigation of RQ4
For RQ1–RQ3, to evaluate the performance of RepLoc properly, we
employthepackagesthathavebeenfixed,andadoptthepatches
fromtheBTSasthegroundtruth.However,inthereal-worldre-producible validation scenario, the patches are not available in
advance. Hence, in this RQ, we intend to investigate RepLoc under
suchcondition.Morespecifically,weconsidertwoscenarios,i.e.,
weapplyRepLoctothepackagesover(1)Debianpackagesthatare
previouslyunfixed,and(2)theunreproduciblepackagesfromGuix.
First, we are interested in whether RepLoc could be generalized
to unfixed packages, which are obtained from the continuous inte-
grationsystemofDebian.WealsochecktheBTS,toensurethatthe
packageshavenotbeenfixed.WeapplyRepLoctolocalizetheprob-
lematicfiles,andthenmanuallycheckandfixtheunreproducible
issues. Through localization and fixing, 3 unreproducible packages
belonging to the Timestamps category are fixed, i.e., regina-rexx
(3.6-2), fonts-uralic (0.0.20040829-5),and manpages-tr (1.0.5.1-
2). We submit the corresponding patches to the BTS [ 3–5], and the
one for fonts-uralic has been accepted.
For these packages, the problematic files are ranked among the
top of the retrieved list by RepLoc. For example, in Table 6, we
present the results over the package manpages-tr . The table is or-
ganizedsimilarlyasTable.3.Fromthetable,weobservethatRepLoc
is able to localize problematic files effectively, i.e., the problematic
filesarerankedthefirstintheresult.Thepackageisunreproducible
duetotheinvocationof gzipwithout“ -n”,andtheissuecanbecap-
tured by the GZIP_ARG rule in “ /source/manderle.sh ”. However,
sincetheheuristicrulesfailtocapturethedynamicaspectofthe
build process, a file (“ /source/man1/gzip.1.xml ”) unused during
compilation is also retrieved. In contrast, with FR and QA, we con-
centrateonthefilesinvolvedbythebuildprocess.BycombiningTable 7: Results of RepLoc, over skalibs
Rank RepLoc(FR) Rank RepLoc(FR+QA)
1/package/info 1/configure
2/doc/[...]/kolbak.html 2/src/[...]/uint32_reverse.c
3/doc/[...]/unixmessage.html 3/src/[...]/badrandom_here.c
4/doc/[...]/unix-transactional.html 4/src/[...]/goodrandom_here.c
5/doc/[...]/unix-timed.html 5/src/[...]/md5_transform.c
...... ......
24/Makefile 10/Makefile
Rank RepLoc(HF) Rank RepLoc
1/tools/gen-deps.sh 1/Makefile
2/Makefile 2/configure
3/src/[...]/localtm_from_ltm64.c 3/src/[...]/uint32_reverse.c
4 4/src/[...]/badrandom_here.c
5 5/src/[...]/goodrandom_here.c
boththestatic(HF)andthedynamic(HFandQA)perspectives,the
problematicfileisrankedthefirstofthelistwithhigherprobability.
Second,weconsiderthepackagesfromtheGuixrepository,to
investigate whether the knowledge obtained from Debian could
begeneralizedtootherrepositories.ThereasonswechooseGuix
arethat,(1)therepositoryisinterestedinthereproduciblebuilds
practice[23],and(2)itspackagemanagerprovidesthefunctionality
ofvalidatingpackagereproducibilitylocally,whichfacilitatesthe
experimentaldesign.Asademonstration,welocalizeandmanually
fix the problematic files of 3 packages, namely libjpeg-turbo
(1.5.2), djvulibre (3.5.27), and skalibs (2.3.10.0). Similar with the
previous case, the patches were submitted to Guix’s BTS [ 8–10].
Taking skalibsasanexample,wepresenttheresultsofthevariants
of RepLoc in Table 7. From the table, we could observe that the
problematicfile“ /Makefile ”isassignedthetoprank.Contrarily,
withoutRepLoc,over900sourcefileshavetobemanuallytraversed.
Such observation to some extent demonstrates the usefulness ofRepLoc in leveraging the knowledge from Debian to a different
repositorysuchasGuix.Afterlocalizingtheproblematicfileand
manuallyfixing,thesubmittedpatchhasbeenacceptedandpushedintothecodebaseofGuix[
10].Similarly,thepatchesfor djvulibre
[8] and libjpeg-turbo [9] have also been accepted.
Answer to RQ4: WedemonstratethatRepLocishelpfulinlo-
calizing unfixed unreproducible packages from both Debian and
Guix. In particular, unreproducible issues of 6 packages from both
repositories are fixed under the guidance of RepLoc, which have
not been fixed before this study.
5 THREATS TO VALIDITY
There are several objections a critical reader might raise to the
evaluation presented in this study, among which the following two
threats deserve special attention.
First,inthisstudy,theheuristicrulesinHFaresummarizedfrom
Debian’sdocumentation.Also,weleveragethebuildloggatheredfrom the build process. Hence, some may argue that the approach
cannotbegeneralizedtoothersoftwarerepositoriesbecauseitrelies
too much on Debian’s infrastructure. To mitigate this threat, in
RepLoc,attentionispaidsothatthecomponentsarenotspecialized
forDebian.Forexample,despiteknowingthattheDebian rules
filestakethelargestportionoftheproblematicfiles(seeFigure7(b)),
no extra priority is given to these files during ranking. Also, in HF,
weavoidusingheuristicrulesspecifictoDebian,andintendtomake
79
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden Zhilei Ren, He Jiang, Jifeng Xuan, and Zijiang Yang
the rules as general as possible. For instance, UNSORTED_WILDCARD
is applicable for Makefile based build systems, and GZIP_ARG is
helpful if gzip-based compression is involved. As a result, the
results of this study can be generalized to other repositories. As
demonstratedinRQ4,wehavesuccessfullyappliedRepLoctoGuix.
For other repositories, applying RepLoc should only require minor
adaptation.Forexample,fortheFedoraproject,thebuildlogcan
begatheredbyparsingtheverboseoutputofthe mockbuildtool,
and the diff log could be generated by diffoscope as well.
Second,whenconstructingthedatasets,theunreproduciblepack-
ages causedby thetool-chain issues arenot considered.For these
packages,theunreproducibleissuesareintroducedbythedepended
packages rather than the current package. Hence, identification of
the tool-chain issues is another challenging task that requires fur-
thermanualinvestigation[ 7].Besides,weshouldnotethatfixing
thetool-chainissuesmayhelpmakemorepackagesreproducible.
For example, when reproducible-related patches were accepted by
gccfromupstream,around200unreproduciblepackagesthatde-
pendedon gccbecamereproducibleautomatically[ 18].Weplanto
explore the tool-chain issues in the future.
6 RELATED WORK
6.1 Bug Localization Related Work
First,thisstudyiscloselyrelatedtothefaultlocalizationstudies,
especially the IR-based approaches.
For example, Zhou et al. [ 49] proposed a specialized VSM based
approach,andconsiderthesimilaritiesbetweenbugreportstolocal-
izebuggyfiles.Wangetal.[ 44]proposeacompositionalmodelthat
integrates multiplevariants of VSM.In particular, they modelthe
compositionofdifferentVSMvariantsasaoptimizationproblem,
andapplyageneticalgorithmtosearchforthesuitablecomposi-
tionpatternbetweenVSMvariants.Wangetal.[ 42]investigatethe
usefulnessofIR-basedfaultlocalizationtechniques,anddiscover
thatthequalityofthebugreportsarecrucialtotheperformance
of localization tasks.
Meanwhile, domain knowledge is utilized to improve the perfor-
mance of IR-based bug localization techniques. Ye et al. [ 48] find
bug-fixingfrequencyandbug-fixingrecencyofsourcecodefilesarehelpfulforbuglocalization.Sahaetal.[
38]findthestructureofbug
reportsandsourcecodefilesarealsogoodknowledgeforbuglocal-
ization.Theyconsiderbugreportsorsourcecodefilesasdocuments
with structured fields, e.g., summary and description, or file name,
classname,andmethodname,respectively.Stack-traceinformation
in bug report is also analyzed [ 33,46] to improve the performance
ofbuglocalization.Besides,versionhistories[ 39,40,43]andsimilar
bug reports [24] are proved to be useful.
Besides, with the development of IR techniques, other text min-
ing methodologies are also incorporated to support locating buggy
files. For example, due to its effectiveness, Latent Dirichlet Allo-
cation(LDA)hasgaineditspopularityinthefieldofbuglocaliza-
tion. Lukins et al. [ 31] propose a static LDA-based technique for
automaticbuglocalization.Lametal.[ 29]proposealocalization
frameworkHyLocthatcombinesdeeplearningandIR-basedmodel.
They integrate deep neural network and a VSM variant, to comple-
mentthetwostandalonecomponents.Experimentalresultsoverreal world projects demonstrate that their proposed model outper-
formstheindividualmodels.Raoetal.[ 35]proposeanincremental
framework to update the model parameters of the Latent Semantic
Analysis,whichisthenappliedtolocalizebuggyfiles.Experiments
over software libraries with ten years of version history validate
their framework.
However, despite the closeness to these studies, we should note
that the problem in this study has its unique features. For example,
thecounterpartofthebugreportsinIR-basedfaultlocalization,i.e.,
the diff logs, are not sufficiently informative to guide the retrieval.
6.2 Reproducible Build Related Work
To the best of our knowledge, there have not been studies on local-
izingfilesthatcauseunreproduciblebuilds.However,therehave
been studies that address the importance of reproducible builds.
Forexample, Wheeler[ 45]describesa practicaltechniquenamed
diverse double compiling. By compiling the source files twice with
different compilers, and verifying the compiled binaries, certain
typesofmaliciousattackscanbedetectedandprevented.According
toDebian’sdocumentation,thisworkpartiallymotivatestherepro-duciblebuildspractice[
15].Holleretal.[ 26]investigatethediverse
compilation under embedded system, and experimentally quantify
theefficiencyofdiversecompilingforsoftwarefaulttolerance.Car-
navaletandMannan[ 25]conductanempiricalstudy,focusingon
the reproduciblebuilds in thecontext of security-criticalsoftware.
Basedontheexperimentsontheencryptiontool TrueCrypt,they
summarize the challenges of reproducibility in practice. Ruiz et al.
[36]addressthereproducibilityincloudcomputing.Theyadoptthe
term reconstructable software, and propose a prototype to simplify
the creation of reliable distributed software.
Inthisstudy,wefocusonthelocalizationtaskforunreproducible
builds, which has not been addressed in the existing studies.
7 CONCLUSIONS
Inthisstudy,weinvestigatethelocalizationtaskforunreproducible
builds. We present components that consider heuristic knowledge,
similarity based information, as well as their integration as Re-
pLoc.Forempiricalvalidation,wecreatefourcategoriesofpublicly
availabledatasetswith671unreproduciblepackagesfromDebian.
ExtensiveexperimentsrevealthatRepLocisabletoeffectivelylo-
calize the files that lead to unreproducible builds. Furthermore,
with the help of RepLoc, we successfully identified and fixed 6 new
unreproducible packages from Debian and Guix.
Forthefuturework,weareinterestedinthelocalizationofprob-
lematic files for the tool-chain related issues. Also, inspired by the
record-and-playtechniques[ 34]fromthecrashreproductionbased
debugging research [ 27,47], it would be interesting to leverage
these techniques to detect more accurate correspondence between
the build commands executed and the built binaries.
ACKNOWLEDGEMENTS
This work is supported in part by the National Natural Science
FoundationofChinaunderGrants61772107,61722202,61502345,
and 61403057,and inpart by theFundamental ResearchFunds for
the Central Universities under Grant DUT16RC(4)62.
80
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. Automated Localization for Unreproducible Builds ICSE ’18, May 27-June 3, 2018, Gothenburg, Sweden
REFERENCES
[1]2015. ProtectingourcustomersfromXcodeGhost. https://www.fireeye.com/blog/
executive-perspective/2015/09/protecting_our_custo.html. (September 2015).
[2]2017. Debian bug report logs – #773916: libical. https://bugs.debian.org/cgi-bin/
bugreport.cgi?bug=773916. (August 2017).
[3]2017. Debianbugreportlogs–#854293:manpages-tr. https://bugs.debian.org/
cgi-bin/bugreport.cgi?bug=854293. (August 2017).
[4]2017. Debian bug report logs – #854294: regina-rexx. https://bugs.debian.org/
cgi-bin/bugreport.cgi?bug=854294. (August 2017).
[5]2017. Debian bug report logs – #854362: fonts-uralic. https://bugs.debian.org/
cgi-bin/bugreport.cgi?bug=854362. (August 2017).
[6]2017. Debian packaging/source package. https://wiki.debian.org/Packaging/
SourcePackage. (February 2017).
[7]2017. Fixing a toolchain package. https://reproducible-builds.org/contribute/.
(January 2017).
[8]2017. GNU bug report logs – #28015: djvulibre. https://debbugs.gnu.org/cgi/
bugreport.cgi?bug=28015. (August 2017).
[9]2017. GNU bug report logs – #28016: libjpeg-turbo. https://debbugs.gnu.org/cgi/
bugreport.cgi?bug=28016. (August 2017).
[10]2017. GNU bug report logs – #28017: skalibs. https://debbugs.gnu.org/cgi/
bugreport.cgi?bug=28017. (August 2017).
[11]2017. TheGuixSystemDistribution. https://www.gnu.org/software/guix/.(Au-
gust 2017).
[12]2017. Known issues related to reproducible builds. https://tests.
reproducible-builds.org/index_issues.html. (July 2017).
[13]2017. NotesonbuildreproducibilityofDebianpackages. https://anonscm.debian.
org/git/reproducible/notes.git. (August 2017).
[14]2017. Overview of reproducible builds for packages in unstable for
amd64. https://tests.reproducible-builds.org/debian/unstable/index_suite_
amd64_stats.html. (August 2017).
[15] 2017. Reproducible builds. https://reproducible-builds.org/. (August 2017).[16]
2017. Reproduciblebuildsbugsfiled. https://tests.reproducible-builds.org/debian/
index_bugs.html. (August 2017).
[17]2017. Reproducible Builds Experimental Toolchain. https://wiki.debian.org/
ReproducibleBuilds/ExperimentalToolchain. (February 2017).
[18]2017. Reproducible builds: week 54 in Stretch cycle. https://reproducible.alioth.
debian.org/blog/posts/54/. (October 2017).
[19]2017. Reproducible builds: who’s involved. https://reproducible-builds.org/who/.
(August 2017).
[20]2017. TimestampsInPEBinaries. https://wiki.debian.org/ReproducibleBuilds/
TimestampsInPEBinaries. (August 2017).
[21]2017. Validating Your Version of Xcode. https://electricnews.fr/
validating-your-version-of-xcode/. (August 2017).
[22]2017. Variations introduced when testing Debian packages. https://tests.
reproducible-builds.org/debian/index_variations.html. (August 2017).
[23]Ludovic Courtès. 2015. Reproducible builds: a means to an end. https://www.
gnu.org/software/guix/news/reproducible-builds-a-means-to-an-end.html.(No-
vember 2015).
[24]Steven Davies, Marc Roper, and Murray Wood. 2012. Using bug report similarity
toenhancebuglocalisation.In ReverseEngineering(WCRE),201219thWorking
Conference on . IEEE, 125–134.
[25]XavierdeCarnédeCarnavaletandMohammadMannan.2014. Challengesand
ImplicationsofVerifiableBuildsforSecurity-criticalOpen-sourceSoftware.In
Proceedingsofthe30thAnnualComputerSecurityApplicationsConference(ACSAC
’14).ACM,NewYork,NY,USA,16–25. DOI:http://dx.doi.org/10.1145/2664243.
2664288
[26]Andrea Höller, Nermin Kajtazovic, Tobias Rauter, Kay Römer, and ChristianKreiner. 2015. Evaluation of diverse compiling for software-fault detection.InProceedings of the 2015 Design, Automation & Test in Europe Conference &
Exhibition . EDA Consortium, 531–536.
[27]Nima Honarmand and Josep Torrellas. 2014. Replay Debugging: Leveraging
RecordandReplayforProgramDebugging.In Proceedingofthe41stAnnualInter-
nationalSymposiumonComputerArchitecuture(ISCA’14) .IEEEPress,Piscataway,
NJ, USA, 445–456. http://dl.acm.org/citation.cfm?id=2665671.2665737
[28]Pavneet SinghKochhar, Yuan Tian,and DavidLo. 2014. Potential biases inbug
localization: Do they matter?. In Proceedings of the 29th ACM/IEEE international
conference on Automated software engineering . ACM, 803–814.
[29]An Ngoc Lam, Anh Tuan Nguyen, Hoan Anh Nguyen, and Tien N Nguyen. 2015.CombiningDeepLearningwithInformationRetrievaltoLocalizeBuggyFilesfor
Bug Reports (N). In Automated Software Engineering (ASE), 2015 30th IEEE/ACM
International Conference on . IEEE, 476–481.
[30]HangLi.2014. Learningtorankforinformationretrievalandnaturallanguage
processing. SynthesisLecturesonHumanLanguageTechnologies 7,3(2014),1–121.
[31]StacyKLukins,NicholasAKraft,andLethaHEtzkorn.2010. Buglocalization
usinglatentDirichletallocation. InformationandSoftwareTechnology 52,9(2010),
972–990.[32]ChristopherDManning,PrabhakarRaghavan,HinrichSchütze,andothers.2008.
Introduction to information retrieval . Vol. 1. Cambridge university press Cam-
bridge.
[33]Kevin Moran, Mario Linares Vásquez, Carlos Bernal-Cárdenas, Christopher Ven-
dome, and Denys Poshyvanyk. 2016. Automatically Discovering, Reporting and
Reproducing Android Application Crashes. In 2016 IEEE International Conference
on Software Testing, Verification and Validation, ICST 2016, Chicago, IL, USA, April
11-15, 2016 . 33–44.
[34]Robert O’Callahan, Chris Jones, Nathan Froyd, Kyle Huey, Albert Noll, andNimrod Partush. 2017. Engineering Record and Replay for Deployability. In
Proceedingsofthe2017USENIXConferenceonUsenixAnnualTechnicalConference
(USENIX ATC ’17) . USENIX Association, Berkeley, CA, USA, 377–389. http:
//dl.acm.org/citation.cfm?id=3154690.3154727
[35]Shivani Rao, Henry Medeiros, and Avinash Kak. 2015. Comparing Incremen-talLatentSemanticAnalysisAlgorithmsforEfficientRetrievalfromSoftware
LibrariesforBugLocalization. ACMSIGSOFTSoftwareEngineeringNotes 40,1
(2015), 1–8.
[36]CristianRuiz,SalemHarrache,MichaelMercier,andOlivierRichard.2015. Re-
constructable Software Appliances with Kameleon. SIGOPS Oper. Syst. Rev. 49, 1
(Jan. 2015), 80–89. DOI:http://dx.doi.org/10.1145/2723872.2723883
[37]DavideDi Ruscioand PatrizioPelliccione.2014. Simulatingupgrades ofcomplex
systems: The case of Free and Open Source Software. Information and Software
Technology 56, 4 (2014), 438 – 462. DOI:http://dx.doi.org/https://doi.org/10.1016/
j.infsof.2014.01.006
[38]Ripon K Saha, Matthew Lease, Sarfraz Khurshid, and Dewayne E Perry. 2013.
Improving bug localization using structured information retrieval. In Automated
SoftwareEngineering(ASE),2013IEEE/ACM28thInternationalConferenceon .IEEE,
345–355.
[39]Bunyamin Sisman and Avinash C Kak. 2012. Incorporating version historiesin information retrieval based bug localization. In Proceedings of the 9th IEEE
Working Conference on Mining Software Repositories . IEEE Press, 50–59.
[40]ChakkritTantithamthavorn,AkinoriIhara,andKen-ichiMatsumoto.2013. Us-
ing co-change histories to improve bug localization performance. In Software
Engineering,ArtificialIntelligence,NetworkingandParallel/DistributedComputing
(SNPD), 2013 14th ACIS International Conference on . IEEE, 543–548.
[41]Ken Thompson. 1984. Reflections on trusting trust. Commun. ACM 27, 8 (1984),
761–763.
[42]QianqianWang,ChrisParnin,andAlessandroOrso.2015. EvaluatingtheUse-
fulness of IR-based Fault Localization Techniques. In Proceedings of the 2015
International Symposium on Software Testing and Analysis (ISSTA 2015) . ACM,
New York, NY, USA, 1–11. DOI:http://dx.doi.org/10.1145/2771783.2771797
[43]ShaoweiWangandDavidLo.2014. Versionhistory,similarreport,andstructure:
Putting them together for improved bug localization. In Proceedings of the 22nd
International Conference on Program Comprehension . ACM, 53–63.
[44]Shaowei Wang, David Lo, and Julia Lawall. 2014. Compositional vector space
modelsforimprovedbuglocalization.In 2014IEEEInternationalConferenceon
Software Maintenance and Evolution (ICSME) . IEEE, 171–180.
[45]David A Wheeler. 2005. Countering trusting trust through diverse double-
compiling. In Computer Security Applications Conference, 21st Annual . IEEE, 13–
pp.
[46]Chu-Pan Wong, Yingfei Xiong, HongyuZhang, Dan Hao, Lu Zhang,and Hong
Mei. 2014. Boosting bug-report-oriented fault localization with segmentation
and stack-trace analysis. In 2014 IEEE International Conference on Software Main-
tenance and Evolution (ICSME) . IEEE, 181–190.
[47]JifengXuan,XiaoyuanXie,andMartinMonperrus.2015. Crashreproductionviatestcasemutation:letexistingtestcaseshelp.In Proceedingsofthe201510thJoint
MeetingonFoundationsofSoftwareEngineering,ESEC/FSE2015,Bergamo,Italy,
August30-September4,2015 .910–913. DOI:http://dx.doi.org/10.1145/2786805.
2803206
[48]XinYe,RazvanBunescu,andChangLiu.2014. Learningtorankrelevantfilesfor
bugreportsusingdomainknowledge.In Proceedingsofthe22ndACMSIGSOFT
InternationalSymposiumonFoundationsofSoftwareEngineering .ACM,689–699.
[49]Jian Zhou, Hongyu Zhang, and David Lo. 2012. Where should the bugs be fixed?
more accurate information retrieval-based bug localization based on bug reports.
InSoftwareEngineering(ICSE),201234thInternationalConferenceon .IEEE,14–24.
81
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:49:35 UTC from IEEE Xplore.  Restrictions apply. 