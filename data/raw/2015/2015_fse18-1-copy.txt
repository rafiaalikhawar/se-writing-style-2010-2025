Verifying the Long-Run Behavior of Probabilistic System Models
in the Presence of Uncertainty
Yamilet R. Serrano Llerena
National University of Singapore
Singapore
Universidad de Ingenieria y
Tecnologia
Lima, Peru
yserrano@utec.edu.peMarcel B√∂hme
Monash University
Melbourne, Australia
marcel.boehme@acm.orgMarc Br√ºnink‚àó
Zurich, Switzerland
marc@u.nus.edu
Guoxin Su
University of Wollongong
Wollongong, Australia
guoxin@uow.edu.auDavid S. Rosenblum
National University of Singapore
Singapore
david@comp.nus.edu.sg
ABSTRACT
Verifying that a stochastic system is in a certain state when it has
reached equilibrium has important applications. For instance, the
probabilistic veri/f_ication of the long-run behavior of a safety-critical
system enables assessors to check whether it accepts a human abort -
command at any time with a probability that is suÔ¨Éciently high.
The stochastic system is represented as probabilistic model, a long-
run property is asserted and a probabilistic veri/f_ier checks the model
against the property.
However, existing probabilistic veri/f_iers do not account for the
imprecision of the probabilistic parameters in the model. Due to
uncertainty, the probability of any state transition may be subject to
small perturbations which can have direct consequences for the ve-
racity of the veri/f_ication result. In reality, the safety-critical system
may accept the abort -command with an insuÔ¨Écient probability.
In this paper, we introduce the /f_irst probabilistic veri/f_ication
technique that accounts for uncertainty on the veri/f_ication of long-
run properties of a stochastic system. We present a mathematical
framework for the asymptotic analysis of the stationary distribution
of a discrete-time Markov chain, making noassumptions about the
distribution of the perturbations. Concretely, our novel technique
computes upper and lower bounds on the long-run probability,
given a certain degree of uncertainty about the stochastic system.
CCS CONCEPTS
‚Ä¢Mathematics of computing !Markov networks; ‚Ä¢Software
and its engineering !Model checking; Software veri/f_ication;
‚àóMarc Br√ºnink is now at Google.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for pro/f_it or commercial advantage and that copies bear this notice and the full citation
on the /f_irst page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior speci/f_ic permission and/or a
fee. Request permissions from permissions@acm.org.
ESEC/FSE ‚Äô18, Lake Buena Vista, FL, USA
¬©2018 ACM. 978-1-4503-5573-5/18/11. . . $15.00
DOI: 10.1145/3236024.3236078KEYWORDS
Uncertainty, Probabilistic Model Checking, Long-Run Properties,
Perturbation Analysis, Discrete-Time Markov Chains
ACM Reference format:
Yamilet R. Serrano Llerena, Marcel B√∂hme, Marc Br√ºnink, Guoxin Su,
and David S. Rosenblum. 2018. Verifying the Long-Run Behavior of Prob-
abilistic System Models in the Presence of Uncertainty. In Proceedings of
Proceedings of the 26th ACM Joint European Software Engineering Conference
and Symposium on the Foundations of Software Engineering, Lake Buena
Vista, FL, USA, November 4‚Äì9, 2018 (ESEC/FSE ‚Äô18), 11 pages.
DOI: 10.1145/3236024.3236078
1 INTRODUCTION
Probabilistic veri/f_ication is a powerful and mature technology
which aims to verify systems that exhibit stochastic rather than
deterministic behavior. The stochastic system is represented by a
stochastic model, such as a discrete-time Markov chain (DTMC).
A probabilistic model checker veri/f_ies this model against a given
system property, such as the minimum (or maximum) long-run
probability or reachability of a certain state. For instance, the life-
cycle of software developed in a large company can be modeled as
a DTMC where a state represents the current development stage
of a software, and the transition probabilities can be determined
empirically from the lifecycle of software developed in the past. A
probabilistic model checker, such as PRISM [ 14], can then check
whether the long-run probability that a software is in the (error-
free) deployment stage exceeds some threshold.
However, probabilistic veri/f_ication does not account for the im-
precision of the probabilistic parameters in the model of the stochas-
tic system. Often, the speci/f_ied transition probabilities are accurate
only to some degree. For instance, the transition probabilities in the
DTMC model of the company‚Äôs development lifecycle are computed
as the sample mean over past instances. However, a sample mean
is subject to variance and approximates the population mean only
with some accuracy. The company may hire new developers, de-
velop diÔ¨Äerent software, or improve the development process. All
of these contribute to our uncertainty about the speci/f_ic probability
to transition from one development stage to another./Q_uantifying the Impact of Uncertainty on the Long-Run Probability Y. Serrano, M. B√∂hme, M. Br√ºnink, G. Su, and D.S. Rosenblum
Previous work has successfully applied perturbation theory to
many aspects of probabilistic model checking, including diÔ¨Äerent
stochastic formalisms, diÔ¨Äerent kinds of properties to be veri/f_ied
and diÔ¨Äerent measures of perturbation distance, as well as appli-
cations of the ideas to self-adaptive software, QoS monitoring and
cloud computing [16, 19‚Äì22].
This paper presents results on dealing with uncertainty when
verifying long-run properties of DTMCs, where we seek to deter-
mine the probability that a system‚Äîwhose stochastic behavior is
subject to perturbation‚Äîwill be in a particular state of interest once
the system has reached a steady state, or equilibrium. We propose
to model a stochastic system that is subject to uncertainty as a pa-
rameterized DTMC where the speci/f_ic probability in each transition
is subject to random perturbations. We introduce a probabilistic
veri/f_ication technique that provides an upper and lower bound on
the long-run probability for each state in the parameterized DTMC.
The bounds characterize the worst-case consequences of uncer-
tainty on the (long-run) probability that the system is in a certain
state at any time after it has reached equilibrium.
The veri/f_ication of long-run probabilities is a very useful and ver-
satile application of probabilistic model checking and can be applied
to problems in software engineering as well as other domains. As
previously mentioned, it allows us to check whether the probability
that a safety-critical system accepts an external abort -command at
an arbitrary point in time is suÔ¨Éciently high. As another example,
the presented technique can also be used to check which functions
are most critical for a system because they are executed most often,
or which web-pages on a server are important because they are
visited with higher likelihood.
We introduce the pertinent concepts and evaluate our novel prob-
abilistic veri/f_ication technique using three case studies. In the /f_irst
case study, we discuss the probabilistic veri/f_ication of a long-run
property in the development lifecycle of a large mobile app develop-
ment company. In the second case study, we investigate the impact
of estimating the transition probabilities in the DTMC from empiri-
cal data (i.e., using maximum-likelihood estimation). Of course, a
sample is subject to some variance resulting in small perturbations
for the transition probabilities. The DTMC models web-pages on a
server, and the veri/f_ication task is to check the importance of those
web-pages given a sample of click-stream data. In the third case
study, we investigate the impact of changes to the program or its
workload on determining the functions that are most critical for
the program. The DTMC models the sequence of function calls in
the program, and the veri/f_ication task is to check the probability
that a function is exercised at any time after equilibrium, given that
the program or workload may slightly change.
The main contributions of this work are as follows:
(1)We introduce the /f_irst probabilistic veri/f_ication technique that
accounts for uncertainty in the veri/f_ication of long-run prop-
erties of a stochastic system. Our technique uses perturba-
tion analysis to provide upper and lower bounds on the sys-
tem‚Äôs long-run properties which represent the worst-case con-
sequences of uncertainty.
(2)We present a mathematical framework for the asymptotic anal-
ysis of the stationary distribution of a (reducible or irreducible)
DTMC when the transition probabilities are subject to a randomperturbation. We make noassumptions about the distribution
of the perturbations, re/f_lecting the reality that the degree of
uncertainty for speci/f_ic state transitions is often unknown.
(3)We present a prototype implementation of our work in Python.
We evaluate our technique on three case studies. Our experi-
ments indicate that our technique is able to provide an accurate
estimation of the worst-case consequences of uncertainty on
veri/f_ication of long-run properties in DTMCs.
The remainder of the paper is organized as follows. Section 2
introduces a running example about lifecycles of software devel-
opment. An introduction to basic concepts of probabilistic model
checking of DTMCs is presented in Section 3. Section 4 explains our
technical approach to analyze the worst-case consequences of the
uncertainty on probabilistic veri/f_ication of long-run properties in
DTMCs. Section 5 presents our experimental evaluation and results.
Section 6 discusses related work. Finally, Section 7 summarizes our
contributions and discusses future work.
2 MOTIVATION
2.1 Motivating Example: A Markov Model For
The Software Development Lifecycle of
Mobile Apps
Throughout the paper, we exemplify the pertinent concepts and
approaches based on the software development lifecycle of a large
mobile app development company. For this company, each mobile
app goes through the following stages:
Early Stage (s0). The app is created and actively developed.
Once the app is feature-complete, it goes to incubation (s1). How-
ever, at this stage an app‚Äôs development can also be abandoned
(s3), e.g., for budget reasons.
Incubation (s1). The app implements all the intended function-
ality but requires some improvements and /f_ixes. If it turns out
that more features or substantial improvements are required, the
app goes back to the early stage (s0). If the project is discontin-
ued, the app is retired (s4). However, if the app reaches a certain
maturity is goes to deployment (s2). Once it is deployed, it cannot
go back to incubation (s1).
Deployment (s2). The (updated) app is uploaded to the app store
and customers start to download and use the app. Deployment
is part of the main development lifecycle. If a user reports a bug,
the app is marked as buggy (s6).
Abandoned (s3). The app development is discontinued at the
early stage. Once the development of an app is marked as aban-
doned, it remains abandoned.
Retired (s4). The app development is discontinued at the incu-
bation stage. Once an app is retired, it remains retired.
Repair (s5). A developer creates a patch for the buggy app and
submits it for peer review. If the patch is accepted, the app goes
back to deployment (s2), i.e., the /f_ixed version is uploaded to the
app store. If the patch is rejected, the app is again marked as
buggy (s6).
Buggy (s6). The app contains a bug that was reported and needs
to be /f_ixed. The app is send for repair (s5)./Q_uantifying the Impact of Uncertainty on the Long-Run Probability ESEC/FSE ‚Äô18, November 4‚Äì9, 2018, Lake Buena Vista, FL, USA
s0 start s1 s2
s3 s4 s5s60:5
0:50:5x10:25x2
0:25x31:0
1:0 1:0
0:5x4
0:5x5
1:0Early
StageIncubation Deployment
Abandoned Retired RepairBuggy
Figure 1: Motivating Example. DTMC Model of the Develop-
ment Lifecycle of a Mobile App.
To understand and improve the development lifecycle of their mo-
bile apps, the company records the various stages that each app
undergoes. For instance, it can empirically determine the propor-
tion of apps in the early stage (s0) that reach incubation (s1) or that
areabandoned (s3). Thus, the development lifecycle can be modeled
as a discrete-time Markov chain with each development phase as
astate, each progression from phase to phase as transition , and
the proportion of apps progressing from one phase to another as
transition probabilities . The DTMC model for the company‚Äôs de-
velopment lifecycle is shown in Figure 1. For now, we ignore the
dashed rectangles and we consider the values of xiin the transition
probabilities to be /f_ixed at x1=: : :=x5=0.
2.2 Problem Statement
In this work, we investigate the worst-case consequences of uncer-
tainty on the veri/f_ication of long-run properties in a discrete-time
Markov chain. In the development lifecycle of an app, the company
would like to understand the probability that an app, in the long-
run, will be in deployment (s2), i.e., graduated from incubation and
not buggy. In the second column of Table 1, we can see that this
probability œÄs2=0:033. It is about 25 times more likely that an
app is abandoned or retired before it reaches the deployment phase
(œÄs3+œÄs4=0:834).
However, there are several sources of uncertainty in the mod-
eling. For instance, the recorded lifecycles are only samples that
are taken from a larger population; future development lifecycles
may not be well-represented by the recorded ones. The company
may have changed the development process since beginning of
the recordings; current lifecycles may not be well-represented by
earlier ones. Hence, the empirically determined transition proba-
bilities are accurate only to some degree. What does that mean for
computing the probability œÄs2that an app, in the long run, will be
in the deployment stage ( s2)?
We model the uncertainty in the transition probabilities as small
perturbations in a parameterized Markov chain, where the (sym-
bolic) perturbation vector ¬Æxis added to the transition probabilities.
Figure 1 depicts the Markov chain for our motivating example
parameterized with the perturbation vector ¬Æx=hx1;x2;x3;x4;x5i.
We do notassume any knowledge about the (distribution of)
values for¬Æx. This re/f_lects the reality that we cannot know the
degree of uncertainty for speci/f_ic state transitions. However, we
assume that the total perturbation distance Œ¥=√ç
xi2¬Æxjxijfor allTable 1: Worst-Case Consequences of Uncertainty in the De-
velopment Lifecycle of Mobile Apps where Œ¥0:001.
StagesœÄsiŒ∫siLinear Bounds
(Œ¥= 0) œÄsi Œ∫siŒ¥œÄsi+Œ∫siŒ¥
s0 0:000 0 :000 0.0000 0.0000
s1 0:000 0 :000 0.0000 0.0000
s2 0:033 0 :067 0.0329 0.0331
s3 0:667 0 :222 0.6667 0.6672
s4 0:167 0 :333 0.1667 0.1673
s5 0:067 0 :133 0.0668 0.0671
s6 0:067 0 :133 0.0668 0.0671
parameterized state transitions can be provided (as an upper bound
on the total uncertainty in the stochastic process).
Due to uncertainty, the veri/f_ication of long-run properties in a
Markov chain is (1) correct only within certain accuracy bounds,
and (2) sensitive to uncertainty in certain states more than in others.
Our approach quanti/f_ies the accuracy of the computed probability
that an app, in the long run, will be in the deployment stage ( s2) in
the form of asymptotic bounds, called linear perturbation bounds .
Our approach also quanti/f_ies the sensitivity of the computed prob-
ability to uncertainty in each transition in the form of condition
numbers .
For our motivating example, the company is interested in the
worst-case consequences of uncertainty in the modeling of the
development lifecycle if the total uncertainty was at least Œ¥=0:001,
i.e,jx1j+jx2j+jx3j+jx4j+jx5j0:001. For this purpose, in the third
column of Table 1, we compute a condition number Œ∫sithat captures
the eÔ¨Äect of perturbation vector ¬Æxin the computation of œÄsisuch
that 0i6. As can be seen from Table 1, the greatest condition
number in the model of the development lifecycle of a mobile app
corresponds to the probability that an app, in the long run, will
beretired (s4). In other words, the long run probability of being
ins4is the most sensitive to the perturbation vector ¬Æx. Based on
the condition number Œ∫siandŒ¥=0:001, the last column of Table 1
provides an estimate of the worst-case consequences of uncertainty
in the modeling of the development lifecycle calculated as Œ∫siŒ¥
and named as linear perturbation bounds . For instance, the linear
perturbation bounds that estimate the worst-case consequences of
uncertainty on veri/f_ication that an app, in the long run, will be in
deployment stage ( s2) are calculated as œÄs2Œ∫s2Œ¥=¬ª0:0329 ;0:0331¬º.
We note that the perturbation distance Œ¥is not needed to quantify
sensitivity to perturbation Œ∫si. Instead,Œ¥is used only to compute
the linear perturbation bounds (which approximate the worst-case
eÔ¨Äect of perturbation). Our method also allows to specify multi-
ple perturbation distances, each of which is associated with the
transition probabilities from the same state, such that the resulting
bounds are tighter. However, the ability to specify a single pertur-
bation distance makes our method the only one available to provide
asymptotic bounds whenever specifying the individual probability
perturbations is impossible or impractical (e.g., in the presence of
unpredictable environmental factors such as failures, disasters and
workload)./Q_uantifying the Impact of Uncertainty on the Long-Run Probability Y. Serrano, M. B√∂hme, M. Br√ºnink, G. Su, and D.S. Rosenblum
3 BACKGROUND
3.1 Discrete-Time Markov Chains
A discrete-time Markov chain (DTMC) represents the stochastic
behavior of a probabilistic system. Speci/f_ically, a DTMC is a tran-
sition system with probability distributions for the successors of
each state. Formally, a DTMC is de/f_ined as follows:
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 1. Discrete-Time Markov Chain (DTMC). A DTMC
is a tupleD=¬πS;P;Sinit;AP;L¬∫where Sis a /f_inite set of states,
P:SS!¬ª0;1¬ºis a probabilistic transition function such that
8s2S;√ç
t2SP¬πs;t¬∫=1,SinitSis a set of initial states, APis a
/f_inite set of atomic propositions, and L:S!2APa labeling function.
In addition, we de/f_ine Œπinit:S!¬ª0;1¬ºas the initial state distri-
bution, such that√ç
s2SŒπinit¬πs¬∫=1and8t<Sinit;Œπinit¬πt¬∫=0. For
instance, in Figure 1 we have S=fsij0i6g,Sinit=fs0g,AP=
fearly stage ;incubation ;deployment ;abandoned ;retired ;repair ;
buggyg, and for instance L¬πs0¬∫=early stage andP¬πs0;s1¬∫=0:5.
Furthermore, Œπinit¬πs0¬∫=1andŒπinit¬πsi¬∫=0fori>0.
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 2. Sub-DTMC. LetD=¬πS;P;Sinit;AP;L¬∫be a DTMC.
A sub-DTMC ofDis a tuple¬πS0;P0¬∫such that;,S0S, and
P0:S0!¬ª 0;1¬ºwhere for all s;s02S0;P0¬πs;s0¬∫=P¬πs;s0¬∫and√ç
s02S0P0¬πs;s0¬∫=1.
The digraph ofD, denoted as G¬πS;E¬∫, is induced as there is one
node for each state s2Sand a direct edge¬πs;t¬∫2Eif only if
P¬πs;t¬∫>0. An in/f_inite path in a DTMC Dis a sequence of the form
œÄ=s0s1s2: : :where si2SandP¬πsi;si+1¬∫>0for all i0. A /f_inite
pathœñis a pre/f_ix of an in/f_inite path œÄending in a particular state
whereœñ=s0s1: : :snsuch that n=jœñj. In this context, we say a
state snisreachable from s0if there is a /f_inite path œñ.
A set of states S0Sinduces a strongly connected subgraph
(SCS) of a DTMCDif only if for all s;t2S0there is a path from s
totvisiting only states from S0. A strongly connected component
(SCC) ofDis a maximal (w.r.t. ) SCS of S. A bottom strongly
connected component (BSCC) of Dis an SCC S0from which no
state outside S0is reachable. We denote BSCC( D) as the set of all
BSCCs of the underlying digraph of D.
A DTMCDis said irreducible if all its states belong to a single
BSCC. Irreducibility of a DTMC is important for convergence to
equilibrium as n!1 , because the convergence should be inde-
pendent of any start state. In case, a DTMC is not irreducible, we
say that is reducible . For instance, the DTMC in our motivating
example is reducible, as the states belong to three BSCCs shown as
dashed boxes in Figure 1.
Given a DTMCD, the period of state sis de/f_ined as d¬πs¬∫=
gcdfn2N+:Pn¬πs;s¬∫>0g. State sisaperiodic ifd¬πs¬∫=1and
periodic ifd¬πs¬∫>1. In this context, a DTMC Dis said to be
aperiodic if all its states are aperiodic. Correspondingly, if all states
ofDare periodic thenDisperiodic .
3.2 Parametric Discrete-Time Markov Chains
Inspired by previous studies [ 8,15,21,22], we use a parametric
model to integrate the uncertainty which is expressed as small
perturbations to transition probabilities in the DTMC.
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 3. Parametric discrete-time Markov chain (PDTMC).
LetD=¬πS;P;Sinit;AP;L¬∫be a DTMC and¬Æx=hx1; : : : ; xmibe aperturbation vector. A PDTMC is a tuple D¬ª¬Æx¬º=¬πS;P¬ª¬Æx¬º;Sinit;AP;L¬∫
where P¬ª¬Æx¬ºis a parametric transition function based on P, and S,Sinit,
APandLare de/f_ined as De/f_inition 1.
Figure 1 depicts a parameterized DTMC where ¬Æx=hx1;x2;x3;x4;x5i.
3.3 Long-Run Properties in DTMCs
In probabilistic model checking of DTMCs, long-run, also named
as steady-state, properties are used to analyze the reliability of
probabilistic systems and to obtain performance parameters such
as throughput, delay, loss probability, etc.
Formally, given a DTMC D, the long-run properties study the
limit behavior of the probability vector œÄD¬πt¬∫=¬ªœÄDs¬πt¬∫¬ºs2Swhen
time tends to in/f_inity ( limt!1œÄD¬πt¬∫) [5]. This limit when exists
is called steady-state probability vector , and it is written as œÄD=
¬ªœÄDs¬ºs2S. Intuitively, we can interpret œÄDsas the long-run mean
fraction of time the DTMC Dis in state s.
In this paper we are interested in the computation of the long-
run probability of being in a particular state shaving started in
initial states of a given DTMC D. We denote this probability as
œÄDs. For convenience, we simply mention œÄsinstead of œÄDswhen
Dis clear in the context.
To compute long-run probabilities in DTMCs, previous stud-
ies [5,18] have demonstrated that the steady-state probability vec-
tor exists if the DTMC is irreducible and aperiodic. Unfortunately,
it is not that case in all probabilistic models. Thus, to avoid with
periodic considerations, we use the long-run average probability
for computing the steady-state probability vector œÄDof a DTMC
D. Consequently, the procedure for computing the long-run prob-
ability œÄDsis based on the following conditions:
3.3.1 DTMCDis Irreducible. LetD=¬πS;P;Sinit;AP;L¬∫be an
irreducible DTMC and given a particular state s2S, we compute
the long-run probability œÄDsas follows:
œÄD
s=√ï
s02Sn
limn!11
nn√ï
k=1Pk¬πs0;s¬∫o
; (1)
where Pk¬πs0;s¬∫denotes the probability of DTMC Dbeing in state
safter exactly ktransitions when starting in state s0.
3.3.2 DTMCDis Reducible. LetD=¬πS;P;Sinit;AP;L¬∫be a
reducible DTMC and given a particular state s2S. To compute
the long-run probability œÄDs, we /f_irst identify the set of all BSCCs
of the underlying digraph of D, denoted as BSCC¬πD¬∫. Then, we
evaluate whether state sbelongs to any BSCC K2BSCC¬πD¬∫. In
the aÔ¨Érmative case, the probability œÄDsis the combination of i)
the probability of reaching the BSCC Khaving started in the initial
states of the model, denoted as PrD¬π^K¬∫, and ii) the long-run
probability of state sin a sub-DTMCD¬πK¬∫=¬πK;PK¬∫ofD, induced
by BSCC K, where PK=¬πP¬πs;t¬∫¬∫s;t2K. In short, œÄDs=PrD¬π^K¬∫
œÄD¬πK¬∫
s :Since every BSCC is irreducible, we follow Equation 1 for
computing the probability œÄD¬πK¬∫
s . Otherwise, œÄDs=0.
4 PERTURBATION APPROACH
In this section, we present our technical approach for estimating
the worst-case consequences of uncertainty on the computation of
long-run probabilities in DTMCs based on perturbation analysis./Q_uantifying the Impact of Uncertainty on the Long-Run Probability ESEC/FSE ‚Äô18, November 4‚Äì9, 2018, Lake Buena Vista, FL, USA
We /f_irst use a parameterized DTMC to model the presence of un-
certainty, which is expressed as small perturbations to transition
probabilities. Then, we de/f_ine a variation function that presents a
mathematical characterization of the perturbation in the veri/f_ica-
tion of long-run properties. This function captures the diÔ¨Äerence
between the veri/f_ication of a long-run property against a perturbed
DTMC and its associated unperturbed DTMC. Lastly, we look for
the linear fragment of the variation function that provides a useful
approximate solution of this function. Based on this linear fragment
and using the concept of condition numbers, we compute linear
perturbation bounds that reveal the worst-case consequences of
perturbations on the veri/f_ication of long-run properties in DTMCs.
4.1 Dealing with Uncertainty
LetD=¬πS;P;Sinit;AP;L¬∫be the unperturbed DTMC. We /f_irst iden-
tify the probabilistic transitions that are vulnerable to perturbations.
Then, we capture the presence of these perturbations by using a
perturbation vector ¬Æx=hx1; : : : ; xmiwhere mis the total number
of perturbation variables in ¬Æx. Based on the unperturbed transi-
tion function P, we incorporate the perturbation vector ¬Æxinto the
parametric probabilistic transition P¬ª¬Æx¬º, which is de/f_ined as follows:
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 4. Parametric Probabilistic Transition Function. Given
a perturbation vector ¬Æx=hx1; : : : ; xmiand a non-parametric prob-
abilistic transition P,P¬ª¬Æx¬ºis the parametric probabilistic transition
function such that√ç
s;t2SP¬ª¬Æx¬º¬πs;t¬∫=1and each entry P¬ª¬Æx¬º¬πs;t¬∫of
P¬ª¬Æx¬ºis de/f_ined as follows:
P¬ª¬Æx¬º¬πs;t¬∫=8>>> <
>>>:P¬πs;t¬∫ ifP¬πs;t¬∫=0orP¬πs;t¬∫=1
P¬πs;t¬∫+xiif9xi2¬Æxsuch that/v.altuln¬πs;t;xi¬∫
P¬πs;t¬∫ otherwise
where/v.altuln¬πs;t;xi¬∫is true if the transition from state sto state tis
vulnerable to perturbation and xi2¬Æxrepresents the perturbation for
the transition from stot.
P/r.sc/o.sc/p.sc/o.sc/s.sc/i.sc/t.sc/i.sc/o.sc/n.sc 1. Given a vector¬Æx=hx1; : : : ; xmi, letIbe a par-
tition onf1; : : : ; mg. A sub-vector¬Æ/y.alt=hxj; : : : ; xkiis an independent
perturbed sub-vector in the partition Isuch that 1j<km. For
all¬Æ/y.alt2I,√ç
t2SP¬ª¬Æx¬º¬πs;t¬∫=√ç
t2SP¬πs;t¬∫+√ç
xi2¬Æ/y.altxifor some s2S.
Proposition 1 states that each element of ¬Æxfalls into an inde-
pendent perturbed sub-vector ¬Æ/y.altand all variables of a sub-vector
¬Æ/y.altare used. On the other hand, it is always assumed that the vec-
tor¬Æx=hx1; : : : ; xmiis within the setU..=f¬Æx2Rmj8¬Æ/y.alt2
I;√ç
xi2¬Æ/y.altxi=0;P¬ª¬Æx¬ºPg. We refer the parametric DTMC D¬ª¬Æx¬º
(De/f_inition 3) as the perturbed version of DTMCD.
To illustrate the de/f_initions above, consider again the DTMC
model of the development lifecycle of a mobile app presented in
Figure 1. In the following, we denote this DTMC as Dlc. As we
introduced in Section 2, there are several sources of uncertainty in
the modeling ofDlc, which are expressed as small perturbation
in the probabilistic transitions of the model. As Figure 1 shows,
the uncertainty in the model is depicted by the perturbation vector
¬Æx=hx1;x2;x3;x4;x5i. Note that we only incorporated variables
into transitions between 0 and 1. The presence of ¬ÆxinDlchas
as a consequence the de/f_inition of PMC Dlc¬ª¬Æx¬ºwhere the only
diÔ¨Äerence between both models is the parametric function P¬ª¬Æx¬º.Based on Proposition 1, each perturbation variable xi2¬Æxfalls
into two independent perturbed sub-vectors: ¬Æ/y.alt1=hx1;x2;x3iand
¬Æ/y.alt2=hx4;x5i. As a result, we have I=f¬Æ/y.alt1;¬Æ/y.alt2g. Note that each
sub-vector is associated to the outgoing transitions of a perturbed
state. For example, sub-vectors ¬Æ/y.alt1and¬Æ/y.alt2are associated to states s1
ands2, respectively.
4.2 Variation Function for Long-Run
Properties in DTMCs
This section presents a mathematical characterization of the pertur-
bation on veri/f_ication of long-run properties in DTMCs. Recall that
a variation function captures the diÔ¨Äerence between the computa-
tion of a long-run probability in a perturbed and unperturbed model.
Following the computation of long-run probabilities described in
Section 3.3, we present two variation functions: i) for irreducible
DTMCs, and ii) for reducible DTMCs.
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 5. Variation Function - Irreducible Case. Let D=
¬πS;P;Sinit;AP;L¬∫andD¬ª¬Æx¬º=¬πS;P¬ª¬Æx¬º;Sinit;AP;L¬∫be an irreducible
DTMC and its parametric irreducible variant, respectively. A variation
function ofD¬ª¬Æx¬ºagainst the long-run probability of a particular state
s2SisœÉ:¬πS;U¬∫!¬ª 0;1¬ºde/f_ined as follows:
œÉ¬πs;¬Æx¬∫=œÄD¬ª¬Æx¬º
s œÄD
s: (2)
Before presenting the variation function for reducible DTMCs,
let us recall that given an unperturbed reducible DTMC D, the
computation of œÄDs,0if and only if s2K;K2BSCC¬πD¬∫. The
value of œÄDsdepends on two components:
(1)The reachability probability from initial states to BSCC K,
denoted as PrD¬π^K¬∫.
(2)The long-run probability of state sin sub-DTMCD¬πK¬∫,
denoted as œÄD¬πK¬∫
s , if and only if s2BSCC K.
Under those circumstances, we de/f_ine the variation function for
reducible DTMCs as follows:
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 6. Variation Function - Reducible Case. Let D=
¬πS;P;Sinit;AP;L¬∫andD¬ª¬Æx¬º=¬πS;P¬ª¬Æx¬º;Sinit;AP;L¬∫be a reducible
DTMC and its parametric reducible variant, respectively. Let KS
be a BSCC. A variation function of reducible D¬ª¬Æx¬ºwith respect to the
long-run probability of a particular state s2KisœÑ:¬πS;U¬∫!¬ª 0;1¬º
de/f_ined as follows:
œÑ¬πs;¬Æx¬∫=PrD¬ª¬Æx¬º¬π^K¬∫œÄD¬πK¬∫¬ª¬Æx¬º
s PrD¬π^K¬∫œÄD¬πK¬∫
s ; (3)
whereD¬πK¬∫¬ª¬Æx¬ºandD¬πK¬∫represent the perturbed and unperturbed
sub-DTMC ofD¬ª¬Æx¬ºandD, respectively.
4.3 Linear Perturbation Bounds
The key idea behind perturbation theory is to reduce a hard problem
into an in/f_inite sequence of relatively simple ones. We compute
the linear perturbation bounds that capture the veri/f_ication eÔ¨Äect
of uncertainty in the form of condition numbers. These bounds
provide a useful approximate solution to the variation function.
We de/f_ine the linear perturbation bounds i) for irreducible DTMCs,
and ii) for reducible DTMCs. For each case, we /f_irst de/f_ine the lin-
ear fragment of its corresponding variation function. Then, we
de/f_ine the condition number based on the linear fragment. Last,
we compute the linear perturbation bounds based on the condition
number and the total perturbation distance Œ¥>0of the model./Q_uantifying the Impact of Uncertainty on the Long-Run Probability Y. Serrano, M. B√∂hme, M. Br√ºnink, G. Su, and D.S. Rosenblum
4.3.1 Irreducible Case. LetœÉ¬πs;¬Æx¬∫be the variation function for
irreducible DTMCs with respect to the long-run probability of a
particular state s(De/f_inition 5). The linear fragment of the variation
functionœÉ¬πs;¬Æx¬∫is de/f_ined as follows:
T/h.sc/e.sc/o.sc/r.sc/e.sc/m.sc 4.1. Linear Fragment of œÉ¬πs;¬Æx¬∫- Irreducible Case. Let
œÉ¬πs;¬Æx¬∫be the variation function for irreducible DTMCs. For any
¬Æx2U, the linear fragment œÉ1ofœÉis formulated as follows:
œÉ1¬πs;¬Æx¬∫=√ï
s02Sn
limn!11
nn√ï
k=1√ï
i+j=k 1¬πPjP?Pi¬∫¬πs0;s¬∫o
; (4)
where P?=P¬ª¬Æx¬º P.
P/r.sc/o.sc/o.sc/f.sc. Let us start by analyzing the variation function œÉ¬πs;¬Æx¬∫=
œÄD¬ª¬Æx¬º
s œÄDs(Equation 2). Using the solution of the unperturbed
œÄDsas an approximation to the solution of the perturbed œÄD¬ª¬Æx¬º
s ,
we can express the variation function œÉ¬πs;¬Æx¬∫as follows:
œÉ¬πs;¬Æx¬∫=√ï
s02Slimn!11
nÀÜP¬πs0;s¬∫;where ÀÜP=n√ï
k=1P¬ª¬Æx¬ºk n√ï
k=1Pk:(5)
LetP?=P¬ª¬Æx¬º PandŒ¥=√ç
xi2¬Æxjxijbe the total perturbation
distance. By expanding the term ÀÜPof Equation 5, we have:
n√ï
k=1P¬ª¬Æx¬ºk n√ï
k=1Pk=n√ï
k=1¬πP?+P¬∫k n√ï
k=1Pk(6)
As we look for the linear fragment of œÉ¬πs;¬Æx¬∫, we ignore any term
of more one copy of P?in Equation 6. As a result, we have:
n√ï
k=1P¬ª¬Æx¬ºk n√ï
k=1Pk=n√ï
k=1√ï
i+j=k 1¬πPjP?Pi¬∫+O¬πŒ¥2¬∫: (7)
where xiO¬πŒ¥¬∫. Based on previous equation, we conclude linear
fragmentœÉ1as Equation 4. 
Based on the linear fragment œÉ1, we de/f_ine the condition number
and linear perturbation bounds for irreducible DTMCs as follows:
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 7. Condition Number - Irreducible Case. Let ¬ÆhTdenote
the transpose of vector ¬Æh. Let¬Æx2U be a perturbation vector. We can
writeœÉ1¬πs;¬Æx¬∫in the form œÉ1¬πs;¬Æx¬∫=¬Æx¬ÆhTfor some constant vector
¬Æh. Thus, we can de/f_ine the condition number Œ∫irrsfor an irreducible
DTMC as follows:
Œ∫irr
s=1
2max
xi;xj2¬Æ/y.alt;¬Æ/y.alt2I¬π¬Æhi ¬Æhj¬∫: (8)
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 8. Linear Perturbation Bound - Irreducible Case. Let
Œ¥=√ç
xi2¬Æxjxijbe the total perturbation distance. Let œÄDsandŒ∫irrs
be the unperturbed long-run probability and the condition number of
a particular state sin an irreducible DTMC D, respectively. A pair of
upper and lower linear perturbation bounds for the variation function
œÉ¬πs;¬Æx¬∫are de/f_ined as follows:
f+
irr=œÄD
s+Œ∫irr
sŒ¥;andf 
irr=œÄD
s Œ∫irr
sŒ¥: (9)
As an illustration, consider again PDTMC Dlc¬ª¬Æx¬ºshown in Fig-
ure 1. As the /f_igure shows, the dashed rectangles represent the set
of BSCCs of the model: K1=fs2;s5;s6g,K2=fs3gandK3=fs4g.
Suppose we are interested to estimate the worst-case eÔ¨Äect of per-
turbed sub-vector ¬Æ/y.alt2=hx4;x5ion the veri/f_ication of the probabil-
ity that an app, in the long run, will be in deployment¬πs2¬∫. Since
s22K1, we only focus on BSCC K1that induces a sub-PDTMCD¬ª¬Æ/y.alt2¬º¬πK1¬∫=¬πK1;P¬ª¬Æ/y.alt2¬ºK1¬∫where P¬ª¬Æ/y.alt2¬ºK1=¬πP¬ª¬Æx¬º¬πs;t¬∫¬∫s;t2K1and
¬Æ/y.alt2¬Æx. It is important to notice that the sub-PDTMC D¬ª¬Æ/y.alt2¬º¬πK1¬∫is
irreducible.
Under those circumstances, we follow the computation of linear
perturbation bounds for irreducible DTMCs. First, we de/f_ine the
variation function œÉ¬πs2;¬Æ/y.alt2¬∫=œÄD¬ª¬Æ/y.alt2¬º¬πK1¬∫
s2 œÄD¬πK1¬∫
s2(De/f_inition 5).
Then, by Theorem 4.1, we calculate œÉ1¬πs2;¬Æ/y.alt2¬∫=1:166x4+0:166x5
as the linear fragment of œÉ. Next, we compute Œ∫irrs2=¬π1:166 
0:166¬∫¬ù2=0:5(De/f_inition 7). Since the company is interested in the
worst-case eÔ¨Äect of uncertainty in the modeling of the development
lifecycle if the total uncertainty was at least Œ¥=0:001, we compute
the upper bound f+
irr=0:199+¬π0:5¬∫¬π0:001¬∫=0:1995, and the lower
bound f 
irr=0:199 ¬π0:5¬∫¬π0:001¬∫=0:1985. Note that we consider
jx4j+jx5j0:001.
4.3.2 Reducible Case. Following the same strategy as for the
irreducible case, we start by de/f_ining the linear fragment of the
variation function œÑ¬πs;¬Æx¬∫for reducible DTMCs as follows:
T/h.sc/e.sc/o.sc/r.sc/e.sc/m.sc 4.2. Linear Fragment of œÑ¬πs;¬Æx¬∫- Reducible Case. Let
s2BSCC K. LetœÑ¬πs;¬Æx¬∫be the variation function for reducible DTMCs
with respect to long-run property of a particular state s. For any
¬Æx2U, the linear fragment of œÑ¬πs;¬Æx¬∫is de/f_ined as follows:
œÑ1¬πs;¬Æx¬∫=PrD¬π^K¬∫œÉ1¬πs;¬Æx¬∫+œÅ1¬π¬Æx¬∫œÄD¬πK¬∫
s ;where: (10)
PrD¬π^K¬∫is the reachability probability from initial states to K,
œÉ1¬πs;¬Æx¬∫is the linear fragment of variation function for irreducible
DTMCs w.r.t. long-run probability of s, presented in Theorem 4.1,
œÅ1¬π¬Æx¬∫=ŒπinitA?¬πA0¬ª¬Æx¬ºA?b+b0¬ª¬Æx¬º¬∫is the linear fragment of a
variation function œÅi¬π¬Æx¬∫for reachability properties in DTMCs, and
œÄD¬πK¬∫
s is the long-run probability of state sin sub-DTMCD¬πK¬∫
induced by K.
P/r.sc/o.sc/o.sc/f.sc. Let us analyze the variation function œÑ¬πs;¬Æx¬∫presented
in Equation 3. The /f_irst term of PrD¬ª¬Æx¬º¬π^K¬∫was studied by Su et
al.[20]. The authors presented the following expansion:
PrD¬ª¬Æx¬º¬π^K¬∫=PrD¬π^K¬∫+œÅi¬π¬Æx¬∫; (11)
whereœÅi¬π¬Æx¬∫=A?A0¬ª¬Æx¬º: : :A?A0¬ª¬Æx¬º
|                      {z                      }
i-1 copies of A?A0¬ª¬Æx¬º¬πA?A0¬ª¬Æx¬ºA?b+A?b0¬ª¬Æx¬º¬∫for
each i1, such that A?=¬πI A¬∫ 1,b=¬πP¬πs0;K¬∫¬∫s02¬πSnK¬∫,
b¬ª¬Æx¬º=¬πP¬ª¬Æx¬º¬πs0;K¬∫¬∫s02¬πSnK¬∫,b0¬ª¬Æx¬º=b¬ª¬Æx¬º b,A=¬πP¬πs0;t¬∫¬∫s0;t2SnK,
A¬ª¬Æx¬º=¬πP¬ª¬Æx¬º¬πs0;t¬∫¬∫s0;t2SnKandA0¬ª¬Æx¬º=A¬ª¬Æx¬º A.
By substituting the above expansion into Equation 3 , we can
rewrite the variation function œÑ¬πs;¬Æx¬∫as follows:
œÑ¬πs;¬Æx¬∫=PrD¬π^K¬∫¬ªœÄD¬πK¬∫¬ª¬Æx¬º
s œÄD¬πK¬∫
s¬º+œÅi¬π¬Æx¬∫œÄD¬πK¬∫¬ª¬Æx¬º
s (12)
It is important to note that the term œÄD¬πK¬∫¬ª¬Æx¬º
s œÄD¬πK¬∫
s in Equa-
tion 12 is the de/f_inition of variation function for irreducible DTMCs,
denoted as œÉ¬πs;¬Æx¬∫(De/f_inition 5). Thus, by substituting œÉ¬πs;¬Æx¬∫into
Equation 12, we have:
œÑ¬πs;¬Æx¬∫=PrD¬π^K¬∫œÉ¬πs;¬Æx¬∫+œÅi¬π¬Æx¬∫œÄD¬πK¬∫¬ª¬Æx¬º
s ; (13)
where the term œÄD¬πK¬∫¬ª¬Æx¬º
s =√ç
s02Sn
limn!11
n√çn
k=1PK¬ª¬Æx¬ºk¬πs0;s¬∫o
:/Q_uantifying the Impact of Uncertainty on the Long-Run Probability ESEC/FSE ‚Äô18, November 4‚Äì9, 2018, Lake Buena Vista, FL, USA
LetP?
K=PK¬ª¬Æx¬º PKandŒ¥=√ç
xi2¬Æxjxijbe the total perturba-
tion distance. Expanding the term√çn
k=1PK¬ª¬Æx¬ºk, we have:
n√ï
k=1PK¬ª¬Æx¬ºk=n√ï
k=1¬πP?
K+PK¬∫k(14)
=n√ï
k=1Pk
K+n√ï
k=1√ï
i;j0
i+j=k 1¬πPjP?
KPi¬∫+O¬πŒ¥2¬∫; (15)
where xiO¬πŒ¥¬∫. It is important for calculating the linear fragment
ofœÑ1¬πs;¬Æx¬∫to ignore any term of more one copy of P?
Kin Equation 14.
Combining the above equations and Equation 13, we conclude as
linear fragment of œÑ¬πs;¬Æx¬∫as Equation 10. 
Based on linear fragment œÑ1¬πs;¬Æx¬∫, we de/f_ine the condition number
and the linear perturbation bound for reducible DTMCs as follows:
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 9. Condition Number - Reducible Case. Let ¬ÆhTdenote
the transpose of vector ¬Æh. Let¬Æx2U be a perturbation vector. We
writeœÑ1¬πs;¬Æx¬∫in the form œÑ1¬πs;¬Æx¬∫=¬Æx¬ÆhTfor some constant vector ¬Æh.
Thus, we de/f_ine the condition number Œ∫redsfor a reducible DTMC as
follows:
Œ∫red
s=1
2max
xi;xj2¬Æ/y.alt;¬Æ/y.alt2I¬π¬Æhi ¬Æhj¬∫: (16)
D/e.sc/f.sc/i.sc/n.sc/i.sc/t.sc/i.sc/o.sc/n.sc 10. Linear Perturbation Bound - Reducible Case. Let
Œ¥=√ç
xi2¬Æxjxijbe the total perturbation distance. Let œÄDsandŒ∫reds
be the unperturbed long-run probability and the condition number of
a particular state sin a reducible DTMC D, respectively. A pair of
upper and lower linear perturbation bounds for the variation function
œÑ¬πs;¬Æx¬∫are de/f_ined as follows:
f+
red=œÄD
s+Œ∫red
sŒ¥;andf 
red=œÄD
s Œ∫red
sŒ¥: (17)
To exemplify the computation of linear perturbation bounds
in reducible DTMCs, consider again the reducible PDTMCDlc¬ª¬Æx¬º
with perturbation vector ¬Æx=hx1;x2;x3;x4;x5iin Figure 1. Sup-
pose again we are interested to estimate the worst-case eÔ¨Äect of ¬Æx
on veri/f_ication of the long-run probability that an app will be in
deployment (s2) in the PDTMCDlc¬ª¬Æx¬º. Recall the set of BSCCs are
K1=fs2;s5;s6g,K2=fs3gandK3=fs4g.
By De/f_inition 6 and given that s22BSCC K1, we /f_irst de/f_ine
œÑ¬πs2;¬Æx¬∫=PrDlc¬ª¬Æx¬º¬π^K1¬∫œÉ¬πs2;¬Æx¬∫+œÅi¬π¬Æx¬∫œÄD¬πK1¬∫¬ª¬Æx¬º
s2as the vari-
ation function, where œÄD¬πK1¬∫¬ª¬Æx¬º
s2denotes the long-run probability
that an app will be in deployment (s2) in the sub-PDTMC D¬πK1¬∫¬ª¬Æx¬º
induced by BSCC K1.
Following Theorem 4.2, the linear fragment of œÑ¬πs2;¬Æx¬∫is de-
/f_ined asœÑ1¬πs2;¬Æx¬∫=PrDlc¬π^K1¬∫œÉ1¬πs2;¬Æx¬∫+œÅ1¬π¬Æx¬∫œÄD¬πK1¬∫
s2where
PrDlc¬π^K1¬∫=0:166,œÉ1¬πs2;¬Æx¬∫=1:166x4+0:166x5(irreducible
case),œÅ1¬π¬Æx¬∫=0:111x1+0:666x2andœÄD¬πK1¬∫
s2=0:199. Thus, we
haveœÑ1¬πs2;¬Æx¬∫=0:0221x1+0:133x2+0:0648x4+0:0092x5. Conse-
quently, based on De/f_inition 9, the condition number Œ∫reds2=0:067
(shown in Table 1). And, since we are interested in the worst-case
eÔ¨Äect of¬Æxwhen the total perturbation distance Œ¥=0:001, we com-
pute the upper bound f+
red=0:033+¬π0:067¬∫¬π0:001¬∫=0:0331, and
the lower bound f 
red=0:033 ¬π0:067¬∫¬π0:001¬∫=0:0329.
T/h.sc/e.sc/o.sc/r.sc/e.sc/m.sc 4.3. The time complexity for computing the linear per-
turbation bounds is O¬πjDj3¬∫.P/r.sc/o.sc/o.sc/f.sc. LetDbe a DTMC andjDjbe the sum of the numbers
of vertices and edges in the digraph of D. The computation of
linear perturbation bounds for irreducible and reducible DTMCs
are based on the calculation of linear fragments œÉ1(Theorem 4.1)
andœÑ1(Theorem 4.2), respectively. Note that œÑ1is de/f_ined in terms
onœÉ1. By analyzing Theorem 4.1, we observe that each term of the
sum can be computed in time O¬πjDj3¬∫. And, the computation of œÉ1
andœÑ1is dominated by this complexity bound. 
5 EXPERIMENTAL EVALUATION
In this section, we evaluate the applicability of our approach in
two case studies. Our purpose is to demonstrate that the computed
asymptotic bounds provide an accurate estimation of the worst-case
consequences of uncertainty on veri/f_ication of long-run behavior
in systems modeled as DTMCs.
For this purpose, we have developed a prototype implementation
in Python. For each case study, we /f_irst build the system model as
a DTMCD. Second, based on the designer expertise, we identify
transitions vulnerable to perturbations. A perturbation variable is
attached to each probabilistic transition. As a result, we obtain the
perturbation vector ¬Æx. Third, we formulate the long-run probability
of being in a particular state sto be analyzed, denoted as œÄs. These
aforementioned components are the input of our prototype. By
following our perturbation approach described in Section 4, our
prototype computes a condition number Œ∫sthat captures the eÔ¨Äect
of uncertainty in the veri/f_ication of œÄs. Lastly, our prototype calcu-
lates linear perturbation bounds based on the computed condition
number and a given perturbation distance Œ¥>0. The prototype can
be found in https://github.com/mboehme/mboehme.github.io/raw/
master/paper/FSE18.zip. For our experiments, we used a machine
with 3.06 GHz Intel Core Duo processors and 8GB RAM.
5.1 Clickstream Data
Model . As a /f_irst case study, we model the stochastic process of
users clicking through the web-pages on a server as an irreducible
DTMC [ 2,17]. Speci/f_ically, we use public clickstream data collected
for a popular news site msnbc.com [10]. The data spans the entire
day of September 28, 1999 and it contains 989818 logs. Each log
represents a clickstream. A clickstream is a sequence of web page
categories visited by a given user. The categories are listed in
Table 2. The DTMC Dcl=¬πS;P;Sinit;AP;L¬∫consists of 17 states
S=fs1; : : : ; s17gwhich represent the categories of the news site.
The set of initial states Sinitis composed by the front-page ( s1).
The transitions inDclrepresent the sequences of clicks from one
category page to another. P¬πsi;sj¬∫is calculated by counting all
instances of state sithat precede state sjacross all clickstreams.
The model contains 17states and 289transitions.
We investigate the impact of estimating the DTMC‚Äôs transition
probabilities from empirical data using maximum-likelihood estima-
tion. The clickstream sample is subject to some variance resulting
in small perturbations to the estimated transition probabilities. We
are interested in the probability that a user is visiting a certain web-
page in the long run. Thus, we calculate the long-run probabilities
œÄDcl
siof all states siwith 1i17. In the following, we simply
refer to œÄDcl
siasœÄsi./Q_uantifying the Impact of Uncertainty on the Long-Run Probability Y. Serrano, M. B√∂hme, M. Br√ºnink, G. Su, and D.S. Rosenblum
Table 2: Experimental Results for Clickstream Data
Categories œÄsiŒ∫siTime Categories œÄsiŒ∫siTime
siName¬πŒ¥=0¬∫ (min) siName¬πŒ¥=0¬∫ (min)
s1Front-page 0.1579 4.053 12.0 s3Tech 0.0401 3.437 12.8
s14BBS 0.1099 6.926 12.9 s13Summary 0.0377 5.565 12.9
s2News 0.1019 4.304 11.6 s10Living 0.0343 3.808 14.3
s8Weather 0.0979 12.14 12.2 s9Health 0.0315 3.354 13.2
s4Local 0.0966 5.521 13.7 s11Business 0.0217 2.525 13.6
s7Misc 0.0783 4.395 14.3 s15Travel 0.0135 2.045 11.6
s6On-air 0.0608 3.327 13.4 s16Msn-news 0.0084 13.89 11.5
s12Sports 0.0549 4.272 12.0 s17Msn-sports 0.0042 2.042 11.5
s5Opinion 0.0504 8.774 12.7
s17s15s16
s11s9s10s13
s3s5
s12s6s7s4s8
s2s14
s1
0210 2410 2610 2810 20:1 0:12 0:14 0:1602468101214
Unperturbed Long-Run Probability œÄsiCondition Number Œ∫si
Figure 2: Relationship Between the Long-Run Probability
and Condition Number of a Web-Page
Uncertainty . The DTMCDclthat we created from the ob-
served clickstream data is subject to sampling error on each state
transition; the sampling error will compound and threaten the va-
lidity of any veri/f_ication results. The clickstream data was collected
on a single day. Thus, the data is merely a sample of the population
of visitors to msnbc.com . Sample statistics represent population
statistics only to some degree of accuracy.
To account for the sampling error, we perturbed each probabilis-
tic transition in the Markov model Dcl. In total, we added 289
perturbation variables, ¬Æx=hx1; : : : ; x289i, one for each transition.
After perturbing the model, we are interested in analyzing which
state is aÔ¨Äected most by the perturbation, i.e. which state is most
susceptible to compounding sampling errors. For this reason, for
each state si, we compute its corresponding condition number Œ∫si
by using our approach.
We present experimental results for this case study in Table 2.
The /f_irst two columns depict the set of 17 web page categories,
which are ordered from the most-visited to least-visited. The next
column shows the probability œÄsithat a visitor, in the long-run,
visits page si, given the ideal scenario ( Œ¥=0). The last column
depicts the corresponding condition number Œ∫si.
As can be seen from Table 2, in an unperturbed model, the most-
visited page is the front-page (15.79%), followed by BBS (10.99%)
and news (10.19%). On the contrary, the least-visited pages are
msn-news (0.42%) and msn-sport (0.84%). In Figure 2 we compare
the long-run probabilities in the unperturbed model (x-axis) with
the condition numbers for each state si. The condition numbers
indicate the eÔ¨Äect of perturbing vector ¬Æxduring the computation of
œÄsi, i.e. the impact of the unknown sampling error on the calculated
long-run probabilities.Table 3: Accuracy of the Linear Perturbation Bounds
Categories œÄsiŒ∫siŒ¥
œÄsi‚àÜœÄsiŒ∫siŒ¥
siName Œ¥=010 310 410 3
s1 Front-page 0.1579 4.0531.5 0.157869 -0.31 6:079
3.0 0.157864 -0.36 12:15
s16Msn-news 0.0084 13.891.5 0.008434 0.34 20:83
3.0 0.008433 0.33 41:67
s8Weather 0.0979 12.141.5 0.097950 0.50 18:21
3.0 0.097939 0.39 36:42
s5Opinion 0.0504 8.7741.5 0.050412 0.12 13:16
3.0 0.050409 0.09 26:32
Observations . Figure 2 allows us to make several insightful ob-
servations. First, it reveals that the msn-news page (denoted as s16)‚Äî
even though it is one of the least-visited pages with œÄs16=0:0084‚Äî
is very sensitive with respect to perturbations of the transitions
probabilities. We can draw this conclusion from the large condition
number,Œ∫s16=13:89. This /f_inding indicates that small changes in
the transition probabilities may have a severe impact on the num-
ber of visits to the msn-news page. Second, the sensitivity of the
front-page, which is the most-visited page, has a condition number
(Œ∫s1=4:053) that is close to the median of 4:272. Thus, the front-
page is not particularly susceptible to perturbation of transition
probabilities. Finally, inspecting Figure 2 we cannot /f_ind a clear
correlation between the long-run probability and the condition
number. This implies that the most- and least-visited web-pages
are only weakly sensitive to the eÔ¨Äect of uncertainty.
Soundness . To evaluate whether our perturbation techniques
provides a sound estimate of the worst-case consequences of uncer-
tainty in the computation of long-run probabilities, we introduce
Table 3. As the table shows, we have restricted our evaluation to the
most-visited page in the unperturbed scenario and three of the most-
sensitivity pages. Table 3 depicts that for each page, we perturbed a
non-parametric DTMC with distances Œ¥=1:5;3:010 3. Then, we
calculate the long-run probability against a non-parametric DTMC
with distance Œ¥. And, we compare the perturbed and unperturbed
long-run probability, denoted as ‚àÜœÄsi, against our estimate Œ∫siŒ¥
of the worst-case eÔ¨Äect of uncertainty in the computation of œÄsi.
Under the assumption that specifying individual probability per-
turbations is impossible or impractical, for this experiment, the
allocation of Œ¥to transition probabilities represents one of the pos-
sible allocations, not the worst-case distribution. Our experimental
results show that, for each table, the estimate Œ∫siŒ¥provide a
safe prediction of the impact of perturbations. For example, the
diÔ¨Äerence between the probabilities for the perturbed and unper-
turbed models for the front-page is  0:000031 , which lies within
our estimation of0:006079 .
In summary, using perturbation analysis we succeed in detecting
a web page category (msn-news) that is very sensitive to small
changes to the transition probabilities. Even minor changes to the
transition probabilities might signi/f_icantly impact the frequency
of visits to the msn-news pages. Perturbation analysis of DTMC
re/f_lects uncertainties in the model. These uncertainties include (but
are not limited to) uncertainties due to sampling error and changing
user behavior. The insights generated by our perturbation analysis
will be very helpful for capacity planning and related activities./Q_uantifying the Impact of Uncertainty on the Long-Run Probability ESEC/FSE ‚Äô18, November 4‚Äì9, 2018, Lake Buena Vista, FL, USA
5.2 Call Invocation Sequences
In this section we continue by investigating how the software engi-
neering community can bene/f_it from our approach, in particular
how the technique can help during software maintenance.
Model . To this end we model the invocation sequence graph
forwc, a program in the coreutils 8.25 tool set. wcparses the
standard input or alternatively a set of /f_iles and counts various
attributes of the read data. By default it counts number of lines,
words, and bytes. We focus on wcfor a multitude of reasons. First,
coreutils is widely distributed and used daily across a diverse
user population. Second, wchas a long development history dating
back to at least 1985 making it a very mature software artifact.
Third, since coreutils is very mature, we expect a mature test
suite which we utilize to collect transition probabilities to model
a DTMC and exemplify the strength of the proposed perturbation
technique. Finally, we picked the wcprogram from the coreutils
tool set due to prior exposure to its source code. Thus, we were
able to manually verify our results using existing prior knowledge.
Similar to the previous case study, we model wcas an irreducible
DTMCDwc. The set of states Scontains all unique functions called
during runtime of wc. Each called function fiis represented as a
state si2S. Additionally, Scontains two pseudo states, ‚Äústart‚Äù and
‚Äúend‚Äù, that represent program start and program termination, re-
spectively. The set of initial states Sinitconsists of the ‚Äústart" state.
The transitions inDwcrepresent the sequences of calls observed
during runtime. We do not model function returns. In particular,
P¬πsi;sj¬∫is calculated by counting the fraction of calls to the func-
tion firepresented by sithat is directly followed by a call to the
function fjrepresented by state sj. A transition fitofjindicates
that function fjmight be called either by fidirectly or by any caller
offi. Thus, we model function call sequences not call graphs.
To gather runtime data we instrument wcwith LLVM XRay
5.0.1 [ 1]. In particular, we use LLVM XRay‚Äôs capability to collect
all function enter and exit events that occurs during runtime. Next,
we execute the test suite of coreutils against the instrumented wc
binary. We obtain 42trace /f_iles that contain 55;072logged function
calls. We use these 55;072function calls to create Dwcas described
above. The resulting model contains 46states representing func-
tions plus 2 pseudo states and 72transitions.
Uncertainty . A common challenge in the context of software
maintenance is to judge about the impact of a prospective change.
Our technique can be used to analyze the sensitivity of a function
with respect to call frequency if transition probabilities are per-
turbed. This can be helpful in the context of software maintenance
to, for example, let us assume a change is pending. In order to judge
about the risk involved in applying the change to the software,
especially with regard to performance, we would like to know how
often the changed function fiis expected to be executed. That is,
we are interested in computing the long-run probability œÄsi. If
the function fihas a high probability of being executed, then any
change to this function might have a severe impact on availabil-
ity and performance of the software artifact. In contrast, if the
execution probability is low, then the risk involved is lower.
We use the previously described model capturing call invocation
sequences to analyze the execution frequencies for wc. To account
for uncertainties, we perturb all 40probabilistic transition, thatTable 4: Experimental Results of wcwhereŒ∫si>10
Function œÄDwc
si¬πŒ¥=0¬∫Œ∫si Time (min)
s2 umaxtostr 0.32782 42.7632 2.18
s11 to_uchar 0.00136 14.5389 2.40
s3 argv_iter 0.10969 10.9580 2.36
s8 wc_/f_ile 0.10931 10.7852 2.07
s7 wc 0.10930 10.6524 2.48
s6 fdadvise 0.10930 10.5196 2.19
s4 safe_read 0.10964 10.4175 2.15
s5 write_counts 0.10946 10.2672 2.04
is0<P¬πsi;sj¬∫<1, of the model where ¬Æx=hx1; : : : ; x40i. The
experimental results are shown in Table 4. The rightmost column in
Table 4 contains the condition number Œ∫si. Due to space constraints,
we present only a limited sub-set of functions of wc. We show all
functions for which the condition number Œ∫si>10. The functions
are ordered by decreasing condition number. We also show the
long-run probability œÄsiunder no perturbation ( Œ¥=0).
Observations . The /f_irst entry in Table 4 describes umaxtostr .
Of all the functions observed during runtime umaxtostr is most
sensitive to perturbations ( Œ∫s2=42:7632 ). It is also the most of-
ten executed function (with a long-run execution probability of
32.789%). Thus, any changes to umaxtostr should be associated
with a higher risk. The next entry describes to_uchar . Looking at
the execution probability of to_uchar (0.136%) we would predict
that changes to this function are likely unproblematic as it is exe-
cuted very seldom. However, the condition number for to_uchar
is relatively high ( Œ∫s11=14:5389). This indicates that small changes
to the transition probabilities can have a severe impact on the exe-
cution frequency of to_uchar .
We investigate the call sites of to_uchar . All recorded calls to
to_uchar originate from wc.c line 496 and 499. These lines are
executed only if wcwas instructed to count characters or words,
or extract the maximum line length. Thus, how often to_uchar
is executed depends strongly on the requested operation. Even
though to_uchar is executed only seldom in our test environment
any changes to it should be marked as risky since the selection of
runtime options might severely increase its invocation rate. The
high condition number for to_uchar correctly identi/f_ies this sensi-
tivity. Figure 3 shows the relationship between unperturbed long-
run probability (log-scale) and condition number for wc. Similar
to Figure 2 in the previous clickstream data scenario we cannot
/f_ind a clear correlation between the long-run probability and the
condition number.
Soundness . To evaluate the soundness of our perturbation esti-
mate generated by our technique, we conducted additional exper-
iments, shown in Table 5. We /f_irst built a non-parametric model
with small perturbation distances ( Œ¥=1;3;510 3). Second, we
compute the long-run probability for a sub-set of functions of wcin
the perturbed model, denoted as œÄsi. In particular, we perturbed
all probabilistic transitions in the strongly connected subgraph
that performs the actual work of counting the requested proper-
ties from the input /f_iles. That is, we perturb all outgoing tran-
sitions from umaxtrostr ,wc,safe_read ,to_uchar ,argv_iter ,
arg_iter_n_args , and call_freefun . Then, we compare the
perturbed and unperturbed long-run probabilities, computed as/Q_uantifying the Impact of Uncertainty on the Long-Run Probability Y. Serrano, M. B√∂hme, M. Br√ºnink, G. Su, and D.S. Rosenblum
Table 5: Additional Experimental Results for wc
Functions œÄsiŒ∫siŒ¥=110 3Œ¥=310 3Œ¥=510 3
si Name ( Œ¥=0;%) œÄsi¬π%¬∫‚àÜœÄsi¬π%¬∫ Œ∫siŒ¥¬π%¬∫œÄsi¬π%¬∫‚àÜœÄsi¬π%¬∫ Œ∫siŒ¥¬π%¬∫œÄsi¬π%¬∫‚àÜœÄsi¬π%¬∫ Œ∫siŒ¥¬π%¬∫
s2 umaxtostr 32.79 42.7632 32.11 -0.680 4:276 31.63 -1.160 12:83 31.32 -1.470 21:38
s11 to_uchar 0.136 14.5389 0.138 0.002 1:454 0.090 -0.046 4:362 0.058 -0.078 7:269
s3 argv_iter 10.97 10.9580 10.82 -0.150 1:096 10.71 -0.260 3:287 10.63 -0.340 5:479
s8 wc_/f_ile 10.93 10.7852 10.77 -0.160 1:078 10.66 -0.270 3:236 10.59 -0.340 5:393
10 510 410 310 210 1010203040umaxtostr
to_uchar
Unperturbed Long-Run Probability œÄsiCondition Number Œ∫si
Figure 3: Relation between Functions and CNs for wc
‚àÜœÄsi=œÄsi œÄsi. Lastly, we calculate the estimate Œ∫siŒ¥, which
provides the worst-case eÔ¨Äect of uncertainty in œÄsi.
For each function the estimate Œ∫siŒ¥in Table 5 represents a safe
prediction of the worst-case consequences caused by the perturba-
tion. For example, given that Œ¥=110 3, the diÔ¨Äerence between
the actual long-run probabilities of function to_uchar for the per-
turbed and unperturbed models is 0:138 0:136=0:002with lies
within the estimation of 1:454. The accuracy of this prediction is
replicated where Œ¥=3;510 3. We obtained similar results for
all functions presented in Table 5. Finally, note that to_uchar is
aÔ¨Äected substantially by the perturbations from a relative perspec-
tive. In contrast, the long-run probabilities of the other functions
are quite stable across the diÔ¨Äerent perturbation distances.
6 RELATED WORK
There is a rich body of literature that investigates /f_inite irreducible
Markov chains under perturbation. Many of those works focus on
the eÔ¨Äect of the perturbed transition matrix of a Markov chain on
its steady-state distribution. Similar analysis has also been applied
to queueing models [ 6]. One common technique is the derivation
of norm-based bounds for irreducible Markov chains. Speci/f_ically,
they computed a condition number Œ∫for measuring the sensitivity
of the Markov chain. Let E=¬πEj
i¬∫2Rnndenote the perturbation.
LetPandP0=P+Ebe probability transition matrices of irreducible
Markov chains with respective stationary probability vectors œÄand
œÄ0satisfying œÄP=œÄ,œÄ0P0=œÄ0, and√ç
iœÄi=1=√ç
iœÄ0
i. Then,
kœÄ œÄ0kŒ∫kEkfor suitable vector and matrix norms.
In those approach, the condition number Œ∫has been calculated
by using the fundamental matrix of a Markov chain as introduced
by Kemeny et al. [11] and Schweitzer [ 12], the group inverse of
AI Pas presented in [ 9,13], the ergodicity coeÔ¨Écients [ 7]and the mean /f_irst passage times [ 3]. All these approaches for
computing the condition number were collected and compared by
Cho and Meyer [ 4]. Based on their review, the smallest condition
number is computed by using relevant information of the group
inverse of A. This approach was proposed by Haviv et al. [9] and
Kirkland et al. [13].
However, Cho and Meyer also revealed that the computation of
the fundamental matrix and the group inverse are usually expensive.
For this reason, the condition number in terms of the mean /f_irst
passage is more feasible to be computed. Likewise, it provides an
equivalent condition number to Haviv‚Äôs de/f_inition based on the
underlying structure of the Markov chain.
Together these studies provide valuable insights into the investi-
gation of the sensitivity of the stationary distribution of Markov
chains under perturbation. However, these previous studies com-
pute the condition number Œ∫based on the perturbation E, which is
a matrix of prior de/f_ined values. Even though we are interested in
analyzing the eÔ¨Äect of the perturbation in the long-run behavior
of DTMCs, our proposal is diÔ¨Äerent from these previous studies
in two points. First, we ignore the de/f_ined values that the pertur-
bation might take. Thus, we propose to capture the perturbation
as symbolic variables. And, to provide an estimation of the worst-
case consequences of the uncertain phenomena. Second, previous
studies have not been applied in probabilistic model checking. To
the best of our knowledge, no previous publication in the literature
has addressed this problem using perturbation analysis.
7 CONCLUSION
The main goal of this paper is to estimate the worst-case conse-
quences of uncertainty on veri/f_ication of long-run properties in
DTMCs. Our main contribution is a mathematical framework for
asymptotic analysis in the presence of small perturbations to model
probabilities on veri/f_ication of long-run properties against DTMCs.
To evaluate our perturbation approach, we implemented a pro-
totype in Python. We ran our experiments on clickstream data and
call invocation sequences. These case studies have been modeled
as a DTMC and aÔ¨Äected by small perturbations for our evalua-
tion purposes. For each case study, we evaluated several long-run
properties under the presence of perturbations. Our experimental
results reveal the importance of our approach at estimating the
eÔ¨Äect to these perturbations and they provide crucial information
for identifying the sensitivity of the long-run properties under un-
certainty. This work is the /f_irst study on dealing the uncertain
phenomena in the veri/f_ication of long-run properties in DTMCs by
using perturbation analysis. There are several directions for further
study, including backward analysis that provides the maximum
permitted perturbations based on a range of veri/f_ication results./Q_uantifying the Impact of Uncertainty on the Long-Run Probability ESEC/FSE ‚Äô18, November 4‚Äì9, 2018, Lake Buena Vista, FL, USA
ACKNOWLEDGMENTS
Y. Serrano, G. Su and D. S. Rosenblum were supported in part by the
Singapore Ministry of Education under grants R-252-000-458-133
and MOE2015-T2-137-1. Y. Serrano was supported in part by a
Research Scholarship from National University of Singapore. G. Su
was supported in part by the National Natural Science Foundation
of China under grant 61502260. The authors thank the anonymous
referees for their insightful comments.
REFERENCES
[1]Dean Michael Berris, Alistair Veitch, Nevin Heintze, Eric Anderson, and Ning
Wang. 2016. XRay: A Function Call Tracing System . Technical Report. A white
paper on XRay, a function call tracing system developed at Google.
[2] Igor V Cadez, David Heckerman, Christopher Meek, Padhraic Smyth, and Steven
White. 2000. Visualization of navigation patterns on a Web site using model-
based clustering. In KDD . 280.
[3]Grace E. Cho and Carl D. Meyer. 2000. Markov Chain Sensitivity Measured
by Mean First Passage Times. Linear Algebra Appl. 316, 1 (2000), 21‚Äì28. DOI:
http://dx.doi.org/10.1016/S0024-3795(99)00263-3
[4] Grace E. Cho and Carl D. Meyer. 2001. Comparison of Perturbation Bounds for
the Stationary Distribution of a Markov Chain. Linear Algebra Appl. 335, 1 (2001),
137‚Äì150.
[5] Nicolas Coste. 2010. Towards Performance Prediction of Compositional Models in
GALS Designs . Ph.D. Dissertation. University of Grenoble.
[6] Altman E., Avrachenkov K., and N√∫√±ez Queija R. 2004. Perturbation Analysis for
Denumerable Markov Chains with Application to Queueing Models. Advances
in Applied Probability 36 (2004), 839‚Äì853.
[7] Seneta E. 1988. Perturbation of the Stationary Distribution Measured by Ergod-
icity CoeÔ¨Écients. Advances in Applied Probability 20, 1 (1988), 228‚Äì230.
[8]Ernst Moritz Hahn, Holger Hermanns, and Lijun Zhang. 2009. Probabilistic
Reachability for Parametric Markov Models. In SPIN . 88‚Äì106.
[9]Moshe Haviv and Ludo Van Der Heyden. 1984. Perturbation Bounds for the
Stationary Probabilities of a Finite Markov Chain. Advances in Applied Probability
16, 4 (1984), 804‚Äì818. http://www.jstor.org/stable/1427341
[10] David Heckerman. 1999. MSNBC.com Anonymous Web Data Set. http://archive.
ics.uci.edu/ml/datasets/msnbc.com+anonymous+web+data. (1999). Accessed:2018-02-05.
[11] Kemeny J. and Snell J. 1960. Finite Markov Chains . D. Van Nostrand, New York.
[12] Schweitzer Paul J. 1968. Perturbation Theory and Finite Markov Chains. Journal
of Applied Probability 5, 2 (1968), 401‚Äì413.
[13] Stephen Kirkland, Michael Neumann, and Bryan Shader. 1998. Applications of
Paz‚Äôs Inequality to Perturbation Bounds for Markov Chains. Linear Algebra Appl.
268, 1 (1998), 183‚Äì196.
[14] Marta Z. Kwiatkowska, Gethin Norman, and David Parker. 2005. Probabilistic
Model Checking in Practice: Case Studies with PRISM. SIGMETRICS Performance
Evaluation Review 32, 4 (2005), 16‚Äì21.
[15] Ruggero Lanotte, Andrea Maggiolo-Schettini, and Angelo Troina. 2007. Paramet-
ric Probabilistic Transition Systems for System Design and Analysis. Formal Asp.
Comput. 19, 1 (2007), 93‚Äì109. DOI: http://dx.doi.org/10.1007/s00165-006-0015-2
[16] Yamilet R. Serrano Llerena, Guoxin Su, and David S. Rosenblum. 2017. Probabilis-
tic Model Checking of Perturbed MDPs with Applications to Cloud Computing.
InProceedings of the 2017 11th Joint Meeting on Foundations of Software Engi-
neering, ESEC/FSE 2017, Paderborn, Germany, September 4-8, 2017 . 454‚Äì464. DOI:
http://dx.doi.org/10.1145/3106237.3106301
[17] Alan L. Montgomery, Shibo Li, Kannan Srinivasan, and John C. Liechty. 2004.
Modeling Online Browsing and Path Analysis Using Clickstream Data. Marketing
Science 23, 4 (2004), 579‚Äì595.
[18] Nicolas Privault. 2013. Understanding Markov Chains: Examples and Applications .
Springer Singapore.
[19] Guoxin Su, Taolue Chen, Yuan Feng, and David S. Rosenblum. 2017. ProEva:
Runtime Proactive Performance Evaluation Based on Continuous-Time Markov
Chains. In Proceedings of the 39th International Conference on Software Engineering,
ICSE 2017, Buenos Aires, Argentina, May 20-28, 2017 . 484‚Äì495. http://dl.acm.org/
citation.cfm?id=3097426
[20] G. Su, Y. Feng, T. Chen, and D. S. Rosenblum. 2016. Asymptotic Perturbation
Bounds for Probabilistic Model Checking with Empirically Determined Proba-
bility Parameters. IEEE Transactions on Software Engineering 42, 7 (July 2016),
623‚Äì639. DOI: http://dx.doi.org/10.1109/TSE.2015.2508444
[21] Guoxin Su and David S. Rosenblum. 2013. Asymptotic Bounds for Quantitative
Veri/f_ication of Perturbed Probabilistic Systems. In ICFEM . 297‚Äì312.
[22] Guoxin Su and David S. Rosenblum. 2014. Perturbation Analysis of Stochastic
Systems with Empirical Distribution Parameters. In ICSE . 311‚Äì321.