ARTINALI: Dynamic Invariant DetectionforCyber-Physical
SystemSecurity
Maryam Raiyat Aliabadi
Universityof British Columbia
Departmentof Electrical and ComputerEngineering
Vancouver, BC,Canada
raiyat@ece.ubc.caAmitaAjith Kamath∗
National Institute of Technology Karnataka
Departement of ComputerScienceand Engineering
Mangalore,India
amita.a.kamath@ieee.org
JulienGascon-Samson
Universityof British Columbia
Departmentof Electrical and ComputerEngineering
Vancouver, BC,Canada
julien.gascon-samson@ece.ubc.caKarthikPattabiraman
Universityof British Columbia
Departmentof Electrical and ComputerEngineering
Vancouver, BC,Canada
karthikp@ece.ubc.ca
ABSTRACT
Cyber-PhysicalSystems(CPSes)arebeingwidelydeployedinse-
curity-criticalscenarios suchassmarthomes andmedicaldevices.
Unfortunately,theconnectednessofthesesystemsandtheirrela-
tive lackof security measures makes them ripe targets for attacks.
Speciication-basedIntrusionDetectionSystems(IDS)havebeen
showntobeefectiveforsecuringCPSs.Unfortunately,derivingin-
variantsforcapturingthespeciicationsofCPSsystemsisatedious
and error-prone process. Therefore, it is important to dynamically
monitor the CPS system to learn its common behaviors and formu-
lateinvariantsfordetectingsecurityattacks.Existingtechniques
forinvariantminingonlyincorporatedataandevents,butnottime.
However, time is central to most CPS systems, and hence incorpo-
ratingtimeinadditiontodataandevents,isessentialforachieving
lowfalse positives andfalse negatives.
ThispaperproposesARTINALI,whichminesdynamicsystem
properties by incorporating time as a irst-class property of the
system. We build ARTINALI-based Intrusion Detection Systems
(IDSes) for two CPSes, namely smart meters and smart medical
devices, and measure their eicacy. We ind that the ARTINALI-
basedIDSessigniicantlyreducetheratiooffalsepositivesandfalse
negatives by 16 to 48% (average 30.75%) and 89 to 95% (average
93.4%)respectivelyover otherdynamicinvariantdetection tools.
CCS CONCEPTS
·Security and privacy →Intrusion detection systems ;Soft-
ware securityengineering ;Domain-speciic security and privacy
architectures ;·Softwareanditsengineering →Real-timesys-
temssoftware ;
∗Thisworkwas doneduring a summer internshipat UBC.
Permissionto make digitalor hard copies of allorpart ofthis work for personalor
classroom use is granted without fee provided that copies are not made or distributed
forproitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
on the irst page. Copyrights for components of this work owned by others than ACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspeciicpermissionand/ora
fee. Request permissions from permissions@acm.org.
ESEC/FSE’17, September 4ś8, 2017, Paderborn, Germany
©2017 Associationfor Computing Machinery.
ACM ISBN 978-1-4503-5105-8/17/09...$15.00
https://doi.org/10.1145/3106237.3106282KEYWORDS
Multi-dimensional model, Security, Cyber Physical System, CPS,
Software Engineering
ACMReference format:
Maryam Raiyat Aliabadi, Amita Ajith Kamath, Julien Gascon-Samson, and
Karthik Pattabiraman.2017.ARTINALI:DynamicInvariantDetection for
Cyber-PhysicalSystemSecurity.In Proceedingsof201711thJointMeeting
of the European Software Engineering Conference and the ACM SIGSOFT
SymposiumontheFoundationsofSoftwareEngineering,Paderborn,Germany,
September 4ś8, 2017(ESEC/FSE’17), 13pages.
https://doi.org/10.1145/3106237.3106282
1 INTRODUCTION
CyberPhysicalSystems(CPSes)arebeingincreasinglyusedinsecu-
rity-criticalcontexts such as smartmedical devices[ 23,34], smart
grids[35],smartcars[ 9],andUnmannedAerialVehicles(UAV)[ 18].
Unfortunately,thesesystemsarevulnerabletocyberattacksdue
totheirinterconnectednessandrelativelackofprotection.Many
attacks have been demonstrated against CPSes such as cars [ 21],
smart medical devices [23,27],andsmart meters[36].
IntrusionDetectionSystems(IDSes)havebeenwidelyusedto
monitor computer systems and detect security attacks. Typical
IDSesfallintooneofthreecategories: Signature-based ,Anomaly-
based,andSpeciication-based .Signature-baseddetectiontechniques
comparetheruntimebehaviorofthesystemagainstknownsecu-
rity attacks, and hence cannot detect unknown attacks [ 30]. The
latterisespeciallyimportantforCPSesastheyareoftendiicultto
patch or upgrade in the ield. In contrast, both anomaly-based and
speciication-basedtechniquesuseabehavioralmodelofthesystem
to compare with suspicious behaviors, and can detect unknown
attacks. Anomaly-based techniques learn the system’s behavior by
observingitsoperationsatruntimeandformulatingthemodelof
the system, while speciication-based techniques rely upon apriori
knowledge of the systems’ behaviour to detect attacks. Unfortu-
nately,anomalybasedsystemsincurconsiderableoverheadtolearn
the system model at runtime, and also sufer from high rates of
false-positives.ThesefactorsinhibittheiruseinCPSeswhichare
often resource constrained, and operate autonomously for long
349ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany AliabadiM.,KamathA.A.,Gascon-Samson J. andPatabiramanK.
periodsoftime.Therefore,speciication-basedsystemshavebeen
proposedas the bestitfor CPS security [8].
Speciication-based techniques build a model for a system based
onitscodeandthespeciicationsdeinedbythedeveloper.However,
there are often inconsistencies between what developers describe
their system does, and what the system does in practice [ 11,31].
Moreover,codealonedoesnot provideinformationabouttherun-
time behavior of the system in its operational environment. In
contrast,dynamicanalysis-basedtechniquesprovideanalternative
way to understand the system by observing the run-time behavior.
There has been a signiicant amount of work on using dynamic
analysis to ind likely invariants for program understanding and
debugging[ 14,16,19,22,24,25,28,32,33,42,44].Thesesystems
mine execution traces of the system for deriving invariants on the
data values of the system, the events or both. However, we ind
that many of these systems incur signiicant false-positives and/or
false-negatives,whenusedinthecontextofanIDS,whichmakes
themchallenging to deploy.
ThispaperintroducesARTINALI(AReal-Time-speciicInvari-
ant iNference ALgorIthm) for mining likely invariants through
dynamic analysis in CPS systems, for speciication-based IDSes.
The main innovation in ARTINALI is that it incorporates time as a
irst-classnotionintheminedinvariants,inadditiontothetradi-
tional data and event invariants. This is important for two reasons.
First,mostCPSeshavereal-timeconstraints,andhencetheiropera-
tional correctness depends on both logical correctness, and correct
timing behavior [ 20,41]. Hence, incorporating time is essential for
detecting many common security attacks in these systems. Sec-
ondly,CPSeshavepredictabletimingbehaviorstoairstorderof
approximation, and hence leveraging this predictability leads to
higheraccuracy(i.e.,lowerfalse-positivesandnegatives).However,
incorporatingtimeindynamicinvariantdetectiontechniquesin-
creases the complexity of the learning due to the much larger state
space that needs to be covered. To alleviate this issue, we break
uptheproblemoflearninginvariantsalongthethreedimensions
intoproblemsoflearninginvariantsalongtwodimensions,namely
data-events and events-time, and then combine them into data-
events-timeinvariants. Tothebestofourknowledge,ARTINALIis
the irst dynamic invariant detection system that mines invariants
along the three dimensions of data, event, and time, and uses the
mined invariantsforintrusiondetection .Our contributionsare:
•We designed ARTINALI, an algorithm that generates a
multi-dimensionalmodelforCPSesbymininginvariants
alongthe data,eventandtime dimensions(Section 3).
•We built an ARTINALI-based IDS prototype, and used it
in the context of two emerging CPS systems, namely i)
advanced meteringinfrastructures, and ii) smart artiicial
pancreas (Section 4).
•WeevaluatedtheeicacyofARTINALIfor6targetedat-
tacks on the two systems. We ind that the ARTINALI-
based IDS can detect all 6 attacks, while none of the other
dynamicinvariantdetection systemsdo so(Section 5).
•We also evaluated our ARTINALI-based IDS prototype on
the two systems, and compared it with several existing
state of the art dynamic invariant detection techniques.
Overall, we ind that the ARTINALI-based IDS exhibitssigniicantly lower false-negativesand false-positives for
arbitrary attacks emulated by fault injection, compared
to the other techniques (Section 6). Furthermore,itincurs
about 32% performance overhead, which is comparable to
otherinvariantdetection techniques.
2 BACKGROUND
Weirstsurveyrelatedworkintheareaofdynamicinvariantde-
tectionandhowARTINALIdifersfromthem.Wethenpresenta
motivatingexamplefromsmartmeterstoillustratewhyweneed
data-time-eventinvariantslike the ones generatedbyARTINALI.
2.1 Related Work
Dynamic analysis-based techniques that model the behavior of
software systems can be categorized into four classes, based on the
modelsthattheygenerate:i)datainvariants,ii)eventrelationships,
iii)dataandeventrelationships,andiv)timedependenciesofevents.
Figure1showsthemaindynamicanalysis-basedtechniques,and
where they fall alongthe data,eventandtime axes.
Daikonwastheirstdynamicanalysis-basedtechniquetoderive
(likely) invariants about data value relations [ 14], and falls into the
irstclassoftechniques.Daikoncanbeplacedonthe dataaxisasit
produces a model for data constraints without taking into account
theeventsortimingofthesystem.DySy[ 10],whichusessymbolic
executionto derive invariants, isanotherexample of this class.
Thesecondclasscapturesthesequenceofeventswithinapro-
gam’s execution paths by inferring inite state machines from a
set of traces. Relevant examples include Perracotta [ 44] and Tex-
ada [25], both of which derive temporal logic propositions, and
capturesequencesofeventsbytrackingdynamictraces.Thesetools
fall along the eventaxis since they only capture the constraints on
eventrelations independent of data ortiming information.
Thethirdclassoftechniquesgenerateintegrationmodelsthat
capture the relationship between data and events. For example, the
GK-Tail algorithm merges temporal speciications and data invari-
ants into Extended Finite StateMachine models [ 28]. It represents
sequencesof methodinvocationsthat areannotatedwithdata,and
is hence limited to classifying data invariants that arise among
methodcalls. Quarryinds datainvariantsateachprogrampoint,
and then inds temporal relationshipsbetween the invariants [ 24].
Neithertechniqueconsiderstiming information, however.
The fourth class consists ofa singletechnique,Perfume,which
isa speciication mining tooldesigned for modellingsystemprop-
erties based on resource (time and storage) consumption [ 32]. It
generates an integration model of event relations and their time
constraints.AlthoughPerfumeconsiderstimeasapartofmodel,it
does not considerthe relationship between data andtime.
Overall, none of the current techniques consider the interplay
among time, events and data in formulating invariants, which we
believeis anessential characteristic ofCPSsystems.
2.2 A Motivating Example
We consider an example of a smart electric meter to illustrate why
the existing dynamic analysis-based techniques are often insui-
cientforcapturingthekeypropertiesofaCPSsystem.Wealsouse
this as amotivatingexample to illustrate ARTINALIlater.
350ARTINALI:DynamicInvariant Detectionfor Cyber-PhysicalSystemSecurity ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany
Figure 1:Scope ofdynamic invariantdetection techniques
Weuseanopen-sourcesmartmetercalledSEGMeterasoneof
thetestbedsfor our implementationand our evaluations (seeSec-
tion4.1).SEGMeteriscomposedoftwomaincomponents:themeter
component and a controller. The meter component is in charge of
measuringandcollectingpowerconsumptiondatacomingthrough
its serial ports, and storing them in memory. The controller acts as
thecommunicationbridgebetweenthemeterboardandtheserver,
and is in charge of passing server commands to the meter board,
as well as transmitting power consumption data to the server at
speciic time intervals. The Serial-Talker() function in the con-
troller program of the smart meter is in charge of receiving power
consumption data (at speciic time intervals) and bufering them
for billing calculationpurposes (Luacode showninFigure 2).
Figure 2:Asnippet ofSerial-Talker codefortheSEGMeter
Figure 3 shows the execution path of Serial-Talker() . The
argument seg-data can take two diferent values: aorb, in pre-
determinedtimeintervals.Thesequenceofeventsthatareinvoked
in this function varies based on the value passed in argument
(seg-data ). Ifais passed (line 6 in Figure 2), then the program
emitstheevent send,followedby read.Alternatively,if bispassed
to the function (line 21 in Figure 2), then the program emits events
receiveandwriterespectively.
Weexaminedtheinvariantsinferredbythediferentdynamic
analysis-basedtoolsforthisexample.Daikoninfersthevaluesof
variableseg-data withinSerial-Talker() during normal execu-
tion as the set {a,b}, namelyseg-data:[a,b] . A typical temporal
speciicationminersuchasTexadaidentiiesthelegalsequences
ofevents,e.g., G(send→XF read),whichmeansthatuponevent
sendhappening, it is always followed by event read. The invari-
antinferredbyPerfume (send→receive,0.1,3.6) complementthe
Figure 3:The statechart ofSerial-Talker()
temporal invariant by adding time boundaries between events, i.e.,
send isfollowedbyread within atime intervalof0 .1to 3.6 ms.
Assume that an adversary’s goal would be to perform energy
fraudandlowertheirenergybills.Onepossibleattackwouldbefor
the attacker to tamper with the synchronization between the send
andreceivemodes in the smart meter. As a result, a part of the
energy usage would not be written to the memory bufer which is
used for future energy usage calculations and billing. For instance,
should the value bbe passed to the function instead of a, then it
wouldleadtotheexecutionof receive andwriteinsteadof send
andread; hence the billing information wouldbe incorrect.
None of the above techniques can detect the attack as the in-
correct occurrence of sequences are triggered by legal values of
seg-data occurringatthewrongtime(e.g., seg-data (T1) = b ).
More speciically, Daikon would notice a valid value for seg-data ,
Texada would notice a normal sequence of receive andwrite
events, and Perfume would also observe valid time intervals be-
tweenevents receiveandwritewithintheexecutedpath.Thus,
none of them would detect the attack. Even if all three models
are used jointly, they would still not detect the intrusion, as the
diferent models either capture the legal data values, or the legal
sequence of events with their time diference, but not the interplay
among them.This interplayisessentialfor detecting the attack.
3 APPROACH
Inthissection,weintroducethesecuritymodelthatARTINALIuses,
and we explain its design. We irst deine our multi-dimensional
model and the diferent classes of invariants. Next, we explain how
to relate diferent dimensions to generate real-time data invariants.
Finally,we present the ARTINALIworklowandalgorithm.
3.1 Multi-DimensionalModel
We modelaCPS inthree dimensions,as follows:
Datareferstodatavaluesassignedtothevariablesofaprogram.
Itincludesneitherthetimingofprocesses,northesequenceand
concurrency ofprocesses.
Eventrefersto an actionthata system takes to respondtoan
external stimulus.
Timerefers to real-time constraints, and includes both the con-
straints on physical timing of various operations, and those where
the system must guarantee response within a speciied time frame.
We model the security policy of a CPS by inferring the set of
invariants tobe preservedduringruntime. An invariant,or inter-
changeably a property, is a logical condition that holds true at a
particularsetofprogrampoints.Likeinpriorwork[ 14,25,44],we
usetheterm invariants asashortcutfor likelyinvariants ,whichare
351ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany AliabadiM.,KamathA.A.,Gascon-Samson J. andPatabiramanK.
thepropertiesthatwe observetobetrueaccrossasetofdynamic
executiontraces.Correspondingtothedimensionsdeinedabove,
we deine six major classes of invariants that form the basis of the
CPS model,as follows:
•Data Invariant captures the expected range of values of se-
lected data variables during normal execution of program.
•Event Invariant captures common patterns in the system’s
eventssuch as the order ofthe events’occurrence.
•Time Invariant captures the normal time boundaries (such
as durationorfrequency) ofan event.
•Data per Event( D|E) Invariant captures the temporal re-
lationship between data and events. It allows the IDS to
checkthe validity ofdata invariantsbaseduponevents.
•EventperTime( E|T)Invariant capturestheconstraintsover
eventandtime.Itrepresentstheboundariesoftransition
time from one eventto anotherinan eventsequence.
•Data perTime ( D|T)Invariant captures the relational con-
straints of time and data invariants. It represents the data
invariantas afunctionoftime.
3.2 Data-Event-Time Interplay
In a CPS, an event is deined as an instance of an action that leads
to a change of condition [ 40] (e.g., message send/receive, sensor
datareading,oractivatinginsulininjection).Eventshavethreekey
features.First,theyrelectinteractionsbetweensystemcomponents
andobservationsratherthaninternalstate.Thesecondfeatureis
the notion that events are separated in space and time [ 12,13,
40], and hence, there is no concurrency among event executions.
Moreover, in the case of dependent events (i.e., one event triggers
theother),oncetheirstevent(task)isdone,ittriggerstheexecution
ofthesecondevent.Thirdly,thelocationsinthecodewhereevents
aretriggeredareusually systemcalls thatareaccessiblebyattackers.
Froma security perspective, events are importantas theyplay the
roleofaninputchannelformaliciouscommunicationwiththeCPS.
Forinstance,thosepointsinwhichanewmeasurementisreadfrom
sensors,oractuationcommandsaresenttophysicalcomponents,
are more vulnerable to spooingattacks [15].
Finding a direct relationship between time and data is challeng-
ingfromboththe learninganddetection perspectives.Sincetime
is a continuous phenomenon, we cannot deine a sharp time for
transitions in data values or changing states of the system; instead,
adistributionoftimevalueshastobelearned.Asexecutiontime
variations might be caused by diferences in input sets ordiferent
executionlows,ratherthanmaliciousactivities,theinvariantin-
ferencetechniqueshouldlearnthenormaltimevariationsofthe
system. The IDS also has todistinguish legitimate time variations
from any time deviation that indicates an intrusion.
To overcome thesechallenges,we leveragetheevent-based na-
ture ofa CPS, in whichevery event takes place in an unique time-
frame. We discretize the timeby theevents, and use these for learn-
ing invariants. After doing so, we irst examine the relationship
betweendataandeventdimensionstoproduceinvariantsthatin-
tegrate event information with constraints on data values ( D|E
invariants).Secondly,wediscovertherelationalconstraintsover
time and event dimensions to calculate the physical time bound-
ariesofevents,eitherindependently( timeinvariants),orinrelationtoeachother( E|Tinvariants).Finally,wecombinetheresultofthe
previous steps to infer D|Tinvariants.
Inthefollowingdiscussion,weillustratehowweinferthe D|T
invariantsgiventheconditionalprobabilityofhaving dataDgiven
eventEinvariant ( P(D|E)), and given the conditional probability of
havingeventEgiventimeTinvariant( P(E|T)).
Considering data D, eventEand time Tas random variables,
equation 1 expresses the joint probability distribution of variables
D,EandT.Werewriteittoobtainequation2.Fromthesetwoequa-
tions,wethenderiveequation3,whichexpressestheprobability
ofhaving DandE,givenT.
P(D,E,T)=P(D,E|T)·P(T) (1)
P(D,E,T)=P(D|E,T)·P(E|T)·P(T) (2)
P(D,E|T)=P(D|E,T)·P(E|T) (3)
Using the marginal probability mass function of Dshown in
equation 4,weformalize P(D|T)(theprobabilityofhaving Dgiven
T) in equation 5 as the sum of the probabilities of data Dand event
Ejgiven time Tfor all events Ej, which can then be rewritten as
equation 6(using equation 3).
P(D)=/summationdisplay.1
P(D,Ej),∀Ej (4)
P(D|T)=/summationdisplay.1
P(D,Ej|T),∀Ej (5)
P(D|T)=/summationdisplay.1
P(D|Ej,T)·P(Ej|T),∀Ej (6)
For example, assuming that at time T, eventEjoccurs; and that
uponEjoccurring,thenvariable Dgetsassignedaspeciicvalue.
This implies that Tis the cause of Ej, and that Dis the efect of
Ej. Thus, variable Disconditionally independent of time variable
Tgiven event Ej. Consequently, DandTare conditionally inde-
pendent, and P(D|Ej,T)=P(D|Ej). Hence, we can simplify the
formulation of P(D|T)as follows:
P(D|T)=/summationdisplay.1
P(D|Ej)·P(Ej|T),∀Ej (7)
According to the event-based semantics of CPS,any givenevent
takesplaceinauniquetimeframe.Thisimpliesthattwoormore
events cannot take place at the same time T; i.e.,P(Ej|T)>0⇒
P(Ei|T)=0,∀Ei/nequalEj. Given this assumption, we irst rewrite
equation 7 to obtain equation 8. Then, we simplify it to obtain
equation 9, which captures the relationship between data Dand
timeTbyexploitingtherelationalconstraintsofbothdataandtime
over thesameevent Ejwhichtakes placeat time T.
P(D|T)=P(D|E=Ej)·P(E=Ej|T)+ (8)
/summationdisplay.1
P(D|Ei)·P(Ei|T),∀Ei/nequalEj
P(D|T)=P(D|E=Ej)·P(E=Ej|T) (9)
Inotherwords, foragivenevent Ej,aD|Tinvariantholdstrue(i.e.,
happenswithahighprobability)ifandonlyifboththecorresponding
D|Einvariantand E|Tinvariantholdtrue.
3.3 ARTINALI Worklow
ARTINALI is a dynamic analysis-based technique that generates
modelsofdynamicsystembehavior,andproposesamulti-dimensional
352ARTINALI:DynamicInvariant Detectionfor Cyber-PhysicalSystemSecurity ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany
modelbasedonthedesignconceptsintroducedintheprevioussec-
tion.Figure 4showsthe key blocksofARTINALI’s worklow.
Figure 4:Worklow ofARTINALI
In order to generate logs for mining invariants, we manually
instrument events and their associated data variables1. We assume
that CPS source code is available, and that it can be modiied to
instrumentevents-thisisreasonableasweenvisionourtechnique
tobeusedbyCPSdevelopers(ifnot,onecanuseabinaryinstru-
mentationengine).Inourtechnique,eventsaresystemcalls.Hence,
we capture all system calls as events. However, the user can op-
tionallyprune the space ofevents by specifying only the important
systemcallsbasedonthesystem’srequirements.Weinstrumentthe
events’programlocationsbyinsertingcallstothe ARTINALIAPI
functions thatwedevelopedforcollectinglogs,beforeandafterthe
event.Duringtheattack-freeruntimeexecutions,thesefunctions
collectdataandtimeinformationassociatedwiththeinstrumented
eventsinseparatelogiles(namely DElogsandTElogs).Thelogged
information isusedas the basisfor mininginvariants.
Block 1. ARTINALI D|EMinerThe ARTINALI D|EMiner
learnsinvariantsaboutthevariablevalues,andhowthesevalues
relatetoaparticulareventinthesystemusingathree-stepprocess.
First,theD|EMinertakestheloggedinformation,andgroupsthem
within each trace into distinct classes labeled with the events. It
thenmergesclassesacross DElogs.Second,withineachclass,using
the Frequent Item Set mining algorithm [ 17], it merges the data
variableswhilecalculatingthelevelofthe conidence andsupport
for every variable. Asinprior work[ 14],supportisthefraction of
tracesinwhichthevariable xwithinclass Ejisseen,and conidence
is the fraction of supported classes, where variable xis assigned to
the same value(s).
Finally, the D|EMiner infers the data invariants associated with
eachclass(event). D|Einvariantsaremulti-propositionaldatain-
variants as they all hold true within the same observed event
(at the same time). The D|Einvariants are stated in the form of
(Ei:d1=[],d2=[],...dn=[]), whereEidenotes the name
of(i)thevent, and d1−dndenote the range of concrete values
ofndata variables mapping to the event Ei. For the example in
Section 2.2, the invariant receive: seg-data=false, command=nil, sta-
tus=[nil, time-out], len.partial >0represents the data invariants that
are valid duringthe event receive,andishence a D|Einvariant.
1Thisissimilartowhatalmostallotherinvariantdetectiontechniquesdo,withthe
exception of DAIKON, whichhas anautomated instrumentation engine.Table 1:E |Tand D|TInvariant Types
E|T InvariantType
TypeI Ei(t)⇌Ei(t+1
Freqi)
TypeII Ej⇌Ei:∆tjimax,∆tjimin
TypeIII Ei:∆timax,∆timin
D|T InvariantType
TypeI dm(Ti≤t≤Tj)=[]
TypeII dm=[]⇌dn=[]:∆tjimax,∆tjimin
Block2. ARTINALI E|TMinerARTINALI’s E|TMiner infers
theE|Tinvariants in four steps. First, it creates all consecutive
event pairs within one trace annotated with their time diferences.
Second, it groups the pair of events that are labeled with the same
pair name. Third, ARTINALI’s E |T Miner looks for the pair-wise
events that are observed in the same order within TE logs, and
calculatestheirsupport.Finally,itmergesthetimevariableswithin
each class to calculate the time boundaries of the paired events,
aswellasthefrequencyandtheaveragedurationofeveryevent
execution. The E |T invariants are classiied into three types, as
showninTable1.TypeIindicatesthatevent Eiisrepeatedevery
1
Freqiseconds.TypeIIindicatesthatthepairofevents EiandEjare
repeatedinalltracesinthesameorder,andtheirtimediference
is bounded within ∆tjimaxand∆tjimin. Type III indicates the
maximumandminimumdurationofevent Ei.Fortheexamplein
Section2.2, send(t)⇌send(t+60)showingthefrequencyof send
occurrences in the system, and the invariant send⇌receive :
14.3,1.5representingthetimeboundary(between1.5and14.3)and
thelogicalorderingoftheevents(i.e.,sendbeforereceive),areboth
examples of E|Tinvariants.
Block3.ARTINALI D|TMinerAccording to the formulation
describedfor D|Tinvariants,ARTINALIcombinestheoutputsof
D|EandE|Tminers to generate the real-time data invariants (D |T
invariants).Wedeinetwotypesofdatainvariants(Table1),and
we explaineachtype using the example inSection 2.2.
TypeIrepresentsthedistributionofvaliddatavaluesofvariable
dmwithintimeslot Ti≤t≤Tj.Forexample, seg-data (T1≤t≤
T2)=ameansthattheonlyvalidvalueofvariable seg-data isa
during the time interval T1≤t≤T2. Note that we difer here from
Daikondatainvariants(e.g. seg-data=a,b ),astheyonlyexpress
the valid valuesofdata invariantswithoutconsidering the time.
Type II captures the relationship of data invariants between two
consecutive events. As explained in previous section, every two
consecutiveeventshaveaboundedtimediference( Ti+∆tjimin≤
Tj≤Ti+∆tjimax).As a result, the data invariantsassociatedwith
thoseeventshavethesametimediference.Inotherwords,datain-
variantdj=[]holds true untildata invariant di=[]becomes true,
while∆tjimaxand∆tjiminspeciiesthetimediferenceboundaries
between thosedatainvariants. In the previous example(Figure 3),
ARTINALI D|TMinergeneratesoneinvariantofthistype,asfol-
lows:seg-data=a⇌seg-data=b: 14.3,1.5; i.e.,seg-data=a
holds true untilseg-data is assigned value b, in a time interval
ranging between1 .5and14.3seconds.
Block4.IDS Prototype As explained in the previoussections,
theARTINALIMinersderivethreeclassesofinvariantsthatcom-
prisetheinalCPSmodel.TheCPSmodelisusedasaninputtoour
353ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany AliabadiM.,KamathA.A.,Gascon-Samson J. andPatabiramanK.
IDS prototypefor monitoringattacks.OurIDS prototypeconsists
oftwocomponents: the Tracingmodule andtheIntrusiondetector .
The tracing module is in charge of collecting the required infor-
mationfromtheprogram’sexecutionandloggingit.Thismodule
is the same as the ARTINALI Logger that instruments the code
andcollectslogs, but with thediference thatit is deployed onthe
production system. The collected information is fed to the intru-
sion detector,whichperiodicallyprocesses the logileandchecks
itagainst the invariantsderivedfrom the CPS model.
4 EXPERIMENTALSETUP
This section irst presents the details of two CPSes, and then the
experimental procedure for evaluating the IDS on the two plat-
forms. Finally, it presents the attack models that we considered for
evaluation, followedbythe evaluation metrics.
4.1 CPSPlatforms
WechosetwoCPSplatformsascasestudiestoevaluatetheeicacy
of the invariants generated by ARTINALI and the other tools. Note
that unlike generic applications, there are few publicly available
open-sourceCPSplatformsthatarealsosecurity-critical.Further-
more, there is a signiicant amount of efort involved in setting up
aCPSplatformandgeneratingexecutiontracesfromit.Sowelimit
ourselves to 2CPS platformsinthe paper.
Advanced Metering Infrastructure (AMI) : Advanced Me-
tering Infrastructure (AMI) systems are deployed on smart electric
powergrids.SmartmetersarekeycomponentsofAMIthatprovide
a two-way communication with the utility provider[ 35]. The large
scaledeploymentofsmartmetersandthediscoveryofmanyvul-
nerabilitiesinthesesystems[ 38,43],makethemgoodcandidates
to evaluate ourwork. Agenericsmart meteriscomposedoftwo
main components, namely the meter and the controller. The me-
tercomponentreceivespowerconsumptiondatathroughanalog
frontendsensors,andstorestheminthememory.Thecontroller
component is the communication bridge between the meter and
theutilityprovider’sserver,passingservercommandstotheme-
ter, and sending consumption data back to the server at speciic
timeintervals(moredetailsin[ 38]).WeuseSEGMeter[ 1],anopen
source smart meter to evaluate our IDS prototype. SEGMeter is
implemented using the Lua language, and consists of 2500 lines of
code (excluding libraries).
SmartArtiicialPancreas(SAP): Diabeticpatientsaremigrat-
ingfromthetraditionalglucosemeterandmanualinsulininjection
systemstocontinuousglucosemonitoringandautonomousinsulin
delivery devices [ 27], which are referred to as Smart Artiicial Pan-
creas(SAP) .SinceattackstoaSAPcanthreatenthepatient’slife,
thesesystemsarehighlysecurity-critical[34].Hence,weselected
SAP as our second case study to evaluate ARTINALI. The main
buildingblocksofagenericSAPareaContinuousGlucoseMonitor
(CGM), an insulinpump, and acontroller.The CGM samples the
patient’sbloodglucose(BG)levelsonaregularbasisandsendsit
to the controller. The insulin pump is a wearable medical device
that is used for automatic injection of insulin through subcuta-
neous infusion. The controller controls the closed loopin the SAP.
It receives the measured BG from CGM, and issues the suitable
actuationcommandforcorrectingthesugarlevel.WeusedOpenArtiicial Pancreas System (OpenAPS) [ 26], an open source SAP,
asasecondusecasetoevaluateourIDSprototype.OpenAPSim-
plements the controller component of an SAP in JavaScript, and
consists of 2000 lines of code (excluding libraries). We simulated a
simpleCGMandaninsulinpumptoclosetheloop,aswedidnot
haveaccesstoapatientwitharealinsulinpumpandglucosemeter.
OpenAPSprovidesasetoftestcasesthattakediferentBGvaluesas
input and process them for calculating basal rate of insulin, which
we use as abaselinefor our experiments.
4.2 ExperimentalProcedure
Figure 5 shows the overall procedure that we follow. In addition
togeneratingtheCPSmodelusing ARTINALI,we generatethree
othermodels (invariantssets)usingDaikon, Texada, andPerfume
for comparison purposes. We have made ARTINALI publicly avail-
able [4]. We downloaded the latest versions of these tools from
theirrespectivewebsites[ 2,3,5].Wedonotruntheinstrumenta-
tionfront-end ofDaikon (i.e., Kvasir), asour goal was togenerate
data invariants based on the event traces we logged. We choose
these three tools to represent the irst, second and fourth classes of
invariants as described in Section 2. We do not choose the tools in
thethirdcategory,namelyGK-tailandQuarry,asweuseDaikonto
ind data invariants for the events that we identiied in the system.
Therefore,theinvariantsgeneratedbyDaikoncoverthethirdclass
ofinvariantsinour experiments (i.e., D|Einvariants).
Thereare22systemcallsinSEGMeter’scode,and4systemcalls
intheOpenAPScode.Weconsiderallofthemasevents.Tables2
and 3 present the types of invariants and the number of invariants
generated by the three tools and ARTINALI for the SEGMeter
andOpenAPSplatformsrespectively.Ascanbeseen,ARTINALI
generates invariants in the Time, D|E,E|T, andD|Tcategories,
while DAIKON, Texada and Perfume only generate invariants in
theD|E,Eventand E|Tcategoriesrespectively.
Because the format of the invariants generated by these other
tools may be diferent from that expected by our IDS, we wrote
scripts to convert the invariants to be in the format expected by
theIDSinterface.ARTINALIdirectlygeneratedinvariantsinthe
properformat.Incaseatooldidnotgenerateacertainkindofin-
variant(e.g., D|E),weleavethatinvariantileblank.Thegenerated
invariant sets are all fed into the IDS as inputs, and their eicacy is
evaluatedondiferentplatforms.
We divide the experiment into a training phase and a testing
phaseforeachsystem.Weirstobtainexecutiontracesfromthetwo
platformsundernormaloperation,andrandomlydividethemintoa
setoftrainingtraces( train)andtestingtraces( test).Wethenchoose
diferenttrainingsetsizesforeachinvariantdetectionsystemto
optimize the false positive (FP) and false negative (FN) ratios for
that system. Finally, we evaluate the FP ratios of the invariants
using the testtraces, and the FN ratios using the attack models
describedinthe nextsection.
TheIDSisimplementedinPython,andconsistsofabout1000
lines of code. Since the IDS is run on the CPS platform, which is
oftenresourceconstrained,itisimportanttominimizeitsoverheads.
WemeasuretheIDS’stimeandspaceoverheadfortheSEGMeter
platform in Section 6. Because we run the OpenAPS platform in
354ARTINALI:DynamicInvariant Detectionfor Cyber-PhysicalSystemSecurity ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany
Figure 5:Overallexperimentalprocess ofrunningtheIDS
Table 2: Types and number of inferred invariants for SEG-
Meter across tools
Event TimeD|EE|TD|T
Daikon - -24--
Texada 158 ----
Perfume - --158-
ARTINALI -12243724
Table 3: Type and number of inferred invariants for Ope-
nAPS across tools
Event TimeD|EE|TD|T
Daikon - -22--
Texada 57 ----
Perfume - --57-
ARTINALI - 422187
asimulator,aswedidnothaveaccesstoitshardware,wedonot
measure the IDSoverheadsonOpenAPS.
4.3 AttackModels
Traditionally, security techniques are evaluated using a small num-
ber of targeted (hand-crafted) attacks. Unfortunately, this is not
suicientforCPSsystemsforthreereasons.First,CPSesarenew
systems for which there are few real attacks - hence they need
protection from zero-day or unknown attacks. This is especially
the casefor security-criticalCPSes suchassmartmedical devices.
Secondly, unlikegeneral computersystems,CPSescanbe diicult
toupgradeandpatchfrequently.Thirdly,thereisnostandardset
ofattacksonCPSesunlikegeneral-purposecomputersystems,so
wewouldhavetohand-craftindividualattacksonthesesystems,
whichwouldpotentiallyintroduce biasinthe evaluation.
TargetedAttacks To evaluate our IDSs against known attacks,
weusethreeattacksforeachsystemthatwediscoveredbasedon
manual analysisofthe CPS (Section 5).
ArbitraryAttacks Weusefaultinjection(i.e.,mutationtesting)
to emulate arbitrary attacks. Fault injection has been used to study
the efects of attacks in previous work [ 38]. Note that these are not
complete attacks, but rather form the building blocks of attacks.
We deploy diferent types of mutation in the program’s code, as
follows.
•Datamutations ,whichchangetheruntimevaluesofdata
variables inthe code;
•Branchlipping ,whichchangethenormalexecutionlow
ofthe program bylipping branchconditions;Table 4: The number of mutations in each attack category
forSEGMeterandOpenAPS.
CPS Attack category
Data mutation Branch lip Artiicial delay
SEGMeter 35 76 45
OpenAPS 100 10 15
•Artiicial delay insertion ,which modifythe normal timing
behaviorofthe program.
Eachoftheabovecategoriesemulatediferentsecurityissues.By
performing data mutations, an attacker can change critical data in
the program to their advantage. Such attacks can be accomplished
byexploitingmemorycorruptionvulnerabilitiesorraceconditions
intheprogram.Likewise,branchlippingcanleadtoillegitimate
controllowpathsbeingtakenintheprogram,toaccomplishthe
attacker’s ends. Such attacks can occur due to code injection or
sematic vulnerabilities. Finally, artiicial delays can allow attackers
to change the timing of the system’s actions, and delay essential
functions,orcauseotherfunctionalitytobesuppressed,againto
their advantage.Through these mutations,we canemulate a wide
varietyofattacks,withoutapredeinedtarget,thusavoidingbias
andallowing modelling of hitherto unknownattacks.
Table 4 presents the number of mutations performed in each
categoryforSEGMeterandOpenAPS.Wemanuallyseededeach
of these mutations in the source code of the respective systems,
by randomly sampling the corresponding program points in the
program’scode.Whilethiscouldhavebeenautomatedbyafault
injectiontool(e.g.,LLFI[ 6]),thelanguagesinwhichthetwosystems
were implemented, JavaScript and Lua, were not supported by
existingtools.Therefore,wehadtoperformmutationsmanually.
However, we attempted to choose the program points randomly
before performingthe experiment toavoidbiasingour evaluation.
After mutatingthe code,we can observe one of fouroutcomes.
•Crash,inwhichthe program isaborted(exception);
•Hang,inwhichtheprogramgoesintoanininiteloopor
deadlocks;
•SDC (Silent Data Corruption) , in which the outcome of the
program isdiferentfrom afault-free execution;
•Nocorruption ,inwhichtheoutcomeoftheprogramdoes
notshowanyobservableimpactwithrespecttofaultmask-
ingornon-triggeringfaults.Internalstatesmighthowever
be corrupted.
Note that in the context of this paper, we are interested only in
SDCandNo corruption outcomes, as the CrashandHangoutcomes
can easily be detected without an IDS. Therefore, we only present
theresultsforthefault-injectionexperimentsthatresultedinthe
SDCandNo corruption outcomes, and which need an IDS (these
compriseabout75%ofthe outcomes onaverage).
4.4 EvaluationMetrics
Accuracy: We use three metrics to measure the efectiveness of
our IDSfrom the accuracypointof view.
•False Negative ratio (FN) , which is the ratio of attacks that
were undetected by the IDS to the total number of attacks;
355ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany AliabadiM.,KamathA.A.,Gascon-Samson J. andPatabiramanK.
•False Positive ratio (FP) , which is the ratio of execution
traces that were (incorrectly) reported as attacks to the
totalnumber ofnormal traces;
•F-Score(β), whichis acomputation ofthe harmonic mean
ofthe true positive ratio(TP), FPandFN.
Thevariationsoftheargument βinF-Score( β)allowustoweigh
the above metrics diferently [ 37], and obtain diferent trade-of
between FP and FN ratios based on the system requirements. A
valueofβ>1weighsFNshigher,whileavalueof β<1weighsFPs
higher.Avalueof β=1weighsthembothequally.Wehypothesize
that FPs are more important in smart meters, as a false-alarm leads
toaddedcosttotheutilityproviderwhoneedstodeployservice
personnel to investigate the false alarm. An occasional FN may be
acceptable in smart meters as the consequence is only a loss of
revenue. In the OpenAPS, on the other hand, even a single FN can
be fatal to the patient, while a FP may be acceptable if there are
other checks in place to ilter out FPs (e.g., patient intervention).
Hence, for SEGMeter, we select F-Score(0.5), and for OpenAPS, we
choose F-score(2)as our reference metric.
Overheads: In addition to the accuracy, we also measure the
memory andperformance overheadsofthe IDS.
Memory overhead is deined as the actual memory usage of the
IDS. It depends on the size of IDS, the number of invariants that
accountfortheCPSmodel,andthecomplexityofinvariants(e.g.,
theinvariant Ej⇌Ei:∆tjimax,∆tjimincarriesmoreinformation
thanthe invariant Ej⇌Ei,andishence more complex).
Performanceoverheadistheincreaseinexecutiontimeasaresult
of running the CPS on the target platform. This metric relects the
overheadofboththe tracingmodule andtheintrusiondetector .Since
CPSesruncontinuouslyforlongperiodsoftime,wemeasurethe
performance overhead per cycle, where a cycle refers to one full
execution of the main loop of the CPS (both the SEGmeter and
OpenAPS consist ofasinglemain loopthat runscontinuously).
5 TARGETEDATTACKS
Inthissection,wediscussthepotentialtargetedattacksandhowwe
derivethemforbothplatforms.WethenevaluatetheIDSseeded
by ARTINALI and other tools against the attacks. Note that we
used attack trees based on prior attacks against similar systems to
generatetheattackstominimizebiasandmodelrealisticattacks.
WefoundthatARTINALIwasabletodetectalltheattacks,while
none of the other tools do. This is because all the attacks involved
violations ofthe interplayamong data,events,andtime.
5.1 AMI Attacks
Energy fraud is a major class of AMI attacks, and can result in
Power Consumption Data(PCD) loss and improper billing [ 29]. We
cameupwithanattacktreeforenergyfraudinAMI(showninFig-
ure6),basedonattacksintroducedinpreviouswork[ 29,35,39,43].
There are three major branches in this tree, namely i) Measure-
menttampering,ii)Storagetampering,andiii)Networktampering.
Correspondingtoeachbranch,wedevelopedtheconcreteattack
actions as the leaves ofthe tree as follows.
SynchronizationTampering(Blocks A1−A4)occurs due to
modiication of the time of sendandreceivemodes in AMI. We
found that the communication between the AMI and the server
Figure 6:Attack tree forAMI
Table5:ARTINALIinvariantstodetecttheexampleattacks
inAMI.
Attack Detecting Invariant
Synchronization (1)send (T0+K ·60)⇌send (T0+(K+1) ·60),
tampering ∀k≥0
Message dropping (2)recv(T1)⇌recv(T1+1)
Meterspooing (3)node-name(T0+N ·60) =NodeB, ∀N≥0
issynchronizedbyavulnerablefunction( get-data-timer() )inthe
controller unit. The controller frequently checks the time with the
sever to decide when to request for data measured by the meter. If
a malicioususer modiies the timeonthe server, thecontroller will
not receive data in the expected time, which leads to data loss, and
improper calculationofinal PCD.
Meter Spooing(Blocks B1−B5):Inasmartgrid,AMIscom-
municatewiththeserverusingauniquenameorID.Thecontroller
unit is able to be connected to more than one meter, collects the
PCDs,andsendthemalongwiththemeter’sIDtotheserver.As
thecontrollercannotdiferentiatebetweennormalandabnormal
messages,itcanbetrickedbyfalsiiedinputssentbyanattacker
instead of the meter. This attack is called meter spooing attack . We
found that spooing themeter only requires the meter’s ID that is
printedonthe meter’snameplate.
MessageDropping(Blocks C1−C5):Anattackermaybeable
todropthemessages(i.e.,apartofenergyusage)afterbypassing
themeterandremoving theloggedPCDhistory.Asimple wayto
mountthisattackistointerceptthecommunicationbetweenthe
meterandthecontroller,andcontrolwhattraictoblockandwhat
to pass through (e.g., through a irewall). Hence, the blocked traic
wouldnot be includedinPCD calculations.
5.2 DetectionofAMI Attacks
WerantheARTINALI-basedIDSontheexampleattacks,andfound
that it detected all of them. Table 5 indicates the important in-
variants that are derived by ARTINALI, which detect the attacks
presentedinthe previous section.
Synchronization Tampering As synchronization tampering
attackmodiiesthetimingof sendandreceiveoperationsofSEGMe-
ter, we picked events sendandreceiveas relevant events to explain
this attack. We can see in row 1 of Table 5 that the ARTINALI
invariant captures the sequence of these events during normal op-
eration, i.e., sendoperation happens every 60 seconds, and receive
356ARTINALI:DynamicInvariant Detectionfor Cyber-PhysicalSystemSecurity ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany
Figure 7:Attacktree forSAP
isrepeatedevery1second.Thus,thisinvariantdetectstheattack
as the timing ofthe eventsisviolatedbythe attack.
MessageDropping Ifweassumetheattackerdropsoneormore
messages frommeter,the droppedmessages willnot be receivedat
the expected time slots by the controller. As a result, the frequency
of receiving messages in controller will change. This attack breaks
the invariant number (2) in Table 5, which represents the time
frequencyofreceivefunctionwhichis1003milliseconds( /simequal1sec)
within one full executionpath.Thus this attackisalsodetected.
Meter Spooing To detect meter spooing attack, we selected
tworeceiveevents (recvAandrecvB) from two diferent meters
(nodeAand node B) that are connected to the same controller, and
analyzedtherespectiveinvariants.Forexample, nodeName(T0+N*60)
= Node B, ∀N≥0 speciies that the valid value of nodeName at
T0+N∗60 isNode B. If the identity of node Ais stolen by node B,
it sends its messages every 60 seconds under the name nodeA. As a
result, variable nodeName attached to event recvB, becomes nodeA.
Thus, the invariantnumber (3) inTable5isviolated.
5.3 SAP Attacks
DiabeticTherapyTampering isoneofthehighestseveritythreats
forpatients,asitcanresultindeathorseverehealthcomplications.
We developed an attack tree for diabetic therapy tampering based
onpubliclyavailablereportsofattacksonSAPs[ 27,34],inFigure7.
We considerthree classesofattacksbasedonthe tree.
CGM SpooingAttack (Blocks A1−A4)injects false into the
communication channelbetween CGM and controller making the
controller think that the glucose level is either higher or lower
thanitactuallyis.TherearetwowaysthatCGMspooingcanbe
accomplished.First,ifthesensordataformatisunknown,thena
replay attack can be used. In this case, a sensor value read in the
pastcanbere-sent(e.g.,byaRFmodule[ 27])tothecontroller.This
would cause the controller unit to indicate an outdated glucose
level rather than the actual one. Second, if the format of sensor
dataisknowntohacker,shecansendthefalsedataatrandomtime
intervals to mislead the controller.
Basal Tampering (Blocks B1−B5)The basal tampering at-
tack may be accomplished in two diferent scenarios. The attacker
may issue a command for i) stopping the basal injection (e.g.,
basal.rate=0) when it is required for patient, or ii) resume the
basal injection ( basal.rate>0) when it has to be stopped. These
attacks may be mounted using a software radio board that fullyTable 6: ARTINALI invariants to detect example attacks in
OpenAPS.
Attack Detecting invariant
CGMspooing (1)read (t)⇌read (t+5)
Stop (2)(120≤BG≤485)⇌
basalinjection (0.9≤basal.rate ≤3.5): 1.99,0.464
Resume (3)BG≤75⇌basal.rate=0
basalinjection : 1.99,0.464
controlstheSAP[ 27,34],andtransmitsthemaliciouscommands
to the pump. To accomplish the attack, the attacker needs to spoof
thePINnumberofthecontroller,andtheformatoftransmission
packets- both ofthesecan be done byan eavesdroppingattack.
5.4 DetectionofExample Attacksin SAP
WemountedtheattackexamplesontheSAPsystemweconsidered
(i.e., OpenAPS), and found that the ARTINALI-based IDS is able
todetectallofthem.TherearefoureventsintheSAP,namely1)
send(BG) orsendingbloodglucosebyCGM,2) read(BG) orreading
BG by the controller , 3) send(basal.rate) or sending basal rate to
pump by the controller, and 4) recv(basal.rate) or receiving basal
rate by pump. We used these events as the basis for mining 51
invariants for OpenAPS’s IDS model. Due to space constraints, we
donotpresentallinferredinvariants,butonlythosethatdetectthe
example attacks(Table6).
CGM Spooing Attack We selected read(BG) in controller as
the relevant event, and analyzed the inferred invariants for this
eventtoanalyzeCGMspooingattack.Undernormalconditions,
thetransmissionofmeasuredBloodGlucose(BG)toCGMoccursat
deterministic,periodictimes(e.g.,everyiveminutes).Thisproperty
is represented in our model as time frequency of event read(BG),
thatisread(t)⇌read(t+5).Usingtheaboveproperty,itwouldbe
possibletodetectmalicioussensorreadingfromanyexternalsource
that performs replay attack or transmits wrong data at random
time intervals to the controller as the frequency of reading data by
controllerwouldchange.
Basal Tampering Attack As previously explained, the basal
tampering attack may be accomplished in two diferent scenarios:
i) stopbasal injection ( basal.rate=0) when it is required,and ii)
resume basal injection ( basal.rate>0) when it is not required.
These attacks break the invariants shown in Table 6. The invariant
number (2) indicates that if BGis higher than the normal range,
the patient needs insulin (i.e., basal.rate>0). However, the stop
insulin injection attack makes the basal.ratevalue to be 0, which
breaks invariant number (2). Similarly, the invariant number (3) in
Table 6 shows that for low BG ranges (e.g., BG=45), the patient
doesnotneedinsulin(i.e, basal.ratemustbe0),but resumebasal
injectionattack sends a command ( basal.rate>0) to the SAP to
injectinsulin. As aresult, invariantnumber (3) isviolated.
6 EVALUATION
Inthissection,wepresenttheresultsofthefaultinjectionexperi-
mentstoemulatearbitraryattacks,andtheoverheadmeasurements.
Weirstpresenttheresearchquestions(RQs)weask.Wethenad-
dresseachofthe RQsinaseparate sub-section.
357ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany AliabadiM.,KamathA.A.,Gascon-Samson J. andPatabiramanK.
6.1 Research Questions(RQs)
RQ1.How do we choose the training set size to obtain the
bestF-Score( β) for eachtool?
RQ2.What is the FN ratio incurred by the IDS using the
invariantsderivedbyARTINALIandthe othertools?
RQ3.What is the FP ratio incurred by the IDS using the
invariantsderivedbyARTINALIandthe othertools?
RQ4.WhatisthememoryoverheadoftheIDSwhenusing
the invariantsderivedbyARTINALIandthe othertools?
RQ5.WhatistheIDSperformanceoverheadwhenusingthe
invariantsderivedbyARTINALIandthe othertools?
6.2 RQ1. F-Score
As mentioned in Section 4, we obtain two setsof tracesfrom each
system,namely trainandtest.InthisRQ,weaskwhatshouldbethe
optimal trainingsetsize foreachsysteminorder to maximizethe
correspondingF-Score values.Toanswer thisquestion,we obtain
a total of 40 training traces, and 50 test traces for each system. We
then vary the training set size from 5 to 40, in increments of 5. We
then run each of the invariant detection tools including ARTINALI
on the same training set to derive invariants. We then measure the
FP, FN, and F-Score values (0 .5,1,2) for each invariant detection
toolandsystem,as afunctionofthe training setsize.
Figures 8 and 9 show the distribution of the amount of false
positives (FP), false negatives (FN) and the F-Score computed with
β=0.5,1,2inrelationtotheamountoftrainingtraces,respectively
for SEGMeter and OpenAPS, corresponding to each of the four
invariant detection tools, including ARTINALI. As expected, as the
amountoftrainingtraces increases,the FPratiodecreases,since
a broader set of invariants are extracted; thus a lower amount of
legitimateactionsarelaggedaspotentialattacks.Aconsequenceis
thatmoreattacksareundetected(FNincreases),asamorerestricted
setofinvariantscanleadtosomeattacksbeingundetected.Overall,
an increase in the amount of training traces lead to an increase
oftheF-Scoreatirst,thenitstabilizes,atwhichpointan optimal
amountoftrainingtraceshavebeenfound(foragivenvaluesof β).
Tables 7 and 8 show the optimal amount of training traces (opti-
malF-Score)foreachinvariantdetectiontool,forSEGMeterand
OpenAPS respectively. Recall that we choose F-Score(0.5) for SEG-
MeterandF-Score(2)forOpenAPS,andhencethesearetheF-score
values we chooseforthe optimalnumberof traces.Forexample,in
SEGMeter,atrainingsetsizeof20resultsinthemaximumvalue
of the F-Score(0.5) value of ARTINALI, whereas for OpenAPS, a
training set size of 15 results in the maximum value of F-Score(0.5).
Likewise,wecomputetheoptimaltrainingsetsizesforthethree
other tools on both platforms. These are the values of the training
set sizes we use for deriving the invariants for each tool in the
rest of this section. In other words, we ind the best coniguration
of each tool on each platform, and generate invariants using this
conigurationforcomparingthecorrespondingIDSes.
6.3 RQ2. FalseNegatives
Inthissection,wecomparethevariationintheFNratioincurred
by the IDS, using invariants extracted by ARTINALI and the other
tools. Tables 7 and 8 also show the FN ratios for each tool for
the SEGMeter and OpenAPS systems respectively. We observe thatTable7:OptimaltrainingsetsizeformaximumF-Score(0.5)
forSEGMeteracross tools,and the FPand FNratios.
Daikon Texada Perfume ARTINALI
F-Score(0.5) 0.721 0.78 0.813 0.898
Num oftraces 30 30 35 20
FP (%) 23 15 15 12
FN (%) 57 60 38 2.3
Table 8: Optimal training set size for maximum F-Score(2)
forOpenAPSacross tools,and the FPand FNratios.
Daikon Texada Perfume ARTINALI
F-Score(2) 0.604 0.62 0.686 0.952
Num oftraces 30 20 15 15
FP (%) 21 16 22 13.5
FN (%) 61 61 39 2
overall,ARTINALIwasabletodetectaround97.5%ofattacks,which
meansithasanaverageFNratioof2.5%.Incontrast,inPerfume,
Texada and Daikon the FN ratio was respectively 38.5%, 60.5% and
59%onaverage,acrossthetwoplatforms. Thus,theARTINALI-based
IDSreducestheratiooffalsenegativesby89to95%(average93.4%)
over otherdynamic invariantdetectiontools.
Figure 10 and Figure 11 illustrate the FN ratio of the IDS for the
threecategoryofattacks(codemutations),aswellastheaggregated
FN ratio,for eachtool,inboth SEGMeter andOpenAPS.
DataMutations: ARTINALIexhibitsthelowestFNratefordata
mutations(2to3%). ThisisfollowedbyDaikon,whichprovides a
muchlowerFNratioin datamutation attacks(15%inSEGMEeter
and17%inOpenAPS)thanPerfume(53%inSEGMEeterand78%in
OpenAPS)andTexada(52%inSEGMEeterand87%inOpenAPS).
This is because DAIKON focuses on data invariants, while Texada
andPerfumedonotincludedatainvariantsintheirmodel.How-
ever, the Daikon data model does not include other properties like
ARTINALIdoes, resultinginmuchhigher FNsthanARTINALI.
BranchFlipping: Among the other three tools, ARTINALI has
thelowestFNrateforbranchlippingattacks(1%).Perfume,Tex-
adaandARTINALIexhibitalowerFNratiocomparedtoDaikon
forbranchlippingattacks.As theseattacksimpact theorderand
sequence oftheeventsinan executioninstance, andDaikon does
not have eventinvariants, itshowsless sensitivity.
Artiicial Delay: Again, ARTINALI has a much lower FN ratio
(2-3%)thanallthreetoolsforartiicialdelayattacks,followedby
Perfume. This is because they both include time in their model.
Nevertheless,DaikonandTexadaarestillabletodetectattacksthat
impact data variables oralterthe executionlowof the program.
Overall,theresultssupportourhypothesisthatamorecomprehen-
siveinvariantmodel,suchasARTINALI,whichcanindinvariants
andtheirconstraintsalongthreedimensions,candetectasigniicantly
larger amount ofattacks (and hence has fewer FNs).
6.4 RQ3. FalsePositives
In this section, we compare the FP ratio incurred by our IDS when
usingtheinvariantsderivedbyARTINALIagainsttheinvariants
generated by the other tools (Daikon, Perfume and Texada). The
results are shown in Table 7 and 8 for the SEGMeter and OpenAPS
358ARTINALI:DynamicInvariant Detectionfor Cyber-PhysicalSystemSecurity ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany
Figure 8: FN, FP and F-Score variations based on number of training traces for SEGMeter across tools; (a) Daikon, (b) Texada,
(c) Perfumeand(d)ARTINALI. X-axisisthetraining set size.
Figure 9: FN, FP and F-Score variations based on number of training traces for OpenAPS across tools; (a) Daikon, (b) Texada,
(c) Perfumeand(d)ARTINALI. X-axisisthetraining set size.
Figure 10: FN(%) of IDS for SEGMeter for diferent attack
typesacross thetools.Errorbars areshownforthe 95%con-
idence interval.
Figure 11: FN(%) of IDS for OpenAPS for diferent attack
typesacross thetools.Errorbars areshownforthe 95%con-
idence interval.systemsrespectively.WecanobservethatinbothCPSes,theuseof
theARTINALI-generated invariants lead to signiicantlyless false
positives comparedto theinvariantsgenerated bytheothertools.
Moreprecisely,ARTINALIprovidesa20%to48%improvementof
the FP ratio for SEGMeter, a 16% to 39% improvement of the FP
ratioforOpenAPS,andaveragely30.75%improvementoftheFP
ratiofor both platforms over the othertools.
These results can be explained by the fact that ARTINALI lever-
agesthecorrelationsamongdata,eventandtimedimensionsduring
correctsystembehaviortogeneratemorestableinvariants.ARTI-
NALIinferseventinvariantsthatpreciselydescribetheorderingof
events in a sequence within an execution low, and then associates
data and time constraints to the events within every path ( D|Eand
E|T). Therefore, during normal operation, the system is unlikely to
followthesamepathwithdiferentassociateddataandtimeval-
uesina givenexecution, whichinturn, reducestheprobability of
false positives. Although the IDS uses the same traces for all tools,
none of these tools other than ARTINALI look at the relational
constraints of both data and time along the events’ paths, resulting
inahigher ratiooffalse positives.
While the FP ratio for the ARTINALI-based IDS is lower than
the other tools, itis still highfor both platforms.To reduce the FP
ratio, one can deploy multiple variants of the code and switch to a
diferent variant when an attack is detected. If the invariant is not
violatedinthesecondversion,itmaybeafalsepositive.Another
solution is to remove invariants that exhibit high FP ratios [ 7], but
this mayalsoincreasethe FN ratio.
359ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany AliabadiM.,KamathA.A.,Gascon-Samson J. andPatabiramanK.
Table 9: Memory and performance overhead of IDS, seeded
by ARTINALIandtheother tools,runningon SEGMeter.
Daikon Texada Perfume ARTINALI
Memory usage (MB) 1.24 3.21 3.94 2.96
Tracing overhead(%) 22.6 13.4 18.8 23.3
Detectoroverhead(%) 4.7 10.3 13.3 8.3
Overall overhead(%) 27.3 23.7 32.08 31.6
Full cycleexecution(s) 60.94 60.94 60.94 60.94
IDSexecution time(s) 16.63 14.45 19.57 19.25
6.5 RQ4. MemoryOverhead
We measured the memory consumption of our IDS running on the
SEGMeter platform, using the invariants generated by diferent
tools. We also calculated the number of invariants that ARTINALI
and the other tools inferred for both platforms. Our results are
shown in Table 9 (łMemory usagež row). Generally, invariants
that involve two or more dimensions (e.g., E|Tinvariants) carry
more information than the invariants of one dimension (e.g., event
invariants), and hence are more complex. We observe that the
memory usage grows as the number and complexity of invariants
increases.Forexample,theIDSconsumesthemaximummemory
usage (3.94 MB) when it uses the Perfume-generated invariants,
which straddle two dimensions, and have the maximum number
of invariants (158 - Table 2). Overall, we ind that the memory
consumption of the IDS with ARTINALI-generated invariants is
lower than those with Perfume or Texada-generated invariants,
but higher than those with Daikon-generated invariants. However,
the memory usage for all tools is much lower than the available
memory inSEGMeter (16 MB).
6.6 RQ5. Performance Overhead
In this section, we discuss the performance overhead of our IDS
running on the SEGMeter platform. Recall that the IDS consists of
two components, namely tracing module and intrusion detector
module. Table 9 (middle part) shows the overheads of the two
modules separately for each tool. Each of these measurements is
an average of the overhead of 10 execution traces for each tool,
where an execution trace is deined as one complete execution
of the meter’s main loop. We ind that ARTINALI and Perfume
havethehighestaggregateoverhead,followedbyDaikon,andthen
Texada.Thediferenceintheoverheadisduetothediferencein
thetracingmodule,whichneedstocollectbotheventanddata/time
information for ARTINALI and Perfume, compared with Texada
(eventsonly), andDaikon(data only).
In addition to the performance overheads, the IDS execution
time should be lower than the execution time of the system’s cycle,
orelseit willbeunabletokeepupwiththe system.We measure
the raw execution times of a full cycle in Table 9 (last part). As can
beseenfromthetable,theentirecycletakesabout60seconds(1
minute). However, the execution of the IDS for each tool takes less
than20secondsevenintheworstcase(forPerfume),whichisonly
a third of execution time of the full cycle. Therefore, the IDS is not
abottleneckinanyofthefoursystems,andiseasilyabletokeep
upwiththe system.Notethattheinvariantminingprocesstakesplaceoline,and
hence does not contribute to the performance overhead of the
IDSrunningontheCPSplatform.Nonetheless,wemeasuredthe
time to mine invariants using ARTINALI, on a standard desktop
system (Intel core i7 processor with 32 GB RAM). We found that
thetimerangesfrom8to96secondsinSEGMeter,andfrom6to
36secondsinOpenAPS.Thoughthisoverheadmaybehigherfor
largersystems,thisprocessneedstobedoneonlyonacodeupdate.
7 DISCUSSION
Inthissection,weirstexaminethethreatstothevalidityofourex-
periments, followed by relections on ARTINALI’s generalizability.
Threats to Validity: Anexternal threat to the validity is the
limitednumberofCPSplatformsconsidered(two).However,aswe
have mentioned, indingCPSplatformsthat arepubliclyavailable
and security critical is a challenge. We have attempted to mitigate
this threat by choosing two fairly diverse platforms, with diferent
tradeofs in terms of FP and FN ratios. We acknowledge that these
platforms exhibit somewhat simple behaviors - however, many
CPSesfallintothiscategory[ 12].Aninternalthreat tovalidityisin
our evaluation of the eicacy of the invariants for attack detection
throughfaultinjectionexperiments.Whilenotnecessarilyrepre-
sentativeofallsecurityattacks,faultinjectionallowsustoemulate
thebehaviorofpotentialattackers without biasing theevaluation
towardsknownvulnerabilities(atthetime oftheevaluation).We
have attempted to mitigate this threat by using mutation operators
that were used for emulatingattacksin prior work[ 38]. Finally, a
constructthreat tovalidityistheevaluationmetricsusedformea-
suringeicacy.FPandFNratioshavehoweverbeenusedinalot
ofpriorworkonintrusiondetection,ashaveF-scores,andhence
we do not believe this is a signiicant threat. Another potential
constructthreatisthechoiceoftoolsweuseforcomparingwith
ARTINALI,butwemitigatedthistoanextentbyirstsystematically
classifying the space of invariant detection techniques, and then
choosing the toolsineachcategory.
Generalizability of ARTINALI: ARTINALI relies upon two
features, namely event-based semantics , andconditional indepen-
dence of time and data (Section 3.2). Events are operations that
involve interaction with the outside world. Event-based semantics
implies that every event takes place in a unique time frame, and
hence, there is no concurrency among event executions. Secondly,
ARTINALI assumes an event occurs at a speciic time interval, and
subsequently,datavariablesareassignedtospeciicvalues.Thus,
the time and data corresponding to a particular event, are condi-
tionally independent regardlessofthe dependency among events.
Thesetwo features are acommonparadigm for CPSes,andhence
ARTINALIcan be generalizedto otherCPS platforms.
However, ARTINALI is not applicable to non-CPS platforms
for two reasons. First, the non-concurrency of events does not
holdinnon-CPSplatformssuchasmobilephones.Secondly,CPS
events have limited functionality, and hence inferring invariants
for each event is straightforward. Unlike CPSes, in general real-
time systems, tasks can be of unbounded complexity. Furthermore,
general purpose computers with full preemptive (i.e., non-real-
time) operatingsystemshave a largespace of behaviors. Therefore,
learninginvariantsfor such systemsischallenging.
360ARTINALI:DynamicInvariant Detectionfor Cyber-PhysicalSystemSecurity ESEC/FSE’17,September4ś8, 2017, Paderborn,Germany
8 CONCLUSION
Cyber-physical systems (CPSes) are becoming increasingly subject
tosecurityattacksduetotheirinterconnectednessandrelativelack
ofprotection.Inthispaper,weattempttousedynamicinvariant
detectiontechniquestobuildintrusiondetectionsystemsforCPSes.
OurkeyinsightisthattimeisairstclassconstraintinCPSsystems,
and hence we incorporate time into the invariants, in addition
to data and events. We devise an eicient algorithm for learning
invariants over the three dimensions of data, events and time, and
implementitinatoolcalledARTINALI.Wedemonstratetheuseof
ARTINALIontwo CPSplatforms for intrusiondetection. We ind
that ARTINALI has signiicantly lower false negatives and false
positives thanotherdynamicinvariantdetection tools.
ACKNOWLEDGEMENT
This work was supported in part by the Natural Sciences and Engi-
neeringResearchCouncil ofCanada(NSERC),andthe MITACS.
REFERENCES
[1]2011. Smart energy groups home page. http://smartenergygroups.com.. (2011).
[2]2014. Perfume User Manual. http://people.cs.umass.edu/~ohmann/perfume/.
(2014).
[3] 2016. TexadaUserManual. https://bitbucket.org/bestchai/texada/.(2016).
[4]2017. ARTINALIInvariantDetector. (2017). https://github.com/karthikp-ubc/
Artinali
[5]2017. TheDaikonInvariantDetectorUserManual. https://plse.cs.washington.
edu/daikon/download/doc/daikon.html. (2017).
[6]MaryamRaiyatAliabadiandKarthikPattabiraman.2016. FIDL:AFaultInjection
Description Language for Compiler-Based SFI Tools. In International Conference
onComputer Safety, Reliability, and Security . Springer, 12ś23.
[7]Leonardo Aniello, Claudio Ciccotelli, Marcello Cinque, Flavio Frattini, Leonardo
Querzoni, and Stefano Russo. 2016. Automatic Invariant Selection for Online
AnomalyDetection.In InternationalConferenceonComputerSafety,Reliability,
and Security . Springer, 172ś183.
[8]Robin Berthier, William H Sanders, and Himanshu Khurana. 2010. Intrusion
detectionforadvancedmeteringinfrastructures:Requirementsandarchitectural
directions. In Smart Grid Communications (SmartGridComm), 2010 First IEEE
InternationalConference on . IEEE,350ś355.
[9]Stephen Checkoway, Damon McCoy, Brian Kantor, Danny Anderson, Hovav
Shacham, Stefan Savage, Karl Koscher, Alexei Czeskis, Franziska Roesner, Ta-
dayoshi Kohno, and others. 2011. Comprehensive Experimental Analyses of
AutomotiveAttack Surfaces.. In USENIXSecuritySymposium . San Francisco.
[10]Christoph Csallner, Nikolai Tillmann, and Yannis Smaragdakis. 2008. DySy:
Dynamic symbolic execution forinvariantinference. In Proceedingsof the 30th
international conference onSoftwareengineering . ACM,281ś290.
[11]Barthélémy Dagenais and Martin P Robillard. 2010. Creating and evolving
developer documentation: understanding the decisions of open source contribu-
tors.InProceedingsoftheeighteenth ACMSIGSOFTinternationalsymposiumon
Foundationsofsoftwareengineering . ACM,127ś136.
[12]Patricia Derler, Edward A Lee, and Alberto Sangiovanni Vincentelli. 2012. Mod-
eling cyberśphysical systems. Proc. IEEE 100, 1 (2012), 13ś28.
[13]JohnEidson,EdwardALee,SlobodanMatic,SanjitASeshia,andJiaZou.2010. A
time-centric model for cyber-physical applications. In Workshop on Model Based
Architecting and Construction ofEmbeddedSystems(ACES-MB) . 21ś35.
[14]Michael D Ernst, Jake Cockrell, William G Griswold, and David Notkin. 2001.
Dynamicallydiscoveringlikelyprograminvariantstosupportprogramevolution.
IEEE Transactions onSoftwareEngineering 27,2 (2001), 99ś123.
[15]Earlence Fernandes, Jaeyeon Jung, and Atul Prakash. 2016. Security analysis
of emerging smart home applications. In Security and Privacy (SP), 2016 IEEE
Symposiumon . IEEE,636ś654.
[16]MarkGabelandZhendongSu.2008. Symbolicminingoftemporalspeciications.
InProceedings of the 30th international conference on Software engineering . ACM,
51ś60.
[17]GöstaGrahneandJianfeiZhu.2005. Fastalgorithmsforfrequentitemsetmining
usingfp-trees. IEEEtransactionsonknowledgeanddataengineering 17,10(2005),
1347ś1362.
[18]Ahmad Y Javaid, Weiqing Sun, Vijay K Devabhaktuni, and Mansoor Alam. 2012.
Cyber security threat analysis and modeling of an unmanned aerial vehicle
system. In Homeland Security (HST), 2012 IEEE Conference on Technologies for .
IEEE,585ś590.[19]HengleJiang,SebastianElbaum,andCarrickDetweiler.2013. Reducingfailure
rates of robotic systems though inferred invariants monitoring. In Intelligent
RobotsandSystems(IROS),2013IEEE/RSJInternationalConferenceon .IEEE,1899ś
1906.
[20]HermannKopetzandGüntherBauer.2003. Thetime-triggeredarchitecture. Proc.
IEEE91,1 (2003), 112ś126.
[21]KarlKoscher,AlexeiCzeskis,FranziskaRoesner,ShwetakPatel,TadayoshiKohno,
Stephen Checkoway, Damon McCoy, Brian Kantor, Danny Anderson, Hovav
Shacham, and others. 2010. Experimental security analysis of a modern automo-
bile. In2010IEEE SymposiumonSecurityand Privacy . IEEE,447ś462.
[22]Ted Kremenek, Paul Twohey, Godmar Back, Andrew Ng, and Dawson Engler.
2006. Fromuncertaintytobelief:Inferringthespeciicationwithin.In Proceedings
ofthe 7th symposiumon Operatingsystems designand implementation . USENIX
Association, 161ś176.
[23]Neal Leavitt. 2010. Researchers ight to keep implanted medical devices safe
from hackers. Computer 43,8 (2010), 11ś14.
[24]Caroline Lemieux. 2015. Mining temporal properties of data invariants. In 2015
IEEE/ACM 37th IEEE International Conference on Software Engineering , Vol. 2.
IEEE,751ś753.
[25]Caroline Lemieux, Dennis Park, and Ivan Beschastnikh. 2015. General LTL
Speciication Mining (T). In Automated Software Engineering (ASE), 2015 30th
IEEE/ACMInternationalConference on . IEEE,81ś92.
[26] Dana Lewis. 2015. Introducing the# OpenAPS project. (2015).
[27]ChunxiaoLi,AnandRaghunathan,and NirajKJha. 2011. Hijacking aninsulin
pump:Securityattacksanddefensesforadiabetestherapysystem.In e-Health
NetworkingApplicationsandServices(Healthcom),201113thIEEEInternational
Conference on . IEEE,150ś156.
[28]Davide Lorenzoli, Leonardo Mariani, and Mauro Pezzè. 2008. Automatic gen-
erationofsoftwarebehavioralmodels.In Proceedingsofthe30thinternational
conference onSoftwareengineering . ACM,501ś510.
[29]Stephen McLaughlin, Dmitry Podkuiko, Sergei Miadzvezhanka, Adam Delozier,
andPatrickMcDaniel.2010. Multi-vendorpenetrationtestingintheadvanced
metering infrastructure. In Proceedings of the 26th Annual Computer Security
ApplicationsConference . ACM,107ś116.
[30]RobertMitchellandIng-RayChen.2014. Asurveyofintrusiondetectiontech-
niques for cyber-physical systems. ACM Computing Surveys (CSUR) 46, 4 (2014),
55.
[31]Gail C Murphy, David Notkin, and Kevin Sullivan. 1995. Software relexion
models: Bridging the gap between source and high-level models. ACM SIGSOFT
SoftwareEngineering Notes 20,4 (1995), 18ś28.
[32]TonyOhmann,MichaelHerzberg,SebastianFiss,ArmandHalbert,MarcPalyart,
IvanBeschastnikh,andYuriyBrun.2014. Behavioralresource-awaremodelinfer-
ence. InProceedings of the 29th ACM/IEEE international conference on Automated
softwareengineering . ACM,19ś30.
[33]Antonio Pecchia, Stefano Russo, and Santonu Sarkar. 2017. Assessing Invariant
MiningTechniquesforCloud-basedUtilityComputingSystems. IEEETransac-
tions onServicesComputing (2017).
[34]JeromeRadclife.2011. Hackingmedicaldevicesforfunandinsulin:Breaking
thehumanSCADAsystem.In BlackHatConferencepresentationslides ,Vol.2011.
[35]Florian Skopik, Zhendong Ma, Thomas Bleier, and Helmut Grüneis. 2012. A sur-
veyonthreatsandvulnerabilitiesinsmartmeteringinfrastructures. International
Journal ofSmartGrid and Clean Energy 1,1 (2012), 22ś28.
[36]Sean W Smith. 2009. Security and privacy challenges in thesmartgrid. (2009).
[37]Marina Sokolova, Nathalie Japkowicz, and Stan Szpakowicz. 2006. Beyond
accuracy, F-score and ROC: a family of discriminant measures for performance
evaluation.In AustralasianJointConferenceonArtiicialIntelligence .Springer,
1015ś1021.
[38]Farid Molazem Tabrizi and Karthik Pattabiraman. 2015. Flexible intrusion detec-
tionsystemsformemory-constrainedembeddedsystems.In DependableCom-
puting Conference (EDCC),2015 Eleventh European . IEEE,1ś12.
[39]FaridMolazemTabriziandKarthikPattabiraman.2016. Formalsecurityanalysis
of smart embedded systems. In Proceedings of the 32nd Annual Conference on
Computer SecurityApplications . ACM,1ś15.
[40]Carolyn Talcott. 2008. Cyber-physical systems and events. In Software-Intensive
Systemsand NewComputingParadigms . Springer, 101ś115.
[41]Joachim Wegener and Matthias Grochtmann. 1998. Verifying timing constraints
of real-timesystemsbymeansofevolutionarytesting. Real-Time Systems 15,3
(1998), 275ś298.
[42]Westley Weimer and George C Necula. 2005. Mining temporal speciications
forerrordetection.In InternationalConferenceonToolsandAlgorithmsforthe
Construction and AnalysisofSystems . Springer, 461ś476.
[43]YeYan,YiQian,HamidSharif,andDavidTipper.2012.Asurveyoncybersecurity
for smart grid communications. IEEE Communications Surveys & Tutorials 14, 4
(2012), 998ś1010.
[44]JinlinYang,DavidEvans,DeepaliBhardwaj,ThirumaleshBhat,andManuvirDas.
2006. Perracotta:miningtemporalAPIrulesfromimperfecttraces.In Proceedings
ofthe 28thinternational conference onSoftwareengineering . ACM,282ś291.
361