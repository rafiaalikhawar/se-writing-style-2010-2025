On evidence preservation requirements for forensic-ready systems
On evidence preservation requirements for forensic-ready systems
Dalal Alrajeh, Liliana Pasquale, BASHAR NUSEIBEH
Publication date
Publication date
01-01-2017
Published in
Published in
ESEC/FSE 2017 Proceedings of the 2017 11th Joint Meeting on Foundations of Software
Engineering;pp.559-569
Licence
Licence
This work is made available under the 
CC BY-NC-SA 1.0
 licence and should only be used in accordance with
that licence. For more information on the specific terms, consult the repository record for this item.
Document Version
Document Version
1
Citation for this work (HarvardUL)
Citation for this work (HarvardUL)
Alrajeh, D., Pasquale, L.and NUSEIBEH, B. (2017) ‘On evidence preservation requirements for forensic-ready
systems’, available: https://hdl.handle.net/10344/7430 [accessed 25 Jul 2022].
This work was downloaded from the University of Limerick research repository.
For more information on this work, the University of Limerick research repository or to report an issue, you can
contact the repository administrators at 
ir@ul.ie
. If you feel that this work breaches copyright, please provide
details and we will remove access to the work immediately while we investigate your claim.On Evidence Preservation Requirements for Forensic-Ready
Systems
Dalal Alrajeh
Imperial College London
London, UKLiliana Pasquale
University College Dublin
Dublin, IrelandBashar Nuseibeh
The Open University, UK, &
Lero, Ireland
ABSTRACT
Forensic readiness denotes the capability of a system to support
digital forensic investigations of potential, known incidents by pre-
serving in advance data that could serve as evidence explaining how
an incident occurred. Given the increasing rate at which (poten-
tially criminal) incidents occur, designing software systems that are
forensic-ready can facilitate and reduce the costs of digital forensic
investigations. However, to date, little or no attention has been
given to how forensic-ready software systems can be designed sys-
tematically. In this paper we propose to explicitly represent evidence
preservation requirement s prescribing preservation of the minimal
amount of data that would be relevant to a future digital investiga-
tion. We formalise evidence preservation requirements and propose
an approach for synthesising specifications for systems to meet
these requirements. We present our prototype implementation—
based on a satisfiability solver and a logic-based learner—which
we use to evaluate our approach, applying it to two digital foren-
sic corpora. Our evaluation suggests that our approach preserves
relevant data that could support hypotheses of potential incidents.
Moreover, it enables significant reduction in the volume of data
that would need to be examined during an investigation.
CCS CONCEPTS
•Software and its engineering →Requirements analysis ;•Ap-
plied computing →Evidence collection, storage and analysis ;
KEYWORDS
Forensic-ready systems, requirements, specification synthesis
ACM Reference Format:
Dalal Alrajeh, Liliana Pasquale, and Bashar Nuseibeh. 2017. On Evidence
Preservation Requirements for Forensic-Ready Systems. In Proceedings of
2017 11th Joint Meeting of the European Software Engineering Conference and
the ACM SIGSOFT Symposium on the Foundations of Software Engineering,
Paderborn, Germany, September 4–8, 2017 (ESEC/FSE’17), 11 pages.
https://doi.org/10.1145/3106237.3106308
1 INTRODUCTION
Digital forensic investigations are concerned with the discovery,
collection, preservation, analysis, interpretation and presentation
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany
©2017 Association for Computing Machinery.
ACM ISBN 978-1-4503-5105-8/17/09. . . $15.00
https://doi.org/10.1145/3106237.3106308of digital data from digital sources, for proof of incident and ulti-
mately for prosecution of criminal activity [ 16,36]. Such data often
comprises log entries indicating the occurrence of events in the
digital sources placed within the environment in which an inci-
dent can occur. Despite the availability of digital forensics tools
for evidence acquisition and examination (e.g., [ 2,10,14]), these
tools are designed to be used only after an incident occurs and
an investigation commences. However, some of the relevant data
may not be available then because, for example, it was stored in
a volatile memory or it has been intentionally tampered with by
an offender. Moreover, digital forensic tools do not select among
the data that might be relevant for investigating a specific incident,
thus requiring investigators to sift through large volumes of data
to determine what may be considered as relevant evidence. This
can be a cumbersome and an error-prone process [29, 54].
Software systems should be forensic-ready [45], i.e., able to sup-
port digital forensic investigations of potential ,known incidents
by preserving in advance data that may serve as evidence explain-
ing how an incident occurred. Given the increasing rate at which
(potentially criminal) incidents occur, designing software systems
that are forensic-ready can facilitate and reduce the costs of digital
forensic investigations. However, existing research has provided
only generic guidelines capturing operational and infrastructural
capabilities for organisations to achieve forensic readiness [ 15,42].
Little or no attention has been given to how forensic-ready systems
can be designed and verified systematically, nor to how to ensure
their suitability for the specific environments in which they will
be deployed [ 51]. Without a formal conceptualisation of a forensic-
ready system and a software design methodology for achieving it,
ensuring the soundness of any automated investigative process or
its outcome becomes difficult, or even impossible [43].
Forensic-ready systems should satisfy evidence preservation re-
quirements , i.e. ensure preservation of relevant andminimal evi-
dence. On the one hand, preservation of an excessive amount of
data often introduces resource and performance issues [ 40], and
increases the cognitive load on investigators who have to make
sense of a large data-set. On the other hand, preservation of an
insufficient amount of data provides an incomplete picture of how
an incident would have occurred, thus making way for misguided
decisions and potentially wrong convictions [12].
This paper addresses some of the challenges in the systematic
design of forensic-ready systems by making the following contribu-
tions: (i) precise definition of evidence preservation requirements
and the concepts upon which these requirements depend; (ii) a
method for generating preservation specifications that satisfy evi-
dence preservation requirements and (iii) a prototype tool for gen-
erating such specifications automatically, which we use to evaluate
our approach. More specifically, we first provide formal definitionsESEC/FSE’17, September 4–8, 2017, Paderborn, Germany Dalal Alrajeh, Liliana Pasquale, and Bashar Nuseibeh
of the domain model of a forensic-ready system including the en-
vironment in which incidents may occur and hypotheses about
such incidents. We also formalise preservation specifications and
requirements. We then present a synthesis approach that combines
deductive reasoning and inductive learning to generate preserva-
tion specifications from a formal description of an environment
and hypotheses. To the best of our knowledge this is the first work
that conceptualises the requirements of evidence preservation and
demonstrates its benefits in reducing data needed to be examined
during an investigation.
In this work, we assume a domain expert provides a set of correct
incident hypotheses. To achieve this aim s/he can follow a proper
risk assessment methodology (using approaches such as [ 9]) over
the threats/incidents considered most likely and highly-critical.
Specifications are expressed declaratively in Linear Temporal Logic
(LTL) [ 39], a commonly used formalism for specifying a system
behaviour, and prescribe constraints over when events happening
at the digital sources in the environment must be logged. We also
assume that a designated software controller, the forensic readiness
controller , is responsible for the enactment of the specification by
interacting with the digital sources through a uniform interface. We
evaluate our approach by applying it to two substantive case stud-
ies publicly available. Our evaluation suggests that our approach
preserves relevant data to explain potential incidents and enables
significant reduction in the volume of data that would need to be
examined during an investigation.
The rest of the paper is organised as follows. Section 2 presents
a motivating example and an overview of our approach. Sections 3
and 4 formalise the domain model of a forensic-ready system and
preservation specifications and requirements. Sections 5 and 6 ex-
plain our approach to generate specifications and its implemen-
tation. Section 7 presents the results of our evaluation. Section 8
gives an overview of related work, and Section 9 concludes.
2 MOTIVATING EXAMPLE AND OVERVIEW
We motivate our work using an example of a corporate fraud in-
cident, inspired by the Galleon Group case [ 35]. We consider an
environment (Fig. 1a) within an enterprise building , where two
employees, bobandalice, work and are provided with laptops ( m2
andm3, respectively) by the company. A sensitive document docis
stored on the server machine m1located in the office r01. Access
tor01is controlled by an NFC reader ( nfc) and is monitored by a
CCTV camera ( cctv). Both alice andbobare authorised to access
r01and to login to m1.
Suppose that a digital investigation related to the exfiltration of
thedocis initiated. An investigator may hypothesise that the doc
was copied onto a storage device mounted on m1. To verify this, she
must first speculate the activities that may have occurred within
the environment and reconstruct different possible scenarios based
on these activities. A possible scenario is that alice enters room
r01,logs into m1,mounts usb1 onm1andcopies doconto usb1.
Another is that bobenters room r01butlogs into m1using alice’s
credentials, and then copies thedoconto usb1.
Once the scenarios have been identified, the investigator must
establish which of the digital devices holds data that might be rele-
vant to the scenarios. Then she must search through the storage of
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfccamera: cctv
storage: usb1 (a)
FR ControllerStorage
Domain ExpertEnvironmentHypotheses
InvestigatorSpeciﬁcationGenerationPSpreserve(event)
CCTVNFC
COMPUTER
receive(event)
(b)
Figure 1: Setting of our example (a) and overall approach (b)
these devices (e.g., logs for all readers and CCTVs, and hard drives
for all computers) for relevant information. However, the investiga-
tor may fail to find information about storage devices mounted on
m1because the system log of m1only retains information about
the last device that was mounted. The large number of events that
can occur also does not make it plausible to preserve all events in
advance for later examination. For example, corporate computers
can generate over 100 millions of events per week1, while the num-
ber of accesses recorded by CCTV cameras and card readers can
exponentially grow with the number of employees and rooms in a
building. Moreover, not all the events are relevant to support the
speculated scenarios. For instance, only copies of the doctaking
place while a storage device is mounted and a user is logged on m1
are relevant for our example.
Our approach (Fig. 1b) aims to design a FR controller thatreceives
events from digital sources within the environment and selectively
preserves them in a secure storage. These events can be acquired
and examined by an investigator during future digital investiga-
tions. We provide an automated approach ( Specification Generation )
to generate a preservation specification ( PS) for the FR controller.
We assume a domain expert (e.g., security administrator or soft-
ware engineer) provides a description of the environment and a
predefined set of hypotheses about incidents of concern. The de-
scription of the environment also includes information about what
activities can be monitored by the digital sources. To generate a
specification, we first check whether the hypotheses are feasible
within the environment (i.e., they may hold if certain activities take
place in the environment). If this is the case, the approach generates
a set of possible sequences of low-level system events (called po-
tential histories) that demonstrate this. The approach then verifies
whether the existing specification already ensures the preservation
of events that correspond to these generated histories. If not, then
our approach inductively synthesises a preservation specification
that configures when an event occurring in a digital source within
1We estimated having 50 Events Per Second (EPS) during non peaks and 2500 EPS
during peaks. An organisation that experiences peaks for 5% of the total time will have
an average of 215 EPS (125 EPS for non-peak and 90 for peak).On Evidence Preservation Requirements for Forensic-Ready Systems ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany
the considered environment should be preserved, according to their
relevance to the hypotheses. For our motivating example, our ap-
proach would prescribe preservation of events indicating copies
of the doconly if a storage device was previously mounted and
a user has previously logged on m1. In the next two sections we
define the artefacts which constitute the domain of a forensic-ready
system (environment, histories and hypotheses) and their relation
to preservation specifications and requirements.
3 FORENSIC DOMAIN MODEL
We provide here a formal underpinning of the concepts and termi-
nology that are commonly used in digital forensic domain [ 11] to
describe the environment in which an incident can occur, histories
and the incident hypotheses.
3.1 Environment Description
The environment description is a set of descriptive statements about:
(i) the context in which an incident may occur, (ii) the behaviour that
may be exhibited within the environment and (iii) their interactions .
Acontext description Cis a collection of descriptive (non-behav-
ioural) declarations about the types (e.g., employees and locations),
and instances of entities present in an environment (e.g., boband
r01), and relations between instances, such as bobis entitled to
access r01(hasbadge(bob,r01) ).
Definition 3.1 (Context Description). A context description Cis
a tuple⟨Y,I,γ,K⟩where Yis a set of types, Ia set of instances,
γ:I→Yis function that assigns an instance in Ito its type in Y,
andKis a set of context relations over instances in I, such that for
every k∈K,k⊆I1×...×In.
We denote the universe of context relations as K. Acontext
relation literal is an expression of the form kor¬kfor some k∈K.
Given a set of context relation literals KL, we writeα(KL )to denote
the set of unique context relations in KL.
Returning to our running example, a context description in this
case includes types such as Emp andComp , instances including bob
andm1with assignments γ(bob )=Emp andγ(m1 )=Comp , and
context relations such as isLocatedIn(m1, r01) , meaning that com-
puter m1is placed in location r01, and isStoredIn(doc, m1) , meaning
that docis stored in m1.
Abehavioural description Bspecifies the events that may occur
within an environment. In a digital investigation setting, these
may be at different levels of abstraction. Similar to [ 8,11], we
distinguish between two types of events to represent these levels
of abstraction: primitive and complex. A primitive event represents
the occurrence of an atomic action that can be observed by an
investigator from a digital device (e.g., using a hard drive analysis
tools). An example of primitive event can be swipe_card(alice,nfc)
indicating the nfcreading alice’s card tag. A complex event indicates
the execution of complex human activities and can involve one
or more primitive events, other complex events and contextual
conditions. For example, a complex event indicating alice entering
room r01involves the following primitive events: alice’s card tag
being read by the nfcreader and her entrance in r01being recorded
by the cctv. These events can happen at the same time or in any
order. The complex event also involves the following contextualconditions: alice is not inside r01and does not possess a badge to
access r01. This is expressed through a composite definition.
Definition 3.2 (Composite Definition). LetApandAcbe the
universe of primitive and complex events respectively. A composite
definition is a tuple⟨Ap,Ac,KL,L,⪯,λ⟩where Ap⊆Ap,Ac⊆Ac,
α(KL )⊆K ,Lis a finite set of time-labels, ⪯⊆L×Lis a partial order
relation over L(that is reflexive, anti-symmetric and transitive) and
λ:L→P (Ap∪Ac∪KL )is a labelling function.
LetDbe a set of composite definitions. We define a relation
◁⊆ Ac×D to associate a composite definition d∈ D with
the complex event e∈ Acit defines. In our example, the com-
plex event enter (alice,r01) may be defined as enter (alice,r01)◁⟨
{swipe_card (alice,nfc),cctv_access (alice,r01,cctv1 ) },∅, {¬in(alice,
r01),hasBadge (alice,r01)}, {l1,l2},∅, {l1→{swipe_card (alice,nfc),¬
in(alice,r01),hasBadge (alice,r01)},l2→{cctv_access (alice,r01,cctv1 ),
¬in(alice,r01)}}⟩.
For our example, to trigger complex event enter (alice,r01), primi-
tive events swipe_card (alice,nfc) and cctv_access (alice,r01,cctv1 ) can
occur in any order; however, both have to occur. When swipe_card (-
alice,nfc) and cctv_access (alice,r01,cctv1 ) occur alice should not
be in r01. Moreover alice should be authorised to access r01(has-
Badge ) when swipe_card (alice,nfc) occurs. Moreover, complex event
mount (usb1,m1) event occurs when the system log in m1records the
mounting of a storage device (primitive event sys_mount (usb1,m1))
while alice orbobare logged to m1(context condition loддed(e,m1)).
This is defined as mount (usb1,m1)◁⟨{sys_mount (usb1,m1) },∅,
{loддed(e,m1)}, {l1},∅, {l1→{sys_mount (usb1,m1),loддed(e,m1)}}⟩.
A behavioural description includes the composite definitions as-
sociated with the complex events that can occur in the environment.
A behavioural description is formally defined as follows.
Definition 3.3 (Behavioural Description). A behavioural descrip-
tionBis a tuple⟨Ap,Ac,K,D, ◁⟩such that for every e◁d,e∈Ac,
d=⟨Ld,⪯d,λd,Ap
d,Ac
d,KLd⟩ ∈ D ,Ap
d⊆ Ap,Ac
d⊆ Acand
α(KLd)⊆K .
Complex events are expected to interact and bring about changes
to the context in which they occur. To capture this effect, we adopt
notions of fluents for event-driven systems [ 22,31]. Given the set
Kof context relations, each k∈K is defined by two disjoint sets of
complex events from Ac(called initiating and terminating events,
respectively) and an initial value (true or false), written according to
the following schema: k≡⟨INk,TRk,initk⟩such that INk∩TRk=∅
andINk∪TRk⊂Ac. The set of associations of this form are called
interaction definitions , and are denoted I. In our running example
the interaction definition of context relation in(alice,r01) is defined
by⟨{enter (alice ,r01 )},{exit (alice ,r01 )},false⟩. This interaction indi-
cates that context relation in(alice,r01) is initially false; it is initiated
by complex event enter (alice,r01) and terminated by complex event
exit(alice,r01).
FromC,BandIwe define an environment description.
Definition 3.4 (Environment Description). An environment de-
scriptionEis a tuple⟨C,B,I⟩whereC=⟨Y,I,γ,K⟩is a con-
text description,B=⟨Ap,Ac,K,D, ◁⟩a behavioural descrip-
tion andIis a set of context relation definitions such that ∀k≡
⟨INk,TRk,initk⟩∈I .k∈K andINk∪TRk⊆Ac.ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany Dalal Alrajeh, Liliana Pasquale, and Bashar Nuseibeh
3.2 Histories
Ahistory is a sequence of (concurrent) events that captures the
evolution of an environment in which the digital devices and evi-
dence sources operate [ 11]. It is potential if it refers to at least one
event that has been speculated and actual if all the events have
been observed from digital sources within the environment. In this
paper, we focus on potential histories for defining preservation
requirements.
A history may describe events at various levels. It is called a
primitive (resp. complex) history, denoted σ(resp.ω), if all the
events that appear in it are primitive (resp. complex). We write
ω=ce1, ...cento denote a complex history where ceiis the set of
complex events occurring concurrently at position i, and similarly
for a primitive history σ.
An environment description Eis interpreted over a sequence
of primitive and complex events (referred to as a hybrid history
υ). Its satisfaction is determined with respect to the satisfaction of
complex events’ composite definitions in Bw.r.t. toI.
For the satisfaction of an event’s composite definition, we con-
sider the notion of a ‘narration’ (a total order over the partial order
given in a complex event’s definition). For a narration to be con-
structed, each complex event appearing in a definition is refined
until all complex events are reduced to their primitive events and
context relation literals. The result of this refinement procedure
applied to definition dis a set of composite definitions δ(d).2
Givenδ(d), a narration of dis captured with respect to one of
the elements in δ(d). We will use the notation υ|Ap(reps.υ|Ac) to
denote the projection of υover primitive (reps. complex) events in
Ap(resp. Ac).
Definition 3.5 (Narration of Composite Definition). LetB=⟨Ap,
Ac,K,D, ◁⟩be a behavioural description and d=⟨Ld,⪯d,λd,Ap
d,
Ac
d,KLd⟩a composite definition in D. Letδ(d)be the set of defi-
nitions obtained refining d. A narration of dis a hybrid history
σ=he1, ...,hem, if there exists a d′∈δ(d)and a total order
l1≺...≺lnover Ld′such that:
•for all li,lj∈Ld′, ifli≺ljthen a<b(where 1≤a,b≤m),
•λd′(li)|Ap=(hea)|Ap
•λd′(li)|Ac=(hea)|Ac.
whereλ(l)|Apandλ(l)|Acdenote the set of primitive events and
complex events respectively assigned to time-label l.
For instance the following are three example narrations for en-
ter(alice,r01)’s composite definition:
υ1=({swipe_card (alice,nfc ),cctv_access (alice,r01,cctv1 ),
enter (alice,r01 )}1)
υ2=({swipe_card (alice,nfc )}1,
{cctv_access (alice,r01,cctv1 ),enter (alice,r01 )}2)
υ3=({cctv_access (alice,r01,cctv1 )}1,
{swipe_card (alice,nfc ),enter (alice,r01 )}2)
Interaction descriptions are interpreted over complex histories.
Given k≡⟨INk,TRk,initk⟩∈I ,kis true at position bin a complex
historyω=ce1, ...,ceb, ...,ceniff either the following holds:
•initk∧∀a∈N ,eTRk∈TRk.(0<a<b)→eTRk<cea;
2See https://github.com/lpasquale/minorityReport for an outline of a refinement algo-
rithm for obtaining δ(d).•∃a∈N.(a<b)∧(eINk∈cea∧∀д∈N ,eTRk∈TRk.((a<
д<b)→eTRk<ceд);
otherwise it is said to be false. We assume histories in which ter-
minating and initiating events for a context relation do not occur
concurrently. We define below satisfaction of a complex event.
Definition 3.6 (Complex Event Satisfaction). Given an environ-
ment description E=(B,C,I), a composite definition dassociated
with complex event e(e◁d∈B) and a hybrid history υ,υis said to
satisfy e◁dwith respect toEif for every decomposition υ=xyz, if
y=hea, ...,heд, ...,hebis a narration of dwith respect to d′∈δ(d)
and order l′
1≺...≺l′
j≺...≺l′nthen:
•e∈(heb)|Ac
•ifkl∈λd′(l′
j)|KLthenυ|Ac,д|=kl
whereλ(l)|KLdenotes the set of context relation literals assigned
to time-label l.
The environment description Eis said to be satisfied in a hybrid
history if every complex event in Acis satisfied in that history. We
write ϒ(E)to denote the set of hybrid histories that satisfy E.
Figure 2 shows a hybrid history satisfying Eof our example. We
project the primitive and complex events composing the hybrid
history onto primitive and complex histories, respectively. The
primitive history represents the case in which (1) the nfcreads
alice’s card tag, (2) the cctvrecords alice passing through the door
ofr01, and m1logs (3) the login performed by user bob, (4) the mount
of storage device usb1, (5) the copy od the docby user bob, and (6)
theunmount ofusb1. If a portion of the primitive history represents
a narration of a composite definition associated with a complex
event, such event is assumed to occur. For example, the sequence of
primitive events at time 1and 2corresponds to narration v2of the
composite definition of enter (alice,r01). While the primitive event
at time 4represents a narration for the composite definition of
event mount (usb1,m1). On top of Figure 2 we indicate the context
relations that hold at each time instant and omit those that are not
satisfied, e.g., mounted (usb1,m1) starts holding when complex event
mount (usb1,m1) occurs and stops holding when complex event
unmount (usb1,m1) happens.
Legendprimitive eventcomplex eventswipe_card(alice, nfc)1345primitivehistorycctv_access(alice, r01, cctv)sys_login(bob, m1)sys_mount(usb1, m1)sys_copy(bob,doc, m1)enter(alice, r01)contextrelationscomplexhistorylogin(bob, m1)mount(usb1, m1)copy(bob, doc, m1)sys_unmount(usb1, m1)6unmount(usb1, m1)2logged(bob, m1)mounted(usb, m1)in(alice, r01)logged(bob, m1)in(alice, r01)in(alice, r01)in(alice, r01)logged(bob, m1)mounted(usb, m1)logged(bob, m1)in(alice, r01)
Figure 2: Example of hybrid history
3.3 Hypotheses
The term hypothesis in a digital investigation is a conjecture that
may refer, for instance, to past events in the lifetime of digital
devices [ 52]. In this paper, we focus on one type of hypothesisOn Evidence Preservation Requirements for Forensic-Ready Systems ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany
relevant to developing forensic-ready systems, the environment
construction hypothesis . This form of hypothesis postulates about
the feasibility of events occurrence and presence of contextual
conditions of interests within the environment. It may be captured
as an event’s composite definition h◁d, where his a complex
event marking the satisfaction of a hypothesis, and with Apind
being empty and AcandKLcontaining only complex events and
context relation literals respectively. The events and the contextual
conditions expressed in the hypothesis represent how an incident
may occur within the environment. The incident of our example
refers to the unauthorised exfiltration of the sensitive document doc.
One way in which the doccan exfiltrate is because an unauthorised
copy to an external storage device was performed. This hypothesis
is defined as
IllegalCopy ◁
⟨∅,{copy (bob,doc,m1 )},{mounted (usb1,m1 )},
{l1},∅,{l1→{mounted (usb1,m1 ),copy (bob,doc,m1 )}}⟩
In other words, a copy of the document is performed while an
external storage device ( usb1) is mounted on m1.
Hypotheses are interpreted over finite complex histories. Their
satisfaction is given by the definition below.
Definition 3.7 (Hypotheses Satisfaction). A hypothesis h(with
definition h◁d) is said to be satisfied in a complex history ωat
position b, i.e.,ω,b|=h, if there exists a decomposition ω=xyz
such thaty=cea, ...,ceд, ...,cebis a narration of dwith respect to
d′∈δ(d)and order l′
1≺...≺l′
j≺...≺l′nand if kl∈λd′(l′
j)|KL
thenυ|Ac,д|=kl.
We distinguish between supportable andrefutable hypotheses in
environmentE.
Definition 3.8 (Hypotheses Supportability and Refutability). Let
ϒ(E)be the set of hybrid histories satisfying E. A hypothesis h
(with definition h◁d) is said to be supportable inEif there exists
a hybrid history υ∈ϒ(E)such that for some b,υ|Ac,b|=h. It is
said to be refutable if there exists a history υ∈ϒ(E)such that for
allb,υ|Ac,b̸|=h.
We sometime abstract away from the position band writeυ|Ac|=h
for a history satisfying hat some point b. We will denote the set
of hybrid histories in ϒ(E)supporting at least one hypothesis in
Hasϒ+(E)and those refuting every hypothesis in Hasϒ−(E).
Returning to our example, the IllegalCopy hypothesis is supportable
in our example environment ( E) since there exists a decomposition
of a hybrid history (see Figure 2) satisfying E, that yields a narration
of the definition of the IllegalCopy hypothesis, i.e.,
x={swipe_card (alice,nfc )}1,
{cctv_access (alice,r01,cctv1 ),enter (alice,r01 )}2,
{sys_login (bob,m1 ),login (bob,m1 )}3,
{sys_mount (usb1,m1 ),mount (usb1,m1 )}4
y={sys_copy (bob,doc,cctv1 ),copy (bob,doc,cctv1 )}5,
z={sys_unmount (usb1,m1 )}6
such thatυ|Ac,5|=mounted (usb1 ,m1 ).
As we will see later in Section 4, we are interested in minimal
hybrid histories that satisfy a hypothesis. We define minimality of
histories with respect to hypotheses as follows.
Definition 3.9. [Minimally Supportive Histories] Let ϒ(E)be a
set of hybrid histories satisfying Eandhbe a hypothesis support-
able byE. The hybrid history υ=he1, ...,hem∈ϒ+(E)is said tobe minimally supportive of hinEiff the history υ∗obtained be
removing any primitive event a∈Apfrom (hei)|Apofυis inϒ(E)
and no longer supports h.
For instance, the hybrid history in Figure 2 is not minimally
supportive of the hypothesis IllegalCopy since the history obtained
by removing sys_unmount (usb1 ,m1 )fromυ6|Apstill satisfies Ille-
galCopy . We sometimes write min (υ,h)(resp. min (ϒ,h)) as a short-
hand for the minimally supportive history v∗(resp. histories) of h
obtained from υ.
4 PRESERVATION SPECIFICATIONS
We are concerned with deriving specifications PSfor a forensic
readiness controller comprising domain pre- and post-conditions
as well as required pre- and trigger-conditions, expressed in LTL.
These conditions control the execution of operations of the form
preserve (a,ts)—where aindicates the occurrence of a primitive event
in the environment, and tsmarks the time-stamp (from the system
clock) at which the occurrence was observed by the FR controller.
We consider tsito be an abstraction over real-time clock variables
that may be obtained following techniques such as [ 13,28]. The
generation of such abstractions is outside the scope of the paper.
We assume an ordered set of timestamps to be isomorphic to the
set of natural numbers.
The domain pre-condition of operation preserve (a,ts) specifies
that this operation cannot take place if the occurrence of event
aattshas already been preserved. The domain post-condition
specifies that operation preserve (a,ts) ensures preservation of the
occurrence of event aattsin the next time instant. We assume
these ar given for each operation. We Assertions 1 and 2 specify,
respectively, the domain pre- and post-conditions of operation
preserve (sys_copy (e,d,m),ts)
∀ts:Timestamp ,e:Emp,d:Doc,m:Comp
G(preserved (sys_copy (e,d,m),ts)→
¬preserve (sys_copy (e,d,m),ts)) (1)
G(preserve (sys_copy (e,d,m),ts)→
Xpreserved (sys_copy (e,d,m),ts)) (2)
Required pre-conditions are assertions that condition the execu-
tion of preserve (a,ts) upon having received notification about the
occurrence of a primitive event in the environment, receive (a,ts). Re-
quired trigger-conditions are conditions upon the (non-)preservation
of other primitive events. An example of a preservation specifica-
tion of operation preserve (sys_copy (e,d,m),ts)is
∀ts:Timestamp ,e:Emp,d:Doc,m:Comp
G(¬received (sys_copy (e,d,m),ts)→
X¬preserve (sys_copy (e,d,m),ts)) (3)
∀ts:Timestamp ,e:Emp,d:Doc,m:Comp
∃ts1,ts2:Timestamp .ts1<ts2∧ts2<ts
G(received (sys_copy (e,d,m),ts)∧
preserved (sys_login (e,d,m),ts1)∧preserved (sys_mount (s,m),ts2)
∧∄ts3,ts4:Timestamp .(ts3>ts1∧ts3≤ts∧ts4>ts2∧ts4≤ts∧
preserved (sys_logout (e,m),ts3)∧preserved (sys_unmount (s,m),ts4))→
Xpreserve (sys_copy (e,d,m),ts)) (4)
Assertion 3 specifies the required pre-condition, i.e., receiving no-
tification of the occurrence of sys_copy (e,d,m). Assertion 4 expressesESEC/FSE’17, September 4–8, 2017, Paderborn, Germany Dalal Alrajeh, Liliana Pasquale, and Bashar Nuseibeh
a trigger-condition forcing the FR controller to preserve occurrence
ofsys_copy (e,d,m)if it has already preserved information about
an employee’s logging onto a computer and the mounting of a
storage device on that computer, but no subsequent occurrence
about the employee logging out or unmounting of the storage de-
vice is recorded. The preservation specification PSdefines a FR
controller’s storage capacities as a set of executable sequences of
preserve operations of the form
π={preserve (a1
1,ts1), ..., preserve (ak
1,ts1)}1, ...,
{preserve (a1m,tsm), ..., preserve (arm,tsm)}m
We say that πis a potential log if πsatisfies PS(according to stan-
dard trace semantics of LTL) and for each preserve (ai
j,tsj)∈π(j),
its required trigger-condition is non-vacuously satisfied in πat
position j. The notation π(j)indicates the set of operations that
occur at position j.
We restrict our definition of preservation specifications to those
that ensure the minimality and relevance of all potential logs to
hypotheses under consideration. Such a specification is referred
to as forensic-ready. To express forensic-ready preservation speci-
fications, we first consider the notion of a specification covering
potential histories.
Definition 4.1. [Specification Coverage] Let PSbe a preservation
specification and υ=(he1, ...,hen)a hybrid history. Then PSis said
tocoverυ, iff there exists a potential log π=(fe1, ...,fen)∈Π(PS)
isomorphic to υ|Ap, i.e., for every primitive event a∈(hei)|Ap,
preserve (a,tsi)∈fei.
The isomorphism with respect to potential histories guaran-
tees the preservation of events related to an incident. Furthermore,
since the isomorphism is defined with respect to minimally sup-
portive histories of hypotheses in Hthis ensures minimality of
preserved event occurrences. It also, together with the requirement
for hypothesesHto be refutable by potential histories of E,ϒ−(E),
supports relevance of events stored through preserve operations.
Definition 4.2. [Forensic-ready Specification] Let Ebe an envi-
ronment description and Ha hypothesis that is both supportable
and refutable inEbyϒ+(E)andϒ−(E)respectively. Let PSbe a
preservation specification. Then PSis said to be forensic-ready with
respect toHinEiffPScovers every history in min (ϒ+(E),h)for
every h∈H and does not cover any ϒ−(E).
Any FR controller whose specification is forensic-ready with
respect toHinEis sufficient to guarantee evidence preservation
requirements of relevance and minimality.
5 SPECIFICATION GENERATION
Based on our formulation above, we propose a systematic approach
(Figure 3) for generating forensic-ready preservation specifications.
Our approach takes as input an environment description E, a set
of speculative incident hypotheses H, elicited, for instance, by a
domain expert, and an initial preservation specification PS, writ-
ten in LTL, which contains domain pre- and post-conditions of
preservation operations. We assume that the description of the
environment is correct and the speculative hypotheses of concern
are known at design-time. The approach provides as output either:
(i) a confirmation that (some) hypotheses are not supportable in
the environment; (ii) a confirmation that the FR controller does
not have the capabilities to ensure the forensic-readiness of itspreservation specification; or (iii) a preservation specification that
is guaranteed to be forensic-ready with respect to HinE. The
approach comprises three phases as described below.
someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISE,H,⌥+(E),⌥ (E)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes (             )
History Generation1yes ( A )Revise 
Preservation Speciﬁcation SynthesisyesSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23no ( B )To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalnoDomain ExpertEnvironmentεHypotheses 
A = {                    }someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISE,H,⌥+(E)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes {            ,             }
SoftwareEngineer
History Generation1yes {            }Revise 
Preservation Speciﬁcation SynthesisnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23EnvironmentεA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-yesA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements [?]. The controlled oper-ations for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved by the Controller in the storage, if the latteralready contains entries about the occurrences of employee’slogging to a computer and the mounting of a storage device onit, and no entries about employee’s logging out from computerand unmounting of the storage device from the computer arestored.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[16], [7]. The generation of such abstractions is outside thescope of the paper. We...Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISOur approach for synthesising the preservation speciﬁcation(see Figure 3) requires as input an environment descriptionE, and a set of speculative incident hypothesesHthat aresupportable and refutable byE. Such inputs can be provided,for instance, by the software engineer. We assume that thedescription of the environment is correct and the speculativehypotheses are known a-priori, before an investigation starts.Preservation speciﬁcation synthesis is performed in threephases.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)with respect toH. The existenceof histories in⌥+(E)ensures that the hypotheses of inter-est are feasible within the intended environment. If⌥+(E)is empty, this means that the either the hypothesis cannotoccur within the environment described, and thus may notbe a security concern, or that the environment descriptionand/or the speculative hypotheses are incorrect and need tobe revised (e.g., by a security administrator). The histories⌥ (E)operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.2) Speciﬁcation Veriﬁcation.Given the generated⌥+(E), wecheck if the primitive history projection for each history is‘covered’ by the preservation speciﬁcation, i.e., there existscorresponding potential log. If this is the case, then thecurrent preservation speciﬁcationOSsatisﬁes the preservationrequirements and the process terminates. If some primitivehistory projection is not, then new operational preservationspeciﬁcation must be synthesised in the next phase.3) Speciﬁcation Synthesis.The synthesis aims to learn anewReqPreand required trigger-conditionsReqTrighat wouldprescribe the preservation of the potential histories⌥+(E)and not those in⌥ (E). The output is a set of required pre-conditions . The new speciﬁcationOS0is given as input to theforensic-ready controller that is responsible for its enactmentduring the system operation.To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalHypotheses 
no
Fig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESIS⌥ (E)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes {            ,             }
SoftwareEngineerHistory Generation1yes {            }Revise 
Preservation Speciﬁcation SynthesisnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23EnvironmentεA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-yesA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements [?]. The controlled oper-ations for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved by the Controller in the storage, if the latteralready contains entries about the occurrences of employee’slogging to a computer and the mounting of a storage device onit, and no entries about employee’s logging out from computerand unmounting of the storage device from the computer arestored.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[16], [7]. The generation of such abstractions is outside thescope of the paper. We...Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISOur approach for synthesising the preservation speciﬁcation(see Figure 3) requires as input an environment descriptionE, and a set of speculative incident hypothesesHthat aresupportable and refutable byE. Such inputs can be provided,for instance, by the software engineer. We assume that thedescription of the environment is correct and the speculativehypotheses are known a-priori, before an investigation starts.Preservation speciﬁcation synthesis is performed in threephases.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)with respect toH. The existenceof histories in⌥+(E)ensures that the hypotheses of inter-est are feasible within the intended environment. If⌥+(E)is empty, this means that the either the hypothesis cannotoccur within the environment described, and thus may notbe a security concern, or that the environment descriptionand/or the speculative hypotheses are incorrect and need tobe revised (e.g., by a security administrator). The histories⌥ (E)operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.2) Speciﬁcation Veriﬁcation.Given the generated⌥+(E), wecheck if the primitive history projection for each history is‘covered’ by the preservation speciﬁcation, i.e., there existscorresponding potential log. If this is the case, then thecurrent preservation speciﬁcationOSsatisﬁes the preservationrequirements and the process terminates. If some primitivehistory projection is not, then new operational preservationspeciﬁcation must be synthesised in the next phase.3) Speciﬁcation Synthesis.The synthesis aims to learn anewReqPreand required trigger-conditionsReqTrighat wouldprescribe the preservation of the potential histories⌥+(E)and not those in⌥ (E). The output is a set of required pre-conditions . The new speciﬁcationOS0is given as input to theforensic-ready controller that is responsible for its enactmentduring the system operation.To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalHypotheses 
noFig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,B = {                                                     }someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISE,H,⌥+(E),⇧+(OS),⇧ (OS)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes {            ,             }
SoftwareEngineer
History Generation1yes {            }Revise 
Preservation Speciﬁcation SynthesisnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23EnvironmentεA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-yesA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements [?]. The controlled oper-ations for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved by the Controller in the storage, if the latteralready contains entries about the occurrences of employee’slogging to a computer and the mounting of a storage device onit, and no entries about employee’s logging out from computerand unmounting of the storage device from the computer arestored.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[16], [7]. The generation of such abstractions is outside thescope of the paper. We...Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISOur approach for synthesising the preservation speciﬁcation(see Figure 3) requires as input an environment descriptionE, and a set of speculative incident hypothesesHthat aresupportable and refutable byE. Such inputs can be provided,for instance, by the software engineer. We assume that thedescription of the environment is correct and the speculativehypotheses are known a-priori, before an investigation starts.Preservation speciﬁcation synthesis is performed in threephases.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)with respect toH. The existenceof histories in⌥+(E)ensures that the hypotheses of inter-est are feasible within the intended environment. If⌥+(E)is empty, this means that the either the hypothesis cannotoccur within the environment described, and thus may notbe a security concern, or that the environment descriptionand/or the speculative hypotheses are incorrect and need tobe revised (e.g., by a security administrator). The histories⌥ (E)operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.2) Speciﬁcation Veriﬁcation.Given the generated⌥+(E), wecheck if the primitive history projection for each history is‘covered’ by the preservation speciﬁcation, i.e., there existscorresponding potential log. If this is the case, then thecurrent preservation speciﬁcationOSsatisﬁes the preservationrequirements and the process terminates. If some primitivehistory projection is not, then new operational preservationspeciﬁcation must be synthesised in the next phase.3) Speciﬁcation Synthesis.The synthesis aims to learn anewReqPreand required trigger-conditionsReqTrighat wouldprescribe the preservation of the potential histories⌥+(E)and not those in⌥ (E). The output is a set of required pre-conditions . The new speciﬁcationOS0is given as input to theforensic-ready controller that is responsible for its enactmentduring the system operation.To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalHypotheses 
no
Fig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,Fig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,and thus it will not required to be considered during a digitalinvestigation, or that the environment description and/or the
History Generation1yes (A)Revise 
Speciﬁcation GenerationnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23yes (B)noDomain ExpertEnvironmentεHypotheses 
A = {                                }someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISE,H,⌥+(E),⌥ (E)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes (             )
History Generation1yes ( A )Revise 
Preservation Speciﬁcation SynthesisyesSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23no ( B )To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalnoDomain ExpertEnvironmentεHypotheses 
A = {                    }someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISE,H,⌥+(E)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes {            ,             }
SoftwareEngineer
History Generation1yes {            }Revise 
Preservation Speciﬁcation SynthesisnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23EnvironmentεA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-yesA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements [?]. The controlled oper-ations for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved by the Controller in the storage, if the latteralready contains entries about the occurrences of employee’slogging to a computer and the mounting of a storage device onit, and no entries about employee’s logging out from computerand unmounting of the storage device from the computer arestored.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[16], [7]. The generation of such abstractions is outside thescope of the paper. We...Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISOur approach for synthesising the preservation speciﬁcation(see Figure 3) requires as input an environment descriptionE, and a set of speculative incident hypothesesHthat aresupportable and refutable byE. Such inputs can be provided,for instance, by the software engineer. We assume that thedescription of the environment is correct and the speculativehypotheses are known a-priori, before an investigation starts.Preservation speciﬁcation synthesis is performed in threephases.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)with respect toH. The existenceof histories in⌥+(E)ensures that the hypotheses of inter-est are feasible within the intended environment. If⌥+(E)is empty, this means that the either the hypothesis cannotoccur within the environment described, and thus may notbe a security concern, or that the environment descriptionand/or the speculative hypotheses are incorrect and need tobe revised (e.g., by a security administrator). The histories⌥ (E)operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.2) Speciﬁcation Veriﬁcation.Given the generated⌥+(E), wecheck if the primitive history projection for each history is‘covered’ by the preservation speciﬁcation, i.e., there existscorresponding potential log. If this is the case, then thecurrent preservation speciﬁcationOSsatisﬁes the preservationrequirements and the process terminates. If some primitivehistory projection is not, then new operational preservationspeciﬁcation must be synthesised in the next phase.3) Speciﬁcation Synthesis.The synthesis aims to learn anewReqPreand required trigger-conditionsReqTrighat wouldprescribe the preservation of the potential histories⌥+(E)and not those in⌥ (E). The output is a set of required pre-conditions . The new speciﬁcationOS0is given as input to theforensic-ready controller that is responsible for its enactmentduring the system operation.To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalHypotheses 
no
Fig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESIS⌥ (E)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes {            ,             }
SoftwareEngineerHistory Generation1yes {            }Revise 
Preservation Speciﬁcation SynthesisnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23EnvironmentεA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-yesA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements [?]. The controlled oper-ations for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved by the Controller in the storage, if the latteralready contains entries about the occurrences of employee’slogging to a computer and the mounting of a storage device onit, and no entries about employee’s logging out from computerand unmounting of the storage device from the computer arestored.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[16], [7]. The generation of such abstractions is outside thescope of the paper. We...Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISOur approach for synthesising the preservation speciﬁcation(see Figure 3) requires as input an environment descriptionE, and a set of speculative incident hypothesesHthat aresupportable and refutable byE. Such inputs can be provided,for instance, by the software engineer. We assume that thedescription of the environment is correct and the speculativehypotheses are known a-priori, before an investigation starts.Preservation speciﬁcation synthesis is performed in threephases.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)with respect toH. The existenceof histories in⌥+(E)ensures that the hypotheses of inter-est are feasible within the intended environment. If⌥+(E)is empty, this means that the either the hypothesis cannotoccur within the environment described, and thus may notbe a security concern, or that the environment descriptionand/or the speculative hypotheses are incorrect and need tobe revised (e.g., by a security administrator). The histories⌥ (E)operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.2) Speciﬁcation Veriﬁcation.Given the generated⌥+(E), wecheck if the primitive history projection for each history is‘covered’ by the preservation speciﬁcation, i.e., there existscorresponding potential log. If this is the case, then thecurrent preservation speciﬁcationOSsatisﬁes the preservationrequirements and the process terminates. If some primitivehistory projection is not, then new operational preservationspeciﬁcation must be synthesised in the next phase.3) Speciﬁcation Synthesis.The synthesis aims to learn anewReqPreand required trigger-conditionsReqTrighat wouldprescribe the preservation of the potential histories⌥+(E)and not those in⌥ (E). The output is a set of required pre-conditions . The new speciﬁcationOS0is given as input to theforensic-ready controller that is responsible for its enactmentduring the system operation.To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalHypotheses 
noFig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,B = {                                                     }someb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executed tosatisfy preservation requirements [46]. The controlled opera-tions for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved, if the controller already preserved infor-mation about an employee’s logging onto a computer and themounting of a storage device on it, but not a subsequent entryabout his/her logging out or unmounting of the storage device.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[24], [10]. The generation of such abstractions is outside thescope of the paper.Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISE,H,⌥+(E),⇧+(OS),⇧ (OS)Our approach for synthesising the preservation speciﬁcation(see Fig. 3) takes as input an environment descriptionE, and aset of speculative incident hypothesesH, elicited, for instance,by a domain expert (software engineer or security administra-tor). We assume that the description of the environment iscorrect and the speculative hypotheses of concern are knownat design-time. The approach comprises three phases.
 yes {            ,             }
SoftwareEngineer
History Generation1yes {            }Revise 
Preservation Speciﬁcation SynthesisnoSpeciﬁcationVeriﬁcationSpeciﬁcationSynthesis23EnvironmentεA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-yesA history may occur at various levels [?]. It is called aprimitive (resp. complex) history, denoted (resp.!), if allthe events that appear in it are primitive (resp. complex).Wewrite!=ce1,. . .cento denote a complex history whereceiisthe set of complex events occurring concurrently at positioni, and similarly for a primitive history .An environment descriptionEis interpreted over a sequenceof primitive and complex events (we refer to as a hybridhistory ). Its satisfaction is determined with respect to thesatisfaction of complex events’ composite deﬁnitions inBaccording toI.For the satisfaction of an event’s composite deﬁnition, weconsider the notion of a ‘narration’ (a total order over thepartial order given in a complex event’s deﬁnition). For anarration to be constructed, each complex event appearing ina deﬁnition is reﬁned until all complex events are reduced totheir primitive events and context relation literals. The resultof this reﬁnement procedure applied to deﬁnitiondis a set ofcomposite deﬁnitions (d). Note that context relation literalsare not reﬁned by their initiating and terminating events.1Given (d), a narration of adis captured with respect toone of the elements in (d). We will use the notation |Ap(reps. |Ac) to denote the projection of over primitive(reps. complex) events inAp(resp.Ac).Deﬁnition 5 (Narration of Composite Deﬁnition):LetB=hAp,Ac,K,D,/ibe a behaviour description andd=hLd, d, d,Apd,Acd,KLdia composite deﬁnition inD. Let (d)bethe set of deﬁnitions obtained reﬁningd. A narration ofdisa hybrid history =he1,. . . ,hem, if there exists ad02 (d)and a total orderl1 ... lnoverLd0such that:•for allli,lj2Ld0, ifli ljthena<b(where1a, bm),• d0(li)|Ap=(hea)|Ap• d0(li)|Ac=(hea)|Ac.where (l)|Apand (l)|Acdenote the set of primitive eventsand complex events respectively assigned to time-labell.For instance the following are three example narrations forenter(alice,r01)’s composite deﬁnition 1=({swipecard(alice,nfc),cctvaccess(alice,r01,cctv1),enter(alice,r01)}1) 2=({swipecard(alice,nfc)}1,,{cctvaccess(alice,r01,cctv1),enter(alice,r01)}2) 3=({cctvaccess(alice,r01,cctv1)}1,{swipecard(alice,nfc),enter(alice,r01)}2)Context descriptions’ relations are interpreted over complexhistories. Givenk⌘hINk,TRk,initki2I,kis true at positionbin a complex history!=ce1,. . . ,ceb,. . . ,ceniff either thefollowing holds:•initk^8a2N,eTRk2TRk.(0<a<b)!eTRk62cea;•9a2N.(a<b)^(eINk2cea^8g2N,eTRk2TRk.((a<g<b)!eTRk62ceg).otherwise it is said to be false. We assume histories in whichterminating and initiating events for a context relation do not1See github an outline of a reﬁnement algorithm??for obtaining (d).occur concurrently. We now deﬁne the satisfaction of complexevent deﬁnitions histories as follows.Deﬁnition 6 (Complex Event Deﬁnition Satisfaction):Givenan environment descriptionE=(B,C,I), a complex event def-initione/d2Band a hybrid history , is said to satisfye/dwith respect toEif for every decomposition =xyz,ify=hea,. . . ,heg,. . . ,hebis a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nthen:•e2(heb)|Ac•ifdis a composite deﬁnition andkl2 d0(l0j)|KLthen |Ac,g|=klwhere (l)|KLdenotes the set context relation literals assignedto time-labell.The environment descriptionEis said to be satisﬁed ina hybrid history if every complex event deﬁnition inBissatisﬁed in that history. We write⌥(E)to denote the set ofhybrid histories that satisfyE.C. HypothesesThe termhypothesisin a digital investigation is a conjecturethat may refer, for instance, to past events in the lifetimeof digital devices, the time span during which a system wasoperational, system capabilities and conﬁgurations [?], [?].In this paper, we focus on one type of hypothesis rel-evant to developing forensic-ready systems, theenviron-ment construction hypothesis. This form of hypothesis pos-tulates about the feasibility of events occurrence and pres-ence of contextual conditions of interests. It may be cap-tured as an event’s composite deﬁnitionh/d, wherehis a complex event marking the satisfaction of a hypoth-esis, and withApindbeing empty andAcandKLcontaining only complex events and context relation lit-erals respectively. For instance the hypothesisIllegalCopy/h{l1},;,;,{copy(bob,doc,m1)},{mounted(usb1,m1)},{l1!{mounted(usb1,m1),copy(bob,doc,m1)}}i.Hypotheses are interpreted overﬁnitecomplex histories.Their satisfaction is given by the deﬁnition below.Deﬁnition 7 (Hypotheses Satisfaction):A hypothesish(withdeﬁnitionh/d) is said to be satisﬁed in a complex history!at positionb, i.e.,!,b|=h, if there exists a decomposition!=xyzsuch thaty=cea,. . . ,ceg,. . . ,cebthat is a narration ofdwith respect tod02 (d)and orderl01 ... l0j ... l0nand ifkl2 d0(l0j)|KLthen |Ac,g|=kl.We distinguish betweensupportableandrefutablehypothe-ses in environmentE.Deﬁnition 8 (Hypotheses Supportability and Refutability):Let⌥(E)be the set of hybrid histories satisfyingE.Ahypothesish(with deﬁnitionh/d) is said to besupportableinEif there exists a hybrid history 2⌥(E)such that forsomeb, |Ac,b|=h. It is said to be refutable if there exists ahistory 2⌥(E)such that for allb, |Ac,b6|=h.We will denote the set of hybrid histories in⌥(E)supportingHas⌥+(E)and those refuting it⌥ (E). Consider thepotential hybrid history shown in Fig.??, since there is a de-composition of that yields a narration of the deﬁnition ofIl-legalCopyhypothesis such that |Ac,5|=mounted(usb1,m1),thenIllegalCopyis supportable inE.D. Operational Preservation SpeciﬁcationOperational preservation speciﬁcationsOSspecify the op-erations that can be performed by the Controller componentin terms of domain-speciﬁc conditions, as well as additionalconstraints for when operations may and must be executedto satisfy preservation requirements [?]. The controlled oper-ations for the controller are a set ofpreserve(a,ts) operationswhereaindicates the occurrence of a primitive event in theenvironment, andtsmarks the time-stamp instance (from thesystem clock) at which the occurrence was observed by thecontroller. The monitored event (and condition) are the receiptof a notiﬁcation of occurrence captured by thereceive(a,ts)operation whereaandtsare as before.Thedomain-speciﬁc conditioncaptures the basic state tran-sitions deﬁned by the application of an operation in thedomain. It is speciﬁed as a pair containing a domain pre-condition (DomPre) and a domain post-condition (DomPost),e.g.,¬preserved(a,ts)andpreserved(a,ts).Required condi-tions, on the other hand, capture strengthened conditionson the software-controlled operations that contribute to thesatisfaction of the requirements. They are expressed in theform ofrequired pre-andtrigger- conditions.Required pre-conditions(ReqPre) are conditions that capture apermissiontoperform apreserveoperation.Required trigger-conditions(Re-qTrig) are conditions that capture anobligationto perform apreserveoperation. An example of an operational preservationrequirements for the operationspreserve(syscopy(e,d,m),ts)(for some employeee, documentdand computerm) isDomPre(preserve(syscopy(e, d, m),ts)) ={¬preserved(syscopy(e, d, m,ts)}DomPost(preserve(syscopy(e, d, m),ts)) ={preserved(syscopy(e, d, m,ts)}ReqPre(preserve(syscopy(e, d, m),ts)) ={received(syscopy(e, d, m),ts),ReqTrig(preserve(syscopy(e, d, m),ts)) ={9ts1,ts2,ts3,ts42Clock,s2Str.ts1<ts3^ts2<ts3^ts3<t s4<ts^preserved(syslogin(e, d, m),ts1)^preserved(sysmount(s, m),ts2)^¬preserved(syslogout(e, m),ts3)}The above says that the occurrence of the eventsyscopymust be preserved by the Controller in the storage, if the latteralready contains entries about the occurrences of employee’slogging to a computer and the mounting of a storage device onit, and no entries about employee’s logging out from computerand unmounting of the storage device from the computer arestored.An operational preservation speciﬁcationOSdeﬁnes all ad-missible preservation capacities (potential logs) as sequencesofpreserveoperations that may be executed by the con-troller (and devices). We call each sequence a potential logand write it in the form (⇡={preserve(a11,ts1)}1, ...,{preserve(a1m,tsm)}m). The set of potential logs admissiblebyOSis denoted as⇧(OS).We now deﬁne the forensic readiness speciﬁcation. Notethat we considertsito be an abstraction over real-time clockvariables that may be obtained following techniques such as[16], [7]. The generation of such abstractions is outside thescope of the paper. We...Deﬁnition 9 (Preservation Coverage and Completeness):Given an environment descriptionEand a hypothesisHthat isboth supportable and refutable inE. LetOSbe an operationalpreservation speciﬁcation. ThenOSis said to becoverapotential history =(he1,. . . ,hen)2⌥+(E), if there exists apotential log⇡=(fe1,. . . ,fen)2⇧(OS), such that for everya2(hei)|Ap,preserve(a,tsi)2fei(OScovers for short.) Itis said to bepreservation complete w.r.t.EandHif it coversall potential histories in⌥+(E)and not any history in⌥ (E).We say the any speciﬁcation that meets the preservationcompleteness described above achieves the preservation re-quirement forHinE, denotedRH, and by abuse of notationdenote this asE,H,OS|=RH.V. PRESERV ATIONSPECIFICATIONSYNTHESISOur approach for synthesising the preservation speciﬁcation(see Figure 3) requires as input an environment descriptionE, and a set of speculative incident hypothesesHthat aresupportable and refutable byE. Such inputs can be provided,for instance, by the software engineer. We assume that thedescription of the environment is correct and the speculativehypotheses are known a-priori, before an investigation starts.Preservation speciﬁcation synthesis is performed in threephases.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)with respect toH. The existenceof histories in⌥+(E)ensures that the hypotheses of inter-est are feasible within the intended environment. If⌥+(E)is empty, this means that the either the hypothesis cannotoccur within the environment described, and thus may notbe a security concern, or that the environment descriptionand/or the speculative hypotheses are incorrect and need tobe revised (e.g., by a security administrator). The histories⌥ (E)operates as a proxy for the synthesis phase to ensureonly relevant event occurrences are preserved.2) Speciﬁcation Veriﬁcation.Given the generated⌥+(E), wecheck if the primitive history projection for each history is‘covered’ by the preservation speciﬁcation, i.e., there existscorresponding potential log. If this is the case, then thecurrent preservation speciﬁcationOSsatisﬁes the preservationrequirements and the process terminates. If some primitivehistory projection is not, then new operational preservationspeciﬁcation must be synthesised in the next phase.3) Speciﬁcation Synthesis.The synthesis aims to learn anewReqPreand required trigger-conditionsReqTrighat wouldprescribe the preservation of the potential histories⌥+(E)and not those in⌥ (E). The output is a set of required pre-conditions . The new speciﬁcationOS0is given as input to theforensic-ready controller that is responsible for its enactmentduring the system operation.To the best of our knowledge, this paper is the ﬁrst to deﬁneand formalise preservation requirements within a softwareengineering context and to propose an automatic means forsynthesising speciﬁcations that satisfy them.II. MOTIVATINGEXAMPLEOur motivating example is a corporate fraud incident,inspired by the Galleon Group case [19]. We consider anenvironment within an enterprise building, where two employ-ees,aliceandbob, work (see Fig. 1).bobandalicehavelaptops (m2andm3, respectively), provided by the company.A sensitive documentdocis stored on the server machinem1that is located in the ofﬁcer01. Access tor01is controlledby anfcreader and is monitored by acctvcamera. Bothaliceandbobare authorised to accessr01and to login tom1. Anincident of concern is related to the exﬁltration of thedoc.Activities such entering a room may be observed (inferred)through low level system events that can be observed fromdigital devices, referred to as evidence sources. Examples oflow level events can be a log entry on an external server towhichcctvis connected identifying an agent coming throughthe room door, or annfclog entry recording the reading of acard tag.
employee: aliceemployee: bob
laptop: m2laptop: m3
desktop: m1ﬁle: doc
location: r01
reader: nfc1camera: cctv1
storage: ubs1 Fig. 1. Setting of our motivating example.Suppose that a digital investigation related to thedocexﬁltration is initiated. An investigator may suspect that thedocwas copied onto a storage device mounted onm1and mayformulate ahypothesison this basis. However she is uncertainabout what exact events must have occurred for this hypothesisto be true. Hence, she reconstructs various scenarios about pos-sible system events that could have occurred (i.e.,histories).One possibility is thataliceenteredr01, performed the logintom1, mountedusb1onm1and copied thedoc. Anotheris thatbobentered the room but usedalice’s credentials tologin tom1and copy the ﬁle ontousb1. A more sophisticatedalternative may be thataliceaccessedr01and mounted astorage device, and she subsequently copied thedocin thestorage remotely. Each of these possibilities would require theinvestigator to identify the relevant devices, search through therecords for each of these devices (e.g., logs from all readers,cctv recordings, and hard drives for all machines) and checkif they support or refute her hypothesis.Given the multitude of histories that could be constructedwithin an environment, a sound investigation would be depen-dent ona)the investigators’ ability to reconstruct all possiblehistories,b)the devices to preserve the required activitiesthat correspond to such histories andc)the investigators toexamine all these against the hypotheses. As the volume ofdata to analyse is high, the context of incident unfamiliar,and pressure to deliver results ever-increasing, the cognitiveload on investigators escalates, making way for evidence andnegative biases to go unnoticed [?]. Furthermore, as eventsfrom devices could be concealed by offenders (clearing hard-drive system history) or might not be retained by a device (ﬁlecopies events), potential evidence may be lost.Although preserving all events that can be observed frompotential evidence sources in the environment may seemplausible, examination of large data-sets is often expensiveand time-consuming and may mask what is truly relevant forthe investigation. For example, 60 days cctv footages wouldoccupy⇠10 TB, while a hard drive occupies⇠500 GB onaverage. In the example, not all ﬁle copy events are relevant tosupport the speculative hypothesis, but only those taking placewhile a storage device is currently mounted. Therefore, thereis a pressing need for developing systems that areforensic-ready, i.e., that can preserve ‘relevant’ evidence proactively.III. PROBLEMSTATEMENTIn this paper we attempt to address two questions: 1) Canpreservation requirements be formulated precisely? 2) Whatare the system speciﬁcations that could achieve them and canthese by synthesised automatically?To articulate the problem, we follow Jackson and Zave [17],[31] approach to requirements deﬁnitions and satisfaction.In their requirements reference model [], to guarantee thata machine achieves its requirementsR, it is necessary toshow that its speciﬁcationSsatisﬁesW, S|=R, whereWcaptures some ‘domain knowledge’ — descriptive assertionsabout world phenomena that are true regardless of behaviourof the machine. In our settingWcomprises theenvironmentdescriptionE, and thespeculative incident hypothesesH. The‘speciﬁcation’Srepresents operational constraints over whatand when the ’machine’, must preserve having speculatedover events lying in the shared phenomena. In our case, thesespeciﬁcations asoperational preservation speciﬁcations,OS.With this frame of mind, thepreservation requirementsareproperties overE,HandOSrequiringOSto preserve anyevent belonging to any history that shows howEmay satisfyH(i.e.,E,H,OS|=RH), whereRHdenotes the requirementpreservations with respect to hypothesesH.Section IV formalises the concepts needed for deﬁning thepreservation requirement problem preciesly. Section V pro-poses an approach for synthesising preservation speciﬁcationsfrom speculated hypotheses and environment descriptions.For the latter we assume the design choice of having asingle Controller that interacts with the individual evidencesources and whose preservation speciﬁcation we synthesise(See Fig. 2). The Controllerreceives events from the digitalHypotheses 
no
Fig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,Fig. 3. Our approach for synthesising preservation speciﬁcations.1) History Generation.In this phase, we search for hybridhistories⌥+(E)and⌥ (E)supporting and refutingHre-spectively. The existence of histories in⌥+(E)ensures thatthe hypotheses of interest are feasible within the intendedenvironment. If⌥+(E)is empty, this means that either thehypothesis cannot occur within the environment described,and thus it will not required to be considered during a digitalinvestigation, or that the environment description and/or thePSPS'FR Controller12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758On Evidence Preservation Requirementsof Forensic-ready Systems ESEC/FSE 2017, 4–8 September, 2017, Paderborn, Germany3) Speci￿cation Synthesis.￿e synthesis phase considersE,H,PS,{ +i}and{  j}. From this it learns a new set of required pre-and trigger-conditions that would prescribe the preservation of allpotential logs{ +i}but not in{  j}, are learned and added toPS.￿e new speci￿cationPS0is given as provided to the controller thatis responsible for its enactment.Note the steps above suppose a design-time synthesis approach,rather than a run-time one.￿e la￿er is constitutes future work.6 TOOL IMPLEMENTATIONAs a proof of concept, we have implemented a prototype tool forsynthesising forensic-ready preservation speci￿cations. Our solu-tion uses a (i) declarative language based on the Event Calculuslogic program2[21] to represent and reason about the environmentdescriptions, speculative hypotheses, preservation speci￿cationsand potential histories and logs in a uniform way, (ii) a Booleanconstraint solver for logic programs, called clingo [], to computepotential histories and logs that satisfy or refute hypotheses, and(iii) and a logic-based learner, called XHAIL [], to synthesise preser-vation speci￿cations from examples of potential logs.￿e encodingof the input as well as the execution of the three phases in Section5 are done automatically.￿e user is expected to provide the initialinput, and the maximum length of the potential histories to beconsidered in the approach.In brief, the history generation phase￿rst tries to￿nd two setsof models, called answer sets of the program, denotedANS+(LE[LH)nandANS (LE[LH)n, where each element in the￿rst com-prises a historyL +⇢ANS+(LE[LH)nofEof lengthnminimallysupportive of a hypothesis inHand each of the second containsa historyL  ⇢ANS (LE[LH)nthat refutes a hypothesis inH.￿is is done through by solving a constraint that requires ahypothesisLh2LHto be satis￿ed by at least one potential historyconsistent withLE.￿e solver searches for the optimal solutionwhich equates to the minimally supportive or refutive history ofh.We denote the set of minimally supportive hypotheses asL +(E)and the minimally refutive asL  (E).￿e speci￿cation veri￿cation phase then considers the computedhistoriesL +(E),L  (E), programLE[LHand programLPS.￿ephase performs several calls to the solver to check for coverage andnon-coverage of each historyL +(E)andL  (E)respectively bythe controller speci￿cationLPS(phase 2). If this is not the case thenpotential logs{ +i}and{  j}that correspond toL +(E)[L  (E)respectively andLE[LHare given to a logic-based learner [] tocompute pre- and trigger-conditions to ensure the preservations ofthese.To conduct the analysis, our implementation translates the inputmodel into an Event Calculus (EC) logic program [21], a formalism—-. (However, the same technique is implementable in any languagesupporting some form of behavioural modelling and declarativesynthesis of temporal speci￿cations.) It has been successfully de-ployed in the context of specifying requirements operationalisation[3,4] and reasoning about evidence in digital investigations [40].It runs an o￿-the- shelf model generation tool, clasp Gebser:2011,to compute histories. Our use of ASP as the underlying veri￿cation2An logic program is a collection of rules of the formlk lk+1,. . . ,ln,not ln+1,. . . ,not lmengine is motivated by its capacity to handle di￿cult (NP-hard)search problems for EC programs.￿e analysis in clasp is boundedup to a user-speci￿ed scope on the size of the domains which corre-sponds to the number of entities, events and the maximum lengthof histories that will be generated. Details of the encoding areavailable on h￿ps://github.com/lpasquale/minorityReport.7 EVALUATIONOur evaluation aims to assess whether the quality of the synthe-sised preservation speci￿cation, particularly whether it prescribesto preserve i)relevant eventsand ii)the minimum amount of eventsnecessary to support speculative hypotheses of potential incidents.To achieve this aim we developed a prototype tool (implemented inPython) and used two incident scenario data-sets that are availablepublicly for research and training purposes. Each data-set includesthe data that an investigator would have to examine to explain -if possible - how the associated incident scenario occurred.￿etool and case study application are available online3. For eachscenario, we manually modelled the environment and the specula-tive hypotheses in EC. Note that each log entry and event type inthe data-sets is mapped to a primitive event modelled in the envi-ronment. From this, we used our tool to automatically synthesisepreservation speci￿cations.{ i+},{ j }To assess whether the synthesised speci￿cation prescribes to pre-serve relevant events, we veri￿ed whether the primitive events thatthe speci￿cation prescribes to preserve are relevant to support someof the speculative incident hypotheses. Note that although some ofthese primitive events may correspond to log entries/events in thedata-set, others might not be available because they have not beenretained by the digital source. To assess whether the synthesisedspeci￿cation prescribes to preserve the minimum amount of events,we measured whether the speci￿cation would prescribe the preser-vation of fewer log entries/events compared to those included inthe data-set. We also measured how many of the log entries/eventsfrom the data-set, which our speci￿cation prescribed to preserve,were irrelevant to support the satisfaction of the speculative hy-potheses. At the end of the section we discuss threats to validity ofour approach.7.1 Relevance and Minimality￿e￿rst incident scenario we considered is set in a university, wherestudents and academic sta￿can send emails by using the universityand students’ residence internal network.￿e data-set4includes theTCP packets captured from the routers located inside the students’residence.￿erefore we considered the routers as the digital sourceswithin the environment and adopted primitive events to representspeci￿c network tra￿c that may berelated to emails exchanges.We modelled the following primitive events: IMAP/POP networktra￿c(SUE) related to emails sent from external addresses to anacademic (SUE); incoming HTTP tra￿c adopted to set-up a cookie3h￿ps://github.com/lpasquale/minorityReport4h￿p://digitalcorpora.org/corpora/scenarios/nitroba-university-harassment-scenarioB = {          PS,                    }
Figure 3: Specification generation approach.
1) History Generation. In this phase, we search for hybrid his-
tories ϒ+(E)andϒ−(E)that minimally support and that refute
H, respectively. The existence of histories in ϒ+(E)ensures that
the hypotheses of interest are feasible within the intended envi-
ronment. If ϒ+(E)is empty, this means that either the hypothesis
cannot occur within the environment described, and thus it will
not require to be considered during a digital investigation, or that
the environment description and/or the speculative hypotheses are
incorrect and need revision. The histories ϒ−(E)operate as a proxy
for the synthesis phase to ensure only relevant event occurrences
are preserved.
2) Specification Verification. Given the generated ϒ+(E), we
check if each history is potentially covered by the preservation spec-
ification, i.e., there exists a corresponding potential log in Π(PS). If
some history in ϒ+(E)is not, then this may be owing to one of two
cases: (i) the FR controller and the digital devices do not have the
capabilities needed to, respectively, preserve the potential logs and
monitor the relevant events; or (ii) they do but require an opera-
tional preservation specification to be synthesised to ensure their
preservation. In the case of the former, the approach terminates,
indicating a need for additional capabilities. In the latter case, cor-
responding potential logs {π+
i}and{π−
j}are produced and passed
onto the third phase.
3) Specification Synthesis. The synthesis phase considers E,H,
PS,{π+
i}and{π−
j}. It searches, within a space of candidate expres-
sions restricted to safety LTL expressions, a new set of required pre-
and trigger-conditions that would prescribe the preservation of all
potential logs{π+
i}but not in{π−
j}. These are added to PS. The new
specification PS′is given as provided to the FR controller that is
responsible for its enactment. Note the steps above are conducted
for a set of given hypotheses. If new ones are provided, then a new
specification must be generated.
6 TOOL IMPLEMENTATION
As a proof of concept, we have implemented a prototype tool3for
synthesising forensic-ready preservation specifications. Our solu-
tion uses a (i) declarative language based on the Event Calculus (EC)
logic program [ 31] to represent and reason about the environment
3The source code of the tool is publicly available at https://github.com/lpasquale/
kEEPER/tree/keeper_CLI.On Evidence Preservation Requirements for Forensic-Ready Systems ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany
descriptions, speculative hypotheses, preservation specifications
and potential histories and logs in a uniform way, (ii) an off-the-shelf
Boolean constraint solver for logic programs, called clingo [ 20], to
compute potential histories and logs that satisfy or refute hypothe-
ses, and (iii) and a logic-based learner, called XHAIL [ 41], to synthe-
sise preservation specifications that cover all histories supportive
of a hypothesis. Our choice of EC logic program as a language is
due to its successful deployment in the context of requirements
operationalisation [ 4,5] and reasoning about evidence in digital in-
vestigations [ 56]. The encoding of the input as well as the execution
of the three phases in Section 5 are done automatically. The user is
expected to provide the initial input, and the maximum length of
the potential histories to be considered in the approach. Our use of
the solver as the underlying history generation and specification
verification engine is motivated by its capacity to handle difficult
(NP-hard) search problems for EC programs. For encoding of preser-
vation specifications, we follow the translation in [ 5]. Details of
the encoding for the environment description and hypotheses are
available at https://github.com/lpasquale/kEEPER/tree/keeper_CLI/
RunningExample. Although the approach is demonstrated for a
particular language, the principles behind it could be applied to
other formalisms and solvers.
In brief, the history generation phase first tries to find two sets
of models of the program LE∪LH. Each element in the first set
is a model of LE∪LHthat comprises a history Lυ+of maximum
length nthat is minimally supportive of a hypothesis in H. Each
element in the second set contains a history Lυ−of length nthat
refutes all hypotheses in H. This is done by solving a constraint
that requires a hypothesis Lh∈LHto be satisfied by at least one
potential history consistent with LE∪Lh. The solver searches for
the optimal solution being defined as the fewest event occurrence
in a history which equates to the minimally supportive history of
h. We denote the set of minimally supportive histories as Lϒ+(E)
and the minimally refuting histories as Lϒ−(E).
The specification verification phase considers the histories Lϒ+(E)
andLϒ−(E), program LE∪LHand program LPS. This phase per-
forms several calls to the solver to check for consistency of each
history Lϒ+(E)andLϒ−(E)respectively with the specification LPS
(phase 2). The solver searches for models that satisfy the program
LE∪LH∪LPS∪Lυ(for each Lυ∈Lϒ+(E)∪Lϒ−(E)) and a con-
straint requiring there to be an isomorphic potential log Lπ+
iin the
model. If a potential log for a supportive history cannot be found,
then the program is unsatisfiable. In this case the approach outputs
those potential histories to the user for further consideration (e.g.,
amending the FR controller’s capabilities).
Otherwise all computed potential logs LΠ+(PS)andLΠ−(PS)that
correspond to histories in Lϒ+(E)∪Lϒ−(E)respectively and the
program LE∪LPSare passed to a logic-based learner. The aim of
the learner is to search through a candidate space (given by a lan-
guage bias as in [ 5]) to compute required pre-conditions LReqPre and
required trigger-conditions LReqTrig such that LE∪LPS|=LΠ+(PS)
where|=is an entailment operator defined with respect to stable
model semantics [ 21], whilst ensuring that LE∪LPS̸|=Lπ−for any
Lπ−∈LΠ−(PS). The programs LReqPre∪LReqTrig are then translated
back to LTL following the method described in [5].7 EVALUATION
Our evaluation aims to assess whether the synthesised preservation
specification prescribes to preserve i) relevant events and ii) the min-
imal amount of events necessary to support speculative hypotheses
of potential incidents. To achieve this aim, we apply our prototype
tool to two case studies publicly available for research and training
purposes. Each case study comprises data that would normally be
available to an investigator for examination (when a FR controller
is not implemented). The investigator can use this data to explain, if
possible, how a particular incident occurred. For each incident, we
manually modelled the environment and the speculative hypothe-
ses in EC. From this, we used our tool to generate preservation
specifications automatically. The EC models of the case studies and
the generated specifications are available online4.
We compare the events that the generated specification pre-
scribes to preserve with those that would be available to an investi-
gator when the system that does not satisfy evidence preservation
requirements, i.e. the information available to an investigator is
represented by the data-sets provided with the case studies. To
assess relevance, we verify whether our specification prescribes
to preserve events that were relevant to satisfy the speculative
hypotheses. We also check if occurrence of those events can be
inferred from the available data-set. To assess minimality we verify
that our approach prescribes preserving fewer events. In particular,
we compare the number of events that our approach prescribes to
preserve with those that can be inferred from the data-set. We also
measure the number of events, whose occurrence can be inferred
from the data-set, which were irrelevant to support the satisfaction
of the hypotheses.
7.1 Relevance and Minimality
The first incident scenario we considered is set in a university,
where students and academic staff can send emails by using the
university and students’ residence internal network. The model of
the environment includes different agents who can be academics
or students, and can teach or attend courses, respectively. It also in-
cludes locations, such as university and students residences, routers
(each of them placed in a location), emails and their corresponding
sender/recipient email and IP addresses. We also model whether
an email address is a university address for staff and students or it
is an external address.
The primitive events we model cover events whose occurrence
can be inferred from the data-set5. This includes the TCP packets
captured from the routers located inside the students’ residence.
Therefore, we consider the routers as digital sources within the
environment and use primitive events to represent network data
streams. We model the following primitive events: IMAP/POP net-
work traffic (we indicate primitive events related to emails sent
from external addresses to an academic as SUE); incoming HTTP
traffic (we indicate HTTP messages used to set-up a cookie as SC);
general outgoing HTTP traffic ( EM) and specific outgoing HTTP
traffic towards anonymous email services ( SAE). Some of the com-
plex events we model include: (i) emails received by a specific email
address (ii) cookie setting from an external address to an IP; (iii)
4https://github.com/lpasquale/kEEPER/tree/keeper_CLI
5http://digitalcorpora.org/corpora/scenarios/nitroba-university-harassment-scenarioESEC/FSE’17, September 4–8, 2017, Paderborn, Germany Dalal Alrajeh, Liliana Pasquale, and Bashar Nuseibeh
sending of HTTP messages from an IP address and a browser agent;
(iv) sending of anonymous emails from an IP address and a browser
agent. The complex event indicating setting of a cookie initiates
the state cookieSet for a specified email and IP address.
An incident of concern is related to the receipt of harassment
emails by academics. The following speculative hypotheses were
constructed: h1: an email is sent to an academic by someone using
an external address; h2: an anonymous email is sent by an indi-
vidual who can be identified for example through the cookie and
his/her browser agents; h3: an anonymous email is sent by an indi-
vidual who cannot be identified. h1is satisfied when complex event
(i) takes place for which the sender email address is external and
the recipient email address is owned by a university staff member.
For supporting h1, the implemented specification recommended
preserving all incoming IMAP/POP network traffic ( SUE) related to
emails sent from external addresses to an academic. h2is satisfied
when a cookie is set for a specific email and IP address, complex
event (iii) takes place for which HTTP traffic originates from the
same IP address with which the cookie is associated, and subse-
quently complex event (iv) takes places for which the IP address
and the browser agent have been previously associated with outgo-
ing HTTP traffic. For h2, the specification required preserving (a)
incoming HTTP traffic adopted to set-up a cookie ( SC), (b) outgo-
ing HTTP traffic from the same address to which the cookie was
set (EM) and (c) outgoing HTTP traffic to send anonymous emails
(SAE).h3is satisfied when complex event (iv) takes place. Therefore,
forh3the specification requires preserving all SAE events.
Table 1 shows the total time necessary to generate a specification
for each hypothesis, and the time required by each phase of the
approach: histories generation (HG), specification verification (SV)
and specification synthesis (SS). For each hypothesis, the number
of supporting histories (out of the total number generated) and
negative histories necessary to compute a specification, including
the maximum length of the histories, are shown. A higher number
of positive and negative histories could have been given as input to
the synthesis activity without affecting the generated specification.
The maximum time was taken for the most complex hypothesis
(h2) which also required the provision of negative histories.
Table 1: Performance in the harassment case study.
Instances Execution time (s)
#Pos #Neg Length HG SV SS Total
h1 1 / 4 0 1∼0 0.01 0.23 0.24
h2 1 / 32 4 3 0.08 0.19 39.913 40.183
h3 1 / 8 0 1 0.01 0.03 0.301 0.341
We implemented the specification of a FR controller able to ex-
tract data stream from the data-set. Extracted data streams can
support h2since an incoming set-cookie message associated with
jcoach@gmail.com and received by IP 192.168.015.004 was pre-
served. Outgoing HTTP messages from the same IP address and
associated with a Mozilla browser have also been recorded; the
same browser appears to have been used to send the anonymous
email. This supports our theory that our approach would preserve
data that might represent relevant evidence if such an incident
were to occur. This would support investigators in prioritising
their efforts, while ensuring that other events related to alternativescenarios would have been preserved if such scenarios occurred.
Moreover, our approach also prescribes to preserve events that
might not be proactively retained by digital sources. For example,
the data-set does not include events about IMAP/POP network traf-
fic (SUE) necessary to support hypothesis h1. This might be due to
the fact that network traffic was collected for a limited amount of
time and was not retained.
To assess minimality we compare the total number of events
whose occurrence can be inferred from the data-set with those that
our specification would prescribe to preserve. The full data-set in-
cludes 577,760data streams (application level messages) exchanged
in15,508communications between different IP addresses. The num-
ber of data streams corresponds to the total number of events that
an investigator would normally have to examine. The number and
type of event that our specification prescribed to preserve for each
hypothesis is shown in Table 2; the total number of events is only
0.71%of the data streams in the entire data-set. Moreover, not all
the events preserved were necessary to support the hypotheses. For
our scenario, only 956 data streams corresponding to HTTP traffic
originating from the Mozilla browser were necessary to support
h2. Therefore, although our specification consistently reduces the
amount of data to be analysed by an investigator, it does not com-
pletely ensure the minimality requirement since 2874 (69%) data
streams were not relevant to support h2.
Table 2: Number of events preserved.
SUE SC EM SAE
# Eventsh1 0 – – –
h2 – 2 3830300h3 – – –
Total: 4132 events
We also applied our approach to a more complex corporate exfil-
tration scenario6. The model of the environment includes the com-
pany’s employees, their email addresses, computers, employees’
access rights to computers, storage devices that could be mounted
and programs that are installed on each computer. The available
data-set consists of an image of the hard drive of a Windows ma-
chine. Thus, primitive events we modelled represent changes in
the file system of a Window machine that can be observed from a
hard drive image. These include users’ logins, mount and unmount
of devices, installation of programs, and sent or received emails.
Owing to space, we will not provide details of the model and the
specification generated for all the hypotheses of this example and
refer the reader to the project webpage.
An incident of concern is related to the exfiltration of a confi-
dential document of a company from the computer of the chief
financial officer (cfo). Six hypotheses were constructed for this inci-
dent. Examples of these hypotheses are: h2: the document is sent
via email to an external email address and h5: the document is
copied while an external storage device is mounted. To support h2
the specification requires preserving user logins to a computer in
which the document is stored and, while a user is logged, sending
of emails to a non-corporate address including the confidential
document attached. As h5is equal to the hypothesis of our running
example, it lead to the same preservation specification. For this
6http://digitalcorpora.org/corpora/scenarios/m57-jeanOn Evidence Preservation Requirements for Forensic-Ready Systems ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany
incident scenario the hypotheses we modelled were more complex
and a higher number of supporting and refuting histories were
generated. This increased the time the approach took to learn a
specification. Table 3 shows the time to generate a preservation
specification for each hypothesis.
We manually acquired the events identified from the computer
hard drive using Autopsy [ 10]. These were not sufficient to support
any of the hypotheses because some of the events that our approach
prescribes to preserve are not retained in a computer hard drive im-
age. For example, we cannot support hypothesis h2speculating that
the document might be sent as an email attachment by an employee
to a non-corporate email address. In particular, although an event
in the data-set indicates that an email with the attached confidential
document was sent from the cfo’s email address ( jean@m57.biz ) to
an external address ( tuckgorge@gmail.com ), we cannot conclude
which user was logged on the machine since the data-set only pro-
vides information about the last user login. A similar situation arise
with hypothesis h5speculating that the document may be copied
to an external device, because mounting of a storage device and
copy of a file are events that are not retained. If our specification
was implemented it would have ensured preservation of events
necessary to support h2andh5when they occurred.
Table 3: Performance in the exfiltration case study.
Instances Execution time (s)
#Pos #Neg Length HI SV SG Total
h1 2 / 12 2 2 0.01 0.05 7.756 7.816
h2 1 / 4 1 2 0.01 0.05 1.852 1.912
h3 4 / 18 14 3 0.1 0.28 1733.82 1734.2
h4 4 / 16 9 3 0.5 0.18 894.197 894.877
h3 4 / 18 14 3 0.1 0.28 1733.82 1734.2
h4 4 / 16 9 3 0.5 0.18 894.197 894.877
h5 1 4 3 0.05 0.2 43.851 44.101
h6 1 4 3 0.5 0.21 170.356 171.066
To assess minimality, Fig. 4 shows, for each hypothesis, the
number of events our approach would have preserved from the
hard drive image. We compared these figures with those that an
investigator would have examined from the data-set (No-FR). Our
approach would have resulted in significantly fewer events to be
examined for hypotheses h1–h6. For example, to support h2it
would be necessary to identify the mail clients among the installed
applications ( 133), inspect all the outboxes associated with the
accounts registered with the mail clients ( 23emails for the cfo’s
outbox and no emails for the Administrator outbox) and identify the
users’ last login ( 3). We cannot claim the same for h5the generated
specification requires preserving users’ last logins, mounted devices
and file access operations, which are not present in the data-set.
7.2 Discussion
The paper aims to ensure relevant events are preserved that may
serve as evidence, thus reducing the amount of data investigators
would have to search through. This is what is evaluated. The paper
is not concerned with reactive investigations nor aiding open-ended
investigations. We make the assumption that the speculative hy-
potheses of an incident are given in advance. Therefore a forensic-
ready system will be prepared to investigate only the incidents
known a-priori. This the assumption on which forensic readiness
Figure 4: Number of events to be examined.
guidelines for organisations are based on. Training experts (e.g.,
system/security administrator) to identify these is part of the busi-
ness requirements for implementing forensic measures [ 45] and is
outside the scope of our work. Furthermore, as the environment
and the speculative hypotheses are expected to be known a pri-
ori, there is a risk that this knowledge can be used to thwart the
forensic-ready system itself — an individual might adjust her be-
haviour to avoid preservation of events indicating her involvement
in an offense. Thus, applications of our approach would require
maintenance of confidentiality of the system specification.
The performance of our approach decreases when ‘richer’ posi-
tive and negative histories are used [ 5] (a saturation point is reached
for 18 histories). This is caused by the increase in the EC model
size when grounded. The time taken to synthesise a specification
increases linearly with the length of the considered preservation his-
tories. A saturation point is reached with histories having length 11.
Note that the scalability results purely depend on the open-source
prototype tool7used to support the specification synthesis. This
could be significantly improved by deploying learning techniques
for context-dependent learning [ 32], and distributed reasoning [ 34].
To show that our formalisation could yield a practical solution,
we provide a proof-of-concept implementation, putting aside us-
ability issues. The definition of the model of the environment and
the hypotheses of the university harrassment and the corporate ex-
filtration scenarios required 2 and 3.5 days of work, respectively, to
one of the paper’s authors. We are developing a graphical interface
that would mask the complexity of the formal specification and
help practitioners represent potential incidents and how they may
occur in the environment. Such graphical interface is based on the
model-driven engineering principle to hide the complexity of the EC
language used to represent the environment and hypotheses within
a model. A model-based representation has the potential to ensure
correctness of the models by-design and encourage re-usability of
the environment and hypotheses among experts.
8 RELATED WORK
Existing research on forensic readiness has mainly focused on iden-
tifying high-level strategies which organisations can implement to
be forensic-ready. For example, Elyas et al. [ 15] use focus groups to
elicit required forensic readiness objectives (e.g., regulatory compli-
ance, legal evidence management) and capabilities (organisational
factors and forensic strategy). Reddy and Venter [ 42] present a
forensic readiness management system taking into account event
7https://github.com/stefano-bragaglia/XHAILESEC/FSE’17, September 4–8, 2017, Paderborn, Germany Dalal Alrajeh, Liliana Pasquale, and Bashar Nuseibeh
analysis capabilities, domain-specific information (e.g., policies pro-
cedures and training requirements), and costs (e.g., staff, infras-
tructure and training costs). However, none of these approaches
has addressed the problem of how to implement forensic readiness
in existing IT systems— inspite of the standardisation of forensic
readiness processes (ISO/IEC 27043:20158) which prescribes the
planning and implementation of pre-incident collection and analy-
sis of evidence activities.
Shield et al. [ 48] propose performing continuous proactive ev-
idence preservation. However, in large scale environments like
cloud systems, monitoring all potential evidence is not a viable
solution, as it might be cumbersome to analyse. Pasquale et al. [ 37]
propose a more targeted approach, where evidence preservation
activities aim to detect potential attack scenarios that can violate
existing security policies. However, this approach is less selective as
it prescribe to preserve any type of event within a history leading
to an incident, independently of other events that have previously
occurred or preserved. Existing work on data extraction for inves-
tigative purposes, such as E-Discovery [ 25], although supporting
retrieval of data for an investigation, it does not provide a solution
to engineer a forensic-ready system prescribing what data should
be preserved depending on its relevance to future investigations.
With the growth of digital forensics as a discipline, interest
in rigorous approaches has increased. For example, Carrier [ 11]
provides guidelines about the types of hypotheses that should be
formulated and the analysis to be performed to verify those hy-
potheses during a digital investigation. Others [ 1,8,27,47] have
focused on providing a unified representation of heterogeneous log
events to automate event reconstruction. Similar to us, all these
approaches distinguish between primitive events having a direct
mapping to raw log events and complex level events, which can be
determined by the occurrence of primitive ones. Formal techniques
have also been used to represent and analyse the behaviour of the
environment in order to identify the root causes that allowed an
incident to occur [ 50] or possible incident scenarios [ 23]. Other
work is specialised on identifying attackers’ traces (e.g., evidence
and timestamps improperly manipulated by an attacker), from vio-
lations of invariant relationships between digital objects [ 49] or by
applying model checking techniques on a set of events expressed
in a multi-sorted algebra [ 7]. However, none of this work addresses
the problem of how hypotheses can be expressed formally, how
they relate to sequences of primitive and complex events supporting
them and how to achieve preservation requirements.
The requirements engineering community [ 26,33,53,55] pro-
posed numerous techniques for modelling security and privacy
requirements to enable the design of systems less vulnerable to
potential attacks and privacy breaches. However, only prelimi-
nary attempts have been made towards engineering forensic-ready
systems [ 6,38] and investigating how forensic-readiness require-
ments are considered during systems development lifecycles [ 24].
Although preservation requirements can be considered as a spe-
cific type of monitoring requirements [ 17,18,44,46], the nature
of the specifications for forensic-ready systems is different in its
8http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?
csnumber=44407scope (environment and hypotheses) and characteristics. These are
aspects that have not been covered in previous work.
Recent studies in program analysis, such as [ 19,57], have high-
lighted the importance of providing software developers with auto-
mated support in making logging decisions and difficulty in con-
structing specifications to guide logging behaviour. In [ 57] for in-
stance, the authors present a method for learning what and when
to log from past logs of software developers. This differs concep-
tually from what we present here since incident-related histories
are domain specific, showing how particular hypotheses may be
met within particular environments. For forensic-ready systems,
justification of preservations need to be made explicit and in read-
able form, which is supported by the learning technique that we
deploy. We believe however that our approach could help software
developers in making informed decisions and insights on what logs
to preserve to enhance forensic-readiness of systems. Closest to
our work with in a forensic setting is that of [ 3,30]. However [ 3]
focuses on defining “ideal” logging preferences for databases that
is independent of the incidents of concern and hence still poses a
risk of inadequate logging. The work of [ 30] instead is limited to
eliciting from natural language descriptions of software artefacts
the set events (as verb-object pairs) and an empirical classification
of such events to determine logging requirements.
9 CONCLUSION
This paper represents a first step towards a rigorous approach to
developing forensic-ready systems. We defined a framework for
formalising evidence preservation requirements of such systems.
We use this to synthesise specifications that guarantee a minimal
amount of data, constituting potentially relevant evidence to sup-
port given speculative hypotheses of incidents of concern, is pre-
served. We also provided a proof-of-concept implementation that
has been evaluated on two incident scenarios. Our results demon-
strate that our approach preserves relevant events and provides
insight into whether existing software/devices have the necessary
capabilities for preserving evidence. Moreover, the size of preserved
data is smaller than what would have been examined during an
investigation otherwise. Our approach does not propose replacing
the role of engineers nor investigators. It also assumes that domain
experts are involved in modelling the environment and selecting the
relevant histories to be covered by the preservation specifications.
In the future, we plan to investigate how our approach may
be adapted to dynamic situations at run-time in which environ-
ments and hypotheses may change over time. We are developing
a graphical designer aimed to facilitate the practitioners’ task of
designing the model of the environment and generation of hypothe-
ses. Finally when generating a preservation specification, we will
consider systematic approaches for synthesis when conflicts with
other requirements, such as legal requirements, are present which
may forbid preserving relevant data for privacy reasons.
ACKNOWLEDGEMENTS
This work is supported by ERC Advanced Grant no. 291652 (ASAP),
SFI Grants 10/CE/I1855, 13/RC/2094 and 15/SIRG/3501, and the
Imperial College Research Fellowship.On Evidence Preservation Requirements for Forensic-Ready Systems ESEC/FSE’17, September 4–8, 2017, Paderborn, Germany
REFERENCES
[1]J. Abbott, J. Bell, A. Clark, O. De Vel, and G. Mohay. Automated Recognition of
Event Scenarios for Digital Forensics. In Proc. of the 2006 ACM Symposium on
Applied Computing , pages 293–300. ACM, 2006.
[2]AccessData. FTK – AccessData Digital Forensics Software. http://www.
accessdata.com/products/digital-forensics/ftk, 2014.
[3]O. M. Adedayo and M. S. Olivier. Ideal log setting for database forensics recon-
struction. Digit. Investig. , 12(C):27–40, 2015.
[4]D. Alrajeh, J. Kramer, A. Russo, and S. Uchitel. Learning operational require-
ments from goal models. In Proc. of the 31st International Conference on Software
Engineering , pages 265–275, 2009.
[5]D. Alrajeh, J. Kramer, A. Russo, and S. Uchitel. Elaborating requirements using
model checking and inductive learning. IEEE Trans. Software Eng. , 39(3):361–383,
2013.
[6]F. Alrimawi, L. Pasquale, and B. Nuseibeh. Software Engineering Challenges for
Investigating Cyber-physical Incidents. In Proc. of the 3rd International Workshop
on Software Engineering for Smart Cyber-Physical Systems , pages 34–40, 2017.
[7]A. R. Arasteh, M. Debbabi, A. Sakha, and M. Saleh. Analyzing Multiple Logs for
Forensics Evidence. In Digital Investigations , volume 4, pages 82–91, 2007.
[8]F. P. Buchholz and C. Falk. Design and Implementation of Zeitline: a Forensic
Timeline Editor. In Proc. of the Digital Forensics Research Workshop , 2005.
[9]A. Cailliau and A. van Lamsweerde. A probabilistic framework for goal-oriented
risk analysis. In Proc. of the 20th International Requirements Engineering Confer-
ence, pages 201–210, 2012.
[10] B. Carrier. The Sleuth Kit (TSK) & Autopsy: Open Source Digital Forensic Tools.
http://www.sleuthkit.org, 2014.
[11] B. D. Carrier. A Hypothesis-Based Approach to Digital Forensic Investigations . PhD
thesis, Purdue University, 2006.
[12] E. Casey, A. Blitz, and C. Steuart. Digital Evidence and Computer Crime, 2014.
[13] E. Clarke, F. Lerda, and M. Talupur. An Abstraction Technique for Real-time
Verification. Next Generation Design and Verification Methodologies for Distributed
Embedded Control Systems , pages 1–17, 2007.
[14] e-fense. Helix. http://www.e-fense.com/products.php, 2014.
[15] M. Elyas, A. Ahmad, S. B. Maynard, and A. Lonie. Digital Forensic Readiness:
Expert Perspectives on a Theoretical Framework. Computers & Security , 52:70–89,
2015.
[16] B. E. Endicott-Popovsky and D. A. Frincke. Embedding Forensic Capabilities
into Networks: Addressing Inefficiencies in Digital Forensics Investigations. In
Proceedings of the 2006 IEEE Workshop on Information Assurance , pages 133–139,
2006.
[17] M. S. Feather, S. Fickas, A. Van Lamsweerde, and C. Ponsard. Reconciling System
Requirements and Runtime Behavior. In Proc. of the 9th International Workshop
on Software Specification and Design , page 50, 1998.
[18] S. Fickas and M. S. Feather. Requirements Monitoring in Dynamic Environments.
InProc. of the 2nd International Symposium on Requirements Engineering , pages
140–147, 1995.
[19] Q. Fu, J. Zhu, W. Hu, J.-G. Lou, R. Ding, Q. Lin, D. Zhang, and T. Xie. Where
do developers log? an empirical study on logging practices in industry. In
Companion proc. of the 36th International Conference on Software Engineering ,
ICSE Companion 2014, pages 24–33, 2014.
[20] M. Gebser, B. Kaufmann, R. Kaminski, M. Ostrowski, and M. T. Schaub,
T.and Schneider. Potassco: The potsdam answer set solving collection. AI
Commun. , 24(2):107–124, 2011.
[21] M. Gelfond and V. Lifschitz. The stable model semantics for logic programming.
In R. Kowalski and K. Bowen, editors, Proc. of 5th Intl. Conf. on Logic Programming ,
pages 1070–1080, 1988.
[22] D. Giannakopoulou and J. Magee. Fluent model checking for event-based sys-
tems. In proc. of the 11th ACM SIGSOFT Symposium on Foundations of Software
Engineering 2003 held jointly with 9th European Software Engineering Conference ,
pages 257–266, 2003.
[23] P. Gladyshev and A. Patel. Finite State Machine Approach to Digital Event
Reconstruction. Digital Investigations , 1:130–149, 2004.
[24] G. Grispos, J. García-Galán, L. Pasquale, and B. Nuseibeh. Are you ready? Towards
the engineering of forensic-ready systems. In Proc. of the 11th International
Conference on Research Challenges in Information Science , pages 328–333, 2017.
[25] M. R. Grossman and G. V. Cormack. Technology-Assisted Review in E-Discovery
Can Be More Effective and More Efficient Than Exhaustive Manual Review. Rich.
JL & Tech. , 17:1, 2010.
[26] C. Haley, R. Laney, J. Moffett, and B. Nuseibeh. Security Requirements Engi-
neering: A Framework for Representation and Analysis. IEEE Transactions on
Software Engineering , 34(1):133–153, 2008.
[27] C. Hargreaves and J. Patterson. An Automated Timeline Reconstruction Approach
for Digital Forensic Investigations. Digital Investigation , 9:S69–S79, 2012.
[28] T. A. Henzinger and O. Kupferman. From quantity to quality. In Proc. of the
International Workshop on Hybrid and Real-Time Systems , pages 48–62, 1997.
[29] R. J. Heuer. Psychology of Intelligence Analysis . Center for the Study of Intelligence,
1999.[30] J. King, R. Pandita, and L. Williams. Enabling forensics by proposing heuristics
to identify mandatory log events. In Proceedings of the 2015 Symposium and
Bootcamp on the Science of Security , HotSoS ’15, pages 6:1–6:11, 2015.
[31] R. A. Kowalski and M. J. Sergot. A logic-based calculus of events. New Generation
Comput. , 4(1):67–95, 1986.
[32] M. Law, A. Russo, and K. Broda. Iterative learning of answer set programs from
context dependent examples. In proc. of the 32nd International Conference on
Logic Programming , 2016.
[33] L. Liu, E. S. K. Yu, and J. Mylopoulos. Security and Privacy Requirements Analysis
within a Social Setting. In Proc. of the 11th IEEE International Conference on
Requirements Engineering , pages 151–161. IEEE Computer Society, 2003.
[34] J. Ma, F. Le, D. Wood, A. Russo, and J. Lobo. A declarative approach to distributed
computing: Specification, execution and analysis. TPLP , 13(4-5):815–830, 2013.
[35] New York Times. Raj Rajaratnam’s Galleon Group Founder Convicted in In-
sider Trading Case. topics.nytimes.com/top/reference/timestopics/people/r/raj_
rajaratnam/index.html.
[36] G. Palmer. A Road Map for Digital Forensics Research. Technical report, Air
Force Research Lab, Rome, 2001.
[37] L. Pasquale, S. Hanvey, M. Mcgloin, and B. Nuseibeh. Adaptive Evidence Col-
lection in the Cloud Using Attack Scenarios. Computers & Security (In Press) ,
2016.
[38] L. Pasquale, Y. Yu, M. Salehie, L. Cavallaro, T. T. Tun, and B. Nuseibeh.
Requirements-Driven Adaptive Digital Forensics. In Proc. of the 21st International
Requirements Engineering Conference , pages 340–341, 2013.
[39] A. Pnueli. The temporal logic of programs. In Proceedings of SFCS77 , pages 46–57,
1977.
[40] D. Quick and K.-K. R. Choo. Big Forensic Data Reduction: Digital Forensic Images
and Electronic Evidence. Cluster Computing , 19(2):723–740, 2016.
[41] O. Ray. Nonmonotonic abductive inductive learning. J. Applied Logic , 7(3):329–
340, 2009.
[42] K. Reddy and H. S. Venter. The Architecture of a Digital Forensic Readiness
Management System. Computers & Security , 32:73–89, 2013.
[43] S. Rekhis and N. Boudriga. Formal digital investigation of anti-forensic attacks.
InProc. of the 5th IEEE International Workshop on Systematic Approaches to Digital
Forensic Engineering , pages 33–44, 2010.
[44] W. N. Robinson. A Requirements Monitoring Framework for Enterprise Systems.
Requir. Eng. , 11(1):17–41, 2006.
[45] R. Rowlingson. A Ten Step Process for Forensic Readiness. International Journal
of Digital Evidence , 2(3):1–28, 2004.
[46] M. Salifu, Y. Yu, A. K. Bandara, and B. Nuseibeh. Analysing Monitoring and
Switching Problems for Adaptive Systems. Journal of Systems and Software ,
85(12):2829–2839, 2012.
[47] B. Schatz, G. Mohay, and A. Clark. Rich Event Representation for Computer
Forensics. In Proc. of the 5th Asia-Pacific Industrial Engineering and Management
Systems Conference , pages 1–16, 2004.
[48] C. Shields, O. Frieder, and M. Maloof. A System for the Proactive, Continuous,
and Efficient Collection of Digital Forensic Evidence. In Digital Investigations ,
volume 8, pages 3–13, 2011.
[49] T. Stallard and K. N. Levitt. Automated Analysis for Digital Forensics Science:
Semantic Integrity Checking. In Proc. of the Annual Computer Security Application
Conference , pages 160–167, 2003.
[50] P. Stephenson. Modeling of Post-Incident Root Cause Analysis. International
Journal of Digital Evidence , 2, 2003.
[51] C. Taylor, B. Endicott-Popovsky, and D. A. Frincke. Specifying Digital Forensics:
A Forensics Policy Approach. Digital investigation , 4:101–104, 2007.
[52] S. Tewelde, S. Gruner, and M. Olivier. Advances in Digital Forensics XI: 11th IFIP
WG 11.9 International Conference, Orlando, FL, USA, January 26-28, 2015, Revised
Selected Papers , chapter NOTIONS OF HYPOTHESIS IN DIGITAL FORENSICS,
pages 29–43. Springer International Publishing, 2015.
[53] T. T. Tun, A. K. Bandara, B. A. Price, Y. Yu, C. B. Haley, I. Omoronyia, and
B. Nuseibeh. Privacy Arguments: Analysing Selective Disclosure Requirements
for Mobile Applications. In Proc. of the 20th International Requirements Engineering
Conference , pages 131–140, 2012.
[54] J. Van den Bos and T. Van Der Storm. Domain-specific optimization in digital
forensics. In International Conference on Theory and Practice of Model Transfor-
mations , pages 121–136, 2012.
[55] A. van Lamsweerde. Elaborating Security Requirements by Construction of
Intentional Anti-Models. In Proc. of the 26th International Conference on Software
Engineering , pages 148–157. IEEE Computer Society, 2004.
[56] S. Y. Willassen. Using Simplified Event Calculus in Digital Investigation. In
Proc. of the ACM Symposium on Applied Computing , pages 1438–1442, 2008.
[57] J. Zhu, P. He, Q. Fu, H. Zhang, M. R. Lyu, and D. Zhang. Learning to Log: Helping
Developers Make Informed Logging Decisions. In Proc. of the 37th International
Conference on Software Engineering , pages 415–425, 2015.