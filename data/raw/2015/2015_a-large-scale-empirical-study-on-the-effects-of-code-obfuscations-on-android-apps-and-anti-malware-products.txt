ALarge-ScaleEmpiricalStudyontheEffectsofCode
ObfuscationsonAndroidAppsandAnti-MalwareProducts
MahmoudHammad,JoshuaGarcia,andSamMalek
DepartmentofInformatics
UniversityofCalifornia,Irvine
Irvine,California,USA
{hammadm,joshug4,malek}@uci.edu
ABSTRACT
TheAndroidplatformhasbeenthedominantmobileplatformin
recentyearsresultinginmillionsofappsandsecuritythreatsagainst
thoseapps.Anti-malwareproductsaimtoprotectsmartphoneusers
fromthesethreats,especiallyfrommaliciousapps.However,mal-
wareauthorsusecodeobfuscationontheirappstoevadedetection
byanti-malwareproducts.Toassesstheeffectsofcodeobfuscation
onAndroidappsandanti-malwareproducts,wehaveconducteda large-scale empirical study that evaluates the effectiveness ofthe top anti-malware products against various obfuscation toolsandstrategies.Tothatend,wehaveobfuscated3,000benignappsand 3,000 malicious apps and generated 73,362 obfuscated apps
using29obfuscationstrategiesfrom7open-source,academic,and
commercialobfuscationtools.Thefindingsofourstudyindicatethat
(1) code obfuscation significantly impacts Android anti-malware
products; (2) the majority of anti-malware products are severelyimpacted by even trivial obfuscations; (3) in general, combinedobfuscation strategies do not successfully evade anti-malwareproducts more than individual strategies; (4) the detection of
anti-malwareproductsdependnotonlyontheappliedobfuscation
strategybutalsoontheleveragedobfuscationtool;(5)anti-malwareproductsareslowtoadoptsignaturesofmaliciousapps;and(6)code
obfuscationoftenresultsinchangestoanapp’ssemanticbehaviors.
ACM Reference Format:
Mahmoud Hammad, Joshua Garcia, and Sam Malek. 2018. A Large-Scale
EmpiricalStudyontheEffectsofCodeObfuscationsonAndroidAppsand
Anti-MalwareProducts.In ICSE’18:ICSE’18:40thInternationalConference
onSoftwareEngineering,May27-June3,2018,Gothenburg,Sweden. ACM,
NewYork,NY,USA,11pages.https://doi.org/10.1145/3180155.3180228
1 INTRODUCTION
Android is the dominant mobile platform holding 85% of the
smartphoneOSmarketshare[ 11].Atthesametime,thenumber
and sophistication of malicious Android apps are increasing. For
instance,McAfeeLabscrawledseveralappstoresoversixmonths
in2016anddetectedmorethan9millionmaliciousapps[ 10].As
anotherexample,Kasperskydiscoveredmorethan4millionnew
malwarein2016[9].
Manyreasonscontributetothismeteoricriseofmalwareapps
including: (1) the relative ease of creating a piggybacked app
Permission to make digital or hard copies of all or part of this work for personal or
classroomuseisgrantedwithoutfeeprovidedthatcopiesarenotmadeordistributed
forprofitorcommercialadvantageandthatcopiesbearthisnoticeandthefullcitation
onthefirstpage.CopyrightsforcomponentsofthisworkownedbyothersthanACM
mustbehonored.Abstractingwithcreditispermitted.Tocopyotherwise,orrepublish,
topostonserversortoredistributetolists,requirespriorspecificpermissionand/or
afee.Requestpermissionsfrompermissions@acm.org.
ICSE’18,May27-June3,2018,Gothenburg,Sweden
©2018AssociationforComputingMachinery.
ACMISBN978-1-4503-5638-1/18/05...$15.00
https://doi.org/10.1145/3180155.3180228[35–38,48],i.e.,amutatedversionofalegitimateappinjectedwith
either malicious code or embedded advertisements; and (2) the
prevalenceofalternativeAndroidappstores(i.e.,appstoresother
than the official Android app store, Google Play [ 19]), on which
maliciousappsmaybedistributedtousers.
Toprotectmobiledevices,usersoftenrelyonanti-malwareprod-
ucts,whichscanappstodetermineiftheyarebenignormalicious.
However,manymalwareappshavepreviouslyevadeddetectionby
theseproducts.ExamplesofsuchmaliciousappsincludeBrainTest
[7],VikingHorde[ 12],FalseGuide[ 18],andDressCode[ 8].These
appshaveinfectedmillionsofusersbeforetheyweredetected.To
evadedetection,malwareauthorsoftenrelyon codeobfuscation.
Code obfuscation transforms code into a form that is more
difficultforhumans, andpossiblymachines,toread, understand,
andreverseengineer.Thesetransformationschangethesyntaxof
codebutnottheirsemantics[ 30].Thesechangescouldbesmall(e.g.,
insertingunusedcode)orsophisticated(e.g.,performingbytecodeencryption)[
44].Althoughcodeobfuscationsareusedbymalware
authors, they are also used by benign app developers to increase
thedifficultyofreverseengineeringtheirapps.
Tobetterprotecttheintellectualpropertyofbenignappdevelop-
ersandpreventcloningoftheirapps,severalcompanieshavedevel-
opedobfuscationtools,or obfuscators forshort,thatimplementdiffer-
entcodetransformations(e.g.,identifierrenaming,stringencryption,
reflection,etc.).Giventheuseofobfuscationsbymalwareauthors,
thegoalofthisstudyistoassesstheperformanceofcommercialanti-
malwareproductsagainstvariousobfuscationtoolsandstrategies.
Although some researchers have studied an individual obfus-
cation tool’s effectiveness on a limited number of anti-malware
products[ 32,34,40,43,44,47],nostudyhasperformedalarge-scale
assessmentof(1)theeffectofindividualandcombinedobfuscation
strategiesprovidedbymultipleobfuscationstoolsonanti-malware
products,(2)theeffectthetoolsandstrategieshaveontheaccuracy
of anti-malware products for benign apps and not just maliciousapps, (3) the effect of time on obfuscated-app detection by those
products,and(4)whethertheapplicationofobfuscationstrategies
result in valid, installable, and runnable apps. Due to the lack ofastudyregardingtheeffectofspecificandcombinedobfuscation
strategiesonanti-malwareproducts,itisunclearwhichstrategies
evadesuchproductsthemost.Noneoftheaforementionedstudies
determinetheextenttowhichanti-malwareproductserroneously
considerobfuscated,benignappsasmalicious,whichisundesirable
forbothanti-malwareproductvendorsandbenignappdevelopers.
To determine if the transformations applied by obfuscation
tools break an app’s semantics, our study investigates the abilityof obfuscation tools to generate valid, installable, and runnable
apps.Anobfuscatedappisnotusefultoabenignappdeveloperor
maliciousauthorifitcannotbeexecutedonadeviceorifitsbenign,
functional behavior changes. To ensure an app’s obfuscation is
4212018 ACM/IEEE 40th International Conference on Software Engineering
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ICSE’18,May27-June3,2018,Gothenburg,Sweden MahmoudHammad,JoshuaGarcia,andSamMalek
successful,ourstudyfurthercomparesthebehaviorofanobfuscated
appwiththebehaviorofitscorrespondingoriginalapp.
Overall,thispapermakesthefollowingcontributions:
We assess the accuracy of over 60 anti-malware products on
apps obfuscated using 7 obfuscation tools and 29 obfuscation
strategieson3,000benignappsand3,000maliciousapps,totaling
over73,000obfuscatedapps.Wefurtherconsidertheeffectofanapp’sageonthataccuracy.

Weevaluatetheabilityof7obfuscationtoolstogenerateAndroid
appsthatarevalid,installable,andrunnable.
Based on our results, we make suggestions for improving
anti-malwareproductsandobfuscationtools.
To conduct this study, we have implemented a framework for
obfuscatingAndroidappsandscanningthemusinganti-malware
products.Theframeworkisreusable,canbeextendedtoinclude
moreobfuscationtoolsandstrategies,andisavailableonline[ 21],
alongwithourresultingdatasetofover73,000obfuscatedapps.
The remainder of this paper is organized as follows. Section 2
coversbackgroundinformationaboutAndroidappsandcodeob-
fuscation.Section3discussestheresearchquestionsthatthisstudy
aimstoanswer.Theresearchmethodologyofthisstudyispresented
in Section 4. The results and the findings are reported in Section
5.Section6discussestheresultsandprovidesrecommendationsto
enhanceanti-malwareproductsandobfuscationtools.Thethreats
tovalidityarepresentedinSection7.Finally,thepaperoverviews
therelatedliterature(Section8)andconcludes(Section9).
2 BACKGROUND
ThissectionprovidesabriefoverviewofAndroidappsandobfus-
cationstrategiestohelpthereaderunderstandtherestofthepaper.
2.1 Android Apps
EachAndroidappispackagedanddistributedasanAndroidPackage
Kit(APK)file,whichisazippedfilethatismainlywritteninJava.
EachAPKfilecontainsamanifestfile,resources(e.g.,images),and
theapp’sbytecode.Anapp’scodeiscompiledinto DalvikEXecutable
(DEX)format,whichcanbeexecutedonacustomizedJavaVirtual
Machine (JVM). There are two JVMs that can execute the DEXformat:AndroidRuntime(ART),introducedinAndroidversion5
(Lollipop);andDalvikVirtualMachine(DVM),forolderversions.
classes.dex,themainDEXfileofanAndroidapp,isafileintheAPK
generatedby dx,autilitythatconverts .classfilesintoaDEXfile.
classes.dex can be disassembled by Baksmali [ 23] into an
Intermediate Representation (IR) format which, in turn, can beassembled by Smali [
23] to generate a new variant of classes.dex.
Thenewclasses.dex canberepackagedusingatoolsuchas Apktool
[1],areverse-engineeringtoolforAndroidAPKfiles,togeneratea
newAPKvariant(e.g.,anobfuscatedapp).DifferentIRformatscan
begeneratedfrom classes.dex,includingSmalicodeusingApktool
and.classfilesusingDARE[ 42]ordex2jar[ 16].Moreover,Soot[ 45]
can generate various IRs such as Baf, Jimple, Shimple, Grimp, or
evenalow-levelIRsuchasJasmin.
2.2 Obfuscation Strategies
To study the effectiveness of anti-malware products, we applied
severaldifferentobfuscationstrategiesoneachAndroidapp.We
usetheterm obfuscationstrategy torefertoasingletransformation
ormultipletransformationsappliedtoanAndroidapp.Weconsider
threetypesofstrategies: trivialstrategies, non-trivialstrategies,and
combinedstrategies.Table1presentsabbreviationsofthetrivialand
non-trivialobfuscations,whichwillbeusedthroughoutthispaper.Table 1: Obfuscation-strategy abbreviations
TrivialObfuscation Non-trivialObfuscation
Disassembly/
ReassemblyDRJunkcode
insertionJUNK Identifier
renamingIDR
AndroidManifest MAN Classrenaming CR ControlflowCF
Alignment ALIGNMember
reorderingMR Reflection REF
Repackaging REPACKString
encryptionENC
Trivial obfuscation strategies arecodetransformationsthat
donotchangetheapp’sbytecode.Forthisstudy,weexaminedthe
followingtrivialstrategies:
Repackaging (REPACK) involves unzipping the APK file and
re-signingitwithadifferentsigningcertificate.Thissimpletrans-
formationthwartsanti-malwareproductsthatrelyontheapp’s
certificatetodetermineiftheappismaliciousornot.Forthistrans-
formation,weunzipanAPKfileusingthe zipfilePythonlibrary
andresignitwithourownsigningcertificateusing jarsigner[20],
atoolforverifyingandgeneratingdigitalsignaturesforJARfiles.
Disassembling and Reassembling (DR) involves disassembling
the app using a reverse-engineering tool, such as Apktool,
reassemblingtheapp,andthensigningit.Bydisassemblingand
reassemblingtheapp,theitemsin classes.dex willbereordered.
Anti-malwareproductsthatrelyonmatching classes.dex against
signaturesofknownmaliciousappswouldbebroken.
AndroidManifest transformation (MAN): Each Android appcontains a configuration file called AndroidManifest.xml file,
which specifies the principal components that constitute the
application, including their types and capabilities, as well as
requiredandenforcedpermissions.Thistransformationchanges
the manifest by adding permissions or adding components’
capabilities,called IntentFilters inAndroid.
Alignment(ALIGN)realignsalluncompresseddata,suchasim-
agesorrawfiles,inanAPKfile.Thistransformationchangesthe
cryptographichashofanAPKfile.Therefore,ifananti-malware
productidentifiesmaliciousappsbasedontheircryptographic
hashes(e.g.,MD5),thistransformationcanthwartit.
Non-trivial obfuscation strategies arecodetransformations
thatchangeanapp’sbytecode.Westudythefollowingnon-trivial
obfuscationstrategies:
Junkcodeinsertion(JUNK)addscodethatdoesnotaffecttheexe-
cutionofanapp.Junkcodeinsertioncanaddnulloperations( nop),
comments,and/ordebugginginformationtoa classes.dex file.
Stringencryption(ENC)encryptsthestringsin classes.dex and
addsafunctionthatdecryptstheencryptedstringsatruntime.
Anti-malwareproductsthatrelyonthestringdatainanappto
determineifitismaliciouswillbeevadedbythistransformation.
Control-flowmanipulation(CF)changesthemethods’control-
flow graph by adding conditions and iterative constructs. Inaddition, this transformation changes the app’s call graph by
addingnewmethodsandfakecallstothenewlyaddedmethods.
Membersreordering(MR)changestheorderofinstancevariables
or methods in a classes.dex file, which evades anti-malware
productsthatdependonthesequenceofmembersinaclass.
IdentifierRenaming(IDR)renamestheinstancevariablesand/or
themethodnamesineachJavaclasswithrandomlygenerated
names.Thistransformationchangessignaturesgeneratedfrom
identifiersandchangesthe methodtable inDalvikbytecode.
422
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ALarge-ScaleEmpiricalStudyontheEffectsofCode
ObfuscationsonAndroidAppsandAnti-MalwareProductsICSE’18,May27-June3,2018,Gothenburg,Sweden
Class renaming (CR) renames the classes and/or the packages
inanappwithrandomlygeneratednames.Thistransformation
changesthe methodtable intheDalvikbytecode.
Reflection(REF)transformationsconvertdirectmethodinvoca-
tionsintoreflectivecallsusingtheJavareflectionAPI,whichcan
evadestaticanalysesthatrelyondirectmethodcalls.
Combined strategies arecombinationsoftheaforementioned
obfuscationstrategies.Previouswork[ 40,44]hasmentionedthat
combining obfuscation strategies result in stronger obfuscations.
Our study leverages different combined strategies to understand
whichcombinationsoftransformationswillresultinbetterevasion
ofanti-malwareproducts.Themajorityofourleveragedcombined
strategieshavenotbeenempiricallystudiedinpreviouswork.
3 RESEARCH QUESTIONS
Inthis paper,our primary goalis toprovide alarge-scaleempiri-
calstudythatevaluatestheeffectivenessofanti-malwareproducts
againstvariousobfuscationtoolsandstrategies.Tothatend,this
sectionpresentsanddiscussestheresearchquestionsthisstudyat-
temptstoanswer.Moreover,thissectionshowswhowillbenefitfrom
answeringeachresearchquestion.Intheremainderofthissection,
weintroduceandmotivateeachresearchquestionthatwestudy.
RQ1.Howistheaccuracyofanti-malwareproductsaffectedby
obfuscationstrategies?
TheuseofcodeobfuscationinAndroidappshasbecomepopular
andisleveragedbybothbenignandmaliciousappdevelopers.Giventhatsmartphoneusersrelyonanti-malwareproductstoprotecttheir
devices,itiscrucialforanti-malwareproductstodistinguishmali-
ciousappsfrombenignoneswithhighaccuracy,whilebeingresilienttoobfuscation.RQ1aimstomeasuretheaccuracyofcommercialanti-malwareproductsagainstabroadrangeofobfuscationstrategies.Wemeasureaccuracyinthispaperusingprecisionandrecall,sincethesemetricstakeintoaccountfalsepositives(i.e.,benignappsmarkedasmalicious)andfalsenegatives(i.e.,maliciousappsmarkedasbenign).
Anti-malware providers will benefit from answers to RQ1 in
ordertoimprovetheirproducts,especiallyagainsttheobfuscation
strategies that thwart their products the most. In addition, theanswers to RQ1 can help smartphone users choose betweenanti-malware products. Benign app developers will benefit fromanswerstoRQ1bylearningwhichobfuscationstrategiesprevent
theirappsfrombeingflaggedasmalicious.
RQ2.Howistheaccuracyofanti-malwareproductsaffectedby
obfuscationtools?
Each anti-malware product’s effectiveness likely varies based
ontheimplementationsofobfuscationstrategiesprovidedbyanobfuscationtool.Tomakethatdetermination,RQ2measurestheaccuracy of anti-malware products on obfuscation tools, where
accuracyisagainmeasuredintermsofprecisionandrecall.
Anti-malwareproductvendors,benignappdevelopers,andobfus-
cationtooldeveloperscanbenefitinseveralwaysfromtheanswers
toRQ2.Anti-malwareproductvendorscanusethisinformationto
determinewhichspecificimplementationsofobfuscationstrategies
may cause false positives (i.e., benign apps marked as malicious)
intheirproducts.Similarly,thesevendorscanbenefitfromlearning
whichobfuscationsresultinsuccessfulevasionfromdetectionby
maliciousapps.AnswerstoRQ2canaidbenignappdevelopersin
choosingtheobfuscationtoolsthatwillpreventtheirappsfromer-
roneouslybeingmarkedasmalicious.Furthermore,iffalsepositives
orfalsenegatives(i.e.,maliciousappsmarkedasbenign)areduetoobfuscationtools,asopposedtotheanti-malwareproducts,then
thisinformationisusefulforcorrectingobfuscationtools.
RQ3.Howistheaccuracyofanti-malwareproductsaffectedby
theyearanappiscreated?
RQ3 aims to study the accuracy of anti-malware products on
non-transformedandtransformedappsoverdifferenttimeperiods,
whereeachtimeperiodforourstudyspanstwoyears.Weconsider
transformed apps as belonging to the same time period as theirnon-transformed versions. For example, if we transform appscreated in time period 2012-2013, we still consider the resulting
obfuscatedappsascreatedin2012-2013,forthepurposesofRQ3.
Thisresearchquestionallowsustounderstandtheeffectiveness
ofanti-malwareproductswhenappliedtodifferenttimeperiodsand
todetermineifthoseproducts’detectionaccuraciesareaffectedby
time.Anti-malwarevendorscanusethisinformationtodetermine
the time periods that result in poor accuracy for their products,aidingthemwithimprovingresultsforappscreatedduringthose
problematictimeperiods.
RQ4.To what extent do obfuscation tools result in valid,
installable,andrunnableapps?
Althoughanobfuscatedappdoesnotneedtoberunnablewhen
scannedbyananti-malwareproduct,developersofbenignappsandobfuscationtoolsrelyonthosetoolstoproducevalid,installable,and
runnableapps.Similarto[ 34],weconsideranAPKtobe validifan
obfuscationtoolsuccessfullygeneratesasignedAPKpackagethat
includesa classes.dex filecontainingcorrectDalvikbytecodesyntax.
An app is installable if it can be successfully deployed into the
Androidruntime.Forourpurposes,atransformedappis runnableif
itsruntimebehaviorissimilartoitsnon-transformedversion.RQ4isparticularlyusefulforobfuscationtooldeveloperssinceanswers
to that question provide information about transformations that
resultinmalformedapps.
4 RESEARCH METHODOLOGY
Thissectiondescribestheresearchmethodologythatwepursued
in terms of our study subjects, selected obfuscation tools, our
evaluationframework,andourselectedanti-malwareproducts.
4.1 Study Subjects
Weusedadatasetofbenignappsconsistingof3,000appsfromGoogle
Playand3,000maliciousapps.Toavoidhavingmaliciousappsinour
ground-truthdatasetofbenignapps,weobtainedbenignappsfrom
AndroZoo[ 26],whichisacollectionofmorethan5.5millionapps
collectedfromseveralsources,includingGooglePlay.AndroZooapps have been scanned by commercial anti-malware productsusingtheVirusTotalservice[
4],afreeonlineserviceprovidedby
Google that scans URLs, files, and Android apps. Approximately
25,000GooglePlayappsoutofnearly2millionappsinAndroZoo
are marked as benign by all anti-malware products. From these25,000apps,wehaverandomlyselected3,000appsforthisstudy.
Themaliciousappsbelongtoseveralmalwarerepositoriesincluding
AndroidMalwareGenome[ 49],Contagio[ 6],AndroTotal[ 39],the
Drebindataset[ 27]andVirusShare[ 5].Inadditiontothesemalware
repositories, we used the VirusTotal service to include recentlydiscovered malicious apps that belong to the following malware
families:BrainTest[7],VikingHorde[12],andFalseGuide[18].
4.2 Obfuscation Tools
We have included the following obfuscation tools for our study,
whosesupportedobfuscationstrategiesaredepictedinTable2:
423
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ICSE’18,May27-June3,2018,Gothenburg,Sweden MahmoudHammad,JoshuaGarcia,andSamMalek
Figure 1: Obfuscation study methodology
Table 2: Obfuscation strategies of each obfuscation tool
Trivial Non-trivial
Obfuscator/Strategy
ALIGN
DRMANREPACK
CFCRENCIDRJUNKMRREFApktool/Jarsigner /check/check
Allatori /check/check /check/check
DashO /check/check /check
DroidChameleon /check /check /check /check/check/check
ADAM /check /check/check /check /check
ProGuard /check
Allatori[ 3]isacommercialJavaandAndroidobfuscationtool
that supports a wide range of obfuscation strategies. Many
companiessuchasAmazon,Fujitsu,andMotorolarelyonAllatori
toprotecttheirsoftwaresystemsfrombeingreverseengineered.
Theprovidersofthistool,SmardecInc.,provideduswithafull
versionforeducationalpurposes.
ProGuard[ 22]isawidelyusedopen-sourceshrinker,optimizer,
obfuscator, and preverifier for Java bytecode. A preverifier
performs certain checks on Java bytecode prior to runtime.
ProGuardsupportsidentifierrenamingandisthedefaulttoolin
manydevelopmentenvironments,includingAndroidStudio[ 14],
theofficialIDEforAndroidapps.
ADAM [47] is a research tool for obfuscating Android apps. It
transformstheSmalicodeofareversed-engineeredapp.
DroidChameleon[ 44]isastate-of-the-artresearchtoolforobfus-
catingAndroidappswhichsupportsawiderangeofobfuscation
strategies. Compared to ADAM, DroidChameleon supportsmorecomplextransformations.LikeADAM,DroidChameleon
transformstheSmalicodeofareversed-engineeredapp.
DashO[15]isacommercialtoolforobfuscatingAndroidandJava
applications.DashOprovidesstaticanalysisprotectionandrun-
timesecuritycontrolagainsttampering,unauthorizeddebugging,andsomeruntimeattackpatterns.Thistoolsupportscontrol-flow,
string-encryption,andidentifier-renamingtransformations.The
providers of DashO, PreEmptive Solutions, supplied us with a
fullfreeversionvalidfor30days.
ApktoolandJarsignerwereusedtoperformtheDRandREPACK
obfuscationstrategies,respectively.Thesetwotransformationsof-tenworkintandembecauseareassembledAPKmustberesigned.
We also considered another tool, DexGuard [ 17], which is an
advancedandcommercialversionofProGuard.Wecontactedtheproviders of DexGuard to obtain an educational or commercial
versionoftheirtooltorunonourdataset.Unfortunately,theyonly
allowtheirtooltorunonarestrictednumberofAndroidapps;and
theydonotselllicensesforresearchpurposes.Hence,wedidnot
includeitinthisstudy.
4.3 Evaluation Framework
Toconductourstudy,wehavedevelopedtheframeworkdepictedin
Figure1,whichconsistsofthefollowingfourmodules: IRConverter,
IR Transformer, APK Generator, and Data Analyzer. IR Converter
takesanAndroidAPKasinputandconvertsitscodetoIntermediateRepresentation(IR)formats. IRTransformer utilizesallobfuscation
tools to transform the IR format using a variety of obfuscationstrategies. APKGenerator repackageseachobfuscatedIRfileand
generatesanobfuscatedAPKfromthatfile. DataAnalyzer scans
obfuscatedappsusinganti-malwareproducts,storesthescanning
results in a MySQL database, analyzes the scanning results, and
createsvariousstatisticalreports.
Ourframeworkisreusableandextendable.Ausercanaddnew
obfuscation tools and support different obfuscation strategies.
Therefore,wemaketheframeworkavailableforresearchersand
practitioners[ 21].TheframeworkisaPythonprogramthatconsists
ofmorethan5,500linesofcode,notcountingtheobfuscationtools.
IR Converter. Obfuscation tools do not require source code
and they work directly on the IR format. Therefore, this moduleconvertsanAPKfiletotwoIRformats: smaliusingBaksmaliand
Javabytecodeusing dex2jar.Inourframework,wegeneratethese
twoIRformatssinceADAMandDroidChameleonworkon smali
codewhileallotherobfuscationtoolsworkonJavabytecode.
IR Transformer. ThismodulegeneratesseveralobfuscatedIR
filesoftheoriginalIRfile.Theframeworkisconfiguredtoleverage
twentyninedifferentobfuscationstrategiesusingsevenobfuscation
tools(recallSection4.2).
APK Generator. ForeachobfuscatedIRfile,thismodulegener-
atesanobfuscatedAndroidapp.First,thismoduleleveragesthe dx
toolfromtheAndroidSDKtoconvertanobfuscatedIRtoa classes.dex
file.Next,itgeneratesanAPKfilewiththenew classes.dex using
Apktool.Finally,theAPKfileissignedusing jarsignerwithourown
certificate,sincetheoriginalcertificateoftheappcannotbeobtained.
Data Analyzer. This module uses the VirusTotal service to
scan apps using anti-malware products. This module uploadsthe apps to VirusTotal, which scans them using more than 60
up-to-datecommercialanti-malwareproducts.Foreachuploaded
app,VirusTotalreturnsauniquescanningID,whichDataAnalyzer
useslatertodownloadthescanningreportsandstoresthemina
MySQLdatabase.DataAnalyzerqueriesandprocessesthedatabase
togeneratevariousstatisticalreports.
4.4 Anti-malware Products
Wehaveevaluatedtheaccuracyandtheresiliencyof61commercial
anti-malwareproductsagainstobfuscations.Duetospacelimitationsandtoensurereadability,wefocusontheresultsofthe21mostpopu-
larAndroidanti-malwareproductsinthispaper;however,wemake
theresultsforall61anti-malwareproductsavailableonline[21].
Table3showstheanti-malwareproductsevaluatedinthisstudy
andincludesthefollowinginformationforeachproduct:itsnumberofDownloads ;itsoverallusersatisfactionscoreasrepresentedusinga
star-rating(Stars );andthenumberofuserswhoreviewedtheproduct
(Reviewers ).ThenumbersinTable3areobtainedfromGooglePlay.
5 DATA ANALYSIS AND RESULTS
Forconductingourexperiments,wehaveleveragedahighperfor-
mancecomputingcluster(HPC),managedbyourorganization,that
hasmorethan200computenodeswithatotalofmorethan8,000
cores.Eachcomputenodehas264GB-512GBRAM.WeutilizedHPC
424
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ALarge-ScaleEmpiricalStudyontheEffectsofCode
ObfuscationsonAndroidAppsandAnti-MalwareProductsICSE’18,May27-June3,2018,Gothenburg,Sweden
Table 3: Anti-malware products (K: Thousand. M: Million)
Product Downloads Stars Reviews Product Downloads Stars Reviews
Ikarus 100K-500K 4.2 2,862 Trustlook 10M-50M 4.4 476,671
Emsisoft 100K-500K 4.2 1,425 McAfee 10M-50M 4.4 506,491
Fortinet 100K-500K 4.2 2,086 Avira 10M-50M 4.5 441,016
AegisLab 100K-500K 4.2 2,905 Norton
10M-50M 4.5 946,230
F-Secure 500K-1M 4.1 12,183 Symantec
Comodo 500K-1M 4.6 33,395 ESET-
NOD3210M-50M 4.7 490,840
GData 1M-5M 4.0 8,850 Kaspersky 10M-50M 4.7 2,061,983
Sophos 1M-5M 4.3 11,816 DrWeb 50M-100M 4.5 1,044,410
TrendMicro 1M-5M 4.6 49,977 Antiy-
AVL100M-500M 4.1 2,166
BitDefender 5M-10M 4.5 88,809 Avast 100M-500M 4.5 4,724,478
CAT-QuickHeal5M-10M 4.4 204,709
AVG 100M-500M 4.5 5,785,171
torunthousandsofjobssimultaneously.Oneachapp,weapplied
29differentobfuscationstrategies:4trivialtransformations,7non-
trivial transformations, and 18 combined transformations. Table
4 shows the number of obfuscated apps resulting from applying
the 29 obfuscation strategies leveraged by the obfuscation tools.
Anemptycellindicatesanobfuscationstrategythatisnotsupport
byaparticularobfuscationtool.Intotal,wehavegenerated73,362
obfuscatedappsfrom3,000benignappsand3,000maliciousapps.
Intheremainderofthissection,wepresenttheresultsofourex-
periments.Wemeasuredtheeffectivenessofanti-malwareproducts
atidentifyingmaliciousappsintermsoftheir precision,whichmea-
surestheextenttowhichbenignappsarelabeledasmalicious,and
recall,whichmeasurestheextenttowhichmaliciousappsarelabeled
asbenign.Weusethe F-score,i.e.,theharmonicmeanofprecisionand
recall,tomeasuretheoveralldetectionrateofanti-malwareproducts.
5.1 RQ1. Obfuscation Strategies
Westudiedtheaccuracyofanti-malwareproductswithrespectto
awidevarietyobfuscationstrategiesintwoscenarios.Inthefirst
scenario(Section5.1.1),wecomparethedetectionratesofeachanti-
malwareproductontheoriginaldatasetandtheobfuscateddataset.
Inthesecondscenario(Section5.1.2),wemeasurethedetectionrate
ofanti-malwareproductsagainsteachobfuscationstrategy.
5.1.1 Detection rate on original and obfuscated apps. Figure 2
showsthedetectionrateof21anti-malwareproductsontheoriginal
dataset of 6,000 apps, depicted as black bars, and the obfuscated
datasetof73,362apps,depictedasgraybars.Figure2demonstrates
that the detection rate of anti-malware products on the original
datasetisabove85%for16products,andbetween75%and85%for
4anti-malwareproducts. TrendMicro exhibitsthelowestdetection
rate,56%.Theaveragedetectionrateis87%ontheoriginaldataset.
Consequently,priortoapplicationofobfuscationstrategiesfromob-
fuscationtools,thesetopanti-malwareproductsarequiteeffective
atprotectingAndroidusers;albeitthereisroomforimprovement.
Onceobfuscationstrategiesareapplied,thedetectionratesfor
those anti-malware products decrease significantly, as shown in
Figure2.Forexample, AegisLab achievesthehighestdetectionrate
on the original dataset, 96%, since it mislabeled only 247 apps inthe original dataset. Its detection rate has dropped to 55% on theobfuscateddataset—a40%decrease—asitmislabeled 27
,636apps.
Other anti-malware products arealso severelyimpacted by codeobfuscation. While the average detection rate of anti-malware
Figure 2: Detection rate of 21 anti-malware products on 6,000original apps and 73,362 obfuscated apps.
productsontheoriginalappsis87%,theaveragedetectionrateon
theobfuscateddatasetis67%—a20%decrease.
Finding 1: Code obfuscation significantly impacts Android
anti-malware products. The average detection rate for the top
anti-malwareproductsdecreasesfrom87%to67%—a20%decrease.
5.1.2 Detection rate for each obfuscation strategy. To better
understandtheimpactofeveryobfuscationstrategyoneachanti-
malwareproduct,Table5presentsthedetectionrateofanti-malware
products,expressedastheF-score,ontheoriginaldatasetandthe
variousobfuscationstrategies.Forexample,thedetectionrateof
Symantec on the original dataset is 93%. This detection rate has
droppedto64%onobfuscatedappsusingMAN,to69%onobfuscated
appsusingENC,andto31%onobfuscatedappsusingENC_IDR.
Table5demonstratesthatthemajorityofanti-malwareproducts
arenotaffectedbyREF.Weconsideratransformation’seffectonaproduct’sdetectionratetobenegligibleifthedetectionratehas
eitherimproved,decreasedbylessthan3%,orremainsabove85%.
Infact,theaccuracyof F-Secure, GData,BitDefender,and Emsisoft
improvesonappsobfuscatedusingREF.Thisresultindicatesthatthe
intensiveuseof codereflection makesanapplooksuspicioustoour
studiedanti-malwareproducts,improvingtheirdetectionrates.Un-
fortunately,thisphenomenonmayresultinfalsepositivesforcertain
anti-malwareproducts.Forinstance, AVGerroneouslymarked307
benignappsobfuscatedusingREFasmalicious,whilealsocorrectly
detectingnearlyallmaliciousappsobfuscatedusingREF.
Finding 2: REF transformations make apps look suspicious,
increasingthechanceofanappbeinglabeledasmalicious.
Perhapsmostsurprisingisthatcertaintrivialobfuscationstrate-
giesarequiteeffectiveagainstthetopanti-malwareproducts.No-
tably, the anti-malware products that we studied rely heavily onanalyzinganapp’smanifestfile,whichcontainsconfigurationin-
formation.Consequently,theseproductsareoftenevadedbyapps
obfuscatedusingMAN,whichinvolvesthetrivialadditionormodifi-cationofpermissionsorIntentfilters.Forexample,thedetectionrateofMcAfeedroppedfrom94%to21%forappsobfuscatedusingMAN.
Overall,theaveragedetectionrateofanti-malwareproductsfellto
60%from87%whenappsareobfuscatedusingMAN—a28%decrease.
Finding 3: MAN,whichisatrivialobfuscationstrategy,severely
impactsmanyanti-malwareproducts,onaverage,decreasinga
product’sdetectionrateby28%.
Anotherinteresting,possiblycounter-intuitive,conclusionthat
wecandrawfromTable5isthatcombinedtransformationsarenot
alwayssuperiortoindividualtransformations.Forinstance,while
425
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ICSE’18,May27-June3,2018,Gothenburg,Sweden MahmoudHammad,JoshuaGarcia,andSamMalek
Table 4: Number of obfuscated apps using the obfuscation strategy in the column leveraged by the obfuscator in the row.
Trivial Non-trivial Combined Strategies
_REF
Obfuscator/Strategy
ALIGN
DRMANREPACK
CFCRENCIDR
JUNK
MR
REF
CF_ENCCF_IDRCF_MANCF_MRCR_MANENC_IDRENC_MAN
JUNK_MANMAN_REF
CF_CR_MANCF_ENC_IDRCF_ENC_MRCF_IDR_MRCF_REF_MAN
ENC_REF_MANCF_ENC_IDR_MR
CF_CR_ENC_MAN_REF
CF_CR_ENC_JUNK_MANTotal apps
Apktool/Jarsigner 3,693 5,880 9,573
Allatori 1,612 1,613 1,609 1,612 1,609 1,607 1,607 1,606 12,875
DashO 1,094 1,089 1,097 1,082 1,084 1,077 1,083 7,606
DroidChameleon 3,597 2,593 1,952 687 351 1,487 610 1,594 1,752 679 349 1,385 1,361 993 658 570 314 20,932
ADAM 5,487 0 4,175 2,708 4,119 4,182 20,671
ProGuard 1,705 1,705
Total apps 5,487 3,693 3,597 5,880 5,299 6,127 6,097 8,530 4,533 1,612 1,487 1,692 1,084 1,594 1,609 1,752 1,077 679 349 1,385 1,361 1,083 1,607 1,607 993 658 1,606 570 314 73,362
Table 5: (RQ1) Detection rate of anti-malware products, measured by their F-score (%), against each obfuscation strategy.
Trivial Non-trivial Combined Strategies
_REF
Anti-malware
Original
ALIGN
DR
MAN
REPACK
CF
CR
ENC
IDR
JUNK
MR
REF
CF_ENC
CF_IDR
CF_MAN
CF_MR
CR_MAN
ENC_IDR
ENC_MAN
JUNK_MAN
MAN_REF
CF_CR_MAN
CF_ENC_IDR
CF_ENC_MR
CF_IDR_MR
CF_REF_MAN
ENC_REF_MAN
CF_ENC_IDR_MR
CF_CR_ENC_MAN_REF
CF_CR_ENC_JUNK_MAN
AegisLab 9684523692523553396266584111576637368615843465666668635835
Ikarus 949594669675848186869388757784888564898689866084879389829287
CAT-QuickHeal 949593929489 91758889939473 9293939155919094915476919484 708980
AVG 94759663967983859184978877 7783978558908589855792969290 929185
McAfee 949050219347204552167323204117732021222022172266661518631420
ESET-NOD32 949492919493938091469466759292949368864666916180926859728057
Fortinet 939489869388837884759186677991888358877787845083838975727256
Symantec 938687648876846979849288636883928531908589853175909290739185
Sophos 939391909389857079938892708493878652919592875066729391519185
Avira 929287849285846578788760617886868538808059833869855833637361
F-Secure 898787859085828184959094736591908253939492845387889393848071
Comodo 88882716822217192417191517201133162014181611202026914231118
GData 889184758879617577958591625479855046837981504579778182775741
BitDefender 879084738878607475958591614676854544837878464379777783775841
Emsisoft 879084738878607475958591614676854543837878464379777783775941
DrWeb 878883818889869086938840928990888690949441908988873940873635
Trustlook 841023048170222003602303801000024039004000
Kaspersky 818375708281767075888180737781817750868981815070778384649185
Antiy-AVL 787956268041224747136818202512702124128201225706912156587
Avast 757563577573666666787475716778746846917976764560698391479186
TrendMicro 56571174812710146161091561671157105101214741235
AVERAGE 87 83 72 60 85 68 61 63 67 66 76 64 55 57 66 77 59 42 68 64 63 60 41 68 73 63 61 64 59 51
thedetectionrateof AVGagainstCFis79%,itsdetectionrateagainst
combinedtransformationsthatincludeCFisbetween57%and97%.
Finding 4: In general, combined transformations do not
affect detection rates more than single transformations: The
averagedetectionrateofanti-malwareproductsis61%forsingle
non-trivialobfuscations,and61%forcombinedobfuscations.
Figure3containsbox-and-whiskerplotsillustratingtheimpactof
eachobfuscationstrategyonallanti-malwareproducts.Theseresults
suggestthatsomeobfuscationstrategieshavenegligibleeffectson
themajorityofanti-malwareproducts.Forexample,REPACKdidnot
affect19anti-malwareproducts.Similarly,theuseoftheMRtrans-
formationsdidnotaffect14anti-malwareproducts.Lastly,theREF
transformationdidnotthwartthemajorityofanti-malwareproducts.Figure3demonstratesthatENC_IDRandCF_ENC_IDRarevery
effective in thwarting anti-malware products. In fact, these two
transformationsevadedallanti-malwareproductsexcept DrWeb.
Finding 5: ENC_IDRandCF_ENC_IDRarethemostsuccessful
transformationsforevadinganti-malwareproducts.
5.2 RQ2. Obfuscation Tools
For RQ2, we studied the detection rate of anti-malware products
onappstransformedusingvariousobfuscationtools.Tothatend,
weanalyzetheresultsofeachanti-malwareproduct’sdetectionrate
oneachobfuscationtool.Wefurtherassesstheoveralleffectofeach
obfuscationtoolacrossallstudiedanti-malwareproducts.
Table6depictsthedetectionrateofeachanti-malwareproduct
onappstransformedusingeachobfuscationtool.FromTable6,we
426
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ALarge-ScaleEmpiricalStudyontheEffectsofCode
ObfuscationsonAndroidAppsandAnti-MalwareProductsICSE’18,May27-June3,2018,Gothenburg,Sweden
Figure 3: (RQ1) The average detection rate of all anti-malware products regarding each obfuscation strategy.
Table 6: Detection rate of anti-malware products (F-score (%))
against each obfuscation tool
Anti-malware
Original
ADAM
Apktool/
Jarsigner
Allatori
Droid
ChameleonProGuard
DashO
AegisLab 96 83 79 66 53 9 13
Ikarus 94 95 95 88 82 80 71
CAT-QuickHeal 94 95 94 86 90 80 75
A V G 9 47 5 9 69 5 8 19 07 1
McAfee 94 90 79 68 19 37 31
ESET-NOD32 94 94 93 88 83 90 80
Fortinet 93 94 91 85 85 74 69
SymantecMobileInsight 93 86 88 86 82 72 51
Sophos 93 93 92 75 90 78 69
Avira 92 92 90 80 77 62 60
F-Secure 89 87 89 88 89 92 61
Comodo 88 88 65 25 14 23 20
GData 88 90 86 81 76 90 50
BitDefender 87 90 87 81 74 90 45
Emsisoft 87 90 86 81 74 90 45
D r W e b 8 78 8 8 68 8 7 78 18 9
Trustlook 84 10 37 39 0 0 2
Kaspersky 81 83 79 76 81 70 66
Antiy-AVL 78 79 72 69 16 23 25
Avast 75 75 71 67 77 60 58
TrendMicro 56 57 35 14 7 10 12
AVERAGE 87 83 80 73 63 62 51
observethatsomeanti-malwareproductsareseverlyimpactedby
allobfuscationtools.Forexample,thedetectionrateof Trustlook
dropped to less than 40% on apps obfuscated using any of our
studiedtools.Furthermore, Trustlook markedallappsobfuscated
bythefollowingtools:DroidChameleon,ProGuard,andDashOas
benignapps.Likewise, TrendMicro andComodoareevadedbyall
obfuscationtools,exceptADAM.
Thebox-and-whiskerplotshowninFigure4depictstheeffect
ofeachobfuscationtoolonallanti-malwareproducts.Thefigure
showsthatthetopanti-malwareproductsareresilientagainstApk-
tool/Jarsigner,ADAM,andAllatori.Atthesametime,DashOevades
thetopanti-malwareproductsmoreoftenthantheotherproducts.
Wefurtherassessedthevariabilityofeachobfuscationtoolonour
studiedanti-malwareproducts,whichindicateshowconsistentlyeach tool affects the accuracy of those products. To that end, we
consideredtheinterquartilerange(IQR)oftheboxplotsinFigure4.
Figure4:(RQ2)Theaveragedetectionrateofallanti-malwareproducts regarding each obfuscation tool.
IQRisthedifferencebetweenthelowerboundandtheupperbound
ofabox,whichconveysthecentraltendencyoftopanti-malware
productsagainstanobfuscationtool.AsmallIQRindicatesthatthe
behaviorofananti-malwareproductishighlyconsistent. Figure
4showsthatProGuardhasthelargestIQR.
ADAMandApktool/Jarsigner,asshowninFigure4,havearel-
ativelyhighmedian,88%and86%,respectively,withthelowestIQR,
i.e.,9%and13%,respectively.Thisindicatesthatanti-malwareprod-
uctsareresilienttothesetools.Consequently,appsobfuscatedby
ADAMandApktool/Jarsignerworkwellforbenignappdevelopers,
whowouldwanttoobfuscateappswithouthavingthembefalsely
reportedasmalicious,andwouldbeleastusefulformalwareauthors.
Finding 6: ADAMandApktool/Jarsignerproduceobfuscations
thatreduceanti-malwareproductaccuracytheleast.
Figure 4 suggests that DashO is most successful at evading
anti-malwareproducts,whichaidsmalwareauthors.Theaverage
detectionrateofanti-malwareproductsonobfuscatedappsusing
DashOis51%withamedianof58%—a37%decreaseintheaverage
detectionrate,anda32%mediandecrease.
Finding 7: DashOreducestheaccuracyofanti-malwareproducts
morethanotherobfuscationtoolsinourstudy.
5.3 RQ3. Time-Aware Analysis
Asignificantfactorthatmayinteractwiththeeffectofobfuscations
onanti-malwareproductaccuracyistime.ForRQ3,weconducted
a time-aware analysis that studies the accuracy of anti-malwareproductsonoriginalandobfuscatedappsthatbelongtothesame
timeperiodforthepast10years.Figure5depictstheresultsofthis
427
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ICSE’18,May27-June3,2018,Gothenburg,Sweden MahmoudHammad,JoshuaGarcia,andSamMalek
analysis.Wegroupedappsintotwo-yeartimeperiods,duetothe
factthatsomeyearsonlyhaveafewapps,mainly2009with29apps,
and2017with130apps.Similarto[ 25],weconsidertheyearofthe
lastmodifieddateof classes.dex inanappastheyearfromwhich
itoriginates.Weconsideranytransformedappasbelongingtothe
sameyearasitsoriginalversion,inordertodeterminetheactual
effectofobfuscationonproductaccuracyforeachtimeperiod.
Figure 5: (RQ3) Time-aware analysis.
Fortheoriginaldataset,Figure5showsthatthetopanti-malware
productsmaintainsimilardetectionratesforanytwoconsecutive
timeperiodspriortoandincluding2012-2013.Unfortunately,there
aresignificantdecreasesinthedetectionratestartingfromthetime
periodbetween2012-2013and2014-2015;theaveragedetectionrate
is70%for2014-2015,fallingfrom87%in2012-2013.By2016-2017,
theaveragedetectionratefallsto53%ontheoriginalapps.
Fortheobfuscateddataset,Figure5illustratesthatthedetection
ratesofanti-malwareproductsdecreaseinalargelylinearfashion.
Theaveragedetectionratestartsat67%onobfuscatedappsfrom
2008-2009anddecreasesto39%onobfuscatedappsfrom2016-2017.
Theseresultssuggestthatanti-malwareproductsareslowtoadopt
signaturesofmaliciousapps.
Theaveragedetectionrateonoriginalappsfrom2010to2013
are higher than the average detection rate on older apps. This
likely occurs because many malicious apps from 2010-2013 are
well-known and highly disseminated among security analysts.
Forexample,AndroidMalwareGenomeisadatasetofmalicious
Androidappsthatarewidelyused,aredescribedinahighlycited
paper[49],andwerereleasedinthe2010-2013timeperiod.
Finding 8: Theaveragedetectionratesofanti-malwareproducts
tendtodecreaseovertime,indicatingthatsuchproductsareslow
toadoptsignaturesofmaliciousapps.
5.4 RQ4. Valid, installable, and runnable apps
An obfuscated app is not useful for app authors, unless the app
canrunonadevice.Forthatreason,RQ4measurestheabilityof
obfuscationtoolstogeneratevalid,installable,andrunnableapps.
5.4.1 Valid apps. RecallfromSection3,a validobfuscatedapp
corresponds to a signed APK package that includes a classes.dex
filecontainingthecorrectDalvikbytecodesyntax.Table7depicts
theabilityofobfuscationtoolstogeneratevalidobfuscatedapps,
which we refer to as the obfuscation rate . The obfuscation rate is
measuredusingtheratioofthenumberofvalidappsgeneratedby
anobfuscationtooltothenumberofappssuccessfullyretargetedto Java bytecode. For example, ProGuard obfuscated 684 benignapps out of 1,688 successfully retargeted benign apps, resulting
inanobfuscationrateof41%forbenignapps.Similarly,ProGuardobfuscated1,021maliciousappsoutof2,005retargetedmalicious
apps;hence,ProGuard’sobfuscationrateonmaliciousappsis51%.
Table7showsthatDashOhasthelowestobfuscationrate(30%)
whereas DroidChameleon achieves the highest obfuscation rate
(60%).Therearemanyreasonsbehindtheselowobfuscationrates,
includingexceptionsraisedbyobfuscationtoolswhiletransforminganappandtheirinabilitytoproduceavalidobfuscated classes.dex file.
Forinstance,Allatoriraisedthisexception“com.allatori.IiIIIIiiii:Only
finalfieldsmayhaveaninitialvalue! ”onmanyapps.Wecontacted
theproviderofAllatoriaboutthisexception,whoinformedusthat
thisproblemhasbeenreportedbyotherusers,butcouldnotberepro-
duced.Consequently,wehelpedthemreproduceittoimprovetheir
product.Theyreportedtousthatthisexceptionismainlycausedby
theuseof dex2jar,althoughafixfortheexceptionisstillinprogress.
Table 7: The ability of obfuscators to generate valid APKs.
ProGuard Allatori DroidChameleon DashO ADAM
Benign 40.52% 25.77% 81.57% 13.39% 79.57%
Malicious 50.92% 58.70% 56.10% 43.24% 59.87%
Total 46.17% 43.65% 59.95% 29.60% 69.72%
5.4.2 Installable and runnable apps. Tomeasureanobfuscation
tool’sabilitytogenerateinstallableapps,weidentifiedalloriginal
appsthathaveatleastoneapptransformedbyeachobfuscationtool.Foreachoriginalapp,ifthereismorethanoneapptransformedusing
thesameobfuscationtool,werandomlyselectoneofthem.Using
thatprocess,werandomlyselected250originalappsalongwiththeir
obfuscatedversions,resultingintheselectionof1,750obfuscated
apps.WeranthisexperimentonaMacBookProwitha2.2GHzIntel
Corei7and16GBRAM,andinstalledtheappsonanAndroidde-
vice.Afterweconfirmedthatall250originalappsweresuccessfully
installedontheAndroiddevice,weinstalledtheobfuscatedapps.
Inadditiontomeasuringapp installabilityafterobfuscation,i.e.,
theextenttowhichanobfuscatorcangenerateinstallableapps,we
furthermeasuredapp runnabilityafterobfuscation,i.e.,theextent
towhichanobfuscatorcangeneraterunnableapps.Forourstudy,
arunnableappcanbeorder-agnosticororder-aware.Arunnableapp isorder-agnostic if its obfuscated version exhibits the same
setofrunningcomponentsandexceptionsasitsoriginalversion;
a runnable app is order-aware if its obfuscated version exhibits
the same sequence of running components and exceptions as its
original version. To determine app runnability after obfuscation,
werecordedthesequenceof(1)componentsthatexecuteand(2)
exceptionsthatoccurduringexecutionofanappusing Monkey[24],
a program that generates pseudo-random streams of user events
(e.g.,clicks,touches,orgestures)andsystem-levelevents.Wethen
checkedforequalityofthesequencesofrunningcomponentsand
exceptionsofanoriginalappanditsobfuscatedversion,using1,000
eventsforeachappasinput.WefurtherranMonkeyusingthesame
random seed for each original app and its obfuscated version, in
ordertotestbothappversionsusingthesamesequenceofinputs.
Toconductthisexperiment,weusedthe250originalappsand
the1,341successfullyinstalledappsfromthepreviousexperiment,
i.e., the total installed apps mentioned in Table 8. To measure
whether an obfuscated app runs successfully, we have modified
andinstrumentedtheAndroidframework[ 13]toincludeprobes
formonitoringtherunningcomponents.Weinstalledourmodified
AndroidframeworkonaNexus5Xdevice.
Table8showstheabilityofobfuscationtoolstoproduceinstal-
lableandrunnableapps,includingthefollowinginformation:the
428
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ALarge-ScaleEmpiricalStudyontheEffectsofCode
ObfuscationsonAndroidAppsandAnti-MalwareProductsICSE’18,May27-June3,2018,Gothenburg,Sweden
totalnumberofobfuscatedappsthatwe Examined perobfuscation
tool; the number of successfully Installed apps; the number of
runnableappsthatare Order-Agnostic ;andthenumberofrunnable
appsthatare Order-Aware.
Table 8: Installable and runnable apps of each obfuscator.
Obfuscator Examined Installed Order-
AgnosticOrder-
Aware
Jarsigner 250 249 248 150
Apktool 250 249 246 154
DroidChameleon 250 249 83 31
ProGuard 250 248 237 131
Allatori 250 213 188 122
ADAM 250 84 67 46
DashO 250 49 0 0
Total Apps 1,750 1,341 1,069 634
Many obfuscation tools produce installable apps. Our results
demonstratethatalmostallappstransformedbyApktool/Jarsigner,
DroidChameleon, and ProGuard have successfully installed. In
addition, only 37 apps obfuscated by Allatori have not installedsuccessfully.Moreover,Table8showsthatmostappsobfuscatedusing ADAM or DashO are not installable. Successfully installed
appsobfuscatedusingADAMallutilizetheALIGNtransformation.
All obfuscated apps using the non-trivial obfuscations of ADAM
arenotinstallable.
Therunnabilityofappsobfuscatedusingourstudiedobfuscation
toolsvariesgreatlydependingonthetool.Table8showsthatalmost
allobfuscatedappsusing Jarsigner andApktoolarerunnableinan
order-agnosticfashion.249appsobfuscatedusingDroidChameleon
areinstallable;only83ofthoseinstallableappsareorder-agnostic
andrunnable;andonly31ofthoseinstallableappsareorder-aware
andrunnable.AllappstransformedbyDroidChameleonusingthe
ENCtransformationaremissingafunctionthatdecryptsencrypted
strings, causing these apps to crash at runtime and raise theerror
java.lang.NoClassDefFoundError . All apps that become
unrunnableaftertransformationbyDashOraisethesameerror,i.e.,
java.lang.ExceptionInInitializerError . Given that DashO
isnotanopen-sourcetool,wecouldnotinvestigatethisproblemfurther. Table 8 shows that 95% of the installable apps generatedby ProGuard are runnable. Likewise, 88% of the installable apps
generatedbyAllatoriarerunnable.
Finding 9: The percentage of obfuscated apps that are both
installableandrunnableinanorder-awarefashionwithrespectto
componentbehaviorsvariesfrom0%-62%.Theseresultssuggesta
significantneedforimprovingobfuscationtoolssothatapplying
theirtransformationsretainanapp’soriginalbehavior.
6 DISCUSSION
Foranti-malwareproductvendors,ourstudysuggestsseveralareas
forwhichanti-malwareproductsingeneralcanbesignificantlyim-
proved.Recallthatoverallonourobfuscateddataset,anti-malware
productsexperienceda20%decreaseintheirdetectionrateofmali-
ciousappscomparedtotheoriginaldataset(Finding1).Inparticular,
transformationsthatmainlyinvolvedidentifier-namemanipulation
(i.e., MAN, ENC_IDR, and CF_ENC_IDR) substantially affected
obfuscationtools(Findings3and5).Manifest-filetransformations
(i.e.,MAN)thatsimplyinvolveadditionofpermissionsthatarenot
necessarilyusedorfakecomponentcapabilitiesresultedina28%
decrease,onaverage,forthetop-performinganti-malwareproducts
Figure 6: Anti-malware detection, installability, andrunnability with respect to obfuscators
(Finding 3). Overall, these results indicate that anti-malware
product vendors would significantly benefit from performing adeeper analysis into the code of an app, potentially focusing on
thesecurity-sensitivecodeusedbyappsthroughstaticordynamic
analysis.Theimportanceofperformingdeeperanalysisisfurther
highlightedby(1)thefactthattransformationsneednotnecessarilybecombinedtoevadeanti-malwareproducts(Finding4)and(2)this
evasionworsensfornewerapps(Finding8).
Forbenign-appdevelopers,ourstudyprovidessomeguidance
astohowparticularobfuscationsmaybeused.Specifically,wehave
foundthatreflectiontransformationstendtoincreasesignificantly
thepossibilityofabenignappbeinglabeledasmalicious.Therefore,
benign app developers may wish to avoid such transformationsto avoid this false labeling, and to reduce overhead exhibited byreflection.Inthegeneralcase,benign-appdevelopersneednotbe
overlyconcernedabouttheirappsbeingfalselylabeledasmalicious
when combining obfuscations (Finding 4), except in the case of
reflectiontransformations(Finding2).
The major finding for obfuscation-tool developers is that our
studyindicatesthatmanyoftheirtransformationsresultininvalid,
non-installable,orunrunnableapps(Finding9).Althoughsomeof
thatburdenliesonbenign-appdeveloperstoensurethatobfusca-
tionstheyapplydonotadverselyaffecttheirapps,obfuscation-tool
developerswouldbenefitfromaidingbenign-appdevelopersinthe
taskofensuringtheirappsremainrunnableafterobfuscation.
Wefurtherexaminetheimplicationsoftheinteractionbetween
(1)obfuscationstools’abilitytoproduceinstallableandrunnable
appsand(2)theanti-malwareproductdetectionrateonmalicious
apps obfuscated using those tools. Figure 6 visually depicts the
interactionbetweenthesetwophenomena.Obfuscationtoolsthatlieontheupper-rightcornerofthefigurearepreferredtoolsforbenign
app developers, obfuscation-tool providers, and anti-malware
vendors.Theseobfuscationtoolsreliablygenerateinstallableand
runnableappswhilemaintainingahighdetectionrateofmalicious
apps for anti-malware products. In our study, no tool is above80% for both its anti-malware detection rate and installabilityand runnability after obfuscation. Consequently, significant
improvementscanbemadetothesetoolsalongthosedimensions.
Obfuscation tools that lie on the upper-left corner of Figure 6
are tools that exhibit properties particularly useful for malware
authors.Thesetoolsreliablygenerateinstallableandrunnableapps
whileevadingthedetectionofanti-malwareproducts.ProGuard
isanexampleofsuchatool.Althoughfewtoolsappearclosetothe
upper-leftcornerofthechart,malwareauthorsarelikelytoexpend
429
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ICSE’18,May27-June3,2018,Gothenburg,Sweden MahmoudHammad,JoshuaGarcia,andSamMalek
theextraeffortneededtoensurethattheirobfuscationsresultin
installableandrunnableapps.
7 THREATS TO VALIDITY
Thissectionpresentsourstudy’sthreatstoexternalandconstruct
validity,andtheactionswehavetakentomitigatethem.
Externalvalidity measurestheextenttowhichtheresultsofour
studycanbegeneralized.Onethreattoexternalvalidityforourstudy
iswhetherourstudy’sfindingscanbegeneralizedtootherappsout-
sideofourstudy.Tomitigatethisthreat,weobtainedbenignand
maliciousappsfromdiversesourcesthatvaryacrossapplicationdo-
mains,intermsofappsize,andoriginatefromvarioustimeperiods.
Toensureourfindingsarelikelytogeneralizetootherobfuscation
strategiesandtools,weemployed29obfuscationstrategiesfrom7
obfuscationtools—thelargestnumberofstrategiesandtoolsutilizedtodateforastudyaboutappobfuscation.Wefurtherobtainedobfus-cationtoolsthatareacademic,open-source,andcommercial—aiding
ingeneralizabilitytothesethreedifferentsources.
Another threat to external validity is our selection of anti-
malwareproducts.Tomitigatethisthreat,wehaveselectedover60 anti-malware products from VirusTotal, and focused on the
mostpopularandwell-rated21productsforourstudy,duetospace
limitations.However,wemaketheresultsofourstudy,alongwith
thecompletelistofanti-malwareproductsandapps,availableonline
[21].Thefindingsfortheanti-malwareproductsnotdiscussedin
thispaperareconsistentwiththefindingsinthispaper.
Construct validity is concerned with whether our study’s
measurements or measurement procedures validly quantify the
constructsorconceptsweintendtoquantify.Athreattoconstruct
validity is the metrics and measurement procedures we used to
quantifytheabilityofobfuscationtoolstoproducerunnableapps
whose behavior before obfuscation is similar to behavior after
obfuscation. To measure these constructs, we compared the setor sequence of running components and thrown exceptions of
appsbeforeandafterobfuscation.Thesemeasurementprocedures
and associated metrics are sensible given that components arefunctional units of behavior—making them a sensible means ofidentifying high-level behavior—and exceptions are the mainmeans of identifying errors in apps whose test cases and oracles
areunavailable,whichisthecaseformanyappsonGooglePlay.
Anotherthreattoconstructvalidityisthelabelingofourapps
asbenignormalicious.Tomitigatethisthreat,ourdatasetofbenign
apps are marked as benign by over 50 anti-malware products.Similarly, our malicious apps are obtained from repositories
containingappsmanuallylabeledasmaliciousbysecurityexperts.
8 RELATED WORK
Wedividepreviousworkrelatedtoourstudyintofourcategories:
(1) studies about similarity of a repackaged app with its original
version,(2)obfuscationstrategiesforPCanddesktopsoftware,(3)
obfuscationtoolsspecificallydesignedforAndroid,and(4)studies
abouttheeffectsofobfuscationonanti-malwareproducts.Inthe
remainderofthissection,wediscusseachoftheseareasofrelated
work and conclude the section with the key differences between
ourstudyandthemostsimilarrelatedwork.
Researchershavestudiedthesimilaritybetweenoriginalapps
and repackaged apps. Huang et al. [ 34] used Androguard [ 2], an
Androidreverse-engineeringframeworkformalwareanalysis,to
studytheobfuscationresilienceofrepackagingdetectionalgorithms.
Faruki et al. [ 32] compared the performance of anti-malwareproductsandAndroguard’scodesimilaritywithAndroSimilar[ 33],
theirtoolfordetectingobfuscatedapps.WangandRountevdescribe
anapproachfordeterminingwhichobfuscationtoolwasapplied
toanobfuscatedapp[46].
A few studies have considered the application of obfuscation
strategies in the context of PC and desktop software. Collberg et
al.producedataxonomyoftransformationsforobfuscationwitha
focusonJava[ 31].Collbergetal.[ 30]alsoimplementedatoolcalled
SandMark for evaluating the effectiveness of code obfuscationto protect Java-based software systems from piracy, tampering,and reverse engineering. Christodorescu and Jha [
28] evaluated
theresilienceofanti-malwareproductsagainstcodeobfuscation
appliedtoVisualBasicprogramsandproposedasemantics-aware
malware-detectionalgorithmin[29].
Previousworkhasproducedafewobfuscationtoolsspecifically
designed for Android apps. Zheng et al. [ 47] proposed ADAM,
a framework for obfuscating Android apps and testing them on
anti-malwareproducts.TheyevaluatedADAM’seffectivenessfor
evading10anti-malwareproductson222transformed,maliciousapps. Rastogi et al. [
44] presented DroidChameleon, a tool for
obfuscatingAndroidapps,andassessedobfuscationsonsixapps
fromAndroidMalwareGenome[49].
Anothersetofstudiesfocusedontheeffectsofobfuscationson
anti-malwareproducts,withoutproposingnewobfuscationtools.
Maiorcaetal.[ 40]studiedtheeffectsofcodeobfuscatedbyasingle
toolon13anti-malwareproducts.Pomilia[ 43]studiedtheperfor-
mance of 9 anti-malware products on a dataset obfuscated using
Allatori.Moralesetal.[ 41]studiedtheresilienceof4anti-malware
productsaftertransforming2virusesonWindowsMobileOS.
Alltheaforementionedpreviousworkthathavestudiedeither
obfuscation tools or the effects of obfuscation strategies on
anti-malwareproductsfocusonasingleobfuscationtoolandasmall
numberofanti-malwareproductsandapps.Noneofthesestudies
have performed a large-scale empirical study considering the
effectsthatoccurduetotheconcurrentutilizationofanti-malware
products,variousobfuscationtools,andtheirsupportedobfuscation
strategies.Noneofthesestudiesassessedtheseeffectsonbenign
apps;theeffectsofcombiningobfuscationstrategies;andtheability
ofobfuscationtoolstoproducevalid,installable,andrunnableapps.
9 CONCLUSION
Inthispaper,wehaveevaluatedtheeffectivenessofthetop-rated
Androidanti-malwareproductsagainstcodeobfuscation.Weused
alargedatasetconsistingof3,000benignapps,3,000maliciousapps,
and73,362obfuscatedapps.ToobfuscateAndroidapps,weapplied
29differentobfuscationstrategiesusing7commercial,open-source,
andacademicobfuscationtools.Ourstudyincludesthefollowingkeyfindings:(1)allanti-malwareproductssuccumbtocodeobfuscation;
(2)mostproductsaresusceptibletotrivialtransformations,suchas
simplechangestotheAndroidmanifestfile;(3)thedetectionratesof
anti-malwareproductsdependnotonlyontheobfuscationstrategy
appliedbutalsoontheleveragedobfuscationtool;(4)anti-malware
products are slow to adopt signatures of malicious apps; and (5)
codeobfuscationtoasignificantextentresultsinappsthatdonot
exhibitthesamebehaviorastheiroriginalversions.Basedonour
overallfindings,wehaveprovidedguidanceandrecommendations
forimprovinganti-malwareproductsandobfuscationtools.Tothat
end,Ourstudyresults,includingtheframeworkthatwedeveloped
toconductthisstudy,areavailablepubliclyonline[21].
430
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. ALarge-ScaleEmpiricalStudyontheEffectsofCode
ObfuscationsonAndroidAppsandAnti-MalwareProductsICSE’18,May27-June3,2018,Gothenburg,Sweden
10 ACKNOWLEDGMENTS
This work was supported in part by awards CCF-1252644, CNS-
1629771,andCCF-1618132fromtheNationalScienceFoundation,
HSHQDC-14-C-B0040fromtheDepartmentofHomelandSecurity,
andFA95501610030fromtheAirForceOfficeofScientificResearch.
REFERENCES
[1] Apktool. https://ibotpeaches.github.io/Apktool/.(2010).
[2]Androguard: Reverse engineering and malware analysis of Android apps by
BlackHat. https://github.com/androguard.(2011).
[3] AllatoriObfuscator. http://www.allatori.com/.(January2012).[4]
VirusTotal-Freevirus,malwareandURLscanner. https://www.virustotal.com/en.
(2012).
[5] VirusShare. http://virusshare.com/.(August2013).
[6] ContagioMalwareRepository. http://contagiodump.blogspot.it.(2015).
[7]Brain Test Lookout Report. https://blog.lookout.com/blog/2016/01/06/
brain-test-re-emerges/.(2016).
[8]DressCode Android malware. http://blog.checkpoint.com/2016/08/31/
dresscode-android-malware-discovered-on-google-play/.(2016).
[9]KasperskySecurityBulletin. https://kasperskycontenthub.com/securelist/files/
2016/12/Kaspersky_Security_Bulletin_2016_Review_ENG.pdf.(2016).
[10]McAfeemobilethreatsreport. https://www.mcafee.com/us/resources/reports/
rp-mobile-threat-report-2016.pdf.(2016).
[11]Smartphone OS Market Share, 2017 Q1. International Data Corporation.
http://www.idc.com/promo/smartphone-market-share/os.(2016).
[12]VikingHorde Android malware. http://blog.checkpoint.com/2016/05/09/
viking-horde-a-new-type-of-android-malware-on-google-play/.(2016).
[13] AndroidOpenSourceProject. https://source.android.com/.(July2017).[14]
AndroidStudio. https://developer.android.com/studio/build/shrink-code.html.
(2017).
[15] DashO. https://www.preemptive.com/.(2017).[16]
Dex2jar: Tools to work with android. dex and java. class files. https:
//github.com/pxb1988/dex2jar.(2017).
[17] DexGuard. https://www.guardsquare.com/en.(2017).[18]
FalseGuide Android malware. http://blog.checkpoint.com/2017/04/24/
falaseguide-misleads-users-googleplay/.(2017).
[19] GooglePlayAppStore. https://play.google.com/store?hl=en.(2017).[20]
jarsigner - JAR Signing and Verification Tool. https://docs.oracle.com/javase/
6/docs/technotes/tools/windows/jarsigner.html.(2017).
[21]Obfuscation Study Framework. http://www.ics.uci.edu/~seal/projects/
obfuscation/index.html.(August2017).
[22] ProGuard. https://www.guardsquare.com/en/proguard.(2017).
[23] Smali/Backsmali. https://github.com/JesusFreke/smali.(2017).
[24]UI/Application Exerciser Monkey. https://developer.android.com/studio/test/
monkey.html.(August2017).
[25]KevinAllix,TegawendéFBissyandé,JacquesKlein,andYvesLeTraon.2015. Are
yourtrainingdatasetsyetrelevant.In InternationalSymposiumonEngineering
SecureSoftwareandSystems.Springer,Milan,Italy,51–67.
[26]Kevin Allix, Tegawendé F Bissyandé, Jacques Klein, and Yves Le Traon. 2016.
Androzoo:Collectingmillionsofandroidappsfortheresearchcommunity.In
IEEE/ACM13thWorkingConferenceonMiningSoftwareRepositories(MSR).IEEE,
Austin,Texas,468–471.
[27]DanielArp,MichaelSpreitzenbarth,MalteHübner,HugoGascon,KonradRieck,andCERTSiemens.2014. Drebin:Effectiveandexplainabledetectionofandroid
malwareinyourpocket.In ProceedingofNetworkandDistributedSystemSecurity
Symposium.SanDiego,California.
[28]Mihai Christodorescu and Somesh Jha. 2004. Testing malware detectors.
InternationalSymposiumonSoftwareTestingandAnalysis(ISSTA’04) (July2004).
[29]MihaiChristodorescu,SomeshJha,SanjitASeshia,DawnSong,andRandalE
Bryant.2005. Semantics-awaremalwaredetection.In IEEESymposiumonSecurity
andPrivacy.IEEE,Oakland,CA,32–46.
[30]ChristianCollberg,GRMyles,andAndrewHuntwork.2003. Sandmark-atool
forsoftwareprotectionresearch. IEEEsecurity&privacy 99,4(2003),40–49.
[31]ChristianCollberg,ClarkThomborson,andDouglasLow.1997. Ataxonomyof
obfuscatingtransformations. TechnicalReportTR148.DepartmentofComputer
Science,TheUniversityofAuckland,NewZealand.
[32]ParvezFaruki,AmmarBharmal,VijayLaxmi,ManojSinghGaur,MauroConti,and
MuttukrishnanRajarajan.2014. Evaluationofandroidanti-malwaretechniques
againstdalvikbytecodeobfuscation.In InternationalConferenceonTrust,Security
andPrivacyinComputingandCommunications(TrustCom).IEEE,Beijing,China,
414–421.
[33]Parvez Faruki, Vijay Laxmi, Ammar Bharmal, Manoj Singh Gaur, and Vijay
Ganmoor.2015. AndroSimilar:RobustsignaturefordetectingvariantsofAndroid
malware. JournalofInformationSecurityandApplications 22(June2015),66–80.
[34]Heqing Huang, Sencun Zhu, Peng Liu, and Dinghao Wu. 2013. A frameworkfor evaluating mobile app repackaging detection algorithms. In International
ConferenceonTrustandTrustworthyComputing.Springer,London,UK,169–186.
[35]LiLi,TegawendéFrançoisDAssiseBissyande,MikePapadakis,SiegfriedRasthofer,
AlexandreBartel,DamienOcteau,JacquesKlein,andYvesLeTraon.2016. Staticanalysisofandroidapps:Asystematicliteraturereview. TechnicalReport.SnT.
[36]LiLi,DaoyuanLi,TegawendéFBissyandé,JacquesKlein,HaipengCai,DavidLo, and Yves Le Traon. 2017. Automatically locating malicious packages inpiggybackedandroidapps.In Proceedingsofthe4thInternationalConferenceon
MobileSoftwareEngineeringandSystems(MOBILESoft’17) .IEEEPress,Buenos
Aires,Argentina,170–174.
[37]LiLi,DaoyuanLi,TegawendéFBissyandé,JacquesKlein,YvesLeTraon,David
Lo,andLorenzoCavallaro.2017. Understandingandroidapppiggybacking:Asystematicstudyofmaliciouscodegrafting. IEEETransactionsonInformation
ForensicsandSecurity 12,6(June2017),1269–1284.
[38]LiLi,DaoyuanLi,TegawendéFBissyandé,JacquesKlein,YvesLeTraon,David
Lo, and Lorenzo Cavallaro. 2017. Understanding Android app piggybacking.InProceedings of the 39th International Conference on Software Engineering
Companion.IEEEPress,BuenosAires,Argentina,359–361.
[39]FedericoMaggi,AndreaValdi,andStefanoZanero.2013. AndroTotal:aflexible,
scalabletoolboxandservicefortestingmobilemalwaredetectors.In Proceedings
of the Third ACM workshop on Security and privacy in smartphones & mobile
devices.ACM,Berlin,Germany,49–54.
[40]DavideMaiorca,DavideAriu,IginoCorona,MarcoAresu,andGiorgioGiacinto.
2015. Stealthattacks:Anextendedinsightintotheobfuscationeffectsonandroid
malware. Computers&Security 51(March2015),16–31.
[41]JoseAndreMorales,PeterJClarke,YiDeng,andBMGolamKibria.2006. Testing
andevaluatingvirusdetectorsforhandhelddevices. JournalinComputerVirology
2,2(2006),135–147.
[42]DamienOcteau,SomeshJha,andPatrickMcDaniel.2012. RetargetingAndroid
applicationstoJavabytecode.In InternationalSymposiumontheFoundationsof
SoftwareEngineering.ACM,Cary,NorthCarolina,6.
[43]M.Pomilia. AStudyonObfuscationTechniquesforAndroidMalware. (2016).
http://www.dis.uniroma1.it/~midlab
[44]VaibhavRastogi,YanChen,andXuxianJiang.2014. Catchmeifyoucan:Eval-
uatingandroidanti-malwareagainsttransformationattacks. IEEETransactions
onInformationForensicsandSecurity 9,1(2014),99–108.
[45]RajaVallée-Rai,PhongCo,EtienneGagnon,LaurieHendren,PatrickLam,and
VijaySundaresan.1999. Soot-aJavaBytecodeOptimizationFramework.In Pro-
ceedingsofthe1999ConferenceoftheCentreforAdvancedStudiesonCollaborativeRe-search(CASCON’99).IBMPress. http://dl.acm.org/citation.cfm?id=781995.782008
[46]YanWangandAtanasRountev.2017.WhoChangedYou?ObfuscatorIdentification
forAndroid. (May2017).
[47]Min Zheng,Patrick PC Lee,and John CSLui. 2012. ADAM: an automaticandextensible platform to stress test android anti-virus systems. In International
ConferenceonDetectionofIntrusionsandMalware,andVulnerabilityAssessment.
Springer,Heraklion,Crete,Greece,82–101.
[48]WuZhou,YajinZhou,MichaelGrace,XuxianJiang,andShihongZou.2013. Fast,
scalabledetectionofpiggybackedmobileapplications.In Proceedingsofthethird
ACMconferenceonDataandapplicationsecurityandprivacy .ACM,SanAntonio,
TX,185–196.
[49]YajinZhouandXuxianJiang.2012. Dissectingandroidmalware:Characterization
andevolution.In IEEESymposiumonSecurityandPrivacy.IEEE,SanFrancisco,
California,95–109.
431
Authorized licensed use limited to: LAHORE UNIV OF MANAGEMENT SCIENCES. Downloaded on August 07,2025 at 10:52:44 UTC from IEEE Xplore.  Restrictions apply. 