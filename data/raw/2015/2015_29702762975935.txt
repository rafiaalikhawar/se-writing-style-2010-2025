Automated Testing and NotiÔ¨Åcation of Mobile App Privacy
Leak-Cause Behaviours
Joseph Chan Joo Keng
School of Information Systems
Singapore Management University
{joseph.chan.2012}@phdis.smu.edu.sg
ABSTRACT
I describe the design, implementation and evaluation of a
novel hybrid static/dynamic analysis system for automat-
ically uncovering and testing for the user-triggered causes
and paths of privacy leaks in Android applications (privacy
'leak-causes'). I describe how I plan to further evaluate and
demonstrate improvements in accuracy, coverage and testing
speed of my hybrid testing approach against other currently
available systems. I also show how user privacy is improved
by the presentation of information on leak-causes in a eld
study as privacy notices. I present plans to investigate which
of the commonly utilized mobile notication mechanisms is
best suited to the presentation of leak-causes, as well as how
users may set better privacy control policies with the infor-
mation provided.
CCS Concepts
Security and privacy !Privacy protections; Software
and its engineering !Automated static analysis; Dy-
namic analysis;
1. INTRODUCTION
While mobile applications help to manage many aspects
of urban lifestyle, many of them do not optimize usage of
privacy data and follow good practices in privacy design.
Many apps in mobile stores, even popular and well regarded
ones, access and leak privacy data to the network. It would
be greatly benecial for tools to perform analysis of app
binaries to analyze their privacy behaviours. Of particular
interest in my dissertation is the discovery and utilization
of user-triggered causes and paths of privacy leaks of mobile
apps [7] (privacy 'leak-cause').
To output the privacy leak-causes and paths, I proposed
and implemented a Graph-Aided Directed automated test-
ing solution for Android apps [5]. The system is based on
a novel utilization of hybrid static/dynamic analysis. Static
analysis is used to capture activity/page transitional paths
of the Android application, as well as identify target activ-
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proÔ¨Åt or commercial advantage and that copies bear this notice and the full cita-
tion on the Ô¨Årst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciÔ¨Åc permission
and/or a fee. Request permissions from permissions@acm.org.
ASE‚Äô16, Sept 3-7, 2016, Singapore
c2016 ACM. ISBN 978-1-4503-2138-9.
DOI:http://dx.doi.org/10.1145/2970276.2975935ities that leak privacy data. After identication of target
activities, automated app testing is utilized for determina-
tion/conrmation of actual runtime privacy behaviours.
While a number of automated testers have been proposed
and developed, automated testing remains a very time and
resource intensive process. Ensuring good coverage of mo-
bile apps in a suciently low testing time is a very challeng-
ing problem due to the large number of app windows and
states involved. Reaching the desired states whereby pri-
vacy behaviours are involved in a practical amount of time
is a challenge. An ecient and eective means of automated
runtime testing will remove hurdles to increased adoption.
To solve the problem, I utilize analysis of callback control
ow to generate an activity transition graph. This allows
automated testing to directly traverse apps towards privacy
related activities for verication.
On eective and accurate discovery of privacy related 'leak-
causes' in mobile apps, an important problem is in improving
the privacy behaviours of users with the knowledge obtained.
Privacy related notications in current privacy detectors are
largely based on the 'just-in-time' concept [3], whereby pri-
vacy notications appear to the user at runtime. Such no-
tications inform users 'when' privacy leaks occur but not
'how' these leaks occur, or the privacy related characteristics
of the app. Eective notication of privacy 'leak-causes' in
apps could provide users with better understanding on the
privacy behaviours of their apps, and enable them to im-
prove their privacy behaviours and set better policies.
1.1 Motivations and Existing Work
Privacy Analysis of Apps : I aim to produce a solution
for automatically uncovering the user-triggered causes and
paths of privacy leaks in Android apps. While systems such
as for e.g. FlowDroid [1], TaintDroid [4] and AppsPlay-
Ground [13] are able to analyze privacy in apps, they do not
output this information. User-triggered causes and paths
represent an additional context information in privacy anal-
ysis that could likely be valuable.
Automated App Testing : Part of my solution involves test-
ing and verication of the privacy leaks using automated
app testing. The commonly used Android Monkey [11] per-
forms testing using Random event generation. Testers such
as Dynodroid [10] and VanarSena [14] are also based on ran-
dom exploration, but have systematic and improved event
selection to increase testing eciency. AMC [8] and DE-
CAF [9] utilize GUI Models obtained at runtime for path
determination. A3E [2] and ORBIT [16] utilize static analy-
sis to obtain GUI models prior to runtime. While solutions
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proÔ¨Åt or commercial advantage and that copies bear this notice and the full citation
on the Ô¨Årst page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior speciÔ¨Åc permission and/or a
fee. Request permissions from Permissions@acm.org.
ASE‚Äô16 , September 3‚Äì7, 2016, Singapore, Singapore
c2016 ACM. 978-1-4503-3845-5/16/09...$15.00
http://dx.doi.org/10.1145/2970276.2975935
880
exist, automated app testing remains time and resource in-
tensive. I aim to design and implement an automated test-
ing solution that is more time ecient than these existing
systems for testing privacy leak-cause behaviours.
Privacy Notications : Privacy leak detection tools [4] are
geared towards the monitoring of privacy infringements rather
than on eective notications to the user. For e.g. Balebako
et al. [3] investigated improving the TaintDroid leak detector
notications by a visualization mechanism which displays
the tabulated total number of privacy requests each app has
requested in a summarized list. Providing additional context
or insights into the privacy characteristic of apps in privacy
notices could potentially improve the value of privacy noti-
cations and aid users in improving their privacy. I aim to
investigate providing this additional context in the form of
user-triggered causes and paths of privacy leaks.
1.2 Proposed Solution & Approach
Hybrid Static/Dynamic Analysis System: My proposed ap-
proach involves using static analysis to capture activity/page
transitional paths of the Android application, as well as
identify target activities that leak privacy data. Obtaining
such transitional paths require the control ow between An-
droid call-back functions. Due to the event-driven nature of
the Android framework, the control-ow between call-back
functions will not be available from a standard control-ow
graph. To overcome this problem, I initially utilized the call-
back control-ow graph (CCFG) using the GATOR tool [15].
However due to scalability issue, I formulated and built a
new implementation for analysis of the control-ow between
call-back methods of Android activities and the unique GUI
components linked to these call-back methods, using SOOT
and the Jimple Bytecode representation. The sequence of
user-actions from the control-ow can then be used to di-
rectly traverse apps towards privacy related activities for
testing.
Privacy HCI: My approach involves providing deeper con-
text and insights into the characteristic of apps in privacy
notices by displaying the user-triggered causes of privacy
leaks and leak characteristics of apps in privacy notices.
To the best of my knowledge, the display of user-triggered
causes of privacy leaks to users has not been studied be-
fore. I investigate how users react in response to these no-
tices, as well as how their mobile privacy behaviours can be
improved from knowledge obtained from the notices. I do
so by studying their privacy-related inclinations after uti-
lizing applications with and without information on user-
triggered causes. Such privacy-related inclinations could be
captured from user activity from usage logs as well as from
surveys that users answer during the course of the study. I
also plan to evaluate which notication delivery mechanism
works best in a lab setting. Lastly, I also study if displaying
information on user-triggered causes can enable users to set
better privacy policies in privacy data managers.
1.3 Contributions
Automated Privacy Analysis System:
Design and implement a novel hybrid static/dynamic
tool for outputting user-triggered causes and paths of
privacy leaks in Android apps
Formulate an eective algorithm for analyzing the con-
trol ow between callback functions that are involvedin activity/page transitions in Android apps, and to
create an activity-transition graph
Utilize the activity-transition graph to directly tra-
verse applications towards privacy-related activities for
automated testing and verication
Scale up automated testing and verication to many
thousands of Android apps, so that the current 'leak-
cause' path sequencing behaviours and characteristics
of apps in the Android ecosystem can be empirically
studied. Evaluate the system with those of other au-
tomated testing solutions.
Notication of Privacy Leak Behaviours:
Investigate the eects of providing the additional con-
text of user-triggered causes of privacy leaks to real
users in the eld.
Evaluate the eectiveness of dierent privacy messag-
ing mechanisms (e.g. Toast message overlays, Stan-
dard Android Notications, Dialogs etc.), in terms of
whether user behaviours are positively modied and
whether their knowledge of app privacy behaviours are
enhanced.
Investigate if information on user-triggered causes en-
able users to form better privacy policies.
I describe the currently completed work in the next sec-
tion.
2. AUTOMATED GRAPH-AIDED DIR-
ECTED TESTING OF ANDROID APPS
In my initial results, I demonstrated that utilizing static
analysis to guide runtime dynamic analysis has signicant
testing time improvements. I developed a solution and im-
plementation for time and resource ecient automated test-
ing of Android apps based on pre-runtime discovery of ac-
tivity state transitional information from control-ow of app
byte-code. (Automated Graph-Aided Directed Testing [5])
The directed testing system is called MAMBA and the over-
all system diagram is displayed in Figure. 1.
From Figure 1, path searches are performed from callback
control-ow graphs (CCFG) using the GATOR tool [15].
The paths sought out were reaching paths from root to all
target activities in the app. A sensitive API linking tool was
also built which performed a static analysis on decompiled
app Smali code to link activities with call-graph links to sen-
sitive API calls. Sensitive API calls were any method calls
which accessed any form of a user's on-phone data or sensor
information (e.g. Phone Identiers, Contact List, GPS Lo-
cation etc.). Activities with links were identied as Target
Activities that are to be reached by the automated tester.
On identication of target activities, the CCFG paths for
these targets were ltered out. Test cases, consisting of user-
actions, were then built from these CCFG paths and pro-
vided to a user-event simulator for enaction on a mobile test-
device. Privacy leaks upon reaching these targeted activities
were then detected and veried using privacy detectors [4,
12].
An evaluation was performed using the MAMBA tester
on a set of 24 Android apps downloaded from the Google
8812Android 
.apk 
Smali 
Code GATOR: 
Callback 
Control-Flow 
Graph (CCFG) SOOT: 
Bytecode 
AMC Directed Testing with 
Test Cases /elipsis
Activities Associated with Sensitive API (Target Activities) Search for Sensitive Data APIs along Call-graph CCFG Paths 
Reaching 
Target 
Activities Search for Paths from Root to Other Activities within App 
Build 
Test Cases Filter 
Target Activities Figure 1: System Diagram of MAMBA: Directed
Testing of Android Applications for Checking Pri-
vacy Specications
Playstore. A comparison was performed against an exhaus-
tive testing approach, whereby clickable app widgets were
ordered sequentially and each tried in turn before backtrack-
ing to the previous page. The total testing times required
and activity coverage were measured. The results are de-
tailed in the following section.
2.1 Results
On average, Graph-Aided Tester (MAMBA) took just over
5 minutes and 3 seconds to complete testing, compared to
over 31 minutes and 15 seconds average time for the Ex-
haustive Testing approach. This represented a 6.1 factor
improvement in testing times.
In all, 101 target activities in the 24 apps were required
to be tested. Both testing concepts achieved on a 85.1% av-
erage coverage of target activities. From leak reports in the
TaintDroid and PMP privacy detectors, 45 of 101 targeted
activities were found to access privacy data (44.6%, over 13
apps). While 27 of 101 target activities (26.7% over 8 apps)
were found to leak privacy data to the network. These re-
sults are promising and show that MAMBA can be used
to perform dynamic runtime testing of Android apps at a
scalable rate.
3. USAGE OF AUTOMATED APP TESTING
OUTPUT TO IMPROVE USER
PRIVACY
I conducted a 2-week long eld user-study to evaluate the
eectiveness of privacy messages detailing 'leak-cause' be-
haviours of Android apps on a set of 47 real users on their
personal un-rooted mobile phones [6]. (25 Users in Test, 22
Users in Control) They consisted of sta/students as well as
external working adults. I utilized 10 test apps that many
of the users had already been using regularly (Social Media,
Utility, News as well as Game Apps). Privacy messages ap-
peared during app usage upon app start-ups, as well as were
overlaid directly on-top of privacy invasive buttons/widgets.
Figure 2 shows an example of a privacy overlay on top of aclickable app widget.
Original	 ¬†Leak	 ¬†Informa0on	 ¬†Message	 ¬†Overlay	 ¬†
The	 ¬†Leak	 ¬†Informa0on	 ¬†Message	 ¬†
Figure 2: Utilizing outputs of privacy checking -
Privacy Messages overlaid on-top of culprit but-
tons/widgets during Application Usage.
The users were randomly divided into separate groups of
Test (With Messages), and Control (Without Messages). (25
Users in Test, 22 Users in Control) I captured the charac-
teristics of users from pre and post-study surveys on 7-point
Likert-Scale as well as Yes/No questions. These charac-
teristics include users' Prior app Usage-time (Familiarity) ,
Surprise level ,Usability ,Privacy Consciousness level and
Disapproval of app data-usage . A multiple regression with
characteristics as Independent variables, and the Duration
of App Usage (Log) and No. of Leak Buttons Clicked (Log)
as Dependent variables. These Dependent variables were
investigated as they were proportional to the amount of pri-
vacy data being leaked by the application.
3.1 Results
The results of the multiple regression are displayed in Ta-
ble 1. It was found that users' Prior App Usage Time (Fa-
miliarity) was the dominant individual factor in aecting
the Duration of App Usage, while User Education was sig-
nicant in reducing the No. of Leak Buttons that users
clicked. There were signicant 3-factor interactions, which
indicated that the Privacy Messages were eective for users
who Disapproved of the data use and had appropriate User
Education, professed high Privacy Consciousness levels or
were Surprised with the data accesses.
The study highlights the conditions under which a 'Non-
Enforcing' mechanism can be eective. In particular, it was
found that user-disapproval with accesses, user-education,
inherent levels of privacy consciousness as well as high surprise-
levels play a part in eectiveness.
4. ACKNOWLEDGEMENTS
The author would like to acknowledge and thank his aca-
demic advisors Assistant Professor Jiang Lingxiao and As-
sociate Professor Rajesh Krishna Balan from the Singapore
882Table 1: Results: Multiple Linear Regression of
Field Study (***99%,**95%,*90% Condence Inter-
vals)
Depend. Independ. Est. Std. p-val
Variable Variable Error
Duration (1) Privacy -0.13 0.83 0.88
of Messages (0.04) (1.73) (0.98)
App
Usage (2) Disapp -0.01 0.18 0.95
(Log) -roval of (-2.52) (1.61) (0.12)
Data Use
(No. of
Leak (3) User 0.02 0.17 0.90
Buttons Education (-0.83) (0.47) (0.08* )
Clicked
(Log)) (4) Privacy 0.12 0.12 0.33
Conscious- (-0.09) (0.31) (0.76)
ness
(5) Surprise 0.04 0.04 0.31
Level (-0.03) (0.12) (0.78)
(6) Prior App 0.24 0.05 1.23 
Usage 10 5
Time ***
(Familiarity) (0.10) (0.12) (0.40)
Interaction -1.23 0.32 1.38 
(1:2:3) 10 4
***
(-3.83) (0.95) (7.86 
10 5
***)
Interaction -0.28 0.12 0.021
(1:2:4) ***
(-0.19) (0.36) (0.60)
Interaction -0.15 0.08 0.07*
(1:2:5) (-0.44) (0.25) (0.08*)
Management University (SMU). (Email: lxjiang/rajesh@
smu.edu.sg)
5. REFERENCES
[1] S. Arzt, S. Rasthofer, C. Fritz, E. Bodden, A. Bartel,
J. Klein, Y. Le Traon, D. Octeau, and P. McDaniel.
Flowdroid: Precise context, ow, eld, object-sensitive
and lifecycle-aware taint analysis for android apps.
ACM SIGPLAN Notices , 49(6):259{269, 2014.
[2] T. Azim and I. Neamtiu. Targeted and depth-rst
exploration for systematic testing of android apps.
ACM SIGPLAN Notices , 48(10):641{660, 2013.
[3] R. Balebako, J. Jung, W. Lu, L. F. Cranor, and
C. Nguyen. Little brothers watching you: Raising
awareness of data leaks on smartphones. In SOUPS ,
page 12. ACM, 2013.
[4] W. Enck, P. Gilbert, B. Chun, L. Cox, J. Jung,
P. McDaniel, and A. Sheth. TaintDroid: Aninformation-ow tracking system for realtime privacy
monitoring on smartphones. In OSDI , pages 1{6, 2010.
[5] J. C. J. Keng, L. Jiang, T. K. Wee, and R. K. Balan.
Graph-aided directed testing of android applications
for checking runtime privacy behaviours. In 11th
IEEE/ACM International Workshop on Automation
of Software Test (AST 2016) , 2016.
[6] J. C. J. Keng, L. Jiang, T. K. Wee, and R. K. Balan.
Leveraging automated privacy checking for design of
mobile privacy protection mechanisms. In Workshop
on Bridging the Gap Between Privacy By Design and
Privacy in Practice 2016 , 2016.
[7] J. C. J. Keng, T. K. Wee, L. Jiang, and R. K. Balan.
The case for mobile forensics of private data leaks:
Towards large-scale user-oriented privacy protection.
InProceedings of the 4th Asia-Pacic Workshop on
Systems , page 6. ACM, 2013.
[8] K. Lee, J. Flinn, T. J. Giuli, B. Noble, and C. Peplin.
Amc: Verifying user interface properties for vehicular
applications. In Proceeding of the 11th annual
international conference on Mobile systems,
applications, and services , pages 1{12. ACM, 2013.
[9] B. Liu, S. Nath, R. Govindan, and J. Liu. Decaf:
detecting and characterizing ad fraud in mobile apps.
InProc. of NSDI , 2014.
[10] A. Machiry, R. Tahiliani, and M. Naik. Dynodroid:
An input generation system for android apps. In FSE
13', pages 224{234. ACM, 2013.
[11] [Online]. Android monkey,
http://developer.android.com/tools/help/monkey.html,
Oct. 2015.
[12] [Online]. Protectmyprivacy (pmp) for android,
http://www.android.protectmyprivacy.org/, Jan. 2016.
[13] V. Rastogi, Y. Chen, and W. Enck. Appsplayground:
automatic security analysis of smartphone
applications. In Proceedings of the third ACM
conference on Data and application security and
privacy , pages 209{220. ACM, 2013.
[14] L. Ravindranath, S. Nath, J. Padhye, and
H. Balakrishnan. Automatic and scalable fault
detection for mobile applications. In Proceedings of the
12th annual international conference on Mobile
systems, applications, and services , pages 190{203.
ACM, 2014.
[15] S. Yang, D. Yan, H. Wu, Y. Wang, and A. Rountev.
Static control-ow analysis of user-driven callbacks in
android applications. In International Conference on
Software Engineering (ICSE) , 2015.
[16] W. Yang, M. R. Prasad, and T. Xie. A grey-box
approach for automated gui-model generation of
mobile applications. In International Conference on
Fundamental Approaches to Software Engineering ,
pages 250{265. Springer, 2013.
883